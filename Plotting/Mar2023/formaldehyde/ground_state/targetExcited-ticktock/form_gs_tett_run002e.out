Rank =    0  Free Memory = 89298 MB
Rank =    1  Free Memory = 89298 MB
Rank =    2  Free Memory = 89298 MB
Rank =    3  Free Memory = 89298 MB
Rank =    4  Free Memory = 89298 MB
Rank =    5  Free Memory = 89297 MB
Rank =    6  Free Memory = 89297 MB
Rank =    7  Free Memory = 89297 MB
Rank =    8  Free Memory = 89297 MB
Rank =    9  Free Memory = 89297 MB
Rank =   10  Free Memory = 89296 MB
Rank =   11  Free Memory = 89296 MB
Rank =   12  Free Memory = 89296 MB
Rank =   13  Free Memory = 89296 MB
Rank =   14  Free Memory = 89296 MB
Rank =   15  Free Memory = 89282 MB
Rank =   16  Free Memory = 89282 MB
Rank =   17  Free Memory = 89282 MB
Rank =   18  Free Memory = 89282 MB
Rank =   19  Free Memory = 89282 MB
Rank =   20  Free Memory = 89282 MB
Rank =   21  Free Memory = 89282 MB
Rank =   22  Free Memory = 89282 MB
Rank =   23  Free Memory = 89282 MB
Rank =   24  Free Memory = 89282 MB
Rank =   25  Free Memory = 89282 MB
Rank =   26  Free Memory = 89281 MB
Rank =   27  Free Memory = 89281 MB
Rank =   28  Free Memory = 89281 MB
Rank =   29  Free Memory = 89281 MB
Rank =   30  Free Memory = 89281 MB
Rank =   31  Free Memory = 89281 MB
Rank =   32  Free Memory = 90574 MB
Rank =   33  Free Memory = 90574 MB
Rank =   34  Free Memory = 90574 MB
Rank =   35  Free Memory = 90574 MB
Rank =   36  Free Memory = 90573 MB
Rank =   37  Free Memory = 90573 MB
Rank =   38  Free Memory = 90573 MB
Rank =   39  Free Memory = 90573 MB
Rank =   40  Free Memory = 90573 MB
Rank =   41  Free Memory = 90572 MB
Rank =   42  Free Memory = 90572 MB
Rank =   43  Free Memory = 90572 MB
Rank =   44  Free Memory = 90572 MB
Rank =   45  Free Memory = 90572 MB
Rank =   46  Free Memory = 90572 MB
Rank =   47  Free Memory = 90572 MB
Rank =   48  Free Memory = 90572 MB
Rank =   49  Free Memory = 90572 MB
Rank =   50  Free Memory = 90572 MB
Rank =   51  Free Memory = 90572 MB
Rank =   52  Free Memory = 90572 MB
Rank =   53  Free Memory = 90572 MB
Rank =   54  Free Memory = 90572 MB
Rank =   55  Free Memory = 90572 MB
Rank =   56  Free Memory = 90572 MB
Rank =   57  Free Memory = 90572 MB
Rank =   58  Free Memory = 90572 MB
Rank =   59  Free Memory = 90572 MB
Rank =   60  Free Memory = 90572 MB
Rank =   61  Free Memory = 90572 MB
Rank =   62  Free Memory = 90572 MB
Rank =   63  Free Memory = 90572 MB
Rank =   64  Free Memory = 91149 MB
Rank =   65  Free Memory = 91149 MB
Rank =   66  Free Memory = 91149 MB
Rank =   67  Free Memory = 91149 MB
Rank =   68  Free Memory = 91149 MB
Rank =   69  Free Memory = 91149 MB
Rank =   70  Free Memory = 91149 MB
Rank =   71  Free Memory = 91149 MB
Rank =   72  Free Memory = 91149 MB
Rank =   73  Free Memory = 91149 MB
Rank =   74  Free Memory = 91149 MB
Rank =   75  Free Memory = 91149 MB
Rank =   76  Free Memory = 91149 MB
Rank =   77  Free Memory = 91149 MB
Rank =   78  Free Memory = 91149 MB
Rank =   79  Free Memory = 91149 MB
Rank =   80  Free Memory = 91149 MB
Rank =   81  Free Memory = 91149 MB
Rank =   82  Free Memory = 91149 MB
Rank =   83  Free Memory = 91149 MB
Rank =   84  Free Memory = 91149 MB
Rank =   85  Free Memory = 91149 MB
Rank =   86  Free Memory = 91149 MB
Rank =   87  Free Memory = 91149 MB
Rank =   88  Free Memory = 91149 MB
Rank =   89  Free Memory = 91149 MB
Rank =   90  Free Memory = 91149 MB
Rank =   91  Free Memory = 91149 MB
Rank =   92  Free Memory = 91149 MB
Rank =   93  Free Memory = 91149 MB
Rank =   94  Free Memory = 91149 MB
Rank =   95  Free Memory = 91149 MB
Rank =   96  Free Memory = 82756 MB
Rank =   97  Free Memory = 82756 MB
Rank =   98  Free Memory = 82756 MB
Rank =   99  Free Memory = 82756 MB
Rank =  100  Free Memory = 82756 MB
Rank =  101  Free Memory = 82756 MB
Rank =  102  Free Memory = 82756 MB
Rank =  103  Free Memory = 82756 MB
Rank =  104  Free Memory = 82756 MB
Rank =  105  Free Memory = 82756 MB
Rank =  106  Free Memory = 82756 MB
Rank =  107  Free Memory = 82756 MB
Rank =  108  Free Memory = 82756 MB
Rank =  109  Free Memory = 82756 MB
Rank =  110  Free Memory = 82756 MB
Rank =  111  Free Memory = 82756 MB
Rank =  112  Free Memory = 82756 MB
Rank =  113  Free Memory = 82756 MB
Rank =  114  Free Memory = 82756 MB
Rank =  115  Free Memory = 82756 MB
Rank =  116  Free Memory = 82756 MB
Rank =  117  Free Memory = 82756 MB
Rank =  118  Free Memory = 82756 MB
Rank =  119  Free Memory = 82756 MB
Rank =  120  Free Memory = 82756 MB
Rank =  121  Free Memory = 82756 MB
Rank =  122  Free Memory = 82756 MB
Rank =  123  Free Memory = 82756 MB
Rank =  124  Free Memory = 82756 MB
Rank =  125  Free Memory = 82756 MB
Rank =  126  Free Memory = 82756 MB
Rank =  127  Free Memory = 82756 MB
  Input file(s): opt_form_gs_tett_run002e.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: a1d851bbe8d902a0d3168a885b757a378aeaab54-dirty
  Last git commit date: Mon Feb 13 11:52:39 2023 -0800
  Last git commit subject: Print param update magnitude and largest update
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_form_gs_tett_run002e.xml

  Project = FORM2
  date    = 2023-03-19 15:35:16 PDT
  host    = n0070.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 548

  Range of prime numbers to use as seeds over processors and threads = 3989-5077


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 12

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 4

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 2.659900e-01    1         1 OFF
     uu_1                 1.059606e-01    1         1 OFF
     uu_2                 6.585438e-03    1         1 OFF
     uu_3                -5.283753e-02    1         1 OFF
     uu_4                -8.663707e-02    1         1 OFF
     uu_5                -1.051063e-01    1         1 OFF
     uu_6                -1.113948e-01    1         1 OFF
     uu_7                -1.038544e-01    1         1 OFF
     uu_8                -8.046518e-02    1         1 OFF
     uu_9                -4.288804e-02    1         1 OFF

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 3.458918e-01    1         1 OFF
     ud_1                 1.068885e-01    1         1 OFF
     ud_2                -9.362422e-03    1         1 OFF
     ud_3                -6.924529e-02    1         1 OFF
     ud_4                -1.012960e-01    1         1 OFF
     ud_5                -1.172753e-01    1         1 OFF
     ud_6                -1.213691e-01    1         1 OFF
     ud_7                -1.120298e-01    1         1 OFF
     ud_8                -8.585231e-02    1         1 OFF
     ud_9                -4.559135e-02    1         1 OFF


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: C
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eC_0                -4.506186e-01    1         1 OFF
     eC_1                -3.146073e-01    1         1 OFF
     eC_2                -6.877446e-02    1         1 OFF
     eC_3                 8.858703e-02    1         1 OFF
     eC_4                 1.363007e-01    1         1 OFF
     eC_5                 2.006961e-01    1         1 OFF
     eC_6                 2.136812e-01    1         1 OFF
     eC_7                 1.597089e-01    1         1 OFF
     eC_8                 3.434703e-02    1         1 OFF
     eC_9                 1.047648e-03    1         1 OFF

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -8.235916e-01    1         1 OFF
     eO_1                -5.244949e-01    1         1 OFF
     eO_2                -1.331913e-01    1         1 OFF
     eO_3                 1.329657e-01    1         1 OFF
     eO_4                 2.611683e-01    1         1 OFF
     eO_5                 3.461237e-01    1         1 OFF
     eO_6                 3.302408e-01    1         1 OFF
     eO_7                 2.658993e-01    1         1 OFF
     eO_8                 1.071358e-01    1         1 OFF
     eO_9                 2.449963e-02    1         1 OFF

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -1.397717e-01    1         1 OFF
     eH1_1                -4.653272e-02    1         1 OFF
     eH1_2                -2.257470e-02    1         1 OFF
     eH1_3                -3.701495e-02    1         1 OFF
     eH1_4                -8.233741e-03    1         1 OFF
     eH1_5                 1.739621e-02    1         1 OFF
     eH1_6                 4.606475e-02    1         1 OFF
     eH1_7                 3.927161e-02    1         1 OFF
     eH1_8                 7.524879e-02    1         1 OFF
     eH1_9                 6.186013e-02    1         1 OFF

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -1.394482e-01    1         1 OFF
     eH2_1                -4.450287e-02    1         1 OFF
     eH2_2                -2.173021e-02    1         1 OFF
     eH2_3                -3.498437e-02    1         1 OFF
     eH2_4                -6.920902e-03    1         1 OFF
     eH2_5                 2.004559e-02    1         1 OFF
     eH2_6                 4.945828e-02    1         1 OFF
     eH2_7                 4.370990e-02    1         1 OFF
     eH2_8                 6.697447e-02    1         1 OFF
     eH2_9                 6.199319e-02    1         1 OFF

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for C
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 70 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.711064e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 20 unique up determinants.
Found 20 unique down determinants.
Number of terms in pairs array: 12
Number of terms in pairs array: 12
CI coefficients are optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for C
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.405000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.405000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.4050000000e+00

  Adding pseudopotential for O
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0750000000e+00
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0750000000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 2.7602e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 12 particles :  u(6) d(6)

    u  1.0776882035e+00  1.1858078688e-01 -1.1228966320e+00
    u  5.2623637829e-01  1.7541589896e-01 -1.3337143393e+00
    u -2.1907738776e-01  1.2604145828e+00  7.3980442540e-01
    u  5.1104917034e-03  1.4830329441e-01  1.8508537617e+00
    u  2.0319189978e-01  5.3211297520e-02  1.1096632188e+00
    u -7.1114543523e-01  2.3194667600e+00 -1.9120363364e+00
    d  4.5386831405e-01  7.4543549121e-01 -1.7781369559e+00
    d -5.3250436761e-01  5.6773482298e-01 -1.4296151151e+00
    d -8.5149149983e-02 -4.7335234687e-01  1.2151269463e+00
    d -1.3341711209e-02  5.3976693736e-01  8.3781480332e-01
    (... and 2 more particle positions ...)

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 4 particles :  C(1) O(1) H1(1) H2(1)

    C  0.0000000000e+00  0.0000000000e+00 -1.1394765782e+00
    O  0.0000000000e+00  0.0000000000e+00  1.1440287480e+00
    H1  0.0000000000e+00  1.7662761033e+00 -2.2339863698e+00
    H2  0.0000000000e+00 -1.7662761033e+00 -2.2339863698e+00

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 100
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root FORM2.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 69
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -22.8256
    reference variance = 0.330992
====================================================
  Execution time = 2.6044e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5344e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4602e-01
  Total weights = 1.964581222e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5945e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433379950273
                                         uncertainty =       0.001700216371

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433379950273
                                         uncertainty =       0.001700216371

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465464387
  error estimate for blocks of size 2^( 2) =       0.000491197304
  error estimate for blocks of size 2^( 3) =       0.000515543498
  error estimate for blocks of size 2^( 4) =       0.000534570699
  error estimate for blocks of size 2^( 5) =       0.000545462242
  error estimate for blocks of size 2^( 6) =       0.000551160536
  error estimate for blocks of size 2^( 7) =       0.000553569657

      target function =      -0.748666477105
              le_mean =     -22.815266190438
             les_mean =     520.982390684633
             stat err =       0.000546190783
             autocorr =       1.376942540029
   target nu stat err =       0.000546190783
   target dn stat err =       0.002523485907
      target stat err =       0.002198649295
              std dev =       0.658266049232
             le_variance =       0.433314191571


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-2.281526619044e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748671935277       residual = 2.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748744975446       residual = 3.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748756177529       residual = 8.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748757929686       residual = 3.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748759663797       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748760103620       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748760078474       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748760070978       residual = 4.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748760059217       residual = 2.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748760035569       residual = 7.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 1.055620e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748671935277       residual = 2.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748692778270       residual = 3.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748695830516       residual = 7.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748696278199       residual = 2.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748696704283       residual = 9.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748696797316       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748696787834       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748696786326       residual = 2.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748696783768       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748696778402       residual = 4.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 2.848772e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748671935277       residual = 2.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748677337025       residual = 3.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748678117176       residual = 7.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748678229423       residual = 2.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748678335044       residual = 9.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748678357047       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748678354494       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748678354147       residual = 2.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748678353536       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748678352236       residual = 3.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 7.267557e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.006404 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0651e+01
  </log>
  <optVariables href="FORM2.s000.opt.xml">
ci_01 1.083268e-01                 3 1 ON  0
ci_02 -2.421142e-02                3 1 ON  1
ci_03 -2.441139e-02                3 1 ON  2
ci_04 2.228358e-02                 3 1 ON  3
ci_05 -1.928310e-02                3 1 ON  4
ci_06 -1.955351e-02                3 1 ON  5
ci_07 2.575777e-02                 3 1 ON  6
ci_08 -4.253819e-03                3 1 ON  7
ci_09 -7.570121e-03                3 1 ON  8
ci_10 -7.716404e-03                3 1 ON  9
ci_11 1.378356e-02                 3 1 ON  10
ci_12 7.089891e-03                 3 1 ON  11
ci_13 1.382351e-02                 3 1 ON  12
ci_14 1.291833e-02                 3 1 ON  13
ci_15 5.293679e-03                 3 1 ON  14
ci_16 5.702961e-03                 3 1 ON  15
ci_17 -5.159046e-03                3 1 ON  16
ci_18 -5.552674e-03                3 1 ON  17
ci_19 1.025334e-02                 3 1 ON  18
ci_20 6.232638e-03                 3 1 ON  19
ci_21 8.459719e-03                 3 1 ON  20
ci_22 8.880713e-03                 3 1 ON  21
ci_23 4.182851e-03                 3 1 ON  22
ci_24 5.092782e-03                 3 1 ON  23
ci_25 2.980665e-03                 3 1 ON  24
ci_26 3.783646e-03                 3 1 ON  25
ci_27 3.303520e-03                 3 1 ON  26
ci_28 7.444054e-04                 3 1 ON  27
ci_29 1.173222e-03                 3 1 ON  28
ci_30 -7.163227e-04                3 1 ON  29
ci_31 1.017522e-03                 3 1 ON  30
ci_32 -6.049452e-04                3 1 ON  31
ci_33 -1.019977e-03                3 1 ON  32
ci_34 1.109506e-03                 3 1 ON  33
ci_35 1.310128e-03                 3 1 ON  34
ci_36 -5.699702e-04                3 1 ON  35
ci_37 -5.166962e-04                3 1 ON  36
ci_38 -2.668062e-04                3 1 ON  37
ci_39 -1.569767e-04                3 1 ON  38
ci_40 -1.890052e-03                3 1 ON  39
ci_41 -5.714769e-04                3 1 ON  40
ci_42 -1.640148e-03                3 1 ON  41
ci_43 -1.367148e-03                3 1 ON  42
ci_44 -2.145040e-03                3 1 ON  43
ci_45 -3.257011e-04                3 1 ON  44
ci_46 -1.658905e-03                3 1 ON  45
ci_47 1.398868e-03                 3 1 ON  46
ci_48 2.892340e-03                 3 1 ON  47
ci_49 -8.474611e-04                3 1 ON  48
ci_50 -7.934475e-04                3 1 ON  49
ci_51 -5.458520e-04                3 1 ON  50
ci_52 -5.871240e-04                3 1 ON  51
ci_53 -7.959593e-04                3 1 ON  52
ci_54 -1.093644e-03                3 1 ON  53
ci_55 -1.201142e-03                3 1 ON  54
ci_56 1.118737e-03                 3 1 ON  55
ci_57 2.099544e-03                 3 1 ON  56
ci_58 -2.554265e-04                3 1 ON  57
ci_59 -6.531073e-04                3 1 ON  58
ci_60 1.602488e-04                 3 1 ON  59
ci_61 -1.000641e-03                3 1 ON  60
ci_62 -3.870900e-04                3 1 ON  61
ci_63 -2.525850e-04                3 1 ON  62
ci_64 -6.533928e-04                3 1 ON  63
ci_65 -1.343677e-04                3 1 ON  64
ci_66 -1.380078e-04                3 1 ON  65
ci_67 -2.395198e-04                3 1 ON  66
ci_68 -1.748604e-03                3 1 ON  67
ci_69 -1.826435e-03                3 1 ON  68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -22.8006
    reference variance = 0.444796
====================================================
  Execution time = 2.7461e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5050e-01
  Total weights = 1.9645e+06
  Execution time = 3.5734e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437553629664
                                         uncertainty =       0.002604766545

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437553629664
                                         uncertainty =       0.002604766545

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467703616
  error estimate for blocks of size 2^( 2) =       0.000493661178
  error estimate for blocks of size 2^( 3) =       0.000517590242
  error estimate for blocks of size 2^( 4) =       0.000536414559
  error estimate for blocks of size 2^( 5) =       0.000548731742
  error estimate for blocks of size 2^( 6) =       0.000555163774
  error estimate for blocks of size 2^( 7) =       0.000558882562

      target function =      -0.744797419672
              le_mean =     -22.815059601098
             les_mean =     520.977600176755
             stat err =       0.000549798159
             autocorr =       1.381863379962
   target nu stat err =       0.000549798159
   target dn stat err =       0.004070507196
      target stat err =       0.003425864824
              std dev =       0.661432796863
             le_variance =       0.437493344766

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437363886454
                                         uncertainty =       0.002552034605

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437363886454
                                         uncertainty =       0.002552034605

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467602459
  error estimate for blocks of size 2^( 2) =       0.000493509195
  error estimate for blocks of size 2^( 3) =       0.000517385694
  error estimate for blocks of size 2^( 4) =       0.000536167986
  error estimate for blocks of size 2^( 5) =       0.000548464686
  error estimate for blocks of size 2^( 6) =       0.000554888151
  error estimate for blocks of size 2^( 7) =       0.000558632436

      target function =      -0.744390065052
              le_mean =     -22.815062066635
             les_mean =     520.978205747287
             stat err =       0.000549538315
             autocorr =       1.381154879192
   target nu stat err =       0.000549538315
   target dn stat err =       0.003968484800
      target stat err =       0.003339129300
              std dev =       0.661289739733
             le_variance =       0.437304119876

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437437391984
                                         uncertainty =       0.002574414962

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437437391984
                                         uncertainty =       0.002574414962

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467641631
  error estimate for blocks of size 2^( 2) =       0.000493570886
  error estimate for blocks of size 2^( 3) =       0.000517470707
  error estimate for blocks of size 2^( 4) =       0.000536271541
  error estimate for blocks of size 2^( 5) =       0.000548577524
  error estimate for blocks of size 2^( 6) =       0.000555004771
  error estimate for blocks of size 2^( 7) =       0.000558738523

      target function =      -0.744718690407
              le_mean =     -22.815059663685
             les_mean =     520.977698673863
             stat err =       0.000549648090
             autocorr =       1.381475261435
   target nu stat err =       0.000549648090
   target dn stat err =       0.004006703399
      target stat err =       0.003373155011
              std dev =       0.661345137331
             le_variance =       0.437377390671

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437537137232
                                         uncertainty =       0.002600654775

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437537137232
                                         uncertainty =       0.002600654775

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467694820
  error estimate for blocks of size 2^( 2) =       0.000493648762
  error estimate for blocks of size 2^( 3) =       0.000517574099
  error estimate for blocks of size 2^( 4) =       0.000536395491
  error estimate for blocks of size 2^( 5) =       0.000548711232
  error estimate for blocks of size 2^( 6) =       0.000555142626
  error estimate for blocks of size 2^( 7) =       0.000558863395

      target function =      -0.744857890811
              le_mean =     -22.815059409036
             les_mean =     520.977518482111
             stat err =       0.000549778186
             autocorr =       1.381814951271
   target nu stat err =       0.000549778186
   target dn stat err =       0.004060596206
      target stat err =       0.003418330198
              std dev =       0.661420357996
             le_variance =       0.437476889972


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744797419672        initial
     2.5000e-01     2.5000e+00             1.0556e-03        -0.744390065052
     1.0000e+00     1.0000e+01             2.8488e-04        -0.744718690407
     4.0000e+00     4.0000e+01             7.2676e-05        -0.744857890811  <--

*****************************************************************************
Applying the update for shift_i =   4.0000e+00     and shift_s =   4.0000e+01
*****************************************************************************

  Execution time = 4.5297e+01
  </log>
  <optVariables href="FORM2.s000.opt.xml">
ci_01                 1.081146e-01 3 1  ON 0
ci_02                -2.406183e-02 3 1  ON 1
ci_03                -2.431784e-02 3 1  ON 2
ci_04                 2.219343e-02 3 1  ON 3
ci_05                -1.917281e-02 3 1  ON 4
ci_06                -1.953604e-02 3 1  ON 5
ci_07                 2.575885e-02 3 1  ON 6
ci_08                -4.233324e-03 3 1  ON 7
ci_09                -7.555214e-03 3 1  ON 8
ci_10                -7.708292e-03 3 1  ON 9
ci_11                 1.375694e-02 3 1  ON 10
ci_12                 7.058066e-03 3 1  ON 11
ci_13                 1.381735e-02 3 1  ON 12
ci_14                 1.283907e-02 3 1  ON 13
ci_15                 5.203615e-03 3 1  ON 14
ci_16                 5.724759e-03 3 1  ON 15
ci_17                -5.056628e-03 3 1  ON 16
ci_18                -5.548969e-03 3 1  ON 17
ci_19                 1.030799e-02 3 1  ON 18
ci_20                 6.249011e-03 3 1  ON 19
ci_21                 8.477959e-03 3 1  ON 20
ci_22                 8.881970e-03 3 1  ON 21
ci_23                 4.174113e-03 3 1  ON 22
ci_24                 5.162364e-03 3 1  ON 23
ci_25                 3.003985e-03 3 1  ON 24
ci_26                 3.790221e-03 3 1  ON 25
ci_27                 3.292743e-03 3 1  ON 26
ci_28                 7.648441e-04 3 1  ON 27
ci_29                 1.183541e-03 3 1  ON 28
ci_30                -7.338049e-04 3 1  ON 29
ci_31                 1.028601e-03 3 1  ON 30
ci_32                -5.557025e-04 3 1  ON 31
ci_33                -1.030885e-03 3 1  ON 32
ci_34                 1.141111e-03 3 1  ON 33
ci_35                 1.264540e-03 3 1  ON 34
ci_36                -5.677775e-04 3 1  ON 35
ci_37                -5.190827e-04 3 1  ON 36
ci_38                -2.810492e-04 3 1  ON 37
ci_39                -1.464329e-04 3 1  ON 38
ci_40                -1.900365e-03 3 1  ON 39
ci_41                -5.298559e-04 3 1  ON 40
ci_42                -1.646304e-03 3 1  ON 41
ci_43                -1.313787e-03 3 1  ON 42
ci_44                -2.168223e-03 3 1  ON 43
ci_45                -2.819966e-04 3 1  ON 44
ci_46                -1.683055e-03 3 1  ON 45
ci_47                 1.426966e-03 3 1  ON 46
ci_48                 2.892185e-03 3 1  ON 47
ci_49                -8.523110e-04 3 1  ON 48
ci_50                -8.129998e-04 3 1  ON 49
ci_51                -5.610611e-04 3 1  ON 50
ci_52                -6.187136e-04 3 1  ON 51
ci_53                -7.999546e-04 3 1  ON 52
ci_54                -1.104894e-03 3 1  ON 53
ci_55                -1.226693e-03 3 1  ON 54
ci_56                 1.105121e-03 3 1  ON 55
ci_57                 2.090945e-03 3 1  ON 56
ci_58                -2.049003e-04 3 1  ON 57
ci_59                -6.288989e-04 3 1  ON 58
ci_60                 1.361470e-04 3 1  ON 59
ci_61                -9.911507e-04 3 1  ON 60
ci_62                -3.828823e-04 3 1  ON 61
ci_63                -2.487557e-04 3 1  ON 62
ci_64                -6.200264e-04 3 1  ON 63
ci_65                -1.141575e-04 3 1  ON 64
ci_66                -1.298472e-04 3 1  ON 65
ci_67                -2.054377e-04 3 1  ON 66
ci_68                -1.784344e-03 3 1  ON 67
ci_69                -1.811530e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5955e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2813e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -22.7583
    reference variance = 0.524499
====================================================
  Execution time = 2.5456e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5366e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5250e-01
  Total weights = 1.964818731e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5488e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438688669942
                                         uncertainty =       0.002574586992

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438688669942
                                         uncertainty =       0.002574586992

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468412403
  error estimate for blocks of size 2^( 2) =       0.000494228615
  error estimate for blocks of size 2^( 3) =       0.000518492626
  error estimate for blocks of size 2^( 4) =       0.000537153334
  error estimate for blocks of size 2^( 5) =       0.000549132740
  error estimate for blocks of size 2^( 6) =       0.000556647820
  error estimate for blocks of size 2^( 7) =       0.000560538522

      target function =      -0.743284032207
              le_mean =     -22.813810396584
             les_mean =     520.922441332314
             stat err =       0.000550868104
             autocorr =       1.383051909264
   target nu stat err =       0.000550868104
   target dn stat err =       0.003526348163
      target stat err =       0.002966389592
              std dev =       0.662435173808
             le_variance =       0.438820359498


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281381039658e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743294989333       residual = 2.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743312646510       residual = 3.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743314850534       residual = 8.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743315558422       residual = 4.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743316207411       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743316345074       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743316330474       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743316352370       residual = 4.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743316354586       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743316359608       residual = 6.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 3.446368e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743294989333       residual = 2.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743299566870       residual = 3.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743300129421       residual = 8.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743300308109       residual = 3.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743300469601       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743300502340       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743300498580       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743300503924       residual = 3.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743300504431       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743300505614       residual = 5.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 8.781244e-05

solving harmonic davidson linear method for identity shift 1.6000e+01, overlap shift 1.6000e+02 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743294989333       residual = 2.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743296144395       residual = 3.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743296285766       residual = 8.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743296330542       residual = 3.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743296370857       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743296378932       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743296377986       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743296379313       residual = 3.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743296379437       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743296379728       residual = 5.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.6000e+01 is 2.205915e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.010094 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0014e+01
  </log>
  <optVariables href="FORM2.s001.opt.xml">
ci_01                 1.082024e-01 3 1  ON 0
ci_02                -2.409705e-02 3 1  ON 1
ci_03                -2.435463e-02 3 1  ON 2
ci_04                 2.223509e-02 3 1  ON 3
ci_05                -1.917156e-02 3 1  ON 4
ci_06                -1.957169e-02 3 1  ON 5
ci_07                 2.577752e-02 3 1  ON 6
ci_08                -4.230630e-03 3 1  ON 7
ci_09                -7.558296e-03 3 1  ON 8
ci_10                -7.687693e-03 3 1  ON 9
ci_11                 1.375608e-02 3 1  ON 10
ci_12                 7.028719e-03 3 1  ON 11
ci_13                 1.381144e-02 3 1  ON 12
ci_14                 1.283117e-02 3 1  ON 13
ci_15                 5.222460e-03 3 1  ON 14
ci_16                 5.729478e-03 3 1  ON 15
ci_17                -5.057908e-03 3 1  ON 16
ci_18                -5.552683e-03 3 1  ON 17
ci_19                 1.030178e-02 3 1  ON 18
ci_20                 6.247119e-03 3 1  ON 19
ci_21                 8.476827e-03 3 1  ON 20
ci_22                 8.875262e-03 3 1  ON 21
ci_23                 4.175233e-03 3 1  ON 22
ci_24                 5.151604e-03 3 1  ON 23
ci_25                 2.994118e-03 3 1  ON 24
ci_26                 3.791935e-03 3 1  ON 25
ci_27                 3.306786e-03 3 1  ON 26
ci_28                 7.575262e-04 3 1  ON 27
ci_29                 1.184073e-03 3 1  ON 28
ci_30                -7.301858e-04 3 1  ON 29
ci_31                 1.034423e-03 3 1  ON 30
ci_32                -5.746989e-04 3 1  ON 31
ci_33                -1.030475e-03 3 1  ON 32
ci_34                 1.150989e-03 3 1  ON 33
ci_35                 1.282590e-03 3 1  ON 34
ci_36                -5.815751e-04 3 1  ON 35
ci_37                -5.237107e-04 3 1  ON 36
ci_38                -2.753281e-04 3 1  ON 37
ci_39                -1.534112e-04 3 1  ON 38
ci_40                -1.890469e-03 3 1  ON 39
ci_41                -5.333495e-04 3 1  ON 40
ci_42                -1.644057e-03 3 1  ON 41
ci_43                -1.322725e-03 3 1  ON 42
ci_44                -2.179077e-03 3 1  ON 43
ci_45                -2.809775e-04 3 1  ON 44
ci_46                -1.667473e-03 3 1  ON 45
ci_47                 1.418561e-03 3 1  ON 46
ci_48                 2.894335e-03 3 1  ON 47
ci_49                -8.539474e-04 3 1  ON 48
ci_50                -8.077074e-04 3 1  ON 49
ci_51                -5.467644e-04 3 1  ON 50
ci_52                -6.171026e-04 3 1  ON 51
ci_53                -7.996318e-04 3 1  ON 52
ci_54                -1.104633e-03 3 1  ON 53
ci_55                -1.224225e-03 3 1  ON 54
ci_56                 1.112092e-03 3 1  ON 55
ci_57                 2.090605e-03 3 1  ON 56
ci_58                -2.220187e-04 3 1  ON 57
ci_59                -6.159103e-04 3 1  ON 58
ci_60                 1.211741e-04 3 1  ON 59
ci_61                -9.886808e-04 3 1  ON 60
ci_62                -3.867108e-04 3 1  ON 61
ci_63                -2.516909e-04 3 1  ON 62
ci_64                -6.205351e-04 3 1  ON 63
ci_65                -9.821953e-05 3 1  ON 64
ci_66                -1.381335e-04 3 1  ON 65
ci_67                -2.091833e-04 3 1  ON 66
ci_68                -1.771482e-03 3 1  ON 67
ci_69                -1.808334e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -22.7519
    reference variance = 0.338333
====================================================
  Execution time = 2.4930e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4610e-01
  Total weights = 1.9646e+06
  Execution time = 3.5516e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432572056053
                                         uncertainty =       0.002041175706

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432572056053
                                         uncertainty =       0.002041175706

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465076785
  error estimate for blocks of size 2^( 2) =       0.000490939955
  error estimate for blocks of size 2^( 3) =       0.000516204582
  error estimate for blocks of size 2^( 4) =       0.000534869580
  error estimate for blocks of size 2^( 5) =       0.000546530882
  error estimate for blocks of size 2^( 6) =       0.000554407688
  error estimate for blocks of size 2^( 7) =       0.000556781900

      target function =      -0.748511960633
              le_mean =     -22.813594127322
             les_mean =     520.906266768548
             stat err =       0.000548147512
             autocorr =       1.389138577880
   target nu stat err =       0.000548147512
   target dn stat err =       0.003261776888
      target stat err =       0.002789958607
              std dev =       0.657717896628
             le_variance =       0.432592831544

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432544685748
                                         uncertainty =       0.002040881607

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432544685748
                                         uncertainty =       0.002040881607

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465061993
  error estimate for blocks of size 2^( 2) =       0.000490912204
  error estimate for blocks of size 2^( 3) =       0.000516162161
  error estimate for blocks of size 2^( 4) =       0.000534815299
  error estimate for blocks of size 2^( 5) =       0.000546467145
  error estimate for blocks of size 2^( 6) =       0.000554342622
  error estimate for blocks of size 2^( 7) =       0.000556715273

      target function =      -0.748716109553
              le_mean =     -22.813594804363
             les_mean =     520.906053863400
             stat err =       0.000548085085
             autocorr =       1.388910532551
   target nu stat err =       0.000548085085
   target dn stat err =       0.003172693041
      target stat err =       0.002718896047
              std dev =       0.657696977299
             le_variance =       0.432565313948

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432557228089
                                         uncertainty =       0.002041013880

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432557228089
                                         uncertainty =       0.002041013880

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465068773
  error estimate for blocks of size 2^( 2) =       0.000490925260
  error estimate for blocks of size 2^( 3) =       0.000516182326
  error estimate for blocks of size 2^( 4) =       0.000534841200
  error estimate for blocks of size 2^( 5) =       0.000546497601
  error estimate for blocks of size 2^( 6) =       0.000554373724
  error estimate for blocks of size 2^( 7) =       0.000556747054

      target function =      -0.748626343156
              le_mean =     -22.813594379974
             les_mean =     520.906141673309
             stat err =       0.000548114895
             autocorr =       1.389021115611
   target nu stat err =       0.000548114895
   target dn stat err =       0.003213044717
      target stat err =       0.002751101866
              std dev =       0.657706566566
             le_variance =       0.432577927704

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432570111688
                                         uncertainty =       0.002041154214

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432570111688
                                         uncertainty =       0.002041154214

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465075734
  error estimate for blocks of size 2^( 2) =       0.000490938063
  error estimate for blocks of size 2^( 3) =       0.000516201735
  error estimate for blocks of size 2^( 4) =       0.000534865961
  error estimate for blocks of size 2^( 5) =       0.000546526647
  error estimate for blocks of size 2^( 6) =       0.000554403371
  error estimate for blocks of size 2^( 7) =       0.000556777483

      target function =      -0.748532252843
              le_mean =     -22.813594144887
             les_mean =     520.906243311241
             stat err =       0.000548143365
             autocorr =       1.389123832582
   target nu stat err =       0.000548143365
   target dn stat err =       0.003255221495
      target stat err =       0.002784767025
              std dev =       0.657716411258
             le_variance =       0.432590877638


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748511960633        initial
     1.0000e+00     1.0000e+01             3.4464e-04        -0.748716109553  <--
     4.0000e+00     4.0000e+01             8.7812e-05        -0.748626343156
     1.6000e+01     1.6000e+02             2.2059e-05        -0.748532252843

*****************************************************************************
Applying the update for shift_i =   1.0000e+00     and shift_s =   1.0000e+01
*****************************************************************************

  Execution time = 4.2721e+01
  </log>
  <optVariables href="FORM2.s001.opt.xml">
ci_01                 1.084592e-01 3 1  ON 0
ci_02                -2.419795e-02 3 1  ON 1
ci_03                -2.446006e-02 3 1  ON 2
ci_04                 2.235396e-02 3 1  ON 3
ci_05                -1.916729e-02 3 1  ON 4
ci_06                -1.967375e-02 3 1  ON 5
ci_07                 2.583135e-02 3 1  ON 6
ci_08                -4.223245e-03 3 1  ON 7
ci_09                -7.567184e-03 3 1  ON 8
ci_10                -7.628342e-03 3 1  ON 9
ci_11                 1.375353e-02 3 1  ON 10
ci_12                 6.944518e-03 3 1  ON 11
ci_13                 1.379406e-02 3 1  ON 12
ci_14                 1.280769e-02 3 1  ON 13
ci_15                 5.276652e-03 3 1  ON 14
ci_16                 5.743175e-03 3 1  ON 15
ci_17                -5.061567e-03 3 1  ON 16
ci_18                -5.563471e-03 3 1  ON 17
ci_19                 1.028407e-02 3 1  ON 18
ci_20                 6.241691e-03 3 1  ON 19
ci_21                 8.473482e-03 3 1  ON 20
ci_22                 8.855760e-03 3 1  ON 21
ci_23                 4.178454e-03 3 1  ON 22
ci_24                 5.120374e-03 3 1  ON 23
ci_25                 2.965926e-03 3 1  ON 24
ci_26                 3.796911e-03 3 1  ON 25
ci_27                 3.347168e-03 3 1  ON 26
ci_28                 7.366859e-04 3 1  ON 27
ci_29                 1.185895e-03 3 1  ON 28
ci_30                -7.197080e-04 3 1  ON 29
ci_31                 1.051180e-03 3 1  ON 30
ci_32                -6.288745e-04 3 1  ON 31
ci_33                -1.029208e-03 3 1  ON 32
ci_34                 1.179248e-03 3 1  ON 33
ci_35                 1.334421e-03 3 1  ON 34
ci_36                -6.211132e-04 3 1  ON 35
ci_37                -5.369643e-04 3 1  ON 36
ci_38                -2.590429e-04 3 1  ON 37
ci_39                -1.734650e-04 3 1  ON 38
ci_40                -1.862433e-03 3 1  ON 39
ci_41                -5.431998e-04 3 1  ON 40
ci_42                -1.637545e-03 3 1  ON 41
ci_43                -1.348537e-03 3 1  ON 42
ci_44                -2.210567e-03 3 1  ON 43
ci_45                -2.781099e-04 3 1  ON 44
ci_46                -1.622958e-03 3 1  ON 45
ci_47                 1.394042e-03 3 1  ON 46
ci_48                 2.900457e-03 3 1  ON 47
ci_49                -8.587464e-04 3 1  ON 48
ci_50                -7.927197e-04 3 1  ON 49
ci_51                -5.059121e-04 3 1  ON 50
ci_52                -6.125181e-04 3 1  ON 51
ci_53                -7.988252e-04 3 1  ON 52
ci_54                -1.103867e-03 3 1  ON 53
ci_55                -1.217104e-03 3 1  ON 54
ci_56                 1.132019e-03 3 1  ON 55
ci_57                 2.089625e-03 3 1  ON 56
ci_58                -2.710984e-04 3 1  ON 57
ci_59                -5.786974e-04 3 1  ON 58
ci_60                 7.722956e-05 3 1  ON 59
ci_61                -9.812989e-04 3 1  ON 60
ci_62                -3.976143e-04 3 1  ON 61
ci_63                -2.601163e-04 3 1  ON 62
ci_64                -6.220200e-04 3 1  ON 63
ci_65                -5.264334e-05 3 1  ON 64
ci_66                -1.618675e-04 3 1  ON 65
ci_67                -2.199386e-04 3 1  ON 66
ci_68                -1.734549e-03 3 1  ON 67
ci_69                -1.799230e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2742e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2784e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -22.779
    reference variance = 0.331259
====================================================
  Execution time = 2.5425e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5361e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4933e-01
  Total weights = 1.964958863e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5526e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437233628517
                                         uncertainty =       0.002505801430

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437233628517
                                         uncertainty =       0.002505801430

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467671035
  error estimate for blocks of size 2^( 2) =       0.000493170857
  error estimate for blocks of size 2^( 3) =       0.000517693454
  error estimate for blocks of size 2^( 4) =       0.000536024810
  error estimate for blocks of size 2^( 5) =       0.000547878057
  error estimate for blocks of size 2^( 6) =       0.000555544827
  error estimate for blocks of size 2^( 7) =       0.000560373898

      target function =      -0.745906081261
              le_mean =     -22.813856716205
             les_mean =     520.921386237623
             stat err =       0.000549955398
             autocorr =       1.382846554941
   target nu stat err =       0.000549955398
   target dn stat err =       0.002788042751
      target stat err =       0.002391009303
              std dev =       0.661386720848
             le_variance =       0.437432394514


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281385671620e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745912698187       residual = 2.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745984802147       residual = 3.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745998357302       residual = 7.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746000185628       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746000793500       residual = 8.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746001034252       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746000903359       residual = 4.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746000885693       residual = 6.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746000885126       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746000886025       residual = 8.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 8.036376e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745912698187       residual = 2.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745933280895       residual = 3.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745936984187       residual = 6.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745937446515       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745937594528       residual = 7.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745937646152       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745937610802       residual = 2.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745937606812       residual = 4.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745937606769       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745937606868       residual = 5.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 2.170801e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745912698187       residual = 2.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745918033006       residual = 3.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745918980356       residual = 6.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745919095870       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745919132444       residual = 6.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745919144703       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745919135734       residual = 2.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745919134774       residual = 3.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745919134769       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745919134785       residual = 4.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 5.539500e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.013760 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9986e+01
  </log>
  <optVariables href="FORM2.s002.opt.xml">
ci_01                 1.086763e-01 3 1  ON 0
ci_02                -2.440353e-02 3 1  ON 1
ci_03                -2.455629e-02 3 1  ON 2
ci_04                 2.247976e-02 3 1  ON 3
ci_05                -1.926442e-02 3 1  ON 4
ci_06                -1.977333e-02 3 1  ON 5
ci_07                 2.583334e-02 3 1  ON 6
ci_08                -4.263711e-03 3 1  ON 7
ci_09                -7.532002e-03 3 1  ON 8
ci_10                -7.742674e-03 3 1  ON 9
ci_11                 1.375823e-02 3 1  ON 10
ci_12                 6.961376e-03 3 1  ON 11
ci_13                 1.377535e-02 3 1  ON 12
ci_14                 1.284078e-02 3 1  ON 13
ci_15                 5.365017e-03 3 1  ON 14
ci_16                 5.720474e-03 3 1  ON 15
ci_17                -5.106253e-03 3 1  ON 16
ci_18                -5.573244e-03 3 1  ON 17
ci_19                 1.021155e-02 3 1  ON 18
ci_20                 6.272912e-03 3 1  ON 19
ci_21                 8.460105e-03 3 1  ON 20
ci_22                 8.843055e-03 3 1  ON 21
ci_23                 4.164088e-03 3 1  ON 22
ci_24                 5.123673e-03 3 1  ON 23
ci_25                 2.937328e-03 3 1  ON 24
ci_26                 3.761887e-03 3 1  ON 25
ci_27                 3.388375e-03 3 1  ON 26
ci_28                 8.140321e-04 3 1  ON 27
ci_29                 1.168230e-03 3 1  ON 28
ci_30                -6.896971e-04 3 1  ON 29
ci_31                 9.667425e-04 3 1  ON 30
ci_32                -6.363305e-04 3 1  ON 31
ci_33                -9.492109e-04 3 1  ON 32
ci_34                 1.146705e-03 3 1  ON 33
ci_35                 1.260358e-03 3 1  ON 34
ci_36                -6.242603e-04 3 1  ON 35
ci_37                -5.409251e-04 3 1  ON 36
ci_38                -2.589606e-04 3 1  ON 37
ci_39                -1.826910e-04 3 1  ON 38
ci_40                -1.818274e-03 3 1  ON 39
ci_41                -6.419883e-04 3 1  ON 40
ci_42                -1.606148e-03 3 1  ON 41
ci_43                -1.445782e-03 3 1  ON 42
ci_44                -2.206552e-03 3 1  ON 43
ci_45                -2.517027e-04 3 1  ON 44
ci_46                -1.550445e-03 3 1  ON 45
ci_47                 1.450403e-03 3 1  ON 46
ci_48                 2.877536e-03 3 1  ON 47
ci_49                -8.321594e-04 3 1  ON 48
ci_50                -8.098730e-04 3 1  ON 49
ci_51                -4.598904e-04 3 1  ON 50
ci_52                -5.672778e-04 3 1  ON 51
ci_53                -8.266299e-04 3 1  ON 52
ci_54                -1.091026e-03 3 1  ON 53
ci_55                -1.193967e-03 3 1  ON 54
ci_56                 1.162485e-03 3 1  ON 55
ci_57                 2.080331e-03 3 1  ON 56
ci_58                -3.025713e-04 3 1  ON 57
ci_59                -6.046203e-04 3 1  ON 58
ci_60                 1.356173e-04 3 1  ON 59
ci_61                -9.505321e-04 3 1  ON 60
ci_62                -3.722778e-04 3 1  ON 61
ci_63                -3.007986e-04 3 1  ON 62
ci_64                -5.913640e-04 3 1  ON 63
ci_65                -9.031416e-05 3 1  ON 64
ci_66                -1.383350e-04 3 1  ON 65
ci_67                -2.729541e-04 3 1  ON 66
ci_68                -1.699171e-03 3 1  ON 67
ci_69                -1.684034e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -22.7373
    reference variance = 0.28395
====================================================
  Execution time = 2.7146e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4691e-01
  Total weights = 1.9649e+06
  Execution time = 3.5511e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436824302981
                                         uncertainty =       0.002117336970

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436824302981
                                         uncertainty =       0.002117336970

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467398899
  error estimate for blocks of size 2^( 2) =       0.000493476406
  error estimate for blocks of size 2^( 3) =       0.000517827398
  error estimate for blocks of size 2^( 4) =       0.000535481999
  error estimate for blocks of size 2^( 5) =       0.000546790324
  error estimate for blocks of size 2^( 6) =       0.000552218294
  error estimate for blocks of size 2^( 7) =       0.000556764370

      target function =      -0.747426965527
              le_mean =     -22.814782543616
             les_mean =     520.961804646580
             stat err =       0.000547813747
             autocorr =       1.373695521455
   target nu stat err =       0.000547813747
   target dn stat err =       0.002474964261
      target stat err =       0.002151763079
              std dev =       0.661001861942
             le_variance =       0.436923461491

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436835941883
                                         uncertainty =       0.002119840925

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436835941883
                                         uncertainty =       0.002119840925

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467405773
  error estimate for blocks of size 2^( 2) =       0.000493433361
  error estimate for blocks of size 2^( 3) =       0.000517732837
  error estimate for blocks of size 2^( 4) =       0.000535348794
  error estimate for blocks of size 2^( 5) =       0.000546630048
  error estimate for blocks of size 2^( 6) =       0.000552054288
  error estimate for blocks of size 2^( 7) =       0.000556582591

      target function =      -0.742778013969
              le_mean =     -22.814782954813
             les_mean =     520.967403314969
             stat err =       0.000547653930
             autocorr =       1.372853747146
   target nu stat err =       0.000547653930
   target dn stat err =       0.005905068320
      target stat err =       0.004899497328
              std dev =       0.661011583131
             le_variance =       0.436936313034

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436820080713
                                         uncertainty =       0.002118620573

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436820080713
                                         uncertainty =       0.002118620573

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467396999
  error estimate for blocks of size 2^( 2) =       0.000493447173
  error estimate for blocks of size 2^( 3) =       0.000517769001
  error estimate for blocks of size 2^( 4) =       0.000535401310
  error estimate for blocks of size 2^( 5) =       0.000546694743
  error estimate for blocks of size 2^( 6) =       0.000552115494
  error estimate for blocks of size 2^( 7) =       0.000556652163

      target function =      -0.719119617570
              le_mean =     -22.814782220423
             les_mean =     520.995800139641
             stat err =       0.000547715927
             autocorr =       1.373216149274
   target nu stat err =       0.000547715927
   target dn stat err =       0.034672207174
      target stat err =       0.026799120892
              std dev =       0.660999174416
             le_variance =       0.436919908579

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436835482863
                                         uncertainty =       0.002116713586

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436835482863
                                         uncertainty =       0.002116713586

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467404908
  error estimate for blocks of size 2^( 2) =       0.000493476539
  error estimate for blocks of size 2^( 3) =       0.000517822427
  error estimate for blocks of size 2^( 4) =       0.000535471357
  error estimate for blocks of size 2^( 5) =       0.000546776469
  error estimate for blocks of size 2^( 6) =       0.000552195659
  error estimate for blocks of size 2^( 7) =       0.000556731307

      target function =      -0.374480624685
              le_mean =     -22.814779827033
             les_mean =     521.593541542547
             stat err =       0.000547793698
             autocorr =       1.373559655469
   target nu stat err =       0.000547793698
   target dn stat err =       0.631982685067
      target stat err =       0.154839203472
              std dev =       0.661010360356
             le_variance =       0.436934696498


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747426965527        initial  <--
     2.5000e-01     2.5000e+00             8.0364e-04        -0.742778013969
     1.0000e+00     1.0000e+01             2.1708e-04        -0.719119617570
     4.0000e+00     4.0000e+01             5.5395e-05        -0.374480624685

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.8985
  </log>
  <optVariables href="FORM2.s002.opt.xml">
ci_01                 1.084592e-01 3 1  ON 0
ci_02                -2.419795e-02 3 1  ON 1
ci_03                -2.446006e-02 3 1  ON 2
ci_04                 2.235396e-02 3 1  ON 3
ci_05                -1.916729e-02 3 1  ON 4
ci_06                -1.967375e-02 3 1  ON 5
ci_07                 2.583135e-02 3 1  ON 6
ci_08                -4.223245e-03 3 1  ON 7
ci_09                -7.567184e-03 3 1  ON 8
ci_10                -7.628342e-03 3 1  ON 9
ci_11                 1.375353e-02 3 1  ON 10
ci_12                 6.944518e-03 3 1  ON 11
ci_13                 1.379406e-02 3 1  ON 12
ci_14                 1.280769e-02 3 1  ON 13
ci_15                 5.276652e-03 3 1  ON 14
ci_16                 5.743175e-03 3 1  ON 15
ci_17                -5.061567e-03 3 1  ON 16
ci_18                -5.563471e-03 3 1  ON 17
ci_19                 1.028407e-02 3 1  ON 18
ci_20                 6.241691e-03 3 1  ON 19
ci_21                 8.473482e-03 3 1  ON 20
ci_22                 8.855760e-03 3 1  ON 21
ci_23                 4.178454e-03 3 1  ON 22
ci_24                 5.120374e-03 3 1  ON 23
ci_25                 2.965926e-03 3 1  ON 24
ci_26                 3.796911e-03 3 1  ON 25
ci_27                 3.347168e-03 3 1  ON 26
ci_28                 7.366859e-04 3 1  ON 27
ci_29                 1.185895e-03 3 1  ON 28
ci_30                -7.197080e-04 3 1  ON 29
ci_31                 1.051180e-03 3 1  ON 30
ci_32                -6.288745e-04 3 1  ON 31
ci_33                -1.029208e-03 3 1  ON 32
ci_34                 1.179248e-03 3 1  ON 33
ci_35                 1.334421e-03 3 1  ON 34
ci_36                -6.211132e-04 3 1  ON 35
ci_37                -5.369643e-04 3 1  ON 36
ci_38                -2.590429e-04 3 1  ON 37
ci_39                -1.734650e-04 3 1  ON 38
ci_40                -1.862433e-03 3 1  ON 39
ci_41                -5.431998e-04 3 1  ON 40
ci_42                -1.637545e-03 3 1  ON 41
ci_43                -1.348537e-03 3 1  ON 42
ci_44                -2.210567e-03 3 1  ON 43
ci_45                -2.781099e-04 3 1  ON 44
ci_46                -1.622958e-03 3 1  ON 45
ci_47                 1.394042e-03 3 1  ON 46
ci_48                 2.900457e-03 3 1  ON 47
ci_49                -8.587464e-04 3 1  ON 48
ci_50                -7.927197e-04 3 1  ON 49
ci_51                -5.059121e-04 3 1  ON 50
ci_52                -6.125181e-04 3 1  ON 51
ci_53                -7.988252e-04 3 1  ON 52
ci_54                -1.103867e-03 3 1  ON 53
ci_55                -1.217104e-03 3 1  ON 54
ci_56                 1.132019e-03 3 1  ON 55
ci_57                 2.089625e-03 3 1  ON 56
ci_58                -2.710984e-04 3 1  ON 57
ci_59                -5.786974e-04 3 1  ON 58
ci_60                 7.722956e-05 3 1  ON 59
ci_61                -9.812989e-04 3 1  ON 60
ci_62                -3.976143e-04 3 1  ON 61
ci_63                -2.601163e-04 3 1  ON 62
ci_64                -6.220200e-04 3 1  ON 63
ci_65                -5.264334e-05 3 1  ON 64
ci_66                -1.618675e-04 3 1  ON 65
ci_67                -2.199386e-04 3 1  ON 66
ci_68                -1.734549e-03 3 1  ON 67
ci_69                -1.799230e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4891e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2775e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -22.8844
    reference variance = 0.341641
====================================================
  Execution time = 2.5647e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5342e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5201e-01
  Total weights = 1.964810148e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5657e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438302205690
                                         uncertainty =       0.002092387133

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438302205690
                                         uncertainty =       0.002092387133

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468113781
  error estimate for blocks of size 2^( 2) =       0.000493888168
  error estimate for blocks of size 2^( 3) =       0.000518372941
  error estimate for blocks of size 2^( 4) =       0.000536846332
  error estimate for blocks of size 2^( 5) =       0.000548282973
  error estimate for blocks of size 2^( 6) =       0.000555357513
  error estimate for blocks of size 2^( 7) =       0.000559449448

      target function =      -0.743685099904
              le_mean =     -22.814511584011
             les_mean =     520.953951789448
             stat err =       0.000549984066
             autocorr =       1.380375881700
   target nu stat err =       0.000549984066
   target dn stat err =       0.002736529692
      target stat err =       0.002338535167
              std dev =       0.662012857164
             le_variance =       0.438261023050


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281451158401e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743691479648       residual = 2.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743699556105       residual = 3.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743700800795       residual = 9.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743701248313       residual = 3.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743701474673       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743701530695       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743701547364       residual = 2.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743701550515       residual = 3.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743701554592       residual = 6.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+00 is 1.387256e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743691479648       residual = 2.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743693528304       residual = 3.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743693841936       residual = 9.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743693954244       residual = 3.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743694010568       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743694024324       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743694028422       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743694029197       residual = 3.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743694030197       residual = 6.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+01 is 3.495266e-05

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743691479648       residual = 2.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743691993693       residual = 3.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743692072255       residual = 9.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743692100358       residual = 3.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743692114422       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743692117845       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743692118865       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743692119058       residual = 3.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743692119307       residual = 6.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+01 is 8.755298e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.016875 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0221e+01
  </log>
  <optVariables href="FORM2.s003.opt.xml">
ci_01                 1.084942e-01 3 1  ON 0
ci_02                -2.421850e-02 3 1  ON 1
ci_03                -2.447587e-02 3 1  ON 2
ci_04                 2.236491e-02 3 1  ON 3
ci_05                -1.917295e-02 3 1  ON 4
ci_06                -1.968507e-02 3 1  ON 5
ci_07                 2.582997e-02 3 1  ON 6
ci_08                -4.225709e-03 3 1  ON 7
ci_09                -7.567626e-03 3 1  ON 8
ci_10                -7.624596e-03 3 1  ON 9
ci_11                 1.375044e-02 3 1  ON 10
ci_12                 6.951155e-03 3 1  ON 11
ci_13                 1.379374e-02 3 1  ON 12
ci_14                 1.281208e-02 3 1  ON 13
ci_15                 5.284378e-03 3 1  ON 14
ci_16                 5.745007e-03 3 1  ON 15
ci_17                -5.069674e-03 3 1  ON 16
ci_18                -5.573164e-03 3 1  ON 17
ci_19                 1.027550e-02 3 1  ON 18
ci_20                 6.245899e-03 3 1  ON 19
ci_21                 8.476559e-03 3 1  ON 20
ci_22                 8.852235e-03 3 1  ON 21
ci_23                 4.184319e-03 3 1  ON 22
ci_24                 5.113144e-03 3 1  ON 23
ci_25                 2.969606e-03 3 1  ON 24
ci_26                 3.795628e-03 3 1  ON 25
ci_27                 3.344449e-03 3 1  ON 26
ci_28                 7.477726e-04 3 1  ON 27
ci_29                 1.181757e-03 3 1  ON 28
ci_30                -7.213657e-04 3 1  ON 29
ci_31                 1.040462e-03 3 1  ON 30
ci_32                -6.340032e-04 3 1  ON 31
ci_33                -1.032933e-03 3 1  ON 32
ci_34                 1.183330e-03 3 1  ON 33
ci_35                 1.331100e-03 3 1  ON 34
ci_36                -6.205373e-04 3 1  ON 35
ci_37                -5.376442e-04 3 1  ON 36
ci_38                -2.590792e-04 3 1  ON 37
ci_39                -1.692595e-04 3 1  ON 38
ci_40                -1.858870e-03 3 1  ON 39
ci_41                -5.450599e-04 3 1  ON 40
ci_42                -1.630940e-03 3 1  ON 41
ci_43                -1.356415e-03 3 1  ON 42
ci_44                -2.215518e-03 3 1  ON 43
ci_45                -2.763964e-04 3 1  ON 44
ci_46                -1.617536e-03 3 1  ON 45
ci_47                 1.393421e-03 3 1  ON 46
ci_48                 2.898270e-03 3 1  ON 47
ci_49                -8.609973e-04 3 1  ON 48
ci_50                -7.898327e-04 3 1  ON 49
ci_51                -5.042222e-04 3 1  ON 50
ci_52                -6.095952e-04 3 1  ON 51
ci_53                -7.956737e-04 3 1  ON 52
ci_54                -1.102391e-03 3 1  ON 53
ci_55                -1.216637e-03 3 1  ON 54
ci_56                 1.130874e-03 3 1  ON 55
ci_57                 2.087628e-03 3 1  ON 56
ci_58                -2.689798e-04 3 1  ON 57
ci_59                -5.749306e-04 3 1  ON 58
ci_60                 7.699008e-05 3 1  ON 59
ci_61                -9.859103e-04 3 1  ON 60
ci_62                -3.965144e-04 3 1  ON 61
ci_63                -2.640007e-04 3 1  ON 62
ci_64                -6.176051e-04 3 1  ON 63
ci_65                -5.007807e-05 3 1  ON 64
ci_66                -1.589873e-04 3 1  ON 65
ci_67                -2.229892e-04 3 1  ON 66
ci_68                -1.728398e-03 3 1  ON 67
ci_69                -1.793410e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -23.0221
    reference variance = 3.01678
====================================================
  Execution time = 2.4881e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4627e-01
  Total weights = 1.9645e+06
  Execution time = 3.5560e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434501500313
                                         uncertainty =       0.002287358766

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434501500313
                                         uncertainty =       0.002287358766

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466146918
  error estimate for blocks of size 2^( 2) =       0.000491832630
  error estimate for blocks of size 2^( 3) =       0.000515947171
  error estimate for blocks of size 2^( 4) =       0.000534420309
  error estimate for blocks of size 2^( 5) =       0.000546774013
  error estimate for blocks of size 2^( 6) =       0.000554125290
  error estimate for blocks of size 2^( 7) =       0.000560637634

      target function =      -0.748450452881
              le_mean =     -22.814461830808
             les_mean =     520.945942917583
             stat err =       0.000548989311
             autocorr =       1.387018149703
   target nu stat err =       0.000548989311
   target dn stat err =       0.002537824698
      target stat err =       0.002207169813
              std dev =       0.659231293282
             le_variance =       0.434585898042

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434495726169
                                         uncertainty =       0.002287981126

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434495726169
                                         uncertainty =       0.002287981126

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466143978
  error estimate for blocks of size 2^( 2) =       0.000491823150
  error estimate for blocks of size 2^( 3) =       0.000515931139
  error estimate for blocks of size 2^( 4) =       0.000534399241
  error estimate for blocks of size 2^( 5) =       0.000546750695
  error estimate for blocks of size 2^( 6) =       0.000554101894
  error estimate for blocks of size 2^( 7) =       0.000560611177

      target function =      -0.748480860372
              le_mean =     -22.814462308752
             les_mean =     520.945928357885
             stat err =       0.000548965752
             autocorr =       1.386916599658
   target nu stat err =       0.000548965752
   target dn stat err =       0.002533725673
      target stat err =       0.002204046262
              std dev =       0.659227135779
             le_variance =       0.434580416548

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434498435169
                                         uncertainty =       0.002287673965

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434498435169
                                         uncertainty =       0.002287673965

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466145353
  error estimate for blocks of size 2^( 2) =       0.000491827754
  error estimate for blocks of size 2^( 3) =       0.000515938973
  error estimate for blocks of size 2^( 4) =       0.000534409565
  error estimate for blocks of size 2^( 5) =       0.000546762138
  error estimate for blocks of size 2^( 6) =       0.000554113382
  error estimate for blocks of size 2^( 7) =       0.000560624163

      target function =      -0.748450356685
              le_mean =     -22.814462055661
             les_mean =     520.945953305616
             stat err =       0.000548977312
             autocorr =       1.386966827755
   target nu stat err =       0.000548977312
   target dn stat err =       0.002535618235
      target stat err =       0.002205395281
              std dev =       0.659229080623
             le_variance =       0.434582980739

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434501101465
                                         uncertainty =       0.002287398155

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434501101465
                                         uncertainty =       0.002287398155

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466146714
  error estimate for blocks of size 2^( 2) =       0.000491832012
  error estimate for blocks of size 2^( 3) =       0.000515946135
  error estimate for blocks of size 2^( 4) =       0.000534418953
  error estimate for blocks of size 2^( 5) =       0.000546772515
  error estimate for blocks of size 2^( 6) =       0.000554123787
  error estimate for blocks of size 2^( 7) =       0.000560635932

      target function =      -0.748454101673
              le_mean =     -22.814461856559
             les_mean =     520.945939727334
             stat err =       0.000548987797
             autocorr =       1.387011709257
   target nu stat err =       0.000548987797
   target dn stat err =       0.002537498324
      target stat err =       0.002206928147
              std dev =       0.659231004820
             le_variance =       0.434585517716


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748450452881        initial
     2.5000e+00     2.5000e+01             1.3873e-04        -0.748480860372  <--
     1.0000e+01     1.0000e+02             3.4953e-05        -0.748450356685
     4.0000e+01     4.0000e+02             8.7553e-06        -0.748454101673

*****************************************************************************
Applying the update for shift_i =   2.5000e+00     and shift_s =   2.5000e+01
*****************************************************************************

  Execution time = 4.2667e+01
  </log>
  <optVariables href="FORM2.s003.opt.xml">
ci_01                 1.085979e-01 3 1  ON 0
ci_02                -2.427907e-02 3 1  ON 1
ci_03                -2.452247e-02 3 1  ON 2
ci_04                 2.239709e-02 3 1  ON 3
ci_05                -1.918956e-02 3 1  ON 4
ci_06                -1.971835e-02 3 1  ON 5
ci_07                 2.582588e-02 3 1  ON 6
ci_08                -4.233005e-03 3 1  ON 7
ci_09                -7.568936e-03 3 1  ON 8
ci_10                -7.613544e-03 3 1  ON 9
ci_11                 1.374125e-02 3 1  ON 10
ci_12                 6.970684e-03 3 1  ON 11
ci_13                 1.379274e-02 3 1  ON 12
ci_14                 1.282510e-02 3 1  ON 13
ci_15                 5.307180e-03 3 1  ON 14
ci_16                 5.750412e-03 3 1  ON 15
ci_17                -5.093592e-03 3 1  ON 16
ci_18                -5.601760e-03 3 1  ON 17
ci_19                 1.025030e-02 3 1  ON 18
ci_20                 6.258288e-03 3 1  ON 19
ci_21                 8.485672e-03 3 1  ON 20
ci_22                 8.841819e-03 3 1  ON 21
ci_23                 4.201563e-03 3 1  ON 22
ci_24                 5.091701e-03 3 1  ON 23
ci_25                 2.980435e-03 3 1  ON 24
ci_26                 3.791849e-03 3 1  ON 25
ci_27                 3.336426e-03 3 1  ON 26
ci_28                 7.804936e-04 3 1  ON 27
ci_29                 1.169593e-03 3 1  ON 28
ci_30                -7.262987e-04 3 1  ON 29
ci_31                 1.008719e-03 3 1  ON 30
ci_32                -6.490732e-04 3 1  ON 31
ci_33                -1.043891e-03 3 1  ON 32
ci_34                 1.195345e-03 3 1  ON 33
ci_35                 1.321286e-03 3 1  ON 34
ci_36                -6.188656e-04 3 1  ON 35
ci_37                -5.396451e-04 3 1  ON 36
ci_38                -2.592010e-04 3 1  ON 37
ci_39                -1.568880e-04 3 1  ON 38
ci_40                -1.848417e-03 3 1  ON 39
ci_41                -5.505236e-04 3 1  ON 40
ci_42                -1.611508e-03 3 1  ON 41
ci_43                -1.379675e-03 3 1  ON 42
ci_44                -2.230134e-03 3 1  ON 43
ci_45                -2.713563e-04 3 1  ON 44
ci_46                -1.601595e-03 3 1  ON 45
ci_47                 1.391534e-03 3 1  ON 46
ci_48                 2.891761e-03 3 1  ON 47
ci_49                -8.676378e-04 3 1  ON 48
ci_50                -7.813660e-04 3 1  ON 49
ci_51                -4.992467e-04 3 1  ON 50
ci_52                -6.010010e-04 3 1  ON 51
ci_53                -7.864301e-04 3 1  ON 52
ci_54                -1.098058e-03 3 1  ON 53
ci_55                -1.215279e-03 3 1  ON 54
ci_56                 1.127513e-03 3 1  ON 55
ci_57                 2.081765e-03 3 1  ON 56
ci_58                -2.627408e-04 3 1  ON 57
ci_59                -5.638307e-04 3 1  ON 58
ci_60                 7.628474e-05 3 1  ON 59
ci_61                -9.996101e-04 3 1  ON 60
ci_62                -3.932892e-04 3 1  ON 61
ci_63                -2.754059e-04 3 1  ON 62
ci_64                -6.046209e-04 3 1  ON 63
ci_65                -4.253464e-05 3 1  ON 64
ci_66                -1.505185e-04 3 1  ON 65
ci_67                -2.319518e-04 3 1  ON 66
ci_68                -1.710292e-03 3 1  ON 67
ci_69                -1.776253e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2895e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2820e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -22.9106
    reference variance = 0.395399
====================================================
  Execution time = 2.5536e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5367e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4700e-01
  Total weights = 1.964645766e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5627e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433762958319
                                         uncertainty =       0.002016030469

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433762958319
                                         uncertainty =       0.002016030469

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465700954
  error estimate for blocks of size 2^( 2) =       0.000491283757
  error estimate for blocks of size 2^( 3) =       0.000515414872
  error estimate for blocks of size 2^( 4) =       0.000534060229
  error estimate for blocks of size 2^( 5) =       0.000544621069
  error estimate for blocks of size 2^( 6) =       0.000549591597
  error estimate for blocks of size 2^( 7) =       0.000553937440

      target function =      -0.747844480971
              le_mean =     -22.814931547718
             les_mean =     520.968101932184
             stat err =       0.000545552583
             autocorr =       1.372331329052
   target nu stat err =       0.000545552583
   target dn stat err =       0.002756750561
      target stat err =       0.002380390742
              std dev =       0.658600605374
             le_variance =       0.433754757400


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281493154772e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747850985625       residual = 2.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747880070687       residual = 3.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747886235619       residual = 7.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747887763911       residual = 2.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747888291841       residual = 8.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747888502382       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747888539338       residual = 2.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747888528991       residual = 5.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747888525133       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747888525400       residual = 2.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-01 is 5.181466e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747850985625       residual = 2.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747858683574       residual = 3.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747860277257       residual = 6.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747860661531       residual = 2.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747860789856       residual = 7.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747860839755       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747860847934       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747860845358       residual = 4.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747860844492       residual = 9.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+00 is 1.334553e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747850985625       residual = 2.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747852938764       residual = 3.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747853340558       residual = 6.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747853436717       residual = 2.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747853468539       residual = 7.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747853480830       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747853482807       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747853482165       residual = 4.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747853481955       residual = 9.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+01 is 3.362588e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.020184 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0108e+01
  </log>
  <optVariables href="FORM2.s004.opt.xml">
ci_01                 1.087314e-01 3 1  ON 0
ci_02                -2.436946e-02 3 1  ON 1
ci_03                -2.457915e-02 3 1  ON 2
ci_04                 2.244198e-02 3 1  ON 3
ci_05                -1.922061e-02 3 1  ON 4
ci_06                -1.972220e-02 3 1  ON 5
ci_07                 2.580472e-02 3 1  ON 6
ci_08                -4.231284e-03 3 1  ON 7
ci_09                -7.582064e-03 3 1  ON 8
ci_10                -7.603276e-03 3 1  ON 9
ci_11                 1.371845e-02 3 1  ON 10
ci_12                 6.979565e-03 3 1  ON 11
ci_13                 1.378441e-02 3 1  ON 12
ci_14                 1.282604e-02 3 1  ON 13
ci_15                 5.340573e-03 3 1  ON 14
ci_16                 5.762982e-03 3 1  ON 15
ci_17                -5.124410e-03 3 1  ON 16
ci_18                -5.609453e-03 3 1  ON 17
ci_19                 1.023818e-02 3 1  ON 18
ci_20                 6.291260e-03 3 1  ON 19
ci_21                 8.487829e-03 3 1  ON 20
ci_22                 8.831074e-03 3 1  ON 21
ci_23                 4.209193e-03 3 1  ON 22
ci_24                 5.038279e-03 3 1  ON 23
ci_25                 2.990407e-03 3 1  ON 24
ci_26                 3.757669e-03 3 1  ON 25
ci_27                 3.333851e-03 3 1  ON 26
ci_28                 7.815988e-04 3 1  ON 27
ci_29                 1.180371e-03 3 1  ON 28
ci_30                -7.378710e-04 3 1  ON 29
ci_31                 9.908303e-04 3 1  ON 30
ci_32                -6.519951e-04 3 1  ON 31
ci_33                -1.053980e-03 3 1  ON 32
ci_34                 1.178660e-03 3 1  ON 33
ci_35                 1.321678e-03 3 1  ON 34
ci_36                -6.228544e-04 3 1  ON 35
ci_37                -5.569563e-04 3 1  ON 36
ci_38                -2.661262e-04 3 1  ON 37
ci_39                -1.744758e-04 3 1  ON 38
ci_40                -1.834811e-03 3 1  ON 39
ci_41                -5.628237e-04 3 1  ON 40
ci_42                -1.623450e-03 3 1  ON 41
ci_43                -1.383083e-03 3 1  ON 42
ci_44                -2.180980e-03 3 1  ON 43
ci_45                -2.647019e-04 3 1  ON 44
ci_46                -1.589189e-03 3 1  ON 45
ci_47                 1.421773e-03 3 1  ON 46
ci_48                 2.878929e-03 3 1  ON 47
ci_49                -8.747253e-04 3 1  ON 48
ci_50                -7.811869e-04 3 1  ON 49
ci_51                -4.735643e-04 3 1  ON 50
ci_52                -5.929893e-04 3 1  ON 51
ci_53                -7.973521e-04 3 1  ON 52
ci_54                -1.090089e-03 3 1  ON 53
ci_55                -1.227579e-03 3 1  ON 54
ci_56                 1.146844e-03 3 1  ON 55
ci_57                 2.070113e-03 3 1  ON 56
ci_58                -2.540684e-04 3 1  ON 57
ci_59                -5.775699e-04 3 1  ON 58
ci_60                 7.286913e-05 3 1  ON 59
ci_61                -9.882243e-04 3 1  ON 60
ci_62                -4.092298e-04 3 1  ON 61
ci_63                -2.704668e-04 3 1  ON 62
ci_64                -5.978488e-04 3 1  ON 63
ci_65                -3.071664e-05 3 1  ON 64
ci_66                -1.570427e-04 3 1  ON 65
ci_67                -2.460078e-04 3 1  ON 66
ci_68                -1.733313e-03 3 1  ON 67
ci_69                -1.759105e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -22.8739
    reference variance = 0.63078
====================================================
  Execution time = 2.6960e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4149e-01
  Total weights = 1.9648e+06
  Execution time = 3.5550e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.430644737255
                                         uncertainty =       0.001948657312

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.430644737255
                                         uncertainty =       0.001948657312

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464119380
  error estimate for blocks of size 2^( 2) =       0.000489516507
  error estimate for blocks of size 2^( 3) =       0.000513487566
  error estimate for blocks of size 2^( 4) =       0.000531752123
  error estimate for blocks of size 2^( 5) =       0.000544328291
  error estimate for blocks of size 2^( 6) =       0.000550016717
  error estimate for blocks of size 2^( 7) =       0.000553485183

      target function =      -0.752344629442
              le_mean =     -22.813838962057
             les_mean =     520.912879329794
             stat err =       0.000544895579
             autocorr =       1.378374279082
   target nu stat err =       0.000544895579
   target dn stat err =       0.002278083897
      target stat err =       0.002016204307
              std dev =       0.656363922438
             le_variance =       0.430813598679

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.430612220013
                                         uncertainty =       0.001945926028

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.430612220013
                                         uncertainty =       0.001945926028

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464102077
  error estimate for blocks of size 2^( 2) =       0.000489476870
  error estimate for blocks of size 2^( 3) =       0.000513425718
  error estimate for blocks of size 2^( 4) =       0.000531671088
  error estimate for blocks of size 2^( 5) =       0.000544234753
  error estimate for blocks of size 2^( 6) =       0.000549917684
  error estimate for blocks of size 2^( 7) =       0.000553377083

      target function =      -0.750227179787
              le_mean =     -22.813839938612
             les_mean =     520.915433038087
             stat err =       0.000544800152
             autocorr =       1.377994285771
   target nu stat err =       0.000544800152
   target dn stat err =       0.003575820884
      target stat err =       0.003060300722
              std dev =       0.656339451222
             le_variance =       0.430781475230

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.430625670160
                                         uncertainty =       0.001947186130

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.430625670160
                                         uncertainty =       0.001947186130

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464109221
  error estimate for blocks of size 2^( 2) =       0.000489494494
  error estimate for blocks of size 2^( 3) =       0.000513454082
  error estimate for blocks of size 2^( 4) =       0.000531709005
  error estimate for blocks of size 2^( 5) =       0.000544278867
  error estimate for blocks of size 2^( 6) =       0.000549964072
  error estimate for blocks of size 2^( 7) =       0.000553428911

      target function =      -0.751917918772
              le_mean =     -22.813839466684
             les_mean =     520.913408345736
             stat err =       0.000544845214
             autocorr =       1.378179822238
   target nu stat err =       0.000544845214
   target dn stat err =       0.002320682637
      target stat err =       0.002048237100
              std dev =       0.656349554172
             le_variance =       0.430794737261

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.430642101769
                                         uncertainty =       0.001948465963

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.430642101769
                                         uncertainty =       0.001948465963

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464117975
  error estimate for blocks of size 2^( 2) =       0.000489513622
  error estimate for blocks of size 2^( 3) =       0.000513483195
  error estimate for blocks of size 2^( 4) =       0.000531746459
  error estimate for blocks of size 2^( 5) =       0.000544321849
  error estimate for blocks of size 2^( 6) =       0.000550009852
  error estimate for blocks of size 2^( 7) =       0.000553477942

      target function =      -0.751106671811
              le_mean =     -22.813838971531
             les_mean =     520.914347341439
             stat err =       0.000544889025
             autocorr =       1.378349473039
   target nu stat err =       0.000544889025
   target dn stat err =       0.002742920014
      target stat err =       0.002385182471
              std dev =       0.656361934680
             le_variance =       0.430810989296


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.752344629442        initial  <--
     6.2500e-01     6.2500e+00             5.1815e-04        -0.750227179787
     2.5000e+00     2.5000e+01             1.3346e-04        -0.751917918772
     1.0000e+01     1.0000e+02             3.3626e-05        -0.751106671811

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.7738
  </log>
  <optVariables href="FORM2.s004.opt.xml">
ci_01                 1.085979e-01 3 1  ON 0
ci_02                -2.427907e-02 3 1  ON 1
ci_03                -2.452247e-02 3 1  ON 2
ci_04                 2.239709e-02 3 1  ON 3
ci_05                -1.918956e-02 3 1  ON 4
ci_06                -1.971835e-02 3 1  ON 5
ci_07                 2.582588e-02 3 1  ON 6
ci_08                -4.233005e-03 3 1  ON 7
ci_09                -7.568936e-03 3 1  ON 8
ci_10                -7.613544e-03 3 1  ON 9
ci_11                 1.374125e-02 3 1  ON 10
ci_12                 6.970684e-03 3 1  ON 11
ci_13                 1.379274e-02 3 1  ON 12
ci_14                 1.282510e-02 3 1  ON 13
ci_15                 5.307180e-03 3 1  ON 14
ci_16                 5.750412e-03 3 1  ON 15
ci_17                -5.093592e-03 3 1  ON 16
ci_18                -5.601760e-03 3 1  ON 17
ci_19                 1.025030e-02 3 1  ON 18
ci_20                 6.258288e-03 3 1  ON 19
ci_21                 8.485672e-03 3 1  ON 20
ci_22                 8.841819e-03 3 1  ON 21
ci_23                 4.201563e-03 3 1  ON 22
ci_24                 5.091701e-03 3 1  ON 23
ci_25                 2.980435e-03 3 1  ON 24
ci_26                 3.791849e-03 3 1  ON 25
ci_27                 3.336426e-03 3 1  ON 26
ci_28                 7.804936e-04 3 1  ON 27
ci_29                 1.169593e-03 3 1  ON 28
ci_30                -7.262987e-04 3 1  ON 29
ci_31                 1.008719e-03 3 1  ON 30
ci_32                -6.490732e-04 3 1  ON 31
ci_33                -1.043891e-03 3 1  ON 32
ci_34                 1.195345e-03 3 1  ON 33
ci_35                 1.321286e-03 3 1  ON 34
ci_36                -6.188656e-04 3 1  ON 35
ci_37                -5.396451e-04 3 1  ON 36
ci_38                -2.592010e-04 3 1  ON 37
ci_39                -1.568880e-04 3 1  ON 38
ci_40                -1.848417e-03 3 1  ON 39
ci_41                -5.505236e-04 3 1  ON 40
ci_42                -1.611508e-03 3 1  ON 41
ci_43                -1.379675e-03 3 1  ON 42
ci_44                -2.230134e-03 3 1  ON 43
ci_45                -2.713563e-04 3 1  ON 44
ci_46                -1.601595e-03 3 1  ON 45
ci_47                 1.391534e-03 3 1  ON 46
ci_48                 2.891761e-03 3 1  ON 47
ci_49                -8.676378e-04 3 1  ON 48
ci_50                -7.813660e-04 3 1  ON 49
ci_51                -4.992467e-04 3 1  ON 50
ci_52                -6.010010e-04 3 1  ON 51
ci_53                -7.864301e-04 3 1  ON 52
ci_54                -1.098058e-03 3 1  ON 53
ci_55                -1.215279e-03 3 1  ON 54
ci_56                 1.127513e-03 3 1  ON 55
ci_57                 2.081765e-03 3 1  ON 56
ci_58                -2.627408e-04 3 1  ON 57
ci_59                -5.638307e-04 3 1  ON 58
ci_60                 7.628474e-05 3 1  ON 59
ci_61                -9.996101e-04 3 1  ON 60
ci_62                -3.932892e-04 3 1  ON 61
ci_63                -2.754059e-04 3 1  ON 62
ci_64                -6.046209e-04 3 1  ON 63
ci_65                -4.253464e-05 3 1  ON 64
ci_66                -1.505185e-04 3 1  ON 65
ci_67                -2.319518e-04 3 1  ON 66
ci_68                -1.710292e-03 3 1  ON 67
ci_69                -1.776253e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4889e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2834e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -22.8777
    reference variance = 0.330384
====================================================
  Execution time = 2.6315e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5329e+04
  VMC Eavg = -2.2813e+01
  VMC Evar = 4.4910e-01
  Total weights = 1.964979183e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5558e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435256598318
                                         uncertainty =       0.002213800295

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435256598318
                                         uncertainty =       0.002213800295

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466455351
  error estimate for blocks of size 2^( 2) =       0.000492146520
  error estimate for blocks of size 2^( 3) =       0.000516263646
  error estimate for blocks of size 2^( 4) =       0.000533989778
  error estimate for blocks of size 2^( 5) =       0.000546251320
  error estimate for blocks of size 2^( 6) =       0.000552567378
  error estimate for blocks of size 2^( 7) =       0.000555103466

      target function =      -0.746085309994
              le_mean =     -22.813304421185
             les_mean =     520.895960281922
             stat err =       0.000546977985
             autocorr =       1.375053310507
   target nu stat err =       0.000546977985
   target dn stat err =       0.003987794738
      target stat err =       0.003360545410
              std dev =       0.659667483488
             le_variance =       0.435161188772


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281330442119e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746099276584       residual = 2.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746103145793       residual = 4.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746103801772       residual = 6.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746103931701       residual = 2.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746103998508       residual = 8.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746103991307       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746103991116       residual = 2.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746103990966       residual = 4.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746103992053       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746103992274       residual = 7.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+00 is 5.113384e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746099276584       residual = 2.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746100249765       residual = 4.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746100414340       residual = 6.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746100446834       residual = 2.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746100463492       residual = 8.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746100461670       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746100461620       residual = 2.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746100461584       residual = 4.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746100461855       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746100461910       residual = 7.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+01 is 1.282281e-05

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746099276584       residual = 2.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746099520249       residual = 4.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746099561429       residual = 6.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746099569553       residual = 2.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746099573715       residual = 8.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746099573258       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746099573246       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746099573237       residual = 4.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746099573304       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746099573318       residual = 6.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+02 is 3.208171e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.023754 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0880e+01
  </log>
  <optVariables href="FORM2.s005.opt.xml">
ci_01                 1.086108e-01 3 1  ON 0
ci_02                -2.428806e-02 3 1  ON 1
ci_03                -2.452727e-02 3 1  ON 2
ci_04                 2.240292e-02 3 1  ON 3
ci_05                -1.918851e-02 3 1  ON 4
ci_06                -1.971977e-02 3 1  ON 5
ci_07                 2.582627e-02 3 1  ON 6
ci_08                -4.235596e-03 3 1  ON 7
ci_09                -7.570931e-03 3 1  ON 8
ci_10                -7.613177e-03 3 1  ON 9
ci_11                 1.373955e-02 3 1  ON 10
ci_12                 6.971015e-03 3 1  ON 11
ci_13                 1.379094e-02 3 1  ON 12
ci_14                 1.282519e-02 3 1  ON 13
ci_15                 5.305632e-03 3 1  ON 14
ci_16                 5.753664e-03 3 1  ON 15
ci_17                -5.092735e-03 3 1  ON 16
ci_18                -5.601802e-03 3 1  ON 17
ci_19                 1.025001e-02 3 1  ON 18
ci_20                 6.253718e-03 3 1  ON 19
ci_21                 8.485744e-03 3 1  ON 20
ci_22                 8.841301e-03 3 1  ON 21
ci_23                 4.203144e-03 3 1  ON 22
ci_24                 5.090119e-03 3 1  ON 23
ci_25                 2.980205e-03 3 1  ON 24
ci_26                 3.792533e-03 3 1  ON 25
ci_27                 3.336226e-03 3 1  ON 26
ci_28                 7.830234e-04 3 1  ON 27
ci_29                 1.172423e-03 3 1  ON 28
ci_30                -7.253318e-04 3 1  ON 29
ci_31                 1.006744e-03 3 1  ON 30
ci_32                -6.530299e-04 3 1  ON 31
ci_33                -1.043434e-03 3 1  ON 32
ci_34                 1.200953e-03 3 1  ON 33
ci_35                 1.321647e-03 3 1  ON 34
ci_36                -6.193254e-04 3 1  ON 35
ci_37                -5.405426e-04 3 1  ON 36
ci_38                -2.602214e-04 3 1  ON 37
ci_39                -1.573740e-04 3 1  ON 38
ci_40                -1.846535e-03 3 1  ON 39
ci_41                -5.505919e-04 3 1  ON 40
ci_42                -1.610990e-03 3 1  ON 41
ci_43                -1.374548e-03 3 1  ON 42
ci_44                -2.228480e-03 3 1  ON 43
ci_45                -2.718712e-04 3 1  ON 44
ci_46                -1.600931e-03 3 1  ON 45
ci_47                 1.392989e-03 3 1  ON 46
ci_48                 2.891845e-03 3 1  ON 47
ci_49                -8.650951e-04 3 1  ON 48
ci_50                -7.817652e-04 3 1  ON 49
ci_51                -4.963006e-04 3 1  ON 50
ci_52                -5.990318e-04 3 1  ON 51
ci_53                -7.864134e-04 3 1  ON 52
ci_54                -1.099018e-03 3 1  ON 53
ci_55                -1.212700e-03 3 1  ON 54
ci_56                 1.130368e-03 3 1  ON 55
ci_57                 2.082223e-03 3 1  ON 56
ci_58                -2.616473e-04 3 1  ON 57
ci_59                -5.636834e-04 3 1  ON 58
ci_60                 7.291266e-05 3 1  ON 59
ci_61                -1.002101e-03 3 1  ON 60
ci_62                -3.927591e-04 3 1  ON 61
ci_63                -2.767941e-04 3 1  ON 62
ci_64                -6.057423e-04 3 1  ON 63
ci_65                -4.010861e-05 3 1  ON 64
ci_66                -1.509150e-04 3 1  ON 65
ci_67                -2.334273e-04 3 1  ON 66
ci_68                -1.708334e-03 3 1  ON 67
ci_69                -1.776781e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -22.7784
    reference variance = 0.369602
====================================================
  Execution time = 2.4822e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4269e-01
  Total weights = 1.9650e+06
  Execution time = 3.5499e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432495395149
                                         uncertainty =       0.001656074666

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432495395149
                                         uncertainty =       0.001656074666

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465034473
  error estimate for blocks of size 2^( 2) =       0.000490759439
  error estimate for blocks of size 2^( 3) =       0.000515028346
  error estimate for blocks of size 2^( 4) =       0.000534053306
  error estimate for blocks of size 2^( 5) =       0.000545228583
  error estimate for blocks of size 2^( 6) =       0.000550852612
  error estimate for blocks of size 2^( 7) =       0.000554715064

      target function =      -0.751450125171
              le_mean =     -22.814049729523
             les_mean =     520.923559746690
             stat err =       0.000546212391
             autocorr =       1.379598775340
   target nu stat err =       0.000546212391
   target dn stat err =       0.002395819941
      target stat err =       0.002107338760
              std dev =       0.657658058368
             le_variance =       0.432514121736

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432492640114
                                         uncertainty =       0.001656447058

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432492640114
                                         uncertainty =       0.001656447058

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465032993
  error estimate for blocks of size 2^( 2) =       0.000490755319
  error estimate for blocks of size 2^( 3) =       0.000515021842
  error estimate for blocks of size 2^( 4) =       0.000534045084
  error estimate for blocks of size 2^( 5) =       0.000545219439
  error estimate for blocks of size 2^( 6) =       0.000550843301
  error estimate for blocks of size 2^( 7) =       0.000554705927

      target function =      -0.751451559097
              le_mean =     -22.814049575162
             les_mean =     520.923551003515
             stat err =       0.000546203438
             autocorr =       1.379562325270
   target nu stat err =       0.000546203438
   target dn stat err =       0.002394829882
      target stat err =       0.002106545622
              std dev =       0.657655965841
             le_variance =       0.432511369406

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432493991908
                                         uncertainty =       0.001656261632

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432493991908
                                         uncertainty =       0.001656261632

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465033719
  error estimate for blocks of size 2^( 2) =       0.000490757358
  error estimate for blocks of size 2^( 3) =       0.000515025067
  error estimate for blocks of size 2^( 4) =       0.000534049164
  error estimate for blocks of size 2^( 5) =       0.000545223978
  error estimate for blocks of size 2^( 6) =       0.000550847921
  error estimate for blocks of size 2^( 7) =       0.000554710460

      target function =      -0.751452731048
              le_mean =     -22.814049648698
             les_mean =     520.923552964784
             stat err =       0.000546207881
             autocorr =       1.379580463307
   target nu stat err =       0.000546207881
   target dn stat err =       0.002395294395
      target stat err =       0.002106927733
              std dev =       0.657656992507
             le_variance =       0.432512719793

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432495217517
                                         uncertainty =       0.001656098045

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432495217517
                                         uncertainty =       0.001656098045

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465034377
  error estimate for blocks of size 2^( 2) =       0.000490759178
  error estimate for blocks of size 2^( 3) =       0.000515027934
  error estimate for blocks of size 2^( 4) =       0.000534052786
  error estimate for blocks of size 2^( 5) =       0.000545228006
  error estimate for blocks of size 2^( 6) =       0.000550852023
  error estimate for blocks of size 2^( 7) =       0.000554714487

      target function =      -0.751450628200
              le_mean =     -22.814049719064
             les_mean =     520.923558672103
             stat err =       0.000546211826
             autocorr =       1.379596483903
   target nu stat err =       0.000546211826
   target dn stat err =       0.002395751611
      target stat err =       0.002107286209
              std dev =       0.657657923440
             le_variance =       0.432513944263


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.751450125171        initial
     6.2500e+00     6.2500e+01             5.1134e-05        -0.751451559097
     2.5000e+01     2.5000e+02             1.2823e-05        -0.751452731048  <--
     1.0000e+02     1.0000e+03             3.2082e-06        -0.751450628200

*****************************************************************************
Applying the update for shift_i =   2.5000e+01     and shift_s =   2.5000e+02
*****************************************************************************

  Execution time = 4.2611e+01
  </log>
  <optVariables href="FORM2.s005.opt.xml">
ci_01                 1.086108e-01 3 1  ON 0
ci_02                -2.428806e-02 3 1  ON 1
ci_03                -2.452727e-02 3 1  ON 2
ci_04                 2.240292e-02 3 1  ON 3
ci_05                -1.918851e-02 3 1  ON 4
ci_06                -1.971977e-02 3 1  ON 5
ci_07                 2.582627e-02 3 1  ON 6
ci_08                -4.235596e-03 3 1  ON 7
ci_09                -7.570931e-03 3 1  ON 8
ci_10                -7.613177e-03 3 1  ON 9
ci_11                 1.373955e-02 3 1  ON 10
ci_12                 6.971015e-03 3 1  ON 11
ci_13                 1.379094e-02 3 1  ON 12
ci_14                 1.282519e-02 3 1  ON 13
ci_15                 5.305632e-03 3 1  ON 14
ci_16                 5.753664e-03 3 1  ON 15
ci_17                -5.092735e-03 3 1  ON 16
ci_18                -5.601802e-03 3 1  ON 17
ci_19                 1.025001e-02 3 1  ON 18
ci_20                 6.253718e-03 3 1  ON 19
ci_21                 8.485744e-03 3 1  ON 20
ci_22                 8.841301e-03 3 1  ON 21
ci_23                 4.203144e-03 3 1  ON 22
ci_24                 5.090119e-03 3 1  ON 23
ci_25                 2.980205e-03 3 1  ON 24
ci_26                 3.792533e-03 3 1  ON 25
ci_27                 3.336226e-03 3 1  ON 26
ci_28                 7.830234e-04 3 1  ON 27
ci_29                 1.172423e-03 3 1  ON 28
ci_30                -7.253318e-04 3 1  ON 29
ci_31                 1.006744e-03 3 1  ON 30
ci_32                -6.530299e-04 3 1  ON 31
ci_33                -1.043434e-03 3 1  ON 32
ci_34                 1.200953e-03 3 1  ON 33
ci_35                 1.321647e-03 3 1  ON 34
ci_36                -6.193254e-04 3 1  ON 35
ci_37                -5.405426e-04 3 1  ON 36
ci_38                -2.602214e-04 3 1  ON 37
ci_39                -1.573740e-04 3 1  ON 38
ci_40                -1.846535e-03 3 1  ON 39
ci_41                -5.505919e-04 3 1  ON 40
ci_42                -1.610990e-03 3 1  ON 41
ci_43                -1.374548e-03 3 1  ON 42
ci_44                -2.228480e-03 3 1  ON 43
ci_45                -2.718712e-04 3 1  ON 44
ci_46                -1.600931e-03 3 1  ON 45
ci_47                 1.392989e-03 3 1  ON 46
ci_48                 2.891845e-03 3 1  ON 47
ci_49                -8.650951e-04 3 1  ON 48
ci_50                -7.817652e-04 3 1  ON 49
ci_51                -4.963006e-04 3 1  ON 50
ci_52                -5.990318e-04 3 1  ON 51
ci_53                -7.864134e-04 3 1  ON 52
ci_54                -1.099018e-03 3 1  ON 53
ci_55                -1.212700e-03 3 1  ON 54
ci_56                 1.130368e-03 3 1  ON 55
ci_57                 2.082223e-03 3 1  ON 56
ci_58                -2.616473e-04 3 1  ON 57
ci_59                -5.636834e-04 3 1  ON 58
ci_60                 7.291266e-05 3 1  ON 59
ci_61                -1.002101e-03 3 1  ON 60
ci_62                -3.927591e-04 3 1  ON 61
ci_63                -2.767941e-04 3 1  ON 62
ci_64                -6.057423e-04 3 1  ON 63
ci_65                -4.010861e-05 3 1  ON 64
ci_66                -1.509150e-04 3 1  ON 65
ci_67                -2.334273e-04 3 1  ON 66
ci_68                -1.708334e-03 3 1  ON 67
ci_69                -1.776781e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3498e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2833e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -22.7916
    reference variance = 0.579328
====================================================
  Execution time = 2.5414e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5359e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4584e-01
  Total weights = 1.964691588e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5612e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432932708249
                                         uncertainty =       0.001879975364

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432932708249
                                         uncertainty =       0.001879975364

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465280278
  error estimate for blocks of size 2^( 2) =       0.000491127105
  error estimate for blocks of size 2^( 3) =       0.000515591580
  error estimate for blocks of size 2^( 4) =       0.000533673490
  error estimate for blocks of size 2^( 5) =       0.000544489993
  error estimate for blocks of size 2^( 6) =       0.000552143735
  error estimate for blocks of size 2^( 7) =       0.000554695656

      target function =      -0.748806535769
              le_mean =     -22.813794252949
             les_mean =     520.915051944488
             stat err =       0.000546250719
             autocorr =       1.378334901193
   target nu stat err =       0.000546250719
   target dn stat err =       0.002601385605
      target stat err =       0.002257231620
              std dev =       0.658005680039
             le_variance =       0.432971474964


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281379425295e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748812364664       residual = 2.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748815601443       residual = 3.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748816142698       residual = 9.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748816360616       residual = 3.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748816437339       residual = 9.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748816457843       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748816465859       residual = 3.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748816463150       residual = 8.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748816462167       residual = 3.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748816462637       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.748816463124       residual = 1.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+00 is 5.741018e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748812364664       residual = 2.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748813178812       residual = 3.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748813314610       residual = 9.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748813369125       residual = 3.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748813388245       residual = 9.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748813393337       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748813395326       residual = 3.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748813394649       residual = 8.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748813394404       residual = 3.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748813394522       residual = 9.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+01 is 1.440790e-05

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748812364664       residual = 2.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748812568513       residual = 3.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748812602493       residual = 9.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748812616124       residual = 3.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748812620900       residual = 9.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748812622171       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748812622667       residual = 3.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748812622498       residual = 8.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748812622437       residual = 3.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748812622466       residual = 9.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+02 is 3.604782e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.028168 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9987e+01
  </log>
  <optVariables href="FORM2.s006.opt.xml">
ci_01                 1.086252e-01 3 1  ON 0
ci_02                -2.429216e-02 3 1  ON 1
ci_03                -2.453281e-02 3 1  ON 2
ci_04                 2.240808e-02 3 1  ON 3
ci_05                -1.919177e-02 3 1  ON 4
ci_06                -1.972342e-02 3 1  ON 5
ci_07                 2.582580e-02 3 1  ON 6
ci_08                -4.235888e-03 3 1  ON 7
ci_09                -7.572904e-03 3 1  ON 8
ci_10                -7.613039e-03 3 1  ON 9
ci_11                 1.373814e-02 3 1  ON 10
ci_12                 6.968711e-03 3 1  ON 11
ci_13                 1.378875e-02 3 1  ON 12
ci_14                 1.282928e-02 3 1  ON 13
ci_15                 5.306051e-03 3 1  ON 14
ci_16                 5.751791e-03 3 1  ON 15
ci_17                -5.095454e-03 3 1  ON 16
ci_18                -5.601940e-03 3 1  ON 17
ci_19                 1.024700e-02 3 1  ON 18
ci_20                 6.256460e-03 3 1  ON 19
ci_21                 8.483456e-03 3 1  ON 20
ci_22                 8.838604e-03 3 1  ON 21
ci_23                 4.204205e-03 3 1  ON 22
ci_24                 5.087659e-03 3 1  ON 23
ci_25                 2.979662e-03 3 1  ON 24
ci_26                 3.789732e-03 3 1  ON 25
ci_27                 3.335877e-03 3 1  ON 26
ci_28                 7.839510e-04 3 1  ON 27
ci_29                 1.174646e-03 3 1  ON 28
ci_30                -7.275950e-04 3 1  ON 29
ci_31                 1.003910e-03 3 1  ON 30
ci_32                -6.571967e-04 3 1  ON 31
ci_33                -1.043569e-03 3 1  ON 32
ci_34                 1.202710e-03 3 1  ON 33
ci_35                 1.320953e-03 3 1  ON 34
ci_36                -6.199191e-04 3 1  ON 35
ci_37                -5.414008e-04 3 1  ON 36
ci_38                -2.618041e-04 3 1  ON 37
ci_39                -1.581901e-04 3 1  ON 38
ci_40                -1.844350e-03 3 1  ON 39
ci_41                -5.519431e-04 3 1  ON 40
ci_42                -1.611767e-03 3 1  ON 41
ci_43                -1.373277e-03 3 1  ON 42
ci_44                -2.228425e-03 3 1  ON 43
ci_45                -2.724902e-04 3 1  ON 44
ci_46                -1.598699e-03 3 1  ON 45
ci_47                 1.394510e-03 3 1  ON 46
ci_48                 2.889146e-03 3 1  ON 47
ci_49                -8.647837e-04 3 1  ON 48
ci_50                -7.821400e-04 3 1  ON 49
ci_51                -4.940746e-04 3 1  ON 50
ci_52                -5.984010e-04 3 1  ON 51
ci_53                -7.856799e-04 3 1  ON 52
ci_54                -1.098426e-03 3 1  ON 53
ci_55                -1.210611e-03 3 1  ON 54
ci_56                 1.130936e-03 3 1  ON 55
ci_57                 2.081140e-03 3 1  ON 56
ci_58                -2.613502e-04 3 1  ON 57
ci_59                -5.662002e-04 3 1  ON 58
ci_60                 7.465151e-05 3 1  ON 59
ci_61                -9.996656e-04 3 1  ON 60
ci_62                -3.899662e-04 3 1  ON 61
ci_63                -2.772759e-04 3 1  ON 62
ci_64                -6.041171e-04 3 1  ON 63
ci_65                -3.798702e-05 3 1  ON 64
ci_66                -1.518242e-04 3 1  ON 65
ci_67                -2.342321e-04 3 1  ON 66
ci_68                -1.705318e-03 3 1  ON 67
ci_69                -1.773825e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -22.7589
    reference variance = 0.220411
====================================================
  Execution time = 2.6806e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5646e-01
  Total weights = 1.9647e+06
  Execution time = 3.5642e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440960078301
                                         uncertainty =       0.004228193616

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440960078301
                                         uncertainty =       0.004228193616

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469572084
  error estimate for blocks of size 2^( 2) =       0.000495101357
  error estimate for blocks of size 2^( 3) =       0.000519191252
  error estimate for blocks of size 2^( 4) =       0.000537638190
  error estimate for blocks of size 2^( 5) =       0.000549421440
  error estimate for blocks of size 2^( 6) =       0.000554922171
  error estimate for blocks of size 2^( 7) =       0.000558592039

      target function =      -0.740080744955
              le_mean =     -22.814490647701
             les_mean =     520.957360409960
             stat err =       0.000550143460
             autocorr =       1.372610663264
   target nu stat err =       0.000550143460
   target dn stat err =       0.005655289875
      target stat err =       0.004660054205
              std dev =       0.664075209878
             le_variance =       0.440995884374

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440957566895
                                         uncertainty =       0.004228125864

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440957566895
                                         uncertainty =       0.004228125864

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469570694
  error estimate for blocks of size 2^( 2) =       0.000495097788
  error estimate for blocks of size 2^( 3) =       0.000519185410
  error estimate for blocks of size 2^( 4) =       0.000537630636
  error estimate for blocks of size 2^( 5) =       0.000549413303
  error estimate for blocks of size 2^( 6) =       0.000554913452
  error estimate for blocks of size 2^( 7) =       0.000558583385

      target function =      -0.739675244656
              le_mean =     -22.814490481426
             les_mean =     520.957846475462
             stat err =       0.000550135194
             autocorr =       1.372577541781
   target nu stat err =       0.000550135194
   target dn stat err =       0.005889999535
      target stat err =       0.004844980017
              std dev =       0.664073244041
             le_variance =       0.440993273451

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440958785330
                                         uncertainty =       0.004228149765

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440958785330
                                         uncertainty =       0.004228149765

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469571369
  error estimate for blocks of size 2^( 2) =       0.000495099545
  error estimate for blocks of size 2^( 3) =       0.000519188292
  error estimate for blocks of size 2^( 4) =       0.000537634355
  error estimate for blocks of size 2^( 5) =       0.000549417310
  error estimate for blocks of size 2^( 6) =       0.000554917761
  error estimate for blocks of size 2^( 7) =       0.000558587669

      target function =      -0.739913848960
              le_mean =     -22.814490562152
             les_mean =     520.957559503706
             stat err =       0.000550139274
             autocorr =       1.372593953637
   target nu stat err =       0.000550139274
   target dn stat err =       0.005762010099
      target stat err =       0.004744396250
              std dev =       0.664074198879
             le_variance =       0.440994541617

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440959912900
                                         uncertainty =       0.004228186997

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440959912900
                                         uncertainty =       0.004228186997

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469571993
  error estimate for blocks of size 2^( 2) =       0.000495101129
  error estimate for blocks of size 2^( 3) =       0.000519190881
  error estimate for blocks of size 2^( 4) =       0.000537637706
  error estimate for blocks of size 2^( 5) =       0.000549420918
  error estimate for blocks of size 2^( 6) =       0.000554921615
  error estimate for blocks of size 2^( 7) =       0.000558591486

      target function =      -0.740067716816
              le_mean =     -22.814490637055
             les_mean =     520.957375718651
             stat err =       0.000550142931
             autocorr =       1.372608559119
   target nu stat err =       0.000550142931
   target dn stat err =       0.005667553661
      target stat err =       0.004669825929
              std dev =       0.664075080651
             le_variance =       0.440995712741


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.740080744955        initial  <--
     6.2500e+00     6.2500e+01             5.7410e-05        -0.739675244656
     2.5000e+01     2.5000e+02             1.4408e-05        -0.739913848960
     1.0000e+02     1.0000e+03             3.6048e-06        -0.740067716816

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.6308
  </log>
  <optVariables href="FORM2.s006.opt.xml">
ci_01                 1.086108e-01 3 1  ON 0
ci_02                -2.428806e-02 3 1  ON 1
ci_03                -2.452727e-02 3 1  ON 2
ci_04                 2.240292e-02 3 1  ON 3
ci_05                -1.918851e-02 3 1  ON 4
ci_06                -1.971977e-02 3 1  ON 5
ci_07                 2.582627e-02 3 1  ON 6
ci_08                -4.235596e-03 3 1  ON 7
ci_09                -7.570931e-03 3 1  ON 8
ci_10                -7.613177e-03 3 1  ON 9
ci_11                 1.373955e-02 3 1  ON 10
ci_12                 6.971015e-03 3 1  ON 11
ci_13                 1.379094e-02 3 1  ON 12
ci_14                 1.282519e-02 3 1  ON 13
ci_15                 5.305632e-03 3 1  ON 14
ci_16                 5.753664e-03 3 1  ON 15
ci_17                -5.092735e-03 3 1  ON 16
ci_18                -5.601802e-03 3 1  ON 17
ci_19                 1.025001e-02 3 1  ON 18
ci_20                 6.253718e-03 3 1  ON 19
ci_21                 8.485744e-03 3 1  ON 20
ci_22                 8.841301e-03 3 1  ON 21
ci_23                 4.203144e-03 3 1  ON 22
ci_24                 5.090119e-03 3 1  ON 23
ci_25                 2.980205e-03 3 1  ON 24
ci_26                 3.792533e-03 3 1  ON 25
ci_27                 3.336226e-03 3 1  ON 26
ci_28                 7.830234e-04 3 1  ON 27
ci_29                 1.172423e-03 3 1  ON 28
ci_30                -7.253318e-04 3 1  ON 29
ci_31                 1.006744e-03 3 1  ON 30
ci_32                -6.530299e-04 3 1  ON 31
ci_33                -1.043434e-03 3 1  ON 32
ci_34                 1.200953e-03 3 1  ON 33
ci_35                 1.321647e-03 3 1  ON 34
ci_36                -6.193254e-04 3 1  ON 35
ci_37                -5.405426e-04 3 1  ON 36
ci_38                -2.602214e-04 3 1  ON 37
ci_39                -1.573740e-04 3 1  ON 38
ci_40                -1.846535e-03 3 1  ON 39
ci_41                -5.505919e-04 3 1  ON 40
ci_42                -1.610990e-03 3 1  ON 41
ci_43                -1.374548e-03 3 1  ON 42
ci_44                -2.228480e-03 3 1  ON 43
ci_45                -2.718712e-04 3 1  ON 44
ci_46                -1.600931e-03 3 1  ON 45
ci_47                 1.392989e-03 3 1  ON 46
ci_48                 2.891845e-03 3 1  ON 47
ci_49                -8.650951e-04 3 1  ON 48
ci_50                -7.817652e-04 3 1  ON 49
ci_51                -4.963006e-04 3 1  ON 50
ci_52                -5.990318e-04 3 1  ON 51
ci_53                -7.864134e-04 3 1  ON 52
ci_54                -1.099018e-03 3 1  ON 53
ci_55                -1.212700e-03 3 1  ON 54
ci_56                 1.130368e-03 3 1  ON 55
ci_57                 2.082223e-03 3 1  ON 56
ci_58                -2.616473e-04 3 1  ON 57
ci_59                -5.636834e-04 3 1  ON 58
ci_60                 7.291266e-05 3 1  ON 59
ci_61                -1.002101e-03 3 1  ON 60
ci_62                -3.927591e-04 3 1  ON 61
ci_63                -2.767941e-04 3 1  ON 62
ci_64                -6.057423e-04 3 1  ON 63
ci_65                -4.010861e-05 3 1  ON 64
ci_66                -1.509150e-04 3 1  ON 65
ci_67                -2.334273e-04 3 1  ON 66
ci_68                -1.708334e-03 3 1  ON 67
ci_69                -1.776781e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4625e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2825e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -22.8938
    reference variance = 0.52618
====================================================
  Execution time = 2.5441e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5375e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5030e-01
  Total weights = 1.964994018e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5532e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436238278388
                                         uncertainty =       0.002159765187

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436238278388
                                         uncertainty =       0.002159765187

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467040151
  error estimate for blocks of size 2^( 2) =       0.000492724165
  error estimate for blocks of size 2^( 3) =       0.000516762793
  error estimate for blocks of size 2^( 4) =       0.000535253553
  error estimate for blocks of size 2^( 5) =       0.000547434013
  error estimate for blocks of size 2^( 6) =       0.000556319641
  error estimate for blocks of size 2^( 7) =       0.000560205452

      target function =      -0.745102540312
              le_mean =     -22.814001554391
             les_mean =     520.928964136277
             stat err =       0.000549803165
             autocorr =       1.385817482020
   target nu stat err =       0.000549803165
   target dn stat err =       0.002942149432
      target stat err =       0.002509992135
              std dev =       0.660494515263
             le_variance =       0.436253004692


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281400155439e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745109951867       residual = 1.10e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745110472742       residual = 1.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745110636605       residual = 3.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745110681823       residual = 8.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745110701111       residual = 3.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745110710423       residual = 9.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745110713199       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745110713304       residual = 1.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745110713380       residual = 4.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745110713325       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745110713314       residual = 3.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+01 is 6.708716e-06

solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745109951867       residual = 1.10e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745110082188       residual = 1.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745110123172       residual = 3.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745110134478       residual = 8.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745110139301       residual = 3.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745110141628       residual = 9.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745110142321       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745110142347       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745110142366       residual = 4.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745110142353       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745110142350       residual = 3.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+02 is 1.677718e-06

solving harmonic davidson linear method for identity shift 1.0000e+03, overlap shift 1.0000e+04 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745109951867       residual = 1.10e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745109984454       residual = 1.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745109994701       residual = 3.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745109997528       residual = 8.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745109998733       residual = 3.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745109999315       residual = 9.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745109999489       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745109999494       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745109999500       residual = 4.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745109999494       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745109999495       residual = 3.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+03 is 4.194632e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.032344 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0004e+01
  </log>
  <optVariables href="FORM2.s007.opt.xml">
ci_01                 1.086124e-01 3 1  ON 0
ci_02                -2.428869e-02 3 1  ON 1
ci_03                -2.452749e-02 3 1  ON 2
ci_04                 2.240324e-02 3 1  ON 3
ci_05                -1.918858e-02 3 1  ON 4
ci_06                -1.972048e-02 3 1  ON 5
ci_07                 2.582658e-02 3 1  ON 6
ci_08                -4.235789e-03 3 1  ON 7
ci_09                -7.571255e-03 3 1  ON 8
ci_10                -7.613191e-03 3 1  ON 9
ci_11                 1.373945e-02 3 1  ON 10
ci_12                 6.971263e-03 3 1  ON 11
ci_13                 1.379087e-02 3 1  ON 12
ci_14                 1.282507e-02 3 1  ON 13
ci_15                 5.305799e-03 3 1  ON 14
ci_16                 5.753603e-03 3 1  ON 15
ci_17                -5.092932e-03 3 1  ON 16
ci_18                -5.602272e-03 3 1  ON 17
ci_19                 1.024988e-02 3 1  ON 18
ci_20                 6.253050e-03 3 1  ON 19
ci_21                 8.486027e-03 3 1  ON 20
ci_22                 8.841354e-03 3 1  ON 21
ci_23                 4.203271e-03 3 1  ON 22
ci_24                 5.089940e-03 3 1  ON 23
ci_25                 2.980176e-03 3 1  ON 24
ci_26                 3.792399e-03 3 1  ON 25
ci_27                 3.336058e-03 3 1  ON 26
ci_28                 7.830625e-04 3 1  ON 27
ci_29                 1.172402e-03 3 1  ON 28
ci_30                -7.253684e-04 3 1  ON 29
ci_31                 1.006137e-03 3 1  ON 30
ci_32                -6.533732e-04 3 1  ON 31
ci_33                -1.043168e-03 3 1  ON 32
ci_34                 1.201066e-03 3 1  ON 33
ci_35                 1.322063e-03 3 1  ON 34
ci_36                -6.193551e-04 3 1  ON 35
ci_37                -5.407353e-04 3 1  ON 36
ci_38                -2.601917e-04 3 1  ON 37
ci_39                -1.573700e-04 3 1  ON 38
ci_40                -1.846305e-03 3 1  ON 39
ci_41                -5.508200e-04 3 1  ON 40
ci_42                -1.611239e-03 3 1  ON 41
ci_43                -1.374751e-03 3 1  ON 42
ci_44                -2.228570e-03 3 1  ON 43
ci_45                -2.716257e-04 3 1  ON 44
ci_46                -1.600599e-03 3 1  ON 45
ci_47                 1.393156e-03 3 1  ON 46
ci_48                 2.891754e-03 3 1  ON 47
ci_49                -8.654138e-04 3 1  ON 48
ci_50                -7.817813e-04 3 1  ON 49
ci_51                -4.963684e-04 3 1  ON 50
ci_52                -5.991036e-04 3 1  ON 51
ci_53                -7.863597e-04 3 1  ON 52
ci_54                -1.099386e-03 3 1  ON 53
ci_55                -1.212680e-03 3 1  ON 54
ci_56                 1.130548e-03 3 1  ON 55
ci_57                 2.082256e-03 3 1  ON 56
ci_58                -2.619184e-04 3 1  ON 57
ci_59                -5.636047e-04 3 1  ON 58
ci_60                 7.331117e-05 3 1  ON 59
ci_61                -1.002514e-03 3 1  ON 60
ci_62                -3.927892e-04 3 1  ON 61
ci_63                -2.769632e-04 3 1  ON 62
ci_64                -6.053824e-04 3 1  ON 63
ci_65                -3.986035e-05 3 1  ON 64
ci_66                -1.509357e-04 3 1  ON 65
ci_67                -2.336104e-04 3 1  ON 66
ci_68                -1.708329e-03 3 1  ON 67
ci_69                -1.776621e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -22.7415
    reference variance = 0.478809
====================================================
  Execution time = 2.4781e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5567e-01
  Total weights = 1.9647e+06
  Execution time = 3.5150e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438327092726
                                         uncertainty =       0.002306081696

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438327092726
                                         uncertainty =       0.002306081696

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468151008
  error estimate for blocks of size 2^( 2) =       0.000494122363
  error estimate for blocks of size 2^( 3) =       0.000518837408
  error estimate for blocks of size 2^( 4) =       0.000536441955
  error estimate for blocks of size 2^( 5) =       0.000548300608
  error estimate for blocks of size 2^( 6) =       0.000554921778
  error estimate for blocks of size 2^( 7) =       0.000558848822

      target function =      -0.740661967697
              le_mean =     -22.814247298774
             les_mean =     520.945546487240
             stat err =       0.000549628291
             autocorr =       1.378371332928
   target nu stat err =       0.000549628291
   target dn stat err =       0.005758198304
      target stat err =       0.004749028780
              std dev =       0.662065504940
             le_variance =       0.438330732831

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438326616511
                                         uncertainty =       0.002305999756

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438326616511
                                         uncertainty =       0.002305999756

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468150753
  error estimate for blocks of size 2^( 2) =       0.000494121877
  error estimate for blocks of size 2^( 3) =       0.000518836676
  error estimate for blocks of size 2^( 4) =       0.000536441012
  error estimate for blocks of size 2^( 5) =       0.000548299544
  error estimate for blocks of size 2^( 6) =       0.000554920775
  error estimate for blocks of size 2^( 7) =       0.000558847778

      target function =      -0.740665132169
              le_mean =     -22.814247279276
             les_mean =     520.945541744038
             stat err =       0.000549627278
             autocorr =       1.378367750683
   target nu stat err =       0.000549627278
   target dn stat err =       0.005757003480
      target stat err =       0.004748099340
              std dev =       0.662065144463
             le_variance =       0.438330255513

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438326854179
                                         uncertainty =       0.002306040681

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438326854179
                                         uncertainty =       0.002306040681

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468150880
  error estimate for blocks of size 2^( 2) =       0.000494122120
  error estimate for blocks of size 2^( 3) =       0.000518837042
  error estimate for blocks of size 2^( 4) =       0.000536441483
  error estimate for blocks of size 2^( 5) =       0.000548300076
  error estimate for blocks of size 2^( 6) =       0.000554921276
  error estimate for blocks of size 2^( 7) =       0.000558848300

      target function =      -0.740663569814
              le_mean =     -22.814247288988
             les_mean =     520.945544089644
             stat err =       0.000549627784
             autocorr =       1.378369541052
   target nu stat err =       0.000549627784
   target dn stat err =       0.005757600590
      target stat err =       0.004748564070
              std dev =       0.662065324369
             le_variance =       0.438330493732

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438327062868
                                         uncertainty =       0.002306076566

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438327062868
                                         uncertainty =       0.002306076566

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468150992
  error estimate for blocks of size 2^( 2) =       0.000494122332
  error estimate for blocks of size 2^( 3) =       0.000518837362
  error estimate for blocks of size 2^( 4) =       0.000536441896
  error estimate for blocks of size 2^( 5) =       0.000548300542
  error estimate for blocks of size 2^( 6) =       0.000554921716
  error estimate for blocks of size 2^( 7) =       0.000558848756

      target function =      -0.740662170185
              le_mean =     -22.814247297547
             les_mean =     520.945546184651
             stat err =       0.000549628228
             autocorr =       1.378371108932
   target nu stat err =       0.000549628228
   target dn stat err =       0.005758123561
      target stat err =       0.004748970697
              std dev =       0.662065482338
             le_variance =       0.438330702904


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.740661967697        initial
     6.2500e+01     6.2500e+02             6.7087e-06        -0.740665132169  <--
     2.5000e+02     2.5000e+03             1.6777e-06        -0.740663569814
     1.0000e+03     1.0000e+04             4.1946e-07        -0.740662170185

*****************************************************************************
Applying the update for shift_i =   6.2500e+01     and shift_s =   6.2500e+02
*****************************************************************************

  Execution time = 4.2357e+01
  </log>
  <optVariables href="FORM2.s007.opt.xml">
ci_01                 1.086175e-01 3 1  ON 0
ci_02                -2.429059e-02 3 1  ON 1
ci_03                -2.452813e-02 3 1  ON 2
ci_04                 2.240419e-02 3 1  ON 3
ci_05                -1.918881e-02 3 1  ON 4
ci_06                -1.972258e-02 3 1  ON 5
ci_07                 2.582751e-02 3 1  ON 6
ci_08                -4.236368e-03 3 1  ON 7
ci_09                -7.572224e-03 3 1  ON 8
ci_10                -7.613233e-03 3 1  ON 9
ci_11                 1.373917e-02 3 1  ON 10
ci_12                 6.972005e-03 3 1  ON 11
ci_13                 1.379063e-02 3 1  ON 12
ci_14                 1.282472e-02 3 1  ON 13
ci_15                 5.306302e-03 3 1  ON 14
ci_16                 5.753420e-03 3 1  ON 15
ci_17                -5.093522e-03 3 1  ON 16
ci_18                -5.603679e-03 3 1  ON 17
ci_19                 1.024951e-02 3 1  ON 18
ci_20                 6.251049e-03 3 1  ON 19
ci_21                 8.486878e-03 3 1  ON 20
ci_22                 8.841511e-03 3 1  ON 21
ci_23                 4.203651e-03 3 1  ON 22
ci_24                 5.089403e-03 3 1  ON 23
ci_25                 2.980090e-03 3 1  ON 24
ci_26                 3.791998e-03 3 1  ON 25
ci_27                 3.335557e-03 3 1  ON 26
ci_28                 7.831799e-04 3 1  ON 27
ci_29                 1.172339e-03 3 1  ON 28
ci_30                -7.254780e-04 3 1  ON 29
ci_31                 1.004317e-03 3 1  ON 30
ci_32                -6.544021e-04 3 1  ON 31
ci_33                -1.042372e-03 3 1  ON 32
ci_34                 1.201407e-03 3 1  ON 33
ci_35                 1.323311e-03 3 1  ON 34
ci_36                -6.194439e-04 3 1  ON 35
ci_37                -5.413126e-04 3 1  ON 36
ci_38                -2.601028e-04 3 1  ON 37
ci_39                -1.573581e-04 3 1  ON 38
ci_40                -1.845616e-03 3 1  ON 39
ci_41                -5.515037e-04 3 1  ON 40
ci_42                -1.611987e-03 3 1  ON 41
ci_43                -1.375361e-03 3 1  ON 42
ci_44                -2.228842e-03 3 1  ON 43
ci_45                -2.708896e-04 3 1  ON 44
ci_46                -1.599604e-03 3 1  ON 45
ci_47                 1.393657e-03 3 1  ON 46
ci_48                 2.891479e-03 3 1  ON 47
ci_49                -8.663689e-04 3 1  ON 48
ci_50                -7.818295e-04 3 1  ON 49
ci_51                -4.965714e-04 3 1  ON 50
ci_52                -5.993191e-04 3 1  ON 51
ci_53                -7.861987e-04 3 1  ON 52
ci_54                -1.100489e-03 3 1  ON 53
ci_55                -1.212621e-03 3 1  ON 54
ci_56                 1.131088e-03 3 1  ON 55
ci_57                 2.082357e-03 3 1  ON 56
ci_58                -2.627310e-04 3 1  ON 57
ci_59                -5.633687e-04 3 1  ON 58
ci_60                 7.450641e-05 3 1  ON 59
ci_61                -1.003751e-03 3 1  ON 60
ci_62                -3.928792e-04 3 1  ON 61
ci_63                -2.774701e-04 3 1  ON 62
ci_64                -6.043036e-04 3 1  ON 63
ci_65                -3.911642e-05 3 1  ON 64
ci_66                -1.509979e-04 3 1  ON 65
ci_67                -2.341593e-04 3 1  ON 66
ci_68                -1.708312e-03 3 1  ON 67
ci_69                -1.776140e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2368e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2824e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -22.8443
    reference variance = 0.426011
====================================================
  Execution time = 2.5228e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5340e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5236e-01
  Total weights = 1.964634640e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5751e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438551295067
                                         uncertainty =       0.002341028594

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438551295067
                                         uncertainty =       0.002341028594

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468286589
  error estimate for blocks of size 2^( 2) =       0.000493881430
  error estimate for blocks of size 2^( 3) =       0.000517714942
  error estimate for blocks of size 2^( 4) =       0.000536785157
  error estimate for blocks of size 2^( 5) =       0.000547491265
  error estimate for blocks of size 2^( 6) =       0.000554343422
  error estimate for blocks of size 2^( 7) =       0.000556459188

      target function =      -0.743395462480
              le_mean =     -22.814044112511
             les_mean =     520.932972166918
             stat err =       0.000548769758
             autocorr =       1.373273056732
   target nu stat err =       0.000548769758
   target dn stat err =       0.003139871274
      target stat err =       0.002657000565
              std dev =       0.662257244756
             le_variance =       0.438584658231


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281404411251e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743403987226       residual = 1.88e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743405076524       residual = 2.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743405239901       residual = 5.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743405284870       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743405292244       residual = 5.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743405298380       residual = 8.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743405298885       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743405299045       residual = 3.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743405299265       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743405299281       residual = 6.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+01 is 1.684475e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743403987226       residual = 1.88e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743404260212       residual = 2.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743404301110       residual = 5.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743404312352       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743404314190       residual = 5.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743404315721       residual = 8.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743404315846       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743404315886       residual = 3.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743404315941       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743404315945       residual = 6.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+01 is 4.216425e-06

solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743403987226       residual = 1.88e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743404055514       residual = 2.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743404065742       residual = 5.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743404068553       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743404069012       residual = 5.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743404069394       residual = 8.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743404069426       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743404069435       residual = 3.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743404069449       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743404069450       residual = 6.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+02 is 1.054434e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.035940 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9812e+01
  </log>
  <optVariables href="FORM2.s008.opt.xml">
ci_01                 1.086217e-01 3 1  ON 0
ci_02                -2.429195e-02 3 1  ON 1
ci_03                -2.453015e-02 3 1  ON 2
ci_04                 2.240647e-02 3 1  ON 3
ci_05                -1.918965e-02 3 1  ON 4
ci_06                -1.972363e-02 3 1  ON 5
ci_07                 2.582765e-02 3 1  ON 6
ci_08                -4.236518e-03 3 1  ON 7
ci_09                -7.571682e-03 3 1  ON 8
ci_10                -7.614988e-03 3 1  ON 9
ci_11                 1.373962e-02 3 1  ON 10
ci_12                 6.971484e-03 3 1  ON 11
ci_13                 1.379078e-02 3 1  ON 12
ci_14                 1.282689e-02 3 1  ON 13
ci_15                 5.307767e-03 3 1  ON 14
ci_16                 5.753361e-03 3 1  ON 15
ci_17                -5.093485e-03 3 1  ON 16
ci_18                -5.603501e-03 3 1  ON 17
ci_19                 1.024944e-02 3 1  ON 18
ci_20                 6.250751e-03 3 1  ON 19
ci_21                 8.486506e-03 3 1  ON 20
ci_22                 8.841239e-03 3 1  ON 21
ci_23                 4.202976e-03 3 1  ON 22
ci_24                 5.088277e-03 3 1  ON 23
ci_25                 2.979898e-03 3 1  ON 24
ci_26                 3.790994e-03 3 1  ON 25
ci_27                 3.334766e-03 3 1  ON 26
ci_28                 7.837545e-04 3 1  ON 27
ci_29                 1.172865e-03 3 1  ON 28
ci_30                -7.253249e-04 3 1  ON 29
ci_31                 1.003860e-03 3 1  ON 30
ci_32                -6.550663e-04 3 1  ON 31
ci_33                -1.041944e-03 3 1  ON 32
ci_34                 1.202095e-03 3 1  ON 33
ci_35                 1.323014e-03 3 1  ON 34
ci_36                -6.192314e-04 3 1  ON 35
ci_37                -5.411544e-04 3 1  ON 36
ci_38                -2.600773e-04 3 1  ON 37
ci_39                -1.571730e-04 3 1  ON 38
ci_40                -1.844860e-03 3 1  ON 39
ci_41                -5.534534e-04 3 1  ON 40
ci_42                -1.611355e-03 3 1  ON 41
ci_43                -1.375564e-03 3 1  ON 42
ci_44                -2.229308e-03 3 1  ON 43
ci_45                -2.707053e-04 3 1  ON 44
ci_46                -1.598411e-03 3 1  ON 45
ci_47                 1.394693e-03 3 1  ON 46
ci_48                 2.891181e-03 3 1  ON 47
ci_49                -8.667051e-04 3 1  ON 48
ci_50                -7.818931e-04 3 1  ON 49
ci_51                -4.961631e-04 3 1  ON 50
ci_52                -5.986640e-04 3 1  ON 51
ci_53                -7.859778e-04 3 1  ON 52
ci_54                -1.100676e-03 3 1  ON 53
ci_55                -1.212216e-03 3 1  ON 54
ci_56                 1.131080e-03 3 1  ON 55
ci_57                 2.081997e-03 3 1  ON 56
ci_58                -2.630157e-04 3 1  ON 57
ci_59                -5.634222e-04 3 1  ON 58
ci_60                 7.482795e-05 3 1  ON 59
ci_61                -1.004273e-03 3 1  ON 60
ci_62                -3.923851e-04 3 1  ON 61
ci_63                -2.772740e-04 3 1  ON 62
ci_64                -6.033201e-04 3 1  ON 63
ci_65                -4.005709e-05 3 1  ON 64
ci_66                -1.509646e-04 3 1  ON 65
ci_67                -2.340629e-04 3 1  ON 66
ci_68                -1.707604e-03 3 1  ON 67
ci_69                -1.776011e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -22.7749
    reference variance = 0.316913
====================================================
  Execution time = 2.5676e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2816e+01
  VMC Evar = 4.5695e-01
  Total weights = 1.9648e+06
  Execution time = 3.8993e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439298330989
                                         uncertainty =       0.002276841841

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439298330989
                                         uncertainty =       0.002276841841

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468729546
  error estimate for blocks of size 2^( 2) =       0.000494200698
  error estimate for blocks of size 2^( 3) =       0.000518468997
  error estimate for blocks of size 2^( 4) =       0.000537089881
  error estimate for blocks of size 2^( 5) =       0.000550024788
  error estimate for blocks of size 2^( 6) =       0.000557174411
  error estimate for blocks of size 2^( 7) =       0.000562996092

      target function =      -0.739609880149
              le_mean =     -22.816065882424
             les_mean =     521.029811773906
             stat err =       0.000551821293
             autocorr =       1.385964956845
   target nu stat err =       0.000551821293
   target dn stat err =       0.004150342685
      target stat err =       0.003448799330
              std dev =       0.662883681135
             le_variance =       0.439414774715

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439296676174
                                         uncertainty =       0.002276816514

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439296676174
                                         uncertainty =       0.002276816514

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468728673
  error estimate for blocks of size 2^( 2) =       0.000494199110
  error estimate for blocks of size 2^( 3) =       0.000518466620
  error estimate for blocks of size 2^( 4) =       0.000537086942
  error estimate for blocks of size 2^( 5) =       0.000550021617
  error estimate for blocks of size 2^( 6) =       0.000557170988
  error estimate for blocks of size 2^( 7) =       0.000562992774

      target function =      -0.739615650818
              le_mean =     -22.816065844048
             les_mean =     521.029802929294
             stat err =       0.000551818080
             autocorr =       1.385953978580
   target nu stat err =       0.000551818080
   target dn stat err =       0.004154475332
      target stat err =       0.003452178320
              std dev =       0.662882446857
             le_variance =       0.439413138352

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439297498189
                                         uncertainty =       0.002276828791

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439297498189
                                         uncertainty =       0.002276828791

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468729107
  error estimate for blocks of size 2^( 2) =       0.000494199901
  error estimate for blocks of size 2^( 3) =       0.000518467804
  error estimate for blocks of size 2^( 4) =       0.000537088407
  error estimate for blocks of size 2^( 5) =       0.000550023198
  error estimate for blocks of size 2^( 6) =       0.000557172694
  error estimate for blocks of size 2^( 7) =       0.000562994428

      target function =      -0.739612883336
              le_mean =     -22.816065862803
             les_mean =     521.029807187824
             stat err =       0.000551819682
             autocorr =       1.385959459907
   target nu stat err =       0.000551819682
   target dn stat err =       0.004152400623
      target stat err =       0.003450483127
              std dev =       0.662883059951
             le_variance =       0.439413951170

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439298226437
                                         uncertainty =       0.002276840164

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439298226437
                                         uncertainty =       0.002276840164

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468729491
  error estimate for blocks of size 2^( 2) =       0.000494200598
  error estimate for blocks of size 2^( 3) =       0.000518468848
  error estimate for blocks of size 2^( 4) =       0.000537089697
  error estimate for blocks of size 2^( 5) =       0.000550024589
  error estimate for blocks of size 2^( 6) =       0.000557174196
  error estimate for blocks of size 2^( 7) =       0.000562995884

      target function =      -0.739610269576
              le_mean =     -22.816065879928
             les_mean =     521.029811181522
             stat err =       0.000551821091
             autocorr =       1.385964269728
   target nu stat err =       0.000551821091
   target dn stat err =       0.004150598618
      target stat err =       0.003449008876
              std dev =       0.662883603147
             le_variance =       0.439414671321


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.739609880149        initial
     1.5625e+01     1.5625e+02             1.6845e-05        -0.739615650818  <--
     6.2500e+01     6.2500e+02             4.2164e-06        -0.739612883336
     2.5000e+02     2.5000e+03             1.0544e-06        -0.739610269576

*****************************************************************************
Applying the update for shift_i =   1.5625e+01     and shift_s =   1.5625e+02
*****************************************************************************

  Execution time = 4.3575e+01
  </log>
  <optVariables href="FORM2.s008.opt.xml">
ci_01                 1.086343e-01 3 1  ON 0
ci_02                -2.429600e-02 3 1  ON 1
ci_03                -2.453618e-02 3 1  ON 2
ci_04                 2.241328e-02 3 1  ON 3
ci_05                -1.919217e-02 3 1  ON 4
ci_06                -1.972676e-02 3 1  ON 5
ci_07                 2.582806e-02 3 1  ON 6
ci_08                -4.236968e-03 3 1  ON 7
ci_09                -7.570061e-03 3 1  ON 8
ci_10                -7.620238e-03 3 1  ON 9
ci_11                 1.374096e-02 3 1  ON 10
ci_12                 6.969926e-03 3 1  ON 11
ci_13                 1.379121e-02 3 1  ON 12
ci_14                 1.283339e-02 3 1  ON 13
ci_15                 5.312151e-03 3 1  ON 14
ci_16                 5.753184e-03 3 1  ON 15
ci_17                -5.093374e-03 3 1  ON 16
ci_18                -5.602966e-03 3 1  ON 17
ci_19                 1.024923e-02 3 1  ON 18
ci_20                 6.249862e-03 3 1  ON 19
ci_21                 8.485392e-03 3 1  ON 20
ci_22                 8.840424e-03 3 1  ON 21
ci_23                 4.200959e-03 3 1  ON 22
ci_24                 5.084906e-03 3 1  ON 23
ci_25                 2.979324e-03 3 1  ON 24
ci_26                 3.787988e-03 3 1  ON 25
ci_27                 3.332400e-03 3 1  ON 26
ci_28                 7.854739e-04 3 1  ON 27
ci_29                 1.174437e-03 3 1  ON 28
ci_30                -7.248661e-04 3 1  ON 29
ci_31                 1.002492e-03 3 1  ON 30
ci_32                -6.570519e-04 3 1  ON 31
ci_33                -1.040664e-03 3 1  ON 32
ci_34                 1.204156e-03 3 1  ON 33
ci_35                 1.322124e-03 3 1  ON 34
ci_36                -6.185960e-04 3 1  ON 35
ci_37                -5.406818e-04 3 1  ON 36
ci_38                -2.600013e-04 3 1  ON 37
ci_39                -1.566198e-04 3 1  ON 38
ci_40                -1.842600e-03 3 1  ON 39
ci_41                -5.592835e-04 3 1  ON 40
ci_42                -1.609464e-03 3 1  ON 41
ci_43                -1.376171e-03 3 1  ON 42
ci_44                -2.230704e-03 3 1  ON 43
ci_45                -2.701542e-04 3 1  ON 44
ci_46                -1.594842e-03 3 1  ON 45
ci_47                 1.397794e-03 3 1  ON 46
ci_48                 2.890288e-03 3 1  ON 47
ci_49                -8.677105e-04 3 1  ON 48
ci_50                -7.820833e-04 3 1  ON 49
ci_51                -4.949423e-04 3 1  ON 50
ci_52                -5.967049e-04 3 1  ON 51
ci_53                -7.853177e-04 3 1  ON 52
ci_54                -1.101235e-03 3 1  ON 53
ci_55                -1.211005e-03 3 1  ON 54
ci_56                 1.131056e-03 3 1  ON 55
ci_57                 2.080921e-03 3 1  ON 56
ci_58                -2.638671e-04 3 1  ON 57
ci_59                -5.635821e-04 3 1  ON 58
ci_60                 7.579224e-05 3 1  ON 59
ci_61                -1.005838e-03 3 1  ON 60
ci_62                -3.909083e-04 3 1  ON 61
ci_63                -2.766882e-04 3 1  ON 62
ci_64                -6.003788e-04 3 1  ON 63
ci_65                -4.287084e-05 3 1  ON 64
ci_66                -1.508653e-04 3 1  ON 65
ci_67                -2.337743e-04 3 1  ON 66
ci_68                -1.705487e-03 3 1  ON 67
ci_69                -1.775625e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3395e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2822e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -22.7277
    reference variance = 0.819061
====================================================
  Execution time = 2.5203e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5341e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4593e-01
  Total weights = 1.964681406e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5275e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432698377355
                                         uncertainty =       0.001985468544

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432698377355
                                         uncertainty =       0.001985468544

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465151704
  error estimate for blocks of size 2^( 2) =       0.000490775197
  error estimate for blocks of size 2^( 3) =       0.000515017881
  error estimate for blocks of size 2^( 4) =       0.000533337794
  error estimate for blocks of size 2^( 5) =       0.000544331078
  error estimate for blocks of size 2^( 6) =       0.000552829675
  error estimate for blocks of size 2^( 7) =       0.000557239555

      target function =      -0.748732522641
              le_mean =     -22.814596989553
             les_mean =     520.951767730966
             stat err =       0.000546934525
             autocorr =       1.382551906309
   target nu stat err =       0.000546934525
   target dn stat err =       0.003357853644
      target stat err =       0.002873904757
              std dev =       0.657823848834
             le_variance =       0.432732216095


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281459698955e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748742627577       residual = 2.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748749210699       residual = 3.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748750333621       residual = 9.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748750574323       residual = 3.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748750683748       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748750673091       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748750669791       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748750670668       residual = 2.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748750671279       residual = 6.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+00 is 9.627418e-05

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748742627577       residual = 2.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748744289075       residual = 3.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748744571311       residual = 9.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748744631500       residual = 3.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748744658699       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748744655943       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748744655118       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748744655335       residual = 2.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748744655488       residual = 6.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+01 is 2.418963e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748742627577       residual = 2.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748743043945       residual = 3.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748743114599       residual = 9.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748743129647       residual = 3.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748743136436       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748743135742       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748743135535       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748743135590       residual = 2.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748743135628       residual = 6.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+01 is 6.055028e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.039093 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9739e+01
  </log>
  <optVariables href="FORM2.s009.opt.xml">
ci_01                 1.086585e-01 3 1  ON 0
ci_02                -2.430452e-02 3 1  ON 1
ci_03                -2.454880e-02 3 1  ON 2
ci_04                 2.242226e-02 3 1  ON 3
ci_05                -1.920031e-02 3 1  ON 4
ci_06                -1.973116e-02 3 1  ON 5
ci_07                 2.582871e-02 3 1  ON 6
ci_08                -4.238864e-03 3 1  ON 7
ci_09                -7.571719e-03 3 1  ON 8
ci_10                -7.624020e-03 3 1  ON 9
ci_11                 1.373906e-02 3 1  ON 10
ci_12                 6.966491e-03 3 1  ON 11
ci_13                 1.378972e-02 3 1  ON 12
ci_14                 1.283304e-02 3 1  ON 13
ci_15                 5.314092e-03 3 1  ON 14
ci_16                 5.756288e-03 3 1  ON 15
ci_17                -5.104818e-03 3 1  ON 16
ci_18                -5.609993e-03 3 1  ON 17
ci_19                 1.024483e-02 3 1  ON 18
ci_20                 6.252072e-03 3 1  ON 19
ci_21                 8.486396e-03 3 1  ON 20
ci_22                 8.837719e-03 3 1  ON 21
ci_23                 4.204379e-03 3 1  ON 22
ci_24                 5.084985e-03 3 1  ON 23
ci_25                 2.982907e-03 3 1  ON 24
ci_26                 3.785502e-03 3 1  ON 25
ci_27                 3.330287e-03 3 1  ON 26
ci_28                 7.886234e-04 3 1  ON 27
ci_29                 1.174595e-03 3 1  ON 28
ci_30                -7.242599e-04 3 1  ON 29
ci_31                 1.001533e-03 3 1  ON 30
ci_32                -6.554507e-04 3 1  ON 31
ci_33                -1.039816e-03 3 1  ON 32
ci_34                 1.202672e-03 3 1  ON 33
ci_35                 1.322485e-03 3 1  ON 34
ci_36                -6.167618e-04 3 1  ON 35
ci_37                -5.423983e-04 3 1  ON 36
ci_38                -2.589444e-04 3 1  ON 37
ci_39                -1.604618e-04 3 1  ON 38
ci_40                -1.840926e-03 3 1  ON 39
ci_41                -5.620872e-04 3 1  ON 40
ci_42                -1.605787e-03 3 1  ON 41
ci_43                -1.376302e-03 3 1  ON 42
ci_44                -2.228808e-03 3 1  ON 43
ci_45                -2.687029e-04 3 1  ON 44
ci_46                -1.593167e-03 3 1  ON 45
ci_47                 1.402303e-03 3 1  ON 46
ci_48                 2.889661e-03 3 1  ON 47
ci_49                -8.688196e-04 3 1  ON 48
ci_50                -7.831235e-04 3 1  ON 49
ci_51                -4.928220e-04 3 1  ON 50
ci_52                -5.936300e-04 3 1  ON 51
ci_53                -7.797055e-04 3 1  ON 52
ci_54                -1.103188e-03 3 1  ON 53
ci_55                -1.211889e-03 3 1  ON 54
ci_56                 1.135471e-03 3 1  ON 55
ci_57                 2.079170e-03 3 1  ON 56
ci_58                -2.664663e-04 3 1  ON 57
ci_59                -5.639559e-04 3 1  ON 58
ci_60                 7.076006e-05 3 1  ON 59
ci_61                -1.000415e-03 3 1  ON 60
ci_62                -3.908339e-04 3 1  ON 61
ci_63                -2.737118e-04 3 1  ON 62
ci_64                -5.978133e-04 3 1  ON 63
ci_65                -3.944267e-05 3 1  ON 64
ci_66                -1.550053e-04 3 1  ON 65
ci_67                -2.330173e-04 3 1  ON 66
ci_68                -1.706340e-03 3 1  ON 67
ci_69                -1.773737e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -22.853
    reference variance = 0.390822
====================================================
  Execution time = 2.4497e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4588e-01
  Total weights = 1.9647e+06
  Execution time = 3.5007e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434726141899
                                         uncertainty =       0.001920281159

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434726141899
                                         uncertainty =       0.001920281159

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466246810
  error estimate for blocks of size 2^( 2) =       0.000492351479
  error estimate for blocks of size 2^( 3) =       0.000516629205
  error estimate for blocks of size 2^( 4) =       0.000534086787
  error estimate for blocks of size 2^( 5) =       0.000546014168
  error estimate for blocks of size 2^( 6) =       0.000553641498
  error estimate for blocks of size 2^( 7) =       0.000554048498

      target function =      -0.748691406519
              le_mean =     -22.814410548376
             les_mean =     520.943315883263
             stat err =       0.000546947738
             autocorr =       1.376131427944
   target nu stat err =       0.000546947738
   target dn stat err =       0.002233493255
      target stat err =       0.001964504992
              std dev =       0.659372562599
             le_variance =       0.434772176309

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434723446547
                                         uncertainty =       0.001920053937

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434723446547
                                         uncertainty =       0.001920053937

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466245341
  error estimate for blocks of size 2^( 2) =       0.000492346142
  error estimate for blocks of size 2^( 3) =       0.000516619893
  error estimate for blocks of size 2^( 4) =       0.000534073948
  error estimate for blocks of size 2^( 5) =       0.000545998825
  error estimate for blocks of size 2^( 6) =       0.000553625015
  error estimate for blocks of size 2^( 7) =       0.000554031497

      target function =      -0.748608347241
              le_mean =     -22.814410839441
             les_mean =     520.943428498395
             stat err =       0.000546932321
             autocorr =       1.376062521011
   target nu stat err =       0.000546932321
   target dn stat err =       0.002241493361
      target stat err =       0.001970441982
              std dev =       0.659370485322
             le_variance =       0.434769436914

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434724728683
                                         uncertainty =       0.001920166320

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434724728683
                                         uncertainty =       0.001920166320

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466246041
  error estimate for blocks of size 2^( 2) =       0.000492348766
  error estimate for blocks of size 2^( 3) =       0.000516624479
  error estimate for blocks of size 2^( 4) =       0.000534080309
  error estimate for blocks of size 2^( 5) =       0.000546006445
  error estimate for blocks of size 2^( 6) =       0.000553633222
  error estimate for blocks of size 2^( 7) =       0.000554039941

      target function =      -0.748676139224
              le_mean =     -22.814410675488
             les_mean =     520.943339974214
             stat err =       0.000546939979
             autocorr =       1.376096929726
   target nu stat err =       0.000546939979
   target dn stat err =       0.002229548964
      target stat err =       0.001961292782
              std dev =       0.659371474160
             le_variance =       0.434770740936

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434725959322
                                         uncertainty =       0.001920266726

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434725959322
                                         uncertainty =       0.001920266726

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466246711
  error estimate for blocks of size 2^( 2) =       0.000492351136
  error estimate for blocks of size 2^( 3) =       0.000516628611
  error estimate for blocks of size 2^( 4) =       0.000534085972
  error estimate for blocks of size 2^( 5) =       0.000546013193
  error estimate for blocks of size 2^( 6) =       0.000553640452
  error estimate for blocks of size 2^( 7) =       0.000554047414

      target function =      -0.748730921663
              le_mean =     -22.814410563017
             les_mean =     520.943269312159
             stat err =       0.000546946758
             autocorr =       1.376127082062
   target nu stat err =       0.000546946758
   target dn stat err =       0.002228221446
      target stat err =       0.001960513232
              std dev =       0.659372422050
             le_variance =       0.434771990960


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748691406519        initial
     3.9062e+00     3.9062e+01             9.6274e-05        -0.748608347241
     1.5625e+01     1.5625e+02             2.4190e-05        -0.748676139224
     6.2500e+01     6.2500e+02             6.0550e-06        -0.748730921663  <--

*****************************************************************************
Applying the update for shift_i =   6.2500e+01     and shift_s =   6.2500e+02
*****************************************************************************

  Execution time = 4.2007e+01
  </log>
  <optVariables href="FORM2.s009.opt.xml">
ci_01                 1.086404e-01 3 1  ON 0
ci_02                -2.429814e-02 3 1  ON 1
ci_03                -2.453934e-02 3 1  ON 2
ci_04                 2.241553e-02 3 1  ON 3
ci_05                -1.919421e-02 3 1  ON 4
ci_06                -1.972787e-02 3 1  ON 5
ci_07                 2.582823e-02 3 1  ON 6
ci_08                -4.237443e-03 3 1  ON 7
ci_09                -7.570476e-03 3 1  ON 8
ci_10                -7.621185e-03 3 1  ON 9
ci_11                 1.374048e-02 3 1  ON 10
ci_12                 6.969065e-03 3 1  ON 11
ci_13                 1.379084e-02 3 1  ON 12
ci_14                 1.283330e-02 3 1  ON 13
ci_15                 5.312637e-03 3 1  ON 14
ci_16                 5.753962e-03 3 1  ON 15
ci_17                -5.096241e-03 3 1  ON 16
ci_18                -5.604727e-03 3 1  ON 17
ci_19                 1.024813e-02 3 1  ON 18
ci_20                 6.250416e-03 3 1  ON 19
ci_21                 8.485643e-03 3 1  ON 20
ci_22                 8.839746e-03 3 1  ON 21
ci_23                 4.201816e-03 3 1  ON 22
ci_24                 5.084926e-03 3 1  ON 23
ci_25                 2.980222e-03 3 1  ON 24
ci_26                 3.787366e-03 3 1  ON 25
ci_27                 3.331871e-03 3 1  ON 26
ci_28                 7.862627e-04 3 1  ON 27
ci_29                 1.174477e-03 3 1  ON 28
ci_30                -7.247143e-04 3 1  ON 29
ci_31                 1.002252e-03 3 1  ON 30
ci_32                -6.566506e-04 3 1  ON 31
ci_33                -1.040451e-03 3 1  ON 32
ci_34                 1.203784e-03 3 1  ON 33
ci_35                 1.322215e-03 3 1  ON 34
ci_36                -6.181363e-04 3 1  ON 35
ci_37                -5.411119e-04 3 1  ON 36
ci_38                -2.597364e-04 3 1  ON 37
ci_39                -1.575825e-04 3 1  ON 38
ci_40                -1.842180e-03 3 1  ON 39
ci_41                -5.599861e-04 3 1  ON 40
ci_42                -1.608542e-03 3 1  ON 41
ci_43                -1.376204e-03 3 1  ON 42
ci_44                -2.230229e-03 3 1  ON 43
ci_45                -2.697906e-04 3 1  ON 44
ci_46                -1.594422e-03 3 1  ON 45
ci_47                 1.398924e-03 3 1  ON 46
ci_48                 2.890131e-03 3 1  ON 47
ci_49                -8.679883e-04 3 1  ON 48
ci_50                -7.823441e-04 3 1  ON 49
ci_51                -4.944109e-04 3 1  ON 50
ci_52                -5.959344e-04 3 1  ON 51
ci_53                -7.839108e-04 3 1  ON 52
ci_54                -1.101724e-03 3 1  ON 53
ci_55                -1.211227e-03 3 1  ON 54
ci_56                 1.132162e-03 3 1  ON 55
ci_57                 2.080482e-03 3 1  ON 56
ci_58                -2.645184e-04 3 1  ON 57
ci_59                -5.636757e-04 3 1  ON 58
ci_60                 7.453272e-05 3 1  ON 59
ci_61                -1.004481e-03 3 1  ON 60
ci_62                -3.908896e-04 3 1  ON 61
ci_63                -2.759421e-04 3 1  ON 62
ci_64                -5.997359e-04 3 1  ON 63
ci_65                -4.201169e-05 3 1  ON 64
ci_66                -1.519027e-04 3 1  ON 65
ci_67                -2.335847e-04 3 1  ON 66
ci_68                -1.705701e-03 3 1  ON 67
ci_69                -1.775152e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.1752e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2819e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -22.7765
    reference variance = 0.285049
====================================================
  Execution time = 2.5226e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5349e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4748e-01
  Total weights = 1.964850225e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5445e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436219282667
                                         uncertainty =       0.002080522316

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436219282667
                                         uncertainty =       0.002080522316

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467071504
  error estimate for blocks of size 2^( 2) =       0.000492720522
  error estimate for blocks of size 2^( 3) =       0.000516850729
  error estimate for blocks of size 2^( 4) =       0.000534568249
  error estimate for blocks of size 2^( 5) =       0.000545580472
  error estimate for blocks of size 2^( 6) =       0.000551164643
  error estimate for blocks of size 2^( 7) =       0.000555176293

      target function =      -0.747440686487
              le_mean =     -22.814081499787
             les_mean =     520.929798317542
             stat err =       0.000546622414
             autocorr =       1.369645351083
   target nu stat err =       0.000546622414
   target dn stat err =       0.002448382139
      target stat err =       0.002127992829
              std dev =       0.660538855942
             le_variance =       0.436311580210


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281408149979e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747445730564       residual = 2.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747447211012       residual = 4.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747447448111       residual = 8.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747447489042       residual = 2.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747447519049       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747447521112       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747447523897       residual = 3.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747447523946       residual = 3.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747447524097       residual = 4.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+01 is 2.395252e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747445730564       residual = 2.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747446101569       residual = 4.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747446160930       residual = 8.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747446171163       residual = 2.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747446178661       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747446179172       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747446179867       residual = 3.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747446179879       residual = 3.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747446179916       residual = 4.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+01 is 5.996040e-06

solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747445730564       residual = 2.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747445823371       residual = 4.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747445838217       residual = 8.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747445840775       residual = 2.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747445842649       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747445842777       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747445842950       residual = 3.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747445842953       residual = 3.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747445842962       residual = 4.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+02 is 1.499505e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.042172 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9779e+01
  </log>
  <optVariables href="FORM2.s010.opt.xml">
ci_01                 1.086464e-01 3 1  ON 0
ci_02                -2.430116e-02 3 1  ON 1
ci_03                -2.454106e-02 3 1  ON 2
ci_04                 2.241708e-02 3 1  ON 3
ci_05                -1.919553e-02 3 1  ON 4
ci_06                -1.973020e-02 3 1  ON 5
ci_07                 2.582853e-02 3 1  ON 6
ci_08                -4.237255e-03 3 1  ON 7
ci_09                -7.569668e-03 3 1  ON 8
ci_10                -7.620523e-03 3 1  ON 9
ci_11                 1.374083e-02 3 1  ON 10
ci_12                 6.969405e-03 3 1  ON 11
ci_13                 1.379126e-02 3 1  ON 12
ci_14                 1.283311e-02 3 1  ON 13
ci_15                 5.313795e-03 3 1  ON 14
ci_16                 5.754511e-03 3 1  ON 15
ci_17                -5.095480e-03 3 1  ON 16
ci_18                -5.605997e-03 3 1  ON 17
ci_19                 1.024696e-02 3 1  ON 18
ci_20                 6.251614e-03 3 1  ON 19
ci_21                 8.485401e-03 3 1  ON 20
ci_22                 8.838929e-03 3 1  ON 21
ci_23                 4.202135e-03 3 1  ON 22
ci_24                 5.084498e-03 3 1  ON 23
ci_25                 2.981542e-03 3 1  ON 24
ci_26                 3.786489e-03 3 1  ON 25
ci_27                 3.333003e-03 3 1  ON 26
ci_28                 7.867661e-04 3 1  ON 27
ci_29                 1.175503e-03 3 1  ON 28
ci_30                -7.252124e-04 3 1  ON 29
ci_31                 1.001739e-03 3 1  ON 30
ci_32                -6.569471e-04 3 1  ON 31
ci_33                -1.040645e-03 3 1  ON 32
ci_34                 1.204129e-03 3 1  ON 33
ci_35                 1.322583e-03 3 1  ON 34
ci_36                -6.185478e-04 3 1  ON 35
ci_37                -5.419719e-04 3 1  ON 36
ci_38                -2.599484e-04 3 1  ON 37
ci_39                -1.579286e-04 3 1  ON 38
ci_40                -1.841039e-03 3 1  ON 39
ci_41                -5.604950e-04 3 1  ON 40
ci_42                -1.608407e-03 3 1  ON 41
ci_43                -1.376424e-03 3 1  ON 42
ci_44                -2.230774e-03 3 1  ON 43
ci_45                -2.693941e-04 3 1  ON 44
ci_46                -1.593576e-03 3 1  ON 45
ci_47                 1.400165e-03 3 1  ON 46
ci_48                 2.890091e-03 3 1  ON 47
ci_49                -8.680459e-04 3 1  ON 48
ci_50                -7.825606e-04 3 1  ON 49
ci_51                -4.947892e-04 3 1  ON 50
ci_52                -5.947412e-04 3 1  ON 51
ci_53                -7.836312e-04 3 1  ON 52
ci_54                -1.100661e-03 3 1  ON 53
ci_55                -1.210996e-03 3 1  ON 54
ci_56                 1.133186e-03 3 1  ON 55
ci_57                 2.081026e-03 3 1  ON 56
ci_58                -2.647925e-04 3 1  ON 57
ci_59                -5.630339e-04 3 1  ON 58
ci_60                 7.424055e-05 3 1  ON 59
ci_61                -1.004065e-03 3 1  ON 60
ci_62                -3.901939e-04 3 1  ON 61
ci_63                -2.766150e-04 3 1  ON 62
ci_64                -5.983757e-04 3 1  ON 63
ci_65                -4.264835e-05 3 1  ON 64
ci_66                -1.522479e-04 3 1  ON 65
ci_67                -2.336133e-04 3 1  ON 66
ci_68                -1.703524e-03 3 1  ON 67
ci_69                -1.774012e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -22.8379
    reference variance = 0.271409
====================================================
  Execution time = 2.4787e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4457e-01
  Total weights = 1.9649e+06
  Execution time = 3.4983e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432975696449
                                         uncertainty =       0.001662324626

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432975696449
                                         uncertainty =       0.001662324626

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465242009
  error estimate for blocks of size 2^( 2) =       0.000491033176
  error estimate for blocks of size 2^( 3) =       0.000515310057
  error estimate for blocks of size 2^( 4) =       0.000532840010
  error estimate for blocks of size 2^( 5) =       0.000544820081
  error estimate for blocks of size 2^( 6) =       0.000551028996
  error estimate for blocks of size 2^( 7) =       0.000554754460

      target function =      -0.749880775853
              le_mean =     -22.814611188475
             les_mean =     520.951049662404
             stat err =       0.000545860887
             autocorr =       1.376594746282
   target nu stat err =       0.000545860887
   target dn stat err =       0.002633625857
      target stat err =       0.002292175437
              std dev =       0.657951559284
             le_variance =       0.432900254364

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432975581669
                                         uncertainty =       0.001662538383

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432975581669
                                         uncertainty =       0.001662538383

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465241947
  error estimate for blocks of size 2^( 2) =       0.000491032147
  error estimate for blocks of size 2^( 3) =       0.000515308006
  error estimate for blocks of size 2^( 4) =       0.000532837149
  error estimate for blocks of size 2^( 5) =       0.000544816735
  error estimate for blocks of size 2^( 6) =       0.000551025817
  error estimate for blocks of size 2^( 7) =       0.000554750995

      target function =      -0.749875531310
              le_mean =     -22.814611203443
             les_mean =     520.951056594453
             stat err =       0.000545857674
             autocorr =       1.376578909712
   target nu stat err =       0.000545857674
   target dn stat err =       0.002634117406
      target stat err =       0.002292541066
              std dev =       0.657951471423
             le_variance =       0.432900138748

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432975635627
                                         uncertainty =       0.001662431706

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432975635627
                                         uncertainty =       0.001662431706

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465241976
  error estimate for blocks of size 2^( 2) =       0.000491032659
  error estimate for blocks of size 2^( 3) =       0.000515309027
  error estimate for blocks of size 2^( 4) =       0.000532838575
  error estimate for blocks of size 2^( 5) =       0.000544818403
  error estimate for blocks of size 2^( 6) =       0.000551027402
  error estimate for blocks of size 2^( 7) =       0.000554752723

      target function =      -0.749878468820
              le_mean =     -22.814611195390
             les_mean =     520.951052726677
             stat err =       0.000545859276
             autocorr =       1.376586815339
   target nu stat err =       0.000545859276
   target dn stat err =       0.002633870262
      target stat err =       0.002292359000
              std dev =       0.657951512746
             le_variance =       0.432900193124

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432975688486
                                         uncertainty =       0.001662338013

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432975688486
                                         uncertainty =       0.001662338013

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465242005
  error estimate for blocks of size 2^( 2) =       0.000491033111
  error estimate for blocks of size 2^( 3) =       0.000515309928
  error estimate for blocks of size 2^( 4) =       0.000532839831
  error estimate for blocks of size 2^( 5) =       0.000544819871
  error estimate for blocks of size 2^( 6) =       0.000551028797
  error estimate for blocks of size 2^( 7) =       0.000554754243

      target function =      -0.749880515481
              le_mean =     -22.814611189278
             les_mean =     520.951050009270
             stat err =       0.000545860685
             autocorr =       1.376593754751
   target nu stat err =       0.000545860685
   target dn stat err =       0.002633656221
      target stat err =       0.002292198396
              std dev =       0.657951553193
             le_variance =       0.432900246349


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.749880775853        initial  <--
     1.5625e+01     1.5625e+02             2.3953e-05        -0.749875531310
     6.2500e+01     6.2500e+02             5.9960e-06        -0.749878468820
     2.5000e+02     2.5000e+03             1.4995e-06        -0.749880515481

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.2572
  </log>
  <optVariables href="FORM2.s010.opt.xml">
ci_01                 1.086404e-01 3 1  ON 0
ci_02                -2.429814e-02 3 1  ON 1
ci_03                -2.453934e-02 3 1  ON 2
ci_04                 2.241553e-02 3 1  ON 3
ci_05                -1.919421e-02 3 1  ON 4
ci_06                -1.972787e-02 3 1  ON 5
ci_07                 2.582823e-02 3 1  ON 6
ci_08                -4.237443e-03 3 1  ON 7
ci_09                -7.570476e-03 3 1  ON 8
ci_10                -7.621185e-03 3 1  ON 9
ci_11                 1.374048e-02 3 1  ON 10
ci_12                 6.969065e-03 3 1  ON 11
ci_13                 1.379084e-02 3 1  ON 12
ci_14                 1.283330e-02 3 1  ON 13
ci_15                 5.312637e-03 3 1  ON 14
ci_16                 5.753962e-03 3 1  ON 15
ci_17                -5.096241e-03 3 1  ON 16
ci_18                -5.604727e-03 3 1  ON 17
ci_19                 1.024813e-02 3 1  ON 18
ci_20                 6.250416e-03 3 1  ON 19
ci_21                 8.485643e-03 3 1  ON 20
ci_22                 8.839746e-03 3 1  ON 21
ci_23                 4.201816e-03 3 1  ON 22
ci_24                 5.084926e-03 3 1  ON 23
ci_25                 2.980222e-03 3 1  ON 24
ci_26                 3.787366e-03 3 1  ON 25
ci_27                 3.331871e-03 3 1  ON 26
ci_28                 7.862627e-04 3 1  ON 27
ci_29                 1.174477e-03 3 1  ON 28
ci_30                -7.247143e-04 3 1  ON 29
ci_31                 1.002252e-03 3 1  ON 30
ci_32                -6.566506e-04 3 1  ON 31
ci_33                -1.040451e-03 3 1  ON 32
ci_34                 1.203784e-03 3 1  ON 33
ci_35                 1.322215e-03 3 1  ON 34
ci_36                -6.181363e-04 3 1  ON 35
ci_37                -5.411119e-04 3 1  ON 36
ci_38                -2.597364e-04 3 1  ON 37
ci_39                -1.575825e-04 3 1  ON 38
ci_40                -1.842180e-03 3 1  ON 39
ci_41                -5.599861e-04 3 1  ON 40
ci_42                -1.608542e-03 3 1  ON 41
ci_43                -1.376204e-03 3 1  ON 42
ci_44                -2.230229e-03 3 1  ON 43
ci_45                -2.697906e-04 3 1  ON 44
ci_46                -1.594422e-03 3 1  ON 45
ci_47                 1.398924e-03 3 1  ON 46
ci_48                 2.890131e-03 3 1  ON 47
ci_49                -8.679883e-04 3 1  ON 48
ci_50                -7.823441e-04 3 1  ON 49
ci_51                -4.944109e-04 3 1  ON 50
ci_52                -5.959344e-04 3 1  ON 51
ci_53                -7.839108e-04 3 1  ON 52
ci_54                -1.101724e-03 3 1  ON 53
ci_55                -1.211227e-03 3 1  ON 54
ci_56                 1.132162e-03 3 1  ON 55
ci_57                 2.080482e-03 3 1  ON 56
ci_58                -2.645184e-04 3 1  ON 57
ci_59                -5.636757e-04 3 1  ON 58
ci_60                 7.453272e-05 3 1  ON 59
ci_61                -1.004481e-03 3 1  ON 60
ci_62                -3.908896e-04 3 1  ON 61
ci_63                -2.759421e-04 3 1  ON 62
ci_64                -5.997359e-04 3 1  ON 63
ci_65                -4.201169e-05 3 1  ON 64
ci_66                -1.519027e-04 3 1  ON 65
ci_67                -2.335847e-04 3 1  ON 66
ci_68                -1.705701e-03 3 1  ON 67
ci_69                -1.775152e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3043e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2818e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -22.8276
    reference variance = 0.483756
====================================================
  Execution time = 2.5239e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5363e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5564e-01
  Total weights = 1.964803138e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5508e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441184732395
                                         uncertainty =       0.004567746050

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441184732395
                                         uncertainty =       0.004567746050

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469682944
  error estimate for blocks of size 2^( 2) =       0.000495317162
  error estimate for blocks of size 2^( 3) =       0.000518932579
  error estimate for blocks of size 2^( 4) =       0.000537103709
  error estimate for blocks of size 2^( 5) =       0.000548940640
  error estimate for blocks of size 2^( 6) =       0.000558180561
  error estimate for blocks of size 2^( 7) =       0.000564003817

      target function =      -0.740681318777
              le_mean =     -22.813559045666
             les_mean =     520.914118625162
             stat err =       0.000552057182
             autocorr =       1.381524365339
   target nu stat err =       0.000552057182
   target dn stat err =       0.006261013716
      target stat err =       0.005152546908
              std dev =       0.664231989574
             le_variance =       0.441204135973


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281355904567e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.740715822085       residual = 3.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.740716054436       residual = 6.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.740716093128       residual = 9.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.740716100716       residual = 3.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.740716103872       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.740716104392       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.740716104277       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.740716104232       residual = 3.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.740716104225       residual = 9.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+02 is 2.581482e-06

solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.740715822085       residual = 3.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.740715880186       residual = 6.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.740715889861       residual = 9.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.740715891758       residual = 3.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.740715892547       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.740715892676       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.740715892647       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.740715892635       residual = 3.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.740715892634       residual = 9.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+02 is 6.454461e-07

solving harmonic davidson linear method for identity shift 2.5000e+03, overlap shift 2.5000e+04 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.740715822085       residual = 3.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.740715836611       residual = 6.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.740715839030       residual = 9.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.740715839504       residual = 3.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.740715839701       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.740715839734       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.740715839727       residual = 2.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.740715839727       residual = 3.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.740715839723       residual = 9.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+03 is 1.613663e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.045276 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9798e+01
  </log>
  <optVariables href="FORM2.s011.opt.xml">
ci_01                 1.086410e-01 3 1  ON 0
ci_02                -2.429835e-02 3 1  ON 1
ci_03                -2.453957e-02 3 1  ON 2
ci_04                 2.241582e-02 3 1  ON 3
ci_05                -1.919420e-02 3 1  ON 4
ci_06                -1.972788e-02 3 1  ON 5
ci_07                 2.582824e-02 3 1  ON 6
ci_08                -4.237564e-03 3 1  ON 7
ci_09                -7.570463e-03 3 1  ON 8
ci_10                -7.621250e-03 3 1  ON 9
ci_11                 1.374037e-02 3 1  ON 10
ci_12                 6.968966e-03 3 1  ON 11
ci_13                 1.379081e-02 3 1  ON 12
ci_14                 1.283332e-02 3 1  ON 13
ci_15                 5.312663e-03 3 1  ON 14
ci_16                 5.753367e-03 3 1  ON 15
ci_17                -5.096316e-03 3 1  ON 16
ci_18                -5.605037e-03 3 1  ON 17
ci_19                 1.024803e-02 3 1  ON 18
ci_20                 6.250400e-03 3 1  ON 19
ci_21                 8.485618e-03 3 1  ON 20
ci_22                 8.839610e-03 3 1  ON 21
ci_23                 4.201923e-03 3 1  ON 22
ci_24                 5.084795e-03 3 1  ON 23
ci_25                 2.980174e-03 3 1  ON 24
ci_26                 3.787615e-03 3 1  ON 25
ci_27                 3.331886e-03 3 1  ON 26
ci_28                 7.862987e-04 3 1  ON 27
ci_29                 1.174408e-03 3 1  ON 28
ci_30                -7.247336e-04 3 1  ON 29
ci_31                 1.002253e-03 3 1  ON 30
ci_32                -6.566072e-04 3 1  ON 31
ci_33                -1.040464e-03 3 1  ON 32
ci_34                 1.203863e-03 3 1  ON 33
ci_35                 1.322116e-03 3 1  ON 34
ci_36                -6.181262e-04 3 1  ON 35
ci_37                -5.411917e-04 3 1  ON 36
ci_38                -2.597045e-04 3 1  ON 37
ci_39                -1.576017e-04 3 1  ON 38
ci_40                -1.842163e-03 3 1  ON 39
ci_41                -5.599658e-04 3 1  ON 40
ci_42                -1.608457e-03 3 1  ON 41
ci_43                -1.376233e-03 3 1  ON 42
ci_44                -2.230050e-03 3 1  ON 43
ci_45                -2.697293e-04 3 1  ON 44
ci_46                -1.594281e-03 3 1  ON 45
ci_47                 1.399014e-03 3 1  ON 46
ci_48                 2.890121e-03 3 1  ON 47
ci_49                -8.680157e-04 3 1  ON 48
ci_50                -7.823347e-04 3 1  ON 49
ci_51                -4.943683e-04 3 1  ON 50
ci_52                -5.958808e-04 3 1  ON 51
ci_53                -7.839798e-04 3 1  ON 52
ci_54                -1.101598e-03 3 1  ON 53
ci_55                -1.211177e-03 3 1  ON 54
ci_56                 1.132285e-03 3 1  ON 55
ci_57                 2.080615e-03 3 1  ON 56
ci_58                -2.645493e-04 3 1  ON 57
ci_59                -5.637127e-04 3 1  ON 58
ci_60                 7.447637e-05 3 1  ON 59
ci_61                -1.004545e-03 3 1  ON 60
ci_62                -3.908825e-04 3 1  ON 61
ci_63                -2.759382e-04 3 1  ON 62
ci_64                -5.997370e-04 3 1  ON 63
ci_65                -4.211426e-05 3 1  ON 64
ci_66                -1.519143e-04 3 1  ON 65
ci_67                -2.336740e-04 3 1  ON 66
ci_68                -1.705710e-03 3 1  ON 67
ci_69                -1.775082e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -22.7126
    reference variance = 1.03753
====================================================
  Execution time = 2.4629e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5815e-01
  Total weights = 1.9646e+06
  Execution time = 3.4955e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443383374698
                                         uncertainty =       0.005890835787

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443383374698
                                         uncertainty =       0.005890835787

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470860510
  error estimate for blocks of size 2^( 2) =       0.000496318383
  error estimate for blocks of size 2^( 3) =       0.000520766814
  error estimate for blocks of size 2^( 4) =       0.000538999545
  error estimate for blocks of size 2^( 5) =       0.000549860370
  error estimate for blocks of size 2^( 6) =       0.000555705753
  error estimate for blocks of size 2^( 7) =       0.000561724146

      target function =      -0.738629286924
              le_mean =     -22.813945206323
             les_mean =     520.934238986464
             stat err =       0.000551572453
             autocorr =       1.372210064411
   target nu stat err =       0.000551572453
   target dn stat err =       0.007082356110
      target stat err =       0.005790904138
              std dev =       0.665897318765
             le_variance =       0.443419239138

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443383080161
                                         uncertainty =       0.005890694289

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443383080161
                                         uncertainty =       0.005890694289

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470860353
  error estimate for blocks of size 2^( 2) =       0.000496318151
  error estimate for blocks of size 2^( 3) =       0.000520766478
  error estimate for blocks of size 2^( 4) =       0.000538999151
  error estimate for blocks of size 2^( 5) =       0.000549859912
  error estimate for blocks of size 2^( 6) =       0.000555705268
  error estimate for blocks of size 2^( 7) =       0.000561723563

      target function =      -0.738595927435
              le_mean =     -22.813945190077
             les_mean =     520.934279209229
             stat err =       0.000551571974
             autocorr =       1.372208591255
   target nu stat err =       0.000551571974
   target dn stat err =       0.007086733816
      target stat err =       0.005793923927
              std dev =       0.665897096862
             le_variance =       0.443418943609

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443383227359
                                         uncertainty =       0.005890765041

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443383227359
                                         uncertainty =       0.005890765041

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470860431
  error estimate for blocks of size 2^( 2) =       0.000496318267
  error estimate for blocks of size 2^( 3) =       0.000520766646
  error estimate for blocks of size 2^( 4) =       0.000538999348
  error estimate for blocks of size 2^( 5) =       0.000549860141
  error estimate for blocks of size 2^( 6) =       0.000555705510
  error estimate for blocks of size 2^( 7) =       0.000561723855

      target function =      -0.738619373083
              le_mean =     -22.813945198192
             les_mean =     520.934250775687
             stat err =       0.000551572213
             autocorr =       1.372209328063
   target nu stat err =       0.000551572213
   target dn stat err =       0.007084505728
      target stat err =       0.005792487920
              std dev =       0.665897207760
             le_variance =       0.443419091303

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443383356274
                                         uncertainty =       0.005890826944

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443383356274
                                         uncertainty =       0.005890826944

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470860500
  error estimate for blocks of size 2^( 2) =       0.000496318369
  error estimate for blocks of size 2^( 3) =       0.000520766793
  error estimate for blocks of size 2^( 4) =       0.000538999520
  error estimate for blocks of size 2^( 5) =       0.000549860341
  error estimate for blocks of size 2^( 6) =       0.000555705722
  error estimate for blocks of size 2^( 7) =       0.000561724110

      target function =      -0.738628113139
              le_mean =     -22.813945205307
             les_mean =     520.934240379641
             stat err =       0.000551572423
             autocorr =       1.372209972388
   target nu stat err =       0.000551572423
   target dn stat err =       0.007082621758
      target stat err =       0.005791100666
              std dev =       0.665897304884
             le_variance =       0.443419220652


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.738629286924        initial  <--
     1.5625e+02     1.5625e+03             2.5815e-06        -0.738595927435
     6.2500e+02     6.2500e+03             6.4545e-07        -0.738619373083
     2.5000e+03     2.5000e+04             1.6137e-07        -0.738628113139

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.1302
  </log>
  <optVariables href="FORM2.s011.opt.xml">
ci_01                 1.086404e-01 3 1  ON 0
ci_02                -2.429814e-02 3 1  ON 1
ci_03                -2.453934e-02 3 1  ON 2
ci_04                 2.241553e-02 3 1  ON 3
ci_05                -1.919421e-02 3 1  ON 4
ci_06                -1.972787e-02 3 1  ON 5
ci_07                 2.582823e-02 3 1  ON 6
ci_08                -4.237443e-03 3 1  ON 7
ci_09                -7.570476e-03 3 1  ON 8
ci_10                -7.621185e-03 3 1  ON 9
ci_11                 1.374048e-02 3 1  ON 10
ci_12                 6.969065e-03 3 1  ON 11
ci_13                 1.379084e-02 3 1  ON 12
ci_14                 1.283330e-02 3 1  ON 13
ci_15                 5.312637e-03 3 1  ON 14
ci_16                 5.753962e-03 3 1  ON 15
ci_17                -5.096241e-03 3 1  ON 16
ci_18                -5.604727e-03 3 1  ON 17
ci_19                 1.024813e-02 3 1  ON 18
ci_20                 6.250416e-03 3 1  ON 19
ci_21                 8.485643e-03 3 1  ON 20
ci_22                 8.839746e-03 3 1  ON 21
ci_23                 4.201816e-03 3 1  ON 22
ci_24                 5.084926e-03 3 1  ON 23
ci_25                 2.980222e-03 3 1  ON 24
ci_26                 3.787366e-03 3 1  ON 25
ci_27                 3.331871e-03 3 1  ON 26
ci_28                 7.862627e-04 3 1  ON 27
ci_29                 1.174477e-03 3 1  ON 28
ci_30                -7.247143e-04 3 1  ON 29
ci_31                 1.002252e-03 3 1  ON 30
ci_32                -6.566506e-04 3 1  ON 31
ci_33                -1.040451e-03 3 1  ON 32
ci_34                 1.203784e-03 3 1  ON 33
ci_35                 1.322215e-03 3 1  ON 34
ci_36                -6.181363e-04 3 1  ON 35
ci_37                -5.411119e-04 3 1  ON 36
ci_38                -2.597364e-04 3 1  ON 37
ci_39                -1.575825e-04 3 1  ON 38
ci_40                -1.842180e-03 3 1  ON 39
ci_41                -5.599861e-04 3 1  ON 40
ci_42                -1.608542e-03 3 1  ON 41
ci_43                -1.376204e-03 3 1  ON 42
ci_44                -2.230229e-03 3 1  ON 43
ci_45                -2.697906e-04 3 1  ON 44
ci_46                -1.594422e-03 3 1  ON 45
ci_47                 1.398924e-03 3 1  ON 46
ci_48                 2.890131e-03 3 1  ON 47
ci_49                -8.679883e-04 3 1  ON 48
ci_50                -7.823441e-04 3 1  ON 49
ci_51                -4.944109e-04 3 1  ON 50
ci_52                -5.959344e-04 3 1  ON 51
ci_53                -7.839108e-04 3 1  ON 52
ci_54                -1.101724e-03 3 1  ON 53
ci_55                -1.211227e-03 3 1  ON 54
ci_56                 1.132162e-03 3 1  ON 55
ci_57                 2.080482e-03 3 1  ON 56
ci_58                -2.645184e-04 3 1  ON 57
ci_59                -5.636757e-04 3 1  ON 58
ci_60                 7.453272e-05 3 1  ON 59
ci_61                -1.004481e-03 3 1  ON 60
ci_62                -3.908896e-04 3 1  ON 61
ci_63                -2.759421e-04 3 1  ON 62
ci_64                -5.997359e-04 3 1  ON 63
ci_65                -4.201169e-05 3 1  ON 64
ci_66                -1.519027e-04 3 1  ON 65
ci_67                -2.335847e-04 3 1  ON 66
ci_68                -1.705701e-03 3 1  ON 67
ci_69                -1.775152e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.1935e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2814e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -22.7292
    reference variance = 0.363789
====================================================
  Execution time = 2.5185e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5351e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4879e-01
  Total weights = 1.964715463e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5260e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435330491030
                                         uncertainty =       0.002032617400

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435330491030
                                         uncertainty =       0.002032617400

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466567104
  error estimate for blocks of size 2^( 2) =       0.000492188132
  error estimate for blocks of size 2^( 3) =       0.000516390074
  error estimate for blocks of size 2^( 4) =       0.000534747766
  error estimate for blocks of size 2^( 5) =       0.000546105377
  error estimate for blocks of size 2^( 6) =       0.000552029315
  error estimate for blocks of size 2^( 7) =       0.000557782392

      target function =      -0.746353289016
              le_mean =     -22.814557429163
             les_mean =     520.952819102526
             stat err =       0.000547666212
             autocorr =       1.377855479036
   target nu stat err =       0.000547666212
   target dn stat err =       0.003013575836
      target stat err =       0.002577317600
              std dev =       0.659825525828
             le_variance =       0.435369724534


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281455742916e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746361247703       residual = 2.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746361259822       residual = 3.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746361261795       residual = 6.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746361262409       residual = 2.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746361262544       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746361262671       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746361262706       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746361262706       residual = 3.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746361262709       residual = 9.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+03 is 1.750408e-07

solving harmonic davidson linear method for identity shift 6.2500e+03, overlap shift 6.2500e+04 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746361247703       residual = 2.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746361250733       residual = 3.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746361251226       residual = 6.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746361251380       residual = 2.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746361251406       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746361251438       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746361251464       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746361251455       residual = 3.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746361251451       residual = 9.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+03 is 4.376077e-08

solving harmonic davidson linear method for identity shift 2.5000e+04, overlap shift 2.5000e+05 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746361247703       residual = 2.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746361248461       residual = 3.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746361248584       residual = 6.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746361248622       residual = 2.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746361248627       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746361248655       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746361248645       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746361248644       residual = 3.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746361248651       residual = 9.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+04 is 1.094023e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.048371 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9719e+01
  </log>
  <optVariables href="FORM2.s012.opt.xml">
ci_01                 1.086404e-01 3 1  ON 0
ci_02                -2.429816e-02 3 1  ON 1
ci_03                -2.453937e-02 3 1  ON 2
ci_04                 2.241555e-02 3 1  ON 3
ci_05                -1.919421e-02 3 1  ON 4
ci_06                -1.972789e-02 3 1  ON 5
ci_07                 2.582824e-02 3 1  ON 6
ci_08                -4.237439e-03 3 1  ON 7
ci_09                -7.570471e-03 3 1  ON 8
ci_10                -7.621192e-03 3 1  ON 9
ci_11                 1.374048e-02 3 1  ON 10
ci_12                 6.969052e-03 3 1  ON 11
ci_13                 1.379083e-02 3 1  ON 12
ci_14                 1.283330e-02 3 1  ON 13
ci_15                 5.312646e-03 3 1  ON 14
ci_16                 5.753968e-03 3 1  ON 15
ci_17                -5.096246e-03 3 1  ON 16
ci_18                -5.604730e-03 3 1  ON 17
ci_19                 1.024812e-02 3 1  ON 18
ci_20                 6.250420e-03 3 1  ON 19
ci_21                 8.485644e-03 3 1  ON 20
ci_22                 8.839748e-03 3 1  ON 21
ci_23                 4.201825e-03 3 1  ON 22
ci_24                 5.084933e-03 3 1  ON 23
ci_25                 2.980209e-03 3 1  ON 24
ci_26                 3.787359e-03 3 1  ON 25
ci_27                 3.331852e-03 3 1  ON 26
ci_28                 7.862631e-04 3 1  ON 27
ci_29                 1.174481e-03 3 1  ON 28
ci_30                -7.247221e-04 3 1  ON 29
ci_31                 1.002237e-03 3 1  ON 30
ci_32                -6.566550e-04 3 1  ON 31
ci_33                -1.040447e-03 3 1  ON 32
ci_34                 1.203783e-03 3 1  ON 33
ci_35                 1.322226e-03 3 1  ON 34
ci_36                -6.181349e-04 3 1  ON 35
ci_37                -5.411154e-04 3 1  ON 36
ci_38                -2.597425e-04 3 1  ON 37
ci_39                -1.575859e-04 3 1  ON 38
ci_40                -1.842174e-03 3 1  ON 39
ci_41                -5.599909e-04 3 1  ON 40
ci_42                -1.608547e-03 3 1  ON 41
ci_43                -1.376200e-03 3 1  ON 42
ci_44                -2.230238e-03 3 1  ON 43
ci_45                -2.697896e-04 3 1  ON 44
ci_46                -1.594417e-03 3 1  ON 45
ci_47                 1.398920e-03 3 1  ON 46
ci_48                 2.890131e-03 3 1  ON 47
ci_49                -8.679833e-04 3 1  ON 48
ci_50                -7.823414e-04 3 1  ON 49
ci_51                -4.944025e-04 3 1  ON 50
ci_52                -5.959252e-04 3 1  ON 51
ci_53                -7.839112e-04 3 1  ON 52
ci_54                -1.101710e-03 3 1  ON 53
ci_55                -1.211221e-03 3 1  ON 54
ci_56                 1.132171e-03 3 1  ON 55
ci_57                 2.080478e-03 3 1  ON 56
ci_58                -2.645177e-04 3 1  ON 57
ci_59                -5.636932e-04 3 1  ON 58
ci_60                 7.454421e-05 3 1  ON 59
ci_61                -1.004474e-03 3 1  ON 60
ci_62                -3.908888e-04 3 1  ON 61
ci_63                -2.759463e-04 3 1  ON 62
ci_64                -5.997412e-04 3 1  ON 63
ci_65                -4.200674e-05 3 1  ON 64
ci_66                -1.519083e-04 3 1  ON 65
ci_67                -2.335831e-04 3 1  ON 66
ci_68                -1.705689e-03 3 1  ON 67
ci_69                -1.775144e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -22.8534
    reference variance = 0.377923
====================================================
  Execution time = 2.4405e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5168e-01
  Total weights = 1.9646e+06
  Execution time = 3.4894e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438321843385
                                         uncertainty =       0.002383274542

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438321843385
                                         uncertainty =       0.002383274542

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468140599
  error estimate for blocks of size 2^( 2) =       0.000493683702
  error estimate for blocks of size 2^( 3) =       0.000518493785
  error estimate for blocks of size 2^( 4) =       0.000536432318
  error estimate for blocks of size 2^( 5) =       0.000548554321
  error estimate for blocks of size 2^( 6) =       0.000554498322
  error estimate for blocks of size 2^( 7) =       0.000557854614

      target function =      -0.743959294488
              le_mean =     -22.814660721499
             les_mean =     520.960421585198
             stat err =       0.000549334894
             autocorr =       1.376961378223
   target nu stat err =       0.000549334894
   target dn stat err =       0.003096626179
      target stat err =       0.002628768752
              std dev =       0.662050784382
             le_variance =       0.438311241101

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438321812416
                                         uncertainty =       0.002383268132

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438321812416
                                         uncertainty =       0.002383268132

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468140583
  error estimate for blocks of size 2^( 2) =       0.000493683678
  error estimate for blocks of size 2^( 3) =       0.000518493751
  error estimate for blocks of size 2^( 4) =       0.000536432278
  error estimate for blocks of size 2^( 5) =       0.000548554276
  error estimate for blocks of size 2^( 6) =       0.000554498274
  error estimate for blocks of size 2^( 7) =       0.000557854563

      target function =      -0.743959122953
              le_mean =     -22.814660721392
             les_mean =     520.960421787988
             stat err =       0.000549334848
             autocorr =       1.376961244841
   target nu stat err =       0.000549334848
   target dn stat err =       0.003096634877
      target stat err =       0.002628774547
              std dev =       0.662050761098
             le_variance =       0.438311210271

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438321827900
                                         uncertainty =       0.002383271337

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438321827900
                                         uncertainty =       0.002383271337

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468140591
  error estimate for blocks of size 2^( 2) =       0.000493683690
  error estimate for blocks of size 2^( 3) =       0.000518493768
  error estimate for blocks of size 2^( 4) =       0.000536432298
  error estimate for blocks of size 2^( 5) =       0.000548554299
  error estimate for blocks of size 2^( 6) =       0.000554498298
  error estimate for blocks of size 2^( 7) =       0.000557854588

      target function =      -0.743959208743
              le_mean =     -22.814660721445
             les_mean =     520.960421686563
             stat err =       0.000549334871
             autocorr =       1.376961311539
   target nu stat err =       0.000549334871
   target dn stat err =       0.003096630526
      target stat err =       0.002628771648
              std dev =       0.662050772740
             le_variance =       0.438311225685

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438321841450
                                         uncertainty =       0.002383274141

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438321841450
                                         uncertainty =       0.002383274141

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468140598
  error estimate for blocks of size 2^( 2) =       0.000493683701
  error estimate for blocks of size 2^( 3) =       0.000518493783
  error estimate for blocks of size 2^( 4) =       0.000536432315
  error estimate for blocks of size 2^( 5) =       0.000548554319
  error estimate for blocks of size 2^( 6) =       0.000554498319
  error estimate for blocks of size 2^( 7) =       0.000557854610

      target function =      -0.743959283772
              le_mean =     -22.814660721492
             les_mean =     520.960421597866
             stat err =       0.000549334891
             autocorr =       1.376961369887
   target nu stat err =       0.000549334891
   target dn stat err =       0.003096626722
      target stat err =       0.002628769114
              std dev =       0.662050782927
             le_variance =       0.438311239174


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743959294488        initial  <--
     1.5625e+03     1.5625e+04             1.7504e-07        -0.743959122953
     6.2500e+03     6.2500e+04             4.3761e-08        -0.743959208743
     2.5000e+04     2.5000e+05             1.0940e-08        -0.743959283772

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.8712
  </log>
  <optVariables href="FORM2.s012.opt.xml">
ci_01                 1.086404e-01 3 1  ON 0
ci_02                -2.429814e-02 3 1  ON 1
ci_03                -2.453934e-02 3 1  ON 2
ci_04                 2.241553e-02 3 1  ON 3
ci_05                -1.919421e-02 3 1  ON 4
ci_06                -1.972787e-02 3 1  ON 5
ci_07                 2.582823e-02 3 1  ON 6
ci_08                -4.237443e-03 3 1  ON 7
ci_09                -7.570476e-03 3 1  ON 8
ci_10                -7.621185e-03 3 1  ON 9
ci_11                 1.374048e-02 3 1  ON 10
ci_12                 6.969065e-03 3 1  ON 11
ci_13                 1.379084e-02 3 1  ON 12
ci_14                 1.283330e-02 3 1  ON 13
ci_15                 5.312637e-03 3 1  ON 14
ci_16                 5.753962e-03 3 1  ON 15
ci_17                -5.096241e-03 3 1  ON 16
ci_18                -5.604727e-03 3 1  ON 17
ci_19                 1.024813e-02 3 1  ON 18
ci_20                 6.250416e-03 3 1  ON 19
ci_21                 8.485643e-03 3 1  ON 20
ci_22                 8.839746e-03 3 1  ON 21
ci_23                 4.201816e-03 3 1  ON 22
ci_24                 5.084926e-03 3 1  ON 23
ci_25                 2.980222e-03 3 1  ON 24
ci_26                 3.787366e-03 3 1  ON 25
ci_27                 3.331871e-03 3 1  ON 26
ci_28                 7.862627e-04 3 1  ON 27
ci_29                 1.174477e-03 3 1  ON 28
ci_30                -7.247143e-04 3 1  ON 29
ci_31                 1.002252e-03 3 1  ON 30
ci_32                -6.566506e-04 3 1  ON 31
ci_33                -1.040451e-03 3 1  ON 32
ci_34                 1.203784e-03 3 1  ON 33
ci_35                 1.322215e-03 3 1  ON 34
ci_36                -6.181363e-04 3 1  ON 35
ci_37                -5.411119e-04 3 1  ON 36
ci_38                -2.597364e-04 3 1  ON 37
ci_39                -1.575825e-04 3 1  ON 38
ci_40                -1.842180e-03 3 1  ON 39
ci_41                -5.599861e-04 3 1  ON 40
ci_42                -1.608542e-03 3 1  ON 41
ci_43                -1.376204e-03 3 1  ON 42
ci_44                -2.230229e-03 3 1  ON 43
ci_45                -2.697906e-04 3 1  ON 44
ci_46                -1.594422e-03 3 1  ON 45
ci_47                 1.398924e-03 3 1  ON 46
ci_48                 2.890131e-03 3 1  ON 47
ci_49                -8.679883e-04 3 1  ON 48
ci_50                -7.823441e-04 3 1  ON 49
ci_51                -4.944109e-04 3 1  ON 50
ci_52                -5.959344e-04 3 1  ON 51
ci_53                -7.839108e-04 3 1  ON 52
ci_54                -1.101724e-03 3 1  ON 53
ci_55                -1.211227e-03 3 1  ON 54
ci_56                 1.132162e-03 3 1  ON 55
ci_57                 2.080482e-03 3 1  ON 56
ci_58                -2.645184e-04 3 1  ON 57
ci_59                -5.636757e-04 3 1  ON 58
ci_60                 7.453272e-05 3 1  ON 59
ci_61                -1.004481e-03 3 1  ON 60
ci_62                -3.908896e-04 3 1  ON 61
ci_63                -2.759421e-04 3 1  ON 62
ci_64                -5.997359e-04 3 1  ON 63
ci_65                -4.201169e-05 3 1  ON 64
ci_66                -1.519027e-04 3 1  ON 65
ci_67                -2.335847e-04 3 1  ON 66
ci_68                -1.705701e-03 3 1  ON 67
ci_69                -1.775152e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4597e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2812e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -22.7949
    reference variance = 0.495874
====================================================
  Execution time = 2.5126e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5338e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4817e-01
  Total weights = 1.964660430e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5178e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435883275001
                                         uncertainty =       0.001868208403

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435883275001
                                         uncertainty =       0.001868208403

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466847723
  error estimate for blocks of size 2^( 2) =       0.000492557006
  error estimate for blocks of size 2^( 3) =       0.000516528151
  error estimate for blocks of size 2^( 4) =       0.000534444572
  error estimate for blocks of size 2^( 5) =       0.000547658285
  error estimate for blocks of size 2^( 6) =       0.000553806855
  error estimate for blocks of size 2^( 7) =       0.000556434554

      target function =      -0.746866462870
              le_mean =     -22.814527763131
             les_mean =     520.950851631211
             stat err =       0.000548086067
             autocorr =       1.378310400355
   target nu stat err =       0.000548086067
   target dn stat err =       0.002485733443
      target stat err =       0.002156529181
              std dev =       0.660222381503
             le_variance =       0.435893593037


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281452776313e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+04, overlap shift 1.5625e+05 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746871629406       residual = 2.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746871630637       residual = 3.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746871630865       residual = 5.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746871630905       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746871630917       residual = 7.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746871630941       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746871630939       residual = 3.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746871630927       residual = 8.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746871630932       residual = 2.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746871630899       residual = 8.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+04 is 1.318910e-08

solving harmonic davidson linear method for identity shift 6.2500e+04, overlap shift 6.2500e+05 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746871629406       residual = 2.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746871629714       residual = 3.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746871629771       residual = 5.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746871629781       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746871629803       residual = 7.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746871629779       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746871629693       residual = 3.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746871629802       residual = 8.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746871629787       residual = 2.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746871629808       residual = 8.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+04 is 3.297279e-09

solving harmonic davidson linear method for identity shift 2.5000e+05, overlap shift 2.5000e+06 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746871629406       residual = 2.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746871629483       residual = 3.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746871629497       residual = 5.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746871629500       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746871629505       residual = 7.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746871629660       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746871629514       residual = 3.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746871629174       residual = 8.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746871629091       residual = 2.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746871629248       residual = 8.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+05 is 8.243202e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.051948 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9652e+01
  </log>
  <optVariables href="FORM2.s013.opt.xml">
ci_01                 1.086404e-01 3 1  ON 0
ci_02                -2.429814e-02 3 1  ON 1
ci_03                -2.453935e-02 3 1  ON 2
ci_04                 2.241553e-02 3 1  ON 3
ci_05                -1.919421e-02 3 1  ON 4
ci_06                -1.972787e-02 3 1  ON 5
ci_07                 2.582823e-02 3 1  ON 6
ci_08                -4.237443e-03 3 1  ON 7
ci_09                -7.570476e-03 3 1  ON 8
ci_10                -7.621185e-03 3 1  ON 9
ci_11                 1.374048e-02 3 1  ON 10
ci_12                 6.969066e-03 3 1  ON 11
ci_13                 1.379084e-02 3 1  ON 12
ci_14                 1.283330e-02 3 1  ON 13
ci_15                 5.312639e-03 3 1  ON 14
ci_16                 5.753963e-03 3 1  ON 15
ci_17                -5.096241e-03 3 1  ON 16
ci_18                -5.604727e-03 3 1  ON 17
ci_19                 1.024813e-02 3 1  ON 18
ci_20                 6.250416e-03 3 1  ON 19
ci_21                 8.485643e-03 3 1  ON 20
ci_22                 8.839746e-03 3 1  ON 21
ci_23                 4.201817e-03 3 1  ON 22
ci_24                 5.084924e-03 3 1  ON 23
ci_25                 2.980222e-03 3 1  ON 24
ci_26                 3.787364e-03 3 1  ON 25
ci_27                 3.331871e-03 3 1  ON 26
ci_28                 7.862628e-04 3 1  ON 27
ci_29                 1.174477e-03 3 1  ON 28
ci_30                -7.247151e-04 3 1  ON 29
ci_31                 1.002251e-03 3 1  ON 30
ci_32                -6.566513e-04 3 1  ON 31
ci_33                -1.040451e-03 3 1  ON 32
ci_34                 1.203786e-03 3 1  ON 33
ci_35                 1.322214e-03 3 1  ON 34
ci_36                -6.181368e-04 3 1  ON 35
ci_37                -5.411120e-04 3 1  ON 36
ci_38                -2.597373e-04 3 1  ON 37
ci_39                -1.575832e-04 3 1  ON 38
ci_40                -1.842179e-03 3 1  ON 39
ci_41                -5.599863e-04 3 1  ON 40
ci_42                -1.608543e-03 3 1  ON 41
ci_43                -1.376205e-03 3 1  ON 42
ci_44                -2.230229e-03 3 1  ON 43
ci_45                -2.697904e-04 3 1  ON 44
ci_46                -1.594422e-03 3 1  ON 45
ci_47                 1.398924e-03 3 1  ON 46
ci_48                 2.890131e-03 3 1  ON 47
ci_49                -8.679884e-04 3 1  ON 48
ci_50                -7.823441e-04 3 1  ON 49
ci_51                -4.944108e-04 3 1  ON 50
ci_52                -5.959335e-04 3 1  ON 51
ci_53                -7.839106e-04 3 1  ON 52
ci_54                -1.101724e-03 3 1  ON 53
ci_55                -1.211227e-03 3 1  ON 54
ci_56                 1.132164e-03 3 1  ON 55
ci_57                 2.080482e-03 3 1  ON 56
ci_58                -2.645187e-04 3 1  ON 57
ci_59                -5.636764e-04 3 1  ON 58
ci_60                 7.453146e-05 3 1  ON 59
ci_61                -1.004482e-03 3 1  ON 60
ci_62                -3.908892e-04 3 1  ON 61
ci_63                -2.759424e-04 3 1  ON 62
ci_64                -5.997358e-04 3 1  ON 63
ci_65                -4.201168e-05 3 1  ON 64
ci_66                -1.519032e-04 3 1  ON 65
ci_67                -2.335855e-04 3 1  ON 66
ci_68                -1.705701e-03 3 1  ON 67
ci_69                -1.775151e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -22.8357
    reference variance = 0.509328
====================================================
  Execution time = 2.4505e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4612e-01
  Total weights = 1.9648e+06
  Execution time = 3.5000e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433635427654
                                         uncertainty =       0.001816828795

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433635427654
                                         uncertainty =       0.001816828795

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465655322
  error estimate for blocks of size 2^( 2) =       0.000491391335
  error estimate for blocks of size 2^( 3) =       0.000515806136
  error estimate for blocks of size 2^( 4) =       0.000533373411
  error estimate for blocks of size 2^( 5) =       0.000545667072
  error estimate for blocks of size 2^( 6) =       0.000548801331
  error estimate for blocks of size 2^( 7) =       0.000553855347

      target function =      -0.748582813906
              le_mean =     -22.814549139737
             les_mean =     520.949768678114
             stat err =       0.000545424290
             autocorr =       1.371954816194
   target nu stat err =       0.000545424290
   target dn stat err =       0.002542782148
      target stat err =       0.002211089799
              std dev =       0.658536071483
             le_variance =       0.433669757444

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433635427893
                                         uncertainty =       0.001816828706

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433635427893
                                         uncertainty =       0.001816828706

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465655322
  error estimate for blocks of size 2^( 2) =       0.000491391335
  error estimate for blocks of size 2^( 3) =       0.000515806134
  error estimate for blocks of size 2^( 4) =       0.000533373408
  error estimate for blocks of size 2^( 5) =       0.000545667069
  error estimate for blocks of size 2^( 6) =       0.000548801328
  error estimate for blocks of size 2^( 7) =       0.000553855344

      target function =      -0.748582814519
              le_mean =     -22.814549139786
             les_mean =     520.949768679596
             stat err =       0.000545424287
             autocorr =       1.371954802133
   target nu stat err =       0.000545424287
   target dn stat err =       0.002542782547
      target stat err =       0.002211090123
              std dev =       0.658536071646
             le_variance =       0.433669757658

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433635427773
                                         uncertainty =       0.001816828751

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433635427773
                                         uncertainty =       0.001816828751

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465655322
  error estimate for blocks of size 2^( 2) =       0.000491391335
  error estimate for blocks of size 2^( 3) =       0.000515806135
  error estimate for blocks of size 2^( 4) =       0.000533373409
  error estimate for blocks of size 2^( 5) =       0.000545667070
  error estimate for blocks of size 2^( 6) =       0.000548801329
  error estimate for blocks of size 2^( 7) =       0.000553855346

      target function =      -0.748582814213
              le_mean =     -22.814549139762
             les_mean =     520.949768678855
             stat err =       0.000545424289
             autocorr =       1.371954809161
   target nu stat err =       0.000545424289
   target dn stat err =       0.002542782348
      target stat err =       0.002211089961
              std dev =       0.658536071564
             le_variance =       0.433669757551

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433635427668
                                         uncertainty =       0.001816828789

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433635427668
                                         uncertainty =       0.001816828789

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465655322
  error estimate for blocks of size 2^( 2) =       0.000491391335
  error estimate for blocks of size 2^( 3) =       0.000515806135
  error estimate for blocks of size 2^( 4) =       0.000533373410
  error estimate for blocks of size 2^( 5) =       0.000545667071
  error estimate for blocks of size 2^( 6) =       0.000548801331
  error estimate for blocks of size 2^( 7) =       0.000553855347

      target function =      -0.748582813945
              le_mean =     -22.814549139740
             les_mean =     520.949768678206
             stat err =       0.000545424290
             autocorr =       1.371954815316
   target nu stat err =       0.000545424290
   target dn stat err =       0.002542782173
      target stat err =       0.002211089819
              std dev =       0.658536071493
             le_variance =       0.433669757458


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748582813906        initial
     1.5625e+04     1.5625e+05             1.3189e-08        -0.748582814519  <--
     6.2500e+04     6.2500e+05             3.2973e-09        -0.748582814213
     2.5000e+05     2.5000e+06             8.2432e-10        -0.748582813945

*****************************************************************************
Applying the update for shift_i =   1.5625e+04     and shift_s =   1.5625e+05
*****************************************************************************

  Execution time = 4.2022e+01
  </log>
  <optVariables href="FORM2.s013.opt.xml">
ci_01                 1.086404e-01 3 1  ON 0
ci_02                -2.429815e-02 3 1  ON 1
ci_03                -2.453935e-02 3 1  ON 2
ci_04                 2.241554e-02 3 1  ON 3
ci_05                -1.919421e-02 3 1  ON 4
ci_06                -1.972787e-02 3 1  ON 5
ci_07                 2.582822e-02 3 1  ON 6
ci_08                -4.237444e-03 3 1  ON 7
ci_09                -7.570475e-03 3 1  ON 8
ci_10                -7.621186e-03 3 1  ON 9
ci_11                 1.374048e-02 3 1  ON 10
ci_12                 6.969067e-03 3 1  ON 11
ci_13                 1.379083e-02 3 1  ON 12
ci_14                 1.283330e-02 3 1  ON 13
ci_15                 5.312645e-03 3 1  ON 14
ci_16                 5.753967e-03 3 1  ON 15
ci_17                -5.096239e-03 3 1  ON 16
ci_18                -5.604728e-03 3 1  ON 17
ci_19                 1.024813e-02 3 1  ON 18
ci_20                 6.250415e-03 3 1  ON 19
ci_21                 8.485642e-03 3 1  ON 20
ci_22                 8.839745e-03 3 1  ON 21
ci_23                 4.201819e-03 3 1  ON 22
ci_24                 5.084918e-03 3 1  ON 23
ci_25                 2.980223e-03 3 1  ON 24
ci_26                 3.787361e-03 3 1  ON 25
ci_27                 3.331870e-03 3 1  ON 26
ci_28                 7.862631e-04 3 1  ON 27
ci_29                 1.174477e-03 3 1  ON 28
ci_30                -7.247174e-04 3 1  ON 29
ci_31                 1.002247e-03 3 1  ON 30
ci_32                -6.566534e-04 3 1  ON 31
ci_33                -1.040451e-03 3 1  ON 32
ci_34                 1.203792e-03 3 1  ON 33
ci_35                 1.322213e-03 3 1  ON 34
ci_36                -6.181385e-04 3 1  ON 35
ci_37                -5.411121e-04 3 1  ON 36
ci_38                -2.597401e-04 3 1  ON 37
ci_39                -1.575851e-04 3 1  ON 38
ci_40                -1.842175e-03 3 1  ON 39
ci_41                -5.599871e-04 3 1  ON 40
ci_42                -1.608544e-03 3 1  ON 41
ci_43                -1.376208e-03 3 1  ON 42
ci_44                -2.230227e-03 3 1  ON 43
ci_45                -2.697900e-04 3 1  ON 44
ci_46                -1.594419e-03 3 1  ON 45
ci_47                 1.398925e-03 3 1  ON 46
ci_48                 2.890128e-03 3 1  ON 47
ci_49                -8.679885e-04 3 1  ON 48
ci_50                -7.823442e-04 3 1  ON 49
ci_51                -4.944107e-04 3 1  ON 50
ci_52                -5.959308e-04 3 1  ON 51
ci_53                -7.839102e-04 3 1  ON 52
ci_54                -1.101725e-03 3 1  ON 53
ci_55                -1.211228e-03 3 1  ON 54
ci_56                 1.132168e-03 3 1  ON 55
ci_57                 2.080483e-03 3 1  ON 56
ci_58                -2.645197e-04 3 1  ON 57
ci_59                -5.636782e-04 3 1  ON 58
ci_60                 7.452768e-05 3 1  ON 59
ci_61                -1.004483e-03 3 1  ON 60
ci_62                -3.908879e-04 3 1  ON 61
ci_63                -2.759433e-04 3 1  ON 62
ci_64                -5.997353e-04 3 1  ON 63
ci_65                -4.201163e-05 3 1  ON 64
ci_66                -1.519046e-04 3 1  ON 65
ci_67                -2.335877e-04 3 1  ON 66
ci_68                -1.705700e-03 3 1  ON 67
ci_69                -1.775147e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.1688e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2813e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -22.836
    reference variance = 0.309408
====================================================
  Execution time = 2.5117e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5348e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4680e-01
  Total weights = 1.964819211e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4991e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435457827133
                                         uncertainty =       0.001969542788

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435457827133
                                         uncertainty =       0.001969542788

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466649228
  error estimate for blocks of size 2^( 2) =       0.000492383491
  error estimate for blocks of size 2^( 3) =       0.000516448619
  error estimate for blocks of size 2^( 4) =       0.000534284269
  error estimate for blocks of size 2^( 5) =       0.000546796306
  error estimate for blocks of size 2^( 6) =       0.000553423515
  error estimate for blocks of size 2^( 7) =       0.000556640493

      target function =      -0.748012742207
              le_mean =     -22.814412483529
             les_mean =     520.944214975699
             stat err =       0.000547786146
             autocorr =       1.377973878327
   target nu stat err =       0.000547786146
   target dn stat err =       0.002570949431
      target stat err =       0.002230725563
              std dev =       0.659941667144
             le_variance =       0.435523004033


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281441248353e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+03, overlap shift 3.9062e+04 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748018396371       residual = 2.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748018401700       residual = 3.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748018402346       residual = 4.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748018402416       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748018402454       residual = 7.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748018402470       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748018402478       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748018402476       residual = 7.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748018402480       residual = 2.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748018402479       residual = 9.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+03 is 6.569501e-08

solving harmonic davidson linear method for identity shift 1.5625e+04, overlap shift 1.5625e+05 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748018396371       residual = 2.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748018397703       residual = 3.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748018397865       residual = 4.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748018397882       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748018397886       residual = 7.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748018397915       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748018397898       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748018397910       residual = 7.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748018397890       residual = 2.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748018397895       residual = 9.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+04 is 1.642389e-08

solving harmonic davidson linear method for identity shift 6.2500e+04, overlap shift 6.2500e+05 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748018396371       residual = 2.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748018396704       residual = 3.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748018396745       residual = 4.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748018396749       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748018396751       residual = 7.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748018396752       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748018396753       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748018396753       residual = 7.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748018396719       residual = 2.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748018396646       residual = 9.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+04 is 4.105981e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.055522 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9626e+01
  </log>
  <optVariables href="FORM2.s014.opt.xml">
ci_01                 1.086404e-01 3 1  ON 0
ci_02                -2.429816e-02 3 1  ON 1
ci_03                -2.453937e-02 3 1  ON 2
ci_04                 2.241555e-02 3 1  ON 3
ci_05                -1.919422e-02 3 1  ON 4
ci_06                -1.972788e-02 3 1  ON 5
ci_07                 2.582823e-02 3 1  ON 6
ci_08                -4.237445e-03 3 1  ON 7
ci_09                -7.570474e-03 3 1  ON 8
ci_10                -7.621184e-03 3 1  ON 9
ci_11                 1.374048e-02 3 1  ON 10
ci_12                 6.969068e-03 3 1  ON 11
ci_13                 1.379083e-02 3 1  ON 12
ci_14                 1.283331e-02 3 1  ON 13
ci_15                 5.312647e-03 3 1  ON 14
ci_16                 5.753965e-03 3 1  ON 15
ci_17                -5.096241e-03 3 1  ON 16
ci_18                -5.604727e-03 3 1  ON 17
ci_19                 1.024812e-02 3 1  ON 18
ci_20                 6.250420e-03 3 1  ON 19
ci_21                 8.485638e-03 3 1  ON 20
ci_22                 8.839743e-03 3 1  ON 21
ci_23                 4.201820e-03 3 1  ON 22
ci_24                 5.084918e-03 3 1  ON 23
ci_25                 2.980227e-03 3 1  ON 24
ci_26                 3.787360e-03 3 1  ON 25
ci_27                 3.331869e-03 3 1  ON 26
ci_28                 7.862668e-04 3 1  ON 27
ci_29                 1.174474e-03 3 1  ON 28
ci_30                -7.247211e-04 3 1  ON 29
ci_31                 1.002245e-03 3 1  ON 30
ci_32                -6.566582e-04 3 1  ON 31
ci_33                -1.040452e-03 3 1  ON 32
ci_34                 1.203791e-03 3 1  ON 33
ci_35                 1.322212e-03 3 1  ON 34
ci_36                -6.181406e-04 3 1  ON 35
ci_37                -5.411152e-04 3 1  ON 36
ci_38                -2.597409e-04 3 1  ON 37
ci_39                -1.575867e-04 3 1  ON 38
ci_40                -1.842174e-03 3 1  ON 39
ci_41                -5.599882e-04 3 1  ON 40
ci_42                -1.608541e-03 3 1  ON 41
ci_43                -1.376211e-03 3 1  ON 42
ci_44                -2.230226e-03 3 1  ON 43
ci_45                -2.697908e-04 3 1  ON 44
ci_46                -1.594417e-03 3 1  ON 45
ci_47                 1.398924e-03 3 1  ON 46
ci_48                 2.890129e-03 3 1  ON 47
ci_49                -8.679877e-04 3 1  ON 48
ci_50                -7.823432e-04 3 1  ON 49
ci_51                -4.944065e-04 3 1  ON 50
ci_52                -5.959306e-04 3 1  ON 51
ci_53                -7.839086e-04 3 1  ON 52
ci_54                -1.101723e-03 3 1  ON 53
ci_55                -1.211226e-03 3 1  ON 54
ci_56                 1.132171e-03 3 1  ON 55
ci_57                 2.080484e-03 3 1  ON 56
ci_58                -2.645184e-04 3 1  ON 57
ci_59                -5.636805e-04 3 1  ON 58
ci_60                 7.453192e-05 3 1  ON 59
ci_61                -1.004480e-03 3 1  ON 60
ci_62                -3.908879e-04 3 1  ON 61
ci_63                -2.759436e-04 3 1  ON 62
ci_64                -5.997353e-04 3 1  ON 63
ci_65                -4.201276e-05 3 1  ON 64
ci_66                -1.519051e-04 3 1  ON 65
ci_67                -2.335899e-04 3 1  ON 66
ci_68                -1.705698e-03 3 1  ON 67
ci_69                -1.775142e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -22.6319
    reference variance = 0.615864
====================================================
  Execution time = 2.4497e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4859e-01
  Total weights = 1.9644e+06
  Execution time = 3.4988e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435335996916
                                         uncertainty =       0.001851781059

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435335996916
                                         uncertainty =       0.001851781059

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466586069
  error estimate for blocks of size 2^( 2) =       0.000492249854
  error estimate for blocks of size 2^( 3) =       0.000516344402
  error estimate for blocks of size 2^( 4) =       0.000534433855
  error estimate for blocks of size 2^( 5) =       0.000545535545
  error estimate for blocks of size 2^( 6) =       0.000552145044
  error estimate for blocks of size 2^( 7) =       0.000552569467

      target function =      -0.746520966365
              le_mean =     -22.814165353140
             les_mean =     520.934727435434
             stat err =       0.000546170978
             autocorr =       1.370230725531
   target nu stat err =       0.000546170978
   target dn stat err =       0.002936458209
      target stat err =       0.002514322717
              std dev =       0.659852347343
             le_variance =       0.435405120294

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435335991629
                                         uncertainty =       0.001851781474

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435335991629
                                         uncertainty =       0.001851781474

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466586067
  error estimate for blocks of size 2^( 2) =       0.000492249847
  error estimate for blocks of size 2^( 3) =       0.000516344390
  error estimate for blocks of size 2^( 4) =       0.000534433840
  error estimate for blocks of size 2^( 5) =       0.000545535529
  error estimate for blocks of size 2^( 6) =       0.000552145027
  error estimate for blocks of size 2^( 7) =       0.000552569451

      target function =      -0.746520984860
              le_mean =     -22.814165353049
             les_mean =     520.934727409104
             stat err =       0.000546170962
             autocorr =       1.370230662103
   target nu stat err =       0.000546170962
   target dn stat err =       0.002936450805
      target stat err =       0.002514316864
              std dev =       0.659852343349
             le_variance =       0.435405115024

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435335994273
                                         uncertainty =       0.001851781266

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435335994273
                                         uncertainty =       0.001851781266

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466586068
  error estimate for blocks of size 2^( 2) =       0.000492249851
  error estimate for blocks of size 2^( 3) =       0.000516344396
  error estimate for blocks of size 2^( 4) =       0.000534433848
  error estimate for blocks of size 2^( 5) =       0.000545535537
  error estimate for blocks of size 2^( 6) =       0.000552145035
  error estimate for blocks of size 2^( 7) =       0.000552569459

      target function =      -0.746520975618
              le_mean =     -22.814165353095
             les_mean =     520.934727422262
             stat err =       0.000546170970
             autocorr =       1.370230693819
   target nu stat err =       0.000546170970
   target dn stat err =       0.002936454507
      target stat err =       0.002514319790
              std dev =       0.659852345346
             le_variance =       0.435405117659

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435335996586
                                         uncertainty =       0.001851781085

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435335996586
                                         uncertainty =       0.001851781085

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466586069
  error estimate for blocks of size 2^( 2) =       0.000492249854
  error estimate for blocks of size 2^( 3) =       0.000516344401
  error estimate for blocks of size 2^( 4) =       0.000534433854
  error estimate for blocks of size 2^( 5) =       0.000545535544
  error estimate for blocks of size 2^( 6) =       0.000552145043
  error estimate for blocks of size 2^( 7) =       0.000552569466

      target function =      -0.746520967522
              le_mean =     -22.814165353134
             les_mean =     520.934727433787
             stat err =       0.000546170977
             autocorr =       1.370230721570
   target nu stat err =       0.000546170977
   target dn stat err =       0.002936457746
      target stat err =       0.002514322351
              std dev =       0.659852347093
             le_variance =       0.435405119964


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746520966365        initial
     3.9062e+03     3.9062e+04             6.5695e-08        -0.746520984860  <--
     1.5625e+04     1.5625e+05             1.6424e-08        -0.746520975618
     6.2500e+04     6.2500e+05             4.1060e-09        -0.746520967522

*****************************************************************************
Applying the update for shift_i =   3.9062e+03     and shift_s =   3.9062e+04
*****************************************************************************

  Execution time = 4.5101e+01
  </log>
  <optVariables href="FORM2.s014.opt.xml">
ci_01                 1.086404e-01 3 1  ON 0
ci_02                -2.429821e-02 3 1  ON 1
ci_03                -2.453940e-02 3 1  ON 2
ci_04                 2.241558e-02 3 1  ON 3
ci_05                -1.919424e-02 3 1  ON 4
ci_06                -1.972789e-02 3 1  ON 5
ci_07                 2.582824e-02 3 1  ON 6
ci_08                -4.237448e-03 3 1  ON 7
ci_09                -7.570470e-03 3 1  ON 8
ci_10                -7.621180e-03 3 1  ON 9
ci_11                 1.374047e-02 3 1  ON 10
ci_12                 6.969072e-03 3 1  ON 11
ci_13                 1.379082e-02 3 1  ON 12
ci_14                 1.283332e-02 3 1  ON 13
ci_15                 5.312653e-03 3 1  ON 14
ci_16                 5.753961e-03 3 1  ON 15
ci_17                -5.096244e-03 3 1  ON 16
ci_18                -5.604725e-03 3 1  ON 17
ci_19                 1.024811e-02 3 1  ON 18
ci_20                 6.250433e-03 3 1  ON 19
ci_21                 8.485625e-03 3 1  ON 20
ci_22                 8.839739e-03 3 1  ON 21
ci_23                 4.201824e-03 3 1  ON 22
ci_24                 5.084917e-03 3 1  ON 23
ci_25                 2.980239e-03 3 1  ON 24
ci_26                 3.787357e-03 3 1  ON 25
ci_27                 3.331867e-03 3 1  ON 26
ci_28                 7.862779e-04 3 1  ON 27
ci_29                 1.174464e-03 3 1  ON 28
ci_30                -7.247323e-04 3 1  ON 29
ci_31                 1.002239e-03 3 1  ON 30
ci_32                -6.566726e-04 3 1  ON 31
ci_33                -1.040453e-03 3 1  ON 32
ci_34                 1.203790e-03 3 1  ON 33
ci_35                 1.322210e-03 3 1  ON 34
ci_36                -6.181470e-04 3 1  ON 35
ci_37                -5.411244e-04 3 1  ON 36
ci_38                -2.597434e-04 3 1  ON 37
ci_39                -1.575915e-04 3 1  ON 38
ci_40                -1.842169e-03 3 1  ON 39
ci_41                -5.599917e-04 3 1  ON 40
ci_42                -1.608533e-03 3 1  ON 41
ci_43                -1.376219e-03 3 1  ON 42
ci_44                -2.230222e-03 3 1  ON 43
ci_45                -2.697933e-04 3 1  ON 44
ci_46                -1.594409e-03 3 1  ON 45
ci_47                 1.398920e-03 3 1  ON 46
ci_48                 2.890133e-03 3 1  ON 47
ci_49                -8.679852e-04 3 1  ON 48
ci_50                -7.823403e-04 3 1  ON 49
ci_51                -4.943940e-04 3 1  ON 50
ci_52                -5.959300e-04 3 1  ON 51
ci_53                -7.839039e-04 3 1  ON 52
ci_54                -1.101718e-03 3 1  ON 53
ci_55                -1.211222e-03 3 1  ON 54
ci_56                 1.132181e-03 3 1  ON 55
ci_57                 2.080488e-03 3 1  ON 56
ci_58                -2.645145e-04 3 1  ON 57
ci_59                -5.636872e-04 3 1  ON 58
ci_60                 7.454464e-05 3 1  ON 59
ci_61                -1.004471e-03 3 1  ON 60
ci_62                -3.908879e-04 3 1  ON 61
ci_63                -2.759448e-04 3 1  ON 62
ci_64                -5.997351e-04 3 1  ON 63
ci_65                -4.201616e-05 3 1  ON 64
ci_66                -1.519066e-04 3 1  ON 65
ci_67                -2.335965e-04 3 1  ON 66
ci_68                -1.705692e-03 3 1  ON 67
ci_69                -1.775125e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4734e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2807e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -22.9168
    reference variance = 0.398495
====================================================
  Execution time = 2.5096e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5355e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4534e-01
  Total weights = 1.964821845e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5206e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434271753167
                                         uncertainty =       0.001888106015

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434271753167
                                         uncertainty =       0.001888106015

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465993514
  error estimate for blocks of size 2^( 2) =       0.000491867889
  error estimate for blocks of size 2^( 3) =       0.000515859854
  error estimate for blocks of size 2^( 4) =       0.000535386385
  error estimate for blocks of size 2^( 5) =       0.000546797825
  error estimate for blocks of size 2^( 6) =       0.000554277687
  error estimate for blocks of size 2^( 7) =       0.000558760653

      target function =      -0.749238611848
              le_mean =     -22.814659900447
             les_mean =     520.954041793771
             stat err =       0.000548805638
             autocorr =       1.387002947305
   target nu stat err =       0.000548805638
   target dn stat err =       0.002077916027
      target stat err =       0.001845251615
              std dev =       0.659014347768
             le_variance =       0.434299910564


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281465990045e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749242153798       residual = 2.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749242174791       residual = 3.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749242177755       residual = 6.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749242178030       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749242178064       residual = 8.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749242178083       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749242178087       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749242178075       residual = 6.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749242178073       residual = 2.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749242178071       residual = 6.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+02 is 2.917645e-07

solving harmonic davidson linear method for identity shift 3.9062e+03, overlap shift 3.9062e+04 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749242153798       residual = 2.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749242159046       residual = 3.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749242159787       residual = 6.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749242159856       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749242159865       residual = 8.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749242159865       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749242159871       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749242159867       residual = 6.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749242159870       residual = 2.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749242159868       residual = 6.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+03 is 7.294265e-08

solving harmonic davidson linear method for identity shift 1.5625e+04, overlap shift 1.5625e+05 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749242153798       residual = 2.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749242155110       residual = 3.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749242155295       residual = 6.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749242155312       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749242155338       residual = 8.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749242155291       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749242155347       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749242155316       residual = 6.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749242155309       residual = 2.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749242155312       residual = 6.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+04 is 1.823576e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.059093 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9626e+01
  </log>
  <optVariables href="FORM2.s015.opt.xml">
ci_01                 1.086405e-01 3 1  ON 0
ci_02                -2.429825e-02 3 1  ON 1
ci_03                -2.453945e-02 3 1  ON 2
ci_04                 2.241562e-02 3 1  ON 3
ci_05                -1.919426e-02 3 1  ON 4
ci_06                -1.972792e-02 3 1  ON 5
ci_07                 2.582824e-02 3 1  ON 6
ci_08                -4.237448e-03 3 1  ON 7
ci_09                -7.570470e-03 3 1  ON 8
ci_10                -7.621174e-03 3 1  ON 9
ci_11                 1.374045e-02 3 1  ON 10
ci_12                 6.969087e-03 3 1  ON 11
ci_13                 1.379083e-02 3 1  ON 12
ci_14                 1.283335e-02 3 1  ON 13
ci_15                 5.312682e-03 3 1  ON 14
ci_16                 5.753973e-03 3 1  ON 15
ci_17                -5.096264e-03 3 1  ON 16
ci_18                -5.604721e-03 3 1  ON 17
ci_19                 1.024809e-02 3 1  ON 18
ci_20                 6.250437e-03 3 1  ON 19
ci_21                 8.485619e-03 3 1  ON 20
ci_22                 8.839746e-03 3 1  ON 21
ci_23                 4.201838e-03 3 1  ON 22
ci_24                 5.084925e-03 3 1  ON 23
ci_25                 2.980233e-03 3 1  ON 24
ci_26                 3.787348e-03 3 1  ON 25
ci_27                 3.331860e-03 3 1  ON 26
ci_28                 7.862920e-04 3 1  ON 27
ci_29                 1.174453e-03 3 1  ON 28
ci_30                -7.247418e-04 3 1  ON 29
ci_31                 1.002219e-03 3 1  ON 30
ci_32                -6.566884e-04 3 1  ON 31
ci_33                -1.040467e-03 3 1  ON 32
ci_34                 1.203791e-03 3 1  ON 33
ci_35                 1.322210e-03 3 1  ON 34
ci_36                -6.181480e-04 3 1  ON 35
ci_37                -5.411315e-04 3 1  ON 36
ci_38                -2.597543e-04 3 1  ON 37
ci_39                -1.576041e-04 3 1  ON 38
ci_40                -1.842160e-03 3 1  ON 39
ci_41                -5.599911e-04 3 1  ON 40
ci_42                -1.608537e-03 3 1  ON 41
ci_43                -1.376224e-03 3 1  ON 42
ci_44                -2.230217e-03 3 1  ON 43
ci_45                -2.697993e-04 3 1  ON 44
ci_46                -1.594389e-03 3 1  ON 45
ci_47                 1.398927e-03 3 1  ON 46
ci_48                 2.890118e-03 3 1  ON 47
ci_49                -8.680070e-04 3 1  ON 48
ci_50                -7.823381e-04 3 1  ON 49
ci_51                -4.943803e-04 3 1  ON 50
ci_52                -5.959164e-04 3 1  ON 51
ci_53                -7.839023e-04 3 1  ON 52
ci_54                -1.101704e-03 3 1  ON 53
ci_55                -1.211223e-03 3 1  ON 54
ci_56                 1.132189e-03 3 1  ON 55
ci_57                 2.080489e-03 3 1  ON 56
ci_58                -2.645297e-04 3 1  ON 57
ci_59                -5.636971e-04 3 1  ON 58
ci_60                 7.455182e-05 3 1  ON 59
ci_61                -1.004469e-03 3 1  ON 60
ci_62                -3.909009e-04 3 1  ON 61
ci_63                -2.759522e-04 3 1  ON 62
ci_64                -5.997245e-04 3 1  ON 63
ci_65                -4.201325e-05 3 1  ON 64
ci_66                -1.519101e-04 3 1  ON 65
ci_67                -2.336031e-04 3 1  ON 66
ci_68                -1.705689e-03 3 1  ON 67
ci_69                -1.775115e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -22.7334
    reference variance = 0.33661
====================================================
  Execution time = 2.4522e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4971e-01
  Total weights = 1.9647e+06
  Execution time = 3.4753e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436123225208
                                         uncertainty =       0.002393462670

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436123225208
                                         uncertainty =       0.002393462670

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466988616
  error estimate for blocks of size 2^( 2) =       0.000492836139
  error estimate for blocks of size 2^( 3) =       0.000516812509
  error estimate for blocks of size 2^( 4) =       0.000535390673
  error estimate for blocks of size 2^( 5) =       0.000547368243
  error estimate for blocks of size 2^( 6) =       0.000553692514
  error estimate for blocks of size 2^( 7) =       0.000557257157

      target function =      -0.745583091382
              le_mean =     -22.815256304467
             les_mean =     520.985634403575
             stat err =       0.000548427147
             autocorr =       1.379193816586
   target nu stat err =       0.000548427147
   target dn stat err =       0.003193745402
      target stat err =       0.002720564539
              std dev =       0.660421633558
             le_variance =       0.436156734071

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436123177096
                                         uncertainty =       0.002393461892

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436123177096
                                         uncertainty =       0.002393461892

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466988590
  error estimate for blocks of size 2^( 2) =       0.000492836095
  error estimate for blocks of size 2^( 3) =       0.000516812448
  error estimate for blocks of size 2^( 4) =       0.000535390601
  error estimate for blocks of size 2^( 5) =       0.000547368165
  error estimate for blocks of size 2^( 6) =       0.000553692439
  error estimate for blocks of size 2^( 7) =       0.000557257080

      target function =      -0.745583102206
              le_mean =     -22.815256302832
             les_mean =     520.985634315901
             stat err =       0.000548427071
             autocorr =       1.379193589607
   target nu stat err =       0.000548427071
   target dn stat err =       0.003193750360
      target stat err =       0.002720568602
              std dev =       0.660421596933
             le_variance =       0.436156685695

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436123201151
                                         uncertainty =       0.002393462281

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436123201151
                                         uncertainty =       0.002393462281

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466988603
  error estimate for blocks of size 2^( 2) =       0.000492836117
  error estimate for blocks of size 2^( 3) =       0.000516812479
  error estimate for blocks of size 2^( 4) =       0.000535390637
  error estimate for blocks of size 2^( 5) =       0.000547368204
  error estimate for blocks of size 2^( 6) =       0.000553692477
  error estimate for blocks of size 2^( 7) =       0.000557257119

      target function =      -0.745583096848
              le_mean =     -22.815256303649
             les_mean =     520.985634359666
             stat err =       0.000548427109
             autocorr =       1.379193703101
   target nu stat err =       0.000548427109
   target dn stat err =       0.003193747880
      target stat err =       0.002720566570
              std dev =       0.660421615244
             le_variance =       0.436156709882

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436123222201
                                         uncertainty =       0.002393462621

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436123222201
                                         uncertainty =       0.002393462621

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466988614
  error estimate for blocks of size 2^( 2) =       0.000492836137
  error estimate for blocks of size 2^( 3) =       0.000516812505
  error estimate for blocks of size 2^( 4) =       0.000535390668
  error estimate for blocks of size 2^( 5) =       0.000547368238
  error estimate for blocks of size 2^( 6) =       0.000553692510
  error estimate for blocks of size 2^( 7) =       0.000557257152

      target function =      -0.745583092071
              le_mean =     -22.815256304364
             les_mean =     520.985634398078
             stat err =       0.000548427142
             autocorr =       1.379193802403
   target nu stat err =       0.000548427142
   target dn stat err =       0.003193745712
      target stat err =       0.002720564793
              std dev =       0.660421631268
             le_variance =       0.436156731047


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745583091382        initial
     9.7656e+02     9.7656e+03             2.9176e-07        -0.745583102206  <--
     3.9062e+03     3.9062e+04             7.2943e-08        -0.745583096848
     1.5625e+04     1.5625e+05             1.8236e-08        -0.745583092071

*****************************************************************************
Applying the update for shift_i =   9.7656e+02     and shift_s =   9.7656e+03
*****************************************************************************

  Execution time = 4.1925e+01
  </log>
  <optVariables href="FORM2.s015.opt.xml">
ci_01                 1.086407e-01 3 1  ON 0
ci_02                -2.429835e-02 3 1  ON 1
ci_03                -2.453961e-02 3 1  ON 2
ci_04                 2.241573e-02 3 1  ON 3
ci_05                -1.919434e-02 3 1  ON 4
ci_06                -1.972802e-02 3 1  ON 5
ci_07                 2.582826e-02 3 1  ON 6
ci_08                -4.237449e-03 3 1  ON 7
ci_09                -7.570471e-03 3 1  ON 8
ci_10                -7.621157e-03 3 1  ON 9
ci_11                 1.374041e-02 3 1  ON 10
ci_12                 6.969130e-03 3 1  ON 11
ci_13                 1.379085e-02 3 1  ON 12
ci_14                 1.283344e-02 3 1  ON 13
ci_15                 5.312770e-03 3 1  ON 14
ci_16                 5.754010e-03 3 1  ON 15
ci_17                -5.096323e-03 3 1  ON 16
ci_18                -5.604711e-03 3 1  ON 17
ci_19                 1.024803e-02 3 1  ON 18
ci_20                 6.250449e-03 3 1  ON 19
ci_21                 8.485600e-03 3 1  ON 20
ci_22                 8.839766e-03 3 1  ON 21
ci_23                 4.201879e-03 3 1  ON 22
ci_24                 5.084951e-03 3 1  ON 23
ci_25                 2.980213e-03 3 1  ON 24
ci_26                 3.787321e-03 3 1  ON 25
ci_27                 3.331840e-03 3 1  ON 26
ci_28                 7.863342e-04 3 1  ON 27
ci_29                 1.174422e-03 3 1  ON 28
ci_30                -7.247704e-04 3 1  ON 29
ci_31                 1.002161e-03 3 1  ON 30
ci_32                -6.567357e-04 3 1  ON 31
ci_33                -1.040508e-03 3 1  ON 32
ci_34                 1.203796e-03 3 1  ON 33
ci_35                 1.322211e-03 3 1  ON 34
ci_36                -6.181511e-04 3 1  ON 35
ci_37                -5.411526e-04 3 1  ON 36
ci_38                -2.597870e-04 3 1  ON 37
ci_39                -1.576419e-04 3 1  ON 38
ci_40                -1.842136e-03 3 1  ON 39
ci_41                -5.599892e-04 3 1  ON 40
ci_42                -1.608551e-03 3 1  ON 41
ci_43                -1.376239e-03 3 1  ON 42
ci_44                -2.230199e-03 3 1  ON 43
ci_45                -2.698175e-04 3 1  ON 44
ci_46                -1.594326e-03 3 1  ON 45
ci_47                 1.398949e-03 3 1  ON 46
ci_48                 2.890072e-03 3 1  ON 47
ci_49                -8.680725e-04 3 1  ON 48
ci_50                -7.823313e-04 3 1  ON 49
ci_51                -4.943394e-04 3 1  ON 50
ci_52                -5.958755e-04 3 1  ON 51
ci_53                -7.838973e-04 3 1  ON 52
ci_54                -1.101659e-03 3 1  ON 53
ci_55                -1.211224e-03 3 1  ON 54
ci_56                 1.132214e-03 3 1  ON 55
ci_57                 2.080491e-03 3 1  ON 56
ci_58                -2.645751e-04 3 1  ON 57
ci_59                -5.637267e-04 3 1  ON 58
ci_60                 7.457337e-05 3 1  ON 59
ci_61                -1.004466e-03 3 1  ON 60
ci_62                -3.909399e-04 3 1  ON 61
ci_63                -2.759743e-04 3 1  ON 62
ci_64                -5.996929e-04 3 1  ON 63
ci_65                -4.200453e-05 3 1  ON 64
ci_66                -1.519204e-04 3 1  ON 65
ci_67                -2.336229e-04 3 1  ON 66
ci_68                -1.705681e-03 3 1  ON 67
ci_69                -1.775085e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.1558e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2808e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -22.7472
    reference variance = 0.357965
====================================================
  Execution time = 2.5089e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5359e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4811e-01
  Total weights = 1.964748881e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5264e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435666064929
                                         uncertainty =       0.002321214521

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435666064929
                                         uncertainty =       0.002321214521

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466712179
  error estimate for blocks of size 2^( 2) =       0.000492557271
  error estimate for blocks of size 2^( 3) =       0.000516486317
  error estimate for blocks of size 2^( 4) =       0.000535744740
  error estimate for blocks of size 2^( 5) =       0.000547162715
  error estimate for blocks of size 2^( 6) =       0.000555165584
  error estimate for blocks of size 2^( 7) =       0.000558838519

      target function =      -0.746920200688
              le_mean =     -22.814253618906
             les_mean =     520.938273714619
             stat err =       0.000549227890
             autocorr =       1.384863268181
   target nu stat err =       0.000549227890
   target dn stat err =       0.003077905448
      target stat err =       0.002632386178
              std dev =       0.660030693518
             le_variance =       0.435640516386


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281425361891e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746928572506       residual = 2.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746928660504       residual = 3.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746928676792       residual = 6.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746928678888       residual = 2.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746928679203       residual = 6.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746928679285       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746928679376       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746928679443       residual = 5.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746928679504       residual = 3.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746928679517       residual = 9.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+02 is 1.307880e-06

solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746928572506       residual = 2.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746928594509       residual = 3.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746928598581       residual = 6.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746928599105       residual = 2.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746928599184       residual = 6.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746928599204       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746928599224       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746928599245       residual = 5.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746928599261       residual = 3.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746928599262       residual = 8.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+02 is 3.269953e-07

solving harmonic davidson linear method for identity shift 3.9062e+03, overlap shift 3.9062e+04 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746928572506       residual = 2.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746928578007       residual = 3.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746928579025       residual = 6.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746928579156       residual = 2.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746928579175       residual = 6.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746928579178       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746928579189       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746928579197       residual = 5.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746928579189       residual = 3.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746928579197       residual = 8.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+03 is 8.175041e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.062630 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9624e+01
  </log>
  <optVariables href="FORM2.s016.opt.xml">
ci_01                 1.086411e-01 3 1  ON 0
ci_02                -2.429856e-02 3 1  ON 1
ci_03                -2.453980e-02 3 1  ON 2
ci_04                 2.241587e-02 3 1  ON 3
ci_05                -1.919437e-02 3 1  ON 4
ci_06                -1.972800e-02 3 1  ON 5
ci_07                 2.582827e-02 3 1  ON 6
ci_08                -4.237431e-03 3 1  ON 7
ci_09                -7.570563e-03 3 1  ON 8
ci_10                -7.621199e-03 3 1  ON 9
ci_11                 1.374040e-02 3 1  ON 10
ci_12                 6.969104e-03 3 1  ON 11
ci_13                 1.379080e-02 3 1  ON 12
ci_14                 1.283337e-02 3 1  ON 13
ci_15                 5.312810e-03 3 1  ON 14
ci_16                 5.754039e-03 3 1  ON 15
ci_17                -5.096342e-03 3 1  ON 16
ci_18                -5.604745e-03 3 1  ON 17
ci_19                 1.024806e-02 3 1  ON 18
ci_20                 6.250486e-03 3 1  ON 19
ci_21                 8.485580e-03 3 1  ON 20
ci_22                 8.839769e-03 3 1  ON 21
ci_23                 4.201899e-03 3 1  ON 22
ci_24                 5.084914e-03 3 1  ON 23
ci_25                 2.980185e-03 3 1  ON 24
ci_26                 3.787196e-03 3 1  ON 25
ci_27                 3.331800e-03 3 1  ON 26
ci_28                 7.863970e-04 3 1  ON 27
ci_29                 1.174416e-03 3 1  ON 28
ci_30                -7.247349e-04 3 1  ON 29
ci_31                 1.002085e-03 3 1  ON 30
ci_32                -6.567986e-04 3 1  ON 31
ci_33                -1.040520e-03 3 1  ON 32
ci_34                 1.203735e-03 3 1  ON 33
ci_35                 1.322198e-03 3 1  ON 34
ci_36                -6.181832e-04 3 1  ON 35
ci_37                -5.411515e-04 3 1  ON 36
ci_38                -2.597670e-04 3 1  ON 37
ci_39                -1.576347e-04 3 1  ON 38
ci_40                -1.842058e-03 3 1  ON 39
ci_41                -5.600836e-04 3 1  ON 40
ci_42                -1.608537e-03 3 1  ON 41
ci_43                -1.376204e-03 3 1  ON 42
ci_44                -2.230222e-03 3 1  ON 43
ci_45                -2.698439e-04 3 1  ON 44
ci_46                -1.594268e-03 3 1  ON 45
ci_47                 1.398961e-03 3 1  ON 46
ci_48                 2.890027e-03 3 1  ON 47
ci_49                -8.680501e-04 3 1  ON 48
ci_50                -7.823298e-04 3 1  ON 49
ci_51                -4.943675e-04 3 1  ON 50
ci_52                -5.958047e-04 3 1  ON 51
ci_53                -7.838509e-04 3 1  ON 52
ci_54                -1.101609e-03 3 1  ON 53
ci_55                -1.211172e-03 3 1  ON 54
ci_56                 1.132312e-03 3 1  ON 55
ci_57                 2.080454e-03 3 1  ON 56
ci_58                -2.645470e-04 3 1  ON 57
ci_59                -5.636770e-04 3 1  ON 58
ci_60                 7.448922e-05 3 1  ON 59
ci_61                -1.004484e-03 3 1  ON 60
ci_62                -3.909444e-04 3 1  ON 61
ci_63                -2.760108e-04 3 1  ON 62
ci_64                -5.997316e-04 3 1  ON 63
ci_65                -4.198534e-05 3 1  ON 64
ci_66                -1.519196e-04 3 1  ON 65
ci_67                -2.335418e-04 3 1  ON 66
ci_68                -1.705668e-03 3 1  ON 67
ci_69                -1.775036e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -22.7409
    reference variance = 0.435866
====================================================
  Execution time = 2.4460e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4596e-01
  Total weights = 1.9647e+06
  Execution time = 3.4932e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433269671826
                                         uncertainty =       0.002246142003

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433269671826
                                         uncertainty =       0.002246142003

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465458781
  error estimate for blocks of size 2^( 2) =       0.000490986788
  error estimate for blocks of size 2^( 3) =       0.000515095998
  error estimate for blocks of size 2^( 4) =       0.000533596573
  error estimate for blocks of size 2^( 5) =       0.000545850029
  error estimate for blocks of size 2^( 6) =       0.000552711624
  error estimate for blocks of size 2^( 7) =       0.000555320802

      target function =      -0.748709391850
              le_mean =     -22.814018578746
             les_mean =     520.925402912632
             stat err =       0.000546869757
             autocorr =       1.380401293530
   target nu stat err =       0.000546869757
   target dn stat err =       0.002967551467
      target stat err =       0.002553509211
              std dev =       0.658258120838
             le_variance =       0.433303753649

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433269619297
                                         uncertainty =       0.002246137991

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433269619297
                                         uncertainty =       0.002246137991

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465458753
  error estimate for blocks of size 2^( 2) =       0.000490986698
  error estimate for blocks of size 2^( 3) =       0.000515095849
  error estimate for blocks of size 2^( 4) =       0.000533596380
  error estimate for blocks of size 2^( 5) =       0.000545849813
  error estimate for blocks of size 2^( 6) =       0.000552711386
  error estimate for blocks of size 2^( 7) =       0.000555320531

      target function =      -0.748709750538
              le_mean =     -22.814018580866
             les_mean =     520.925402580168
             stat err =       0.000546869528
             autocorr =       1.380400301714
   target nu stat err =       0.000546869528
   target dn stat err =       0.002967540044
      target stat err =       0.002553502267
              std dev =       0.658258081208
             le_variance =       0.433303701476

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433269645544
                                         uncertainty =       0.002246139997

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433269645544
                                         uncertainty =       0.002246139997

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465458767
  error estimate for blocks of size 2^( 2) =       0.000490986743
  error estimate for blocks of size 2^( 3) =       0.000515095924
  error estimate for blocks of size 2^( 4) =       0.000533596476
  error estimate for blocks of size 2^( 5) =       0.000545849921
  error estimate for blocks of size 2^( 6) =       0.000552711505
  error estimate for blocks of size 2^( 7) =       0.000555320666

      target function =      -0.748709571930
              le_mean =     -22.814018579805
             les_mean =     520.925402745449
             stat err =       0.000546869642
             autocorr =       1.380400797577
   target nu stat err =       0.000546869642
   target dn stat err =       0.002967545734
      target stat err =       0.002553505727
              std dev =       0.658258101009
             le_variance =       0.433303727544

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433269668539
                                         uncertainty =       0.002246141752

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433269668539
                                         uncertainty =       0.002246141752

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465458779
  error estimate for blocks of size 2^( 2) =       0.000490986782
  error estimate for blocks of size 2^( 3) =       0.000515095989
  error estimate for blocks of size 2^( 4) =       0.000533596560
  error estimate for blocks of size 2^( 5) =       0.000545850016
  error estimate for blocks of size 2^( 6) =       0.000552711609
  error estimate for blocks of size 2^( 7) =       0.000555320785

      target function =      -0.748709414439
              le_mean =     -22.814018578878
             les_mean =     520.925402891632
             stat err =       0.000546869743
             autocorr =       1.380401231540
   target nu stat err =       0.000546869743
   target dn stat err =       0.002967550748
      target stat err =       0.002553508774
              std dev =       0.658258118358
             le_variance =       0.433303750385


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748709391850        initial
     2.4414e+02     2.4414e+03             1.3079e-06        -0.748709750538  <--
     9.7656e+02     9.7656e+03             3.2700e-07        -0.748709571930
     3.9062e+03     3.9062e+04             8.1750e-08        -0.748709414439

*****************************************************************************
Applying the update for shift_i =   2.4414e+02     and shift_s =   2.4414e+03
*****************************************************************************

  Execution time = 4.5733e+01
  </log>
  <optVariables href="FORM2.s016.opt.xml">
ci_01                 1.086420e-01 3 1  ON 0
ci_02                -2.429918e-02 3 1  ON 1
ci_03                -2.454039e-02 3 1  ON 2
ci_04                 2.241628e-02 3 1  ON 3
ci_05                -1.919445e-02 3 1  ON 4
ci_06                -1.972793e-02 3 1  ON 5
ci_07                 2.582833e-02 3 1  ON 6
ci_08                -4.237378e-03 3 1  ON 7
ci_09                -7.570841e-03 3 1  ON 8
ci_10                -7.621324e-03 3 1  ON 9
ci_11                 1.374039e-02 3 1  ON 10
ci_12                 6.969023e-03 3 1  ON 11
ci_13                 1.379065e-02 3 1  ON 12
ci_14                 1.283315e-02 3 1  ON 13
ci_15                 5.312929e-03 3 1  ON 14
ci_16                 5.754127e-03 3 1  ON 15
ci_17                -5.096400e-03 3 1  ON 16
ci_18                -5.604846e-03 3 1  ON 17
ci_19                 1.024815e-02 3 1  ON 18
ci_20                 6.250597e-03 3 1  ON 19
ci_21                 8.485520e-03 3 1  ON 20
ci_22                 8.839778e-03 3 1  ON 21
ci_23                 4.201959e-03 3 1  ON 22
ci_24                 5.084803e-03 3 1  ON 23
ci_25                 2.980099e-03 3 1  ON 24
ci_26                 3.786819e-03 3 1  ON 25
ci_27                 3.331681e-03 3 1  ON 26
ci_28                 7.865855e-04 3 1  ON 27
ci_29                 1.174398e-03 3 1  ON 28
ci_30                -7.246282e-04 3 1  ON 29
ci_31                 1.001858e-03 3 1  ON 30
ci_32                -6.569873e-04 3 1  ON 31
ci_33                -1.040554e-03 3 1  ON 32
ci_34                 1.203553e-03 3 1  ON 33
ci_35                 1.322159e-03 3 1  ON 34
ci_36                -6.182794e-04 3 1  ON 35
ci_37                -5.411483e-04 3 1  ON 36
ci_38                -2.597068e-04 3 1  ON 37
ci_39                -1.576129e-04 3 1  ON 38
ci_40                -1.841823e-03 3 1  ON 39
ci_41                -5.603667e-04 3 1  ON 40
ci_42                -1.608495e-03 3 1  ON 41
ci_43                -1.376098e-03 3 1  ON 42
ci_44                -2.230291e-03 3 1  ON 43
ci_45                -2.699229e-04 3 1  ON 44
ci_46                -1.594093e-03 3 1  ON 45
ci_47                 1.398998e-03 3 1  ON 46
ci_48                 2.889893e-03 3 1  ON 47
ci_49                -8.679829e-04 3 1  ON 48
ci_50                -7.823253e-04 3 1  ON 49
ci_51                -4.944519e-04 3 1  ON 50
ci_52                -5.955923e-04 3 1  ON 51
ci_53                -7.837115e-04 3 1  ON 52
ci_54                -1.101457e-03 3 1  ON 53
ci_55                -1.211015e-03 3 1  ON 54
ci_56                 1.132608e-03 3 1  ON 55
ci_57                 2.080344e-03 3 1  ON 56
ci_58                -2.644626e-04 3 1  ON 57
ci_59                -5.635277e-04 3 1  ON 58
ci_60                 7.423681e-05 3 1  ON 59
ci_61                -1.004540e-03 3 1  ON 60
ci_62                -3.909579e-04 3 1  ON 61
ci_63                -2.761201e-04 3 1  ON 62
ci_64                -5.998477e-04 3 1  ON 63
ci_65                -4.192782e-05 3 1  ON 64
ci_66                -1.519170e-04 3 1  ON 65
ci_67                -2.332987e-04 3 1  ON 66
ci_68                -1.705631e-03 3 1  ON 67
ci_69                -1.774887e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5364e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2805e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -22.8109
    reference variance = 0.467167
====================================================
  Execution time = 2.5329e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5339e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4806e-01
  Total weights = 1.964874170e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5316e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435990437949
                                         uncertainty =       0.002271153444

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435990437949
                                         uncertainty =       0.002271153444

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466871878
  error estimate for blocks of size 2^( 2) =       0.000492085361
  error estimate for blocks of size 2^( 3) =       0.000516422962
  error estimate for blocks of size 2^( 4) =       0.000534622489
  error estimate for blocks of size 2^( 5) =       0.000546484440
  error estimate for blocks of size 2^( 6) =       0.000553750676
  error estimate for blocks of size 2^( 7) =       0.000555645057

      target function =      -0.746958279008
              le_mean =     -22.814925334503
             les_mean =     520.968881418751
             stat err =       0.000547625665
             autocorr =       1.375853386033
   target nu stat err =       0.000547625665
   target dn stat err =       0.002721624883
      target stat err =       0.002347251019
              std dev =       0.660256542210
             le_variance =       0.435938701532


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281492533450e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746964693732       residual = 2.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746964953578       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746964999344       residual = 6.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746965020110       residual = 2.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746965024982       residual = 7.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746965025804       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746965025850       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746965025881       residual = 3.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746965025839       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746965025840       residual = 4.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+01 is 5.286802e-06

solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746964693732       residual = 2.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746964758733       residual = 2.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746964770179       residual = 6.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746964775371       residual = 2.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746964776588       residual = 7.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746964776794       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746964776805       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746964776813       residual = 3.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746964776803       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746964776803       residual = 4.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+02 is 1.322109e-06

solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746964693732       residual = 2.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746964709985       residual = 2.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746964712846       residual = 6.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746964714145       residual = 2.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746964714449       residual = 7.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746964714500       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746964714502       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746964714504       residual = 3.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746964714502       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746964714501       residual = 4.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+02 is 3.305527e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.066178 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9872e+01
  </log>
  <optVariables href="FORM2.s017.opt.xml">
ci_01                 1.086434e-01 3 1  ON 0
ci_02                -2.429976e-02 3 1  ON 1
ci_03                -2.454097e-02 3 1  ON 2
ci_04                 2.241696e-02 3 1  ON 3
ci_05                -1.919443e-02 3 1  ON 4
ci_06                -1.972821e-02 3 1  ON 5
ci_07                 2.582833e-02 3 1  ON 6
ci_08                -4.237601e-03 3 1  ON 7
ci_09                -7.571100e-03 3 1  ON 8
ci_10                -7.621316e-03 3 1  ON 9
ci_11                 1.373997e-02 3 1  ON 10
ci_12                 6.969130e-03 3 1  ON 11
ci_13                 1.379062e-02 3 1  ON 12
ci_14                 1.283333e-02 3 1  ON 13
ci_15                 5.313199e-03 3 1  ON 14
ci_16                 5.754100e-03 3 1  ON 15
ci_17                -5.096637e-03 3 1  ON 16
ci_18                -5.604850e-03 3 1  ON 17
ci_19                 1.024787e-02 3 1  ON 18
ci_20                 6.250404e-03 3 1  ON 19
ci_21                 8.485405e-03 3 1  ON 20
ci_22                 8.839721e-03 3 1  ON 21
ci_23                 4.202100e-03 3 1  ON 22
ci_24                 5.084466e-03 3 1  ON 23
ci_25                 2.980015e-03 3 1  ON 24
ci_26                 3.786885e-03 3 1  ON 25
ci_27                 3.331713e-03 3 1  ON 26
ci_28                 7.867520e-04 3 1  ON 27
ci_29                 1.174754e-03 3 1  ON 28
ci_30                -7.245442e-04 3 1  ON 29
ci_31                 1.001772e-03 3 1  ON 30
ci_32                -6.570930e-04 3 1  ON 31
ci_33                -1.040679e-03 3 1  ON 32
ci_34                 1.203329e-03 3 1  ON 33
ci_35                 1.322403e-03 3 1  ON 34
ci_36                -6.181144e-04 3 1  ON 35
ci_37                -5.410880e-04 3 1  ON 36
ci_38                -2.598302e-04 3 1  ON 37
ci_39                -1.577142e-04 3 1  ON 38
ci_40                -1.841669e-03 3 1  ON 39
ci_41                -5.604450e-04 3 1  ON 40
ci_42                -1.608517e-03 3 1  ON 41
ci_43                -1.376014e-03 3 1  ON 42
ci_44                -2.230337e-03 3 1  ON 43
ci_45                -2.698555e-04 3 1  ON 44
ci_46                -1.593808e-03 3 1  ON 45
ci_47                 1.399010e-03 3 1  ON 46
ci_48                 2.889834e-03 3 1  ON 47
ci_49                -8.679751e-04 3 1  ON 48
ci_50                -7.823259e-04 3 1  ON 49
ci_51                -4.942150e-04 3 1  ON 50
ci_52                -5.954473e-04 3 1  ON 51
ci_53                -7.836535e-04 3 1  ON 52
ci_54                -1.101313e-03 3 1  ON 53
ci_55                -1.210992e-03 3 1  ON 54
ci_56                 1.132750e-03 3 1  ON 55
ci_57                 2.080325e-03 3 1  ON 56
ci_58                -2.645699e-04 3 1  ON 57
ci_59                -5.636268e-04 3 1  ON 58
ci_60                 7.439192e-05 3 1  ON 59
ci_61                -1.004349e-03 3 1  ON 60
ci_62                -3.909548e-04 3 1  ON 61
ci_63                -2.761335e-04 3 1  ON 62
ci_64                -5.999714e-04 3 1  ON 63
ci_65                -4.187330e-05 3 1  ON 64
ci_66                -1.518779e-04 3 1  ON 65
ci_67                -2.332547e-04 3 1  ON 66
ci_68                -1.705287e-03 3 1  ON 67
ci_69                -1.774646e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -22.823
    reference variance = 0.299543
====================================================
  Execution time = 2.4485e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4587e-01
  Total weights = 1.9647e+06
  Execution time = 3.5132e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434566222359
                                         uncertainty =       0.001780244873

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434566222359
                                         uncertainty =       0.001780244873

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466102877
  error estimate for blocks of size 2^( 2) =       0.000491658393
  error estimate for blocks of size 2^( 3) =       0.000515182416
  error estimate for blocks of size 2^( 4) =       0.000532521746
  error estimate for blocks of size 2^( 5) =       0.000543169737
  error estimate for blocks of size 2^( 6) =       0.000549986836
  error estimate for blocks of size 2^( 7) =       0.000555041868

      target function =      -0.748795925985
              le_mean =     -22.815064137013
             les_mean =     520.973016924988
             stat err =       0.000545180047
             autocorr =       1.368095260020
   target nu stat err =       0.000545180047
   target dn stat err =       0.002265787724
      target stat err =       0.001992049279
              std dev =       0.659169009799
             le_variance =       0.434503783479

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434566207437
                                         uncertainty =       0.001780245453

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434566207437
                                         uncertainty =       0.001780245453

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466102868
  error estimate for blocks of size 2^( 2) =       0.000491658143
  error estimate for blocks of size 2^( 3) =       0.000515181925
  error estimate for blocks of size 2^( 4) =       0.000532521061
  error estimate for blocks of size 2^( 5) =       0.000543168915
  error estimate for blocks of size 2^( 6) =       0.000549985982
  error estimate for blocks of size 2^( 7) =       0.000555040920

      target function =      -0.748792876362
              le_mean =     -22.815064160597
             les_mean =     520.973021644579
             stat err =       0.000545179220
             autocorr =       1.368091159869
   target nu stat err =       0.000545179220
   target dn stat err =       0.002265803628
      target stat err =       0.001992046274
              std dev =       0.659168997507
             le_variance =       0.434503767274

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434566214723
                                         uncertainty =       0.001780245162

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434566214723
                                         uncertainty =       0.001780245162

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466102872
  error estimate for blocks of size 2^( 2) =       0.000491658268
  error estimate for blocks of size 2^( 3) =       0.000515182170
  error estimate for blocks of size 2^( 4) =       0.000532521403
  error estimate for blocks of size 2^( 5) =       0.000543169326
  error estimate for blocks of size 2^( 6) =       0.000549986409
  error estimate for blocks of size 2^( 7) =       0.000555041394

      target function =      -0.748794039959
              le_mean =     -22.815064148705
             les_mean =     520.973019711775
             stat err =       0.000545179633
             autocorr =       1.368093209923
   target nu stat err =       0.000545179633
   target dn stat err =       0.002265797906
      target stat err =       0.001992047721
              std dev =       0.659169003520
             le_variance =       0.434503775202

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434566221387
                                         uncertainty =       0.001780244909

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434566221387
                                         uncertainty =       0.001780244909

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466102876
  error estimate for blocks of size 2^( 2) =       0.000491658377
  error estimate for blocks of size 2^( 3) =       0.000515182385
  error estimate for blocks of size 2^( 4) =       0.000532521703
  error estimate for blocks of size 2^( 5) =       0.000543169686
  error estimate for blocks of size 2^( 6) =       0.000549986783
  error estimate for blocks of size 2^( 7) =       0.000555041808

      target function =      -0.748795875708
              le_mean =     -22.815064138472
             les_mean =     520.973017051657
             stat err =       0.000545179995
             autocorr =       1.368095003694
   target nu stat err =       0.000545179995
   target dn stat err =       0.002265788695
      target stat err =       0.001992049785
              std dev =       0.659169009001
             le_variance =       0.434503782427


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748795925985        initial  <--
     6.1035e+01     6.1035e+02             5.2868e-06        -0.748792876362
     2.4414e+02     2.4414e+03             1.3221e-06        -0.748794039959
     9.7656e+02     9.7656e+03             3.3055e-07        -0.748795875708

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.0514
  </log>
  <optVariables href="FORM2.s017.opt.xml">
ci_01                 1.086420e-01 3 1  ON 0
ci_02                -2.429918e-02 3 1  ON 1
ci_03                -2.454039e-02 3 1  ON 2
ci_04                 2.241628e-02 3 1  ON 3
ci_05                -1.919445e-02 3 1  ON 4
ci_06                -1.972793e-02 3 1  ON 5
ci_07                 2.582833e-02 3 1  ON 6
ci_08                -4.237378e-03 3 1  ON 7
ci_09                -7.570841e-03 3 1  ON 8
ci_10                -7.621324e-03 3 1  ON 9
ci_11                 1.374039e-02 3 1  ON 10
ci_12                 6.969023e-03 3 1  ON 11
ci_13                 1.379065e-02 3 1  ON 12
ci_14                 1.283315e-02 3 1  ON 13
ci_15                 5.312929e-03 3 1  ON 14
ci_16                 5.754127e-03 3 1  ON 15
ci_17                -5.096400e-03 3 1  ON 16
ci_18                -5.604846e-03 3 1  ON 17
ci_19                 1.024815e-02 3 1  ON 18
ci_20                 6.250597e-03 3 1  ON 19
ci_21                 8.485520e-03 3 1  ON 20
ci_22                 8.839778e-03 3 1  ON 21
ci_23                 4.201959e-03 3 1  ON 22
ci_24                 5.084803e-03 3 1  ON 23
ci_25                 2.980099e-03 3 1  ON 24
ci_26                 3.786819e-03 3 1  ON 25
ci_27                 3.331681e-03 3 1  ON 26
ci_28                 7.865855e-04 3 1  ON 27
ci_29                 1.174398e-03 3 1  ON 28
ci_30                -7.246282e-04 3 1  ON 29
ci_31                 1.001858e-03 3 1  ON 30
ci_32                -6.569873e-04 3 1  ON 31
ci_33                -1.040554e-03 3 1  ON 32
ci_34                 1.203553e-03 3 1  ON 33
ci_35                 1.322159e-03 3 1  ON 34
ci_36                -6.182794e-04 3 1  ON 35
ci_37                -5.411483e-04 3 1  ON 36
ci_38                -2.597068e-04 3 1  ON 37
ci_39                -1.576129e-04 3 1  ON 38
ci_40                -1.841823e-03 3 1  ON 39
ci_41                -5.603667e-04 3 1  ON 40
ci_42                -1.608495e-03 3 1  ON 41
ci_43                -1.376098e-03 3 1  ON 42
ci_44                -2.230291e-03 3 1  ON 43
ci_45                -2.699229e-04 3 1  ON 44
ci_46                -1.594093e-03 3 1  ON 45
ci_47                 1.398998e-03 3 1  ON 46
ci_48                 2.889893e-03 3 1  ON 47
ci_49                -8.679829e-04 3 1  ON 48
ci_50                -7.823253e-04 3 1  ON 49
ci_51                -4.944519e-04 3 1  ON 50
ci_52                -5.955923e-04 3 1  ON 51
ci_53                -7.837115e-04 3 1  ON 52
ci_54                -1.101457e-03 3 1  ON 53
ci_55                -1.211015e-03 3 1  ON 54
ci_56                 1.132608e-03 3 1  ON 55
ci_57                 2.080344e-03 3 1  ON 56
ci_58                -2.644626e-04 3 1  ON 57
ci_59                -5.635277e-04 3 1  ON 58
ci_60                 7.423681e-05 3 1  ON 59
ci_61                -1.004540e-03 3 1  ON 60
ci_62                -3.909579e-04 3 1  ON 61
ci_63                -2.761201e-04 3 1  ON 62
ci_64                -5.998477e-04 3 1  ON 63
ci_65                -4.192782e-05 3 1  ON 64
ci_66                -1.519170e-04 3 1  ON 65
ci_67                -2.332987e-04 3 1  ON 66
ci_68                -1.705631e-03 3 1  ON 67
ci_69                -1.774887e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.1930e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2805e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -22.8343
    reference variance = 0.771716
====================================================
  Execution time = 2.5145e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5343e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5250e-01
  Total weights = 1.964653769e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5033e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438375698605
                                         uncertainty =       0.002521623113

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438375698605
                                         uncertainty =       0.002521623113

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468231398
  error estimate for blocks of size 2^( 2) =       0.000494308930
  error estimate for blocks of size 2^( 3) =       0.000518915447
  error estimate for blocks of size 2^( 4) =       0.000537207981
  error estimate for blocks of size 2^( 5) =       0.000547875124
  error estimate for blocks of size 2^( 6) =       0.000553275788
  error estimate for blocks of size 2^( 7) =       0.000557631707

      target function =      -0.743281306521
              le_mean =     -22.813955790556
             les_mean =     520.929076296595
             stat err =       0.000548997650
             autocorr =       1.374737900062
   target nu stat err =       0.000548997650
   target dn stat err =       0.003784546017
      target stat err =       0.003174974669
              std dev =       0.662179192830
             le_variance =       0.438481283417


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281395579056e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743293805309       residual = 2.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743293834181       residual = 2.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743293840061       residual = 5.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743293841442       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743293841857       residual = 5.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743293842196       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743293842207       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743293842213       residual = 4.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743293842210       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743293842217       residual = 5.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+02 is 4.348226e-07

solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743293805309       residual = 2.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743293812527       residual = 2.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743293813997       residual = 5.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743293814343       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743293814443       residual = 5.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743293814529       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743293814535       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743293814533       residual = 4.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743293814537       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743293814538       residual = 5.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+03 is 1.087091e-07

solving harmonic davidson linear method for identity shift 9.7656e+03, overlap shift 9.7656e+04 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743293805309       residual = 2.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743293807113       residual = 2.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743293807481       residual = 5.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743293807567       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743293807589       residual = 5.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743293807612       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743293807615       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743293807617       residual = 4.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743293807599       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743293807612       residual = 5.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+03 is 2.717750e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.069749 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9657e+01
  </log>
  <optVariables href="FORM2.s018.opt.xml">
ci_01                 1.086422e-01 3 1  ON 0
ci_02                -2.429924e-02 3 1  ON 1
ci_03                -2.454043e-02 3 1  ON 2
ci_04                 2.241633e-02 3 1  ON 3
ci_05                -1.919450e-02 3 1  ON 4
ci_06                -1.972792e-02 3 1  ON 5
ci_07                 2.582834e-02 3 1  ON 6
ci_08                -4.237381e-03 3 1  ON 7
ci_09                -7.570848e-03 3 1  ON 8
ci_10                -7.621334e-03 3 1  ON 9
ci_11                 1.374038e-02 3 1  ON 10
ci_12                 6.969025e-03 3 1  ON 11
ci_13                 1.379065e-02 3 1  ON 12
ci_14                 1.283317e-02 3 1  ON 13
ci_15                 5.312960e-03 3 1  ON 14
ci_16                 5.754154e-03 3 1  ON 15
ci_17                -5.096401e-03 3 1  ON 16
ci_18                -5.604879e-03 3 1  ON 17
ci_19                 1.024809e-02 3 1  ON 18
ci_20                 6.250565e-03 3 1  ON 19
ci_21                 8.485515e-03 3 1  ON 20
ci_22                 8.839767e-03 3 1  ON 21
ci_23                 4.201972e-03 3 1  ON 22
ci_24                 5.084798e-03 3 1  ON 23
ci_25                 2.980100e-03 3 1  ON 24
ci_26                 3.786810e-03 3 1  ON 25
ci_27                 3.331678e-03 3 1  ON 26
ci_28                 7.865852e-04 3 1  ON 27
ci_29                 1.174405e-03 3 1  ON 28
ci_30                -7.246490e-04 3 1  ON 29
ci_31                 1.001817e-03 3 1  ON 30
ci_32                -6.569864e-04 3 1  ON 31
ci_33                -1.040566e-03 3 1  ON 32
ci_34                 1.203557e-03 3 1  ON 33
ci_35                 1.322157e-03 3 1  ON 34
ci_36                -6.182868e-04 3 1  ON 35
ci_37                -5.411613e-04 3 1  ON 36
ci_38                -2.597125e-04 3 1  ON 37
ci_39                -1.576148e-04 3 1  ON 38
ci_40                -1.841790e-03 3 1  ON 39
ci_41                -5.603759e-04 3 1  ON 40
ci_42                -1.608494e-03 3 1  ON 41
ci_43                -1.376107e-03 3 1  ON 42
ci_44                -2.230249e-03 3 1  ON 43
ci_45                -2.699255e-04 3 1  ON 44
ci_46                -1.594074e-03 3 1  ON 45
ci_47                 1.399016e-03 3 1  ON 46
ci_48                 2.889874e-03 3 1  ON 47
ci_49                -8.679962e-04 3 1  ON 48
ci_50                -7.823278e-04 3 1  ON 49
ci_51                -4.944377e-04 3 1  ON 50
ci_52                -5.955835e-04 3 1  ON 51
ci_53                -7.837151e-04 3 1  ON 52
ci_54                -1.101443e-03 3 1  ON 53
ci_55                -1.210997e-03 3 1  ON 54
ci_56                 1.132623e-03 3 1  ON 55
ci_57                 2.080339e-03 3 1  ON 56
ci_58                -2.644682e-04 3 1  ON 57
ci_59                -5.635348e-04 3 1  ON 58
ci_60                 7.427383e-05 3 1  ON 59
ci_61                -1.004530e-03 3 1  ON 60
ci_62                -3.909401e-04 3 1  ON 61
ci_63                -2.761140e-04 3 1  ON 62
ci_64                -5.998232e-04 3 1  ON 63
ci_65                -4.193420e-05 3 1  ON 64
ci_66                -1.519176e-04 3 1  ON 65
ci_67                -2.333055e-04 3 1  ON 66
ci_68                -1.705611e-03 3 1  ON 67
ci_69                -1.774867e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -22.7822
    reference variance = 0.514393
====================================================
  Execution time = 2.4377e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5166e-01
  Total weights = 1.9644e+06
  Execution time = 3.5016e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439708227074
                                         uncertainty =       0.003074683659

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439708227074
                                         uncertainty =       0.003074683659

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468928713
  error estimate for blocks of size 2^( 2) =       0.000495206950
  error estimate for blocks of size 2^( 3) =       0.000519270273
  error estimate for blocks of size 2^( 4) =       0.000537139758
  error estimate for blocks of size 2^( 5) =       0.000547425777
  error estimate for blocks of size 2^( 6) =       0.000552775842
  error estimate for blocks of size 2^( 7) =       0.000556056394

      target function =      -0.743966776915
              le_mean =     -22.815261713930
             les_mean =     520.987829555277
             stat err =       0.000548349443
             autocorr =       1.367417587480
   target nu stat err =       0.000548349443
   target dn stat err =       0.003607113131
      target stat err =       0.003042967712
              std dev =       0.663165345250
             le_variance =       0.439788275141

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439708213995
                                         uncertainty =       0.003074685726

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439708213995
                                         uncertainty =       0.003074685726

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468928706
  error estimate for blocks of size 2^( 2) =       0.000495206920
  error estimate for blocks of size 2^( 3) =       0.000519270224
  error estimate for blocks of size 2^( 4) =       0.000537139694
  error estimate for blocks of size 2^( 5) =       0.000547425706
  error estimate for blocks of size 2^( 6) =       0.000552775771
  error estimate for blocks of size 2^( 7) =       0.000556056318

      target function =      -0.743966724296
              le_mean =     -22.815261712672
             les_mean =     520.987829561501
             stat err =       0.000548349372
             autocorr =       1.367417277159
   target nu stat err =       0.000548349372
   target dn stat err =       0.003607119084
      target stat err =       0.003042972090
              std dev =       0.663165335441
             le_variance =       0.439788262130

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439708220532
                                         uncertainty =       0.003074684693

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439708220532
                                         uncertainty =       0.003074684693

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468928709
  error estimate for blocks of size 2^( 2) =       0.000495206935
  error estimate for blocks of size 2^( 3) =       0.000519270248
  error estimate for blocks of size 2^( 4) =       0.000537139726
  error estimate for blocks of size 2^( 5) =       0.000547425741
  error estimate for blocks of size 2^( 6) =       0.000552775806
  error estimate for blocks of size 2^( 7) =       0.000556056356

      target function =      -0.743966751410
              le_mean =     -22.815261713301
             les_mean =     520.987829557404
             stat err =       0.000548349407
             autocorr =       1.367417432309
   target nu stat err =       0.000548349407
   target dn stat err =       0.003607116106
      target stat err =       0.003042969907
              std dev =       0.663165340344
             le_variance =       0.439788268633

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439708226256
                                         uncertainty =       0.003074683789

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439708226256
                                         uncertainty =       0.003074683789

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468928712
  error estimate for blocks of size 2^( 2) =       0.000495206948
  error estimate for blocks of size 2^( 3) =       0.000519270270
  error estimate for blocks of size 2^( 4) =       0.000537139754
  error estimate for blocks of size 2^( 5) =       0.000547425772
  error estimate for blocks of size 2^( 6) =       0.000552775837
  error estimate for blocks of size 2^( 7) =       0.000556056389

      target function =      -0.743966773811
              le_mean =     -22.815261713851
             les_mean =     520.987829555440
             stat err =       0.000548349438
             autocorr =       1.367417568084
   target nu stat err =       0.000548349438
   target dn stat err =       0.003607113502
      target stat err =       0.003042967987
              std dev =       0.663165344637
             le_variance =       0.439788274327


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743966776915        initial  <--
     6.1035e+02     6.1035e+03             4.3482e-07        -0.743966724296
     2.4414e+03     2.4414e+04             1.0871e-07        -0.743966751410
     9.7656e+03     9.7656e+04             2.7177e-08        -0.743966773811

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 41.8892
  </log>
  <optVariables href="FORM2.s018.opt.xml">
ci_01                 1.086420e-01 3 1  ON 0
ci_02                -2.429918e-02 3 1  ON 1
ci_03                -2.454039e-02 3 1  ON 2
ci_04                 2.241628e-02 3 1  ON 3
ci_05                -1.919445e-02 3 1  ON 4
ci_06                -1.972793e-02 3 1  ON 5
ci_07                 2.582833e-02 3 1  ON 6
ci_08                -4.237378e-03 3 1  ON 7
ci_09                -7.570841e-03 3 1  ON 8
ci_10                -7.621324e-03 3 1  ON 9
ci_11                 1.374039e-02 3 1  ON 10
ci_12                 6.969023e-03 3 1  ON 11
ci_13                 1.379065e-02 3 1  ON 12
ci_14                 1.283315e-02 3 1  ON 13
ci_15                 5.312929e-03 3 1  ON 14
ci_16                 5.754127e-03 3 1  ON 15
ci_17                -5.096400e-03 3 1  ON 16
ci_18                -5.604846e-03 3 1  ON 17
ci_19                 1.024815e-02 3 1  ON 18
ci_20                 6.250597e-03 3 1  ON 19
ci_21                 8.485520e-03 3 1  ON 20
ci_22                 8.839778e-03 3 1  ON 21
ci_23                 4.201959e-03 3 1  ON 22
ci_24                 5.084803e-03 3 1  ON 23
ci_25                 2.980099e-03 3 1  ON 24
ci_26                 3.786819e-03 3 1  ON 25
ci_27                 3.331681e-03 3 1  ON 26
ci_28                 7.865855e-04 3 1  ON 27
ci_29                 1.174398e-03 3 1  ON 28
ci_30                -7.246282e-04 3 1  ON 29
ci_31                 1.001858e-03 3 1  ON 30
ci_32                -6.569873e-04 3 1  ON 31
ci_33                -1.040554e-03 3 1  ON 32
ci_34                 1.203553e-03 3 1  ON 33
ci_35                 1.322159e-03 3 1  ON 34
ci_36                -6.182794e-04 3 1  ON 35
ci_37                -5.411483e-04 3 1  ON 36
ci_38                -2.597068e-04 3 1  ON 37
ci_39                -1.576129e-04 3 1  ON 38
ci_40                -1.841823e-03 3 1  ON 39
ci_41                -5.603667e-04 3 1  ON 40
ci_42                -1.608495e-03 3 1  ON 41
ci_43                -1.376098e-03 3 1  ON 42
ci_44                -2.230291e-03 3 1  ON 43
ci_45                -2.699229e-04 3 1  ON 44
ci_46                -1.594093e-03 3 1  ON 45
ci_47                 1.398998e-03 3 1  ON 46
ci_48                 2.889893e-03 3 1  ON 47
ci_49                -8.679829e-04 3 1  ON 48
ci_50                -7.823253e-04 3 1  ON 49
ci_51                -4.944519e-04 3 1  ON 50
ci_52                -5.955923e-04 3 1  ON 51
ci_53                -7.837115e-04 3 1  ON 52
ci_54                -1.101457e-03 3 1  ON 53
ci_55                -1.211015e-03 3 1  ON 54
ci_56                 1.132608e-03 3 1  ON 55
ci_57                 2.080344e-03 3 1  ON 56
ci_58                -2.644626e-04 3 1  ON 57
ci_59                -5.635277e-04 3 1  ON 58
ci_60                 7.423681e-05 3 1  ON 59
ci_61                -1.004540e-03 3 1  ON 60
ci_62                -3.909579e-04 3 1  ON 61
ci_63                -2.761201e-04 3 1  ON 62
ci_64                -5.998477e-04 3 1  ON 63
ci_65                -4.192782e-05 3 1  ON 64
ci_66                -1.519170e-04 3 1  ON 65
ci_67                -2.332987e-04 3 1  ON 66
ci_68                -1.705631e-03 3 1  ON 67
ci_69                -1.774887e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.1553e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2806e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -22.8483
    reference variance = 0.556367
====================================================
  Execution time = 2.7174e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5337e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4537e-01
  Total weights = 1.964952858e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4868e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432790927187
                                         uncertainty =       0.001500521925

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432790927187
                                         uncertainty =       0.001500521925

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465185779
  error estimate for blocks of size 2^( 2) =       0.000491309646
  error estimate for blocks of size 2^( 3) =       0.000516076876
  error estimate for blocks of size 2^( 4) =       0.000534217745
  error estimate for blocks of size 2^( 5) =       0.000546134966
  error estimate for blocks of size 2^( 6) =       0.000551202994
  error estimate for blocks of size 2^( 7) =       0.000554888927

      target function =      -0.749205165123
              le_mean =     -22.813780294915
             les_mean =     520.913938204256
             stat err =       0.000546611158
             autocorr =       1.380715261860
   target nu stat err =       0.000546611158
   target dn stat err =       0.002589029841
      target stat err =       0.002249661208
              std dev =       0.657872038360
             le_variance =       0.432795618856


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281378029491e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+03, overlap shift 6.1035e+04 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749210904276       residual = 3.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749210908343       residual = 3.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749210908965       residual = 7.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749210909138       residual = 2.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749210909171       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749210909180       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749210909182       residual = 2.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749210909186       residual = 5.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749210909185       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749210909186       residual = 5.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+03 is 4.277546e-08

solving harmonic davidson linear method for identity shift 2.4414e+04, overlap shift 2.4414e+05 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749210904276       residual = 3.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749210905293       residual = 3.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749210905448       residual = 7.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749210905492       residual = 2.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749210905500       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749210905519       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749210905550       residual = 2.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749210905504       residual = 5.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749210905503       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749210905504       residual = 5.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+04 is 1.069390e-08

solving harmonic davidson linear method for identity shift 9.7656e+04, overlap shift 9.7656e+05 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749210904276       residual = 3.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749210904530       residual = 3.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749210904569       residual = 7.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749210904580       residual = 2.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749210904582       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749210904740       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749210904648       residual = 2.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749210904561       residual = 5.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749210904546       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749210904434       residual = 5.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+04 is 2.673477e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.073340 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1670e+01
  </log>
  <optVariables href="FORM2.s019.opt.xml">
ci_01                 1.086421e-01 3 1  ON 0
ci_02                -2.429919e-02 3 1  ON 1
ci_03                -2.454039e-02 3 1  ON 2
ci_04                 2.241629e-02 3 1  ON 3
ci_05                -1.919446e-02 3 1  ON 4
ci_06                -1.972794e-02 3 1  ON 5
ci_07                 2.582833e-02 3 1  ON 6
ci_08                -4.237381e-03 3 1  ON 7
ci_09                -7.570840e-03 3 1  ON 8
ci_10                -7.621328e-03 3 1  ON 9
ci_11                 1.374039e-02 3 1  ON 10
ci_12                 6.969023e-03 3 1  ON 11
ci_13                 1.379065e-02 3 1  ON 12
ci_14                 1.283315e-02 3 1  ON 13
ci_15                 5.312927e-03 3 1  ON 14
ci_16                 5.754127e-03 3 1  ON 15
ci_17                -5.096402e-03 3 1  ON 16
ci_18                -5.604847e-03 3 1  ON 17
ci_19                 1.024815e-02 3 1  ON 18
ci_20                 6.250598e-03 3 1  ON 19
ci_21                 8.485520e-03 3 1  ON 20
ci_22                 8.839774e-03 3 1  ON 21
ci_23                 4.201962e-03 3 1  ON 22
ci_24                 5.084801e-03 3 1  ON 23
ci_25                 2.980098e-03 3 1  ON 24
ci_26                 3.786817e-03 3 1  ON 25
ci_27                 3.331681e-03 3 1  ON 26
ci_28                 7.865864e-04 3 1  ON 27
ci_29                 1.174399e-03 3 1  ON 28
ci_30                -7.246279e-04 3 1  ON 29
ci_31                 1.001859e-03 3 1  ON 30
ci_32                -6.569859e-04 3 1  ON 31
ci_33                -1.040552e-03 3 1  ON 32
ci_34                 1.203555e-03 3 1  ON 33
ci_35                 1.322159e-03 3 1  ON 34
ci_36                -6.182774e-04 3 1  ON 35
ci_37                -5.411496e-04 3 1  ON 36
ci_38                -2.597076e-04 3 1  ON 37
ci_39                -1.576143e-04 3 1  ON 38
ci_40                -1.841820e-03 3 1  ON 39
ci_41                -5.603722e-04 3 1  ON 40
ci_42                -1.608493e-03 3 1  ON 41
ci_43                -1.376098e-03 3 1  ON 42
ci_44                -2.230288e-03 3 1  ON 43
ci_45                -2.699222e-04 3 1  ON 44
ci_46                -1.594093e-03 3 1  ON 45
ci_47                 1.399003e-03 3 1  ON 46
ci_48                 2.889894e-03 3 1  ON 47
ci_49                -8.679840e-04 3 1  ON 48
ci_50                -7.823246e-04 3 1  ON 49
ci_51                -4.944470e-04 3 1  ON 50
ci_52                -5.955914e-04 3 1  ON 51
ci_53                -7.837135e-04 3 1  ON 52
ci_54                -1.101456e-03 3 1  ON 53
ci_55                -1.211014e-03 3 1  ON 54
ci_56                 1.132611e-03 3 1  ON 55
ci_57                 2.080343e-03 3 1  ON 56
ci_58                -2.644630e-04 3 1  ON 57
ci_59                -5.635276e-04 3 1  ON 58
ci_60                 7.423960e-05 3 1  ON 59
ci_61                -1.004541e-03 3 1  ON 60
ci_62                -3.909577e-04 3 1  ON 61
ci_63                -2.761187e-04 3 1  ON 62
ci_64                -5.998479e-04 3 1  ON 63
ci_65                -4.192802e-05 3 1  ON 64
ci_66                -1.519184e-04 3 1  ON 65
ci_67                -2.333004e-04 3 1  ON 66
ci_68                -1.705633e-03 3 1  ON 67
ci_69                -1.774885e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -22.8383
    reference variance = 0.825669
====================================================
  Execution time = 2.4535e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4811e-01
  Total weights = 1.9649e+06
  Execution time = 3.5055e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435753687940
                                         uncertainty =       0.001667326109

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435753687940
                                         uncertainty =       0.001667326109

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466736707
  error estimate for blocks of size 2^( 2) =       0.000492437456
  error estimate for blocks of size 2^( 3) =       0.000516351460
  error estimate for blocks of size 2^( 4) =       0.000534985471
  error estimate for blocks of size 2^( 5) =       0.000544763691
  error estimate for blocks of size 2^( 6) =       0.000550250676
  error estimate for blocks of size 2^( 7) =       0.000553029055

      target function =      -0.746922776541
              le_mean =     -22.814716787367
             les_mean =     520.959408277268
             stat err =       0.000545757223
             autocorr =       1.367272468246
   target nu stat err =       0.000545757223
   target dn stat err =       0.002664531869
      target stat err =       0.002299896161
              std dev =       0.660065381430
             le_variance =       0.435686307762

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435753683109
                                         uncertainty =       0.001667326346

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435753683109
                                         uncertainty =       0.001667326346

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466736705
  error estimate for blocks of size 2^( 2) =       0.000492437452
  error estimate for blocks of size 2^( 3) =       0.000516351452
  error estimate for blocks of size 2^( 4) =       0.000534985462
  error estimate for blocks of size 2^( 5) =       0.000544763680
  error estimate for blocks of size 2^( 6) =       0.000550250665
  error estimate for blocks of size 2^( 7) =       0.000553029044

      target function =      -0.746923169262
              le_mean =     -22.814716787260
             les_mean =     520.959407800787
             stat err =       0.000545757213
             autocorr =       1.367272431487
   target nu stat err =       0.000545757213
   target dn stat err =       0.002664502213
      target stat err =       0.002299874684
              std dev =       0.660065377781
             le_variance =       0.435686302945

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435753685524
                                         uncertainty =       0.001667326228

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435753685524
                                         uncertainty =       0.001667326228

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466736706
  error estimate for blocks of size 2^( 2) =       0.000492437454
  error estimate for blocks of size 2^( 3) =       0.000516351456
  error estimate for blocks of size 2^( 4) =       0.000534985467
  error estimate for blocks of size 2^( 5) =       0.000544763685
  error estimate for blocks of size 2^( 6) =       0.000550250670
  error estimate for blocks of size 2^( 7) =       0.000553029050

      target function =      -0.746922973100
              le_mean =     -22.814716787314
             les_mean =     520.959408038789
             stat err =       0.000545757218
             autocorr =       1.367272449874
   target nu stat err =       0.000545757218
   target dn stat err =       0.002664517016
      target stat err =       0.002299885404
              std dev =       0.660065379605
             le_variance =       0.435686305354

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435753687638
                                         uncertainty =       0.001667326124

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435753687638
                                         uncertainty =       0.001667326124

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466736707
  error estimate for blocks of size 2^( 2) =       0.000492437456
  error estimate for blocks of size 2^( 3) =       0.000516351459
  error estimate for blocks of size 2^( 4) =       0.000534985471
  error estimate for blocks of size 2^( 5) =       0.000544763690
  error estimate for blocks of size 2^( 6) =       0.000550250675
  error estimate for blocks of size 2^( 7) =       0.000553029054

      target function =      -0.746922801132
              le_mean =     -22.814716787360
             les_mean =     520.959408247432
             stat err =       0.000545757223
             autocorr =       1.367272465954
   target nu stat err =       0.000545757223
   target dn stat err =       0.002664530009
      target stat err =       0.002299894814
              std dev =       0.660065381202
             le_variance =       0.435686307461


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746922776541        initial
     6.1035e+03     6.1035e+04             4.2775e-08        -0.746923169262  <--
     2.4414e+04     2.4414e+05             1.0694e-08        -0.746922973100
     9.7656e+04     9.7656e+05             2.6735e-09        -0.746922801132

*****************************************************************************
Applying the update for shift_i =   6.1035e+03     and shift_s =   6.1035e+04
*****************************************************************************

  Execution time = 4.2064e+01
  </log>
  <optVariables href="FORM2.s019.opt.xml">
ci_01                 1.086421e-01 3 1  ON 0
ci_02                -2.429922e-02 3 1  ON 1
ci_03                -2.454040e-02 3 1  ON 2
ci_04                 2.241631e-02 3 1  ON 3
ci_05                -1.919446e-02 3 1  ON 4
ci_06                -1.972795e-02 3 1  ON 5
ci_07                 2.582833e-02 3 1  ON 6
ci_08                -4.237390e-03 3 1  ON 7
ci_09                -7.570837e-03 3 1  ON 8
ci_10                -7.621340e-03 3 1  ON 9
ci_11                 1.374039e-02 3 1  ON 10
ci_12                 6.969022e-03 3 1  ON 11
ci_13                 1.379065e-02 3 1  ON 12
ci_14                 1.283316e-02 3 1  ON 13
ci_15                 5.312920e-03 3 1  ON 14
ci_16                 5.754127e-03 3 1  ON 15
ci_17                -5.096410e-03 3 1  ON 16
ci_18                -5.604850e-03 3 1  ON 17
ci_19                 1.024814e-02 3 1  ON 18
ci_20                 6.250602e-03 3 1  ON 19
ci_21                 8.485522e-03 3 1  ON 20
ci_22                 8.839764e-03 3 1  ON 21
ci_23                 4.201971e-03 3 1  ON 22
ci_24                 5.084795e-03 3 1  ON 23
ci_25                 2.980096e-03 3 1  ON 24
ci_26                 3.786812e-03 3 1  ON 25
ci_27                 3.331682e-03 3 1  ON 26
ci_28                 7.865890e-04 3 1  ON 27
ci_29                 1.174405e-03 3 1  ON 28
ci_30                -7.246270e-04 3 1  ON 29
ci_31                 1.001859e-03 3 1  ON 30
ci_32                -6.569816e-04 3 1  ON 31
ci_33                -1.040549e-03 3 1  ON 32
ci_34                 1.203561e-03 3 1  ON 33
ci_35                 1.322159e-03 3 1  ON 34
ci_36                -6.182714e-04 3 1  ON 35
ci_37                -5.411534e-04 3 1  ON 36
ci_38                -2.597101e-04 3 1  ON 37
ci_39                -1.576185e-04 3 1  ON 38
ci_40                -1.841814e-03 3 1  ON 39
ci_41                -5.603887e-04 3 1  ON 40
ci_42                -1.608487e-03 3 1  ON 41
ci_43                -1.376097e-03 3 1  ON 42
ci_44                -2.230280e-03 3 1  ON 43
ci_45                -2.699198e-04 3 1  ON 44
ci_46                -1.594091e-03 3 1  ON 45
ci_47                 1.399020e-03 3 1  ON 46
ci_48                 2.889899e-03 3 1  ON 47
ci_49                -8.679874e-04 3 1  ON 48
ci_50                -7.823225e-04 3 1  ON 49
ci_51                -4.944323e-04 3 1  ON 50
ci_52                -5.955887e-04 3 1  ON 51
ci_53                -7.837195e-04 3 1  ON 52
ci_54                -1.101451e-03 3 1  ON 53
ci_55                -1.211013e-03 3 1  ON 54
ci_56                 1.132621e-03 3 1  ON 55
ci_57                 2.080339e-03 3 1  ON 56
ci_58                -2.644640e-04 3 1  ON 57
ci_59                -5.635272e-04 3 1  ON 58
ci_60                 7.424799e-05 3 1  ON 59
ci_61                -1.004542e-03 3 1  ON 60
ci_62                -3.909571e-04 3 1  ON 61
ci_63                -2.761143e-04 3 1  ON 62
ci_64                -5.998483e-04 3 1  ON 63
ci_65                -4.192862e-05 3 1  ON 64
ci_66                -1.519225e-04 3 1  ON 65
ci_67                -2.333056e-04 3 1  ON 66
ci_68                -1.705639e-03 3 1  ON 67
ci_69                -1.774880e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3742e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2807e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -22.926
    reference variance = 0.360476
====================================================
  Execution time = 2.5268e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5336e+04
  VMC Eavg = -2.2813e+01
  VMC Evar = 4.5136e-01
  Total weights = 1.964758104e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5330e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439498784127
                                         uncertainty =       0.002073441259

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439498784127
                                         uncertainty =       0.002073441259

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468796162
  error estimate for blocks of size 2^( 2) =       0.000494822203
  error estimate for blocks of size 2^( 3) =       0.000519435597
  error estimate for blocks of size 2^( 4) =       0.000537265087
  error estimate for blocks of size 2^( 5) =       0.000548283705
  error estimate for blocks of size 2^( 6) =       0.000554387312
  error estimate for blocks of size 2^( 7) =       0.000560591158

      target function =      -0.744221871308
              le_mean =     -22.813077355366
             les_mean =     520.887862106782
             stat err =       0.000550131815
             autocorr =       1.377099842813
   target nu stat err =       0.000550131815
   target dn stat err =       0.002921453915
      target stat err =       0.002484337710
              std dev =       0.662977890509
             le_variance =       0.439539683304


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281307735537e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744229178210       residual = 2.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744229191914       residual = 2.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744229193729       residual = 4.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744229194033       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744229194190       residual = 4.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744229194116       residual = 8.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744229194122       residual = 2.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744229194127       residual = 6.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744229194136       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744229194134       residual = 7.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+03 is 1.201550e-07

solving harmonic davidson linear method for identity shift 6.1035e+03, overlap shift 6.1035e+04 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744229178210       residual = 2.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744229181636       residual = 2.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744229182090       residual = 4.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744229182168       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744229182214       residual = 4.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744229182188       residual = 8.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744229182196       residual = 2.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744229182186       residual = 6.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744229182197       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744229182200       residual = 7.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+03 is 3.003915e-08

solving harmonic davidson linear method for identity shift 2.4414e+04, overlap shift 2.4414e+05 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744229178210       residual = 2.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744229179067       residual = 2.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744229179180       residual = 4.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744229179198       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744229179193       residual = 4.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744229179204       residual = 8.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744229179205       residual = 2.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744229179186       residual = 6.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744229179214       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744229179197       residual = 7.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+04 is 7.509812e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.076860 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9810e+01
  </log>
  <optVariables href="FORM2.s020.opt.xml">
ci_01                 1.086421e-01 3 1  ON 0
ci_02                -2.429924e-02 3 1  ON 1
ci_03                -2.454043e-02 3 1  ON 2
ci_04                 2.241633e-02 3 1  ON 3
ci_05                -1.919446e-02 3 1  ON 4
ci_06                -1.972795e-02 3 1  ON 5
ci_07                 2.582833e-02 3 1  ON 6
ci_08                -4.237391e-03 3 1  ON 7
ci_09                -7.570827e-03 3 1  ON 8
ci_10                -7.621336e-03 3 1  ON 9
ci_11                 1.374038e-02 3 1  ON 10
ci_12                 6.969024e-03 3 1  ON 11
ci_13                 1.379064e-02 3 1  ON 12
ci_14                 1.283317e-02 3 1  ON 13
ci_15                 5.312923e-03 3 1  ON 14
ci_16                 5.754120e-03 3 1  ON 15
ci_17                -5.096421e-03 3 1  ON 16
ci_18                -5.604851e-03 3 1  ON 17
ci_19                 1.024814e-02 3 1  ON 18
ci_20                 6.250611e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839772e-03 3 1  ON 21
ci_23                 4.201968e-03 3 1  ON 22
ci_24                 5.084796e-03 3 1  ON 23
ci_25                 2.980084e-03 3 1  ON 24
ci_26                 3.786810e-03 3 1  ON 25
ci_27                 3.331665e-03 3 1  ON 26
ci_28                 7.866061e-04 3 1  ON 27
ci_29                 1.174407e-03 3 1  ON 28
ci_30                -7.246173e-04 3 1  ON 29
ci_31                 1.001848e-03 3 1  ON 30
ci_32                -6.569973e-04 3 1  ON 31
ci_33                -1.040550e-03 3 1  ON 32
ci_34                 1.203578e-03 3 1  ON 33
ci_35                 1.322159e-03 3 1  ON 34
ci_36                -6.182744e-04 3 1  ON 35
ci_37                -5.411624e-04 3 1  ON 36
ci_38                -2.597129e-04 3 1  ON 37
ci_39                -1.576204e-04 3 1  ON 38
ci_40                -1.841803e-03 3 1  ON 39
ci_41                -5.603979e-04 3 1  ON 40
ci_42                -1.608483e-03 3 1  ON 41
ci_43                -1.376111e-03 3 1  ON 42
ci_44                -2.230280e-03 3 1  ON 43
ci_45                -2.699249e-04 3 1  ON 44
ci_46                -1.594084e-03 3 1  ON 45
ci_47                 1.399022e-03 3 1  ON 46
ci_48                 2.889901e-03 3 1  ON 47
ci_49                -8.679872e-04 3 1  ON 48
ci_50                -7.823214e-04 3 1  ON 49
ci_51                -4.944314e-04 3 1  ON 50
ci_52                -5.955828e-04 3 1  ON 51
ci_53                -7.837262e-04 3 1  ON 52
ci_54                -1.101448e-03 3 1  ON 53
ci_55                -1.211012e-03 3 1  ON 54
ci_56                 1.132628e-03 3 1  ON 55
ci_57                 2.080334e-03 3 1  ON 56
ci_58                -2.644673e-04 3 1  ON 57
ci_59                -5.635356e-04 3 1  ON 58
ci_60                 7.425049e-05 3 1  ON 59
ci_61                -1.004532e-03 3 1  ON 60
ci_62                -3.909550e-04 3 1  ON 61
ci_63                -2.761244e-04 3 1  ON 62
ci_64                -5.998520e-04 3 1  ON 63
ci_65                -4.193755e-05 3 1  ON 64
ci_66                -1.519258e-04 3 1  ON 65
ci_67                -2.332991e-04 3 1  ON 66
ci_68                -1.705627e-03 3 1  ON 67
ci_69                -1.774856e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -22.7419
    reference variance = 0.380059
====================================================
  Execution time = 2.4568e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4551e-01
  Total weights = 1.9648e+06
  Execution time = 3.5070e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433668183253
                                         uncertainty =       0.001966330675

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433668183253
                                         uncertainty =       0.001966330675

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465657337
  error estimate for blocks of size 2^( 2) =       0.000491243027
  error estimate for blocks of size 2^( 3) =       0.000515622041
  error estimate for blocks of size 2^( 4) =       0.000534864389
  error estimate for blocks of size 2^( 5) =       0.000546517085
  error estimate for blocks of size 2^( 6) =       0.000554059100
  error estimate for blocks of size 2^( 7) =       0.000557165338

      target function =      -0.749094817706
              le_mean =     -22.814759545800
             les_mean =     520.958758557526
             stat err =       0.000548151478
             autocorr =       1.385697004289
   target nu stat err =       0.000548151478
   target dn stat err =       0.002515566477
      target stat err =       0.002193646133
              std dev =       0.658538921757
             le_variance =       0.433673511469

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433668164546
                                         uncertainty =       0.001966330517

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433668164546
                                         uncertainty =       0.001966330517

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465657327
  error estimate for blocks of size 2^( 2) =       0.000491243010
  error estimate for blocks of size 2^( 3) =       0.000515622016
  error estimate for blocks of size 2^( 4) =       0.000534864358
  error estimate for blocks of size 2^( 5) =       0.000546517049
  error estimate for blocks of size 2^( 6) =       0.000554059062
  error estimate for blocks of size 2^( 7) =       0.000557165295

      target function =      -0.749094913823
              le_mean =     -22.814759545903
             les_mean =     520.958758447487
             stat err =       0.000548151441
             autocorr =       1.385696878284
   target nu stat err =       0.000548151441
   target dn stat err =       0.002515550123
      target stat err =       0.002193633514
              std dev =       0.658538907459
             le_variance =       0.433673492638

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433668173899
                                         uncertainty =       0.001966330596

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433668173899
                                         uncertainty =       0.001966330596

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465657332
  error estimate for blocks of size 2^( 2) =       0.000491243018
  error estimate for blocks of size 2^( 3) =       0.000515622028
  error estimate for blocks of size 2^( 4) =       0.000534864374
  error estimate for blocks of size 2^( 5) =       0.000546517067
  error estimate for blocks of size 2^( 6) =       0.000554059081
  error estimate for blocks of size 2^( 7) =       0.000557165316

      target function =      -0.749094865788
              le_mean =     -22.814759545851
             les_mean =     520.958758502476
             stat err =       0.000548151460
             autocorr =       1.385696941280
   target nu stat err =       0.000548151460
   target dn stat err =       0.002515558299
      target stat err =       0.002193639823
              std dev =       0.658538914608
             le_variance =       0.433673502053

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433668182084
                                         uncertainty =       0.001966330665

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433668182084
                                         uncertainty =       0.001966330665

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465657337
  error estimate for blocks of size 2^( 2) =       0.000491243026
  error estimate for blocks of size 2^( 3) =       0.000515622039
  error estimate for blocks of size 2^( 4) =       0.000534864387
  error estimate for blocks of size 2^( 5) =       0.000546517083
  error estimate for blocks of size 2^( 6) =       0.000554059098
  error estimate for blocks of size 2^( 7) =       0.000557165335

      target function =      -0.749094823719
              le_mean =     -22.814759545807
             les_mean =     520.958758550642
             stat err =       0.000548151476
             autocorr =       1.385696996412
   target nu stat err =       0.000548151476
   target dn stat err =       0.002515565455
      target stat err =       0.002193645344
              std dev =       0.658538920864
             le_variance =       0.433673510292


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.749094817706        initial
     1.5259e+03     1.5259e+04             1.2016e-07        -0.749094913823  <--
     6.1035e+03     6.1035e+04             3.0039e-08        -0.749094865788
     2.4414e+04     2.4414e+05             7.5098e-09        -0.749094823719

*****************************************************************************
Applying the update for shift_i =   1.5259e+03     and shift_s =   1.5259e+04
*****************************************************************************

  Execution time = 4.2106e+01
  </log>
  <optVariables href="FORM2.s020.opt.xml">
ci_01                 1.086422e-01 3 1  ON 0
ci_02                -2.429929e-02 3 1  ON 1
ci_03                -2.454049e-02 3 1  ON 2
ci_04                 2.241641e-02 3 1  ON 3
ci_05                -1.919447e-02 3 1  ON 4
ci_06                -1.972795e-02 3 1  ON 5
ci_07                 2.582834e-02 3 1  ON 6
ci_08                -4.237394e-03 3 1  ON 7
ci_09                -7.570795e-03 3 1  ON 8
ci_10                -7.621325e-03 3 1  ON 9
ci_11                 1.374035e-02 3 1  ON 10
ci_12                 6.969028e-03 3 1  ON 11
ci_13                 1.379061e-02 3 1  ON 12
ci_14                 1.283318e-02 3 1  ON 13
ci_15                 5.312931e-03 3 1  ON 14
ci_16                 5.754102e-03 3 1  ON 15
ci_17                -5.096454e-03 3 1  ON 16
ci_18                -5.604856e-03 3 1  ON 17
ci_19                 1.024812e-02 3 1  ON 18
ci_20                 6.250636e-03 3 1  ON 19
ci_21                 8.485445e-03 3 1  ON 20
ci_22                 8.839796e-03 3 1  ON 21
ci_23                 4.201958e-03 3 1  ON 22
ci_24                 5.084799e-03 3 1  ON 23
ci_25                 2.980050e-03 3 1  ON 24
ci_26                 3.786801e-03 3 1  ON 25
ci_27                 3.331611e-03 3 1  ON 26
ci_28                 7.866573e-04 3 1  ON 27
ci_29                 1.174412e-03 3 1  ON 28
ci_30                -7.245884e-04 3 1  ON 29
ci_31                 1.001813e-03 3 1  ON 30
ci_32                -6.570444e-04 3 1  ON 31
ci_33                -1.040554e-03 3 1  ON 32
ci_34                 1.203628e-03 3 1  ON 33
ci_35                 1.322159e-03 3 1  ON 34
ci_36                -6.182836e-04 3 1  ON 35
ci_37                -5.411895e-04 3 1  ON 36
ci_38                -2.597216e-04 3 1  ON 37
ci_39                -1.576258e-04 3 1  ON 38
ci_40                -1.841767e-03 3 1  ON 39
ci_41                -5.604256e-04 3 1  ON 40
ci_42                -1.608473e-03 3 1  ON 41
ci_43                -1.376153e-03 3 1  ON 42
ci_44                -2.230280e-03 3 1  ON 43
ci_45                -2.699403e-04 3 1  ON 44
ci_46                -1.594062e-03 3 1  ON 45
ci_47                 1.399028e-03 3 1  ON 46
ci_48                 2.889906e-03 3 1  ON 47
ci_49                -8.679865e-04 3 1  ON 48
ci_50                -7.823181e-04 3 1  ON 49
ci_51                -4.944285e-04 3 1  ON 50
ci_52                -5.955652e-04 3 1  ON 51
ci_53                -7.837461e-04 3 1  ON 52
ci_54                -1.101440e-03 3 1  ON 53
ci_55                -1.211008e-03 3 1  ON 54
ci_56                 1.132648e-03 3 1  ON 55
ci_57                 2.080320e-03 3 1  ON 56
ci_58                -2.644771e-04 3 1  ON 57
ci_59                -5.635610e-04 3 1  ON 58
ci_60                 7.425798e-05 3 1  ON 59
ci_61                -1.004502e-03 3 1  ON 60
ci_62                -3.909487e-04 3 1  ON 61
ci_63                -2.761548e-04 3 1  ON 62
ci_64                -5.998631e-04 3 1  ON 63
ci_65                -4.196433e-05 3 1  ON 64
ci_66                -1.519355e-04 3 1  ON 65
ci_67                -2.332797e-04 3 1  ON 66
ci_68                -1.705592e-03 3 1  ON 67
ci_69                -1.774784e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.1922e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2809e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -22.8065
    reference variance = 0.362369
====================================================
  Execution time = 2.7338e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5341e+04
  VMC Eavg = -2.2816e+01
  VMC Evar = 4.4978e-01
  Total weights = 1.964403115e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5045e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436408266178
                                         uncertainty =       0.002238834450

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436408266178
                                         uncertainty =       0.002238834450

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467186949
  error estimate for blocks of size 2^( 2) =       0.000492782921
  error estimate for blocks of size 2^( 3) =       0.000516914996
  error estimate for blocks of size 2^( 4) =       0.000534433342
  error estimate for blocks of size 2^( 5) =       0.000545542644
  error estimate for blocks of size 2^( 6) =       0.000554291781
  error estimate for blocks of size 2^( 7) =       0.000556715965

      target function =      -0.745525654259
              le_mean =     -22.815943605003
             les_mean =     521.017061376206
             stat err =       0.000547745933
             autocorr =       1.374601834708
   target nu stat err =       0.000547745933
   target dn stat err =       0.003558315328
      target stat err =       0.003018740293
              std dev =       0.660702119307
             le_variance =       0.436527290456


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281594360500e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745536932253       residual = 1.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745536980111       residual = 2.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745536985957       residual = 4.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745536987264       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745536987439       residual = 6.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745536987578       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745536987675       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745536987710       residual = 2.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745536987701       residual = 8.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+02 is 6.512532e-07

solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745536932253       residual = 1.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745536944219       residual = 2.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745536945680       residual = 4.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745536946007       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745536946052       residual = 6.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745536946085       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745536946110       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745536946119       residual = 2.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745536946118       residual = 8.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+03 is 1.628223e-07

solving harmonic davidson linear method for identity shift 6.1035e+03, overlap shift 6.1035e+04 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745536932253       residual = 1.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745536935245       residual = 2.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745536935610       residual = 4.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745536935692       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745536935699       residual = 6.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745536935730       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745536935716       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745536935720       residual = 2.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745536935719       residual = 8.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+03 is 4.070613e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.079990 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1851e+01
  </log>
  <optVariables href="FORM2.s021.opt.xml">
ci_01                 1.086424e-01 3 1  ON 0
ci_02                -2.429941e-02 3 1  ON 1
ci_03                -2.454053e-02 3 1  ON 2
ci_04                 2.241645e-02 3 1  ON 3
ci_05                -1.919453e-02 3 1  ON 4
ci_06                -1.972806e-02 3 1  ON 5
ci_07                 2.582834e-02 3 1  ON 6
ci_08                -4.237378e-03 3 1  ON 7
ci_09                -7.570803e-03 3 1  ON 8
ci_10                -7.621292e-03 3 1  ON 9
ci_11                 1.374039e-02 3 1  ON 10
ci_12                 6.969043e-03 3 1  ON 11
ci_13                 1.379057e-02 3 1  ON 12
ci_14                 1.283314e-02 3 1  ON 13
ci_15                 5.312936e-03 3 1  ON 14
ci_16                 5.754086e-03 3 1  ON 15
ci_17                -5.096486e-03 3 1  ON 16
ci_18                -5.604883e-03 3 1  ON 17
ci_19                 1.024811e-02 3 1  ON 18
ci_20                 6.250630e-03 3 1  ON 19
ci_21                 8.485485e-03 3 1  ON 20
ci_22                 8.839794e-03 3 1  ON 21
ci_23                 4.201999e-03 3 1  ON 22
ci_24                 5.084813e-03 3 1  ON 23
ci_25                 2.980053e-03 3 1  ON 24
ci_26                 3.786713e-03 3 1  ON 25
ci_27                 3.331581e-03 3 1  ON 26
ci_28                 7.866750e-04 3 1  ON 27
ci_29                 1.174408e-03 3 1  ON 28
ci_30                -7.246042e-04 3 1  ON 29
ci_31                 1.001816e-03 3 1  ON 30
ci_32                -6.570650e-04 3 1  ON 31
ci_33                -1.040553e-03 3 1  ON 32
ci_34                 1.203642e-03 3 1  ON 33
ci_35                 1.322190e-03 3 1  ON 34
ci_36                -6.182935e-04 3 1  ON 35
ci_37                -5.411931e-04 3 1  ON 36
ci_38                -2.597193e-04 3 1  ON 37
ci_39                -1.576357e-04 3 1  ON 38
ci_40                -1.841765e-03 3 1  ON 39
ci_41                -5.604764e-04 3 1  ON 40
ci_42                -1.608481e-03 3 1  ON 41
ci_43                -1.376160e-03 3 1  ON 42
ci_44                -2.230315e-03 3 1  ON 43
ci_45                -2.699649e-04 3 1  ON 44
ci_46                -1.594061e-03 3 1  ON 45
ci_47                 1.399113e-03 3 1  ON 46
ci_48                 2.889883e-03 3 1  ON 47
ci_49                -8.679774e-04 3 1  ON 48
ci_50                -7.823117e-04 3 1  ON 49
ci_51                -4.943924e-04 3 1  ON 50
ci_52                -5.955471e-04 3 1  ON 51
ci_53                -7.837592e-04 3 1  ON 52
ci_54                -1.101444e-03 3 1  ON 53
ci_55                -1.211006e-03 3 1  ON 54
ci_56                 1.132638e-03 3 1  ON 55
ci_57                 2.080333e-03 3 1  ON 56
ci_58                -2.644722e-04 3 1  ON 57
ci_59                -5.635820e-04 3 1  ON 58
ci_60                 7.426790e-05 3 1  ON 59
ci_61                -1.004498e-03 3 1  ON 60
ci_62                -3.909422e-04 3 1  ON 61
ci_63                -2.761558e-04 3 1  ON 62
ci_64                -5.998362e-04 3 1  ON 63
ci_65                -4.198249e-05 3 1  ON 64
ci_66                -1.519282e-04 3 1  ON 65
ci_67                -2.333120e-04 3 1  ON 66
ci_68                -1.705545e-03 3 1  ON 67
ci_69                -1.774744e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -22.9462
    reference variance = 0.397375
====================================================
  Execution time = 2.4601e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4559e-01
  Total weights = 1.9649e+06
  Execution time = 3.4990e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432785744536
                                         uncertainty =       0.001987009360

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432785744536
                                         uncertainty =       0.001987009360

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465225152
  error estimate for blocks of size 2^( 2) =       0.000491332215
  error estimate for blocks of size 2^( 3) =       0.000515944923
  error estimate for blocks of size 2^( 4) =       0.000534487295
  error estimate for blocks of size 2^( 5) =       0.000545322252
  error estimate for blocks of size 2^( 6) =       0.000552469540
  error estimate for blocks of size 2^( 7) =       0.000556351611

      target function =      -0.749027053881
              le_mean =     -22.814955661159
             les_mean =     520.967788988726
             stat err =       0.000547157674
             autocorr =       1.383243433741
   target nu stat err =       0.000547157674
   target dn stat err =       0.002552123975
      target stat err =       0.002223012889
              std dev =       0.657927719381
             le_variance =       0.432868883930

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432785729195
                                         uncertainty =       0.001987014274

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432785729195
                                         uncertainty =       0.001987014274

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465225144
  error estimate for blocks of size 2^( 2) =       0.000491332173
  error estimate for blocks of size 2^( 3) =       0.000515944847
  error estimate for blocks of size 2^( 4) =       0.000534487190
  error estimate for blocks of size 2^( 5) =       0.000545322132
  error estimate for blocks of size 2^( 6) =       0.000552469419
  error estimate for blocks of size 2^( 7) =       0.000556351492

      target function =      -0.749027100080
              le_mean =     -22.814955662896
             les_mean =     520.967789012748
             stat err =       0.000547157558
             autocorr =       1.383242895398
   target nu stat err =       0.000547157558
   target dn stat err =       0.002552130512
      target stat err =       0.002223018385
              std dev =       0.657927707852
             le_variance =       0.432868868760

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432785736861
                                         uncertainty =       0.001987011818

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432785736861
                                         uncertainty =       0.001987011818

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465225148
  error estimate for blocks of size 2^( 2) =       0.000491332194
  error estimate for blocks of size 2^( 3) =       0.000515944885
  error estimate for blocks of size 2^( 4) =       0.000534487243
  error estimate for blocks of size 2^( 5) =       0.000545322192
  error estimate for blocks of size 2^( 6) =       0.000552469480
  error estimate for blocks of size 2^( 7) =       0.000556351551

      target function =      -0.749027080795
              le_mean =     -22.814955662027
             les_mean =     520.967788996147
             stat err =       0.000547157616
             autocorr =       1.383243164541
   target nu stat err =       0.000547157616
   target dn stat err =       0.002552127240
      target stat err =       0.002223015656
              std dev =       0.657927713613
             le_variance =       0.432868876340

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432785743576
                                         uncertainty =       0.001987009667

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432785743576
                                         uncertainty =       0.001987009667

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465225151
  error estimate for blocks of size 2^( 2) =       0.000491332213
  error estimate for blocks of size 2^( 3) =       0.000515944918
  error estimate for blocks of size 2^( 4) =       0.000534487289
  error estimate for blocks of size 2^( 5) =       0.000545322244
  error estimate for blocks of size 2^( 6) =       0.000552469532
  error estimate for blocks of size 2^( 7) =       0.000556351604

      target function =      -0.749027057708
              le_mean =     -22.814955661268
             les_mean =     520.967788989098
             stat err =       0.000547157667
             autocorr =       1.383243400087
   target nu stat err =       0.000547157667
   target dn stat err =       0.002552124383
      target stat err =       0.002223013237
              std dev =       0.657927718660
             le_variance =       0.432868882981


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.749027053881        initial
     3.8147e+02     3.8147e+03             6.5125e-07        -0.749027100080  <--
     1.5259e+03     1.5259e+04             1.6282e-07        -0.749027080795
     6.1035e+03     6.1035e+04             4.0706e-08        -0.749027057708

*****************************************************************************
Applying the update for shift_i =   3.8147e+02     and shift_s =   3.8147e+03
*****************************************************************************

  Execution time = 4.2096e+01
  </log>
  <optVariables href="FORM2.s021.opt.xml">
ci_01                 1.086429e-01 3 1  ON 0
ci_02                -2.429978e-02 3 1  ON 1
ci_03                -2.454066e-02 3 1  ON 2
ci_04                 2.241657e-02 3 1  ON 3
ci_05                -1.919469e-02 3 1  ON 4
ci_06                -1.972839e-02 3 1  ON 5
ci_07                 2.582834e-02 3 1  ON 6
ci_08                -4.237331e-03 3 1  ON 7
ci_09                -7.570829e-03 3 1  ON 8
ci_10                -7.621192e-03 3 1  ON 9
ci_11                 1.374051e-02 3 1  ON 10
ci_12                 6.969088e-03 3 1  ON 11
ci_13                 1.379045e-02 3 1  ON 12
ci_14                 1.283302e-02 3 1  ON 13
ci_15                 5.312949e-03 3 1  ON 14
ci_16                 5.754038e-03 3 1  ON 15
ci_17                -5.096581e-03 3 1  ON 16
ci_18                -5.604965e-03 3 1  ON 17
ci_19                 1.024808e-02 3 1  ON 18
ci_20                 6.250615e-03 3 1  ON 19
ci_21                 8.485606e-03 3 1  ON 20
ci_22                 8.839789e-03 3 1  ON 21
ci_23                 4.202121e-03 3 1  ON 22
ci_24                 5.084856e-03 3 1  ON 23
ci_25                 2.980063e-03 3 1  ON 24
ci_26                 3.786449e-03 3 1  ON 25
ci_27                 3.331488e-03 3 1  ON 26
ci_28                 7.867282e-04 3 1  ON 27
ci_29                 1.174394e-03 3 1  ON 28
ci_30                -7.246518e-04 3 1  ON 29
ci_31                 1.001826e-03 3 1  ON 30
ci_32                -6.571268e-04 3 1  ON 31
ci_33                -1.040551e-03 3 1  ON 32
ci_34                 1.203684e-03 3 1  ON 33
ci_35                 1.322284e-03 3 1  ON 34
ci_36                -6.183230e-04 3 1  ON 35
ci_37                -5.412041e-04 3 1  ON 36
ci_38                -2.597125e-04 3 1  ON 37
ci_39                -1.576655e-04 3 1  ON 38
ci_40                -1.841756e-03 3 1  ON 39
ci_41                -5.606288e-04 3 1  ON 40
ci_42                -1.608505e-03 3 1  ON 41
ci_43                -1.376182e-03 3 1  ON 42
ci_44                -2.230423e-03 3 1  ON 43
ci_45                -2.700387e-04 3 1  ON 44
ci_46                -1.594059e-03 3 1  ON 45
ci_47                 1.399366e-03 3 1  ON 46
ci_48                 2.889813e-03 3 1  ON 47
ci_49                -8.679501e-04 3 1  ON 48
ci_50                -7.822925e-04 3 1  ON 49
ci_51                -4.942844e-04 3 1  ON 50
ci_52                -5.954925e-04 3 1  ON 51
ci_53                -7.837984e-04 3 1  ON 52
ci_54                -1.101455e-03 3 1  ON 53
ci_55                -1.210997e-03 3 1  ON 54
ci_56                 1.132609e-03 3 1  ON 55
ci_57                 2.080371e-03 3 1  ON 56
ci_58                -2.644574e-04 3 1  ON 57
ci_59                -5.636451e-04 3 1  ON 58
ci_60                 7.429767e-05 3 1  ON 59
ci_61                -1.004487e-03 3 1  ON 60
ci_62                -3.909229e-04 3 1  ON 61
ci_63                -2.761586e-04 3 1  ON 62
ci_64                -5.997556e-04 3 1  ON 63
ci_65                -4.203697e-05 3 1  ON 64
ci_66                -1.519061e-04 3 1  ON 65
ci_67                -2.334089e-04 3 1  ON 66
ci_68                -1.705405e-03 3 1  ON 67
ci_69                -1.774623e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3954e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2812e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -22.7384
    reference variance = 0.350179
====================================================
  Execution time = 2.5076e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5375e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4316e-01
  Total weights = 1.964781214e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5384e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431334665261
                                         uncertainty =       0.001941219831

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431334665261
                                         uncertainty =       0.001941219831

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464365570
  error estimate for blocks of size 2^( 2) =       0.000490375887
  error estimate for blocks of size 2^( 3) =       0.000513843131
  error estimate for blocks of size 2^( 4) =       0.000531429678
  error estimate for blocks of size 2^( 5) =       0.000542498382
  error estimate for blocks of size 2^( 6) =       0.000549368045
  error estimate for blocks of size 2^( 7) =       0.000554764637

      target function =      -0.751060444534
              le_mean =     -22.814694538939
             les_mean =     520.953450576892
             stat err =       0.000544515186
             autocorr =       1.374991359647
   target nu stat err =       0.000544515186
   target dn stat err =       0.002475992010
      target stat err =       0.002171392351
              std dev =       0.656712086487
             le_variance =       0.431270764538


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281469453894e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.751065730350       residual = 2.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.751065950509       residual = 3.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.751065983491       residual = 6.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.751065987847       residual = 2.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.751065989122       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.751065990718       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.751065991411       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.751065991650       residual = 2.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.751065991654       residual = 5.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+01 is 3.123440e-06

solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.751065730350       residual = 2.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.751065785411       residual = 3.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.751065793659       residual = 6.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.751065794748       residual = 2.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.751065795066       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.751065795465       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.751065795638       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.751065795698       residual = 2.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.751065795699       residual = 5.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+02 is 7.810279e-07

solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.751065730350       residual = 2.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.751065744116       residual = 3.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.751065746178       residual = 6.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.751065746450       residual = 2.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.751065746532       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.751065746631       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.751065746672       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.751065746690       residual = 2.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.751065746690       residual = 5.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+03 is 1.952675e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.083122 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9623e+01
  </log>
  <optVariables href="FORM2.s022.opt.xml">
ci_01                 1.086436e-01 3 1  ON 0
ci_02                -2.430030e-02 3 1  ON 1
ci_03                -2.454116e-02 3 1  ON 2
ci_04                 2.241689e-02 3 1  ON 3
ci_05                -1.919509e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582842e-02 3 1  ON 6
ci_08                -4.237296e-03 3 1  ON 7
ci_09                -7.570942e-03 3 1  ON 8
ci_10                -7.621149e-03 3 1  ON 9
ci_11                 1.374045e-02 3 1  ON 10
ci_12                 6.969176e-03 3 1  ON 11
ci_13                 1.379041e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.312989e-03 3 1  ON 14
ci_16                 5.754135e-03 3 1  ON 15
ci_17                -5.096818e-03 3 1  ON 16
ci_18                -5.604945e-03 3 1  ON 17
ci_19                 1.024792e-02 3 1  ON 18
ci_20                 6.250662e-03 3 1  ON 19
ci_21                 8.485617e-03 3 1  ON 20
ci_22                 8.839803e-03 3 1  ON 21
ci_23                 4.202205e-03 3 1  ON 22
ci_24                 5.084814e-03 3 1  ON 23
ci_25                 2.980081e-03 3 1  ON 24
ci_26                 3.786612e-03 3 1  ON 25
ci_27                 3.331532e-03 3 1  ON 26
ci_28                 7.868399e-04 3 1  ON 27
ci_29                 1.174405e-03 3 1  ON 28
ci_30                -7.246372e-04 3 1  ON 29
ci_31                 1.001685e-03 3 1  ON 30
ci_32                -6.572532e-04 3 1  ON 31
ci_33                -1.040542e-03 3 1  ON 32
ci_34                 1.203686e-03 3 1  ON 33
ci_35                 1.322317e-03 3 1  ON 34
ci_36                -6.184128e-04 3 1  ON 35
ci_37                -5.411797e-04 3 1  ON 36
ci_38                -2.598007e-04 3 1  ON 37
ci_39                -1.577149e-04 3 1  ON 38
ci_40                -1.841773e-03 3 1  ON 39
ci_41                -5.606607e-04 3 1  ON 40
ci_42                -1.608664e-03 3 1  ON 41
ci_43                -1.376392e-03 3 1  ON 42
ci_44                -2.230503e-03 3 1  ON 43
ci_45                -2.700765e-04 3 1  ON 44
ci_46                -1.593740e-03 3 1  ON 45
ci_47                 1.399401e-03 3 1  ON 46
ci_48                 2.889867e-03 3 1  ON 47
ci_49                -8.680473e-04 3 1  ON 48
ci_50                -7.822890e-04 3 1  ON 49
ci_51                -4.940628e-04 3 1  ON 50
ci_52                -5.953969e-04 3 1  ON 51
ci_53                -7.837649e-04 3 1  ON 52
ci_54                -1.101405e-03 3 1  ON 53
ci_55                -1.210900e-03 3 1  ON 54
ci_56                 1.132766e-03 3 1  ON 55
ci_57                 2.080375e-03 3 1  ON 56
ci_58                -2.643351e-04 3 1  ON 57
ci_59                -5.636244e-04 3 1  ON 58
ci_60                 7.402007e-05 3 1  ON 59
ci_61                -1.004341e-03 3 1  ON 60
ci_62                -3.910351e-04 3 1  ON 61
ci_63                -2.761665e-04 3 1  ON 62
ci_64                -5.996044e-04 3 1  ON 63
ci_65                -4.196237e-05 3 1  ON 64
ci_66                -1.519416e-04 3 1  ON 65
ci_67                -2.334353e-04 3 1  ON 66
ci_68                -1.705283e-03 3 1  ON 67
ci_69                -1.774492e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -22.8437
    reference variance = 0.407745
====================================================
  Execution time = 2.4643e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5150e-01
  Total weights = 1.9649e+06
  Execution time = 3.4945e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437261935221
                                         uncertainty =       0.002518958642

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437261935221
                                         uncertainty =       0.002518958642

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467537488
  error estimate for blocks of size 2^( 2) =       0.000493504504
  error estimate for blocks of size 2^( 3) =       0.000518050528
  error estimate for blocks of size 2^( 4) =       0.000537083072
  error estimate for blocks of size 2^( 5) =       0.000549461055
  error estimate for blocks of size 2^( 6) =       0.000557193946
  error estimate for blocks of size 2^( 7) =       0.000561177571

      target function =      -0.744105557164
              le_mean =     -22.814348777663
             les_mean =     520.946007082404
             stat err =       0.000551228911
             autocorr =       1.390052158715
   target nu stat err =       0.000551228911
   target dn stat err =       0.003733289297
      target stat err =       0.003142705055
              std dev =       0.661197856777
             le_variance =       0.437182605807

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437261926157
                                         uncertainty =       0.002519179497

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437261926157
                                         uncertainty =       0.002519179497

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467537483
  error estimate for blocks of size 2^( 2) =       0.000493504312
  error estimate for blocks of size 2^( 3) =       0.000518050172
  error estimate for blocks of size 2^( 4) =       0.000537082574
  error estimate for blocks of size 2^( 5) =       0.000549460525
  error estimate for blocks of size 2^( 6) =       0.000557193342
  error estimate for blocks of size 2^( 7) =       0.000561176907

      target function =      -0.744083683081
              le_mean =     -22.814348795671
             les_mean =     520.946034394942
             stat err =       0.000551228337
             autocorr =       1.390049294012
   target nu stat err =       0.000551228337
   target dn stat err =       0.003733539863
      target stat err =       0.003142726679
              std dev =       0.661197849211
             le_variance =       0.437182595802

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437261930574
                                         uncertainty =       0.002519069092

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437261930574
                                         uncertainty =       0.002519069092

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467537485
  error estimate for blocks of size 2^( 2) =       0.000493504408
  error estimate for blocks of size 2^( 3) =       0.000518050350
  error estimate for blocks of size 2^( 4) =       0.000537082823
  error estimate for blocks of size 2^( 5) =       0.000549460790
  error estimate for blocks of size 2^( 6) =       0.000557193643
  error estimate for blocks of size 2^( 7) =       0.000561177239

      target function =      -0.744101726773
              le_mean =     -22.814348786734
             les_mean =     520.946012134831
             stat err =       0.000551228624
             autocorr =       1.390050725736
   target nu stat err =       0.000551228624
   target dn stat err =       0.003733351958
      target stat err =       0.003142724044
              std dev =       0.661197852907
             le_variance =       0.437182600689

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437261934628
                                         uncertainty =       0.002518972448

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437261934628
                                         uncertainty =       0.002518972448

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467537488
  error estimate for blocks of size 2^( 2) =       0.000493504492
  error estimate for blocks of size 2^( 3) =       0.000518050506
  error estimate for blocks of size 2^( 4) =       0.000537083041
  error estimate for blocks of size 2^( 5) =       0.000549461022
  error estimate for blocks of size 2^( 6) =       0.000557193908
  error estimate for blocks of size 2^( 7) =       0.000561177530

      target function =      -0.744105292270
              le_mean =     -22.814348778799
             les_mean =     520.946007454993
             stat err =       0.000551228875
             autocorr =       1.390051979573
   target nu stat err =       0.000551228875
   target dn stat err =       0.003733296219
      target stat err =       0.003142708464
              std dev =       0.661197856284
             le_variance =       0.437182605155


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744105557164        initial  <--
     9.5367e+01     9.5367e+02             3.1234e-06        -0.744083683081
     3.8147e+02     3.8147e+03             7.8103e-07        -0.744101726773
     1.5259e+03     1.5259e+04             1.9527e-07        -0.744105292270

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.1201
  </log>
  <optVariables href="FORM2.s022.opt.xml">
ci_01                 1.086429e-01 3 1  ON 0
ci_02                -2.429978e-02 3 1  ON 1
ci_03                -2.454066e-02 3 1  ON 2
ci_04                 2.241657e-02 3 1  ON 3
ci_05                -1.919469e-02 3 1  ON 4
ci_06                -1.972839e-02 3 1  ON 5
ci_07                 2.582834e-02 3 1  ON 6
ci_08                -4.237331e-03 3 1  ON 7
ci_09                -7.570829e-03 3 1  ON 8
ci_10                -7.621192e-03 3 1  ON 9
ci_11                 1.374051e-02 3 1  ON 10
ci_12                 6.969088e-03 3 1  ON 11
ci_13                 1.379045e-02 3 1  ON 12
ci_14                 1.283302e-02 3 1  ON 13
ci_15                 5.312949e-03 3 1  ON 14
ci_16                 5.754038e-03 3 1  ON 15
ci_17                -5.096581e-03 3 1  ON 16
ci_18                -5.604965e-03 3 1  ON 17
ci_19                 1.024808e-02 3 1  ON 18
ci_20                 6.250615e-03 3 1  ON 19
ci_21                 8.485606e-03 3 1  ON 20
ci_22                 8.839789e-03 3 1  ON 21
ci_23                 4.202121e-03 3 1  ON 22
ci_24                 5.084856e-03 3 1  ON 23
ci_25                 2.980063e-03 3 1  ON 24
ci_26                 3.786449e-03 3 1  ON 25
ci_27                 3.331488e-03 3 1  ON 26
ci_28                 7.867282e-04 3 1  ON 27
ci_29                 1.174394e-03 3 1  ON 28
ci_30                -7.246518e-04 3 1  ON 29
ci_31                 1.001826e-03 3 1  ON 30
ci_32                -6.571268e-04 3 1  ON 31
ci_33                -1.040551e-03 3 1  ON 32
ci_34                 1.203684e-03 3 1  ON 33
ci_35                 1.322284e-03 3 1  ON 34
ci_36                -6.183230e-04 3 1  ON 35
ci_37                -5.412041e-04 3 1  ON 36
ci_38                -2.597125e-04 3 1  ON 37
ci_39                -1.576655e-04 3 1  ON 38
ci_40                -1.841756e-03 3 1  ON 39
ci_41                -5.606288e-04 3 1  ON 40
ci_42                -1.608505e-03 3 1  ON 41
ci_43                -1.376182e-03 3 1  ON 42
ci_44                -2.230423e-03 3 1  ON 43
ci_45                -2.700387e-04 3 1  ON 44
ci_46                -1.594059e-03 3 1  ON 45
ci_47                 1.399366e-03 3 1  ON 46
ci_48                 2.889813e-03 3 1  ON 47
ci_49                -8.679501e-04 3 1  ON 48
ci_50                -7.822925e-04 3 1  ON 49
ci_51                -4.942844e-04 3 1  ON 50
ci_52                -5.954925e-04 3 1  ON 51
ci_53                -7.837984e-04 3 1  ON 52
ci_54                -1.101455e-03 3 1  ON 53
ci_55                -1.210997e-03 3 1  ON 54
ci_56                 1.132609e-03 3 1  ON 55
ci_57                 2.080371e-03 3 1  ON 56
ci_58                -2.644574e-04 3 1  ON 57
ci_59                -5.636451e-04 3 1  ON 58
ci_60                 7.429767e-05 3 1  ON 59
ci_61                -1.004487e-03 3 1  ON 60
ci_62                -3.909229e-04 3 1  ON 61
ci_63                -2.761586e-04 3 1  ON 62
ci_64                -5.997556e-04 3 1  ON 63
ci_65                -4.203697e-05 3 1  ON 64
ci_66                -1.519061e-04 3 1  ON 65
ci_67                -2.334089e-04 3 1  ON 66
ci_68                -1.705405e-03 3 1  ON 67
ci_69                -1.774623e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.1750e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2811e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -22.7934
    reference variance = 0.453783
====================================================
  Execution time = 2.7526e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5313e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5031e-01
  Total weights = 1.964764898e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5082e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438103207112
                                         uncertainty =       0.002998821834

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438103207112
                                         uncertainty =       0.002998821834

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468024336
  error estimate for blocks of size 2^( 2) =       0.000493462509
  error estimate for blocks of size 2^( 3) =       0.000517474647
  error estimate for blocks of size 2^( 4) =       0.000534888553
  error estimate for blocks of size 2^( 5) =       0.000545639869
  error estimate for blocks of size 2^( 6) =       0.000550893738
  error estimate for blocks of size 2^( 7) =       0.000554683022

      target function =      -0.745085374378
              le_mean =     -22.815204045588
             les_mean =     520.983847486028
             stat err =       0.000546526296
             autocorr =       1.363594540893
   target nu stat err =       0.000546526296
   target dn stat err =       0.003551207200
      target stat err =       0.003005873189
              std dev =       0.661886362982
             le_variance =       0.438093557501


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281520404559e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745096394180       residual = 2.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745096412717       residual = 3.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745096415728       residual = 7.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745096416403       residual = 2.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745096416750       residual = 8.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745096416684       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745096416696       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745096416700       residual = 2.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745096416700       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745096416700       residual = 2.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+02 is 2.527771e-07

solving harmonic davidson linear method for identity shift 3.8147e+03, overlap shift 3.8147e+04 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745096394180       residual = 2.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745096398815       residual = 3.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745096399567       residual = 7.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745096399736       residual = 2.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745096399822       residual = 8.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745096399807       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745096399817       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745096399815       residual = 2.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745096399821       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745096399812       residual = 2.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+03 is 6.319552e-08

solving harmonic davidson linear method for identity shift 1.5259e+04, overlap shift 1.5259e+05 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745096394180       residual = 2.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745096395339       residual = 3.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745096395527       residual = 7.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745096395569       residual = 2.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745096395602       residual = 8.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745096395625       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745096395600       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745096395588       residual = 2.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745096395588       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745096395588       residual = 2.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+04 is 1.579896e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.086715 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2043e+01
  </log>
  <optVariables href="FORM2.s023.opt.xml">
ci_01                 1.086429e-01 3 1  ON 0
ci_02                -2.429983e-02 3 1  ON 1
ci_03                -2.454067e-02 3 1  ON 2
ci_04                 2.241658e-02 3 1  ON 3
ci_05                -1.919468e-02 3 1  ON 4
ci_06                -1.972841e-02 3 1  ON 5
ci_07                 2.582837e-02 3 1  ON 6
ci_08                -4.237349e-03 3 1  ON 7
ci_09                -7.570838e-03 3 1  ON 8
ci_10                -7.621200e-03 3 1  ON 9
ci_11                 1.374050e-02 3 1  ON 10
ci_12                 6.969109e-03 3 1  ON 11
ci_13                 1.379042e-02 3 1  ON 12
ci_14                 1.283302e-02 3 1  ON 13
ci_15                 5.312964e-03 3 1  ON 14
ci_16                 5.754045e-03 3 1  ON 15
ci_17                -5.096608e-03 3 1  ON 16
ci_18                -5.604949e-03 3 1  ON 17
ci_19                 1.024806e-02 3 1  ON 18
ci_20                 6.250619e-03 3 1  ON 19
ci_21                 8.485603e-03 3 1  ON 20
ci_22                 8.839781e-03 3 1  ON 21
ci_23                 4.202130e-03 3 1  ON 22
ci_24                 5.084848e-03 3 1  ON 23
ci_25                 2.980062e-03 3 1  ON 24
ci_26                 3.786417e-03 3 1  ON 25
ci_27                 3.331483e-03 3 1  ON 26
ci_28                 7.867364e-04 3 1  ON 27
ci_29                 1.174402e-03 3 1  ON 28
ci_30                -7.246443e-04 3 1  ON 29
ci_31                 1.001799e-03 3 1  ON 30
ci_32                -6.571187e-04 3 1  ON 31
ci_33                -1.040549e-03 3 1  ON 32
ci_34                 1.203690e-03 3 1  ON 33
ci_35                 1.322281e-03 3 1  ON 34
ci_36                -6.183203e-04 3 1  ON 35
ci_37                -5.412071e-04 3 1  ON 36
ci_38                -2.597192e-04 3 1  ON 37
ci_39                -1.576603e-04 3 1  ON 38
ci_40                -1.841753e-03 3 1  ON 39
ci_41                -5.606334e-04 3 1  ON 40
ci_42                -1.608498e-03 3 1  ON 41
ci_43                -1.376154e-03 3 1  ON 42
ci_44                -2.230421e-03 3 1  ON 43
ci_45                -2.700464e-04 3 1  ON 44
ci_46                -1.594034e-03 3 1  ON 45
ci_47                 1.399366e-03 3 1  ON 46
ci_48                 2.889797e-03 3 1  ON 47
ci_49                -8.679444e-04 3 1  ON 48
ci_50                -7.822838e-04 3 1  ON 49
ci_51                -4.942860e-04 3 1  ON 50
ci_52                -5.954825e-04 3 1  ON 51
ci_53                -7.837831e-04 3 1  ON 52
ci_54                -1.101453e-03 3 1  ON 53
ci_55                -1.210992e-03 3 1  ON 54
ci_56                 1.132605e-03 3 1  ON 55
ci_57                 2.080383e-03 3 1  ON 56
ci_58                -2.644560e-04 3 1  ON 57
ci_59                -5.636366e-04 3 1  ON 58
ci_60                 7.428960e-05 3 1  ON 59
ci_61                -1.004507e-03 3 1  ON 60
ci_62                -3.909257e-04 3 1  ON 61
ci_63                -2.761619e-04 3 1  ON 62
ci_64                -5.997523e-04 3 1  ON 63
ci_65                -4.206317e-05 3 1  ON 64
ci_66                -1.518842e-04 3 1  ON 65
ci_67                -2.334147e-04 3 1  ON 66
ci_68                -1.705398e-03 3 1  ON 67
ci_69                -1.774622e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -22.7601
    reference variance = 0.510992
====================================================
  Execution time = 2.4439e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4645e-01
  Total weights = 1.9648e+06
  Execution time = 3.4973e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433772743469
                                         uncertainty =       0.002073805904

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433772743469
                                         uncertainty =       0.002073805904

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465711255
  error estimate for blocks of size 2^( 2) =       0.000491620880
  error estimate for blocks of size 2^( 3) =       0.000515879344
  error estimate for blocks of size 2^( 4) =       0.000534327836
  error estimate for blocks of size 2^( 5) =       0.000546270452
  error estimate for blocks of size 2^( 6) =       0.000552308548
  error estimate for blocks of size 2^( 7) =       0.000558086756

      target function =      -0.748302112677
              le_mean =     -22.814650265311
             les_mean =     520.954717378532
             stat err =       0.000547748398
             autocorr =       1.383339454276
   target nu stat err =       0.000547748398
   target dn stat err =       0.002863760445
      target stat err =       0.002469349758
              std dev =       0.658615173548
             le_variance =       0.433773946828

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433772739379
                                         uncertainty =       0.002073807622

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433772739379
                                         uncertainty =       0.002073807622

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465711253
  error estimate for blocks of size 2^( 2) =       0.000491620868
  error estimate for blocks of size 2^( 3) =       0.000515879322
  error estimate for blocks of size 2^( 4) =       0.000534327807
  error estimate for blocks of size 2^( 5) =       0.000546270419
  error estimate for blocks of size 2^( 6) =       0.000552308513
  error estimate for blocks of size 2^( 7) =       0.000558086722

      target function =      -0.748302286948
              le_mean =     -22.814650265215
             les_mean =     520.954717165524
             stat err =       0.000547748365
             autocorr =       1.383339302818
   target nu stat err =       0.000547748365
   target dn stat err =       0.002863765323
      target stat err =       0.002469354812
              std dev =       0.658615170217
             le_variance =       0.433773942440

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433772741424
                                         uncertainty =       0.002073806763

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433772741424
                                         uncertainty =       0.002073806763

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465711254
  error estimate for blocks of size 2^( 2) =       0.000491620874
  error estimate for blocks of size 2^( 3) =       0.000515879333
  error estimate for blocks of size 2^( 4) =       0.000534327821
  error estimate for blocks of size 2^( 5) =       0.000546270436
  error estimate for blocks of size 2^( 6) =       0.000552308530
  error estimate for blocks of size 2^( 7) =       0.000558086739

      target function =      -0.748302200925
              le_mean =     -22.814650265263
             les_mean =     520.954717270690
             stat err =       0.000547748382
             autocorr =       1.383339378557
   target nu stat err =       0.000547748382
   target dn stat err =       0.002863762881
      target stat err =       0.002469352290
              std dev =       0.658615171882
             le_variance =       0.433773944633

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433772743214
                                         uncertainty =       0.002073806012

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433772743214
                                         uncertainty =       0.002073806012

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465711255
  error estimate for blocks of size 2^( 2) =       0.000491620880
  error estimate for blocks of size 2^( 3) =       0.000515879343
  error estimate for blocks of size 2^( 4) =       0.000534327834
  error estimate for blocks of size 2^( 5) =       0.000546270450
  error estimate for blocks of size 2^( 6) =       0.000552308546
  error estimate for blocks of size 2^( 7) =       0.000558086754

      target function =      -0.748302123834
              le_mean =     -22.814650265305
             les_mean =     520.954717364900
             stat err =       0.000547748396
             autocorr =       1.383339444804
   target nu stat err =       0.000547748396
   target dn stat err =       0.002863760749
      target stat err =       0.002469350075
              std dev =       0.658615173340
             le_variance =       0.433773946554


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748302112677        initial
     9.5367e+02     9.5367e+03             2.5278e-07        -0.748302286948  <--
     3.8147e+03     3.8147e+04             6.3196e-08        -0.748302200925
     1.5259e+04     1.5259e+05             1.5799e-08        -0.748302123834

*****************************************************************************
Applying the update for shift_i =   9.5367e+02     and shift_s =   9.5367e+03
*****************************************************************************

  Execution time = 4.1929e+01
  </log>
  <optVariables href="FORM2.s023.opt.xml">
ci_01                 1.086431e-01 3 1  ON 0
ci_02                -2.429996e-02 3 1  ON 1
ci_03                -2.454068e-02 3 1  ON 2
ci_04                 2.241661e-02 3 1  ON 3
ci_05                -1.919465e-02 3 1  ON 4
ci_06                -1.972850e-02 3 1  ON 5
ci_07                 2.582845e-02 3 1  ON 6
ci_08                -4.237402e-03 3 1  ON 7
ci_09                -7.570866e-03 3 1  ON 8
ci_10                -7.621223e-03 3 1  ON 9
ci_11                 1.374046e-02 3 1  ON 10
ci_12                 6.969173e-03 3 1  ON 11
ci_13                 1.379033e-02 3 1  ON 12
ci_14                 1.283303e-02 3 1  ON 13
ci_15                 5.313008e-03 3 1  ON 14
ci_16                 5.754066e-03 3 1  ON 15
ci_17                -5.096690e-03 3 1  ON 16
ci_18                -5.604903e-03 3 1  ON 17
ci_19                 1.024799e-02 3 1  ON 18
ci_20                 6.250633e-03 3 1  ON 19
ci_21                 8.485594e-03 3 1  ON 20
ci_22                 8.839758e-03 3 1  ON 21
ci_23                 4.202157e-03 3 1  ON 22
ci_24                 5.084827e-03 3 1  ON 23
ci_25                 2.980058e-03 3 1  ON 24
ci_26                 3.786323e-03 3 1  ON 25
ci_27                 3.331470e-03 3 1  ON 26
ci_28                 7.867610e-04 3 1  ON 27
ci_29                 1.174427e-03 3 1  ON 28
ci_30                -7.246219e-04 3 1  ON 29
ci_31                 1.001715e-03 3 1  ON 30
ci_32                -6.570945e-04 3 1  ON 31
ci_33                -1.040540e-03 3 1  ON 32
ci_34                 1.203709e-03 3 1  ON 33
ci_35                 1.322274e-03 3 1  ON 34
ci_36                -6.183123e-04 3 1  ON 35
ci_37                -5.412160e-04 3 1  ON 36
ci_38                -2.597392e-04 3 1  ON 37
ci_39                -1.576446e-04 3 1  ON 38
ci_40                -1.841743e-03 3 1  ON 39
ci_41                -5.606473e-04 3 1  ON 40
ci_42                -1.608478e-03 3 1  ON 41
ci_43                -1.376072e-03 3 1  ON 42
ci_44                -2.230416e-03 3 1  ON 43
ci_45                -2.700694e-04 3 1  ON 44
ci_46                -1.593961e-03 3 1  ON 45
ci_47                 1.399365e-03 3 1  ON 46
ci_48                 2.889749e-03 3 1  ON 47
ci_49                -8.679272e-04 3 1  ON 48
ci_50                -7.822577e-04 3 1  ON 49
ci_51                -4.942910e-04 3 1  ON 50
ci_52                -5.954525e-04 3 1  ON 51
ci_53                -7.837374e-04 3 1  ON 52
ci_54                -1.101449e-03 3 1  ON 53
ci_55                -1.210975e-03 3 1  ON 54
ci_56                 1.132591e-03 3 1  ON 55
ci_57                 2.080421e-03 3 1  ON 56
ci_58                -2.644520e-04 3 1  ON 57
ci_59                -5.636112e-04 3 1  ON 58
ci_60                 7.426538e-05 3 1  ON 59
ci_61                -1.004567e-03 3 1  ON 60
ci_62                -3.909342e-04 3 1  ON 61
ci_63                -2.761717e-04 3 1  ON 62
ci_64                -5.997425e-04 3 1  ON 63
ci_65                -4.214179e-05 3 1  ON 64
ci_66                -1.518186e-04 3 1  ON 65
ci_67                -2.334322e-04 3 1  ON 66
ci_68                -1.705377e-03 3 1  ON 67
ci_69                -1.774620e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3979e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2809e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -22.7692
    reference variance = 0.503189
====================================================
  Execution time = 2.5289e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5356e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5409e-01
  Total weights = 1.964774736e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5196e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440550103898
                                         uncertainty =       0.004385025403

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440550103898
                                         uncertainty =       0.004385025403

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469311990
  error estimate for blocks of size 2^( 2) =       0.000494795391
  error estimate for blocks of size 2^( 3) =       0.000518647039
  error estimate for blocks of size 2^( 4) =       0.000537138762
  error estimate for blocks of size 2^( 5) =       0.000548621018
  error estimate for blocks of size 2^( 6) =       0.000554635298
  error estimate for blocks of size 2^( 7) =       0.000558840452

      target function =      -0.741950478908
              le_mean =     -22.814375225856
             les_mean =     520.949808536362
             stat err =       0.000549808883
             autocorr =       1.372461604971
   target nu stat err =       0.000549808883
   target dn stat err =       0.005881764719
      target stat err =       0.004867009004
              std dev =       0.663707381719
             le_variance =       0.440507488549


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281437522586e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+02, overlap shift 2.3842e+03 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741981374251       residual = 5.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741981565281       residual = 7.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741981588461       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741981596791       residual = 7.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741981601954       residual = 2.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741981602944       residual = 3.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741981603146       residual = 2.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741981603184       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741981603163       residual = 3.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+02 is 2.115469e-06

solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741981374251       residual = 5.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741981422016       residual = 7.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741981427812       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741981429894       residual = 7.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741981431185       residual = 2.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741981431433       residual = 3.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741981431483       residual = 2.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741981431492       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741981431486       residual = 3.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+02 is 5.289116e-07

solving harmonic davidson linear method for identity shift 3.8147e+03, overlap shift 3.8147e+04 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741981374251       residual = 5.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741981386193       residual = 7.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741981387642       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741981388162       residual = 7.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741981388490       residual = 2.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741981388548       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741981388570       residual = 2.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741981388563       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741981388568       residual = 3.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+03 is 1.322307e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.089858 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9817e+01
  </log>
  <optVariables href="FORM2.s024.opt.xml">
ci_01                 1.086436e-01 3 1  ON 0
ci_02                -2.430009e-02 3 1  ON 1
ci_03                -2.454109e-02 3 1  ON 2
ci_04                 2.241669e-02 3 1  ON 3
ci_05                -1.919491e-02 3 1  ON 4
ci_06                -1.972849e-02 3 1  ON 5
ci_07                 2.582843e-02 3 1  ON 6
ci_08                -4.237487e-03 3 1  ON 7
ci_09                -7.570917e-03 3 1  ON 8
ci_10                -7.621041e-03 3 1  ON 9
ci_11                 1.374049e-02 3 1  ON 10
ci_12                 6.969067e-03 3 1  ON 11
ci_13                 1.379029e-02 3 1  ON 12
ci_14                 1.283304e-02 3 1  ON 13
ci_15                 5.313172e-03 3 1  ON 14
ci_16                 5.754082e-03 3 1  ON 15
ci_17                -5.096577e-03 3 1  ON 16
ci_18                -5.604981e-03 3 1  ON 17
ci_19                 1.024803e-02 3 1  ON 18
ci_20                 6.250664e-03 3 1  ON 19
ci_21                 8.485576e-03 3 1  ON 20
ci_22                 8.839741e-03 3 1  ON 21
ci_23                 4.202166e-03 3 1  ON 22
ci_24                 5.084729e-03 3 1  ON 23
ci_25                 2.980066e-03 3 1  ON 24
ci_26                 3.786189e-03 3 1  ON 25
ci_27                 3.331440e-03 3 1  ON 26
ci_28                 7.868601e-04 3 1  ON 27
ci_29                 1.174398e-03 3 1  ON 28
ci_30                -7.246231e-04 3 1  ON 29
ci_31                 1.001663e-03 3 1  ON 30
ci_32                -6.570380e-04 3 1  ON 31
ci_33                -1.040630e-03 3 1  ON 32
ci_34                 1.203850e-03 3 1  ON 33
ci_35                 1.322326e-03 3 1  ON 34
ci_36                -6.183741e-04 3 1  ON 35
ci_37                -5.411952e-04 3 1  ON 36
ci_38                -2.597108e-04 3 1  ON 37
ci_39                -1.576593e-04 3 1  ON 38
ci_40                -1.841686e-03 3 1  ON 39
ci_41                -5.606763e-04 3 1  ON 40
ci_42                -1.608414e-03 3 1  ON 41
ci_43                -1.376118e-03 3 1  ON 42
ci_44                -2.230364e-03 3 1  ON 43
ci_45                -2.701417e-04 3 1  ON 44
ci_46                -1.593893e-03 3 1  ON 45
ci_47                 1.399347e-03 3 1  ON 46
ci_48                 2.889749e-03 3 1  ON 47
ci_49                -8.679818e-04 3 1  ON 48
ci_50                -7.822386e-04 3 1  ON 49
ci_51                -4.942792e-04 3 1  ON 50
ci_52                -5.954269e-04 3 1  ON 51
ci_53                -7.837315e-04 3 1  ON 52
ci_54                -1.101449e-03 3 1  ON 53
ci_55                -1.210996e-03 3 1  ON 54
ci_56                 1.132616e-03 3 1  ON 55
ci_57                 2.080396e-03 3 1  ON 56
ci_58                -2.644747e-04 3 1  ON 57
ci_59                -5.635605e-04 3 1  ON 58
ci_60                 7.425635e-05 3 1  ON 59
ci_61                -1.004521e-03 3 1  ON 60
ci_62                -3.909082e-04 3 1  ON 61
ci_63                -2.761809e-04 3 1  ON 62
ci_64                -5.996510e-04 3 1  ON 63
ci_65                -4.212812e-05 3 1  ON 64
ci_66                -1.518513e-04 3 1  ON 65
ci_67                -2.334315e-04 3 1  ON 66
ci_68                -1.705360e-03 3 1  ON 67
ci_69                -1.774636e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -22.8578
    reference variance = 0.476804
====================================================
  Execution time = 2.4880e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4936e-01
  Total weights = 1.9649e+06
  Execution time = 3.5002e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435780417899
                                         uncertainty =       0.001670144737

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435780417899
                                         uncertainty =       0.001670144737

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466758755
  error estimate for blocks of size 2^( 2) =       0.000492653197
  error estimate for blocks of size 2^( 3) =       0.000517286544
  error estimate for blocks of size 2^( 4) =       0.000535853161
  error estimate for blocks of size 2^( 5) =       0.000546863451
  error estimate for blocks of size 2^( 6) =       0.000554688412
  error estimate for blocks of size 2^( 7) =       0.000556118721

      target function =      -0.745874371287
              le_mean =     -22.814078617765
             les_mean =     520.931548964542
             stat err =       0.000548380936
             autocorr =       1.380319910129
   target nu stat err =       0.000548380936
   target dn stat err =       0.002894812154
      target stat err =       0.002476878018
              std dev =       0.660096561389
             le_variance =       0.435727470358

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435780348204
                                         uncertainty =       0.001670156871

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435780348204
                                         uncertainty =       0.001670156871

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466758717
  error estimate for blocks of size 2^( 2) =       0.000492653073
  error estimate for blocks of size 2^( 3) =       0.000517286333
  error estimate for blocks of size 2^( 4) =       0.000535852878
  error estimate for blocks of size 2^( 5) =       0.000546863132
  error estimate for blocks of size 2^( 6) =       0.000554688039
  error estimate for blocks of size 2^( 7) =       0.000556118359

      target function =      -0.745890929942
              le_mean =     -22.814078616762
             les_mean =     520.931529007549
             stat err =       0.000548380602
             autocorr =       1.380318451016
   target nu stat err =       0.000548380602
   target dn stat err =       0.002886117424
      target stat err =       0.002469996094
              std dev =       0.660096507752
             le_variance =       0.435727399546

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435780383015
                                         uncertainty =       0.001670150804

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435780383015
                                         uncertainty =       0.001670150804

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466758736
  error estimate for blocks of size 2^( 2) =       0.000492653135
  error estimate for blocks of size 2^( 3) =       0.000517286438
  error estimate for blocks of size 2^( 4) =       0.000535853020
  error estimate for blocks of size 2^( 5) =       0.000546863291
  error estimate for blocks of size 2^( 6) =       0.000554688225
  error estimate for blocks of size 2^( 7) =       0.000556118540

      target function =      -0.745882696438
              le_mean =     -22.814078617258
             les_mean =     520.931538930674
             stat err =       0.000548380769
             autocorr =       1.380319180514
   target nu stat err =       0.000548380769
   target dn stat err =       0.002890427766
      target stat err =       0.002473407513
              std dev =       0.660096534543
             le_variance =       0.435727434916

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435780413535
                                         uncertainty =       0.001670145496

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435780413535
                                         uncertainty =       0.001670145496

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466758752
  error estimate for blocks of size 2^( 2) =       0.000492653189
  error estimate for blocks of size 2^( 3) =       0.000517286531
  error estimate for blocks of size 2^( 4) =       0.000535853144
  error estimate for blocks of size 2^( 5) =       0.000546863431
  error estimate for blocks of size 2^( 6) =       0.000554688389
  error estimate for blocks of size 2^( 7) =       0.000556118699

      target function =      -0.745875416985
              le_mean =     -22.814078617701
             les_mean =     520.931547704201
             stat err =       0.000548380915
             autocorr =       1.380319818918
   target nu stat err =       0.000548380915
   target dn stat err =       0.002894260006
      target stat err =       0.002476440934
              std dev =       0.660096558031
             le_variance =       0.435727465925


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745874371287        initial
     2.3842e+02     2.3842e+03             2.1155e-06        -0.745890929942  <--
     9.5367e+02     9.5367e+03             5.2891e-07        -0.745882696438
     3.8147e+03     3.8147e+04             1.3223e-07        -0.745875416985

*****************************************************************************
Applying the update for shift_i =   2.3842e+02     and shift_s =   2.3842e+03
*****************************************************************************

  Execution time = 4.2398e+01
  </log>
  <optVariables href="FORM2.s024.opt.xml">
ci_01                 1.086452e-01 3 1  ON 0
ci_02                -2.430045e-02 3 1  ON 1
ci_03                -2.454230e-02 3 1  ON 2
ci_04                 2.241694e-02 3 1  ON 3
ci_05                -1.919567e-02 3 1  ON 4
ci_06                -1.972849e-02 3 1  ON 5
ci_07                 2.582835e-02 3 1  ON 6
ci_08                -4.237741e-03 3 1  ON 7
ci_09                -7.571073e-03 3 1  ON 8
ci_10                -7.620497e-03 3 1  ON 9
ci_11                 1.374055e-02 3 1  ON 10
ci_12                 6.968748e-03 3 1  ON 11
ci_13                 1.379018e-02 3 1  ON 12
ci_14                 1.283310e-02 3 1  ON 13
ci_15                 5.313665e-03 3 1  ON 14
ci_16                 5.754130e-03 3 1  ON 15
ci_17                -5.096238e-03 3 1  ON 16
ci_18                -5.605216e-03 3 1  ON 17
ci_19                 1.024814e-02 3 1  ON 18
ci_20                 6.250759e-03 3 1  ON 19
ci_21                 8.485522e-03 3 1  ON 20
ci_22                 8.839692e-03 3 1  ON 21
ci_23                 4.202192e-03 3 1  ON 22
ci_24                 5.084436e-03 3 1  ON 23
ci_25                 2.980089e-03 3 1  ON 24
ci_26                 3.785789e-03 3 1  ON 25
ci_27                 3.331351e-03 3 1  ON 26
ci_28                 7.871574e-04 3 1  ON 27
ci_29                 1.174309e-03 3 1  ON 28
ci_30                -7.246265e-04 3 1  ON 29
ci_31                 1.001506e-03 3 1  ON 30
ci_32                -6.568683e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204272e-03 3 1  ON 33
ci_35                 1.322481e-03 3 1  ON 34
ci_36                -6.185596e-04 3 1  ON 35
ci_37                -5.411328e-04 3 1  ON 36
ci_38                -2.596256e-04 3 1  ON 37
ci_39                -1.577033e-04 3 1  ON 38
ci_40                -1.841516e-03 3 1  ON 39
ci_41                -5.607635e-04 3 1  ON 40
ci_42                -1.608223e-03 3 1  ON 41
ci_43                -1.376258e-03 3 1  ON 42
ci_44                -2.230208e-03 3 1  ON 43
ci_45                -2.703584e-04 3 1  ON 44
ci_46                -1.593688e-03 3 1  ON 45
ci_47                 1.399291e-03 3 1  ON 46
ci_48                 2.889749e-03 3 1  ON 47
ci_49                -8.681453e-04 3 1  ON 48
ci_50                -7.821813e-04 3 1  ON 49
ci_51                -4.942438e-04 3 1  ON 50
ci_52                -5.953502e-04 3 1  ON 51
ci_53                -7.837137e-04 3 1  ON 52
ci_54                -1.101451e-03 3 1  ON 53
ci_55                -1.211059e-03 3 1  ON 54
ci_56                 1.132692e-03 3 1  ON 55
ci_57                 2.080322e-03 3 1  ON 56
ci_58                -2.645430e-04 3 1  ON 57
ci_59                -5.634083e-04 3 1  ON 58
ci_60                 7.422927e-05 3 1  ON 59
ci_61                -1.004385e-03 3 1  ON 60
ci_62                -3.908302e-04 3 1  ON 61
ci_63                -2.762084e-04 3 1  ON 62
ci_64                -5.993767e-04 3 1  ON 63
ci_65                -4.208711e-05 3 1  ON 64
ci_66                -1.519497e-04 3 1  ON 65
ci_67                -2.334296e-04 3 1  ON 66
ci_68                -1.705307e-03 3 1  ON 67
ci_69                -1.774687e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2223e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2810e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -22.7745
    reference variance = 0.259527
====================================================
  Execution time = 2.7828e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5343e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5398e-01
  Total weights = 1.964521502e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4935e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440120875775
                                         uncertainty =       0.002023423237

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440120875775
                                         uncertainty =       0.002023423237

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469147432
  error estimate for blocks of size 2^( 2) =       0.000494979561
  error estimate for blocks of size 2^( 3) =       0.000519143397
  error estimate for blocks of size 2^( 4) =       0.000537485622
  error estimate for blocks of size 2^( 5) =       0.000548357141
  error estimate for blocks of size 2^( 6) =       0.000554650239
  error estimate for blocks of size 2^( 7) =       0.000561353906

      target function =      -0.742066667271
              le_mean =     -22.814873140821
             les_mean =     520.972412646838
             stat err =       0.000550461727
             autocorr =       1.376688138103
   target nu stat err =       0.000550461727
   target dn stat err =       0.002801799220
      target stat err =       0.002381922534
              std dev =       0.663474660612
             le_variance =       0.440198625274


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281487314082e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+01, overlap shift 5.9605e+02 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742073261984       residual = 2.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742073698543       residual = 3.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742073764110       residual = 7.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742073772718       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742073777092       residual = 8.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742073780361       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742073779860       residual = 2.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742073779846       residual = 5.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742073779928       residual = 2.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742073779899       residual = 8.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+01 is 4.556465e-06

solving harmonic davidson linear method for identity shift 2.3842e+02, overlap shift 2.3842e+03 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742073261984       residual = 2.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742073371192       residual = 3.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742073387588       residual = 7.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742073389740       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742073390833       residual = 8.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742073391650       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742073391526       residual = 2.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742073391522       residual = 5.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742073391542       residual = 2.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742073391535       residual = 8.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+02 is 1.139481e-06

solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742073261984       residual = 2.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742073289290       residual = 3.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742073293390       residual = 7.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742073293928       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742073294201       residual = 8.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742073294403       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742073294372       residual = 2.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742073294372       residual = 5.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742073294378       residual = 2.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742073294374       residual = 8.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+02 is 2.848931e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.093427 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2330e+01
  </log>
  <optVariables href="FORM2.s025.opt.xml">
ci_01                 1.086464e-01 3 1  ON 0
ci_02                -2.430147e-02 3 1  ON 1
ci_03                -2.454320e-02 3 1  ON 2
ci_04                 2.241763e-02 3 1  ON 3
ci_05                -1.919568e-02 3 1  ON 4
ci_06                -1.972860e-02 3 1  ON 5
ci_07                 2.582821e-02 3 1  ON 6
ci_08                -4.237814e-03 3 1  ON 7
ci_09                -7.571183e-03 3 1  ON 8
ci_10                -7.620031e-03 3 1  ON 9
ci_11                 1.374046e-02 3 1  ON 10
ci_12                 6.968491e-03 3 1  ON 11
ci_13                 1.379012e-02 3 1  ON 12
ci_14                 1.283337e-02 3 1  ON 13
ci_15                 5.313898e-03 3 1  ON 14
ci_16                 5.754378e-03 3 1  ON 15
ci_17                -5.096275e-03 3 1  ON 16
ci_18                -5.605512e-03 3 1  ON 17
ci_19                 1.024820e-02 3 1  ON 18
ci_20                 6.250877e-03 3 1  ON 19
ci_21                 8.485436e-03 3 1  ON 20
ci_22                 8.839603e-03 3 1  ON 21
ci_23                 4.202142e-03 3 1  ON 22
ci_24                 5.084435e-03 3 1  ON 23
ci_25                 2.980040e-03 3 1  ON 24
ci_26                 3.785897e-03 3 1  ON 25
ci_27                 3.331420e-03 3 1  ON 26
ci_28                 7.872875e-04 3 1  ON 27
ci_29                 1.174252e-03 3 1  ON 28
ci_30                -7.243459e-04 3 1  ON 29
ci_31                 1.001133e-03 3 1  ON 30
ci_32                -6.570165e-04 3 1  ON 31
ci_33                -1.041355e-03 3 1  ON 32
ci_34                 1.204109e-03 3 1  ON 33
ci_35                 1.322412e-03 3 1  ON 34
ci_36                -6.186932e-04 3 1  ON 35
ci_37                -5.412924e-04 3 1  ON 36
ci_38                -2.595479e-04 3 1  ON 37
ci_39                -1.576270e-04 3 1  ON 38
ci_40                -1.841371e-03 3 1  ON 39
ci_41                -5.608241e-04 3 1  ON 40
ci_42                -1.608058e-03 3 1  ON 41
ci_43                -1.375993e-03 3 1  ON 42
ci_44                -2.230256e-03 3 1  ON 43
ci_45                -2.702509e-04 3 1  ON 44
ci_46                -1.593591e-03 3 1  ON 45
ci_47                 1.399722e-03 3 1  ON 46
ci_48                 2.889510e-03 3 1  ON 47
ci_49                -8.681966e-04 3 1  ON 48
ci_50                -7.821832e-04 3 1  ON 49
ci_51                -4.941014e-04 3 1  ON 50
ci_52                -5.952660e-04 3 1  ON 51
ci_53                -7.838658e-04 3 1  ON 52
ci_54                -1.101427e-03 3 1  ON 53
ci_55                -1.211137e-03 3 1  ON 54
ci_56                 1.133006e-03 3 1  ON 55
ci_57                 2.079970e-03 3 1  ON 56
ci_58                -2.651061e-04 3 1  ON 57
ci_59                -5.634187e-04 3 1  ON 58
ci_60                 7.467812e-05 3 1  ON 59
ci_61                -1.004306e-03 3 1  ON 60
ci_62                -3.907993e-04 3 1  ON 61
ci_63                -2.761682e-04 3 1  ON 62
ci_64                -5.994245e-04 3 1  ON 63
ci_65                -4.222005e-05 3 1  ON 64
ci_66                -1.520744e-04 3 1  ON 65
ci_67                -2.335323e-04 3 1  ON 66
ci_68                -1.704906e-03 3 1  ON 67
ci_69                -1.774312e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -22.8086
    reference variance = 0.351114
====================================================
  Execution time = 2.4716e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4838e-01
  Total weights = 1.9649e+06
  Execution time = 3.4978e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435172936157
                                         uncertainty =       0.001884974312

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435172936157
                                         uncertainty =       0.001884974312

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466450614
  error estimate for blocks of size 2^( 2) =       0.000492673197
  error estimate for blocks of size 2^( 3) =       0.000516955504
  error estimate for blocks of size 2^( 4) =       0.000534590733
  error estimate for blocks of size 2^( 5) =       0.000548414608
  error estimate for blocks of size 2^( 6) =       0.000555032255
  error estimate for blocks of size 2^( 7) =       0.000559261917

      target function =      -0.746693040834
              le_mean =     -22.813867426851
             les_mean =     520.920926585040
             stat err =       0.000549324878
             autocorr =       1.386906544038
   target nu stat err =       0.000549324878
   target dn stat err =       0.002814360303
      target stat err =       0.002416900795
              std dev =       0.659660785195
             le_variance =       0.435152351524

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435172620922
                                         uncertainty =       0.001884999224

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435172620922
                                         uncertainty =       0.001884999224

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466450441
  error estimate for blocks of size 2^( 2) =       0.000492672761
  error estimate for blocks of size 2^( 3) =       0.000516954805
  error estimate for blocks of size 2^( 4) =       0.000534589845
  error estimate for blocks of size 2^( 5) =       0.000548413583
  error estimate for blocks of size 2^( 6) =       0.000555031249
  error estimate for blocks of size 2^( 7) =       0.000559260900

      target function =      -0.746689883693
              le_mean =     -22.813867422212
             les_mean =     520.920930172111
             stat err =       0.000549323895
             autocorr =       1.386902605420
   target nu stat err =       0.000549323895
   target dn stat err =       0.002814551427
      target stat err =       0.002417034354
              std dev =       0.659660540495
             le_variance =       0.435152028687

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435172778155
                                         uncertainty =       0.001884986761

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435172778155
                                         uncertainty =       0.001884986761

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466450528
  error estimate for blocks of size 2^( 2) =       0.000492672979
  error estimate for blocks of size 2^( 3) =       0.000516955154
  error estimate for blocks of size 2^( 4) =       0.000534590289
  error estimate for blocks of size 2^( 5) =       0.000548414095
  error estimate for blocks of size 2^( 6) =       0.000555031752
  error estimate for blocks of size 2^( 7) =       0.000559261409

      target function =      -0.746691688311
              le_mean =     -22.813867424505
             les_mean =     520.920928105317
             stat err =       0.000549324386
             autocorr =       1.386904573843
   target nu stat err =       0.000549324386
   target dn stat err =       0.002814450973
      target stat err =       0.002416965059
              std dev =       0.659660662552
             le_variance =       0.435152189719

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435172916373
                                         uncertainty =       0.001884975867

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435172916373
                                         uncertainty =       0.001884975867

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466450604
  error estimate for blocks of size 2^( 2) =       0.000492673170
  error estimate for blocks of size 2^( 3) =       0.000516955460
  error estimate for blocks of size 2^( 4) =       0.000534590677
  error estimate for blocks of size 2^( 5) =       0.000548414544
  error estimate for blocks of size 2^( 6) =       0.000555032192
  error estimate for blocks of size 2^( 7) =       0.000559261854

      target function =      -0.746692892615
              le_mean =     -22.813867426555
             les_mean =     520.920926749851
             stat err =       0.000549324817
             autocorr =       1.386906297744
   target nu stat err =       0.000549324817
   target dn stat err =       0.002814371163
      target stat err =       0.002416908577
              std dev =       0.659660769839
             le_variance =       0.435152331265


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746693040834        initial  <--
     5.9605e+01     5.9605e+02             4.5565e-06        -0.746689883693
     2.3842e+02     2.3842e+03             1.1395e-06        -0.746691688311
     9.5367e+02     9.5367e+03             2.8489e-07        -0.746692892615

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.2004
  </log>
  <optVariables href="FORM2.s025.opt.xml">
ci_01                 1.086452e-01 3 1  ON 0
ci_02                -2.430045e-02 3 1  ON 1
ci_03                -2.454230e-02 3 1  ON 2
ci_04                 2.241694e-02 3 1  ON 3
ci_05                -1.919567e-02 3 1  ON 4
ci_06                -1.972849e-02 3 1  ON 5
ci_07                 2.582835e-02 3 1  ON 6
ci_08                -4.237741e-03 3 1  ON 7
ci_09                -7.571073e-03 3 1  ON 8
ci_10                -7.620497e-03 3 1  ON 9
ci_11                 1.374055e-02 3 1  ON 10
ci_12                 6.968748e-03 3 1  ON 11
ci_13                 1.379018e-02 3 1  ON 12
ci_14                 1.283310e-02 3 1  ON 13
ci_15                 5.313665e-03 3 1  ON 14
ci_16                 5.754130e-03 3 1  ON 15
ci_17                -5.096238e-03 3 1  ON 16
ci_18                -5.605216e-03 3 1  ON 17
ci_19                 1.024814e-02 3 1  ON 18
ci_20                 6.250759e-03 3 1  ON 19
ci_21                 8.485522e-03 3 1  ON 20
ci_22                 8.839692e-03 3 1  ON 21
ci_23                 4.202192e-03 3 1  ON 22
ci_24                 5.084436e-03 3 1  ON 23
ci_25                 2.980089e-03 3 1  ON 24
ci_26                 3.785789e-03 3 1  ON 25
ci_27                 3.331351e-03 3 1  ON 26
ci_28                 7.871574e-04 3 1  ON 27
ci_29                 1.174309e-03 3 1  ON 28
ci_30                -7.246265e-04 3 1  ON 29
ci_31                 1.001506e-03 3 1  ON 30
ci_32                -6.568683e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204272e-03 3 1  ON 33
ci_35                 1.322481e-03 3 1  ON 34
ci_36                -6.185596e-04 3 1  ON 35
ci_37                -5.411328e-04 3 1  ON 36
ci_38                -2.596256e-04 3 1  ON 37
ci_39                -1.577033e-04 3 1  ON 38
ci_40                -1.841516e-03 3 1  ON 39
ci_41                -5.607635e-04 3 1  ON 40
ci_42                -1.608223e-03 3 1  ON 41
ci_43                -1.376258e-03 3 1  ON 42
ci_44                -2.230208e-03 3 1  ON 43
ci_45                -2.703584e-04 3 1  ON 44
ci_46                -1.593688e-03 3 1  ON 45
ci_47                 1.399291e-03 3 1  ON 46
ci_48                 2.889749e-03 3 1  ON 47
ci_49                -8.681453e-04 3 1  ON 48
ci_50                -7.821813e-04 3 1  ON 49
ci_51                -4.942438e-04 3 1  ON 50
ci_52                -5.953502e-04 3 1  ON 51
ci_53                -7.837137e-04 3 1  ON 52
ci_54                -1.101451e-03 3 1  ON 53
ci_55                -1.211059e-03 3 1  ON 54
ci_56                 1.132692e-03 3 1  ON 55
ci_57                 2.080322e-03 3 1  ON 56
ci_58                -2.645430e-04 3 1  ON 57
ci_59                -5.634083e-04 3 1  ON 58
ci_60                 7.422927e-05 3 1  ON 59
ci_61                -1.004385e-03 3 1  ON 60
ci_62                -3.908302e-04 3 1  ON 61
ci_63                -2.762084e-04 3 1  ON 62
ci_64                -5.993767e-04 3 1  ON 63
ci_65                -4.208711e-05 3 1  ON 64
ci_66                -1.519497e-04 3 1  ON 65
ci_67                -2.334296e-04 3 1  ON 66
ci_68                -1.705307e-03 3 1  ON 67
ci_69                -1.774687e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4538e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2809e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -22.7554
    reference variance = 0.25349
====================================================
  Execution time = 2.5313e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5310e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5556e-01
  Total weights = 1.964538192e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5011e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440175021821
                                         uncertainty =       0.002314083001

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440175021821
                                         uncertainty =       0.002314083001

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469191227
  error estimate for blocks of size 2^( 2) =       0.000495012263
  error estimate for blocks of size 2^( 3) =       0.000519545034
  error estimate for blocks of size 2^( 4) =       0.000537830231
  error estimate for blocks of size 2^( 5) =       0.000550721962
  error estimate for blocks of size 2^( 6) =       0.000555344475
  error estimate for blocks of size 2^( 7) =       0.000560633358

      target function =      -0.740770966380
              le_mean =     -22.814099634043
             les_mean =     520.938702772790
             stat err =       0.000551132507
             autocorr =       1.379787761116
   target nu stat err =       0.000551132507
   target dn stat err =       0.003100648661
      target stat err =       0.002608371311
              std dev =       0.663536596379
             le_variance =       0.440280814734


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281409963404e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+02, overlap shift 5.9605e+03 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.740779124466       residual = 2.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.740779158305       residual = 3.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.740779163919       residual = 6.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.740779164964       residual = 2.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.740779165601       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.740779165646       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.740779165642       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.740779165630       residual = 3.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.740779165625       residual = 6.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+02 is 5.177672e-07

solving harmonic davidson linear method for identity shift 2.3842e+03, overlap shift 2.3842e+04 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.740779124466       residual = 2.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.740779132926       residual = 3.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.740779134329       residual = 6.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.740779134592       residual = 2.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.740779134749       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.740779134762       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.740779134760       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.740779134759       residual = 3.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.740779134752       residual = 6.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+03 is 1.294460e-07

solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.740779124466       residual = 2.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.740779126581       residual = 3.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.740779126932       residual = 6.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.740779127001       residual = 2.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.740779127030       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.740779127041       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.740779127036       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.740779127037       residual = 3.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.740779127034       residual = 6.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+03 is 3.236176e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.096582 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9823e+01
  </log>
  <optVariables href="FORM2.s026.opt.xml">
ci_01                 1.086454e-01 3 1  ON 0
ci_02                -2.430051e-02 3 1  ON 1
ci_03                -2.454237e-02 3 1  ON 2
ci_04                 2.241701e-02 3 1  ON 3
ci_05                -1.919568e-02 3 1  ON 4
ci_06                -1.972849e-02 3 1  ON 5
ci_07                 2.582835e-02 3 1  ON 6
ci_08                -4.237753e-03 3 1  ON 7
ci_09                -7.571074e-03 3 1  ON 8
ci_10                -7.620481e-03 3 1  ON 9
ci_11                 1.374052e-02 3 1  ON 10
ci_12                 6.968742e-03 3 1  ON 11
ci_13                 1.379016e-02 3 1  ON 12
ci_14                 1.283311e-02 3 1  ON 13
ci_15                 5.313692e-03 3 1  ON 14
ci_16                 5.754158e-03 3 1  ON 15
ci_17                -5.096220e-03 3 1  ON 16
ci_18                -5.605262e-03 3 1  ON 17
ci_19                 1.024811e-02 3 1  ON 18
ci_20                 6.250749e-03 3 1  ON 19
ci_21                 8.485517e-03 3 1  ON 20
ci_22                 8.839706e-03 3 1  ON 21
ci_23                 4.202225e-03 3 1  ON 22
ci_24                 5.084413e-03 3 1  ON 23
ci_25                 2.980084e-03 3 1  ON 24
ci_26                 3.785791e-03 3 1  ON 25
ci_27                 3.331348e-03 3 1  ON 26
ci_28                 7.871778e-04 3 1  ON 27
ci_29                 1.174313e-03 3 1  ON 28
ci_30                -7.246355e-04 3 1  ON 29
ci_31                 1.001460e-03 3 1  ON 30
ci_32                -6.568906e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204296e-03 3 1  ON 33
ci_35                 1.322445e-03 3 1  ON 34
ci_36                -6.185588e-04 3 1  ON 35
ci_37                -5.411537e-04 3 1  ON 36
ci_38                -2.596471e-04 3 1  ON 37
ci_39                -1.577156e-04 3 1  ON 38
ci_40                -1.841506e-03 3 1  ON 39
ci_41                -5.607556e-04 3 1  ON 40
ci_42                -1.608211e-03 3 1  ON 41
ci_43                -1.376276e-03 3 1  ON 42
ci_44                -2.230177e-03 3 1  ON 43
ci_45                -2.703612e-04 3 1  ON 44
ci_46                -1.593659e-03 3 1  ON 45
ci_47                 1.399308e-03 3 1  ON 46
ci_48                 2.889731e-03 3 1  ON 47
ci_49                -8.681514e-04 3 1  ON 48
ci_50                -7.821868e-04 3 1  ON 49
ci_51                -4.942350e-04 3 1  ON 50
ci_52                -5.953377e-04 3 1  ON 51
ci_53                -7.836851e-04 3 1  ON 52
ci_54                -1.101455e-03 3 1  ON 53
ci_55                -1.211025e-03 3 1  ON 54
ci_56                 1.132716e-03 3 1  ON 55
ci_57                 2.080327e-03 3 1  ON 56
ci_58                -2.645415e-04 3 1  ON 57
ci_59                -5.633866e-04 3 1  ON 58
ci_60                 7.421553e-05 3 1  ON 59
ci_61                -1.004368e-03 3 1  ON 60
ci_62                -3.908477e-04 3 1  ON 61
ci_63                -2.761982e-04 3 1  ON 62
ci_64                -5.993571e-04 3 1  ON 63
ci_65                -4.206022e-05 3 1  ON 64
ci_66                -1.519550e-04 3 1  ON 65
ci_67                -2.334470e-04 3 1  ON 66
ci_68                -1.705272e-03 3 1  ON 67
ci_69                -1.774682e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -22.8534
    reference variance = 0.426953
====================================================
  Execution time = 2.5161e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5163e-01
  Total weights = 1.9647e+06
  Execution time = 3.5102e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436993798769
                                         uncertainty =       0.002151596624

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436993798769
                                         uncertainty =       0.002151596624

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467409514
  error estimate for blocks of size 2^( 2) =       0.000493217434
  error estimate for blocks of size 2^( 3) =       0.000517573486
  error estimate for blocks of size 2^( 4) =       0.000535605314
  error estimate for blocks of size 2^( 5) =       0.000546670112
  error estimate for blocks of size 2^( 6) =       0.000552859857
  error estimate for blocks of size 2^( 7) =       0.000557224477

      target function =      -0.743992904883
              le_mean =     -22.814774563223
             les_mean =     520.965569047175
             stat err =       0.000548089940
             autocorr =       1.375018574139
   target nu stat err =       0.000548089940
   target dn stat err =       0.003879351146
      target stat err =       0.003261541454
              std dev =       0.661016874084
             le_variance =       0.436943307824

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436993800567
                                         uncertainty =       0.002151598636

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436993800567
                                         uncertainty =       0.002151598636

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467409515
  error estimate for blocks of size 2^( 2) =       0.000493217409
  error estimate for blocks of size 2^( 3) =       0.000517573437
  error estimate for blocks of size 2^( 4) =       0.000535605247
  error estimate for blocks of size 2^( 5) =       0.000546670031
  error estimate for blocks of size 2^( 6) =       0.000552859766
  error estimate for blocks of size 2^( 7) =       0.000557224386

      target function =      -0.743992959523
              le_mean =     -22.814774563666
             les_mean =     520.965569001295
             stat err =       0.000548089857
             autocorr =       1.375018156306
   target nu stat err =       0.000548089857
   target dn stat err =       0.003879347731
      target stat err =       0.003261539139
              std dev =       0.661016875258
             le_variance =       0.436943309376

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436993799665
                                         uncertainty =       0.002151597630

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436993799665
                                         uncertainty =       0.002151597630

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467409515
  error estimate for blocks of size 2^( 2) =       0.000493217422
  error estimate for blocks of size 2^( 3) =       0.000517573462
  error estimate for blocks of size 2^( 4) =       0.000535605281
  error estimate for blocks of size 2^( 5) =       0.000546670071
  error estimate for blocks of size 2^( 6) =       0.000552859811
  error estimate for blocks of size 2^( 7) =       0.000557224431

      target function =      -0.743992932251
              le_mean =     -22.814774563444
             les_mean =     520.965569024163
             stat err =       0.000548089899
             autocorr =       1.375018365213
   target nu stat err =       0.000548089899
   target dn stat err =       0.003879349436
      target stat err =       0.003261540295
              std dev =       0.661016874669
             le_variance =       0.436943308597

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436993798881
                                         uncertainty =       0.002151596750

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436993798881
                                         uncertainty =       0.002151596750

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467409514
  error estimate for blocks of size 2^( 2) =       0.000493217433
  error estimate for blocks of size 2^( 3) =       0.000517573483
  error estimate for blocks of size 2^( 4) =       0.000535605310
  error estimate for blocks of size 2^( 5) =       0.000546670107
  error estimate for blocks of size 2^( 6) =       0.000552859851
  error estimate for blocks of size 2^( 7) =       0.000557224471

      target function =      -0.743992908309
              le_mean =     -22.814774563250
             les_mean =     520.965569044291
             stat err =       0.000548089935
             autocorr =       1.375018548028
   target nu stat err =       0.000548089935
   target dn stat err =       0.003879350932
      target stat err =       0.003261541309
              std dev =       0.661016874157
             le_variance =       0.436943307920


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743992904883        initial
     5.9605e+02     5.9605e+03             5.1777e-07        -0.743992959523  <--
     2.3842e+03     2.3842e+04             1.2945e-07        -0.743992932251
     9.5367e+03     9.5367e+04             3.2362e-08        -0.743992908309

*****************************************************************************
Applying the update for shift_i =   5.9605e+02     and shift_s =   5.9605e+03
*****************************************************************************

  Execution time = 4.2706e+01
  </log>
  <optVariables href="FORM2.s026.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620434e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968723e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283312e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250718e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084342e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785796e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872390e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246626e-04 3 1  ON 29
ci_31                 1.001323e-03 3 1  ON 30
ci_32                -6.569574e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185566e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841476e-03 3 1  ON 39
ci_41                -5.607318e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376330e-03 3 1  ON 42
ci_44                -2.230083e-03 3 1  ON 43
ci_45                -2.703697e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681696e-04 3 1  ON 48
ci_50                -7.822034e-04 3 1  ON 49
ci_51                -4.942086e-04 3 1  ON 50
ci_52                -5.953002e-04 3 1  ON 51
ci_53                -7.835994e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645368e-04 3 1  ON 57
ci_59                -5.633215e-04 3 1  ON 58
ci_60                 7.417430e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909002e-04 3 1  ON 61
ci_63                -2.761673e-04 3 1  ON 62
ci_64                -5.992986e-04 3 1  ON 63
ci_65                -4.197956e-05 3 1  ON 64
ci_66                -1.519710e-04 3 1  ON 65
ci_67                -2.334991e-04 3 1  ON 66
ci_68                -1.705168e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2536e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2809e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -22.8904
    reference variance = 0.497891
====================================================
  Execution time = 2.7383e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5362e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4823e-01
  Total weights = 1.964791736e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5134e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435787165423
                                         uncertainty =       0.001997692527

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435787165423
                                         uncertainty =       0.001997692527

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466746278
  error estimate for blocks of size 2^( 2) =       0.000492506810
  error estimate for blocks of size 2^( 3) =       0.000516946307
  error estimate for blocks of size 2^( 4) =       0.000535167069
  error estimate for blocks of size 2^( 5) =       0.000546511437
  error estimate for blocks of size 2^( 6) =       0.000553487152
  error estimate for blocks of size 2^( 7) =       0.000556679442

      target function =      -0.746819626088
              le_mean =     -22.814575521304
             les_mean =     520.953085404353
             stat err =       0.000547961275
             autocorr =       1.378281756929
   target nu stat err =       0.000547961275
   target dn stat err =       0.002755670171
      target stat err =       0.002372643951
              std dev =       0.660078916978
             le_variance =       0.435704176639


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281457552130e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+02, overlap shift 1.4901e+03 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746826262169       residual = 2.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746826379306       residual = 3.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746826400441       residual = 8.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746826405254       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746826406993       residual = 7.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746826408274       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746826408365       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746826408391       residual = 2.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746826408366       residual = 5.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+02 is 1.516473e-06

solving harmonic davidson linear method for identity shift 5.9605e+02, overlap shift 5.9605e+03 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746826262169       residual = 2.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746826291461       residual = 3.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746826296746       residual = 8.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746826297949       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746826298384       residual = 7.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746826298704       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746826298726       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746826298733       residual = 2.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746826298726       residual = 5.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+02 is 3.791708e-07

solving harmonic davidson linear method for identity shift 2.3842e+03, overlap shift 2.3842e+04 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746826262169       residual = 2.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746826269493       residual = 3.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746826270814       residual = 8.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746826271115       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746826271220       residual = 7.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746826271299       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746826271309       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746826271309       residual = 2.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746826271312       residual = 5.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+03 is 9.479599e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.099691 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1905e+01
  </log>
  <optVariables href="FORM2.s027.opt.xml">
ci_01                 1.086461e-01 3 1  ON 0
ci_02                -2.430092e-02 3 1  ON 1
ci_03                -2.454274e-02 3 1  ON 2
ci_04                 2.241745e-02 3 1  ON 3
ci_05                -1.919586e-02 3 1  ON 4
ci_06                -1.972871e-02 3 1  ON 5
ci_07                 2.582839e-02 3 1  ON 6
ci_08                -4.237792e-03 3 1  ON 7
ci_09                -7.571060e-03 3 1  ON 8
ci_10                -7.620448e-03 3 1  ON 9
ci_11                 1.374050e-02 3 1  ON 10
ci_12                 6.968747e-03 3 1  ON 11
ci_13                 1.378998e-02 3 1  ON 12
ci_14                 1.283318e-02 3 1  ON 13
ci_15                 5.313994e-03 3 1  ON 14
ci_16                 5.754319e-03 3 1  ON 15
ci_17                -5.096301e-03 3 1  ON 16
ci_18                -5.605350e-03 3 1  ON 17
ci_19                 1.024790e-02 3 1  ON 18
ci_20                 6.250786e-03 3 1  ON 19
ci_21                 8.485550e-03 3 1  ON 20
ci_22                 8.839742e-03 3 1  ON 21
ci_23                 4.202312e-03 3 1  ON 22
ci_24                 5.084296e-03 3 1  ON 23
ci_25                 2.980026e-03 3 1  ON 24
ci_26                 3.785738e-03 3 1  ON 25
ci_27                 3.331215e-03 3 1  ON 26
ci_28                 7.872871e-04 3 1  ON 27
ci_29                 1.174279e-03 3 1  ON 28
ci_30                -7.247571e-04 3 1  ON 29
ci_31                 1.001254e-03 3 1  ON 30
ci_32                -6.569837e-04 3 1  ON 31
ci_33                -1.040918e-03 3 1  ON 32
ci_34                 1.204424e-03 3 1  ON 33
ci_35                 1.322415e-03 3 1  ON 34
ci_36                -6.185638e-04 3 1  ON 35
ci_37                -5.412573e-04 3 1  ON 36
ci_38                -2.597608e-04 3 1  ON 37
ci_39                -1.578033e-04 3 1  ON 38
ci_40                -1.841426e-03 3 1  ON 39
ci_41                -5.608140e-04 3 1  ON 40
ci_42                -1.608201e-03 3 1  ON 41
ci_43                -1.376355e-03 3 1  ON 42
ci_44                -2.230055e-03 3 1  ON 43
ci_45                -2.703835e-04 3 1  ON 44
ci_46                -1.593440e-03 3 1  ON 45
ci_47                 1.399439e-03 3 1  ON 46
ci_48                 2.889592e-03 3 1  ON 47
ci_49                -8.682045e-04 3 1  ON 48
ci_50                -7.821199e-04 3 1  ON 49
ci_51                -4.941313e-04 3 1  ON 50
ci_52                -5.951974e-04 3 1  ON 51
ci_53                -7.835467e-04 3 1  ON 52
ci_54                -1.101462e-03 3 1  ON 53
ci_55                -1.210789e-03 3 1  ON 54
ci_56                 1.132868e-03 3 1  ON 55
ci_57                 2.080348e-03 3 1  ON 56
ci_58                -2.645823e-04 3 1  ON 57
ci_59                -5.633729e-04 3 1  ON 58
ci_60                 7.424303e-05 3 1  ON 59
ci_61                -1.004483e-03 3 1  ON 60
ci_62                -3.908266e-04 3 1  ON 61
ci_63                -2.761779e-04 3 1  ON 62
ci_64                -5.991869e-04 3 1  ON 63
ci_65                -4.197639e-05 3 1  ON 64
ci_66                -1.520548e-04 3 1  ON 65
ci_67                -2.334523e-04 3 1  ON 66
ci_68                -1.705121e-03 3 1  ON 67
ci_69                -1.774611e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -22.7682
    reference variance = 0.714721
====================================================
  Execution time = 2.4988e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4659e-01
  Total weights = 1.9647e+06
  Execution time = 3.5037e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434629688491
                                         uncertainty =       0.002310306376

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434629688491
                                         uncertainty =       0.002310306376

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466187799
  error estimate for blocks of size 2^( 2) =       0.000491720089
  error estimate for blocks of size 2^( 3) =       0.000515839797
  error estimate for blocks of size 2^( 4) =       0.000533550069
  error estimate for blocks of size 2^( 5) =       0.000544152086
  error estimate for blocks of size 2^( 6) =       0.000550232455
  error estimate for blocks of size 2^( 7) =       0.000555533838

      target function =      -0.748187818277
              le_mean =     -22.815435598189
             les_mean =     520.990693008815
             stat err =       0.000545867112
             autocorr =       1.371046084519
   target nu stat err =       0.000545867112
   target dn stat err =       0.002609126003
      target stat err =       0.002265280732
              std dev =       0.659289107569
             le_variance =       0.434662127359

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434629578174
                                         uncertainty =       0.002310298592

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434629578174
                                         uncertainty =       0.002310298592

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466187739
  error estimate for blocks of size 2^( 2) =       0.000491719941
  error estimate for blocks of size 2^( 3) =       0.000515839571
  error estimate for blocks of size 2^( 4) =       0.000533549779
  error estimate for blocks of size 2^( 5) =       0.000544151764
  error estimate for blocks of size 2^( 6) =       0.000550232077
  error estimate for blocks of size 2^( 7) =       0.000555533483

      target function =      -0.748187767749
              le_mean =     -22.815435590119
             les_mean =     520.990692701007
             stat err =       0.000545866776
             autocorr =       1.371044746610
   target nu stat err =       0.000545866776
   target dn stat err =       0.002609119424
      target stat err =       0.002265275011
              std dev =       0.659289022914
             le_variance =       0.434662015734

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434629633294
                                         uncertainty =       0.002310302482

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434629633294
                                         uncertainty =       0.002310302482

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466187769
  error estimate for blocks of size 2^( 2) =       0.000491720015
  error estimate for blocks of size 2^( 3) =       0.000515839684
  error estimate for blocks of size 2^( 4) =       0.000533549924
  error estimate for blocks of size 2^( 5) =       0.000544151925
  error estimate for blocks of size 2^( 6) =       0.000550232266
  error estimate for blocks of size 2^( 7) =       0.000555533660

      target function =      -0.748187794437
              le_mean =     -22.815435594149
             les_mean =     520.990692852962
             stat err =       0.000545866944
             autocorr =       1.371045415452
   target nu stat err =       0.000545866944
   target dn stat err =       0.002609122692
      target stat err =       0.002265277862
              std dev =       0.659289065212
             le_variance =       0.434662071508

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434629681588
                                         uncertainty =       0.002310305889

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434629681588
                                         uncertainty =       0.002310305889

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466187795
  error estimate for blocks of size 2^( 2) =       0.000491720080
  error estimate for blocks of size 2^( 3) =       0.000515839783
  error estimate for blocks of size 2^( 4) =       0.000533550051
  error estimate for blocks of size 2^( 5) =       0.000544152066
  error estimate for blocks of size 2^( 6) =       0.000550232431
  error estimate for blocks of size 2^( 7) =       0.000555533815

      target function =      -0.748187815452
              le_mean =     -22.815435597684
             les_mean =     520.990692989125
             stat err =       0.000545867091
             autocorr =       1.371046000880
   target nu stat err =       0.000545867091
   target dn stat err =       0.002609125587
      target stat err =       0.002265280372
              std dev =       0.659289102272
             le_variance =       0.434662120374


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748187818277        initial  <--
     1.4901e+02     1.4901e+03             1.5165e-06        -0.748187767749
     5.9605e+02     5.9605e+03             3.7917e-07        -0.748187794437
     2.3842e+03     2.3842e+04             9.4796e-08        -0.748187815452

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.5121
  </log>
  <optVariables href="FORM2.s027.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620434e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968723e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283312e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250718e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084342e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785796e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872390e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246626e-04 3 1  ON 29
ci_31                 1.001323e-03 3 1  ON 30
ci_32                -6.569574e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185566e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841476e-03 3 1  ON 39
ci_41                -5.607318e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376330e-03 3 1  ON 42
ci_44                -2.230083e-03 3 1  ON 43
ci_45                -2.703697e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681696e-04 3 1  ON 48
ci_50                -7.822034e-04 3 1  ON 49
ci_51                -4.942086e-04 3 1  ON 50
ci_52                -5.953002e-04 3 1  ON 51
ci_53                -7.835994e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645368e-04 3 1  ON 57
ci_59                -5.633215e-04 3 1  ON 58
ci_60                 7.417430e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909002e-04 3 1  ON 61
ci_63                -2.761673e-04 3 1  ON 62
ci_64                -5.992986e-04 3 1  ON 63
ci_65                -4.197956e-05 3 1  ON 64
ci_66                -1.519710e-04 3 1  ON 65
ci_67                -2.334991e-04 3 1  ON 66
ci_68                -1.705168e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4424e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2809e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -22.8459
    reference variance = 0.439572
====================================================
  Execution time = 2.5264e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5367e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5340e-01
  Total weights = 1.965194919e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5044e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439005653041
                                         uncertainty =       0.002308979121

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439005653041
                                         uncertainty =       0.002308979121

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468495364
  error estimate for blocks of size 2^( 2) =       0.000494154533
  error estimate for blocks of size 2^( 3) =       0.000518610945
  error estimate for blocks of size 2^( 4) =       0.000537082559
  error estimate for blocks of size 2^( 5) =       0.000549349034
  error estimate for blocks of size 2^( 6) =       0.000555657464
  error estimate for blocks of size 2^( 7) =       0.000560871762

      target function =      -0.742543833046
              le_mean =     -22.813662972478
             les_mean =     520.916618186302
             stat err =       0.000550740205
             autocorr =       1.381920206417
   target nu stat err =       0.000550740205
   target dn stat err =       0.003180955660
      target stat err =       0.002682925356
              std dev =       0.662552498305
             le_variance =       0.438975813010


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281366297248e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+03, overlap shift 1.4901e+04 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742552509818       residual = 2.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742552523451       residual = 2.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742552525255       residual = 5.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742552525768       residual = 2.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742552525834       residual = 8.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742552525836       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742552525845       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742552525849       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742552525847       residual = 3.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+03 is 1.813530e-07

solving harmonic davidson linear method for identity shift 5.9605e+03, overlap shift 5.9605e+04 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742552509818       residual = 2.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742552513226       residual = 2.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742552513677       residual = 5.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742552513804       residual = 2.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742552513833       residual = 8.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742552513823       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742552513820       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742552513825       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742552513816       residual = 3.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+03 is 4.533884e-08

solving harmonic davidson linear method for identity shift 2.3842e+04, overlap shift 2.3842e+05 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742552509818       residual = 2.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742552510670       residual = 2.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742552510783       residual = 5.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742552510815       residual = 2.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742552510829       residual = 8.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742552510791       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742552510813       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742552510826       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742552510830       residual = 3.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+04 is 1.133475e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.102810 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9777e+01
  </log>
  <optVariables href="FORM2.s028.opt.xml">
ci_01                 1.086458e-01 3 1  ON 0
ci_02                -2.430072e-02 3 1  ON 1
ci_03                -2.454263e-02 3 1  ON 2
ci_04                 2.241725e-02 3 1  ON 3
ci_05                -1.919574e-02 3 1  ON 4
ci_06                -1.972847e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237795e-03 3 1  ON 7
ci_09                -7.571072e-03 3 1  ON 8
ci_10                -7.620428e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968728e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313768e-03 3 1  ON 14
ci_16                 5.754254e-03 3 1  ON 15
ci_17                -5.096167e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024799e-02 3 1  ON 18
ci_20                 6.250716e-03 3 1  ON 19
ci_21                 8.485497e-03 3 1  ON 20
ci_22                 8.839748e-03 3 1  ON 21
ci_23                 4.202337e-03 3 1  ON 22
ci_24                 5.084335e-03 3 1  ON 23
ci_25                 2.980061e-03 3 1  ON 24
ci_26                 3.785791e-03 3 1  ON 25
ci_27                 3.331327e-03 3 1  ON 26
ci_28                 7.872471e-04 3 1  ON 27
ci_29                 1.174329e-03 3 1  ON 28
ci_30                -7.246588e-04 3 1  ON 29
ci_31                 1.001315e-03 3 1  ON 30
ci_32                -6.569609e-04 3 1  ON 31
ci_33                -1.040901e-03 3 1  ON 32
ci_34                 1.204362e-03 3 1  ON 33
ci_35                 1.322351e-03 3 1  ON 34
ci_36                -6.185635e-04 3 1  ON 35
ci_37                -5.412200e-04 3 1  ON 36
ci_38                -2.597076e-04 3 1  ON 37
ci_39                -1.577488e-04 3 1  ON 38
ci_40                -1.841471e-03 3 1  ON 39
ci_41                -5.607339e-04 3 1  ON 40
ci_42                -1.608167e-03 3 1  ON 41
ci_43                -1.376336e-03 3 1  ON 42
ci_44                -2.230080e-03 3 1  ON 43
ci_45                -2.703622e-04 3 1  ON 44
ci_46                -1.593563e-03 3 1  ON 45
ci_47                 1.399366e-03 3 1  ON 46
ci_48                 2.889658e-03 3 1  ON 47
ci_49                -8.681728e-04 3 1  ON 48
ci_50                -7.822055e-04 3 1  ON 49
ci_51                -4.942059e-04 3 1  ON 50
ci_52                -5.952897e-04 3 1  ON 51
ci_53                -7.836030e-04 3 1  ON 52
ci_54                -1.101465e-03 3 1  ON 53
ci_55                -1.210928e-03 3 1  ON 54
ci_56                 1.132800e-03 3 1  ON 55
ci_57                 2.080343e-03 3 1  ON 56
ci_58                -2.645392e-04 3 1  ON 57
ci_59                -5.633150e-04 3 1  ON 58
ci_60                 7.416611e-05 3 1  ON 59
ci_61                -1.004310e-03 3 1  ON 60
ci_62                -3.908979e-04 3 1  ON 61
ci_63                -2.761707e-04 3 1  ON 62
ci_64                -5.992872e-04 3 1  ON 63
ci_65                -4.198324e-05 3 1  ON 64
ci_66                -1.519760e-04 3 1  ON 65
ci_67                -2.335083e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774665e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -22.7641
    reference variance = 0.422992
====================================================
  Execution time = 2.4834e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4418e-01
  Total weights = 1.9647e+06
  Execution time = 3.4892e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432696224545
                                         uncertainty =       0.002241814746

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432696224545
                                         uncertainty =       0.002241814746

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465233128
  error estimate for blocks of size 2^( 2) =       0.000490956667
  error estimate for blocks of size 2^( 3) =       0.000515304702
  error estimate for blocks of size 2^( 4) =       0.000533789407
  error estimate for blocks of size 2^( 5) =       0.000545269485
  error estimate for blocks of size 2^( 6) =       0.000552963517
  error estimate for blocks of size 2^( 7) =       0.000554415694

      target function =      -0.750196785447
              le_mean =     -22.813973957191
             les_mean =     520.921591544388
             stat err =       0.000546609526
             autocorr =       1.380425990713
   target nu stat err =       0.000546609526
   target dn stat err =       0.002692690313
      target stat err =       0.002339871477
              std dev =       0.657938999380
             le_variance =       0.432883726905

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432696216789
                                         uncertainty =       0.002241816366

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432696216789
                                         uncertainty =       0.002241816366

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465233124
  error estimate for blocks of size 2^( 2) =       0.000490956652
  error estimate for blocks of size 2^( 3) =       0.000515304677
  error estimate for blocks of size 2^( 4) =       0.000533789375
  error estimate for blocks of size 2^( 5) =       0.000545269448
  error estimate for blocks of size 2^( 6) =       0.000552963477
  error estimate for blocks of size 2^( 7) =       0.000554415654

      target function =      -0.750196643954
              le_mean =     -22.813973956836
             les_mean =     520.921591696652
             stat err =       0.000546609489
             autocorr =       1.380425826982
   target nu stat err =       0.000546609489
   target dn stat err =       0.002692721244
      target stat err =       0.002339895657
              std dev =       0.657938993451
             le_variance =       0.432883719104

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432696220666
                                         uncertainty =       0.002241815556

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432696220666
                                         uncertainty =       0.002241815556

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465233126
  error estimate for blocks of size 2^( 2) =       0.000490956659
  error estimate for blocks of size 2^( 3) =       0.000515304690
  error estimate for blocks of size 2^( 4) =       0.000533789391
  error estimate for blocks of size 2^( 5) =       0.000545269467
  error estimate for blocks of size 2^( 6) =       0.000552963497
  error estimate for blocks of size 2^( 7) =       0.000554415674

      target function =      -0.750196714706
              le_mean =     -22.813973957013
             les_mean =     520.921591620511
             stat err =       0.000546609507
             autocorr =       1.380425908845
   target nu stat err =       0.000546609507
   target dn stat err =       0.002692705777
      target stat err =       0.002339883566
              std dev =       0.657938996415
             le_variance =       0.432883723004

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432696224060
                                         uncertainty =       0.002241814847

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432696224060
                                         uncertainty =       0.002241814847

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465233128
  error estimate for blocks of size 2^( 2) =       0.000490956666
  error estimate for blocks of size 2^( 3) =       0.000515304701
  error estimate for blocks of size 2^( 4) =       0.000533789405
  error estimate for blocks of size 2^( 5) =       0.000545269483
  error estimate for blocks of size 2^( 6) =       0.000552963514
  error estimate for blocks of size 2^( 7) =       0.000554415692

      target function =      -0.750196776605
              le_mean =     -22.813973957169
             les_mean =     520.921591553903
             stat err =       0.000546609524
             autocorr =       1.380425980474
   target nu stat err =       0.000546609524
   target dn stat err =       0.002692692246
      target stat err =       0.002339872988
              std dev =       0.657938999010
             le_variance =       0.432883726418


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.750196785447        initial  <--
     1.4901e+03     1.4901e+04             1.8135e-07        -0.750196643954
     5.9605e+03     5.9605e+04             4.5339e-08        -0.750196714706
     2.3842e+04     2.3842e+05             1.1335e-08        -0.750196776605

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.2887
  </log>
  <optVariables href="FORM2.s028.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620434e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968723e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283312e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250718e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084342e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785796e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872390e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246626e-04 3 1  ON 29
ci_31                 1.001323e-03 3 1  ON 30
ci_32                -6.569574e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185566e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841476e-03 3 1  ON 39
ci_41                -5.607318e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376330e-03 3 1  ON 42
ci_44                -2.230083e-03 3 1  ON 43
ci_45                -2.703697e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681696e-04 3 1  ON 48
ci_50                -7.822034e-04 3 1  ON 49
ci_51                -4.942086e-04 3 1  ON 50
ci_52                -5.953002e-04 3 1  ON 51
ci_53                -7.835994e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645368e-04 3 1  ON 57
ci_59                -5.633215e-04 3 1  ON 58
ci_60                 7.417430e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909002e-04 3 1  ON 61
ci_63                -2.761673e-04 3 1  ON 62
ci_64                -5.992986e-04 3 1  ON 63
ci_65                -4.197956e-05 3 1  ON 64
ci_66                -1.519710e-04 3 1  ON 65
ci_67                -2.334991e-04 3 1  ON 66
ci_68                -1.705168e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2073e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2809e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -22.8804
    reference variance = 0.498479
====================================================
  Execution time = 2.7469e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5357e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5141e-01
  Total weights = 1.964545800e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5061e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437651947347
                                         uncertainty =       0.002898447339

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437651947347
                                         uncertainty =       0.002898447339

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467829190
  error estimate for blocks of size 2^( 2) =       0.000493716795
  error estimate for blocks of size 2^( 3) =       0.000517674123
  error estimate for blocks of size 2^( 4) =       0.000536352184
  error estimate for blocks of size 2^( 5) =       0.000548146521
  error estimate for blocks of size 2^( 6) =       0.000556019699
  error estimate for blocks of size 2^( 7) =       0.000559322127

      target function =      -0.744169177882
              le_mean =     -22.814180849123
             les_mean =     520.938262512274
             stat err =       0.000549960133
             autocorr =       1.381935535879
   target nu stat err =       0.000549960133
   target dn stat err =       0.004385445699
      target stat err =       0.003671881304
              std dev =       0.661610385406
             le_variance =       0.437728302077


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281418084912e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+04, overlap shift 1.4901e+05 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744186077819       residual = 3.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744186079612       residual = 3.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744186079875       residual = 5.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744186079919       residual = 2.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744186079968       residual = 9.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744186079929       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744186079947       residual = 3.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744186079941       residual = 6.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744186079942       residual = 2.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744186079954       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744186079908       residual = 1.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+04 is 1.703720e-08

solving harmonic davidson linear method for identity shift 5.9605e+04, overlap shift 5.9605e+05 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744186077819       residual = 3.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744186078267       residual = 3.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744186078333       residual = 5.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744186078368       residual = 2.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744186078369       residual = 9.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744186078374       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744186078289       residual = 3.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744186078433       residual = 6.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744186078324       residual = 2.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744186078321       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744186078447       residual = 1.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+04 is 4.259309e-09

solving harmonic davidson linear method for identity shift 2.3842e+05, overlap shift 2.3842e+06 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744186077819       residual = 3.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744186077931       residual = 3.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744186077948       residual = 5.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744186077812       residual = 2.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744186077951       residual = 9.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744186078003       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744186078005       residual = 3.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744186077923       residual = 6.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744186077482       residual = 2.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744186078156       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744186077763       residual = 1.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+05 is 1.064828e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.107009 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1985e+01
  </log>
  <optVariables href="FORM2.s029.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430070e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237789e-03 3 1  ON 7
ci_09                -7.571077e-03 3 1  ON 8
ci_10                -7.620434e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283312e-02 3 1  ON 13
ci_15                 5.313776e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096164e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839748e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084342e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872364e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246621e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569591e-04 3 1  ON 31
ci_33                -1.040898e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322337e-03 3 1  ON 34
ci_36                -6.185571e-04 3 1  ON 35
ci_37                -5.412171e-04 3 1  ON 36
ci_38                -2.597119e-04 3 1  ON 37
ci_39                -1.577546e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607336e-04 3 1  ON 40
ci_42                -1.608172e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230083e-03 3 1  ON 43
ci_45                -2.703705e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681693e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942080e-04 3 1  ON 50
ci_52                -5.952997e-04 3 1  ON 51
ci_53                -7.835995e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210923e-03 3 1  ON 54
ci_56                 1.132792e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645379e-04 3 1  ON 57
ci_59                -5.633215e-04 3 1  ON 58
ci_60                 7.417237e-05 3 1  ON 59
ci_61                -1.004319e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761670e-04 3 1  ON 62
ci_64                -5.992988e-04 3 1  ON 63
ci_65                -4.197973e-05 3 1  ON 64
ci_66                -1.519714e-04 3 1  ON 65
ci_67                -2.334995e-04 3 1  ON 66
ci_68                -1.705168e-03 3 1  ON 67
ci_69                -1.774670e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -22.7939
    reference variance = 0.40343
====================================================
  Execution time = 2.5090e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5265e-01
  Total weights = 1.9647e+06
  Execution time = 3.4932e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437464158642
                                         uncertainty =       0.003935207845

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437464158642
                                         uncertainty =       0.003935207845

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467696730
  error estimate for blocks of size 2^( 2) =       0.000493270864
  error estimate for blocks of size 2^( 3) =       0.000517836221
  error estimate for blocks of size 2^( 4) =       0.000535760165
  error estimate for blocks of size 2^( 5) =       0.000548137883
  error estimate for blocks of size 2^( 6) =       0.000556545143
  error estimate for blocks of size 2^( 7) =       0.000560486374

      target function =      -0.743132362554
              le_mean =     -22.815038775703
             les_mean =     520.978640334476
             stat err =       0.000550232391
             autocorr =       1.384087792741
   target nu stat err =       0.000550232391
   target dn stat err =       0.006249513271
      target stat err =       0.005188271253
              std dev =       0.661423059055
             le_variance =       0.437480463050

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437464161482
                                         uncertainty =       0.003935209225

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437464161482
                                         uncertainty =       0.003935209225

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467696732
  error estimate for blocks of size 2^( 2) =       0.000493270864
  error estimate for blocks of size 2^( 3) =       0.000517836221
  error estimate for blocks of size 2^( 4) =       0.000535760164
  error estimate for blocks of size 2^( 5) =       0.000548137881
  error estimate for blocks of size 2^( 6) =       0.000556545141
  error estimate for blocks of size 2^( 7) =       0.000560486372

      target function =      -0.743132351004
              le_mean =     -22.815038775721
             les_mean =     520.978640349263
             stat err =       0.000550232389
             autocorr =       1.384087774987
   target nu stat err =       0.000550232389
   target dn stat err =       0.006249517274
      target stat err =       0.005188274370
              std dev =       0.661423061201
             le_variance =       0.437480465888

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437464160062
                                         uncertainty =       0.003935208535

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437464160062
                                         uncertainty =       0.003935208535

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467696731
  error estimate for blocks of size 2^( 2) =       0.000493270864
  error estimate for blocks of size 2^( 3) =       0.000517836221
  error estimate for blocks of size 2^( 4) =       0.000535760164
  error estimate for blocks of size 2^( 5) =       0.000548137882
  error estimate for blocks of size 2^( 6) =       0.000556545142
  error estimate for blocks of size 2^( 7) =       0.000560486373

      target function =      -0.743132356780
              le_mean =     -22.815038775712
             les_mean =     520.978640341868
             stat err =       0.000550232390
             autocorr =       1.384087783862
   target nu stat err =       0.000550232390
   target dn stat err =       0.006249515272
      target stat err =       0.005188272812
              std dev =       0.661423060128
             le_variance =       0.437480464469

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437464158820
                                         uncertainty =       0.003935207931

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437464158820
                                         uncertainty =       0.003935207931

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467696730
  error estimate for blocks of size 2^( 2) =       0.000493270864
  error estimate for blocks of size 2^( 3) =       0.000517836221
  error estimate for blocks of size 2^( 4) =       0.000535760165
  error estimate for blocks of size 2^( 5) =       0.000548137882
  error estimate for blocks of size 2^( 6) =       0.000556545143
  error estimate for blocks of size 2^( 7) =       0.000560486374

      target function =      -0.743132361832
              le_mean =     -22.815038775704
             les_mean =     520.978640335400
             stat err =       0.000550232391
             autocorr =       1.384087791637
   target nu stat err =       0.000550232391
   target dn stat err =       0.006249513521
      target stat err =       0.005188271448
              std dev =       0.661423059189
             le_variance =       0.437480463228


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743132362554        initial  <--
     1.4901e+04     1.4901e+05             1.7037e-08        -0.743132351004
     5.9605e+04     5.9605e+05             4.2593e-09        -0.743132356780
     2.3842e+05     2.3842e+06             1.0648e-09        -0.743132361832

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.5543
  </log>
  <optVariables href="FORM2.s029.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620434e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968723e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283312e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250718e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084342e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785796e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872390e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246626e-04 3 1  ON 29
ci_31                 1.001323e-03 3 1  ON 30
ci_32                -6.569574e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185566e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841476e-03 3 1  ON 39
ci_41                -5.607318e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376330e-03 3 1  ON 42
ci_44                -2.230083e-03 3 1  ON 43
ci_45                -2.703697e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681696e-04 3 1  ON 48
ci_50                -7.822034e-04 3 1  ON 49
ci_51                -4.942086e-04 3 1  ON 50
ci_52                -5.953002e-04 3 1  ON 51
ci_53                -7.835994e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645368e-04 3 1  ON 57
ci_59                -5.633215e-04 3 1  ON 58
ci_60                 7.417430e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909002e-04 3 1  ON 61
ci_63                -2.761673e-04 3 1  ON 62
ci_64                -5.992986e-04 3 1  ON 63
ci_65                -4.197956e-05 3 1  ON 64
ci_66                -1.519710e-04 3 1  ON 65
ci_67                -2.334991e-04 3 1  ON 66
ci_68                -1.705168e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4546e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2810e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -22.8886
    reference variance = 0.932735
====================================================
  Execution time = 2.5228e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5344e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4656e-01
  Total weights = 1.964892893e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4834e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433144901037
                                         uncertainty =       0.002391759419

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433144901037
                                         uncertainty =       0.002391759419

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465339825
  error estimate for blocks of size 2^( 2) =       0.000491213245
  error estimate for blocks of size 2^( 3) =       0.000515779627
  error estimate for blocks of size 2^( 4) =       0.000534806251
  error estimate for blocks of size 2^( 5) =       0.000546238346
  error estimate for blocks of size 2^( 6) =       0.000553127922
  error estimate for blocks of size 2^( 7) =       0.000556508105

      target function =      -0.748206685837
              le_mean =     -22.814657805488
             les_mean =     520.955171451624
             stat err =       0.000547670156
             autocorr =       1.385152875626
   target nu stat err =       0.000547670156
   target dn stat err =       0.003457657321
      target stat err =       0.002951896563
              std dev =       0.658089891036
             le_variance =       0.433082304684


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281465780549e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+05, overlap shift 1.4901e+06 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748217376551       residual = 2.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748217376708       residual = 3.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748217376729       residual = 7.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748217376735       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748217376737       residual = 7.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748217376737       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748217376869       residual = 2.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748217376580       residual = 8.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748217376900       residual = 3.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748217376933       residual = 8.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+05 is 1.811891e-09

solving harmonic davidson linear method for identity shift 5.9605e+05, overlap shift 5.9605e+06 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748217376551       residual = 2.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748217376590       residual = 3.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748217376596       residual = 7.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748217376833       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748217376597       residual = 7.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748217376597       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748217376597       residual = 2.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748217376597       residual = 8.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748217376597       residual = 3.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748217376597       residual = 8.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+05 is 4.529728e-10

solving harmonic davidson linear method for identity shift 2.3842e+06, overlap shift 2.3842e+07 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748217376551       residual = 2.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748217376561       residual = 3.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748217376562       residual = 7.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748217376562       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748217376562       residual = 7.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748217376563       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748217376563       residual = 2.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748217376563       residual = 8.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748217376563       residual = 3.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748217378881       residual = 8.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+06 is 1.132432e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.110581 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9721e+01
  </log>
  <optVariables href="FORM2.s030.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620434e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968723e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283312e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250718e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084342e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872390e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246626e-04 3 1  ON 29
ci_31                 1.001323e-03 3 1  ON 30
ci_32                -6.569574e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185566e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841476e-03 3 1  ON 39
ci_41                -5.607319e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376330e-03 3 1  ON 42
ci_44                -2.230083e-03 3 1  ON 43
ci_45                -2.703697e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681696e-04 3 1  ON 48
ci_50                -7.822034e-04 3 1  ON 49
ci_51                -4.942085e-04 3 1  ON 50
ci_52                -5.953002e-04 3 1  ON 51
ci_53                -7.835994e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645369e-04 3 1  ON 57
ci_59                -5.633215e-04 3 1  ON 58
ci_60                 7.417430e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909002e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992984e-04 3 1  ON 63
ci_65                -4.197957e-05 3 1  ON 64
ci_66                -1.519711e-04 3 1  ON 65
ci_67                -2.334991e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -22.84
    reference variance = 0.318339
====================================================
  Execution time = 2.4800e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2813e+01
  VMC Evar = 4.4813e-01
  Total weights = 1.9652e+06
  Execution time = 3.4998e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434376674814
                                         uncertainty =       0.001728148302

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434376674814
                                         uncertainty =       0.001728148302

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466015674
  error estimate for blocks of size 2^( 2) =       0.000492008182
  error estimate for blocks of size 2^( 3) =       0.000517127647
  error estimate for blocks of size 2^( 4) =       0.000535196352
  error estimate for blocks of size 2^( 5) =       0.000547472860
  error estimate for blocks of size 2^( 6) =       0.000554947367
  error estimate for blocks of size 2^( 7) =       0.000556131626

      target function =      -0.746896439342
              le_mean =     -22.812899986285
             les_mean =     520.876537342990
             stat err =       0.000548437051
             autocorr =       1.385008778784
   target nu stat err =       0.000548437051
   target dn stat err =       0.002690391162
      target stat err =       0.002315013920
              std dev =       0.659045686395
             le_variance =       0.434341216756

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434376674840
                                         uncertainty =       0.001728148317

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434376674840
                                         uncertainty =       0.001728148317

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466015674
  error estimate for blocks of size 2^( 2) =       0.000492008182
  error estimate for blocks of size 2^( 3) =       0.000517127647
  error estimate for blocks of size 2^( 4) =       0.000535196352
  error estimate for blocks of size 2^( 5) =       0.000547472860
  error estimate for blocks of size 2^( 6) =       0.000554947367
  error estimate for blocks of size 2^( 7) =       0.000556131626

      target function =      -0.746896440666
              le_mean =     -22.812899986289
             les_mean =     520.876537341596
             stat err =       0.000548437051
             autocorr =       1.385008777346
   target nu stat err =       0.000548437051
   target dn stat err =       0.002690390848
      target stat err =       0.002315013677
              std dev =       0.659045686414
             le_variance =       0.434341216781

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434376674827
                                         uncertainty =       0.001728148309

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434376674827
                                         uncertainty =       0.001728148309

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466015674
  error estimate for blocks of size 2^( 2) =       0.000492008182
  error estimate for blocks of size 2^( 3) =       0.000517127647
  error estimate for blocks of size 2^( 4) =       0.000535196352
  error estimate for blocks of size 2^( 5) =       0.000547472860
  error estimate for blocks of size 2^( 6) =       0.000554947367
  error estimate for blocks of size 2^( 7) =       0.000556131626

      target function =      -0.746896440004
              le_mean =     -22.812899986287
             les_mean =     520.876537342293
             stat err =       0.000548437051
             autocorr =       1.385008778068
   target nu stat err =       0.000548437051
   target dn stat err =       0.002690391005
      target stat err =       0.002315013798
              std dev =       0.659045686405
             le_variance =       0.434341216768

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434376674816
                                         uncertainty =       0.001728148303

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434376674816
                                         uncertainty =       0.001728148303

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466015674
  error estimate for blocks of size 2^( 2) =       0.000492008182
  error estimate for blocks of size 2^( 3) =       0.000517127647
  error estimate for blocks of size 2^( 4) =       0.000535196352
  error estimate for blocks of size 2^( 5) =       0.000547472860
  error estimate for blocks of size 2^( 6) =       0.000554947367
  error estimate for blocks of size 2^( 7) =       0.000556131626

      target function =      -0.746896439425
              le_mean =     -22.812899986285
             les_mean =     520.876537342903
             stat err =       0.000548437051
             autocorr =       1.385008778703
   target nu stat err =       0.000548437051
   target dn stat err =       0.002690391142
      target stat err =       0.002315013905
              std dev =       0.659045686396
             le_variance =       0.434341216757


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746896439342        initial
     1.4901e+05     1.4901e+06             1.8119e-09        -0.746896440666  <--
     5.9605e+05     5.9605e+06             4.5297e-10        -0.746896440004
     2.3842e+06     2.3842e+07             1.1324e-10        -0.746896439425

*****************************************************************************
Applying the update for shift_i =   1.4901e+05     and shift_s =   1.4901e+06
*****************************************************************************

  Execution time = 4.2306e+01
  </log>
  <optVariables href="FORM2.s030.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2033e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2812e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -22.7904
    reference variance = 0.524371
====================================================
  Execution time = 2.6122e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5336e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4660e-01
  Total weights = 1.964767910e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.8040e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434563202267
                                         uncertainty =       0.001938926036

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434563202267
                                         uncertainty =       0.001938926036

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466162515
  error estimate for blocks of size 2^( 2) =       0.000492266387
  error estimate for blocks of size 2^( 3) =       0.000516978340
  error estimate for blocks of size 2^( 4) =       0.000535914734
  error estimate for blocks of size 2^( 5) =       0.000547887328
  error estimate for blocks of size 2^( 6) =       0.000555209928
  error estimate for blocks of size 2^( 7) =       0.000555952947

      target function =      -0.748170884062
              le_mean =     -22.813627683153
             les_mean =     520.908212865727
             stat err =       0.000548741234
             autocorr =       1.385672170384
   target nu stat err =       0.000548741234
   target dn stat err =       0.002518352776
      target stat err =       0.002187173468
              std dev =       0.659253351494
             le_variance =       0.434614981456


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281362768315e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+04, overlap shift 3.7253e+05 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748176230204       residual = 3.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748176230828       residual = 4.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748176230909       residual = 6.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748176230930       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748176230934       residual = 7.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748176230924       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748176230992       residual = 3.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748176230928       residual = 4.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748176230863       residual = 8.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+04 is 5.137728e-09

solving harmonic davidson linear method for identity shift 1.4901e+05, overlap shift 1.4901e+06 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748176230204       residual = 3.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748176230360       residual = 4.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748176230380       residual = 6.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748176230384       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748176230412       residual = 7.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748176230245       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748176230323       residual = 3.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748176230436       residual = 4.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748176230689       residual = 8.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+05 is 1.284433e-09

solving harmonic davidson linear method for identity shift 5.9605e+05, overlap shift 5.9605e+06 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748176230204       residual = 3.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748176230243       residual = 4.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748176230248       residual = 6.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748176230276       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748176230496       residual = 7.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748176230422       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748176230250       residual = 3.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748176230433       residual = 4.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748176231123       residual = 8.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+05 is 3.211082e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.113666 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0935e+01
  </log>
  <optVariables href="FORM2.s031.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430070e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313775e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096166e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980068e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331341e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246628e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412164e-04 3 1  ON 36
ci_38                -2.597117e-04 3 1  ON 37
ci_39                -1.577522e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607323e-04 3 1  ON 40
ci_42                -1.608174e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889673e-03 3 1  ON 47
ci_49                -8.681695e-04 3 1  ON 48
ci_50                -7.822034e-04 3 1  ON 49
ci_51                -4.942081e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835994e-04 3 1  ON 52
ci_54                -1.101465e-03 3 1  ON 53
ci_55                -1.210923e-03 3 1  ON 54
ci_56                 1.132791e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645376e-04 3 1  ON 57
ci_59                -5.633215e-04 3 1  ON 58
ci_60                 7.417417e-05 3 1  ON 59
ci_61                -1.004317e-03 3 1  ON 60
ci_62                -3.909003e-04 3 1  ON 61
ci_63                -2.761671e-04 3 1  ON 62
ci_64                -5.992979e-04 3 1  ON 63
ci_65                -4.197978e-05 3 1  ON 64
ci_66                -1.519713e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -22.7433
    reference variance = 0.339839
====================================================
  Execution time = 2.5428e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4520e-01
  Total weights = 1.9649e+06
  Execution time = 3.5086e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433222468832
                                         uncertainty =       0.002151992325

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433222468832
                                         uncertainty =       0.002151992325

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465405423
  error estimate for blocks of size 2^( 2) =       0.000491290591
  error estimate for blocks of size 2^( 3) =       0.000515914521
  error estimate for blocks of size 2^( 4) =       0.000533305907
  error estimate for blocks of size 2^( 5) =       0.000545355601
  error estimate for blocks of size 2^( 6) =       0.000552007482
  error estimate for blocks of size 2^( 7) =       0.000556979535

      target function =      -0.749351038264
              le_mean =     -22.814048933562
             les_mean =     520.926023812222
             stat err =       0.000546912131
             autocorr =       1.380931811039
   target nu stat err =       0.000546912131
   target dn stat err =       0.002474995981
      target stat err =       0.002159784563
              std dev =       0.658182661540
             le_variance =       0.433204415952

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433222468518
                                         uncertainty =       0.002151992385

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433222468518
                                         uncertainty =       0.002151992385

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465405423
  error estimate for blocks of size 2^( 2) =       0.000491290590
  error estimate for blocks of size 2^( 3) =       0.000515914520
  error estimate for blocks of size 2^( 4) =       0.000533305905
  error estimate for blocks of size 2^( 5) =       0.000545355600
  error estimate for blocks of size 2^( 6) =       0.000552007481
  error estimate for blocks of size 2^( 7) =       0.000556979534

      target function =      -0.749350839483
              le_mean =     -22.814048933532
             les_mean =     520.926024048305
             stat err =       0.000546912130
             autocorr =       1.380931805456
   target nu stat err =       0.000546912130
   target dn stat err =       0.002475005599
      target stat err =       0.002159791184
              std dev =       0.658182661298
             le_variance =       0.433204415633

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433222468675
                                         uncertainty =       0.002151992355

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433222468675
                                         uncertainty =       0.002151992355

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465405423
  error estimate for blocks of size 2^( 2) =       0.000491290591
  error estimate for blocks of size 2^( 3) =       0.000515914521
  error estimate for blocks of size 2^( 4) =       0.000533305906
  error estimate for blocks of size 2^( 5) =       0.000545355600
  error estimate for blocks of size 2^( 6) =       0.000552007482
  error estimate for blocks of size 2^( 7) =       0.000556979535

      target function =      -0.749350938959
              le_mean =     -22.814048933547
             les_mean =     520.926023930162
             stat err =       0.000546912131
             autocorr =       1.380931808243
   target nu stat err =       0.000546912131
   target dn stat err =       0.002475000783
      target stat err =       0.002159787869
              std dev =       0.658182661419
             le_variance =       0.433204415792

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433222468812
                                         uncertainty =       0.002151992328

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433222468812
                                         uncertainty =       0.002151992328

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465405423
  error estimate for blocks of size 2^( 2) =       0.000491290591
  error estimate for blocks of size 2^( 3) =       0.000515914521
  error estimate for blocks of size 2^( 4) =       0.000533305907
  error estimate for blocks of size 2^( 5) =       0.000545355601
  error estimate for blocks of size 2^( 6) =       0.000552007482
  error estimate for blocks of size 2^( 7) =       0.000556979535

      target function =      -0.749351025860
              le_mean =     -22.814048933560
             les_mean =     520.926023826953
             stat err =       0.000546912131
             autocorr =       1.380931810690
   target nu stat err =       0.000546912131
   target dn stat err =       0.002474996581
      target stat err =       0.002159784976
              std dev =       0.658182661525
             le_variance =       0.433204415932


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.749351038264        initial  <--
     3.7253e+04     3.7253e+05             5.1377e-09        -0.749350839483
     1.4901e+05     1.4901e+06             1.2844e-09        -0.749350938959
     5.9605e+05     5.9605e+06             3.2111e-10        -0.749351025860

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.0414
  </log>
  <optVariables href="FORM2.s031.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3983e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2811e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -22.8796
    reference variance = 0.415594
====================================================
  Execution time = 2.5361e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5344e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5309e-01
  Total weights = 1.964347178e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5137e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438345486449
                                         uncertainty =       0.002259899143

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438345486449
                                         uncertainty =       0.002259899143

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468169639
  error estimate for blocks of size 2^( 2) =       0.000493929720
  error estimate for blocks of size 2^( 3) =       0.000518308257
  error estimate for blocks of size 2^( 4) =       0.000535770223
  error estimate for blocks of size 2^( 5) =       0.000547675878
  error estimate for blocks of size 2^( 6) =       0.000552357047
  error estimate for blocks of size 2^( 7) =       0.000555506238

      target function =      -0.742799475482
              le_mean =     -22.814181828448
             les_mean =     520.939977875592
             stat err =       0.000547827347
             autocorr =       1.369244241644
   target nu stat err =       0.000547827347
   target dn stat err =       0.003378513581
      target stat err =       0.002844624750
              std dev =       0.662091853227
             le_variance =       0.438365622110


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281418182845e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+05, overlap shift 3.7253e+06 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742809203524       residual = 1.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742809203565       residual = 2.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742809203572       residual = 4.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742809203573       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742809203462       residual = 4.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742809203599       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742809204388       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742809203429       residual = 2.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742809204675       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742809203846       residual = 3.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+05 is 4.671382e-10

solving harmonic davidson linear method for identity shift 1.4901e+06, overlap shift 1.4901e+07 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742809203524       residual = 1.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742809203534       residual = 2.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742809203536       residual = 4.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742809203957       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742809203455       residual = 4.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742809202541       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742809207379       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742809205353       residual = 2.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742809203973       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742809204783       residual = 3.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+06 is 1.167846e-10

solving harmonic davidson linear method for identity shift 5.9605e+06, overlap shift 5.9605e+07 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742809203524       residual = 1.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742809203526       residual = 2.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742809203527       residual = 4.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742809203527       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742809203527       residual = 4.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742809204190       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742809203527       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742809202133       residual = 2.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742809212418       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742809186734       residual = 3.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+06 is 2.919614e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.117268 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9884e+01
  </log>
  <optVariables href="FORM2.s032.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096166e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872390e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246628e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703700e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681695e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942081e-04 3 1  ON 50
ci_52                -5.952999e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417427e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761675e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -22.9051
    reference variance = 0.644089
====================================================
  Execution time = 2.4642e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4515e-01
  Total weights = 1.9648e+06
  Execution time = 3.5203e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433232247016
                                         uncertainty =       0.002152557470

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433232247016
                                         uncertainty =       0.002152557470

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465425414
  error estimate for blocks of size 2^( 2) =       0.000491117329
  error estimate for blocks of size 2^( 3) =       0.000515700585
  error estimate for blocks of size 2^( 4) =       0.000534673723
  error estimate for blocks of size 2^( 5) =       0.000546871258
  error estimate for blocks of size 2^( 6) =       0.000553919130
  error estimate for blocks of size 2^( 7) =       0.000556306898

      target function =      -0.749393066378
              le_mean =     -22.814646039745
             les_mean =     520.953221621702
             stat err =       0.000547942752
             autocorr =       1.386022197220
   target nu stat err =       0.000547942752
   target dn stat err =       0.002701057538
      target stat err =       0.002344528931
              std dev =       0.658210933039
             le_variance =       0.433241632372

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433232246991
                                         uncertainty =       0.002152557471

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433232246991
                                         uncertainty =       0.002152557471

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465425414
  error estimate for blocks of size 2^( 2) =       0.000491117329
  error estimate for blocks of size 2^( 3) =       0.000515700585
  error estimate for blocks of size 2^( 4) =       0.000534673723
  error estimate for blocks of size 2^( 5) =       0.000546871258
  error estimate for blocks of size 2^( 6) =       0.000553919130
  error estimate for blocks of size 2^( 7) =       0.000556306898

      target function =      -0.749393065925
              le_mean =     -22.814646039745
             les_mean =     520.953221622243
             stat err =       0.000547942752
             autocorr =       1.386022196619
   target nu stat err =       0.000547942752
   target dn stat err =       0.002701057607
      target stat err =       0.002344528984
              std dev =       0.658210933020
             le_variance =       0.433241632347

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433232247003
                                         uncertainty =       0.002152557471

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433232247003
                                         uncertainty =       0.002152557471

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465425414
  error estimate for blocks of size 2^( 2) =       0.000491117329
  error estimate for blocks of size 2^( 3) =       0.000515700585
  error estimate for blocks of size 2^( 4) =       0.000534673723
  error estimate for blocks of size 2^( 5) =       0.000546871258
  error estimate for blocks of size 2^( 6) =       0.000553919130
  error estimate for blocks of size 2^( 7) =       0.000556306898

      target function =      -0.749393066151
              le_mean =     -22.814646039745
             les_mean =     520.953221621972
             stat err =       0.000547942752
             autocorr =       1.386022196916
   target nu stat err =       0.000547942752
   target dn stat err =       0.002701057572
      target stat err =       0.002344528958
              std dev =       0.658210933029
             le_variance =       0.433241632359

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433232247014
                                         uncertainty =       0.002152557470

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433232247014
                                         uncertainty =       0.002152557470

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465425414
  error estimate for blocks of size 2^( 2) =       0.000491117329
  error estimate for blocks of size 2^( 3) =       0.000515700585
  error estimate for blocks of size 2^( 4) =       0.000534673723
  error estimate for blocks of size 2^( 5) =       0.000546871258
  error estimate for blocks of size 2^( 6) =       0.000553919130
  error estimate for blocks of size 2^( 7) =       0.000556306898

      target function =      -0.749393066349
              le_mean =     -22.814646039745
             les_mean =     520.953221621736
             stat err =       0.000547942752
             autocorr =       1.386022197183
   target nu stat err =       0.000547942752
   target dn stat err =       0.002701057542
      target stat err =       0.002344528935
              std dev =       0.658210933037
             le_variance =       0.433241632370


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.749393066378        initial  <--
     3.7253e+05     3.7253e+06             4.6714e-10        -0.749393065925
     1.4901e+06     1.4901e+07             1.1678e-10        -0.749393066151
     5.9605e+06     5.9605e+07             2.9196e-11        -0.749393066349

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.2186
  </log>
  <optVariables href="FORM2.s032.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2109e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2813e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -22.7971
    reference variance = 0.272537
====================================================
  Execution time = 2.5271e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5351e+04
  VMC Eavg = -2.2816e+01
  VMC Evar = 4.6889e-01
  Total weights = 1.964869384e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6882e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440548044176
                                         uncertainty =       0.002261471651

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440548044176
                                         uncertainty =       0.002261471651

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469279978
  error estimate for blocks of size 2^( 2) =       0.000495268826
  error estimate for blocks of size 2^( 3) =       0.000519346031
  error estimate for blocks of size 2^( 4) =       0.000537408668
  error estimate for blocks of size 2^( 5) =       0.000549010683
  error estimate for blocks of size 2^( 6) =       0.000556245522
  error estimate for blocks of size 2^( 7) =       0.000557927042

      target function =      -0.729799369267
              le_mean =     -22.815814300355
             les_mean =     521.030268544667
             stat err =       0.000550147979
             autocorr =       1.374342550726
   target nu stat err =       0.000550147979
   target dn stat err =       0.015052940891
      target stat err =       0.012000212786
              std dev =       0.663662109366
             le_variance =       0.440447395409


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281581430036e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+06, overlap shift 3.7253e+07 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.729995689018       residual = 3.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.729995689027       residual = 7.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.729995689029       residual = 1.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.729995689030       residual = 6.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.729995689030       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.729995692441       residual = 4.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.729995687186       residual = 4.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.729995682578       residual = 6.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.729995680420       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.729995690248       residual = 7.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+06 is 1.690498e-10

solving harmonic davidson linear method for identity shift 1.4901e+07, overlap shift 1.4901e+08 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.729995689018       residual = 3.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.729995689020       residual = 7.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.729995689021       residual = 1.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.729995689021       residual = 6.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.729995689021       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.729995689021       residual = 4.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.729995689021       residual = 4.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.729995689021       residual = 6.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.729995689021       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.729995713500       residual = 7.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+07 is 4.226272e-11

solving harmonic davidson linear method for identity shift 5.9605e+07, overlap shift 5.9605e+08 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.729995689018       residual = 3.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.729995689018       residual = 7.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.729995689018       residual = 1.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.729995689018       residual = 6.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.729995677140       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.729995736405       residual = 4.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.729995721954       residual = 4.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.729995773179       residual = 6.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.729995814981       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.729995581031       residual = 6.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+07 is 1.056548e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.120857 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2880e+01
  </log>
  <optVariables href="FORM2.s033.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872390e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822034e-04 3 1  ON 49
ci_51                -4.942081e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417429e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197961e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -22.7583
    reference variance = 0.308134
====================================================
  Execution time = 2.4523e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4837e-01
  Total weights = 1.9647e+06
  Execution time = 3.4831e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435661029460
                                         uncertainty =       0.002070913355

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435661029460
                                         uncertainty =       0.002070913355

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466693582
  error estimate for blocks of size 2^( 2) =       0.000492564708
  error estimate for blocks of size 2^( 3) =       0.000516433495
  error estimate for blocks of size 2^( 4) =       0.000534233598
  error estimate for blocks of size 2^( 5) =       0.000546624214
  error estimate for blocks of size 2^( 6) =       0.000552580956
  error estimate for blocks of size 2^( 7) =       0.000555408662

      target function =      -0.746700124685
              le_mean =     -22.814643032318
             les_mean =     520.956309263912
             stat err =       0.000547211857
             autocorr =       1.374824750783
   target nu stat err =       0.000547211857
   target dn stat err =       0.002844540035
      target stat err =       0.002443450730
              std dev =       0.660004393114
             le_variance =       0.435605798930

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435661029464
                                         uncertainty =       0.002070913353

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435661029464
                                         uncertainty =       0.002070913353

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466693582
  error estimate for blocks of size 2^( 2) =       0.000492564708
  error estimate for blocks of size 2^( 3) =       0.000516433495
  error estimate for blocks of size 2^( 4) =       0.000534233598
  error estimate for blocks of size 2^( 5) =       0.000546624214
  error estimate for blocks of size 2^( 6) =       0.000552580956
  error estimate for blocks of size 2^( 7) =       0.000555408662

      target function =      -0.746700124657
              le_mean =     -22.814643032318
             les_mean =     520.956309263946
             stat err =       0.000547211857
             autocorr =       1.374824750713
   target nu stat err =       0.000547211857
   target dn stat err =       0.002844540036
      target stat err =       0.002443450731
              std dev =       0.660004393117
             le_variance =       0.435605798933

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435661029462
                                         uncertainty =       0.002070913354

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435661029462
                                         uncertainty =       0.002070913354

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466693582
  error estimate for blocks of size 2^( 2) =       0.000492564708
  error estimate for blocks of size 2^( 3) =       0.000516433495
  error estimate for blocks of size 2^( 4) =       0.000534233598
  error estimate for blocks of size 2^( 5) =       0.000546624214
  error estimate for blocks of size 2^( 6) =       0.000552580956
  error estimate for blocks of size 2^( 7) =       0.000555408662

      target function =      -0.746700124671
              le_mean =     -22.814643032318
             les_mean =     520.956309263929
             stat err =       0.000547211857
             autocorr =       1.374824750755
   target nu stat err =       0.000547211857
   target dn stat err =       0.002844540035
      target stat err =       0.002443450730
              std dev =       0.660004393115
             le_variance =       0.435605798931

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435661029460
                                         uncertainty =       0.002070913355

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435661029460
                                         uncertainty =       0.002070913355

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466693582
  error estimate for blocks of size 2^( 2) =       0.000492564708
  error estimate for blocks of size 2^( 3) =       0.000516433495
  error estimate for blocks of size 2^( 4) =       0.000534233598
  error estimate for blocks of size 2^( 5) =       0.000546624214
  error estimate for blocks of size 2^( 6) =       0.000552580956
  error estimate for blocks of size 2^( 7) =       0.000555408662

      target function =      -0.746700124683
              le_mean =     -22.814643032318
             les_mean =     520.956309263914
             stat err =       0.000547211857
             autocorr =       1.374824750785
   target nu stat err =       0.000547211857
   target dn stat err =       0.002844540035
      target stat err =       0.002443450730
              std dev =       0.660004393114
             le_variance =       0.435605798930


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746700124685        initial  <--
     3.7253e+06     3.7253e+07             1.6905e-10        -0.746700124657
     1.4901e+07     1.4901e+08             4.2263e-11        -0.746700124671
     5.9605e+07     5.9605e+08             1.0565e-11        -0.746700124683

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 41.9654
  </log>
  <optVariables href="FORM2.s033.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4853e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2812e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -22.84
    reference variance = 0.341805
====================================================
  Execution time = 2.5075e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5395e+04
  VMC Eavg = -2.2813e+01
  VMC Evar = 4.4898e-01
  Total weights = 1.964943080e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5356e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437978230512
                                         uncertainty =       0.002328555164

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437978230512
                                         uncertainty =       0.002328555164

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467979884
  error estimate for blocks of size 2^( 2) =       0.000493654163
  error estimate for blocks of size 2^( 3) =       0.000518149040
  error estimate for blocks of size 2^( 4) =       0.000535588111
  error estimate for blocks of size 2^( 5) =       0.000547148463
  error estimate for blocks of size 2^( 6) =       0.000553888052
  error estimate for blocks of size 2^( 7) =       0.000556222120

      target function =      -0.746194474429
              le_mean =     -22.813422702495
             les_mean =     520.901234890271
             stat err =       0.000548211686
             autocorr =       1.372278339583
   target nu stat err =       0.000548211686
   target dn stat err =       0.002722204803
      target stat err =       0.002338007095
              std dev =       0.661823498247
             le_variance =       0.438010342831


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281342270249e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+07, overlap shift 3.7253e+08 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746200853871       residual = 2.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746200853872       residual = 3.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746200853872       residual = 7.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746200853872       residual = 3.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746200853872       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746200873152       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746200883225       residual = 2.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746200837749       residual = 5.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746200869659       residual = 2.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746200874776       residual = 6.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+07 is 8.787868e-12

solving harmonic davidson linear method for identity shift 1.4901e+08, overlap shift 1.4901e+09 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746200853871       residual = 2.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746200853871       residual = 3.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746200853871       residual = 7.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746200853871       residual = 3.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746200853871       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746200853846       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746200684129       residual = 2.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746201014344       residual = 5.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746200588626       residual = 2.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746200791949       residual = 7.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+08 is 2.196920e-12

solving harmonic davidson linear method for identity shift 5.9605e+08, overlap shift 5.9605e+09 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746200853871       residual = 2.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746200853871       residual = 3.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746200853871       residual = 7.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746200853871       residual = 3.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746200853872       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746200488943       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746200851031       residual = 2.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746201156624       residual = 5.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746201038916       residual = 2.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746199851561       residual = 7.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+08 is 5.492706e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.124409 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9620e+01
  </log>
  <optVariables href="FORM2.s034.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -22.8225
    reference variance = 0.412156
====================================================
  Execution time = 2.4576e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4658e-01
  Total weights = 1.9652e+06
  Execution time = 3.4884e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435850182274
                                         uncertainty =       0.002262322054

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435850182274
                                         uncertainty =       0.002262322054

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466845461
  error estimate for blocks of size 2^( 2) =       0.000493031598
  error estimate for blocks of size 2^( 3) =       0.000517411896
  error estimate for blocks of size 2^( 4) =       0.000535944848
  error estimate for blocks of size 2^( 5) =       0.000548089434
  error estimate for blocks of size 2^( 6) =       0.000555118184
  error estimate for blocks of size 2^( 7) =       0.000559440783

      target function =      -0.748190734547
              le_mean =     -22.813510276434
             les_mean =     520.902830416826
             stat err =       0.000549648312
             autocorr =       1.386192408381
   target nu stat err =       0.000549648312
   target dn stat err =       0.002671549375
      target stat err =       0.002310081534
              std dev =       0.660219182594
             le_variance =       0.435889369064

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435850182274
                                         uncertainty =       0.002262322054

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435850182274
                                         uncertainty =       0.002262322054

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466845461
  error estimate for blocks of size 2^( 2) =       0.000493031598
  error estimate for blocks of size 2^( 3) =       0.000517411896
  error estimate for blocks of size 2^( 4) =       0.000535944848
  error estimate for blocks of size 2^( 5) =       0.000548089434
  error estimate for blocks of size 2^( 6) =       0.000555118184
  error estimate for blocks of size 2^( 7) =       0.000559440783

      target function =      -0.748190734549
              le_mean =     -22.813510276434
             les_mean =     520.902830416826
             stat err =       0.000549648312
             autocorr =       1.386192408376
   target nu stat err =       0.000549648312
   target dn stat err =       0.002671549375
      target stat err =       0.002310081534
              std dev =       0.660219182593
             le_variance =       0.435889369064

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435850182274
                                         uncertainty =       0.002262322054

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435850182274
                                         uncertainty =       0.002262322054

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466845461
  error estimate for blocks of size 2^( 2) =       0.000493031598
  error estimate for blocks of size 2^( 3) =       0.000517411896
  error estimate for blocks of size 2^( 4) =       0.000535944848
  error estimate for blocks of size 2^( 5) =       0.000548089434
  error estimate for blocks of size 2^( 6) =       0.000555118184
  error estimate for blocks of size 2^( 7) =       0.000559440783

      target function =      -0.748190734548
              le_mean =     -22.813510276434
             les_mean =     520.902830416826
             stat err =       0.000549648312
             autocorr =       1.386192408380
   target nu stat err =       0.000549648312
   target dn stat err =       0.002671549375
      target stat err =       0.002310081534
              std dev =       0.660219182593
             le_variance =       0.435889369064

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435850182274
                                         uncertainty =       0.002262322054

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435850182274
                                         uncertainty =       0.002262322054

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466845461
  error estimate for blocks of size 2^( 2) =       0.000493031598
  error estimate for blocks of size 2^( 3) =       0.000517411896
  error estimate for blocks of size 2^( 4) =       0.000535944848
  error estimate for blocks of size 2^( 5) =       0.000548089434
  error estimate for blocks of size 2^( 6) =       0.000555118184
  error estimate for blocks of size 2^( 7) =       0.000559440783

      target function =      -0.748190734548
              le_mean =     -22.813510276434
             les_mean =     520.902830416826
             stat err =       0.000549648312
             autocorr =       1.386192408378
   target nu stat err =       0.000549648312
   target dn stat err =       0.002671549375
      target stat err =       0.002310081534
              std dev =       0.660219182593
             le_variance =       0.435889369064


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748190734547        initial
     3.7253e+07     3.7253e+08             8.7879e-12        -0.748190734549  <--
     1.4901e+08     1.4901e+09             2.1969e-12        -0.748190734548
     5.9605e+08     5.9605e+09             5.4927e-13        -0.748190734548

*****************************************************************************
Applying the update for shift_i =   3.7253e+07     and shift_s =   3.7253e+08
*****************************************************************************

  Execution time = 4.2128e+01
  </log>
  <optVariables href="FORM2.s034.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.1755e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2813e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -22.8594
    reference variance = 0.630958
====================================================
  Execution time = 2.5136e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5334e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4847e-01
  Total weights = 1.964701470e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5203e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436295256795
                                         uncertainty =       0.002318953733

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436295256795
                                         uncertainty =       0.002318953733

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467070361
  error estimate for blocks of size 2^( 2) =       0.000493097297
  error estimate for blocks of size 2^( 3) =       0.000518347432
  error estimate for blocks of size 2^( 4) =       0.000537330866
  error estimate for blocks of size 2^( 5) =       0.000548914893
  error estimate for blocks of size 2^( 6) =       0.000555395340
  error estimate for blocks of size 2^( 7) =       0.000559375603

      target function =      -0.746615642801
              le_mean =     -22.814544167722
             les_mean =     520.951899463145
             stat err =       0.000550254175
             autocorr =       1.387912461175
   target nu stat err =       0.000550254175
   target dn stat err =       0.002865991702
      target stat err =       0.002460674237
              std dev =       0.660537239188
             le_variance =       0.436309444354


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281454416772e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+06, overlap shift 9.3132e+07 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746622689711       residual = 1.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746622689713       residual = 2.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746622689713       residual = 8.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746622689713       residual = 3.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746622689713       residual = 8.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746622689782       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746622693031       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746622688936       residual = 3.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746622700034       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746622698254       residual = 4.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+06 is 3.789895e-11

solving harmonic davidson linear method for identity shift 3.7253e+07, overlap shift 3.7253e+08 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746622689711       residual = 1.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746622689712       residual = 2.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746622689712       residual = 8.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746622689712       residual = 3.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746622689712       residual = 8.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746622718107       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746622738108       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746622676233       residual = 3.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746622740250       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746622784986       residual = 4.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+07 is 9.474551e-12

solving harmonic davidson linear method for identity shift 1.4901e+08, overlap shift 1.4901e+09 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746622689711       residual = 1.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746622689711       residual = 2.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746622689711       residual = 8.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746622689711       residual = 3.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746622689711       residual = 8.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746622689711       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746622714896       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746622540683       residual = 3.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746622872395       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746622834970       residual = 4.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+08 is 2.368698e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.127974 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9666e+01
  </log>
  <optVariables href="FORM2.s035.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -22.829
    reference variance = 0.426002
====================================================
  Execution time = 2.6613e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4897e-01
  Total weights = 1.9646e+06
  Execution time = 3.5059e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436106345515
                                         uncertainty =       0.001963219964

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436106345515
                                         uncertainty =       0.001963219964

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466966383
  error estimate for blocks of size 2^( 2) =       0.000492706111
  error estimate for blocks of size 2^( 3) =       0.000516870970
  error estimate for blocks of size 2^( 4) =       0.000535118460
  error estimate for blocks of size 2^( 5) =       0.000546623296
  error estimate for blocks of size 2^( 6) =       0.000552527375
  error estimate for blocks of size 2^( 7) =       0.000556185343

      target function =      -0.746203012272
              le_mean =     -22.813788275870
             les_mean =     520.917906344470
             stat err =       0.000547613619
             autocorr =       1.375236047596
   target nu stat err =       0.000547613619
   target dn stat err =       0.002614855289
      target stat err =       0.002253282190
              std dev =       0.660390191420
             le_variance =       0.436115204924

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436106345511
                                         uncertainty =       0.001963219964

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436106345511
                                         uncertainty =       0.001963219964

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466966383
  error estimate for blocks of size 2^( 2) =       0.000492706111
  error estimate for blocks of size 2^( 3) =       0.000516870970
  error estimate for blocks of size 2^( 4) =       0.000535118460
  error estimate for blocks of size 2^( 5) =       0.000546623296
  error estimate for blocks of size 2^( 6) =       0.000552527375
  error estimate for blocks of size 2^( 7) =       0.000556185343

      target function =      -0.746203012266
              le_mean =     -22.813788275870
             les_mean =     520.917906344479
             stat err =       0.000547613619
             autocorr =       1.375236047573
   target nu stat err =       0.000547613619
   target dn stat err =       0.002614855289
      target stat err =       0.002253282190
              std dev =       0.660390191417
             le_variance =       0.436115204920

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436106345513
                                         uncertainty =       0.001963219964

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436106345513
                                         uncertainty =       0.001963219964

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466966383
  error estimate for blocks of size 2^( 2) =       0.000492706111
  error estimate for blocks of size 2^( 3) =       0.000516870970
  error estimate for blocks of size 2^( 4) =       0.000535118460
  error estimate for blocks of size 2^( 5) =       0.000546623296
  error estimate for blocks of size 2^( 6) =       0.000552527375
  error estimate for blocks of size 2^( 7) =       0.000556185343

      target function =      -0.746203012269
              le_mean =     -22.813788275870
             les_mean =     520.917906344475
             stat err =       0.000547613619
             autocorr =       1.375236047585
   target nu stat err =       0.000547613619
   target dn stat err =       0.002614855289
      target stat err =       0.002253282190
              std dev =       0.660390191418
             le_variance =       0.436115204921

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436106345514
                                         uncertainty =       0.001963219964

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436106345514
                                         uncertainty =       0.001963219964

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466966383
  error estimate for blocks of size 2^( 2) =       0.000492706111
  error estimate for blocks of size 2^( 3) =       0.000516870970
  error estimate for blocks of size 2^( 4) =       0.000535118460
  error estimate for blocks of size 2^( 5) =       0.000546623296
  error estimate for blocks of size 2^( 6) =       0.000552527375
  error estimate for blocks of size 2^( 7) =       0.000556185343

      target function =      -0.746203012272
              le_mean =     -22.813788275870
             les_mean =     520.917906344471
             stat err =       0.000547613619
             autocorr =       1.375236047598
   target nu stat err =       0.000547613619
   target dn stat err =       0.002614855289
      target stat err =       0.002253282190
              std dev =       0.660390191420
             le_variance =       0.436115204923


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746203012272        initial  <--
     9.3132e+06     9.3132e+07             3.7899e-11        -0.746203012266
     3.7253e+07     3.7253e+08             9.4746e-12        -0.746203012269
     1.4901e+08     1.4901e+09             2.3687e-12        -0.746203012272

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.1314
  </log>
  <optVariables href="FORM2.s035.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3804e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2813e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -22.8892
    reference variance = 0.427575
====================================================
  Execution time = 2.5217e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5361e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4185e-01
  Total weights = 1.964896524e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5131e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431412227474
                                         uncertainty =       0.001609867726

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431412227474
                                         uncertainty =       0.001609867726

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464480031
  error estimate for blocks of size 2^( 2) =       0.000490114746
  error estimate for blocks of size 2^( 3) =       0.000514601096
  error estimate for blocks of size 2^( 4) =       0.000533136258
  error estimate for blocks of size 2^( 5) =       0.000545250529
  error estimate for blocks of size 2^( 6) =       0.000550834830
  error estimate for blocks of size 2^( 7) =       0.000555001323

      target function =      -0.752162786413
              le_mean =     -22.814224246504
             les_mean =     520.930680127399
             stat err =       0.000546055735
             autocorr =       1.382101222042
   target nu stat err =       0.000546055735
   target dn stat err =       0.002143111817
      target stat err =       0.001908662079
              std dev =       0.656873958986
             le_variance =       0.431483397993


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281422424650e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+07, overlap shift 9.3132e+08 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.752166644290       residual = 2.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.752166644291       residual = 2.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.752166644291       residual = 4.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.752166644291       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.752166644291       residual = 6.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.752166634498       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.752166597574       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.752166660983       residual = 2.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.752166768991       residual = 4.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+07 is 2.090082e-12

solving harmonic davidson linear method for identity shift 3.7253e+08, overlap shift 3.7253e+09 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.752166644290       residual = 2.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.752166644290       residual = 2.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.752166644290       residual = 4.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.752166644290       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.752166644294       residual = 6.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.752166571781       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.752166342433       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.752165600056       residual = 2.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.752166882946       residual = 5.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+08 is 5.225967e-13

solving harmonic davidson linear method for identity shift 1.4901e+09, overlap shift 1.4901e+10 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.752166644290       residual = 2.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.752166644290       residual = 2.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.752166644290       residual = 4.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.752166644290       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.752166644290       residual = 6.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.752166646258       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.752166645708       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.752167930714       residual = 2.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.752170442238       residual = 4.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+09 is 1.305555e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.131089 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9738e+01
  </log>
  <optVariables href="FORM2.s036.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -22.777
    reference variance = 0.329258
====================================================
  Execution time = 2.4878e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4798e-01
  Total weights = 1.9649e+06
  Execution time = 3.5045e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436054828599
                                         uncertainty =       0.001908115184

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436054828599
                                         uncertainty =       0.001908115184

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466903773
  error estimate for blocks of size 2^( 2) =       0.000492462340
  error estimate for blocks of size 2^( 3) =       0.000516877142
  error estimate for blocks of size 2^( 4) =       0.000535577043
  error estimate for blocks of size 2^( 5) =       0.000547422984
  error estimate for blocks of size 2^( 6) =       0.000556233433
  error estimate for blocks of size 2^( 7) =       0.000561358980

      target function =      -0.747024827512
              le_mean =     -22.813664887907
             les_mean =     520.911286987074
             stat err =       0.000550148110
             autocorr =       1.388367646643
   target nu stat err =       0.000550148110
   target dn stat err =       0.002539102911
      target stat err =       0.002197862081
              std dev =       0.660301647533
             le_variance =       0.435998265734

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436054828599
                                         uncertainty =       0.001908115184

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436054828599
                                         uncertainty =       0.001908115184

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466903773
  error estimate for blocks of size 2^( 2) =       0.000492462340
  error estimate for blocks of size 2^( 3) =       0.000516877142
  error estimate for blocks of size 2^( 4) =       0.000535577043
  error estimate for blocks of size 2^( 5) =       0.000547422984
  error estimate for blocks of size 2^( 6) =       0.000556233433
  error estimate for blocks of size 2^( 7) =       0.000561358980

      target function =      -0.747024827497
              le_mean =     -22.813664887907
             les_mean =     520.911286987091
             stat err =       0.000550148110
             autocorr =       1.388367646637
   target nu stat err =       0.000550148110
   target dn stat err =       0.002539102916
      target stat err =       0.002197862085
              std dev =       0.660301647533
             le_variance =       0.435998265735

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436054828599
                                         uncertainty =       0.001908115184

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436054828599
                                         uncertainty =       0.001908115184

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466903773
  error estimate for blocks of size 2^( 2) =       0.000492462340
  error estimate for blocks of size 2^( 3) =       0.000516877142
  error estimate for blocks of size 2^( 4) =       0.000535577043
  error estimate for blocks of size 2^( 5) =       0.000547422984
  error estimate for blocks of size 2^( 6) =       0.000556233433
  error estimate for blocks of size 2^( 7) =       0.000561358980

      target function =      -0.747024827504
              le_mean =     -22.813664887907
             les_mean =     520.911286987083
             stat err =       0.000550148110
             autocorr =       1.388367646647
   target nu stat err =       0.000550148110
   target dn stat err =       0.002539102913
      target stat err =       0.002197862083
              std dev =       0.660301647533
             le_variance =       0.435998265735

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436054828599
                                         uncertainty =       0.001908115184

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436054828599
                                         uncertainty =       0.001908115184

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466903773
  error estimate for blocks of size 2^( 2) =       0.000492462340
  error estimate for blocks of size 2^( 3) =       0.000516877142
  error estimate for blocks of size 2^( 4) =       0.000535577043
  error estimate for blocks of size 2^( 5) =       0.000547422984
  error estimate for blocks of size 2^( 6) =       0.000556233433
  error estimate for blocks of size 2^( 7) =       0.000561358980

      target function =      -0.747024827511
              le_mean =     -22.813664887907
             les_mean =     520.911286987075
             stat err =       0.000550148110
             autocorr =       1.388367646642
   target nu stat err =       0.000550148110
   target dn stat err =       0.002539102911
      target stat err =       0.002197862081
              std dev =       0.660301647533
             le_variance =       0.435998265735


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747024827512        initial  <--
     9.3132e+07     9.3132e+08             2.0901e-12        -0.747024827497
     3.7253e+08     3.7253e+09             5.2260e-13        -0.747024827504
     1.4901e+09     1.4901e+10             1.3056e-13        -0.747024827511

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.4012
  </log>
  <optVariables href="FORM2.s036.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2148e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2814e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -22.7173
    reference variance = 0.385108
====================================================
  Execution time = 2.5148e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5365e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5312e-01
  Total weights = 1.964876799e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4696e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435899040778
                                         uncertainty =       0.002393694134

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435899040778
                                         uncertainty =       0.002393694134

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466817004
  error estimate for blocks of size 2^( 2) =       0.000492653565
  error estimate for blocks of size 2^( 3) =       0.000516961897
  error estimate for blocks of size 2^( 4) =       0.000534277700
  error estimate for blocks of size 2^( 5) =       0.000545962196
  error estimate for blocks of size 2^( 6) =       0.000551638490
  error estimate for blocks of size 2^( 7) =       0.000557157871

      target function =      -0.742763934779
              le_mean =     -22.815052760646
             les_mean =     520.979753377439
             stat err =       0.000547259064
             autocorr =       1.374334959617
   target nu stat err =       0.000547259064
   target dn stat err =       0.003684671387
      target stat err =       0.003094757645
              std dev =       0.660178937621
             le_variance =       0.435836229678


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281505276065e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+08, overlap shift 9.3132e+09 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742775905251       residual = 3.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742775905251       residual = 3.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742775905251       residual = 9.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742775905280       residual = 3.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742775905251       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742775894817       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742775999073       residual = 3.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742775151928       residual = 6.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742774508672       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742775959012       residual = 3.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+08 is 4.273991e-13

solving harmonic davidson linear method for identity shift 3.7253e+09, overlap shift 3.7253e+10 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742775905251       residual = 3.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742775905251       residual = 3.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742775905251       residual = 9.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742776641434       residual = 3.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742775905251       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742774139075       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742771247720       residual = 3.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742780514378       residual = 6.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742779183278       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742772830079       residual = 5.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+09 is 1.068529e-13

solving harmonic davidson linear method for identity shift 1.4901e+10, overlap shift 1.4901e+11 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742775905251       residual = 3.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742775905251       residual = 3.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742775905251       residual = 9.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742775905251       residual = 3.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742775905289       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742776394746       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742772047981       residual = 3.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742723150366       residual = 9.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742761760471       residual = 5.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742795699904       residual = 4.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742763295876       residual = 6.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.742757304073       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.742801440327       residual = 2.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.742807255256       residual = 4.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.742782697795       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.742777007327       residual = 4.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.742752570922       residual = 3.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.742772238093       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.742777482076       residual = 7.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+10 is 2.673356e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.138360 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9630e+01
  </log>
  <optVariables href="FORM2.s037.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -22.7957
    reference variance = 0.560807
====================================================
  Execution time = 2.6974e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5024e-01
  Total weights = 1.9646e+06
  Execution time = 3.5023e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437478337553
                                         uncertainty =       0.002119369162

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437478337553
                                         uncertainty =       0.002119369162

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467690065
  error estimate for blocks of size 2^( 2) =       0.000493878047
  error estimate for blocks of size 2^( 3) =       0.000518233015
  error estimate for blocks of size 2^( 4) =       0.000536059718
  error estimate for blocks of size 2^( 5) =       0.000548038422
  error estimate for blocks of size 2^( 6) =       0.000555062681
  error estimate for blocks of size 2^( 7) =       0.000561567750

      target function =      -0.745150056297
              le_mean =     -22.814412860868
             les_mean =     520.947674725406
             stat err =       0.000550182143
             autocorr =       1.383874452073
   target nu stat err =       0.000550182143
   target dn stat err =       0.002772600869
      target stat err =       0.002376007903
              std dev =       0.661413632889
             le_variance =       0.437467993772

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437478337553
                                         uncertainty =       0.002119369162

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437478337553
                                         uncertainty =       0.002119369162

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467690065
  error estimate for blocks of size 2^( 2) =       0.000493878047
  error estimate for blocks of size 2^( 3) =       0.000518233015
  error estimate for blocks of size 2^( 4) =       0.000536059718
  error estimate for blocks of size 2^( 5) =       0.000548038422
  error estimate for blocks of size 2^( 6) =       0.000555062681
  error estimate for blocks of size 2^( 7) =       0.000561567750

      target function =      -0.745150056297
              le_mean =     -22.814412860868
             les_mean =     520.947674725406
             stat err =       0.000550182143
             autocorr =       1.383874452075
   target nu stat err =       0.000550182143
   target dn stat err =       0.002772600869
      target stat err =       0.002376007903
              std dev =       0.661413632889
             le_variance =       0.437467993772

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437478337553
                                         uncertainty =       0.002119369162

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437478337553
                                         uncertainty =       0.002119369162

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467690065
  error estimate for blocks of size 2^( 2) =       0.000493878047
  error estimate for blocks of size 2^( 3) =       0.000518233015
  error estimate for blocks of size 2^( 4) =       0.000536059718
  error estimate for blocks of size 2^( 5) =       0.000548038422
  error estimate for blocks of size 2^( 6) =       0.000555062681
  error estimate for blocks of size 2^( 7) =       0.000561567750

      target function =      -0.745150056297
              le_mean =     -22.814412860868
             les_mean =     520.947674725406
             stat err =       0.000550182143
             autocorr =       1.383874452075
   target nu stat err =       0.000550182143
   target dn stat err =       0.002772600869
      target stat err =       0.002376007903
              std dev =       0.661413632889
             le_variance =       0.437467993772

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437478337553
                                         uncertainty =       0.002119369162

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437478337553
                                         uncertainty =       0.002119369162

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467690065
  error estimate for blocks of size 2^( 2) =       0.000493878047
  error estimate for blocks of size 2^( 3) =       0.000518233015
  error estimate for blocks of size 2^( 4) =       0.000536059718
  error estimate for blocks of size 2^( 5) =       0.000548038422
  error estimate for blocks of size 2^( 6) =       0.000555062681
  error estimate for blocks of size 2^( 7) =       0.000561567750

      target function =      -0.745150056297
              le_mean =     -22.814412860868
             les_mean =     520.947674725406
             stat err =       0.000550182143
             autocorr =       1.383874452075
   target nu stat err =       0.000550182143
   target dn stat err =       0.002772600869
      target stat err =       0.002376007903
              std dev =       0.661413632889
             le_variance =       0.437467993772


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745150056297        initial
     9.3132e+08     9.3132e+09             4.2740e-13        -0.745150056297  <--
     3.7253e+09     3.7253e+10             1.0685e-13        -0.745150056297
     1.4901e+10     1.4901e+11             2.6734e-14        -0.745150056297

*****************************************************************************
Applying the update for shift_i =   9.3132e+08     and shift_s =   9.3132e+09
*****************************************************************************

  Execution time = 4.4491e+01
  </log>
  <optVariables href="FORM2.s037.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4127e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2812e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -22.7016
    reference variance = 0.333261
====================================================
  Execution time = 2.5075e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5346e+04
  VMC Eavg = -2.2813e+01
  VMC Evar = 4.4846e-01
  Total weights = 1.964957726e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5093e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436555007853
                                         uncertainty =       0.002682365426

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436555007853
                                         uncertainty =       0.002682365426

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467310900
  error estimate for blocks of size 2^( 2) =       0.000493175789
  error estimate for blocks of size 2^( 3) =       0.000517303841
  error estimate for blocks of size 2^( 4) =       0.000535788731
  error estimate for blocks of size 2^( 5) =       0.000547388258
  error estimate for blocks of size 2^( 6) =       0.000553584104
  error estimate for blocks of size 2^( 7) =       0.000557436591

      target function =      -0.746624497816
              le_mean =     -22.813309962734
             les_mean =     520.895569292334
             stat err =       0.000548549421
             autocorr =       1.377906346167
   target nu stat err =       0.000548549421
   target dn stat err =       0.003181628998
      target stat err =       0.002710302490
              std dev =       0.660877412374
             le_variance =       0.436758954186


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281330996273e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+08, overlap shift 2.3283e+09 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746633306800       residual = 2.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746633306800       residual = 3.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746633306801       residual = 6.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746633306800       residual = 2.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746633306806       residual = 8.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746633613695       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746633072933       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746632956783       residual = 3.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746633251980       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746633618175       residual = 6.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+08 is 1.515666e-12

solving harmonic davidson linear method for identity shift 9.3132e+08, overlap shift 9.3132e+09 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746633306800       residual = 2.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746633306800       residual = 3.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746633306800       residual = 6.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746633306800       residual = 2.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746633306810       residual = 8.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746633310747       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746632954943       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746634984301       residual = 3.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746633055099       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746632341925       residual = 7.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+08 is 3.788606e-13

solving harmonic davidson linear method for identity shift 3.7253e+09, overlap shift 3.7253e+10 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746633306800       residual = 2.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746633306800       residual = 3.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746633306800       residual = 6.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746633306800       residual = 2.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746633306794       residual = 8.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746633313939       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746633467452       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746635824360       residual = 4.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746638425709       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746644277025       residual = 7.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+09 is 9.481118e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.141936 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9593e+01
  </log>
  <optVariables href="FORM2.s038.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -22.8272
    reference variance = 0.46594
====================================================
  Execution time = 2.4639e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5259e-01
  Total weights = 1.9649e+06
  Execution time = 3.5053e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436737885415
                                         uncertainty =       0.002007875358

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436737885415
                                         uncertainty =       0.002007875358

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467269556
  error estimate for blocks of size 2^( 2) =       0.000492958182
  error estimate for blocks of size 2^( 3) =       0.000517817766
  error estimate for blocks of size 2^( 4) =       0.000536476031
  error estimate for blocks of size 2^( 5) =       0.000548095992
  error estimate for blocks of size 2^( 6) =       0.000555545501
  error estimate for blocks of size 2^( 7) =       0.000561504251

      target function =      -0.743200550805
              le_mean =     -22.814120216950
             les_mean =     520.936676100386
             stat err =       0.000550405444
             autocorr =       1.387491937435
   target nu stat err =       0.000550405444
   target dn stat err =       0.003797031470
      target stat err =       0.003185465159
              std dev =       0.660818943880
             le_variance =       0.436681676590

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436737885415
                                         uncertainty =       0.002007875358

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436737885415
                                         uncertainty =       0.002007875358

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467269556
  error estimate for blocks of size 2^( 2) =       0.000492958182
  error estimate for blocks of size 2^( 3) =       0.000517817766
  error estimate for blocks of size 2^( 4) =       0.000536476031
  error estimate for blocks of size 2^( 5) =       0.000548095992
  error estimate for blocks of size 2^( 6) =       0.000555545501
  error estimate for blocks of size 2^( 7) =       0.000561504251

      target function =      -0.743200550805
              le_mean =     -22.814120216950
             les_mean =     520.936676100386
             stat err =       0.000550405444
             autocorr =       1.387491937433
   target nu stat err =       0.000550405444
   target dn stat err =       0.003797031470
      target stat err =       0.003185465159
              std dev =       0.660818943879
             le_variance =       0.436681676590

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436737885415
                                         uncertainty =       0.002007875358

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436737885415
                                         uncertainty =       0.002007875358

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467269556
  error estimate for blocks of size 2^( 2) =       0.000492958182
  error estimate for blocks of size 2^( 3) =       0.000517817766
  error estimate for blocks of size 2^( 4) =       0.000536476031
  error estimate for blocks of size 2^( 5) =       0.000548095992
  error estimate for blocks of size 2^( 6) =       0.000555545501
  error estimate for blocks of size 2^( 7) =       0.000561504251

      target function =      -0.743200550805
              le_mean =     -22.814120216950
             les_mean =     520.936676100386
             stat err =       0.000550405444
             autocorr =       1.387491937442
   target nu stat err =       0.000550405444
   target dn stat err =       0.003797031470
      target stat err =       0.003185465159
              std dev =       0.660818943880
             le_variance =       0.436681676590

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436737885415
                                         uncertainty =       0.002007875358

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436737885415
                                         uncertainty =       0.002007875358

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467269556
  error estimate for blocks of size 2^( 2) =       0.000492958182
  error estimate for blocks of size 2^( 3) =       0.000517817766
  error estimate for blocks of size 2^( 4) =       0.000536476031
  error estimate for blocks of size 2^( 5) =       0.000548095992
  error estimate for blocks of size 2^( 6) =       0.000555545501
  error estimate for blocks of size 2^( 7) =       0.000561504251

      target function =      -0.743200550805
              le_mean =     -22.814120216950
             les_mean =     520.936676100386
             stat err =       0.000550405444
             autocorr =       1.387491937435
   target nu stat err =       0.000550405444
   target dn stat err =       0.003797031470
      target stat err =       0.003185465159
              std dev =       0.660818943880
             le_variance =       0.436681676590


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743200550805        initial
     2.3283e+08     2.3283e+09             1.5157e-12        -0.743200550805  <--
     9.3132e+08     9.3132e+09             3.7886e-13        -0.743200550805
     3.7253e+09     3.7253e+10             9.4811e-14        -0.743200550805

*****************************************************************************
Applying the update for shift_i =   2.3283e+08     and shift_s =   2.3283e+09
*****************************************************************************

  Execution time = 4.2193e+01
  </log>
  <optVariables href="FORM2.s038.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.1836e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2811e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -22.8078
    reference variance = 0.408101
====================================================
  Execution time = 2.5093e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5353e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4482e-01
  Total weights = 1.964517276e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5282e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433453705992
                                         uncertainty =       0.001691461366

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433453705992
                                         uncertainty =       0.001691461366

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465597912
  error estimate for blocks of size 2^( 2) =       0.000491640919
  error estimate for blocks of size 2^( 3) =       0.000516030854
  error estimate for blocks of size 2^( 4) =       0.000534019308
  error estimate for blocks of size 2^( 5) =       0.000544991633
  error estimate for blocks of size 2^( 6) =       0.000552665630
  error estimate for blocks of size 2^( 7) =       0.000554582353

      target function =      -0.749668285568
              le_mean =     -22.814814732806
             les_mean =     520.960593912419
             stat err =       0.000546564731
             autocorr =       1.378037894595
   target nu stat err =       0.000546564731
   target dn stat err =       0.002290986640
      target stat err =       0.002016335745
              std dev =       0.658454881618
             le_variance =       0.433562831127


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281481473281e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+07, overlap shift 5.8208e+08 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749672720917       residual = 2.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749672720918       residual = 4.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749672720918       residual = 7.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749672721254       residual = 2.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749672709831       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749672700620       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749672632004       residual = 4.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749672720918       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749672720918       residual = 5.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749672752088       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.749672754322       residual = 2.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+07 is 4.138714e-12

solving harmonic davidson linear method for identity shift 2.3283e+08, overlap shift 2.3283e+09 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749672720917       residual = 2.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749672720918       residual = 4.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749672720918       residual = 7.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749672720918       residual = 2.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749672720918       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749672720918       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749673050394       residual = 4.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749672336097       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749672804744       residual = 5.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749673083601       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.749673231454       residual = 2.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+08 is 1.034629e-12

solving harmonic davidson linear method for identity shift 9.3132e+08, overlap shift 9.3132e+09 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749672720917       residual = 2.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749672720917       residual = 4.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749672720917       residual = 7.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749672754154       residual = 2.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749672720917       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749673197690       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749672720917       residual = 4.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749672720917       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749672720917       residual = 5.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749672431739       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.749675199537       residual = 2.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+08 is 2.586509e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.146084 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9631e+01
  </log>
  <optVariables href="FORM2.s039.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -22.9385
    reference variance = 0.688469
====================================================
  Execution time = 2.6559e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4758e-01
  Total weights = 1.9648e+06
  Execution time = 3.5124e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435724834755
                                         uncertainty =       0.001916853769

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435724834755
                                         uncertainty =       0.001916853769

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466720502
  error estimate for blocks of size 2^( 2) =       0.000492151899
  error estimate for blocks of size 2^( 3) =       0.000516255172
  error estimate for blocks of size 2^( 4) =       0.000534660667
  error estimate for blocks of size 2^( 5) =       0.000546880006
  error estimate for blocks of size 2^( 6) =       0.000553484631
  error estimate for blocks of size 2^( 7) =       0.000556633059

      target function =      -0.747360766080
              le_mean =     -22.813999613625
             les_mean =     520.926157582966
             stat err =       0.000547914591
             autocorr =       1.378199134484
   target nu stat err =       0.000547914591
   target dn stat err =       0.002451317583
      target stat err =       0.002130050595
              std dev =       0.660042464461
             le_variance =       0.435656054891

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435724834755
                                         uncertainty =       0.001916853769

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435724834755
                                         uncertainty =       0.001916853769

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466720502
  error estimate for blocks of size 2^( 2) =       0.000492151899
  error estimate for blocks of size 2^( 3) =       0.000516255172
  error estimate for blocks of size 2^( 4) =       0.000534660667
  error estimate for blocks of size 2^( 5) =       0.000546880006
  error estimate for blocks of size 2^( 6) =       0.000553484631
  error estimate for blocks of size 2^( 7) =       0.000556633059

      target function =      -0.747360766081
              le_mean =     -22.813999613625
             les_mean =     520.926157582965
             stat err =       0.000547914591
             autocorr =       1.378199134474
   target nu stat err =       0.000547914591
   target dn stat err =       0.002451317583
      target stat err =       0.002130050595
              std dev =       0.660042464460
             le_variance =       0.435656054891

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435724834755
                                         uncertainty =       0.001916853769

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435724834755
                                         uncertainty =       0.001916853769

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466720502
  error estimate for blocks of size 2^( 2) =       0.000492151899
  error estimate for blocks of size 2^( 3) =       0.000516255172
  error estimate for blocks of size 2^( 4) =       0.000534660667
  error estimate for blocks of size 2^( 5) =       0.000546880006
  error estimate for blocks of size 2^( 6) =       0.000553484631
  error estimate for blocks of size 2^( 7) =       0.000556633059

      target function =      -0.747360766081
              le_mean =     -22.813999613625
             les_mean =     520.926157582966
             stat err =       0.000547914591
             autocorr =       1.378199134488
   target nu stat err =       0.000547914591
   target dn stat err =       0.002451317583
      target stat err =       0.002130050595
              std dev =       0.660042464460
             le_variance =       0.435656054891

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435724834755
                                         uncertainty =       0.001916853769

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435724834755
                                         uncertainty =       0.001916853769

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466720502
  error estimate for blocks of size 2^( 2) =       0.000492151899
  error estimate for blocks of size 2^( 3) =       0.000516255172
  error estimate for blocks of size 2^( 4) =       0.000534660667
  error estimate for blocks of size 2^( 5) =       0.000546880006
  error estimate for blocks of size 2^( 6) =       0.000553484631
  error estimate for blocks of size 2^( 7) =       0.000556633059

      target function =      -0.747360766080
              le_mean =     -22.813999613625
             les_mean =     520.926157582966
             stat err =       0.000547914591
             autocorr =       1.378199134477
   target nu stat err =       0.000547914591
   target dn stat err =       0.002451317583
      target stat err =       0.002130050595
              std dev =       0.660042464461
             le_variance =       0.435656054891


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747360766080        initial
     5.8208e+07     5.8208e+08             4.1387e-12        -0.747360766081  <--
     2.3283e+08     2.3283e+09             1.0346e-12        -0.747360766081
     9.3132e+08     9.3132e+09             2.5865e-13        -0.747360766080

*****************************************************************************
Applying the update for shift_i =   5.8208e+07     and shift_s =   5.8208e+08
*****************************************************************************

  Execution time = 4.4219e+01
  </log>
  <optVariables href="FORM2.s039.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3861e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s040 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s040 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=40  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2813e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -22.8578
    reference variance = 0.355529
====================================================
  Execution time = 2.5159e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s040
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5355e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4617e-01
  Total weights = 1.964814312e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4994e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434193666212
                                         uncertainty =       0.001811319114

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434193666212
                                         uncertainty =       0.001811319114

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465902622
  error estimate for blocks of size 2^( 2) =       0.000491547957
  error estimate for blocks of size 2^( 3) =       0.000515405757
  error estimate for blocks of size 2^( 4) =       0.000532735235
  error estimate for blocks of size 2^( 5) =       0.000542684673
  error estimate for blocks of size 2^( 6) =       0.000549595449
  error estimate for blocks of size 2^( 7) =       0.000554988820

      target function =      -0.748542283090
              le_mean =     -22.814938969195
             les_mean =     520.967607184605
             stat err =       0.000545001044
             autocorr =       1.368372567333
   target nu stat err =       0.000545001044
   target dn stat err =       0.002437899802
      target stat err =       0.002127825679
              std dev =       0.658885807397
             le_variance =       0.434130507189


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281493896919e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+07, overlap shift 1.4552e+08 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748547332377       residual = 2.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748547332379       residual = 3.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748547332379       residual = 7.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748547332379       residual = 2.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748547331867       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748547315580       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748547337564       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748547338412       residual = 2.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748547321028       residual = 8.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+07 is 2.313400e-11

solving harmonic davidson linear method for identity shift 5.8208e+07, overlap shift 5.8208e+08 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748547332377       residual = 2.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748547332378       residual = 3.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748547332378       residual = 7.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748547332378       residual = 2.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748547359053       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748547350763       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748547332378       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748547333027       residual = 2.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748547480490       residual = 8.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+07 is 5.783469e-12

solving harmonic davidson linear method for identity shift 2.3283e+08, overlap shift 2.3283e+09 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748547332377       residual = 2.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748547332377       residual = 3.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748547332377       residual = 7.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748547315643       residual = 2.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748547383913       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748547332377       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748547263603       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748546495197       residual = 2.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748547332377       residual = 8.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+08 is 1.445885e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.149192 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9666e+01
  </log>
  <optVariables href="FORM2.s040.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -22.7076
    reference variance = 0.656441
====================================================
  Execution time = 2.4558e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s040
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5169e-01
  Total weights = 1.9648e+06
  Execution time = 3.4905e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439540402304
                                         uncertainty =       0.002221172125

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439540402304
                                         uncertainty =       0.002221172125

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468801045
  error estimate for blocks of size 2^( 2) =       0.000494470983
  error estimate for blocks of size 2^( 3) =       0.000518253040
  error estimate for blocks of size 2^( 4) =       0.000536493677
  error estimate for blocks of size 2^( 5) =       0.000547124569
  error estimate for blocks of size 2^( 6) =       0.000555683221
  error estimate for blocks of size 2^( 7) =       0.000555095962

      target function =      -0.743947628454
              le_mean =     -22.814865266885
             les_mean =     520.969770796111
             stat err =       0.000548599357
             autocorr =       1.369409849000
   target nu stat err =       0.000548599357
   target dn stat err =       0.002738618628
      target stat err =       0.002342630847
              std dev =       0.662984795447
             le_variance =       0.439548838994

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439540402303
                                         uncertainty =       0.002221172126

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439540402303
                                         uncertainty =       0.002221172126

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468801045
  error estimate for blocks of size 2^( 2) =       0.000494470983
  error estimate for blocks of size 2^( 3) =       0.000518253040
  error estimate for blocks of size 2^( 4) =       0.000536493677
  error estimate for blocks of size 2^( 5) =       0.000547124569
  error estimate for blocks of size 2^( 6) =       0.000555683221
  error estimate for blocks of size 2^( 7) =       0.000555095962

      target function =      -0.743947628399
              le_mean =     -22.814865266885
             les_mean =     520.969770796179
             stat err =       0.000548599357
             autocorr =       1.369409848988
   target nu stat err =       0.000548599357
   target dn stat err =       0.002738618640
      target stat err =       0.002342630856
              std dev =       0.662984795447
             le_variance =       0.439548838994

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439540402304
                                         uncertainty =       0.002221172125

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439540402304
                                         uncertainty =       0.002221172125

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468801045
  error estimate for blocks of size 2^( 2) =       0.000494470983
  error estimate for blocks of size 2^( 3) =       0.000518253040
  error estimate for blocks of size 2^( 4) =       0.000536493677
  error estimate for blocks of size 2^( 5) =       0.000547124569
  error estimate for blocks of size 2^( 6) =       0.000555683221
  error estimate for blocks of size 2^( 7) =       0.000555095962

      target function =      -0.743947628426
              le_mean =     -22.814865266885
             les_mean =     520.969770796145
             stat err =       0.000548599357
             autocorr =       1.369409849003
   target nu stat err =       0.000548599357
   target dn stat err =       0.002738618634
      target stat err =       0.002342630851
              std dev =       0.662984795447
             le_variance =       0.439548838994

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439540402304
                                         uncertainty =       0.002221172125

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439540402304
                                         uncertainty =       0.002221172125

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468801045
  error estimate for blocks of size 2^( 2) =       0.000494470983
  error estimate for blocks of size 2^( 3) =       0.000518253040
  error estimate for blocks of size 2^( 4) =       0.000536493677
  error estimate for blocks of size 2^( 5) =       0.000547124569
  error estimate for blocks of size 2^( 6) =       0.000555683221
  error estimate for blocks of size 2^( 7) =       0.000555095962

      target function =      -0.743947628451
              le_mean =     -22.814865266885
             les_mean =     520.969770796115
             stat err =       0.000548599357
             autocorr =       1.369409849004
   target nu stat err =       0.000548599357
   target dn stat err =       0.002738618629
      target stat err =       0.002342630847
              std dev =       0.662984795447
             le_variance =       0.439548838994


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743947628454        initial  <--
     1.4552e+07     1.4552e+08             2.3134e-11        -0.743947628399
     5.8208e+07     5.8208e+08             5.7835e-12        -0.743947628426
     2.3283e+08     2.3283e+09             1.4459e-12        -0.743947628451

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.0229
  </log>
  <optVariables href="FORM2.s040.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.1702e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s041 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s041 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=41  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2812e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -22.7996
    reference variance = 0.324472
====================================================
  Execution time = 2.5145e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s041
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5360e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4937e-01
  Total weights = 1.964596351e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5140e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435845539581
                                         uncertainty =       0.002593767624

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435845539581
                                         uncertainty =       0.002593767624

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466800323
  error estimate for blocks of size 2^( 2) =       0.000492257419
  error estimate for blocks of size 2^( 3) =       0.000515996159
  error estimate for blocks of size 2^( 4) =       0.000533576048
  error estimate for blocks of size 2^( 5) =       0.000544642077
  error estimate for blocks of size 2^( 6) =       0.000552744156
  error estimate for blocks of size 2^( 7) =       0.000554774315

      target function =      -0.745868396243
              le_mean =     -22.813688787437
             les_mean =     520.913766728641
             stat err =       0.000546434149
             autocorr =       1.370292780361
   target nu stat err =       0.000546434149
   target dn stat err =       0.003160262256
      target stat err =       0.002688698262
              std dev =       0.660155347385
             le_variance =       0.435805082681


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281368878744e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+08, overlap shift 1.4552e+09 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745877098970       residual = 2.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745877098970       residual = 3.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745877098970       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745877098970       residual = 3.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745877054108       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745877098970       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745877530366       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745876912629       residual = 2.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745877055114       residual = 5.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+08 is 2.649287e-12

solving harmonic davidson linear method for identity shift 5.8208e+08, overlap shift 5.8208e+09 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745877098970       residual = 2.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745877098970       residual = 3.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745877098970       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745877098891       residual = 3.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745877098960       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745877114855       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745877470541       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745877400638       residual = 2.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745878328535       residual = 5.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+08 is 6.622408e-13

solving harmonic davidson linear method for identity shift 2.3283e+09, overlap shift 2.3283e+10 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745877098970       residual = 2.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745877098970       residual = 3.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745877098970       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745877098970       residual = 3.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745877098970       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745876239669       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745872075611       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745877098970       residual = 2.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745873219477       residual = 5.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+09 is 1.654609e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.152309 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9667e+01
  </log>
  <optVariables href="FORM2.s041.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -22.7945
    reference variance = 0.453547
====================================================
  Execution time = 2.6472e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s041
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4482e-01
  Total weights = 1.9649e+06
  Execution time = 3.5095e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431908635815
                                         uncertainty =       0.001860429845

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431908635815
                                         uncertainty =       0.001860429845

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464661820
  error estimate for blocks of size 2^( 2) =       0.000490187857
  error estimate for blocks of size 2^( 3) =       0.000514355848
  error estimate for blocks of size 2^( 4) =       0.000532629617
  error estimate for blocks of size 2^( 5) =       0.000544882334
  error estimate for blocks of size 2^( 6) =       0.000551275322
  error estimate for blocks of size 2^( 7) =       0.000552447036

      target function =      -0.749666098429
              le_mean =     -22.814366634215
             les_mean =     520.940145250004
             stat err =       0.000545308577
             autocorr =       1.377243334216
   target nu stat err =       0.000545308577
   target dn stat err =       0.002629632501
      target stat err =       0.002286683730
              std dev =       0.657131048108
             le_variance =       0.431821214387

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431908635815
                                         uncertainty =       0.001860429845

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431908635815
                                         uncertainty =       0.001860429845

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464661820
  error estimate for blocks of size 2^( 2) =       0.000490187857
  error estimate for blocks of size 2^( 3) =       0.000514355848
  error estimate for blocks of size 2^( 4) =       0.000532629617
  error estimate for blocks of size 2^( 5) =       0.000544882334
  error estimate for blocks of size 2^( 6) =       0.000551275322
  error estimate for blocks of size 2^( 7) =       0.000552447036

      target function =      -0.749666098429
              le_mean =     -22.814366634215
             les_mean =     520.940145250004
             stat err =       0.000545308577
             autocorr =       1.377243334214
   target nu stat err =       0.000545308577
   target dn stat err =       0.002629632501
      target stat err =       0.002286683731
              std dev =       0.657131048108
             le_variance =       0.431821214387

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431908635815
                                         uncertainty =       0.001860429845

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431908635815
                                         uncertainty =       0.001860429845

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464661820
  error estimate for blocks of size 2^( 2) =       0.000490187857
  error estimate for blocks of size 2^( 3) =       0.000514355848
  error estimate for blocks of size 2^( 4) =       0.000532629617
  error estimate for blocks of size 2^( 5) =       0.000544882334
  error estimate for blocks of size 2^( 6) =       0.000551275322
  error estimate for blocks of size 2^( 7) =       0.000552447036

      target function =      -0.749666098429
              le_mean =     -22.814366634215
             les_mean =     520.940145250004
             stat err =       0.000545308577
             autocorr =       1.377243334215
   target nu stat err =       0.000545308577
   target dn stat err =       0.002629632501
      target stat err =       0.002286683730
              std dev =       0.657131048108
             le_variance =       0.431821214387

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431908635815
                                         uncertainty =       0.001860429845

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431908635815
                                         uncertainty =       0.001860429845

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464661820
  error estimate for blocks of size 2^( 2) =       0.000490187857
  error estimate for blocks of size 2^( 3) =       0.000514355848
  error estimate for blocks of size 2^( 4) =       0.000532629617
  error estimate for blocks of size 2^( 5) =       0.000544882334
  error estimate for blocks of size 2^( 6) =       0.000551275322
  error estimate for blocks of size 2^( 7) =       0.000552447036

      target function =      -0.749666098429
              le_mean =     -22.814366634215
             les_mean =     520.940145250004
             stat err =       0.000545308577
             autocorr =       1.377243334220
   target nu stat err =       0.000545308577
   target dn stat err =       0.002629632501
      target stat err =       0.002286683730
              std dev =       0.657131048108
             le_variance =       0.431821214387


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.749666098429        initial  <--
     1.4552e+08     1.4552e+09             2.6493e-12        -0.749666098429
     5.8208e+08     5.8208e+09             6.6224e-13        -0.749666098429
     2.3283e+09     2.3283e+10             1.6546e-13        -0.749666098429

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.9863
  </log>
  <optVariables href="FORM2.s041.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3716e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s042 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s042 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=42  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2812e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -22.7789
    reference variance = 0.333503
====================================================
  Execution time = 2.5251e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s042
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5328e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4886e-01
  Total weights = 1.964566697e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5198e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436527849259
                                         uncertainty =       0.002439651311

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436527849259
                                         uncertainty =       0.002439651311

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467233069
  error estimate for blocks of size 2^( 2) =       0.000492953440
  error estimate for blocks of size 2^( 3) =       0.000517215685
  error estimate for blocks of size 2^( 4) =       0.000535047457
  error estimate for blocks of size 2^( 5) =       0.000545588258
  error estimate for blocks of size 2^( 6) =       0.000550512871
  error estimate for blocks of size 2^( 7) =       0.000552981936

      target function =      -0.746292514128
              le_mean =     -22.814359234814
             les_mean =     520.943848670852
             stat err =       0.000546032630
             autocorr =       1.365746348682
   target nu stat err =       0.000546032630
   target dn stat err =       0.003035035278
      target stat err =       0.002593042355
              std dev =       0.660767342295
             le_variance =       0.436613480644


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281435923481e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+09, overlap shift 1.4552e+10 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746300460337       residual = 2.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746300460337       residual = 2.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746300460337       residual = 6.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746300460337       residual = 2.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746300460339       residual = 8.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746300431361       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746300460337       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746302589023       residual = 2.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746299448174       residual = 6.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+09 is 1.979421e-13

solving harmonic davidson linear method for identity shift 5.8208e+09, overlap shift 5.8208e+10 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746300460337       residual = 2.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746300460337       residual = 2.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746300460337       residual = 6.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746301634105       residual = 2.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746293965783       residual = 8.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746300458703       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746300604018       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746307474249       residual = 3.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746302751292       residual = 7.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+09 is 4.946958e-14

solving harmonic davidson linear method for identity shift 2.3283e+10, overlap shift 2.3283e+11 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746300460337       residual = 2.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746300460337       residual = 2.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746300460337       residual = 6.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746300460337       residual = 2.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746300460324       residual = 8.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746300461295       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746306477218       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746261691912       residual = 8.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746248917108       residual = 7.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746297144150       residual = 6.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746352477125       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746309572701       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.746335478530       residual = 7.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.746359107753       residual = 8.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.746287177245       residual = 6.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.746280092374       residual = 4.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.746293713020       residual = 3.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.746283123592       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.746285245152       residual = 2.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.746316743338       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.746290232554       residual = 2.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.746269684040       residual = 2.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.746298332054       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.746332709022       residual = 8.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.746285666172       residual = 4.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.746282976682       residual = 2.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.746282379008       residual = 3.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.746283900107       residual = 3.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.746280940238       residual = 2.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.746317552724       residual = 8.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.746263524929       residual = 5.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.746297500998       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.746287667865       residual = 5.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         32 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+10 is 1.234664e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.169450 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9793e+01
  </log>
  <optVariables href="FORM2.s042.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -22.723
    reference variance = 0.557514
====================================================
  Execution time = 2.4526e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s042
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5122e-01
  Total weights = 1.9648e+06
  Execution time = 3.4896e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437132397726
                                         uncertainty =       0.002309364259

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437132397726
                                         uncertainty =       0.002309364259

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467483277
  error estimate for blocks of size 2^( 2) =       0.000493110160
  error estimate for blocks of size 2^( 3) =       0.000517521582
  error estimate for blocks of size 2^( 4) =       0.000535945533
  error estimate for blocks of size 2^( 5) =       0.000546689412
  error estimate for blocks of size 2^( 6) =       0.000553708055
  error estimate for blocks of size 2^( 7) =       0.000557565932

      target function =      -0.744337416093
              le_mean =     -22.814629143571
             les_mean =     520.958519490496
             stat err =       0.000548477233
             autocorr =       1.376528001043
   target nu stat err =       0.000548477233
   target dn stat err =       0.003602135076
      target stat err =       0.003039062074
              std dev =       0.661121190705
             le_variance =       0.437081228799

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437132397726
                                         uncertainty =       0.002309364259

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437132397726
                                         uncertainty =       0.002309364259

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467483277
  error estimate for blocks of size 2^( 2) =       0.000493110160
  error estimate for blocks of size 2^( 3) =       0.000517521582
  error estimate for blocks of size 2^( 4) =       0.000535945533
  error estimate for blocks of size 2^( 5) =       0.000546689412
  error estimate for blocks of size 2^( 6) =       0.000553708055
  error estimate for blocks of size 2^( 7) =       0.000557565932

      target function =      -0.744337416093
              le_mean =     -22.814629143571
             les_mean =     520.958519490496
             stat err =       0.000548477233
             autocorr =       1.376528001044
   target nu stat err =       0.000548477233
   target dn stat err =       0.003602135076
      target stat err =       0.003039062074
              std dev =       0.661121190705
             le_variance =       0.437081228799

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437132397726
                                         uncertainty =       0.002309364259

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437132397726
                                         uncertainty =       0.002309364259

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467483277
  error estimate for blocks of size 2^( 2) =       0.000493110160
  error estimate for blocks of size 2^( 3) =       0.000517521582
  error estimate for blocks of size 2^( 4) =       0.000535945533
  error estimate for blocks of size 2^( 5) =       0.000546689412
  error estimate for blocks of size 2^( 6) =       0.000553708055
  error estimate for blocks of size 2^( 7) =       0.000557565932

      target function =      -0.744337416093
              le_mean =     -22.814629143571
             les_mean =     520.958519490496
             stat err =       0.000548477233
             autocorr =       1.376528001045
   target nu stat err =       0.000548477233
   target dn stat err =       0.003602135076
      target stat err =       0.003039062074
              std dev =       0.661121190705
             le_variance =       0.437081228799

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437132397726
                                         uncertainty =       0.002309364259

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437132397726
                                         uncertainty =       0.002309364259

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467483277
  error estimate for blocks of size 2^( 2) =       0.000493110160
  error estimate for blocks of size 2^( 3) =       0.000517521582
  error estimate for blocks of size 2^( 4) =       0.000535945533
  error estimate for blocks of size 2^( 5) =       0.000546689412
  error estimate for blocks of size 2^( 6) =       0.000553708055
  error estimate for blocks of size 2^( 7) =       0.000557565932

      target function =      -0.744337416093
              le_mean =     -22.814629143571
             les_mean =     520.958519490496
             stat err =       0.000548477233
             autocorr =       1.376528001045
   target nu stat err =       0.000548477233
   target dn stat err =       0.003602135076
      target stat err =       0.003039062074
              std dev =       0.661121190705
             le_variance =       0.437081228799


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744337416093        initial
     1.4552e+09     1.4552e+10             1.9794e-13        -0.744337416093  <--
     5.8208e+09     5.8208e+10             4.9470e-14        -0.744337416093
     2.3283e+10     2.3283e+11             1.2347e-14        -0.744337416093

*****************************************************************************
Applying the update for shift_i =   1.4552e+09     and shift_s =   1.4552e+10
*****************************************************************************

  Execution time = 4.1990e+01
  </log>
  <optVariables href="FORM2.s042.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.1794e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s043 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s043 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=43  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2810e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -22.8258
    reference variance = 1.05917
====================================================
  Execution time = 2.5071e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s043
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5332e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.6252e-01
  Total weights = 1.964767632e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5067e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444463906359
                                         uncertainty =       0.005712032703

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444463906359
                                         uncertainty =       0.005712032703

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471423488
  error estimate for blocks of size 2^( 2) =       0.000496806933
  error estimate for blocks of size 2^( 3) =       0.000521233218
  error estimate for blocks of size 2^( 4) =       0.000539576282
  error estimate for blocks of size 2^( 5) =       0.000551998219
  error estimate for blocks of size 2^( 6) =       0.000558907351
  error estimate for blocks of size 2^( 7) =       0.000562649078

      target function =      -0.735053527898
              le_mean =     -22.815235409270
             les_mean =     520.997490506088
             stat err =       0.000553282733
             autocorr =       1.377437174178
   target nu stat err =       0.000553282733
   target dn stat err =       0.007931602191
      target stat err =       0.006428395005
              std dev =       0.666693490344
             le_variance =       0.444480210068


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281523540927e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+08, overlap shift 3.6380e+09 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.735108493536       residual = 2.63e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.735108493536       residual = 2.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.735108493536       residual = 3.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.735108493536       residual = 5.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.735108611756       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.735108529767       residual = 3.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.735108971634       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.735108739484       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.735107857428       residual = 4.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.735108299932       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.735108106500       residual = 2.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+08 is 1.695877e-12

solving harmonic davidson linear method for identity shift 1.4552e+09, overlap shift 1.4552e+10 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.735108493536       residual = 2.63e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.735108493536       residual = 2.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.735108493536       residual = 3.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.735108493536       residual = 5.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.735108333074       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.735108250971       residual = 3.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.735108493536       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.735113601770       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.735107910655       residual = 4.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.735106090015       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.735110232146       residual = 4.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+09 is 4.239366e-13

solving harmonic davidson linear method for identity shift 5.8208e+09, overlap shift 5.8208e+10 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.735108493536       residual = 2.63e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.735108493536       residual = 2.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.735108493536       residual = 3.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.735108493536       residual = 5.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.735107045661       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.735106750898       residual = 3.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.735112091448       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.735116096639       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.735102378185       residual = 4.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.735102580551       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.735121526141       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.735108996395       residual = 3.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+09 is 1.060097e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.173883 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9587e+01
  </log>
  <optVariables href="FORM2.s043.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -22.8529
    reference variance = 0.257742
====================================================
  Execution time = 2.6649e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s043
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5217e-01
  Total weights = 1.9648e+06
  Execution time = 3.4875e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438333948790
                                         uncertainty =       0.003080273431

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438333948790
                                         uncertainty =       0.003080273431

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468383520
  error estimate for blocks of size 2^( 2) =       0.000494623942
  error estimate for blocks of size 2^( 3) =       0.000519108132
  error estimate for blocks of size 2^( 4) =       0.000536919138
  error estimate for blocks of size 2^( 5) =       0.000548272206
  error estimate for blocks of size 2^( 6) =       0.000554104012
  error estimate for blocks of size 2^( 7) =       0.000561339790

      target function =      -0.743546409847
              le_mean =     -22.814471270903
             les_mean =     520.952272826764
             stat err =       0.000550158787
             autocorr =       1.379662609309
   target nu stat err =       0.000550158787
   target dn stat err =       0.003769548688
      target stat err =       0.003167752894
              std dev =       0.662394326877
             le_variance =       0.438766244279

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438333948790
                                         uncertainty =       0.003080273431

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438333948790
                                         uncertainty =       0.003080273431

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468383520
  error estimate for blocks of size 2^( 2) =       0.000494623942
  error estimate for blocks of size 2^( 3) =       0.000519108132
  error estimate for blocks of size 2^( 4) =       0.000536919138
  error estimate for blocks of size 2^( 5) =       0.000548272206
  error estimate for blocks of size 2^( 6) =       0.000554104012
  error estimate for blocks of size 2^( 7) =       0.000561339790

      target function =      -0.743546409845
              le_mean =     -22.814471270903
             les_mean =     520.952272826765
             stat err =       0.000550158787
             autocorr =       1.379662609309
   target nu stat err =       0.000550158787
   target dn stat err =       0.003769548688
      target stat err =       0.003167752894
              std dev =       0.662394326877
             le_variance =       0.438766244279

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438333948790
                                         uncertainty =       0.003080273431

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438333948790
                                         uncertainty =       0.003080273431

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468383520
  error estimate for blocks of size 2^( 2) =       0.000494623942
  error estimate for blocks of size 2^( 3) =       0.000519108132
  error estimate for blocks of size 2^( 4) =       0.000536919138
  error estimate for blocks of size 2^( 5) =       0.000548272206
  error estimate for blocks of size 2^( 6) =       0.000554104012
  error estimate for blocks of size 2^( 7) =       0.000561339790

      target function =      -0.743546409846
              le_mean =     -22.814471270903
             les_mean =     520.952272826765
             stat err =       0.000550158787
             autocorr =       1.379662609306
   target nu stat err =       0.000550158787
   target dn stat err =       0.003769548688
      target stat err =       0.003167752894
              std dev =       0.662394326877
             le_variance =       0.438766244279

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438333948790
                                         uncertainty =       0.003080273431

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438333948790
                                         uncertainty =       0.003080273431

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468383520
  error estimate for blocks of size 2^( 2) =       0.000494623942
  error estimate for blocks of size 2^( 3) =       0.000519108132
  error estimate for blocks of size 2^( 4) =       0.000536919138
  error estimate for blocks of size 2^( 5) =       0.000548272206
  error estimate for blocks of size 2^( 6) =       0.000554104012
  error estimate for blocks of size 2^( 7) =       0.000561339790

      target function =      -0.743546409847
              le_mean =     -22.814471270903
             les_mean =     520.952272826764
             stat err =       0.000550158787
             autocorr =       1.379662609309
   target nu stat err =       0.000550158787
   target dn stat err =       0.003769548688
      target stat err =       0.003167752894
              std dev =       0.662394326877
             le_variance =       0.438766244279


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743546409847        initial  <--
     3.6380e+08     3.6380e+09             1.6959e-12        -0.743546409845
     1.4552e+09     1.4552e+10             4.2394e-13        -0.743546409846
     5.8208e+09     5.8208e+10             1.0601e-13        -0.743546409847

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.0941
  </log>
  <optVariables href="FORM2.s043.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3689e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s044 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s044 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=44  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2811e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -22.8369
    reference variance = 0.24397
====================================================
  Execution time = 2.5840e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s044
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5365e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4826e-01
  Total weights = 1.964501468e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5055e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435303871581
                                         uncertainty =       0.002164490607

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435303871581
                                         uncertainty =       0.002164490607

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466505807
  error estimate for blocks of size 2^( 2) =       0.000492347328
  error estimate for blocks of size 2^( 3) =       0.000516612845
  error estimate for blocks of size 2^( 4) =       0.000535450834
  error estimate for blocks of size 2^( 5) =       0.000546929761
  error estimate for blocks of size 2^( 6) =       0.000553061775
  error estimate for blocks of size 2^( 7) =       0.000556905688

      target function =      -0.746788490139
              le_mean =     -22.814849762160
             les_mean =     520.965631563286
             stat err =       0.000548087014
             autocorr =       1.380336321775
   target nu stat err =       0.000548087014
   target dn stat err =       0.003497827432
      target stat err =       0.002974608997
              std dev =       0.659738839874
             le_variance =       0.435255336839


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281484976216e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+09, overlap shift 3.6380e+10 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746799365957       residual = 1.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746799365957       residual = 2.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746799365957       residual = 7.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746799365957       residual = 2.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746800375220       residual = 8.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746799365957       residual = 9.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746799365957       residual = 8.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746792908833       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746806346064       residual = 9.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+09 is 7.819670e-14

solving harmonic davidson linear method for identity shift 1.4552e+10, overlap shift 1.4552e+11 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746799365957       residual = 1.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746799365957       residual = 2.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746799365957       residual = 7.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746799365957       residual = 2.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746799365957       residual = 7.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746799365957       residual = 9.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746799365957       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746825717770       residual = 6.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746799365957       residual = 2.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746819297274       residual = 3.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746774569247       residual = 3.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746798311327       residual = 4.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.746758662155       residual = 4.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.746762386898       residual = 6.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.746831455685       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.746784551801       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.746784215988       residual = 9.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+10 is 1.963161e-14

solving harmonic davidson linear method for identity shift 5.8208e+10, overlap shift 5.8208e+11 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746799365957       residual = 1.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746799365957       residual = 2.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746799365957       residual = 7.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746799365957       residual = 2.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746806667695       residual = 8.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746799365957       residual = 9.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746826809621       residual = 9.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746746273211       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746754843000       residual = 8.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746922016925       residual = 4.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746810118711       residual = 6.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746639860592       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.746956523310       residual = 5.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.746730574149       residual = 3.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.746713027699       residual = 2.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.746731216513       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.746823995605       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.746805813375       residual = 7.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.746855271799       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.746821981087       residual = 5.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.746883451502       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.746847685285       residual = 5.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.746873493456       residual = 6.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.746773269611       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.746841289516       residual = 8.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.746776142187       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.746730626061       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.746722464761       residual = 4.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.746922558294       residual = 3.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.746792126489       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.746732646773       residual = 2.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.746728579365       residual = 6.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.746781360852       residual = 5.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.746787358229       residual = 5.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.746794555778       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.746762114853       residual = 9.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.746759977346       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.746799668247       residual = 6.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.746813010204       residual = 6.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.746831334421       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.746719621155       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.746834258347       residual = 9.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.746779823735       residual = 9.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.746843913120       residual = 3.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.746734418680       residual = 2.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.746783670235       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.746752006046       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.746810424809       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.746789616541       residual = 8.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.746760550583       residual = 6.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.746774536331       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.746803820299       residual = 3.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.746859462630       residual = 7.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.746873709944       residual = 1.16e-06           smallest_sin_value = 9.99e-01
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.746818556114       residual = 2.13e-06           smallest_sin_value = 9.93e-01
davidson iteration   55 stopping due to small subspace S singular value of 9.63e-01
davidson solver did not converge after         55 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+10 is 4.869526e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.247073 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0427e+01
  </log>
  <optVariables href="FORM2.s044.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -22.8084
    reference variance = 0.240935
====================================================
  Execution time = 2.4371e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s044
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4956e-01
  Total weights = 1.9649e+06
  Execution time = 3.4858e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436040388575
                                         uncertainty =       0.002064953010

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436040388575
                                         uncertainty =       0.002064953010

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466878506
  error estimate for blocks of size 2^( 2) =       0.000492545266
  error estimate for blocks of size 2^( 3) =       0.000516651183
  error estimate for blocks of size 2^( 4) =       0.000535056322
  error estimate for blocks of size 2^( 5) =       0.000546739648
  error estimate for blocks of size 2^( 6) =       0.000553369822
  error estimate for blocks of size 2^( 7) =       0.000559614755

      target function =      -0.745710729519
              le_mean =     -22.814800183868
             les_mean =     520.964671179114
             stat err =       0.000548695137
             autocorr =       1.381193293931
   target nu stat err =       0.000548695137
   target dn stat err =       0.002793059054
      target stat err =       0.002396829663
              std dev =       0.660265914924
             le_variance =       0.435951078411

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436040388575
                                         uncertainty =       0.002064953010

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436040388575
                                         uncertainty =       0.002064953010

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466878506
  error estimate for blocks of size 2^( 2) =       0.000492545266
  error estimate for blocks of size 2^( 3) =       0.000516651183
  error estimate for blocks of size 2^( 4) =       0.000535056322
  error estimate for blocks of size 2^( 5) =       0.000546739648
  error estimate for blocks of size 2^( 6) =       0.000553369822
  error estimate for blocks of size 2^( 7) =       0.000559614755

      target function =      -0.745710729519
              le_mean =     -22.814800183868
             les_mean =     520.964671179115
             stat err =       0.000548695137
             autocorr =       1.381193293926
   target nu stat err =       0.000548695137
   target dn stat err =       0.002793059054
      target stat err =       0.002396829663
              std dev =       0.660265914924
             le_variance =       0.435951078411

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436040388575
                                         uncertainty =       0.002064953010

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436040388575
                                         uncertainty =       0.002064953010

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466878506
  error estimate for blocks of size 2^( 2) =       0.000492545266
  error estimate for blocks of size 2^( 3) =       0.000516651183
  error estimate for blocks of size 2^( 4) =       0.000535056322
  error estimate for blocks of size 2^( 5) =       0.000546739648
  error estimate for blocks of size 2^( 6) =       0.000553369822
  error estimate for blocks of size 2^( 7) =       0.000559614755

      target function =      -0.745710729519
              le_mean =     -22.814800183868
             les_mean =     520.964671179115
             stat err =       0.000548695137
             autocorr =       1.381193293927
   target nu stat err =       0.000548695137
   target dn stat err =       0.002793059054
      target stat err =       0.002396829663
              std dev =       0.660265914925
             le_variance =       0.435951078411

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436040388575
                                         uncertainty =       0.002064953010

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436040388575
                                         uncertainty =       0.002064953010

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466878506
  error estimate for blocks of size 2^( 2) =       0.000492545266
  error estimate for blocks of size 2^( 3) =       0.000516651183
  error estimate for blocks of size 2^( 4) =       0.000535056322
  error estimate for blocks of size 2^( 5) =       0.000546739648
  error estimate for blocks of size 2^( 6) =       0.000553369822
  error estimate for blocks of size 2^( 7) =       0.000559614755

      target function =      -0.745710729519
              le_mean =     -22.814800183868
             les_mean =     520.964671179114
             stat err =       0.000548695137
             autocorr =       1.381193293929
   target nu stat err =       0.000548695137
   target dn stat err =       0.002793059054
      target stat err =       0.002396829663
              std dev =       0.660265914924
             le_variance =       0.435951078411


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745710729519        initial  <--
     3.6380e+09     3.6380e+10             7.8197e-14        -0.745710729519
     1.4552e+10     1.4552e+11             1.9632e-14        -0.745710729519
     5.8208e+10     5.8208e+11             4.8695e-15        -0.745710729519

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 41.8068
  </log>
  <optVariables href="FORM2.s044.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2241e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s045 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s045 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=45  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2811e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -22.8791
    reference variance = 0.420768
====================================================
  Execution time = 2.5063e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s045
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5342e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5099e-01
  Total weights = 1.964722777e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5145e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434282469777
                                         uncertainty =       0.002056224513

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434282469777
                                         uncertainty =       0.002056224513

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465988635
  error estimate for blocks of size 2^( 2) =       0.000491521926
  error estimate for blocks of size 2^( 3) =       0.000515805247
  error estimate for blocks of size 2^( 4) =       0.000533682235
  error estimate for blocks of size 2^( 5) =       0.000545037625
  error estimate for blocks of size 2^( 6) =       0.000552257516
  error estimate for blocks of size 2^( 7) =       0.000557251045

      target function =      -0.744519585965
              le_mean =     -22.814364703071
             les_mean =     520.946224108974
             stat err =       0.000547057106
             autocorr =       1.378207715165
   target nu stat err =       0.000547057106
   target dn stat err =       0.004639742510
      target stat err =       0.003883258425
              std dev =       0.659007447683
             le_variance =       0.434290816101


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281436470307e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+10, overlap shift 3.6380e+11 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744538852623       residual = 1.17e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744538852623       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744538852623       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744541127155       residual = 6.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744538852623       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744540941112       residual = 3.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744566271130       residual = 8.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744481975720       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744499931145       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744531806874       residual = 4.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744556733278       residual = 5.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.744559826732       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.744525146469       residual = 2.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.744573940938       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.744595513418       residual = 3.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.744523381829       residual = 4.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.744545966460       residual = 3.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.744586053838       residual = 6.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.744523167913       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.744526857681       residual = 2.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.744536805606       residual = 5.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.744542909268       residual = 8.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.744531038920       residual = 8.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.744549843889       residual = 7.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.744540571028       residual = 8.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.744538952082       residual = 4.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.744530389941       residual = 7.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.744538810973       residual = 7.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.744535059973       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.744537023003       residual = 8.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.744507128752       residual = 5.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.744558308608       residual = 6.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.744556994691       residual = 5.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.744519489491       residual = 6.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.744557861327       residual = 7.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.744531123206       residual = 2.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.744539546592       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.744544985295       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.744561812432       residual = 3.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.744527929730       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.744517734026       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.744523336296       residual = 5.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.744556625402       residual = 7.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.744547054824       residual = 3.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.744533462938       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.744539188715       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.744538137961       residual = 2.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.744537934920       residual = 4.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.744553918171       residual = 2.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.744540722760       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.744537037933       residual = 2.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.744534058598       residual = 3.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.744542298312       residual = 8.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.744530440104       residual = 3.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.744529220830       residual = 3.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   tar_fn =      -0.744536583401       residual = 5.73e-07           smallest_sin_value = 9.98e-01
davidson iteration   56 stopping due to small subspace S singular value of 9.90e-01
davidson solver did not converge after         56 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+10 is 1.007054e-14

solving harmonic davidson linear method for identity shift 1.4552e+11, overlap shift 1.4552e+12 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744538852623       residual = 1.17e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744538852623       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744538852623       residual = 1.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744538852623       residual = 6.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744538852623       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744557314666       residual = 3.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744538852623       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744538852623       residual = 2.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744256829379       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744417019562       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744605458492       residual = 5.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.744402153262       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.744554871035       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.744307092397       residual = 5.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.744457542331       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.744400770193       residual = 7.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.744480520821       residual = 6.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.744551069849       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.744507519783       residual = 9.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.744938138354       residual = 5.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.744546100174       residual = 4.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.744723085534       residual = 8.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.744732764304       residual = 5.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.744463394258       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.744319202468       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.744476464112       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.744179907079       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.744629660810       residual = 2.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.744425664963       residual = 4.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.744687710561       residual = 3.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.744408238581       residual = 2.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.744749305331       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.744731366899       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.744630828580       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.744446847741       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.744560069549       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.744786492350       residual = 7.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.744602964952       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.744392896275       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.744516974483       residual = 9.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.744405263464       residual = 9.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.744685494227       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.744428483904       residual = 9.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.744312182654       residual = 3.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.744461791455       residual = 5.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.744244840710       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.744561119229       residual = 4.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.744654965990       residual = 4.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.744534503026       residual = 5.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.744788351260       residual = 7.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.744875406705       residual = 9.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.744570256766       residual = 6.39e-06           smallest_sin_value = 9.99e-01
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.744787108698       residual = 1.16e-05           smallest_sin_value = 9.94e-01
davidson iteration   53 stopping due to small subspace S singular value of 9.69e-01
davidson solver did not converge after         53 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+11 is 2.519245e-15

solving harmonic davidson linear method for identity shift 5.8208e+11, overlap shift 5.8208e+12 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744538852623       residual = 1.17e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744538852623       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744538852623       residual = 1.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744809191648       residual = 5.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744838248414       residual = 3.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744651918231       residual = 5.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745097120371       residual = 5.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745969096447       residual = 3.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744290720995       residual = 8.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743895109144       residual = 7.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744916868743       residual = 5.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743480943114       residual = 2.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.745237902467       residual = 2.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.744184412853       residual = 5.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.744678076957       residual = 2.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.744542731393       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.744121724837       residual = 5.64e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.743900867044       residual = 3.76e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.743707757846       residual = 8.75e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.744582529125       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.744469510020       residual = 2.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.745072000114       residual = 2.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.745828384664       residual = 3.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.745440724701       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.744929176541       residual = 3.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.744321243252       residual = 1.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.745640235084       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.744807047422       residual = 2.35e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.744688254132       residual = 9.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.744633171812       residual = 2.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.744127436851       residual = 6.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.744457661187       residual = 4.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.744747175002       residual = 2.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.744514099273       residual = 2.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.744512547064       residual = 2.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.744459701928       residual = 3.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.744408213756       residual = 2.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.745087961793       residual = 2.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.744925269478       residual = 5.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.744260536386       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.744593470205       residual = 6.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.744914858021       residual = 6.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.744333247290       residual = 2.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.744172920955       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.744652298636       residual = 9.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.744521798647       residual = 4.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.744520950913       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.744357583822       residual = 7.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.744193813666       residual = 3.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.744305333058       residual = 2.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.744505812869       residual = 5.82e-05           smallest_sin_value = 9.99e-01
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.744561665127       residual = 9.84e-05           smallest_sin_value = 9.97e-01
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.744736707723       residual = 1.30e-04           smallest_sin_value = 9.96e-01
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.744244221236       residual = 5.56e-05           smallest_sin_value = 9.94e-01
davidson iteration   54:   krylov dim =  55   tar_fn =      -0.744252143604       residual = 5.48e-05           smallest_sin_value = 9.94e-01
davidson iteration   55 stopping due to small subspace S singular value of 9.86e-01
davidson solver did not converge after         55 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+11 is 6.340364e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.439689 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9776e+01
  </log>
  <optVariables href="FORM2.s045.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -22.8339
    reference variance = 0.260031
====================================================
  Execution time = 2.6637e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s045
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5263e-01
  Total weights = 1.9646e+06
  Execution time = 3.5158e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438284326320
                                         uncertainty =       0.002256506917

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438284326320
                                         uncertainty =       0.002256506917

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468085690
  error estimate for blocks of size 2^( 2) =       0.000493482982
  error estimate for blocks of size 2^( 3) =       0.000517393719
  error estimate for blocks of size 2^( 4) =       0.000535687194
  error estimate for blocks of size 2^( 5) =       0.000547437360
  error estimate for blocks of size 2^( 6) =       0.000553780696
  error estimate for blocks of size 2^( 7) =       0.000556248589

      target function =      -0.743176145170
              le_mean =     -22.814764991393
             les_mean =     520.966128972046
             stat err =       0.000548288460
             autocorr =       1.372042235464
   target nu stat err =       0.000548288460
   target dn stat err =       0.003020928751
      target stat err =       0.002562875984
              std dev =       0.661973131824
             le_variance =       0.438208427257

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438284326320
                                         uncertainty =       0.002256506917

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438284326320
                                         uncertainty =       0.002256506917

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468085690
  error estimate for blocks of size 2^( 2) =       0.000493482982
  error estimate for blocks of size 2^( 3) =       0.000517393719
  error estimate for blocks of size 2^( 4) =       0.000535687194
  error estimate for blocks of size 2^( 5) =       0.000547437360
  error estimate for blocks of size 2^( 6) =       0.000553780696
  error estimate for blocks of size 2^( 7) =       0.000556248589

      target function =      -0.743176145170
              le_mean =     -22.814764991393
             les_mean =     520.966128972046
             stat err =       0.000548288460
             autocorr =       1.372042235465
   target nu stat err =       0.000548288460
   target dn stat err =       0.003020928751
      target stat err =       0.002562875984
              std dev =       0.661973131824
             le_variance =       0.438208427257

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438284326320
                                         uncertainty =       0.002256506917

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438284326320
                                         uncertainty =       0.002256506917

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468085690
  error estimate for blocks of size 2^( 2) =       0.000493482982
  error estimate for blocks of size 2^( 3) =       0.000517393719
  error estimate for blocks of size 2^( 4) =       0.000535687194
  error estimate for blocks of size 2^( 5) =       0.000547437360
  error estimate for blocks of size 2^( 6) =       0.000553780696
  error estimate for blocks of size 2^( 7) =       0.000556248589

      target function =      -0.743176145170
              le_mean =     -22.814764991393
             les_mean =     520.966128972046
             stat err =       0.000548288460
             autocorr =       1.372042235473
   target nu stat err =       0.000548288460
   target dn stat err =       0.003020928751
      target stat err =       0.002562875984
              std dev =       0.661973131824
             le_variance =       0.438208427257

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438284326320
                                         uncertainty =       0.002256506917

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438284326320
                                         uncertainty =       0.002256506917

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468085690
  error estimate for blocks of size 2^( 2) =       0.000493482982
  error estimate for blocks of size 2^( 3) =       0.000517393719
  error estimate for blocks of size 2^( 4) =       0.000535687194
  error estimate for blocks of size 2^( 5) =       0.000547437360
  error estimate for blocks of size 2^( 6) =       0.000553780696
  error estimate for blocks of size 2^( 7) =       0.000556248589

      target function =      -0.743176145170
              le_mean =     -22.814764991393
             les_mean =     520.966128972046
             stat err =       0.000548288460
             autocorr =       1.372042235470
   target nu stat err =       0.000548288460
   target dn stat err =       0.003020928751
      target stat err =       0.002562875984
              std dev =       0.661973131824
             le_variance =       0.438208427257


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743176145170        initial  <--
     3.6380e+10     3.6380e+11             1.0071e-14        -0.743176145170
     1.4552e+11     1.4552e+12             2.5192e-15        -0.743176145170
     5.8208e+11     5.8208e+12             6.3404e-16        -0.743176145170

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.1515
  </log>
  <optVariables href="FORM2.s045.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3934e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s046 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s046 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=46  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2812e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -22.8312
    reference variance = 0.316984
====================================================
  Execution time = 2.5084e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s046
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5355e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4859e-01
  Total weights = 1.964897575e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4909e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436279369314
                                         uncertainty =       0.001820953251

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436279369314
                                         uncertainty =       0.001820953251

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467028565
  error estimate for blocks of size 2^( 2) =       0.000492606125
  error estimate for blocks of size 2^( 3) =       0.000516852130
  error estimate for blocks of size 2^( 4) =       0.000535031677
  error estimate for blocks of size 2^( 5) =       0.000547413132
  error estimate for blocks of size 2^( 6) =       0.000552634938
  error estimate for blocks of size 2^( 7) =       0.000554669994

      target function =      -0.746516585310
              le_mean =     -22.814358817927
             les_mean =     520.943562389230
             stat err =       0.000547437435
             autocorr =       1.373985329212
   target nu stat err =       0.000547437435
   target dn stat err =       0.002634115142
      target stat err =       0.002272389227
              std dev =       0.660478131189
             le_variance =       0.436231361778


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281435881793e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+11, overlap shift 3.6380e+12 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746522507722       residual = 2.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746522507722       residual = 3.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746522507722       residual = 8.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746522507722       residual = 3.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746522507722       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746522507722       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746630659792       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745925628514       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747555861040       residual = 1.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746500563994       residual = 3.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746343731181       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746436704471       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.746042101319       residual = 2.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.747378483466       residual = 5.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.747315953581       residual = 6.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.746424431071       residual = 6.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.745758708246       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.746539842622       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.746433196242       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.745932997769       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.745884996862       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.746486485822       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.746487885259       residual = 9.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.745879317898       residual = 8.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.746826673812       residual = 9.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.746868375171       residual = 7.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.746832491781       residual = 4.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.747270562409       residual = 4.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.747247936763       residual = 4.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.746594726618       residual = 5.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.747146027775       residual = 3.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.746637402769       residual = 2.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.745999814309       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.746002999782       residual = 3.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.747150993972       residual = 9.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.746965850482       residual = 8.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.746781114853       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.746080962330       residual = 6.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.746463527401       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.746493029090       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.746418090747       residual = 6.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.746253780847       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.746970658328       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.746513159667       residual = 7.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.746485983325       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.746284530014       residual = 1.60e-05           smallest_sin_value = 9.98e-01
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.747073190173       residual = 4.13e-05           smallest_sin_value = 9.94e-01
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.746795102187       residual = 1.33e-05           smallest_sin_value = 9.94e-01
davidson iteration   48 stopping due to small subspace S singular value of 9.73e-01
davidson solver did not converge after         48 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+11 is 9.544836e-16

solving harmonic davidson linear method for identity shift 1.4552e+12, overlap shift 1.4552e+13 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746522507722       residual = 2.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746522507722       residual = 3.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746522507722       residual = 8.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746522507722       residual = 3.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746517493553       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745647225115       residual = 3.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746093728148       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746463211673       residual = 8.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743552887184       residual = 2.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748307949648       residual = 4.46e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745930088584       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.745529404141       residual = 3.38e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.749506767236       residual = 4.40e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.749791050485       residual = 6.72e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.751927289774       residual = 6.59e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.747721364040       residual = 8.19e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.747166595659       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.741817529445       residual = 2.48e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.746693729338       residual = 6.10e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.746916633515       residual = 8.20e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.746140738946       residual = 8.63e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.747958685041       residual = 5.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.746562517393       residual = 3.64e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.746537393124       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.746560889895       residual = 6.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.746657338117       residual = 4.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.747235982660       residual = 2.35e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.745957333040       residual = 9.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.746868734982       residual = 2.14e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.746688319751       residual = 2.37e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.745377654956       residual = 3.69e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.746254288421       residual = 1.58e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.745444529144       residual = 1.53e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.745526802004       residual = 3.19e-03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.746281365471       residual = 9.30e-03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.746734599977       residual = 7.62e-03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.746039837933       residual = 4.16e-03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.745715762034       residual = 2.69e-03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.745877338203       residual = 1.30e-03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.746087620051       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.746200911778       residual = 1.60e-03           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.746640869316       residual = 1.42e-03           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.746660908897       residual = 1.32e-03           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.746984811857       residual = 7.38e-04           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.746902055838       residual = 8.19e-04           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.746732966843       residual = 1.14e-03           smallest_sin_value = 9.99e-01
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.746613815728       residual = 5.80e-04           smallest_sin_value = 9.99e-01
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.745984667791       residual = 6.69e-04           smallest_sin_value = 9.99e-01
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.746387220223       residual = 5.47e-04           smallest_sin_value = 9.97e-01
davidson iteration   49 stopping due to small subspace S singular value of 9.86e-01
davidson solver did not converge after         49 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+12 is 2.363686e-16

solving harmonic davidson linear method for identity shift 5.8208e+12, overlap shift 5.8208e+13 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746522507722       residual = 2.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746522507722       residual = 3.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746522507722       residual = 8.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746522507722       residual = 8.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746522507722       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746522519583       residual = 3.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745576685197       residual = 2.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747385598037       residual = 8.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.739003381691       residual = 5.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.724185091152       residual = 2.78e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741376796495       residual = 4.73e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.756513925467       residual = 6.43e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.743909062700       residual = 1.55e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.746121996531       residual = 3.28e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.749319839457       residual = 6.65e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.757259044943       residual = 7.94e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.746561597145       residual = 6.96e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.756123297800       residual = 1.41e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.746436407087       residual = 6.93e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.746116808000       residual = 8.07e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.752631423341       residual = 1.30e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.759142630285       residual = 4.70e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.750964672093       residual = 7.35e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.748154417663       residual = 1.19e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.744006828528       residual = 7.35e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.746162195337       residual = 6.82e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.765868395199       residual = 4.76e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.743095670046       residual = 1.64e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.748982395847       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.745623464778       residual = 1.08e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.746179542764       residual = 6.01e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.745201738397       residual = 2.62e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.753485405520       residual = 3.00e-02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.745042219437       residual = 2.02e-02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.737313929561       residual = 1.29e-02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.742511637317       residual = 1.15e-02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.742414127252       residual = 7.19e-03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.740699490984       residual = 1.08e-02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.746108846162       residual = 4.90e-03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.751628192161       residual = 9.24e-03           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.744654343275       residual = 8.97e-03           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.749170351912       residual = 5.99e-03           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.748323642625       residual = 4.23e-03           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.743544938985       residual = 4.99e-03           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.759038592945       residual = 1.14e-02           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.750976101088       residual = 1.06e-02           smallest_sin_value = 9.99e-01
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.745421028515       residual = 7.02e-03           smallest_sin_value = 9.98e-01
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.752739135743       residual = 1.67e-02           smallest_sin_value = 9.96e-01
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.752191792073       residual = 8.71e-03           smallest_sin_value = 9.94e-01
davidson iteration   49 stopping due to small subspace S singular value of 9.73e-01
davidson solver did not converge after         49 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+12 is 5.350184e-17

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.577971 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9718e+01
  </log>
  <optVariables href="FORM2.s046.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -22.8494
    reference variance = 0.486007
====================================================
  Execution time = 2.4480e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s046
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5262e-01
  Total weights = 1.9648e+06
  Execution time = 3.4999e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436114420094
                                         uncertainty =       0.002005155088

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436114420094
                                         uncertainty =       0.002005155088

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467001973
  error estimate for blocks of size 2^( 2) =       0.000492847431
  error estimate for blocks of size 2^( 3) =       0.000517428418
  error estimate for blocks of size 2^( 4) =       0.000534955017
  error estimate for blocks of size 2^( 5) =       0.000547609639
  error estimate for blocks of size 2^( 6) =       0.000553641663
  error estimate for blocks of size 2^( 7) =       0.000558980694

      target function =      -0.743177532323
              le_mean =     -22.813937703719
             les_mean =     520.928369362810
             stat err =       0.000548796753
             autocorr =       1.380974429178
   target nu stat err =       0.000548796753
   target dn stat err =       0.004616536018
      target stat err =       0.003848416826
              std dev =       0.660440523214
             le_variance =       0.436181684703

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436114420094
                                         uncertainty =       0.002005155088

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436114420094
                                         uncertainty =       0.002005155088

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467001973
  error estimate for blocks of size 2^( 2) =       0.000492847431
  error estimate for blocks of size 2^( 3) =       0.000517428418
  error estimate for blocks of size 2^( 4) =       0.000534955017
  error estimate for blocks of size 2^( 5) =       0.000547609639
  error estimate for blocks of size 2^( 6) =       0.000553641663
  error estimate for blocks of size 2^( 7) =       0.000558980694

      target function =      -0.743177532323
              le_mean =     -22.813937703719
             les_mean =     520.928369362810
             stat err =       0.000548796753
             autocorr =       1.380974429172
   target nu stat err =       0.000548796753
   target dn stat err =       0.004616536018
      target stat err =       0.003848416826
              std dev =       0.660440523214
             le_variance =       0.436181684703

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436114420094
                                         uncertainty =       0.002005155088

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436114420094
                                         uncertainty =       0.002005155088

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467001973
  error estimate for blocks of size 2^( 2) =       0.000492847431
  error estimate for blocks of size 2^( 3) =       0.000517428418
  error estimate for blocks of size 2^( 4) =       0.000534955017
  error estimate for blocks of size 2^( 5) =       0.000547609639
  error estimate for blocks of size 2^( 6) =       0.000553641663
  error estimate for blocks of size 2^( 7) =       0.000558980694

      target function =      -0.743177532323
              le_mean =     -22.813937703719
             les_mean =     520.928369362810
             stat err =       0.000548796753
             autocorr =       1.380974429170
   target nu stat err =       0.000548796753
   target dn stat err =       0.004616536018
      target stat err =       0.003848416826
              std dev =       0.660440523214
             le_variance =       0.436181684703

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436114420094
                                         uncertainty =       0.002005155088

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436114420094
                                         uncertainty =       0.002005155088

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467001973
  error estimate for blocks of size 2^( 2) =       0.000492847431
  error estimate for blocks of size 2^( 3) =       0.000517428418
  error estimate for blocks of size 2^( 4) =       0.000534955017
  error estimate for blocks of size 2^( 5) =       0.000547609639
  error estimate for blocks of size 2^( 6) =       0.000553641663
  error estimate for blocks of size 2^( 7) =       0.000558980694

      target function =      -0.743177532323
              le_mean =     -22.813937703719
             les_mean =     520.928369362810
             stat err =       0.000548796753
             autocorr =       1.380974429178
   target nu stat err =       0.000548796753
   target dn stat err =       0.004616536018
      target stat err =       0.003848416826
              std dev =       0.660440523214
             le_variance =       0.436181684703


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743177532323        initial
     3.6380e+11     3.6380e+12             9.5448e-16        -0.743177532323
     1.4552e+12     1.4552e+13             2.3637e-16        -0.743177532323
     5.8208e+12     5.8208e+13             5.3502e-17        -0.743177532323  <--

*****************************************************************************
Applying the update for shift_i =   5.8208e+12     and shift_s =   5.8208e+13
*****************************************************************************

  Execution time = 4.1979e+01
  </log>
  <optVariables href="FORM2.s046.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.1705e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s047 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s047 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=47  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2813e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -22.8272
    reference variance = 0.341798
====================================================
  Execution time = 2.5068e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s047
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5372e+04
  VMC Eavg = -2.2813e+01
  VMC Evar = 4.4696e-01
  Total weights = 1.964843145e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5084e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433985040181
                                         uncertainty =       0.001916618533

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433985040181
                                         uncertainty =       0.001916618533

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465894489
  error estimate for blocks of size 2^( 2) =       0.000491585678
  error estimate for blocks of size 2^( 3) =       0.000516096276
  error estimate for blocks of size 2^( 4) =       0.000533896826
  error estimate for blocks of size 2^( 5) =       0.000546396952
  error estimate for blocks of size 2^( 6) =       0.000552926582
  error estimate for blocks of size 2^( 7) =       0.000554355863

      target function =      -0.747869211833
              le_mean =     -22.813165199875
             les_mean =     520.887468823042
             stat err =       0.000546894056
             autocorr =       1.377943020087
   target nu stat err =       0.000546894056
   target dn stat err =       0.002799183597
      target stat err =       0.002408832552
              std dev =       0.658874305075
             le_variance =       0.434115349888


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281316519987e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+12, overlap shift 1.4552e+13 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747875883480       residual = 2.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747875883480       residual = 7.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747875883480       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747875883480       residual = 2.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747875883478       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748464358174       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748301797834       residual = 1.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748402540704       residual = 3.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749013630177       residual = 7.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746537314923       residual = 3.05e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745207600922       residual = 2.64e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.747174230657       residual = 5.11e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.748049943644       residual = 8.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.747223480311       residual = 1.95e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.746385797252       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.748037896298       residual = 3.61e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.749022855132       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.750289352560       residual = 1.92e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.748496082175       residual = 5.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.748219462140       residual = 1.00e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.749171580561       residual = 9.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.745990714777       residual = 2.89e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.748171103624       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.749595969263       residual = 1.07e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.748052209137       residual = 2.87e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.748284163227       residual = 6.09e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.752095776167       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.745025073818       residual = 4.56e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.752567081789       residual = 3.19e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.747631642890       residual = 6.32e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.747439225435       residual = 1.11e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.747993040369       residual = 1.54e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.748877830995       residual = 2.63e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.747641338230       residual = 9.80e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.749573455106       residual = 8.20e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.747291818610       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.747221452751       residual = 7.11e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.749557546502       residual = 2.32e-04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.748641713254       residual = 2.86e-04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.748529708159       residual = 2.22e-04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.748570291821       residual = 2.08e-04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.746209959430       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.748054297670       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.747407811844       residual = 2.68e-04           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.748228633265       residual = 2.51e-04           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.746670448781       residual = 7.65e-04           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.747697526492       residual = 2.62e-04           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.749660716295       residual = 2.82e-04           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.746383728324       residual = 2.20e-04           smallest_sin_value = 9.98e-01
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.747351866906       residual = 3.23e-04           smallest_sin_value = 9.93e-01
davidson iteration   50 stopping due to small subspace S singular value of 9.47e-01
davidson solver did not converge after         50 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+12 is 1.327912e-16

solving harmonic davidson linear method for identity shift 5.8208e+12, overlap shift 5.8208e+13 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747875883480       residual = 2.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747875883480       residual = 7.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747875883480       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747875883479       residual = 2.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747875883447       residual = 6.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748847373991       residual = 7.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749487643820       residual = 5.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746721943746       residual = 8.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.738227798664       residual = 4.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.765626691269       residual = 8.63e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.759470904553       residual = 1.19e-02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.747251497396       residual = 1.58e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.755413136535       residual = 4.84e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.751353690925       residual = 2.22e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.750885575994       residual = 2.30e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.748706903043       residual = 1.90e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.750482215715       residual = 3.25e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.749433077322       residual = 2.04e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.762615772875       residual = 3.71e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.738384058784       residual = 4.44e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.760801142155       residual = 1.84e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.739073558108       residual = 6.26e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.750157125217       residual = 8.40e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.749575654823       residual = 3.24e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.747278087573       residual = 4.14e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.746907696189       residual = 7.96e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.748645755502       residual = 1.13e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.750893732513       residual = 5.50e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.747677699359       residual = 9.72e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.742888053084       residual = 6.68e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.746589156241       residual = 1.18e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.750504081071       residual = 1.07e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.765890865621       residual = 1.47e-02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.747665457112       residual = 1.42e-02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.735159062388       residual = 9.08e-03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.745991059404       residual = 8.63e-03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.752030765896       residual = 9.66e-03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.743933125640       residual = 1.99e-02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.756412917067       residual = 1.92e-02           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.750782207138       residual = 2.74e-02           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.743160316256       residual = 4.73e-02           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.741541869287       residual = 5.42e-02           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.743190138754       residual = 1.22e-01           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.747175245924       residual = 1.51e-02           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.749406964201       residual = 1.01e-02           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.747375152243       residual = 4.12e-03           smallest_sin_value = 9.99e-01
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.742660312260       residual = 4.61e-03           smallest_sin_value = 9.97e-01
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.741479511637       residual = 6.56e-03           smallest_sin_value = 9.95e-01
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.751774516262       residual = 6.15e-03           smallest_sin_value = 9.95e-01
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.755022125418       residual = 8.76e-03           smallest_sin_value = 9.94e-01
davidson iteration   50 stopping due to small subspace S singular value of 9.87e-01
davidson solver did not converge after         50 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+12 is 3.240493e-17

solving harmonic davidson linear method for identity shift 2.3283e+13, overlap shift 2.3283e+14 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747875883480       residual = 2.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747875883480       residual = 7.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747875883480       residual = 9.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747875883480       residual = 2.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747875883547       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747875841661       residual = 2.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.768929448201       residual = 3.51e-02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.732326539512       residual = 9.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.727408532181       residual = 2.13e-01           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.760298407394       residual = 3.85e-02           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746696750353       residual = 5.37e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.763188452044       residual = 9.97e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.771261471090       residual = 4.04e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.741794493256       residual = 5.41e-01           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.746560936124       residual = 4.50e-01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.728358283357       residual = 6.67e-01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.741613791087       residual = 5.52e-01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.759740763047       residual = 2.76e-01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.753031858419       residual = 8.66e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.747584586386       residual = 8.68e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.756759022502       residual = 1.27e-01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.759989654241       residual = 1.13e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.767300340591       residual = 4.39e-01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.755410783011       residual = 6.40e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.759679091980       residual = 5.49e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.755484876336       residual = 2.78e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.774220859488       residual = 3.93e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.748752045545       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.755686824778       residual = 3.61e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.789963652528       residual = 2.38e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.736959009346       residual = 3.32e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.749672419048       residual = 2.56e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.779376104761       residual = 4.75e-02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.758934809361       residual = 1.19e-01           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.756994583850       residual = 4.80e-02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.720962289619       residual = 8.23e-02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.740956004712       residual = 4.08e-02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.743052571055       residual = 1.93e-02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.746630365765       residual = 1.05e-02           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.743090582049       residual = 4.08e-02           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.744222599733       residual = 4.33e-02           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.752877999474       residual = 8.58e-03           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.754864430716       residual = 1.79e-02           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.747379107002       residual = 1.31e-02           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.743835270301       residual = 8.17e-02           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.760840108735       residual = 3.27e-01           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.755905219975       residual = 6.08e-01           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.754101801293       residual = 6.39e-02           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.745046460695       residual = 2.85e-02           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.737834252642       residual = 1.99e-02           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.726201972503       residual = 9.12e-02           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.764440677733       residual = 1.02e-01           smallest_sin_value = 9.99e-01
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.738672477224       residual = 6.47e-02           smallest_sin_value = 9.95e-01
davidson iteration   53 stopping due to small subspace S singular value of 9.86e-01
davidson solver did not converge after         53 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+13 is 8.076179e-18

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.733202 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9737e+01
  </log>
  <optVariables href="FORM2.s047.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -22.7502
    reference variance = 0.261613
====================================================
  Execution time = 2.4455e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s047
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4610e-01
  Total weights = 1.9647e+06
  Execution time = 3.7369e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434514381173
                                         uncertainty =       0.001900489129

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434514381173
                                         uncertainty =       0.001900489129

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466172952
  error estimate for blocks of size 2^( 2) =       0.000491995280
  error estimate for blocks of size 2^( 3) =       0.000516448856
  error estimate for blocks of size 2^( 4) =       0.000534381248
  error estimate for blocks of size 2^( 5) =       0.000544649268
  error estimate for blocks of size 2^( 6) =       0.000550542664
  error estimate for blocks of size 2^( 7) =       0.000553760488

      target function =      -0.748600551329
              le_mean =     -22.815325623109
             les_mean =     520.985181491828
             stat err =       0.000545833417
             autocorr =       1.370964149434
   target nu stat err =       0.000545833417
   target dn stat err =       0.002540382747
      target stat err =       0.002211950612
              std dev =       0.659268110886
             le_variance =       0.434634442032

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434514381173
                                         uncertainty =       0.001900489129

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434514381173
                                         uncertainty =       0.001900489129

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466172952
  error estimate for blocks of size 2^( 2) =       0.000491995280
  error estimate for blocks of size 2^( 3) =       0.000516448856
  error estimate for blocks of size 2^( 4) =       0.000534381248
  error estimate for blocks of size 2^( 5) =       0.000544649268
  error estimate for blocks of size 2^( 6) =       0.000550542664
  error estimate for blocks of size 2^( 7) =       0.000553760488

      target function =      -0.748600551329
              le_mean =     -22.815325623109
             les_mean =     520.985181491828
             stat err =       0.000545833417
             autocorr =       1.370964149434
   target nu stat err =       0.000545833417
   target dn stat err =       0.002540382747
      target stat err =       0.002211950612
              std dev =       0.659268110886
             le_variance =       0.434634442032

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434514381173
                                         uncertainty =       0.001900489129

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434514381173
                                         uncertainty =       0.001900489129

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466172952
  error estimate for blocks of size 2^( 2) =       0.000491995280
  error estimate for blocks of size 2^( 3) =       0.000516448856
  error estimate for blocks of size 2^( 4) =       0.000534381248
  error estimate for blocks of size 2^( 5) =       0.000544649268
  error estimate for blocks of size 2^( 6) =       0.000550542664
  error estimate for blocks of size 2^( 7) =       0.000553760488

      target function =      -0.748600551329
              le_mean =     -22.815325623109
             les_mean =     520.985181491828
             stat err =       0.000545833417
             autocorr =       1.370964149434
   target nu stat err =       0.000545833417
   target dn stat err =       0.002540382747
      target stat err =       0.002211950612
              std dev =       0.659268110886
             le_variance =       0.434634442032

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434514381173
                                         uncertainty =       0.001900489129

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434514381173
                                         uncertainty =       0.001900489129

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466172952
  error estimate for blocks of size 2^( 2) =       0.000491995280
  error estimate for blocks of size 2^( 3) =       0.000516448856
  error estimate for blocks of size 2^( 4) =       0.000534381248
  error estimate for blocks of size 2^( 5) =       0.000544649268
  error estimate for blocks of size 2^( 6) =       0.000550542664
  error estimate for blocks of size 2^( 7) =       0.000553760488

      target function =      -0.748600551329
              le_mean =     -22.815325623109
             les_mean =     520.985181491828
             stat err =       0.000545833417
             autocorr =       1.370964149434
   target nu stat err =       0.000545833417
   target dn stat err =       0.002540382747
      target stat err =       0.002211950612
              std dev =       0.659268110886
             le_variance =       0.434634442032


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748600551329        initial
     1.4552e+12     1.4552e+13             1.3279e-16        -0.748600551329
     5.8208e+12     5.8208e+13             3.2405e-17        -0.748600551329
     2.3283e+13     2.3283e+14             8.0762e-18        -0.748600551329  <--

*****************************************************************************
Applying the update for shift_i =   2.3283e+13     and shift_s =   2.3283e+14
*****************************************************************************

  Execution time = 4.2605e+01
  </log>
  <optVariables href="FORM2.s047.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2349e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s048 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s048 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=48  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2812e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -22.8156
    reference variance = 0.294901
====================================================
  Execution time = 2.5176e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s048
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5355e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5153e-01
  Total weights = 1.964713311e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4772e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437486879548
                                         uncertainty =       0.002426435636

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437486879548
                                         uncertainty =       0.002426435636

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467687647
  error estimate for blocks of size 2^( 2) =       0.000493120616
  error estimate for blocks of size 2^( 3) =       0.000517596500
  error estimate for blocks of size 2^( 4) =       0.000536370073
  error estimate for blocks of size 2^( 5) =       0.000548049450
  error estimate for blocks of size 2^( 6) =       0.000556658229
  error estimate for blocks of size 2^( 7) =       0.000559059599

      target function =      -0.744072088330
              le_mean =     -22.815121749898
             les_mean =     520.981313419491
             stat err =       0.000550034338
             autocorr =       1.383145305680
   target nu stat err =       0.000550034338
   target dn stat err =       0.003936081712
      target stat err =       0.003310395532
              std dev =       0.661410213341
             le_variance =       0.437463470312


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281512174990e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+12, overlap shift 5.8208e+13 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744085822825       residual = 1.88e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744085822825       residual = 2.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744085822825       residual = 4.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744085822825       residual = 2.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743821191566       residual = 4.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744085822825       residual = 2.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742901436375       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742711847818       residual = 7.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741090862834       residual = 6.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.750304548271       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.757401046065       residual = 1.04e-02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.731561986790       residual = 4.63e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.745985855670       residual = 4.50e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.751616022328       residual = 5.28e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.738479347391       residual = 2.33e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.745201444786       residual = 1.28e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.744724124127       residual = 1.46e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.744419842372       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.744175257796       residual = 1.80e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.739869943653       residual = 1.71e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.740797016178       residual = 1.47e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.743959352909       residual = 8.79e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.742874257315       residual = 2.89e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.740535362142       residual = 1.59e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.742229395695       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.745427722807       residual = 1.91e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.744203998092       residual = 3.65e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.745323283616       residual = 2.01e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.742516688167       residual = 1.87e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.746838333704       residual = 1.43e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.743450449360       residual = 4.44e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.741853649277       residual = 1.61e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.745227973530       residual = 3.19e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.746306804630       residual = 2.19e-02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.746146434246       residual = 3.35e-03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.743683527126       residual = 2.27e-03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.742397177897       residual = 7.13e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.741821321634       residual = 3.66e-02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.744016105422       residual = 3.03e-02           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.744965879367       residual = 7.23e-03           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.742694367541       residual = 1.94e-02           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.748122783956       residual = 1.06e-02           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.741300977425       residual = 9.38e-03           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.744317758978       residual = 7.26e-03           smallest_sin_value = 9.99e-01
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.742127341825       residual = 1.28e-02           smallest_sin_value = 9.97e-01
davidson iteration   45: stopping due to imaginary component in cost function
davidson solver did not converge after         45 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+12 is 2.694073e-17

solving harmonic davidson linear method for identity shift 2.3283e+13, overlap shift 2.3283e+14 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744085822825       residual = 1.88e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744085822825       residual = 2.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744085822825       residual = 7.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747513059901       residual = 4.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.726940343133       residual = 3.90e-02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.755030857249       residual = 4.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.734934213617       residual = 1.22e-01           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.751033926182       residual = 2.73e-02           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.760083698637       residual = 6.81e-02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.714492999243       residual = 7.80e-02           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.689818729322       residual = 8.75e-02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.689909462521       residual = 1.26e-01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.744742865841       residual = 2.09e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.743395952458       residual = 2.59e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.707080470058       residual = 9.84e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.766893565894       residual = 6.49e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.731721070756       residual = 1.23e-01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.718814959772       residual = 8.37e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.692374591537       residual = 6.39e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.717248923394       residual = 7.19e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.707767185819       residual = 6.08e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.753322501648       residual = 9.97e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.735639553748       residual = 4.35e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.759730503858       residual = 2.72e-01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.791088796894       residual = 1.24e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.732863286861       residual = 7.31e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.688266097801       residual = 9.50e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.737226958747       residual = 2.50e-01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.716525378747       residual = 8.47e-01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.770825402208       residual = 2.50e-01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.716931616530       residual = 2.90e-01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.683630534395       residual = 1.94e-01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.728056463751       residual = 8.90e-02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.759139010511       residual = 1.65e-01           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.705674615729       residual = 1.38e-01           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.739982967838       residual = 1.86e-01           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.775811297305       residual = 8.44e-02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.752584649369       residual = 2.90e-01           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.758031026954       residual = 1.16e-01           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.703726228529       residual = 1.72e-01           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.727149804520       residual = 6.80e-02           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.753317391152       residual = 7.43e-02           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.714234666028       residual = 6.55e-02           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.754681030450       residual = 1.04e-01           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.755409555574       residual = 6.53e-02           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.797770575428       residual = 1.02e-01           smallest_sin_value = 9.99e-01
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.725769872032       residual = 9.13e-02           smallest_sin_value = 9.97e-01
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.731971848075       residual = 1.32e-01           smallest_sin_value = 9.97e-01
davidson iteration   48 stopping due to small subspace S singular value of 9.88e-01
davidson solver did not converge after         48 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+13 is 5.127614e-18

solving harmonic davidson linear method for identity shift 9.3132e+13, overlap shift 9.3132e+14 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744085822825       residual = 1.88e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744085822825       residual = 2.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744085822825       residual = 1.88e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to small subspace S singular value of 6.21e-01
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+13 is 1.281904e-18

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.812812 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9738e+01
  </log>
  <optVariables href="FORM2.s048.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -22.8131
    reference variance = 0.323233
====================================================
  Execution time = 2.4464e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s048
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5297e-01
  Total weights = 1.9647e+06
  Execution time = 3.4962e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436398109719
                                         uncertainty =       0.002223525848

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436398109719
                                         uncertainty =       0.002223525848

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467140227
  error estimate for blocks of size 2^( 2) =       0.000492861483
  error estimate for blocks of size 2^( 3) =       0.000517194378
  error estimate for blocks of size 2^( 4) =       0.000534935519
  error estimate for blocks of size 2^( 5) =       0.000546305289
  error estimate for blocks of size 2^( 6) =       0.000551976578
  error estimate for blocks of size 2^( 7) =       0.000554652773

      target function =      -0.742863782131
              le_mean =     -22.814529331242
             les_mean =     520.955715846412
             stat err =       0.000546967540
             autocorr =       1.370971962208
   target nu stat err =       0.000546967540
   target dn stat err =       0.006779374444
      target stat err =       0.005613648339
              std dev =       0.660636044113
             le_variance =       0.436439982782

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436398109719
                                         uncertainty =       0.002223525848

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436398109719
                                         uncertainty =       0.002223525848

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467140227
  error estimate for blocks of size 2^( 2) =       0.000492861483
  error estimate for blocks of size 2^( 3) =       0.000517194378
  error estimate for blocks of size 2^( 4) =       0.000534935519
  error estimate for blocks of size 2^( 5) =       0.000546305289
  error estimate for blocks of size 2^( 6) =       0.000551976578
  error estimate for blocks of size 2^( 7) =       0.000554652773

      target function =      -0.742863782131
              le_mean =     -22.814529331242
             les_mean =     520.955715846412
             stat err =       0.000546967540
             autocorr =       1.370971962208
   target nu stat err =       0.000546967540
   target dn stat err =       0.006779374444
      target stat err =       0.005613648339
              std dev =       0.660636044113
             le_variance =       0.436439982782

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436398109719
                                         uncertainty =       0.002223525848

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436398109719
                                         uncertainty =       0.002223525848

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467140227
  error estimate for blocks of size 2^( 2) =       0.000492861483
  error estimate for blocks of size 2^( 3) =       0.000517194378
  error estimate for blocks of size 2^( 4) =       0.000534935519
  error estimate for blocks of size 2^( 5) =       0.000546305289
  error estimate for blocks of size 2^( 6) =       0.000551976578
  error estimate for blocks of size 2^( 7) =       0.000554652773

      target function =      -0.742863782131
              le_mean =     -22.814529331242
             les_mean =     520.955715846412
             stat err =       0.000546967540
             autocorr =       1.370971962208
   target nu stat err =       0.000546967540
   target dn stat err =       0.006779374444
      target stat err =       0.005613648339
              std dev =       0.660636044113
             le_variance =       0.436439982782

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436398109719
                                         uncertainty =       0.002223525848

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436398109719
                                         uncertainty =       0.002223525848

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467140227
  error estimate for blocks of size 2^( 2) =       0.000492861483
  error estimate for blocks of size 2^( 3) =       0.000517194378
  error estimate for blocks of size 2^( 4) =       0.000534935519
  error estimate for blocks of size 2^( 5) =       0.000546305289
  error estimate for blocks of size 2^( 6) =       0.000551976578
  error estimate for blocks of size 2^( 7) =       0.000554652773

      target function =      -0.742863782131
              le_mean =     -22.814529331242
             les_mean =     520.955715846412
             stat err =       0.000546967540
             autocorr =       1.370971962207
   target nu stat err =       0.000546967540
   target dn stat err =       0.006779374444
      target stat err =       0.005613648339
              std dev =       0.660636044113
             le_variance =       0.436439982782


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.742863782131        initial  <--
     5.8208e+12     5.8208e+13             2.6941e-17        -0.742863782131
     2.3283e+13     2.3283e+14             5.1276e-18        -0.742863782131
     9.3132e+13     9.3132e+14             1.2819e-18        -0.742863782131

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 41.9790
  </log>
  <optVariables href="FORM2.s048.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.1726e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s049 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s049 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=49  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2812e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -22.8467
    reference variance = 0.382054
====================================================
  Execution time = 2.5220e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s049
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5330e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4733e-01
  Total weights = 1.964549935e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5147e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435697945064
                                         uncertainty =       0.002488430184

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435697945064
                                         uncertainty =       0.002488430184

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466738768
  error estimate for blocks of size 2^( 2) =       0.000492439627
  error estimate for blocks of size 2^( 3) =       0.000516659981
  error estimate for blocks of size 2^( 4) =       0.000534936505
  error estimate for blocks of size 2^( 5) =       0.000547228953
  error estimate for blocks of size 2^( 6) =       0.000553813202
  error estimate for blocks of size 2^( 7) =       0.000559293042

      target function =      -0.747564102225
              le_mean =     -22.814442284773
             les_mean =     520.946106882345
             stat err =       0.000548817926
             autocorr =       1.382639072502
   target nu stat err =       0.000548817926
   target dn stat err =       0.003470646071
      target stat err =       0.002956846138
              std dev =       0.660068295356
             le_variance =       0.435690154535


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281444228477e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+13, overlap shift 5.8208e+14 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747574707561       residual = 1.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747574707561       residual = 3.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747574707561       residual = 7.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747574707561       residual = 3.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.732423802347       residual = 1.20e-02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747574708284       residual = 5.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747573275221       residual = 2.29e-02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.866637251795       residual = 7.14e-01           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.792559325338       residual = 2.78e-01           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.791045853647       residual = 7.16e-02           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.767859226293       residual = 6.04e-02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.712210144435       residual = 6.14e-02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.779732873175       residual = 4.51e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.763632127580       residual = 3.14e-01           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.805944383345       residual = 1.92e-01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.717293795440       residual = 8.29e-01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.680755334308       residual = 3.42e-01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.815478360394       residual = 4.28e-01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.739656812999       residual = 5.46e-01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.814611314544       residual = 4.31e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.785195076371       residual = 6.43e-01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.626706508342       residual = 3.00e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.600930549158       residual = 5.03e-01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.678265876882       residual = 4.85e-01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.734886431111       residual = 1.88e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.776444888397       residual = 1.67e-01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.762768499512       residual = 3.26e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.803098760562       residual = 2.71e-01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.720813404347       residual = 2.29e+00           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.668581180893       residual = 4.03e+00           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.883594379402       residual = 2.20e+00           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.651654871855       residual = 2.81e+00           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.879208099091       residual = 1.49e+00           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.684264503968       residual = 1.98e+00           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.796995710464       residual = 3.78e-01           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.695036038945       residual = 1.06e+00           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.712499487156       residual = 1.39e+00           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.830892134137       residual = 4.46e-01           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.730581659339       residual = 1.93e+00           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.750045906497       residual = 3.24e-01           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.739174554321       residual = 6.15e-01           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.787794747822       residual = 2.65e-01           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.738864953314       residual = 2.69e-01           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.800731159195       residual = 1.70e+00           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.755889783011       residual = 1.07e+00           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.775247483269       residual = 1.30e+00           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.688494235146       residual = 8.14e-01           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.743304057596       residual = 7.83e-01           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.858684299836       residual = 9.76e-01           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -0.741854351625       residual = 2.28e+00           smallest_sin_value = 9.98e-01
davidson iteration   50:   krylov dim =  51   tar_fn =      -0.765050590980       residual = 1.42e+00           smallest_sin_value = 9.98e-01
davidson iteration   51:   krylov dim =  52   tar_fn =      -0.731048518967       residual = 1.36e+00           smallest_sin_value = 9.97e-01
davidson iteration   52:   krylov dim =  53   tar_fn =      -0.813875368881       residual = 2.35e+00           smallest_sin_value = 9.97e-01
davidson iteration   53:   krylov dim =  54   tar_fn =      -0.753771299186       residual = 4.58e-01           smallest_sin_value = 9.92e-01
davidson iteration   54 stopping due to small subspace S singular value of 9.55e-01
davidson solver did not converge after         54 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+13 is 3.769331e-18

solving harmonic davidson linear method for identity shift 2.3283e+14, overlap shift 2.3283e+15 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747574707561       residual = 1.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747574707561       residual = 3.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747574707561       residual = 7.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747574707561       residual = 1.27e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.869442448933       residual = 1.37e+00           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.902956446743       residual = 1.28e+00           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.787146339206       residual = 8.86e-01           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.716690629577       residual = 1.32e+00           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.458996668188       residual = 8.16e+00           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -1.217420154570       residual = 1.30e+00           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -1.463492221662       residual = 2.18e+00           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.094644124254       residual = 5.05e-01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.414432315040       residual = 5.26e-01           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.616193953693       residual = 1.58e-01           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.560854696929       residual = 8.12e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.538271882920       residual = 5.09e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.609726171346       residual = 2.69e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.748728182150       residual = 1.41e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.667142691175       residual = 2.45e+01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.930347836669       residual = 1.44e+01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.687888245149       residual = 2.34e+01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.807956511044       residual = 2.89e+01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.506479807547       residual = 2.67e+01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -1.101237886385       residual = 2.61e+01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.749639048578       residual = 3.01e+01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.800266030100       residual = 3.02e+01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.569971466583       residual = 4.57e+00           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.934957426243       residual = 1.40e+00           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.729256784717       residual = 4.84e+00           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.776270246632       residual = 3.68e+01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.693266737705       residual = 7.28e-01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.915500231645       residual = 5.74e+00           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.763596862930       residual = 2.11e+01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.801160644474       residual = 3.15e+01           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.777064786077       residual = 3.61e+00           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.883974636339       residual = 1.85e+00           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.907181680202       residual = 1.65e+01           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.873099104205       residual = 1.16e+01           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.745232801286       residual = 2.26e+01           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.783666753805       residual = 1.58e+01           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.996318814577       residual = 2.92e+01           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -1.146691759188       residual = 2.14e+01           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.551547955511       residual = 1.48e+01           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.646751978017       residual = 5.51e+01           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.844258401875       residual = 8.34e+00           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.771978785213       residual = 8.40e+00           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.903593914200       residual = 8.42e+01           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.771110433563       residual = 1.23e+01           smallest_sin_value = 9.99e-01
davidson iteration   48:   krylov dim =  49   tar_fn =      -0.710529055965       residual = 3.71e+01           smallest_sin_value = 9.96e-01
davidson iteration   49 stopping due to small subspace S singular value of 9.85e-01
davidson solver did not converge after         49 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+14 is 6.995941e-19

solving harmonic davidson linear method for identity shift 9.3132e+14, overlap shift 9.3132e+15 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747574707561       residual = 1.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747574707561       residual = 3.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747574707561       residual = 7.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747574707561       residual = 9.45e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.438385116020       residual = 1.07e+01           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.685486921471       residual = 8.41e+00           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.457240942679       residual = 8.43e+00           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.371163098118       residual = 1.00e+00           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =       0.268286666520       residual = 1.37e+00           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =       0.999799051533       residual = 3.75e+00           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =       0.962143255420       residual = 2.89e+00           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -1.606837979529       residual = 7.74e-01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.236692955583       residual = 4.76e-01           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =       2.666312998066       residual = 1.09e+01           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.906533119275       residual = 4.53e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.359938692932       residual = 1.52e-01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.974828280976       residual = 1.29e+02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -2.821611988679       residual = 1.65e+02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -2.660726546644       residual = 4.14e+02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.681330179421       residual = 9.79e+01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -1.275808611563       residual = 1.69e+02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =       0.644378035523       residual = 2.39e+01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =       0.455778271141       residual = 6.03e+01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -2.783000338577       residual = 8.67e+01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =       0.597317710581       residual = 8.28e+02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =       0.549563010477       residual = 5.58e+02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =       1.373434236371       residual = 5.90e+02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -1.838653540294       residual = 5.03e+01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.932800203013       residual = 1.57e+02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.076820165354       residual = 1.42e+02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -1.269695042008       residual = 5.79e+02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =       0.538084522096       residual = 1.75e+02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -1.851473390952       residual = 2.76e+02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.705291189343       residual = 1.27e+02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =       0.228914687593       residual = 3.98e+02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =       0.995609761461       residual = 8.14e+02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.261285233909       residual = 8.27e+02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.539742114793       residual = 1.02e+03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.946947393082       residual = 7.34e+02           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -1.087119959815       residual = 1.91e+02           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.386389166081       residual = 2.57e+02           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -1.091691548296       residual = 5.13e+02           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.206330090412       residual = 1.61e+02           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.592924646972       residual = 1.02e+02           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.859770250812       residual = 1.01e+03           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.485548909725       residual = 2.16e+02           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =       0.083618175509       residual = 7.64e+01           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =       0.710593624676       residual = 3.43e+02           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -2.345886560966       residual = 5.37e+02           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -1.392729048692       residual = 2.36e+02           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =       0.235664173463       residual = 6.43e+02           smallest_sin_value = 9.99e-01
davidson iteration   51:   krylov dim =  52   tar_fn =       0.133476475390       residual = 1.12e+02           smallest_sin_value = 9.98e-01
davidson iteration   52 stopping due to small subspace S singular value of 9.89e-01
davidson solver did not converge after         52 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+14 is 1.748985e-19

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.975533 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9903e+01
  </log>
  <optVariables href="FORM2.s049.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -22.8384
    reference variance = 0.495613
====================================================
  Execution time = 2.4383e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s049
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4727e-01
  Total weights = 1.9651e+06
  Execution time = 3.4997e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435122193058
                                         uncertainty =       0.002365540277

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435122193058
                                         uncertainty =       0.002365540277

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466504854
  error estimate for blocks of size 2^( 2) =       0.000492126238
  error estimate for blocks of size 2^( 3) =       0.000516210381
  error estimate for blocks of size 2^( 4) =       0.000534357013
  error estimate for blocks of size 2^( 5) =       0.000544550732
  error estimate for blocks of size 2^( 6) =       0.000551539607
  error estimate for blocks of size 2^( 7) =       0.000555460690

      target function =      -0.747614030554
              le_mean =     -22.814389309326
             les_mean =     520.943634130799
             stat err =       0.000546477010
             autocorr =       1.372244372764
   target nu stat err =       0.000546477010
   target dn stat err =       0.002817366850
      target stat err =       0.002426187042
              std dev =       0.659737491820
             le_variance =       0.435253558113

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435122193058
                                         uncertainty =       0.002365540277

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435122193058
                                         uncertainty =       0.002365540277

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466504854
  error estimate for blocks of size 2^( 2) =       0.000492126238
  error estimate for blocks of size 2^( 3) =       0.000516210381
  error estimate for blocks of size 2^( 4) =       0.000534357013
  error estimate for blocks of size 2^( 5) =       0.000544550732
  error estimate for blocks of size 2^( 6) =       0.000551539607
  error estimate for blocks of size 2^( 7) =       0.000555460690

      target function =      -0.747614030554
              le_mean =     -22.814389309326
             les_mean =     520.943634130799
             stat err =       0.000546477010
             autocorr =       1.372244372763
   target nu stat err =       0.000546477010
   target dn stat err =       0.002817366850
      target stat err =       0.002426187042
              std dev =       0.659737491820
             le_variance =       0.435253558113

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435122193058
                                         uncertainty =       0.002365540277

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435122193058
                                         uncertainty =       0.002365540277

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466504854
  error estimate for blocks of size 2^( 2) =       0.000492126238
  error estimate for blocks of size 2^( 3) =       0.000516210381
  error estimate for blocks of size 2^( 4) =       0.000534357013
  error estimate for blocks of size 2^( 5) =       0.000544550732
  error estimate for blocks of size 2^( 6) =       0.000551539607
  error estimate for blocks of size 2^( 7) =       0.000555460690

      target function =      -0.747614030554
              le_mean =     -22.814389309326
             les_mean =     520.943634130799
             stat err =       0.000546477010
             autocorr =       1.372244372751
   target nu stat err =       0.000546477010
   target dn stat err =       0.002817366850
      target stat err =       0.002426187042
              std dev =       0.659737491820
             le_variance =       0.435253558113

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435122193058
                                         uncertainty =       0.002365540277

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435122193058
                                         uncertainty =       0.002365540277

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466504854
  error estimate for blocks of size 2^( 2) =       0.000492126238
  error estimate for blocks of size 2^( 3) =       0.000516210381
  error estimate for blocks of size 2^( 4) =       0.000534357013
  error estimate for blocks of size 2^( 5) =       0.000544550732
  error estimate for blocks of size 2^( 6) =       0.000551539607
  error estimate for blocks of size 2^( 7) =       0.000555460690

      target function =      -0.747614030554
              le_mean =     -22.814389309326
             les_mean =     520.943634130799
             stat err =       0.000546477010
             autocorr =       1.372244372764
   target nu stat err =       0.000546477010
   target dn stat err =       0.002817366850
      target stat err =       0.002426187042
              std dev =       0.659737491820
             le_variance =       0.435253558113


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747614030554        initial  <--
     5.8208e+13     5.8208e+14             3.7693e-18        -0.747614030554
     2.3283e+14     2.3283e+15             6.9959e-19        -0.747614030554
     9.3132e+14     9.3132e+15             1.7490e-19        -0.747614030554

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.3343
  </log>
  <optVariables href="FORM2.s049.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3244e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s050 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s050 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=50  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2813e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -22.856
    reference variance = 0.344257
====================================================
  Execution time = 2.5124e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s050
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5363e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5768e-01
  Total weights = 1.964774574e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5314e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439590401875
                                         uncertainty =       0.005001942905

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439590401875
                                         uncertainty =       0.005001942905

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468815492
  error estimate for blocks of size 2^( 2) =       0.000494353360
  error estimate for blocks of size 2^( 3) =       0.000518342688
  error estimate for blocks of size 2^( 4) =       0.000536646461
  error estimate for blocks of size 2^( 5) =       0.000548410366
  error estimate for blocks of size 2^( 6) =       0.000554486864
  error estimate for blocks of size 2^( 7) =       0.000558559288

      target function =      -0.738974006798
              le_mean =     -22.814513656892
             les_mean =     520.959709080805
             stat err =       0.000549525745
             autocorr =       1.373953953628
   target nu stat err =       0.000549525745
   target dn stat err =       0.009167871227
      target stat err =       0.007492926153
              std dev =       0.663005226913
             le_variance =       0.439575930914


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281451365689e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+14, overlap shift 5.8208e+15 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.739049023570       residual = 3.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.739049023570       residual = 7.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.739049023570       residual = 2.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.739049023570       residual = 8.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.739049023567       residual = 3.75e-01           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.739049018933       residual = 3.91e+00           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.739049023569       residual = 8.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.739048938512       residual = 7.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.467320783950       residual = 1.48e+01           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -2.175912850362       residual = 3.64e+01           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -1.351867157780       residual = 8.42e+00           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =       0.233103377617       residual = 3.94e+00           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.527548255191       residual = 7.16e-01           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =       0.283430226140       residual = 1.73e+00           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =       0.239848366852       residual = 1.06e+00           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.065912848000       residual = 1.84e+00           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.101846436216       residual = 4.13e-01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.583846576083       residual = 4.09e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.307453586099       residual = 5.37e+01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.874877439348       residual = 6.13e+01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.450076612643       residual = 8.31e+01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -1.863863078993       residual = 1.13e+02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.864692754116       residual = 1.36e+02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.556786480459       residual = 9.83e+01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.544917451636       residual = 1.14e+02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.983342248474       residual = 3.62e+01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -1.505239118664       residual = 2.73e+02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.246181007143       residual = 1.06e+01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.403606829061       residual = 2.18e+02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.532305479199       residual = 1.34e+02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.963440509280       residual = 8.38e+01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.515915224976       residual = 1.75e+02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.813643192747       residual = 1.82e+02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.984182113556       residual = 2.25e+02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.050232079714       residual = 2.60e+02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.166397490309       residual = 2.74e+02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.839802949539       residual = 3.05e+02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -1.509134621571       residual = 1.56e+02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -1.624397428207       residual = 1.20e+02           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =       0.179836226571       residual = 8.68e+01           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =       0.513256393614       residual = 1.34e+02           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.877912211418       residual = 1.10e+02           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -2.227353095509       residual = 4.67e+01           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -2.504948156987       residual = 1.84e+02           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.934532989930       residual = 4.86e+01           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.622221712221       residual = 6.46e+01           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.618818875178       residual = 4.28e+01           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =      -0.028605834872       residual = 4.23e+01           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -1.209609934235       residual = 1.88e+02           smallest_sin_value = 9.99e-01
davidson iteration   49:   krylov dim =  50   tar_fn =      -1.062241573277       residual = 4.66e+01           smallest_sin_value = 9.98e-01
davidson iteration   50:   krylov dim =  51   tar_fn =       0.149209591192       residual = 1.25e+02           smallest_sin_value = 9.96e-01
davidson iteration   51 stopping due to small subspace S singular value of 9.81e-01
davidson solver did not converge after         51 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+14 is 8.111310e-19

solving harmonic davidson linear method for identity shift 2.3283e+15, overlap shift 2.3283e+16 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.739049023570       residual = 3.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.739049023570       residual = 7.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.739049023570       residual = 2.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.739049023570       residual = 8.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.739049023570       residual = 1.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.739049023570       residual = 4.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.739026646830       residual = 1.85e-02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.629400829194       residual = 1.59e+01           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -2.744993331784       residual = 1.70e+01           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -5.754368328477       residual = 3.85e+01           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =       1.501705271764       residual = 1.02e+01           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -1.881268252899       residual = 1.73e+00           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.631259255912       residual = 9.66e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =       0.554059673491       residual = 2.48e+02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -7.856389938351       residual = 3.97e+02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -4.118902854811       residual = 2.09e+03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -2.919364892078       residual = 3.68e+02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =       5.729669141963       residual = 1.93e+03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =       1.654687729907       residual = 9.33e+01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =       0.205310300964       residual = 3.20e+02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =       0.828917502753       residual = 5.45e+02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =       4.155668097386       residual = 1.21e+03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =       2.908560596000       residual = 8.52e+02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =       1.383738796137       residual = 4.05e+03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =       1.453646359577       residual = 8.07e+02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =       0.718510451018       residual = 2.38e+02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =       0.422120334988       residual = 1.22e+03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -3.838839966181       residual = 2.22e+02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -1.780189995979       residual = 8.78e+02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =       2.738531409055       residual = 7.00e+03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -1.104420772372       residual = 2.50e+03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -6.057387839738       residual = 5.55e+03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =       0.459488668858       residual = 7.19e+03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -8.795210010621       residual = 1.15e+03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -1.735735333490       residual = 4.20e+03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -1.570559266741       residual = 2.56e+02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =       2.369714866421       residual = 1.01e+03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =       0.299565330916       residual = 1.77e+03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -1.195974151661       residual = 8.93e+03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =       4.933518728198       residual = 6.47e+03           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.894867967046       residual = 1.37e+03           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -1.598205562415       residual = 9.14e+02           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =       9.070976305890       residual = 7.71e+03           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -4.009584899862       residual = 1.19e+03           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =       0.502936332494       residual = 1.21e+03           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   tar_fn =      -1.474884488380       residual = 1.11e+03           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   tar_fn =       1.550171764622       residual = 9.75e+02           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   tar_fn =       5.242472592283       residual = 4.69e+02           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   tar_fn =      -4.196492485528       residual = 1.16e+03           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   tar_fn =      -8.321451310235       residual = 2.04e+03           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   tar_fn =      -1.928909961672       residual = 1.50e+03           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   tar_fn =       2.018974802207       residual = 1.42e+03           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   tar_fn =       1.758466923786       residual = 8.81e+02           smallest_sin_value = 9.99e-01
davidson iteration   53:   krylov dim =  54   tar_fn =      -5.989501542887       residual = 2.08e+03           smallest_sin_value = 9.96e-01
davidson iteration   54 stopping due to small subspace S singular value of 9.88e-01
davidson solver did not converge after         54 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+15 is 1.987989e-19

solving harmonic davidson linear method for identity shift 9.3132e+15, overlap shift 9.3132e+16 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.739049023570       residual = 3.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.739049023570       residual = 7.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.739049023570       residual = 2.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.739049023579       residual = 3.06e+01           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.739049023570       residual = 1.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.821857790042       residual = 4.68e+00           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -4.088185497250       residual = 2.37e+02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.718346389562       residual = 2.05e+01           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.833358290038       residual = 3.41e+02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =       6.926299243897       residual = 9.49e+01           smallest_sin_value = 1.00e+00
davidson iteration   10 stopping due to too large eigenvalue change
davidson solver did not converge after         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+15 is 4.749478e-20

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.089538 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9775e+01
  </log>
  <optVariables href="FORM2.s050.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -22.6894
    reference variance = 0.297316
====================================================
  Execution time = 2.4699e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s050
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2816e+01
  VMC Evar = 4.4980e-01
  Total weights = 1.9646e+06
  Execution time = 3.4872e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437166849512
                                         uncertainty =       0.002674537837

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437166849512
                                         uncertainty =       0.002674537837

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467521788
  error estimate for blocks of size 2^( 2) =       0.000493257628
  error estimate for blocks of size 2^( 3) =       0.000517250839
  error estimate for blocks of size 2^( 4) =       0.000535598187
  error estimate for blocks of size 2^( 5) =       0.000546156773
  error estimate for blocks of size 2^( 6) =       0.000554033862
  error estimate for blocks of size 2^( 7) =       0.000554827710

      target function =      -0.745515620439
              le_mean =     -22.815586229916
             les_mean =     521.000771185125
             stat err =       0.000547654133
             autocorr =       1.372173504176
   target nu stat err =       0.000547654133
   target dn stat err =       0.002973653751
      target stat err =       0.002543451526
              std dev =       0.661175652794
             le_variance =       0.437153243847

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437166849512
                                         uncertainty =       0.002674537837

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437166849512
                                         uncertainty =       0.002674537837

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467521788
  error estimate for blocks of size 2^( 2) =       0.000493257628
  error estimate for blocks of size 2^( 3) =       0.000517250839
  error estimate for blocks of size 2^( 4) =       0.000535598187
  error estimate for blocks of size 2^( 5) =       0.000546156773
  error estimate for blocks of size 2^( 6) =       0.000554033862
  error estimate for blocks of size 2^( 7) =       0.000554827710

      target function =      -0.745515620439
              le_mean =     -22.815586229916
             les_mean =     521.000771185125
             stat err =       0.000547654133
             autocorr =       1.372173504175
   target nu stat err =       0.000547654133
   target dn stat err =       0.002973653751
      target stat err =       0.002543451526
              std dev =       0.661175652794
             le_variance =       0.437153243847

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437166849512
                                         uncertainty =       0.002674537837

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437166849512
                                         uncertainty =       0.002674537837

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467521788
  error estimate for blocks of size 2^( 2) =       0.000493257628
  error estimate for blocks of size 2^( 3) =       0.000517250839
  error estimate for blocks of size 2^( 4) =       0.000535598187
  error estimate for blocks of size 2^( 5) =       0.000546156773
  error estimate for blocks of size 2^( 6) =       0.000554033862
  error estimate for blocks of size 2^( 7) =       0.000554827710

      target function =      -0.745515620439
              le_mean =     -22.815586229916
             les_mean =     521.000771185125
             stat err =       0.000547654133
             autocorr =       1.372173504176
   target nu stat err =       0.000547654133
   target dn stat err =       0.002973653751
      target stat err =       0.002543451526
              std dev =       0.661175652794
             le_variance =       0.437153243847

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437166849512
                                         uncertainty =       0.002674537837

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437166849512
                                         uncertainty =       0.002674537837

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467521788
  error estimate for blocks of size 2^( 2) =       0.000493257628
  error estimate for blocks of size 2^( 3) =       0.000517250839
  error estimate for blocks of size 2^( 4) =       0.000535598187
  error estimate for blocks of size 2^( 5) =       0.000546156773
  error estimate for blocks of size 2^( 6) =       0.000554033862
  error estimate for blocks of size 2^( 7) =       0.000554827710

      target function =      -0.745515620439
              le_mean =     -22.815586229916
             les_mean =     521.000771185125
             stat err =       0.000547654133
             autocorr =       1.372173504176
   target nu stat err =       0.000547654133
   target dn stat err =       0.002973653751
      target stat err =       0.002543451526
              std dev =       0.661175652794
             le_variance =       0.437153243847


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745515620439        initial
     5.8208e+14     5.8208e+15             8.1113e-19        -0.745515620439
     2.3283e+15     2.3283e+16             1.9880e-19        -0.745515620439  <--
     9.3132e+15     9.3132e+16             4.7495e-20        -0.745515620439

*****************************************************************************
Applying the update for shift_i =   2.3283e+15     and shift_s =   2.3283e+16
*****************************************************************************

  Execution time = 4.2157e+01
  </log>
  <optVariables href="FORM2.s050.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.1940e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s051 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s051 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=51  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2812e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -22.8207
    reference variance = 0.353971
====================================================
  Execution time = 2.5535e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s051
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5334e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4300e-01
  Total weights = 1.964808058e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5177e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431935575674
                                         uncertainty =       0.001995902553

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431935575674
                                         uncertainty =       0.001995902553

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464770626
  error estimate for blocks of size 2^( 2) =       0.000490549240
  error estimate for blocks of size 2^( 3) =       0.000514984584
  error estimate for blocks of size 2^( 4) =       0.000533453536
  error estimate for blocks of size 2^( 5) =       0.000545416169
  error estimate for blocks of size 2^( 6) =       0.000550581732
  error estimate for blocks of size 2^( 7) =       0.000553980787

      target function =      -0.751201529752
              le_mean =     -22.814775873622
             les_mean =     520.956995722112
             stat err =       0.000545858056
             autocorr =       1.379374213216
   target nu stat err =       0.000545858056
   target dn stat err =       0.002328042581
      target stat err =       0.002053620519
              std dev =       0.657284923197
             le_variance =       0.432023470262


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281477587362e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+14, overlap shift 5.8208e+15 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.751206195012       residual = 2.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.751206195012       residual = 2.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.74e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+14 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.3283e+15, overlap shift 2.3283e+16 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.751206195012       residual = 2.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.751206195012       residual = 2.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.74e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+15 is 0.000000e+00

solving harmonic davidson linear method for identity shift 9.3132e+15, overlap shift 9.3132e+16 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.751206195012       residual = 2.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.751206195012       residual = 2.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.74e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+15 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.090634 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0059e+01
  </log>
  <optVariables href="FORM2.s051.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -22.8034
    reference variance = 0.322126
====================================================
  Execution time = 2.5823e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s051
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5336e-01
  Total weights = 1.9648e+06
  Execution time = 3.4829e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437293229264
                                         uncertainty =       0.002644742737

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437293229264
                                         uncertainty =       0.002644742737

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467546218
  error estimate for blocks of size 2^( 2) =       0.000493239109
  error estimate for blocks of size 2^( 3) =       0.000517146919
  error estimate for blocks of size 2^( 4) =       0.000535892203
  error estimate for blocks of size 2^( 5) =       0.000546653584
  error estimate for blocks of size 2^( 6) =       0.000552216058
  error estimate for blocks of size 2^( 7) =       0.000553799750

      target function =      -0.742556841569
              le_mean =     -22.813914322428
             les_mean =     520.928045781347
             stat err =       0.000547140399
             autocorr =       1.369457215155
   target nu stat err =       0.000547140399
   target dn stat err =       0.005656290845
      target stat err =       0.004687380499
              std dev =       0.661210202380
             le_variance =       0.437198931732

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437293229264
                                         uncertainty =       0.002644742737

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437293229264
                                         uncertainty =       0.002644742737

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467546218
  error estimate for blocks of size 2^( 2) =       0.000493239109
  error estimate for blocks of size 2^( 3) =       0.000517146919
  error estimate for blocks of size 2^( 4) =       0.000535892203
  error estimate for blocks of size 2^( 5) =       0.000546653584
  error estimate for blocks of size 2^( 6) =       0.000552216058
  error estimate for blocks of size 2^( 7) =       0.000553799750

      target function =      -0.742556841569
              le_mean =     -22.813914322428
             les_mean =     520.928045781347
             stat err =       0.000547140399
             autocorr =       1.369457215155
   target nu stat err =       0.000547140399
   target dn stat err =       0.005656290845
      target stat err =       0.004687380499
              std dev =       0.661210202380
             le_variance =       0.437198931732

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437293229264
                                         uncertainty =       0.002644742737

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437293229264
                                         uncertainty =       0.002644742737

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467546218
  error estimate for blocks of size 2^( 2) =       0.000493239109
  error estimate for blocks of size 2^( 3) =       0.000517146919
  error estimate for blocks of size 2^( 4) =       0.000535892203
  error estimate for blocks of size 2^( 5) =       0.000546653584
  error estimate for blocks of size 2^( 6) =       0.000552216058
  error estimate for blocks of size 2^( 7) =       0.000553799750

      target function =      -0.742556841569
              le_mean =     -22.813914322428
             les_mean =     520.928045781347
             stat err =       0.000547140399
             autocorr =       1.369457215155
   target nu stat err =       0.000547140399
   target dn stat err =       0.005656290845
      target stat err =       0.004687380499
              std dev =       0.661210202380
             le_variance =       0.437198931732

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437293229264
                                         uncertainty =       0.002644742737

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437293229264
                                         uncertainty =       0.002644742737

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467546218
  error estimate for blocks of size 2^( 2) =       0.000493239109
  error estimate for blocks of size 2^( 3) =       0.000517146919
  error estimate for blocks of size 2^( 4) =       0.000535892203
  error estimate for blocks of size 2^( 5) =       0.000546653584
  error estimate for blocks of size 2^( 6) =       0.000552216058
  error estimate for blocks of size 2^( 7) =       0.000553799750

      target function =      -0.742556841569
              le_mean =     -22.813914322428
             les_mean =     520.928045781347
             stat err =       0.000547140399
             autocorr =       1.369457215155
   target nu stat err =       0.000547140399
   target dn stat err =       0.005656290845
      target stat err =       0.004687380499
              std dev =       0.661210202380
             le_variance =       0.437198931732


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.742556841569        initial  <--
     5.8208e+14     5.8208e+15             0.0000e+00        -0.742556841569
     2.3283e+15     2.3283e+16             0.0000e+00        -0.742556841569
     9.3132e+15     9.3132e+16             0.0000e+00        -0.742556841569

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 47.3683
  </log>
  <optVariables href="FORM2.s051.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7704e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s052 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s052 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=52  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2812e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -22.7157
    reference variance = 0.542487
====================================================
  Execution time = 2.5179e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s052
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5318e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4959e-01
  Total weights = 1.964797498e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5227e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437406570164
                                         uncertainty =       0.002219987147

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437406570164
                                         uncertainty =       0.002219987147

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467635945
  error estimate for blocks of size 2^( 2) =       0.000493878257
  error estimate for blocks of size 2^( 3) =       0.000518622458
  error estimate for blocks of size 2^( 4) =       0.000536842870
  error estimate for blocks of size 2^( 5) =       0.000548598251
  error estimate for blocks of size 2^( 6) =       0.000556003997
  error estimate for blocks of size 2^( 7) =       0.000558396010

      target function =      -0.745692751661
              le_mean =     -22.814136604262
             les_mean =     520.934414356807
             stat err =       0.000549960282
             autocorr =       1.383078658141
   target nu stat err =       0.000549960282
   target dn stat err =       0.002809671678
      target stat err =       0.002408023379
              std dev =       0.661337095466
             le_variance =       0.437366753839


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281413660426e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+15, overlap shift 5.8208e+16 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745699552507       residual = 2.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745699552507       residual = 2.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.21e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+15 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.3283e+16, overlap shift 2.3283e+17 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745699552507       residual = 2.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745699552507       residual = 2.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.21e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+16 is 0.000000e+00

solving harmonic davidson linear method for identity shift 9.3132e+16, overlap shift 9.3132e+17 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745699552507       residual = 2.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745699552507       residual = 2.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.21e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+16 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.091714 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9708e+01
  </log>
  <optVariables href="FORM2.s052.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -22.7988
    reference variance = 0.28858
====================================================
  Execution time = 2.4905e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s052
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4840e-01
  Total weights = 1.9646e+06
  Execution time = 3.4950e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435919484746
                                         uncertainty =       0.002059169981

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435919484746
                                         uncertainty =       0.002059169981

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466819320
  error estimate for blocks of size 2^( 2) =       0.000492724255
  error estimate for blocks of size 2^( 3) =       0.000516675490
  error estimate for blocks of size 2^( 4) =       0.000535449195
  error estimate for blocks of size 2^( 5) =       0.000547393965
  error estimate for blocks of size 2^( 6) =       0.000552489485
  error estimate for blocks of size 2^( 7) =       0.000557500887

      target function =      -0.746676899424
              le_mean =     -22.813759219421
             les_mean =     520.916009144505
             stat err =       0.000548208383
             autocorr =       1.379093466864
   target nu stat err =       0.000548208383
   target dn stat err =       0.002707373261
      target stat err =       0.002330207665
              std dev =       0.660182213687
             le_variance =       0.435840555269

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435919484746
                                         uncertainty =       0.002059169981

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435919484746
                                         uncertainty =       0.002059169981

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466819320
  error estimate for blocks of size 2^( 2) =       0.000492724255
  error estimate for blocks of size 2^( 3) =       0.000516675490
  error estimate for blocks of size 2^( 4) =       0.000535449195
  error estimate for blocks of size 2^( 5) =       0.000547393965
  error estimate for blocks of size 2^( 6) =       0.000552489485
  error estimate for blocks of size 2^( 7) =       0.000557500887

      target function =      -0.746676899424
              le_mean =     -22.813759219421
             les_mean =     520.916009144505
             stat err =       0.000548208383
             autocorr =       1.379093466863
   target nu stat err =       0.000548208383
   target dn stat err =       0.002707373261
      target stat err =       0.002330207665
              std dev =       0.660182213687
             le_variance =       0.435840555269

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435919484746
                                         uncertainty =       0.002059169981

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435919484746
                                         uncertainty =       0.002059169981

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466819320
  error estimate for blocks of size 2^( 2) =       0.000492724255
  error estimate for blocks of size 2^( 3) =       0.000516675490
  error estimate for blocks of size 2^( 4) =       0.000535449195
  error estimate for blocks of size 2^( 5) =       0.000547393965
  error estimate for blocks of size 2^( 6) =       0.000552489485
  error estimate for blocks of size 2^( 7) =       0.000557500887

      target function =      -0.746676899424
              le_mean =     -22.813759219421
             les_mean =     520.916009144505
             stat err =       0.000548208383
             autocorr =       1.379093466863
   target nu stat err =       0.000548208383
   target dn stat err =       0.002707373261
      target stat err =       0.002330207665
              std dev =       0.660182213687
             le_variance =       0.435840555269

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435919484746
                                         uncertainty =       0.002059169981

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435919484746
                                         uncertainty =       0.002059169981

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466819320
  error estimate for blocks of size 2^( 2) =       0.000492724255
  error estimate for blocks of size 2^( 3) =       0.000516675490
  error estimate for blocks of size 2^( 4) =       0.000535449195
  error estimate for blocks of size 2^( 5) =       0.000547393965
  error estimate for blocks of size 2^( 6) =       0.000552489485
  error estimate for blocks of size 2^( 7) =       0.000557500887

      target function =      -0.746676899424
              le_mean =     -22.813759219421
             les_mean =     520.916009144505
             stat err =       0.000548208383
             autocorr =       1.379093466863
   target nu stat err =       0.000548208383
   target dn stat err =       0.002707373261
      target stat err =       0.002330207665
              std dev =       0.660182213687
             le_variance =       0.435840555269


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746676899424        initial  <--
     5.8208e+15     5.8208e+16             0.0000e+00        -0.746676899424
     2.3283e+16     2.3283e+17             0.0000e+00        -0.746676899424
     9.3132e+16     9.3132e+17             0.0000e+00        -0.746676899424

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.3991
  </log>
  <optVariables href="FORM2.s052.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2113e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s053 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s053 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=53  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2811e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -22.7606
    reference variance = 0.337749
====================================================
  Execution time = 2.5443e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s053
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5347e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5136e-01
  Total weights = 1.964765923e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4795e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435564965135
                                         uncertainty =       0.002057141442

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435564965135
                                         uncertainty =       0.002057141442

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466629927
  error estimate for blocks of size 2^( 2) =       0.000492194406
  error estimate for blocks of size 2^( 3) =       0.000516451679
  error estimate for blocks of size 2^( 4) =       0.000534166255
  error estimate for blocks of size 2^( 5) =       0.000544524191
  error estimate for blocks of size 2^( 6) =       0.000551290374
  error estimate for blocks of size 2^( 7) =       0.000558241569

      target function =      -0.744219465935
              le_mean =     -22.814766833491
             les_mean =     520.964942231631
             stat err =       0.000547055597
             autocorr =       1.374414581663
   target nu stat err =       0.000547055597
   target dn stat err =       0.003880121857
      target stat err =       0.003263867508
              std dev =       0.659914371670
             le_variance =       0.435486977937


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281476683349e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+16, overlap shift 5.8208e+17 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744232742141       residual = 2.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744232742141       residual = 2.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.31e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+16 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.3283e+17, overlap shift 2.3283e+18 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744232742141       residual = 2.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744232742141       residual = 2.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.31e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+17 is 0.000000e+00

solving harmonic davidson linear method for identity shift 9.3132e+17, overlap shift 9.3132e+18 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744232742141       residual = 2.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744232742141       residual = 2.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.31e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+17 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.092909 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9931e+01
  </log>
  <optVariables href="FORM2.s053.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -22.8124
    reference variance = 0.27297
====================================================
  Execution time = 2.4909e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s053
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4926e-01
  Total weights = 1.9649e+06
  Execution time = 3.5023e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436964034924
                                         uncertainty =       0.001890677016

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436964034924
                                         uncertainty =       0.001890677016

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467424924
  error estimate for blocks of size 2^( 2) =       0.000493594835
  error estimate for blocks of size 2^( 3) =       0.000518063733
  error estimate for blocks of size 2^( 4) =       0.000536341939
  error estimate for blocks of size 2^( 5) =       0.000548423454
  error estimate for blocks of size 2^( 6) =       0.000552900929
  error estimate for blocks of size 2^( 7) =       0.000558147041

      target function =      -0.745966308873
              le_mean =     -22.814722594379
             les_mean =     520.960822413364
             stat err =       0.000548953341
             autocorr =       1.379263145704
   target nu stat err =       0.000548953341
   target dn stat err =       0.002869128270
      target stat err =       0.002459345012
              std dev =       0.661038667319
             le_variance =       0.436972119691

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436964034924
                                         uncertainty =       0.001890677016

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436964034924
                                         uncertainty =       0.001890677016

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467424924
  error estimate for blocks of size 2^( 2) =       0.000493594835
  error estimate for blocks of size 2^( 3) =       0.000518063733
  error estimate for blocks of size 2^( 4) =       0.000536341939
  error estimate for blocks of size 2^( 5) =       0.000548423454
  error estimate for blocks of size 2^( 6) =       0.000552900929
  error estimate for blocks of size 2^( 7) =       0.000558147041

      target function =      -0.745966308873
              le_mean =     -22.814722594379
             les_mean =     520.960822413364
             stat err =       0.000548953341
             autocorr =       1.379263145704
   target nu stat err =       0.000548953341
   target dn stat err =       0.002869128270
      target stat err =       0.002459345012
              std dev =       0.661038667319
             le_variance =       0.436972119691

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436964034924
                                         uncertainty =       0.001890677016

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436964034924
                                         uncertainty =       0.001890677016

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467424924
  error estimate for blocks of size 2^( 2) =       0.000493594835
  error estimate for blocks of size 2^( 3) =       0.000518063733
  error estimate for blocks of size 2^( 4) =       0.000536341939
  error estimate for blocks of size 2^( 5) =       0.000548423454
  error estimate for blocks of size 2^( 6) =       0.000552900929
  error estimate for blocks of size 2^( 7) =       0.000558147041

      target function =      -0.745966308873
              le_mean =     -22.814722594379
             les_mean =     520.960822413364
             stat err =       0.000548953341
             autocorr =       1.379263145704
   target nu stat err =       0.000548953341
   target dn stat err =       0.002869128270
      target stat err =       0.002459345012
              std dev =       0.661038667319
             le_variance =       0.436972119691

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436964034924
                                         uncertainty =       0.001890677016

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436964034924
                                         uncertainty =       0.001890677016

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467424924
  error estimate for blocks of size 2^( 2) =       0.000493594835
  error estimate for blocks of size 2^( 3) =       0.000518063733
  error estimate for blocks of size 2^( 4) =       0.000536341939
  error estimate for blocks of size 2^( 5) =       0.000548423454
  error estimate for blocks of size 2^( 6) =       0.000552900929
  error estimate for blocks of size 2^( 7) =       0.000558147041

      target function =      -0.745966308873
              le_mean =     -22.814722594379
             les_mean =     520.960822413364
             stat err =       0.000548953341
             autocorr =       1.379263145704
   target nu stat err =       0.000548953341
   target dn stat err =       0.002869128270
      target stat err =       0.002459345012
              std dev =       0.661038667319
             le_variance =       0.436972119691


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745966308873        initial  <--
     5.8208e+16     5.8208e+17             0.0000e+00        -0.745966308873
     2.3283e+17     2.3283e+18             0.0000e+00        -0.745966308873
     9.3132e+17     9.3132e+18             0.0000e+00        -0.745966308873

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.8582
  </log>
  <optVariables href="FORM2.s053.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3795e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s054 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s054 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=54  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2811e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -22.7979
    reference variance = 0.596399
====================================================
  Execution time = 2.5354e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s054
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5365e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5311e-01
  Total weights = 1.964850478e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5928e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438327557058
                                         uncertainty =       0.002510043182

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438327557058
                                         uncertainty =       0.002510043182

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468121640
  error estimate for blocks of size 2^( 2) =       0.000493813437
  error estimate for blocks of size 2^( 3) =       0.000517450646
  error estimate for blocks of size 2^( 4) =       0.000534829916
  error estimate for blocks of size 2^( 5) =       0.000547667558
  error estimate for blocks of size 2^( 6) =       0.000555811909
  error estimate for blocks of size 2^( 7) =       0.000559091042

      target function =      -0.742767744282
              le_mean =     -22.814882885376
             les_mean =     520.971995432059
             stat err =       0.000549350106
             autocorr =       1.377149185185
   target nu stat err =       0.000549350106
   target dn stat err =       0.004044927428
      target stat err =       0.003385806586
              std dev =       0.662023972391
             le_variance =       0.438275740021


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281488288538e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+17, overlap shift 5.8208e+18 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742782190266       residual = 6.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742782190266       residual = 8.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742782190266       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742782190278       residual = 1.54e+02           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+17 is 3.103070e-22

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+18, overlap shift 2.3283e+19 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742782190266       residual = 6.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742782190266       residual = 8.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742782190266       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742782190266       residual = 6.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+18 is 7.757675e-23

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+18, overlap shift 9.3132e+19 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742782190266       residual = 6.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742782190266       residual = 8.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742782190266       residual = 3.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742782190266       residual = 4.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742782166862       residual = 1.41e+03           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+18 is 1.923987e-23

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.094697 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9954e+01
  </log>
  <optVariables href="FORM2.s054.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -22.7972
    reference variance = 0.54196
====================================================
  Execution time = 2.4933e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s054
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2816e+01
  VMC Evar = 4.4766e-01
  Total weights = 1.9648e+06
  Execution time = 3.5018e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435502065079
                                         uncertainty =       0.002136723634

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435502065079
                                         uncertainty =       0.002136723634

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466726703
  error estimate for blocks of size 2^( 2) =       0.000492270976
  error estimate for blocks of size 2^( 3) =       0.000516445432
  error estimate for blocks of size 2^( 4) =       0.000534391882
  error estimate for blocks of size 2^( 5) =       0.000547500977
  error estimate for blocks of size 2^( 6) =       0.000553618554
  error estimate for blocks of size 2^( 7) =       0.000556744778

      target function =      -0.747299390262
              le_mean =     -22.815882498299
             les_mean =     521.012149565840
             stat err =       0.000548064048
             autocorr =       1.378914475083
   target nu stat err =       0.000548064048
   target dn stat err =       0.002624564464
      target stat err =       0.002274680286
              std dev =       0.660051232645
             le_variance =       0.435667629716

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435502065079
                                         uncertainty =       0.002136723634

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435502065079
                                         uncertainty =       0.002136723634

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466726703
  error estimate for blocks of size 2^( 2) =       0.000492270976
  error estimate for blocks of size 2^( 3) =       0.000516445432
  error estimate for blocks of size 2^( 4) =       0.000534391882
  error estimate for blocks of size 2^( 5) =       0.000547500977
  error estimate for blocks of size 2^( 6) =       0.000553618554
  error estimate for blocks of size 2^( 7) =       0.000556744778

      target function =      -0.747299390262
              le_mean =     -22.815882498299
             les_mean =     521.012149565840
             stat err =       0.000548064048
             autocorr =       1.378914475083
   target nu stat err =       0.000548064048
   target dn stat err =       0.002624564464
      target stat err =       0.002274680286
              std dev =       0.660051232645
             le_variance =       0.435667629716

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435502065079
                                         uncertainty =       0.002136723634

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435502065079
                                         uncertainty =       0.002136723634

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466726703
  error estimate for blocks of size 2^( 2) =       0.000492270976
  error estimate for blocks of size 2^( 3) =       0.000516445432
  error estimate for blocks of size 2^( 4) =       0.000534391882
  error estimate for blocks of size 2^( 5) =       0.000547500977
  error estimate for blocks of size 2^( 6) =       0.000553618554
  error estimate for blocks of size 2^( 7) =       0.000556744778

      target function =      -0.747299390262
              le_mean =     -22.815882498299
             les_mean =     521.012149565840
             stat err =       0.000548064048
             autocorr =       1.378914475083
   target nu stat err =       0.000548064048
   target dn stat err =       0.002624564464
      target stat err =       0.002274680286
              std dev =       0.660051232645
             le_variance =       0.435667629716

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435502065079
                                         uncertainty =       0.002136723634

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435502065079
                                         uncertainty =       0.002136723634

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466726703
  error estimate for blocks of size 2^( 2) =       0.000492270976
  error estimate for blocks of size 2^( 3) =       0.000516445432
  error estimate for blocks of size 2^( 4) =       0.000534391882
  error estimate for blocks of size 2^( 5) =       0.000547500977
  error estimate for blocks of size 2^( 6) =       0.000553618554
  error estimate for blocks of size 2^( 7) =       0.000556744778

      target function =      -0.747299390262
              le_mean =     -22.815882498299
             les_mean =     521.012149565840
             stat err =       0.000548064048
             autocorr =       1.378914475083
   target nu stat err =       0.000548064048
   target dn stat err =       0.002624564464
      target stat err =       0.002274680286
              std dev =       0.660051232645
             le_variance =       0.435667629716


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747299390262        initial  <--
     5.8208e+17     5.8208e+18             3.1031e-22        -0.747299390262
     2.3283e+18     2.3283e+19             7.7577e-23        -0.747299390262
     9.3132e+18     9.3132e+19             1.9240e-23        -0.747299390262

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.5192
  </log>
  <optVariables href="FORM2.s054.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2479e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s055 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s055 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=55  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2810e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -22.826
    reference variance = 0.311338
====================================================
  Execution time = 2.5243e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s055
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5374e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5766e-01
  Total weights = 1.964742152e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4936e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434955545783
                                         uncertainty =       0.004026186647

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434955545783
                                         uncertainty =       0.004026186647

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466324978
  error estimate for blocks of size 2^( 2) =       0.000492115897
  error estimate for blocks of size 2^( 3) =       0.000516993586
  error estimate for blocks of size 2^( 4) =       0.000536308682
  error estimate for blocks of size 2^( 5) =       0.000547485225
  error estimate for blocks of size 2^( 6) =       0.000553399935
  error estimate for blocks of size 2^( 7) =       0.000557134147

      target function =      -0.738898819151
              le_mean =     -22.814205922220
             les_mean =     520.945656632835
             stat err =       0.000548581997
             autocorr =       1.383903301930
   target nu stat err =       0.000548581997
   target dn stat err =       0.013493082411
      target stat err =       0.011002466035
              std dev =       0.659483108176
             le_variance =       0.434917969970


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281420592222e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+18, overlap shift 5.8208e+19 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.739060901110       residual = 2.64e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.739060901110       residual = 2.64e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+19, overlap shift 2.3283e+20 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.739060901110       residual = 2.64e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.739060901110       residual = 2.64e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+19, overlap shift 9.3132e+20 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.739060901110       residual = 2.64e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.739060901110       residual = 2.64e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.095831 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9744e+01
  </log>
  <optVariables href="FORM2.s055.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -22.7404
    reference variance = 0.353621
====================================================
  Execution time = 2.4736e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s055
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4957e-01
  Total weights = 1.9650e+06
  Execution time = 3.5106e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436270102170
                                         uncertainty =       0.002286030501

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436270102170
                                         uncertainty =       0.002286030501

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467052532
  error estimate for blocks of size 2^( 2) =       0.000492992915
  error estimate for blocks of size 2^( 3) =       0.000517523033
  error estimate for blocks of size 2^( 4) =       0.000535686207
  error estimate for blocks of size 2^( 5) =       0.000546110567
  error estimate for blocks of size 2^( 6) =       0.000551581352
  error estimate for blocks of size 2^( 7) =       0.000553702579

      target function =      -0.745700859756
              le_mean =     -22.813945632774
             les_mean =     520.925688219405
             stat err =       0.000546770176
             autocorr =       1.370497267788
   target nu stat err =       0.000546770176
   target dn stat err =       0.003203403062
      target stat err =       0.002723475006
              std dev =       0.660512024828
             le_variance =       0.436276134942

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436270102170
                                         uncertainty =       0.002286030501

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436270102170
                                         uncertainty =       0.002286030501

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467052532
  error estimate for blocks of size 2^( 2) =       0.000492992915
  error estimate for blocks of size 2^( 3) =       0.000517523033
  error estimate for blocks of size 2^( 4) =       0.000535686207
  error estimate for blocks of size 2^( 5) =       0.000546110567
  error estimate for blocks of size 2^( 6) =       0.000551581352
  error estimate for blocks of size 2^( 7) =       0.000553702579

      target function =      -0.745700859756
              le_mean =     -22.813945632774
             les_mean =     520.925688219405
             stat err =       0.000546770176
             autocorr =       1.370497267788
   target nu stat err =       0.000546770176
   target dn stat err =       0.003203403062
      target stat err =       0.002723475006
              std dev =       0.660512024828
             le_variance =       0.436276134942

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436270102170
                                         uncertainty =       0.002286030501

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436270102170
                                         uncertainty =       0.002286030501

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467052532
  error estimate for blocks of size 2^( 2) =       0.000492992915
  error estimate for blocks of size 2^( 3) =       0.000517523033
  error estimate for blocks of size 2^( 4) =       0.000535686207
  error estimate for blocks of size 2^( 5) =       0.000546110567
  error estimate for blocks of size 2^( 6) =       0.000551581352
  error estimate for blocks of size 2^( 7) =       0.000553702579

      target function =      -0.745700859756
              le_mean =     -22.813945632774
             les_mean =     520.925688219405
             stat err =       0.000546770176
             autocorr =       1.370497267788
   target nu stat err =       0.000546770176
   target dn stat err =       0.003203403062
      target stat err =       0.002723475006
              std dev =       0.660512024828
             le_variance =       0.436276134942

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436270102170
                                         uncertainty =       0.002286030501

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436270102170
                                         uncertainty =       0.002286030501

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467052532
  error estimate for blocks of size 2^( 2) =       0.000492992915
  error estimate for blocks of size 2^( 3) =       0.000517523033
  error estimate for blocks of size 2^( 4) =       0.000535686207
  error estimate for blocks of size 2^( 5) =       0.000546110567
  error estimate for blocks of size 2^( 6) =       0.000551581352
  error estimate for blocks of size 2^( 7) =       0.000553702579

      target function =      -0.745700859756
              le_mean =     -22.813945632774
             les_mean =     520.925688219405
             stat err =       0.000546770176
             autocorr =       1.370497267788
   target nu stat err =       0.000546770176
   target dn stat err =       0.003203403062
      target stat err =       0.002723475006
              std dev =       0.660512024828
             le_variance =       0.436276134942


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745700859756        initial  <--
     5.8208e+18     5.8208e+19             0.0000e+00        -0.745700859756
     2.3283e+19     2.3283e+20             0.0000e+00        -0.745700859756
     9.3132e+19     9.3132e+20             0.0000e+00        -0.745700859756

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.6376
  </log>
  <optVariables href="FORM2.s055.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4387e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s056 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s056 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=56  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2810e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -22.8451
    reference variance = 0.421256
====================================================
  Execution time = 2.5277e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s056
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5372e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5057e-01
  Total weights = 1.964888539e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5400e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436249522504
                                         uncertainty =       0.002572388790

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436249522504
                                         uncertainty =       0.002572388790

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467043011
  error estimate for blocks of size 2^( 2) =       0.000492464351
  error estimate for blocks of size 2^( 3) =       0.000516515696
  error estimate for blocks of size 2^( 4) =       0.000534918862
  error estimate for blocks of size 2^( 5) =       0.000547114200
  error estimate for blocks of size 2^( 6) =       0.000553172908
  error estimate for blocks of size 2^( 7) =       0.000555341354

      target function =      -0.744870524579
              le_mean =     -22.814712944982
             les_mean =     520.961699405526
             stat err =       0.000547636831
             autocorr =       1.374901359760
   target nu stat err =       0.000547636831
   target dn stat err =       0.003496546826
      target stat err =       0.002957926183
              std dev =       0.660498560935
             le_variance =       0.436258348998


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281471294498e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+19, overlap shift 5.8208e+20 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744881306370       residual = 3.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744881306370       residual = 3.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+20, overlap shift 2.3283e+21 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744881306370       residual = 3.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744881306370       residual = 3.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+20, overlap shift 9.3132e+21 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744881306370       residual = 3.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744881306370       residual = 3.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.096964 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9823e+01
  </log>
  <optVariables href="FORM2.s056.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -22.8037
    reference variance = 0.456082
====================================================
  Execution time = 2.4667e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s056
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4865e-01
  Total weights = 1.9650e+06
  Execution time = 3.5004e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435222199379
                                         uncertainty =       0.001948120319

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435222199379
                                         uncertainty =       0.001948120319

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466489897
  error estimate for blocks of size 2^( 2) =       0.000492436073
  error estimate for blocks of size 2^( 3) =       0.000516823306
  error estimate for blocks of size 2^( 4) =       0.000535555547
  error estimate for blocks of size 2^( 5) =       0.000547772349
  error estimate for blocks of size 2^( 6) =       0.000553599823
  error estimate for blocks of size 2^( 7) =       0.000555895335

      target function =      -0.746467012142
              le_mean =     -22.814290154614
             les_mean =     520.940486046027
             stat err =       0.000548205763
             autocorr =       1.381028715877
   target nu stat err =       0.000548205763
   target dn stat err =       0.003089250993
      target stat err =       0.002638328060
              std dev =       0.659716339301
             le_variance =       0.435225648341

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435222199379
                                         uncertainty =       0.001948120319

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435222199379
                                         uncertainty =       0.001948120319

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466489897
  error estimate for blocks of size 2^( 2) =       0.000492436073
  error estimate for blocks of size 2^( 3) =       0.000516823306
  error estimate for blocks of size 2^( 4) =       0.000535555547
  error estimate for blocks of size 2^( 5) =       0.000547772349
  error estimate for blocks of size 2^( 6) =       0.000553599823
  error estimate for blocks of size 2^( 7) =       0.000555895335

      target function =      -0.746467012142
              le_mean =     -22.814290154614
             les_mean =     520.940486046027
             stat err =       0.000548205763
             autocorr =       1.381028715877
   target nu stat err =       0.000548205763
   target dn stat err =       0.003089250993
      target stat err =       0.002638328060
              std dev =       0.659716339301
             le_variance =       0.435225648341

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435222199379
                                         uncertainty =       0.001948120319

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435222199379
                                         uncertainty =       0.001948120319

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466489897
  error estimate for blocks of size 2^( 2) =       0.000492436073
  error estimate for blocks of size 2^( 3) =       0.000516823306
  error estimate for blocks of size 2^( 4) =       0.000535555547
  error estimate for blocks of size 2^( 5) =       0.000547772349
  error estimate for blocks of size 2^( 6) =       0.000553599823
  error estimate for blocks of size 2^( 7) =       0.000555895335

      target function =      -0.746467012142
              le_mean =     -22.814290154614
             les_mean =     520.940486046027
             stat err =       0.000548205763
             autocorr =       1.381028715877
   target nu stat err =       0.000548205763
   target dn stat err =       0.003089250993
      target stat err =       0.002638328060
              std dev =       0.659716339301
             le_variance =       0.435225648341

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435222199379
                                         uncertainty =       0.001948120319

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435222199379
                                         uncertainty =       0.001948120319

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466489897
  error estimate for blocks of size 2^( 2) =       0.000492436073
  error estimate for blocks of size 2^( 3) =       0.000516823306
  error estimate for blocks of size 2^( 4) =       0.000535555547
  error estimate for blocks of size 2^( 5) =       0.000547772349
  error estimate for blocks of size 2^( 6) =       0.000553599823
  error estimate for blocks of size 2^( 7) =       0.000555895335

      target function =      -0.746467012142
              le_mean =     -22.814290154614
             les_mean =     520.940486046027
             stat err =       0.000548205763
             autocorr =       1.381028715877
   target nu stat err =       0.000548205763
   target dn stat err =       0.003089250993
      target stat err =       0.002638328060
              std dev =       0.659716339301
             le_variance =       0.435225648341


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746467012142        initial  <--
     5.8208e+19     5.8208e+20             0.0000e+00        -0.746467012142
     2.3283e+20     2.3283e+21             0.0000e+00        -0.746467012142
     9.3132e+20     9.3132e+21             0.0000e+00        -0.746467012142

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.1776
  </log>
  <optVariables href="FORM2.s056.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2007e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s057 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s057 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=57  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2810e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -22.7651
    reference variance = 0.317179
====================================================
  Execution time = 2.5187e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s057
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5329e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5001e-01
  Total weights = 1.964821510e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5144e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438243379506
                                         uncertainty =       0.002808451651

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438243379506
                                         uncertainty =       0.002808451651

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468111377
  error estimate for blocks of size 2^( 2) =       0.000493826933
  error estimate for blocks of size 2^( 3) =       0.000518410568
  error estimate for blocks of size 2^( 4) =       0.000537660650
  error estimate for blocks of size 2^( 5) =       0.000548099653
  error estimate for blocks of size 2^( 6) =       0.000554836396
  error estimate for blocks of size 2^( 7) =       0.000558931612

      target function =      -0.745340782881
              le_mean =     -22.814626147271
             les_mean =     520.957173163618
             stat err =       0.000549882078
             autocorr =       1.379878149543
   target nu stat err =       0.000549882078
   target dn stat err =       0.003234118146
      target stat err =       0.002749261876
              std dev =       0.662009457552
             le_variance =       0.438256521889


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281462614727e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+20, overlap shift 5.8208e+21 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745350023920       residual = 2.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745350023920       residual = 2.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+21, overlap shift 2.3283e+22 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745350023920       residual = 2.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745350023920       residual = 2.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+21, overlap shift 9.3132e+22 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745350023920       residual = 2.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745350023920       residual = 2.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.098115 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9708e+01
  </log>
  <optVariables href="FORM2.s057.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -22.7826
    reference variance = 0.434241
====================================================
  Execution time = 2.4760e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s057
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4760e-01
  Total weights = 1.9649e+06
  Execution time = 3.5987e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434864515618
                                         uncertainty =       0.002029634763

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434864515618
                                         uncertainty =       0.002029634763

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466318168
  error estimate for blocks of size 2^( 2) =       0.000491907520
  error estimate for blocks of size 2^( 3) =       0.000516337627
  error estimate for blocks of size 2^( 4) =       0.000533752256
  error estimate for blocks of size 2^( 5) =       0.000544886118
  error estimate for blocks of size 2^( 6) =       0.000550223254
  error estimate for blocks of size 2^( 7) =       0.000556383285

      target function =      -0.747346320570
              le_mean =     -22.814936240834
             les_mean =     520.968912775642
             stat err =       0.000546311228
             autocorr =       1.372510202357
   target nu stat err =       0.000546311228
   target dn stat err =       0.002835114721
      target stat err =       0.002440761537
              std dev =       0.659473477349
             le_variance =       0.434905267327

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434864515618
                                         uncertainty =       0.002029634763

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434864515618
                                         uncertainty =       0.002029634763

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466318168
  error estimate for blocks of size 2^( 2) =       0.000491907520
  error estimate for blocks of size 2^( 3) =       0.000516337627
  error estimate for blocks of size 2^( 4) =       0.000533752256
  error estimate for blocks of size 2^( 5) =       0.000544886118
  error estimate for blocks of size 2^( 6) =       0.000550223254
  error estimate for blocks of size 2^( 7) =       0.000556383285

      target function =      -0.747346320570
              le_mean =     -22.814936240834
             les_mean =     520.968912775642
             stat err =       0.000546311228
             autocorr =       1.372510202357
   target nu stat err =       0.000546311228
   target dn stat err =       0.002835114721
      target stat err =       0.002440761537
              std dev =       0.659473477349
             le_variance =       0.434905267327

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434864515618
                                         uncertainty =       0.002029634763

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434864515618
                                         uncertainty =       0.002029634763

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466318168
  error estimate for blocks of size 2^( 2) =       0.000491907520
  error estimate for blocks of size 2^( 3) =       0.000516337627
  error estimate for blocks of size 2^( 4) =       0.000533752256
  error estimate for blocks of size 2^( 5) =       0.000544886118
  error estimate for blocks of size 2^( 6) =       0.000550223254
  error estimate for blocks of size 2^( 7) =       0.000556383285

      target function =      -0.747346320570
              le_mean =     -22.814936240834
             les_mean =     520.968912775642
             stat err =       0.000546311228
             autocorr =       1.372510202357
   target nu stat err =       0.000546311228
   target dn stat err =       0.002835114721
      target stat err =       0.002440761537
              std dev =       0.659473477349
             le_variance =       0.434905267327

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434864515618
                                         uncertainty =       0.002029634763

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434864515618
                                         uncertainty =       0.002029634763

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466318168
  error estimate for blocks of size 2^( 2) =       0.000491907520
  error estimate for blocks of size 2^( 3) =       0.000516337627
  error estimate for blocks of size 2^( 4) =       0.000533752256
  error estimate for blocks of size 2^( 5) =       0.000544886118
  error estimate for blocks of size 2^( 6) =       0.000550223254
  error estimate for blocks of size 2^( 7) =       0.000556383285

      target function =      -0.747346320570
              le_mean =     -22.814936240834
             les_mean =     520.968912775642
             stat err =       0.000546311228
             autocorr =       1.372510202357
   target nu stat err =       0.000546311228
   target dn stat err =       0.002835114721
      target stat err =       0.002440761537
              std dev =       0.659473477349
             le_variance =       0.434905267327


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747346320570        initial  <--
     5.8208e+20     5.8208e+21             0.0000e+00        -0.747346320570
     2.3283e+21     2.3283e+22             0.0000e+00        -0.747346320570
     9.3132e+21     9.3132e+22             0.0000e+00        -0.747346320570

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.3904
  </log>
  <optVariables href="FORM2.s057.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2104e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s058 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s058 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=58  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2810e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -22.8172
    reference variance = 0.275494
====================================================
  Execution time = 2.7231e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s058
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5340e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4941e-01
  Total weights = 1.964938823e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5187e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437284418349
                                         uncertainty =       0.001881862221

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437284418349
                                         uncertainty =       0.001881862221

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467615826
  error estimate for blocks of size 2^( 2) =       0.000493610528
  error estimate for blocks of size 2^( 3) =       0.000517754428
  error estimate for blocks of size 2^( 4) =       0.000536460994
  error estimate for blocks of size 2^( 5) =       0.000548363993
  error estimate for blocks of size 2^( 6) =       0.000554394971
  error estimate for blocks of size 2^( 7) =       0.000559067464

      target function =      -0.745840292955
              le_mean =     -22.813952036349
             les_mean =     520.925816335353
             stat err =       0.000549571856
             autocorr =       1.381244511280
   target nu stat err =       0.000549571856
   target dn stat err =       0.002547644567
      target stat err =       0.002198728821
              std dev =       0.661308643414
             le_variance =       0.437329121854


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281395203635e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+21, overlap shift 5.8208e+22 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745845774336       residual = 3.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745845774336       residual = 3.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+22, overlap shift 2.3283e+23 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745845774336       residual = 3.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745845774336       residual = 3.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+22, overlap shift 9.3132e+23 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745845774336       residual = 3.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745845774336       residual = 3.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.099251 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1757e+01
  </log>
  <optVariables href="FORM2.s058.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -22.8095
    reference variance = 0.401376
====================================================
  Execution time = 2.4702e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s058
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4197e-01
  Total weights = 1.9648e+06
  Execution time = 3.4997e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431880859021
                                         uncertainty =       0.002172962921

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431880859021
                                         uncertainty =       0.002172962921

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464692793
  error estimate for blocks of size 2^( 2) =       0.000490231139
  error estimate for blocks of size 2^( 3) =       0.000514733399
  error estimate for blocks of size 2^( 4) =       0.000532317790
  error estimate for blocks of size 2^( 5) =       0.000543485908
  error estimate for blocks of size 2^( 6) =       0.000549187123
  error estimate for blocks of size 2^( 7) =       0.000551138675

      target function =      -0.752064312963
              le_mean =     -22.814521677975
             les_mean =     520.944370355223
             stat err =       0.000544032374
             autocorr =       1.370621737701
   target nu stat err =       0.000544032374
   target dn stat err =       0.002396583893
      target stat err =       0.002112034657
              std dev =       0.657174849861
             le_variance =       0.431878783290

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431880859021
                                         uncertainty =       0.002172962921

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431880859021
                                         uncertainty =       0.002172962921

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464692793
  error estimate for blocks of size 2^( 2) =       0.000490231139
  error estimate for blocks of size 2^( 3) =       0.000514733399
  error estimate for blocks of size 2^( 4) =       0.000532317790
  error estimate for blocks of size 2^( 5) =       0.000543485908
  error estimate for blocks of size 2^( 6) =       0.000549187123
  error estimate for blocks of size 2^( 7) =       0.000551138675

      target function =      -0.752064312963
              le_mean =     -22.814521677975
             les_mean =     520.944370355223
             stat err =       0.000544032374
             autocorr =       1.370621737703
   target nu stat err =       0.000544032374
   target dn stat err =       0.002396583893
      target stat err =       0.002112034657
              std dev =       0.657174849861
             le_variance =       0.431878783290

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431880859021
                                         uncertainty =       0.002172962921

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431880859021
                                         uncertainty =       0.002172962921

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464692793
  error estimate for blocks of size 2^( 2) =       0.000490231139
  error estimate for blocks of size 2^( 3) =       0.000514733399
  error estimate for blocks of size 2^( 4) =       0.000532317790
  error estimate for blocks of size 2^( 5) =       0.000543485908
  error estimate for blocks of size 2^( 6) =       0.000549187123
  error estimate for blocks of size 2^( 7) =       0.000551138675

      target function =      -0.752064312963
              le_mean =     -22.814521677975
             les_mean =     520.944370355223
             stat err =       0.000544032374
             autocorr =       1.370621737703
   target nu stat err =       0.000544032374
   target dn stat err =       0.002396583893
      target stat err =       0.002112034657
              std dev =       0.657174849861
             le_variance =       0.431878783290

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431880859021
                                         uncertainty =       0.002172962921

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431880859021
                                         uncertainty =       0.002172962921

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464692793
  error estimate for blocks of size 2^( 2) =       0.000490231139
  error estimate for blocks of size 2^( 3) =       0.000514733399
  error estimate for blocks of size 2^( 4) =       0.000532317790
  error estimate for blocks of size 2^( 5) =       0.000543485908
  error estimate for blocks of size 2^( 6) =       0.000549187123
  error estimate for blocks of size 2^( 7) =       0.000551138675

      target function =      -0.752064312963
              le_mean =     -22.814521677975
             les_mean =     520.944370355223
             stat err =       0.000544032374
             autocorr =       1.370621737703
   target nu stat err =       0.000544032374
   target dn stat err =       0.002396583893
      target stat err =       0.002112034657
              std dev =       0.657174849861
             le_variance =       0.431878783290


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.752064312963        initial  <--
     5.8208e+21     5.8208e+22             0.0000e+00        -0.752064312963
     2.3283e+22     2.3283e+23             0.0000e+00        -0.752064312963
     9.3132e+22     9.3132e+23             0.0000e+00        -0.752064312963

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.1907
  </log>
  <optVariables href="FORM2.s058.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3953e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s059 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s059 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=59  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2810e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -22.7461
    reference variance = 0.830561
====================================================
  Execution time = 2.5332e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s059
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5330e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5017e-01
  Total weights = 1.964750816e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5590e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436593373989
                                         uncertainty =       0.002333158644

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436593373989
                                         uncertainty =       0.002333158644

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467381754
  error estimate for blocks of size 2^( 2) =       0.000493092462
  error estimate for blocks of size 2^( 3) =       0.000517528395
  error estimate for blocks of size 2^( 4) =       0.000535372330
  error estimate for blocks of size 2^( 5) =       0.000546833839
  error estimate for blocks of size 2^( 6) =       0.000552739945
  error estimate for blocks of size 2^( 7) =       0.000554145483

      target function =      -0.745205187516
              le_mean =     -22.814033057748
             les_mean =     520.930274244328
             stat err =       0.000547272899
             autocorr =       1.371084992933
   target nu stat err =       0.000547272899
   target dn stat err =       0.003412933652
      target stat err =       0.002889744058
              std dev =       0.660977614827
             le_variance =       0.436891407303


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281403305775e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+22, overlap shift 5.8208e+23 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745215328743       residual = 2.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745215328743       residual = 2.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+23, overlap shift 2.3283e+24 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745215328743       residual = 2.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745215328743       residual = 2.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+23, overlap shift 9.3132e+24 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745215328743       residual = 2.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745215328743       residual = 2.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.100354 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9898e+01
  </log>
  <optVariables href="FORM2.s059.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -22.8104
    reference variance = 0.36728
====================================================
  Execution time = 2.4714e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s059
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5164e-01
  Total weights = 1.9647e+06
  Execution time = 3.5155e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436679015182
                                         uncertainty =       0.002295554133

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436679015182
                                         uncertainty =       0.002295554133

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467232847
  error estimate for blocks of size 2^( 2) =       0.000493088921
  error estimate for blocks of size 2^( 3) =       0.000516970751
  error estimate for blocks of size 2^( 4) =       0.000535657059
  error estimate for blocks of size 2^( 5) =       0.000548312132
  error estimate for blocks of size 2^( 6) =       0.000555679086
  error estimate for blocks of size 2^( 7) =       0.000556610203

      target function =      -0.743982705084
              le_mean =     -22.814873786817
             les_mean =     520.970106646503
             stat err =       0.000549064620
             autocorr =       1.380957100947
   target nu stat err =       0.000549064620
   target dn stat err =       0.004106773563
      target stat err =       0.003446884348
              std dev =       0.660767028833
             le_variance =       0.436613066393

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436679015182
                                         uncertainty =       0.002295554133

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436679015182
                                         uncertainty =       0.002295554133

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467232847
  error estimate for blocks of size 2^( 2) =       0.000493088921
  error estimate for blocks of size 2^( 3) =       0.000516970751
  error estimate for blocks of size 2^( 4) =       0.000535657059
  error estimate for blocks of size 2^( 5) =       0.000548312132
  error estimate for blocks of size 2^( 6) =       0.000555679086
  error estimate for blocks of size 2^( 7) =       0.000556610203

      target function =      -0.743982705084
              le_mean =     -22.814873786817
             les_mean =     520.970106646503
             stat err =       0.000549064620
             autocorr =       1.380957100947
   target nu stat err =       0.000549064620
   target dn stat err =       0.004106773563
      target stat err =       0.003446884348
              std dev =       0.660767028833
             le_variance =       0.436613066393

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436679015182
                                         uncertainty =       0.002295554133

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436679015182
                                         uncertainty =       0.002295554133

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467232847
  error estimate for blocks of size 2^( 2) =       0.000493088921
  error estimate for blocks of size 2^( 3) =       0.000516970751
  error estimate for blocks of size 2^( 4) =       0.000535657059
  error estimate for blocks of size 2^( 5) =       0.000548312132
  error estimate for blocks of size 2^( 6) =       0.000555679086
  error estimate for blocks of size 2^( 7) =       0.000556610203

      target function =      -0.743982705084
              le_mean =     -22.814873786817
             les_mean =     520.970106646503
             stat err =       0.000549064620
             autocorr =       1.380957100947
   target nu stat err =       0.000549064620
   target dn stat err =       0.004106773563
      target stat err =       0.003446884348
              std dev =       0.660767028833
             le_variance =       0.436613066393

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436679015182
                                         uncertainty =       0.002295554133

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436679015182
                                         uncertainty =       0.002295554133

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467232847
  error estimate for blocks of size 2^( 2) =       0.000493088921
  error estimate for blocks of size 2^( 3) =       0.000516970751
  error estimate for blocks of size 2^( 4) =       0.000535657059
  error estimate for blocks of size 2^( 5) =       0.000548312132
  error estimate for blocks of size 2^( 6) =       0.000555679086
  error estimate for blocks of size 2^( 7) =       0.000556610203

      target function =      -0.743982705084
              le_mean =     -22.814873786817
             les_mean =     520.970106646503
             stat err =       0.000549064620
             autocorr =       1.380957100947
   target nu stat err =       0.000549064620
   target dn stat err =       0.004106773563
      target stat err =       0.003446884348
              std dev =       0.660767028833
             le_variance =       0.436613066393


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743982705084        initial  <--
     5.8208e+22     5.8208e+23             0.0000e+00        -0.743982705084
     2.3283e+23     2.3283e+24             0.0000e+00        -0.743982705084
     9.3132e+23     9.3132e+24             0.0000e+00        -0.743982705084

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.2958
  </log>
  <optVariables href="FORM2.s059.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2200e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s060 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s060 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=60  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2809e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 60
    time step          = 0.05
    reference energy   = -22.7072
    reference variance = 0.32592
====================================================
  Execution time = 2.7388e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s060
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5364e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4695e-01
  Total weights = 1.964669331e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4886e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434509390062
                                         uncertainty =       0.002078074214

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434509390062
                                         uncertainty =       0.002078074214

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466104904
  error estimate for blocks of size 2^( 2) =       0.000492112435
  error estimate for blocks of size 2^( 3) =       0.000516686598
  error estimate for blocks of size 2^( 4) =       0.000535413270
  error estimate for blocks of size 2^( 5) =       0.000547891265
  error estimate for blocks of size 2^( 6) =       0.000555995771
  error estimate for blocks of size 2^( 7) =       0.000562949395

      target function =      -0.747885039504
              le_mean =     -22.813953141774
             les_mean =     520.923404224246
             stat err =       0.000550562425
             autocorr =       1.395229958217
   target nu stat err =       0.000550562425
   target dn stat err =       0.003015887951
      target stat err =       0.002587917117
              std dev =       0.659171876254
             le_variance =       0.434507562444


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281395314177e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+23, overlap shift 5.8208e+24 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747893008472       residual = 3.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747893008472       residual = 4.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747893171765       residual = 5.48e+08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747893008472       residual = 6.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747893007872       residual = 3.89e+07           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+23 is 3.084991e-28

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+24, overlap shift 2.3283e+25 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747893008472       residual = 3.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747893008472       residual = 4.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747893008472       residual = 3.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+24 is 7.712478e-29

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+24, overlap shift 9.3132e+25 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747893008472       residual = 3.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747893008472       residual = 4.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747895515091       residual = 8.77e+09           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747893008472       residual = 3.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747863769531       residual = 1.69e+08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.731071015212       residual = 2.75e+06           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+24 is 1.928119e-29

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.102287 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1884e+01
  </log>
  <optVariables href="FORM2.s060.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 60
    time step          = 0.05
    reference energy   = -22.8031
    reference variance = 0.368601
====================================================
  Execution time = 2.4865e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s060
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4658e-01
  Total weights = 1.9647e+06
  Execution time = 3.4973e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434622747147
                                         uncertainty =       0.002619417562

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434622747147
                                         uncertainty =       0.002619417562

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466277034
  error estimate for blocks of size 2^( 2) =       0.000491523310
  error estimate for blocks of size 2^( 3) =       0.000516135030
  error estimate for blocks of size 2^( 4) =       0.000533595542
  error estimate for blocks of size 2^( 5) =       0.000545883590
  error estimate for blocks of size 2^( 6) =       0.000551284626
  error estimate for blocks of size 2^( 7) =       0.000553386975

      target function =      -0.748192358220
              le_mean =     -22.814401493785
             les_mean =     520.943493034963
             stat err =       0.000546037683
             autocorr =       1.371378007140
   target nu stat err =       0.000546037683
   target dn stat err =       0.003347101574
      target stat err =       0.002860032454
              std dev =       0.659415304962
             le_variance =       0.434828544418

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434622747147
                                         uncertainty =       0.002619417562

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434622747147
                                         uncertainty =       0.002619417562

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466277034
  error estimate for blocks of size 2^( 2) =       0.000491523310
  error estimate for blocks of size 2^( 3) =       0.000516135030
  error estimate for blocks of size 2^( 4) =       0.000533595542
  error estimate for blocks of size 2^( 5) =       0.000545883590
  error estimate for blocks of size 2^( 6) =       0.000551284626
  error estimate for blocks of size 2^( 7) =       0.000553386975

      target function =      -0.748192358220
              le_mean =     -22.814401493785
             les_mean =     520.943493034963
             stat err =       0.000546037683
             autocorr =       1.371378007140
   target nu stat err =       0.000546037683
   target dn stat err =       0.003347101574
      target stat err =       0.002860032454
              std dev =       0.659415304962
             le_variance =       0.434828544418

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434622747147
                                         uncertainty =       0.002619417562

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434622747147
                                         uncertainty =       0.002619417562

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466277034
  error estimate for blocks of size 2^( 2) =       0.000491523310
  error estimate for blocks of size 2^( 3) =       0.000516135030
  error estimate for blocks of size 2^( 4) =       0.000533595542
  error estimate for blocks of size 2^( 5) =       0.000545883590
  error estimate for blocks of size 2^( 6) =       0.000551284626
  error estimate for blocks of size 2^( 7) =       0.000553386975

      target function =      -0.748192358220
              le_mean =     -22.814401493785
             les_mean =     520.943493034963
             stat err =       0.000546037683
             autocorr =       1.371378007140
   target nu stat err =       0.000546037683
   target dn stat err =       0.003347101574
      target stat err =       0.002860032454
              std dev =       0.659415304962
             le_variance =       0.434828544418

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434622747147
                                         uncertainty =       0.002619417562

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434622747147
                                         uncertainty =       0.002619417562

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466277034
  error estimate for blocks of size 2^( 2) =       0.000491523310
  error estimate for blocks of size 2^( 3) =       0.000516135030
  error estimate for blocks of size 2^( 4) =       0.000533595542
  error estimate for blocks of size 2^( 5) =       0.000545883590
  error estimate for blocks of size 2^( 6) =       0.000551284626
  error estimate for blocks of size 2^( 7) =       0.000553386975

      target function =      -0.748192358220
              le_mean =     -22.814401493785
             les_mean =     520.943493034963
             stat err =       0.000546037683
             autocorr =       1.371378007140
   target nu stat err =       0.000546037683
   target dn stat err =       0.003347101574
      target stat err =       0.002860032454
              std dev =       0.659415304962
             le_variance =       0.434828544418


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748192358220        initial  <--
     5.8208e+23     5.8208e+24             3.0850e-28        -0.748192358220
     2.3283e+24     2.3283e+25             7.7125e-29        -0.748192358220
     9.3132e+24     9.3132e+25             1.9281e-29        -0.748192358220

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.3510
  </log>
  <optVariables href="FORM2.s060.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4241e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s061 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s061 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=61  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2808e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 61
    time step          = 0.05
    reference energy   = -22.837
    reference variance = 0.324393
====================================================
  Execution time = 2.5314e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s061
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5342e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4575e-01
  Total weights = 1.964662550e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5125e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434755923967
                                         uncertainty =       0.001902975136

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434755923967
                                         uncertainty =       0.001902975136

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466245369
  error estimate for blocks of size 2^( 2) =       0.000492229065
  error estimate for blocks of size 2^( 3) =       0.000516330626
  error estimate for blocks of size 2^( 4) =       0.000533431025
  error estimate for blocks of size 2^( 5) =       0.000545665748
  error estimate for blocks of size 2^( 6) =       0.000550460640
  error estimate for blocks of size 2^( 7) =       0.000554940058

      target function =      -0.748890485397
              le_mean =     -22.814451763690
             les_mean =     520.944958546429
             stat err =       0.000546124368
             autocorr =       1.371999797371
   target nu stat err =       0.000546124368
   target dn stat err =       0.002260198631
      target stat err =       0.001986582171
              std dev =       0.659370524736
             le_variance =       0.434769488891


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281445176369e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+24, overlap shift 5.8208e+25 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748894759594       residual = 2.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748894759594       residual = 3.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748894759594       residual = 2.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+24 is 2.582775e-29

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+25, overlap shift 2.3283e+26 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748894759594       residual = 2.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748894759594       residual = 3.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748894759594       residual = 2.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+25 is 6.456938e-30

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+25, overlap shift 9.3132e+26 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748894759594       residual = 2.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748894759594       residual = 3.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748894759594       residual = 2.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+25 is 1.614235e-30

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.103683 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9834e+01
  </log>
  <optVariables href="FORM2.s061.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 61
    time step          = 0.05
    reference energy   = -22.886
    reference variance = 0.78543
====================================================
  Execution time = 2.4939e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s061
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4673e-01
  Total weights = 1.9645e+06
  Execution time = 3.5028e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433992512628
                                         uncertainty =       0.001860859211

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433992512628
                                         uncertainty =       0.001860859211

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465840132
  error estimate for blocks of size 2^( 2) =       0.000491234302
  error estimate for blocks of size 2^( 3) =       0.000515514557
  error estimate for blocks of size 2^( 4) =       0.000534069279
  error estimate for blocks of size 2^( 5) =       0.000545828868
  error estimate for blocks of size 2^( 6) =       0.000553795281
  error estimate for blocks of size 2^( 7) =       0.000555751420

      target function =      -0.748075479850
              le_mean =     -22.815055028384
             les_mean =     520.973461222831
             stat err =       0.000547361212
             autocorr =       1.380620240246
   target nu stat err =       0.000547361212
   target dn stat err =       0.002555375234
      target stat err =       0.002220584485
              std dev =       0.658797432958
             le_variance =       0.434014057672

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433992512628
                                         uncertainty =       0.001860859211

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433992512628
                                         uncertainty =       0.001860859211

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465840132
  error estimate for blocks of size 2^( 2) =       0.000491234302
  error estimate for blocks of size 2^( 3) =       0.000515514557
  error estimate for blocks of size 2^( 4) =       0.000534069279
  error estimate for blocks of size 2^( 5) =       0.000545828868
  error estimate for blocks of size 2^( 6) =       0.000553795281
  error estimate for blocks of size 2^( 7) =       0.000555751420

      target function =      -0.748075479850
              le_mean =     -22.815055028384
             les_mean =     520.973461222831
             stat err =       0.000547361212
             autocorr =       1.380620240246
   target nu stat err =       0.000547361212
   target dn stat err =       0.002555375234
      target stat err =       0.002220584485
              std dev =       0.658797432958
             le_variance =       0.434014057672

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433992512628
                                         uncertainty =       0.001860859211

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433992512628
                                         uncertainty =       0.001860859211

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465840132
  error estimate for blocks of size 2^( 2) =       0.000491234302
  error estimate for blocks of size 2^( 3) =       0.000515514557
  error estimate for blocks of size 2^( 4) =       0.000534069279
  error estimate for blocks of size 2^( 5) =       0.000545828868
  error estimate for blocks of size 2^( 6) =       0.000553795281
  error estimate for blocks of size 2^( 7) =       0.000555751420

      target function =      -0.748075479850
              le_mean =     -22.815055028384
             les_mean =     520.973461222831
             stat err =       0.000547361212
             autocorr =       1.380620240246
   target nu stat err =       0.000547361212
   target dn stat err =       0.002555375234
      target stat err =       0.002220584485
              std dev =       0.658797432958
             le_variance =       0.434014057672

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433992512628
                                         uncertainty =       0.001860859211

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433992512628
                                         uncertainty =       0.001860859211

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465840132
  error estimate for blocks of size 2^( 2) =       0.000491234302
  error estimate for blocks of size 2^( 3) =       0.000515514557
  error estimate for blocks of size 2^( 4) =       0.000534069279
  error estimate for blocks of size 2^( 5) =       0.000545828868
  error estimate for blocks of size 2^( 6) =       0.000553795281
  error estimate for blocks of size 2^( 7) =       0.000555751420

      target function =      -0.748075479850
              le_mean =     -22.815055028384
             les_mean =     520.973461222831
             stat err =       0.000547361212
             autocorr =       1.380620240246
   target nu stat err =       0.000547361212
   target dn stat err =       0.002555375234
      target stat err =       0.002220584485
              std dev =       0.658797432958
             le_variance =       0.434014057672


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748075479850        initial  <--
     5.8208e+24     5.8208e+25             2.5828e-29        -0.748075479850
     2.3283e+25     2.3283e+26             6.4569e-30        -0.748075479850
     9.3132e+25     9.3132e+26             1.6142e-30        -0.748075479850

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.4638
  </log>
  <optVariables href="FORM2.s061.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2304e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s062 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s062 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=62  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2809e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 62
    time step          = 0.05
    reference energy   = -22.7453
    reference variance = 0.294148
====================================================
  Execution time = 2.7323e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s062
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5362e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5189e-01
  Total weights = 1.964893313e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5316e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437752049031
                                         uncertainty =       0.002383944420

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437752049031
                                         uncertainty =       0.002383944420

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467866743
  error estimate for blocks of size 2^( 2) =       0.000494037050
  error estimate for blocks of size 2^( 3) =       0.000518527223
  error estimate for blocks of size 2^( 4) =       0.000537493628
  error estimate for blocks of size 2^( 5) =       0.000549619396
  error estimate for blocks of size 2^( 6) =       0.000557109686
  error estimate for blocks of size 2^( 7) =       0.000561871793

      target function =      -0.743777434267
              le_mean =     -22.815273496549
             les_mean =     520.988598124382
             stat err =       0.000551523626
             autocorr =       1.389581075464
   target nu stat err =       0.000551523626
   target dn stat err =       0.003368936731
      target stat err =       0.002849749674
              std dev =       0.661663493394
             le_variance =       0.437798578490


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281527349655e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+25, overlap shift 5.8208e+26 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743787369079       residual = 2.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743787369079       residual = 3.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743787369080       residual = 2.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+25 is 2.608805e-30

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+26, overlap shift 2.3283e+27 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743787369079       residual = 2.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743787369079       residual = 3.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743787369079       residual = 5.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743787369079       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+26 is 6.418225e-31

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+26, overlap shift 9.3132e+27 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743787369079       residual = 2.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743787369079       residual = 3.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743787369079       residual = 5.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743787369080       residual = 1.10e-02           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+26 is 1.720490e-31

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.105284 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1862e+01
  </log>
  <optVariables href="FORM2.s062.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 62
    time step          = 0.05
    reference energy   = -22.7845
    reference variance = 0.640053
====================================================
  Execution time = 2.4524e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s062
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5091e-01
  Total weights = 1.9645e+06
  Execution time = 3.4990e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436950022400
                                         uncertainty =       0.002345708055

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436950022400
                                         uncertainty =       0.002345708055

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467393752
  error estimate for blocks of size 2^( 2) =       0.000492956377
  error estimate for blocks of size 2^( 3) =       0.000517732021
  error estimate for blocks of size 2^( 4) =       0.000536690039
  error estimate for blocks of size 2^( 5) =       0.000548571062
  error estimate for blocks of size 2^( 6) =       0.000555506453
  error estimate for blocks of size 2^( 7) =       0.000555179083

      target function =      -0.744589148207
              le_mean =     -22.814744398061
             les_mean =     520.963476140884
             stat err =       0.000548986659
             autocorr =       1.379614586340
   target nu stat err =       0.000548986659
   target dn stat err =       0.003267713911
      target stat err =       0.002771224656
              std dev =       0.660994582459
             le_variance =       0.436913838041

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436950022400
                                         uncertainty =       0.002345708055

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436950022400
                                         uncertainty =       0.002345708055

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467393752
  error estimate for blocks of size 2^( 2) =       0.000492956377
  error estimate for blocks of size 2^( 3) =       0.000517732021
  error estimate for blocks of size 2^( 4) =       0.000536690039
  error estimate for blocks of size 2^( 5) =       0.000548571062
  error estimate for blocks of size 2^( 6) =       0.000555506453
  error estimate for blocks of size 2^( 7) =       0.000555179083

      target function =      -0.744589148207
              le_mean =     -22.814744398061
             les_mean =     520.963476140884
             stat err =       0.000548986659
             autocorr =       1.379614586338
   target nu stat err =       0.000548986659
   target dn stat err =       0.003267713911
      target stat err =       0.002771224656
              std dev =       0.660994582459
             le_variance =       0.436913838041

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436950022400
                                         uncertainty =       0.002345708055

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436950022400
                                         uncertainty =       0.002345708055

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467393752
  error estimate for blocks of size 2^( 2) =       0.000492956377
  error estimate for blocks of size 2^( 3) =       0.000517732021
  error estimate for blocks of size 2^( 4) =       0.000536690039
  error estimate for blocks of size 2^( 5) =       0.000548571062
  error estimate for blocks of size 2^( 6) =       0.000555506453
  error estimate for blocks of size 2^( 7) =       0.000555179083

      target function =      -0.744589148207
              le_mean =     -22.814744398061
             les_mean =     520.963476140884
             stat err =       0.000548986659
             autocorr =       1.379614586338
   target nu stat err =       0.000548986659
   target dn stat err =       0.003267713911
      target stat err =       0.002771224656
              std dev =       0.660994582459
             le_variance =       0.436913838041

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436950022400
                                         uncertainty =       0.002345708055

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436950022400
                                         uncertainty =       0.002345708055

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467393752
  error estimate for blocks of size 2^( 2) =       0.000492956377
  error estimate for blocks of size 2^( 3) =       0.000517732021
  error estimate for blocks of size 2^( 4) =       0.000536690039
  error estimate for blocks of size 2^( 5) =       0.000548571062
  error estimate for blocks of size 2^( 6) =       0.000555506453
  error estimate for blocks of size 2^( 7) =       0.000555179083

      target function =      -0.744589148207
              le_mean =     -22.814744398061
             les_mean =     520.963476140884
             stat err =       0.000548986659
             autocorr =       1.379614586338
   target nu stat err =       0.000548986659
   target dn stat err =       0.003267713911
      target stat err =       0.002771224656
              std dev =       0.660994582459
             le_variance =       0.436913838041


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744589148207        initial  <--
     5.8208e+25     5.8208e+26             2.6088e-30        -0.744589148207
     2.3283e+26     2.3283e+27             6.4182e-31        -0.744589148207
     9.3132e+26     9.3132e+27             1.7205e-31        -0.744589148207

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.0208
  </log>
  <optVariables href="FORM2.s062.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3948e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s063 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s063 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=63  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2808e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 63
    time step          = 0.05
    reference energy   = -22.7526
    reference variance = 0.472644
====================================================
  Execution time = 2.5361e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s063
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5347e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5681e-01
  Total weights = 1.964832172e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5039e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442576975372
                                         uncertainty =       0.004554216590

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442576975372
                                         uncertainty =       0.004554216590

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470680690
  error estimate for blocks of size 2^( 2) =       0.000496608433
  error estimate for blocks of size 2^( 3) =       0.000520737567
  error estimate for blocks of size 2^( 4) =       0.000538511205
  error estimate for blocks of size 2^( 5) =       0.000550047749
  error estimate for blocks of size 2^( 6) =       0.000555617547
  error estimate for blocks of size 2^( 7) =       0.000559523680

      target function =      -0.739717260205
              le_mean =     -22.815169939639
             les_mean =     520.988785462780
             stat err =       0.000550925046
             autocorr =       1.370036918844
   target nu stat err =       0.000550925046
   target dn stat err =       0.006070677329
      target stat err =       0.004997064090
              std dev =       0.665643014808
             le_variance =       0.443080623162


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281516993964e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+26, overlap shift 5.8208e+27 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.739751939473       residual = 5.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.739751939473       residual = 5.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+26 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+27, overlap shift 2.3283e+28 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.739751939473       residual = 5.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.739751939473       residual = 5.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+27 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+27, overlap shift 9.3132e+28 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.739751939473       residual = 5.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.739751939473       residual = 5.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+27 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.106454 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9872e+01
  </log>
  <optVariables href="FORM2.s063.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 63
    time step          = 0.05
    reference energy   = -22.8234
    reference variance = 0.294604
====================================================
  Execution time = 2.4784e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s063
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4926e-01
  Total weights = 1.9647e+06
  Execution time = 3.4872e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437389982586
                                         uncertainty =       0.003072768496

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437389982586
                                         uncertainty =       0.003072768496

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467681762
  error estimate for blocks of size 2^( 2) =       0.000493484583
  error estimate for blocks of size 2^( 3) =       0.000517896860
  error estimate for blocks of size 2^( 4) =       0.000536733622
  error estimate for blocks of size 2^( 5) =       0.000549105291
  error estimate for blocks of size 2^( 6) =       0.000556146606
  error estimate for blocks of size 2^( 7) =       0.000561250206

      target function =      -0.745955699794
              le_mean =     -22.814445720307
             les_mean =     520.948196737097
             stat err =       0.000550808931
             autocorr =       1.387078624245
   target nu stat err =       0.000550808931
   target dn stat err =       0.003542188390
      target stat err =       0.003002987325
              std dev =       0.661401890588
             le_variance =       0.437452460873

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437389982586
                                         uncertainty =       0.003072768496

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437389982586
                                         uncertainty =       0.003072768496

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467681762
  error estimate for blocks of size 2^( 2) =       0.000493484583
  error estimate for blocks of size 2^( 3) =       0.000517896860
  error estimate for blocks of size 2^( 4) =       0.000536733622
  error estimate for blocks of size 2^( 5) =       0.000549105291
  error estimate for blocks of size 2^( 6) =       0.000556146606
  error estimate for blocks of size 2^( 7) =       0.000561250206

      target function =      -0.745955699794
              le_mean =     -22.814445720307
             les_mean =     520.948196737097
             stat err =       0.000550808931
             autocorr =       1.387078624245
   target nu stat err =       0.000550808931
   target dn stat err =       0.003542188390
      target stat err =       0.003002987325
              std dev =       0.661401890588
             le_variance =       0.437452460873

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437389982586
                                         uncertainty =       0.003072768496

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437389982586
                                         uncertainty =       0.003072768496

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467681762
  error estimate for blocks of size 2^( 2) =       0.000493484583
  error estimate for blocks of size 2^( 3) =       0.000517896860
  error estimate for blocks of size 2^( 4) =       0.000536733622
  error estimate for blocks of size 2^( 5) =       0.000549105291
  error estimate for blocks of size 2^( 6) =       0.000556146606
  error estimate for blocks of size 2^( 7) =       0.000561250206

      target function =      -0.745955699794
              le_mean =     -22.814445720307
             les_mean =     520.948196737097
             stat err =       0.000550808931
             autocorr =       1.387078624245
   target nu stat err =       0.000550808931
   target dn stat err =       0.003542188390
      target stat err =       0.003002987325
              std dev =       0.661401890588
             le_variance =       0.437452460873

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437389982586
                                         uncertainty =       0.003072768496

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437389982586
                                         uncertainty =       0.003072768496

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467681762
  error estimate for blocks of size 2^( 2) =       0.000493484583
  error estimate for blocks of size 2^( 3) =       0.000517896860
  error estimate for blocks of size 2^( 4) =       0.000536733622
  error estimate for blocks of size 2^( 5) =       0.000549105291
  error estimate for blocks of size 2^( 6) =       0.000556146606
  error estimate for blocks of size 2^( 7) =       0.000561250206

      target function =      -0.745955699794
              le_mean =     -22.814445720307
             les_mean =     520.948196737097
             stat err =       0.000550808931
             autocorr =       1.387078624245
   target nu stat err =       0.000550808931
   target dn stat err =       0.003542188390
      target stat err =       0.003002987325
              std dev =       0.661401890588
             le_variance =       0.437452460873


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745955699794        initial  <--
     5.8208e+26     5.8208e+27             0.0000e+00        -0.745955699794
     2.3283e+27     2.3283e+28             0.0000e+00        -0.745955699794
     9.3132e+27     9.3132e+28             0.0000e+00        -0.745955699794

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.2234
  </log>
  <optVariables href="FORM2.s063.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2132e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s064 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s064 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=64  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2808e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 64
    time step          = 0.05
    reference energy   = -22.7845
    reference variance = 0.292048
====================================================
  Execution time = 2.8933e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s064
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5338e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4896e-01
  Total weights = 1.964638103e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4755e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435501719552
                                         uncertainty =       0.002012722976

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435501719552
                                         uncertainty =       0.002012722976

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466641357
  error estimate for blocks of size 2^( 2) =       0.000492183582
  error estimate for blocks of size 2^( 3) =       0.000516817545
  error estimate for blocks of size 2^( 4) =       0.000535448473
  error estimate for blocks of size 2^( 5) =       0.000545985701
  error estimate for blocks of size 2^( 6) =       0.000553183680
  error estimate for blocks of size 2^( 7) =       0.000558445819

      target function =      -0.746204735887
              le_mean =     -22.814864842902
             les_mean =     520.967021718089
             stat err =       0.000548265918
             autocorr =       1.380435268724
   target nu stat err =       0.000548265918
   target dn stat err =       0.003483801090
      target stat err =       0.002958759764
              std dev =       0.659930535935
             le_variance =       0.435508312260


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281486484290e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+27, overlap shift 5.8208e+28 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746215524398       residual = 2.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746215524398       residual = 3.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746215524398       residual = 5.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+27 is 3.351141e-32

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+28, overlap shift 2.3283e+29 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746215524398       residual = 2.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746215524398       residual = 3.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746215524398       residual = 5.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+28 is 8.377853e-33

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+28, overlap shift 9.3132e+29 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746215524398       residual = 2.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746215524398       residual = 3.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746215524398       residual = 5.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+28 is 2.094463e-33

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.107830 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.3415e+01
  </log>
  <optVariables href="FORM2.s064.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 64
    time step          = 0.05
    reference energy   = -22.7802
    reference variance = 0.421623
====================================================
  Execution time = 2.5326e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s064
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4643e-01
  Total weights = 1.9647e+06
  Execution time = 3.4884e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435592447940
                                         uncertainty =       0.001867929923

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435592447940
                                         uncertainty =       0.001867929923

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466724292
  error estimate for blocks of size 2^( 2) =       0.000492746939
  error estimate for blocks of size 2^( 3) =       0.000516822741
  error estimate for blocks of size 2^( 4) =       0.000535510902
  error estimate for blocks of size 2^( 5) =       0.000546515932
  error estimate for blocks of size 2^( 6) =       0.000553518282
  error estimate for blocks of size 2^( 7) =       0.000557125447

      target function =      -0.748318205776
              le_mean =     -22.813854777201
             les_mean =     520.918400164501
             stat err =       0.000548167641
             autocorr =       1.379450047459
   target nu stat err =       0.000548167641
   target dn stat err =       0.002380616196
      target stat err =       0.002078447290
              std dev =       0.660047824034
             le_variance =       0.435663130012

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435592447940
                                         uncertainty =       0.001867929923

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435592447940
                                         uncertainty =       0.001867929923

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466724292
  error estimate for blocks of size 2^( 2) =       0.000492746939
  error estimate for blocks of size 2^( 3) =       0.000516822741
  error estimate for blocks of size 2^( 4) =       0.000535510902
  error estimate for blocks of size 2^( 5) =       0.000546515932
  error estimate for blocks of size 2^( 6) =       0.000553518282
  error estimate for blocks of size 2^( 7) =       0.000557125447

      target function =      -0.748318205776
              le_mean =     -22.813854777201
             les_mean =     520.918400164501
             stat err =       0.000548167641
             autocorr =       1.379450047459
   target nu stat err =       0.000548167641
   target dn stat err =       0.002380616196
      target stat err =       0.002078447290
              std dev =       0.660047824034
             le_variance =       0.435663130012

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435592447940
                                         uncertainty =       0.001867929923

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435592447940
                                         uncertainty =       0.001867929923

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466724292
  error estimate for blocks of size 2^( 2) =       0.000492746939
  error estimate for blocks of size 2^( 3) =       0.000516822741
  error estimate for blocks of size 2^( 4) =       0.000535510902
  error estimate for blocks of size 2^( 5) =       0.000546515932
  error estimate for blocks of size 2^( 6) =       0.000553518282
  error estimate for blocks of size 2^( 7) =       0.000557125447

      target function =      -0.748318205776
              le_mean =     -22.813854777201
             les_mean =     520.918400164501
             stat err =       0.000548167641
             autocorr =       1.379450047459
   target nu stat err =       0.000548167641
   target dn stat err =       0.002380616196
      target stat err =       0.002078447290
              std dev =       0.660047824034
             le_variance =       0.435663130012

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435592447940
                                         uncertainty =       0.001867929923

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435592447940
                                         uncertainty =       0.001867929923

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466724292
  error estimate for blocks of size 2^( 2) =       0.000492746939
  error estimate for blocks of size 2^( 3) =       0.000516822741
  error estimate for blocks of size 2^( 4) =       0.000535510902
  error estimate for blocks of size 2^( 5) =       0.000546515932
  error estimate for blocks of size 2^( 6) =       0.000553518282
  error estimate for blocks of size 2^( 7) =       0.000557125447

      target function =      -0.748318205776
              le_mean =     -22.813854777201
             les_mean =     520.918400164501
             stat err =       0.000548167641
             autocorr =       1.379450047459
   target nu stat err =       0.000548167641
   target dn stat err =       0.002380616196
      target stat err =       0.002078447290
              std dev =       0.660047824034
             le_variance =       0.435663130012


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748318205776        initial  <--
     5.8208e+27     5.8208e+28             3.3511e-32        -0.748318205776
     2.3283e+28     2.3283e+29             8.3779e-33        -0.748318205776
     9.3132e+28     9.3132e+29             2.0945e-33        -0.748318205776

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.7694
  </log>
  <optVariables href="FORM2.s064.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6191e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s065 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s065 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=65  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2808e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 65
    time step          = 0.05
    reference energy   = -22.8356
    reference variance = 0.317278
====================================================
  Execution time = 2.5404e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s065
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5357e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4716e-01
  Total weights = 1.964731724e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6313e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433375136137
                                         uncertainty =       0.002334382280

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433375136137
                                         uncertainty =       0.002334382280

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465540480
  error estimate for blocks of size 2^( 2) =       0.000491097364
  error estimate for blocks of size 2^( 3) =       0.000515148665
  error estimate for blocks of size 2^( 4) =       0.000532616746
  error estimate for blocks of size 2^( 5) =       0.000544732822
  error estimate for blocks of size 2^( 6) =       0.000551373232
  error estimate for blocks of size 2^( 7) =       0.000553934172

      target function =      -0.747702854996
              le_mean =     -22.813769457852
             les_mean =     520.915235439790
             stat err =       0.000545664243
             autocorr =       1.373839791554
   target nu stat err =       0.000545664243
   target dn stat err =       0.003744287240
      target stat err =       0.003177646216
              std dev =       0.658373660909
             le_variance =       0.433455877378


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281376945785e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+28, overlap shift 5.8208e+29 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747715351627       residual = 4.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747715351627       residual = 2.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747715351627       residual = 5.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747715351637       residual = 3.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747715473175       residual = 8.60e+05           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+28 is 3.987883e-33

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+29, overlap shift 2.3283e+30 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747715351627       residual = 4.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747715351627       residual = 2.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747715351627       residual = 5.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747715351637       residual = 3.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+29 is 9.969707e-34

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+29, overlap shift 9.3132e+30 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747715351627       residual = 4.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747715351627       residual = 2.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747715351627       residual = 5.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747715353966       residual = 2.90e+03           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+29 is 2.492427e-34

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.109617 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0042e+01
  </log>
  <optVariables href="FORM2.s065.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 65
    time step          = 0.05
    reference energy   = -22.7696
    reference variance = 0.472728
====================================================
  Execution time = 2.4536e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s065
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4619e-01
  Total weights = 1.9649e+06
  Execution time = 3.5040e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434403569712
                                         uncertainty =       0.001929114940

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434403569712
                                         uncertainty =       0.001929114940

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466063303
  error estimate for blocks of size 2^( 2) =       0.000492110640
  error estimate for blocks of size 2^( 3) =       0.000516148816
  error estimate for blocks of size 2^( 4) =       0.000534845423
  error estimate for blocks of size 2^( 5) =       0.000548009282
  error estimate for blocks of size 2^( 6) =       0.000557257673
  error estimate for blocks of size 2^( 7) =       0.000560746564

      target function =      -0.748517066798
              le_mean =     -22.813636886535
             les_mean =     520.908216441355
             stat err =       0.000550214736
             autocorr =       1.393717063956
   target nu stat err =       0.000550214736
   target dn stat err =       0.002747106592
      target stat err =       0.002373492949
              std dev =       0.659113043774
             le_variance =       0.434430004473

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434403569712
                                         uncertainty =       0.001929114940

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434403569712
                                         uncertainty =       0.001929114940

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466063303
  error estimate for blocks of size 2^( 2) =       0.000492110640
  error estimate for blocks of size 2^( 3) =       0.000516148816
  error estimate for blocks of size 2^( 4) =       0.000534845423
  error estimate for blocks of size 2^( 5) =       0.000548009282
  error estimate for blocks of size 2^( 6) =       0.000557257673
  error estimate for blocks of size 2^( 7) =       0.000560746564

      target function =      -0.748517066798
              le_mean =     -22.813636886535
             les_mean =     520.908216441355
             stat err =       0.000550214736
             autocorr =       1.393717063956
   target nu stat err =       0.000550214736
   target dn stat err =       0.002747106592
      target stat err =       0.002373492949
              std dev =       0.659113043774
             le_variance =       0.434430004473

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434403569712
                                         uncertainty =       0.001929114940

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434403569712
                                         uncertainty =       0.001929114940

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466063303
  error estimate for blocks of size 2^( 2) =       0.000492110640
  error estimate for blocks of size 2^( 3) =       0.000516148816
  error estimate for blocks of size 2^( 4) =       0.000534845423
  error estimate for blocks of size 2^( 5) =       0.000548009282
  error estimate for blocks of size 2^( 6) =       0.000557257673
  error estimate for blocks of size 2^( 7) =       0.000560746564

      target function =      -0.748517066798
              le_mean =     -22.813636886535
             les_mean =     520.908216441355
             stat err =       0.000550214736
             autocorr =       1.393717063956
   target nu stat err =       0.000550214736
   target dn stat err =       0.002747106592
      target stat err =       0.002373492949
              std dev =       0.659113043774
             le_variance =       0.434430004473

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434403569712
                                         uncertainty =       0.001929114940

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434403569712
                                         uncertainty =       0.001929114940

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466063303
  error estimate for blocks of size 2^( 2) =       0.000492110640
  error estimate for blocks of size 2^( 3) =       0.000516148816
  error estimate for blocks of size 2^( 4) =       0.000534845423
  error estimate for blocks of size 2^( 5) =       0.000548009282
  error estimate for blocks of size 2^( 6) =       0.000557257673
  error estimate for blocks of size 2^( 7) =       0.000560746564

      target function =      -0.748517066798
              le_mean =     -22.813636886535
             les_mean =     520.908216441355
             stat err =       0.000550214736
             autocorr =       1.393717063956
   target nu stat err =       0.000550214736
   target dn stat err =       0.002747106592
      target stat err =       0.002373492949
              std dev =       0.659113043774
             le_variance =       0.434430004473


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748517066798        initial  <--
     5.8208e+28     5.8208e+29             3.9879e-33        -0.748517066798
     2.3283e+29     2.3283e+30             9.9697e-34        -0.748517066798
     9.3132e+29     9.3132e+30             2.4924e-34        -0.748517066798

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.1283
  </log>
  <optVariables href="FORM2.s065.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2177e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s066 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s066 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=66  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2808e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 66
    time step          = 0.05
    reference energy   = -22.8847
    reference variance = 0.414917
====================================================
  Execution time = 2.7350e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s066
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5354e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4819e-01
  Total weights = 1.965102208e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5335e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434498490027
                                         uncertainty =       0.001812890644

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434498490027
                                         uncertainty =       0.001812890644

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466165128
  error estimate for blocks of size 2^( 2) =       0.000492315559
  error estimate for blocks of size 2^( 3) =       0.000516312580
  error estimate for blocks of size 2^( 4) =       0.000534810188
  error estimate for blocks of size 2^( 5) =       0.000545484171
  error estimate for blocks of size 2^( 6) =       0.000552619222
  error estimate for blocks of size 2^( 7) =       0.000557788516

      target function =      -0.746844076694
              le_mean =     -22.813733817442
             les_mean =     520.914638867927
             stat err =       0.000547675524
             autocorr =       1.380279695259
   target nu stat err =       0.000547675524
   target dn stat err =       0.004041420946
      target stat err =       0.003413409100
              std dev =       0.659257046800
             le_variance =       0.434619853756


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281373381744e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+29, overlap shift 5.8208e+30 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746858562218       residual = 2.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746858562218       residual = 2.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+29 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+30, overlap shift 2.3283e+31 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746858562218       residual = 2.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746858562218       residual = 2.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+30 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+30, overlap shift 9.3132e+31 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746858562218       residual = 2.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746858562218       residual = 2.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+30 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.110746 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1890e+01
  </log>
  <optVariables href="FORM2.s066.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 66
    time step          = 0.05
    reference energy   = -22.7401
    reference variance = 0.632446
====================================================
  Execution time = 2.5173e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s066
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2813e+01
  VMC Evar = 4.5373e-01
  Total weights = 1.9647e+06
  Execution time = 3.5106e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440673147453
                                         uncertainty =       0.003029179002

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440673147453
                                         uncertainty =       0.003029179002

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469358502
  error estimate for blocks of size 2^( 2) =       0.000495165273
  error estimate for blocks of size 2^( 3) =       0.000519390451
  error estimate for blocks of size 2^( 4) =       0.000538163273
  error estimate for blocks of size 2^( 5) =       0.000549718408
  error estimate for blocks of size 2^( 6) =       0.000557128272
  error estimate for blocks of size 2^( 7) =       0.000561933361

      target function =      -0.742272324950
              le_mean =     -22.812865172632
             les_mean =     520.880545956562
             stat err =       0.000551735828
             autocorr =       1.381824842156
   target nu stat err =       0.000551735828
   target dn stat err =       0.003859816769
      target stat err =       0.003222537617
              std dev =       0.663773158729
             le_variance =       0.440594806249

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440673147453
                                         uncertainty =       0.003029179002

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440673147453
                                         uncertainty =       0.003029179002

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469358502
  error estimate for blocks of size 2^( 2) =       0.000495165273
  error estimate for blocks of size 2^( 3) =       0.000519390451
  error estimate for blocks of size 2^( 4) =       0.000538163273
  error estimate for blocks of size 2^( 5) =       0.000549718408
  error estimate for blocks of size 2^( 6) =       0.000557128272
  error estimate for blocks of size 2^( 7) =       0.000561933361

      target function =      -0.742272324950
              le_mean =     -22.812865172632
             les_mean =     520.880545956562
             stat err =       0.000551735828
             autocorr =       1.381824842155
   target nu stat err =       0.000551735828
   target dn stat err =       0.003859816769
      target stat err =       0.003222537617
              std dev =       0.663773158729
             le_variance =       0.440594806249

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440673147453
                                         uncertainty =       0.003029179002

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440673147453
                                         uncertainty =       0.003029179002

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469358502
  error estimate for blocks of size 2^( 2) =       0.000495165273
  error estimate for blocks of size 2^( 3) =       0.000519390451
  error estimate for blocks of size 2^( 4) =       0.000538163273
  error estimate for blocks of size 2^( 5) =       0.000549718408
  error estimate for blocks of size 2^( 6) =       0.000557128272
  error estimate for blocks of size 2^( 7) =       0.000561933361

      target function =      -0.742272324950
              le_mean =     -22.812865172632
             les_mean =     520.880545956562
             stat err =       0.000551735828
             autocorr =       1.381824842155
   target nu stat err =       0.000551735828
   target dn stat err =       0.003859816769
      target stat err =       0.003222537617
              std dev =       0.663773158729
             le_variance =       0.440594806249

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440673147453
                                         uncertainty =       0.003029179002

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440673147453
                                         uncertainty =       0.003029179002

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469358502
  error estimate for blocks of size 2^( 2) =       0.000495165273
  error estimate for blocks of size 2^( 3) =       0.000519390451
  error estimate for blocks of size 2^( 4) =       0.000538163273
  error estimate for blocks of size 2^( 5) =       0.000549718408
  error estimate for blocks of size 2^( 6) =       0.000557128272
  error estimate for blocks of size 2^( 7) =       0.000561933361

      target function =      -0.742272324950
              le_mean =     -22.812865172632
             les_mean =     520.880545956562
             stat err =       0.000551735828
             autocorr =       1.381824842155
   target nu stat err =       0.000551735828
   target dn stat err =       0.003859816769
      target stat err =       0.003222537617
              std dev =       0.663773158729
             le_variance =       0.440594806249


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.742272324950        initial  <--
     5.8208e+29     5.8208e+30             0.0000e+00        -0.742272324950
     2.3283e+30     2.3283e+31             0.0000e+00        -0.742272324950
     9.3132e+30     9.3132e+31             0.0000e+00        -0.742272324950

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.7460
  </log>
  <optVariables href="FORM2.s066.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5115e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s067 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s067 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=67  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2808e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 67
    time step          = 0.05
    reference energy   = -22.7185
    reference variance = 0.337997
====================================================
  Execution time = 2.5507e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s067
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5354e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4887e-01
  Total weights = 1.964704671e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5358e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436250186535
                                         uncertainty =       0.002588366630

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436250186535
                                         uncertainty =       0.002588366630

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467027501
  error estimate for blocks of size 2^( 2) =       0.000492790317
  error estimate for blocks of size 2^( 3) =       0.000517112147
  error estimate for blocks of size 2^( 4) =       0.000535320044
  error estimate for blocks of size 2^( 5) =       0.000547133757
  error estimate for blocks of size 2^( 6) =       0.000554257964
  error estimate for blocks of size 2^( 7) =       0.000558011203

      target function =      -0.746283738167
              le_mean =     -22.814123118729
             les_mean =     520.933084928711
             stat err =       0.000548680742
             autocorr =       1.380239729894
   target nu stat err =       0.000548680742
   target dn stat err =       0.003081149582
      target stat err =       0.002629989649
              std dev =       0.660476625936
             le_variance =       0.436229373407


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281412311873e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+30, overlap shift 5.8208e+31 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746291979492       residual = 2.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746291979492       residual = 2.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+30 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+31, overlap shift 2.3283e+32 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746291979492       residual = 2.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746291979492       residual = 2.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+31 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+31, overlap shift 9.3132e+32 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746291979492       residual = 2.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746291979492       residual = 2.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+31 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.111880 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0049e+01
  </log>
  <optVariables href="FORM2.s067.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 67
    time step          = 0.05
    reference energy   = -22.7914
    reference variance = 0.426316
====================================================
  Execution time = 2.4478e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s067
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4577e-01
  Total weights = 1.9644e+06
  Execution time = 3.5041e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433681188374
                                         uncertainty =       0.001885796261

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433681188374
                                         uncertainty =       0.001885796261

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465628423
  error estimate for blocks of size 2^( 2) =       0.000491623089
  error estimate for blocks of size 2^( 3) =       0.000516115557
  error estimate for blocks of size 2^( 4) =       0.000534674454
  error estimate for blocks of size 2^( 5) =       0.000546373748
  error estimate for blocks of size 2^( 6) =       0.000552881197
  error estimate for blocks of size 2^( 7) =       0.000555716170

      target function =      -0.748867841593
              le_mean =     -22.814321957256
             les_mean =     520.939059585914
             stat err =       0.000547411392
             autocorr =       1.382129375399
   target nu stat err =       0.000547411392
   target dn stat err =       0.002689598145
      target stat err =       0.002330820202
              std dev =       0.658498030758
             le_variance =       0.433619656513

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433681188374
                                         uncertainty =       0.001885796261

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433681188374
                                         uncertainty =       0.001885796261

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465628423
  error estimate for blocks of size 2^( 2) =       0.000491623089
  error estimate for blocks of size 2^( 3) =       0.000516115557
  error estimate for blocks of size 2^( 4) =       0.000534674454
  error estimate for blocks of size 2^( 5) =       0.000546373748
  error estimate for blocks of size 2^( 6) =       0.000552881197
  error estimate for blocks of size 2^( 7) =       0.000555716170

      target function =      -0.748867841593
              le_mean =     -22.814321957256
             les_mean =     520.939059585914
             stat err =       0.000547411392
             autocorr =       1.382129375399
   target nu stat err =       0.000547411392
   target dn stat err =       0.002689598145
      target stat err =       0.002330820202
              std dev =       0.658498030758
             le_variance =       0.433619656513

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433681188374
                                         uncertainty =       0.001885796261

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433681188374
                                         uncertainty =       0.001885796261

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465628423
  error estimate for blocks of size 2^( 2) =       0.000491623089
  error estimate for blocks of size 2^( 3) =       0.000516115557
  error estimate for blocks of size 2^( 4) =       0.000534674454
  error estimate for blocks of size 2^( 5) =       0.000546373748
  error estimate for blocks of size 2^( 6) =       0.000552881197
  error estimate for blocks of size 2^( 7) =       0.000555716170

      target function =      -0.748867841593
              le_mean =     -22.814321957256
             les_mean =     520.939059585914
             stat err =       0.000547411392
             autocorr =       1.382129375399
   target nu stat err =       0.000547411392
   target dn stat err =       0.002689598145
      target stat err =       0.002330820202
              std dev =       0.658498030758
             le_variance =       0.433619656513

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433681188374
                                         uncertainty =       0.001885796261

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433681188374
                                         uncertainty =       0.001885796261

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465628423
  error estimate for blocks of size 2^( 2) =       0.000491623089
  error estimate for blocks of size 2^( 3) =       0.000516115557
  error estimate for blocks of size 2^( 4) =       0.000534674454
  error estimate for blocks of size 2^( 5) =       0.000546373748
  error estimate for blocks of size 2^( 6) =       0.000552881197
  error estimate for blocks of size 2^( 7) =       0.000555716170

      target function =      -0.748867841593
              le_mean =     -22.814321957256
             les_mean =     520.939059585914
             stat err =       0.000547411392
             autocorr =       1.382129375399
   target nu stat err =       0.000547411392
   target dn stat err =       0.002689598145
      target stat err =       0.002330820202
              std dev =       0.658498030758
             le_variance =       0.433619656513


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748867841593        initial  <--
     5.8208e+30     5.8208e+31             0.0000e+00        -0.748867841593
     2.3283e+31     2.3283e+32             0.0000e+00        -0.748867841593
     9.3132e+31     9.3132e+32             0.0000e+00        -0.748867841593

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 41.9933
  </log>
  <optVariables href="FORM2.s067.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2049e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s068 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s068 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=68  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2807e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 68
    time step          = 0.05
    reference energy   = -22.8294
    reference variance = 0.322301
====================================================
  Execution time = 2.7524e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s068
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5362e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4714e-01
  Total weights = 1.965166576e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5048e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433922601308
                                         uncertainty =       0.001866526128

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433922601308
                                         uncertainty =       0.001866526128

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465747947
  error estimate for blocks of size 2^( 2) =       0.000491510693
  error estimate for blocks of size 2^( 3) =       0.000515791226
  error estimate for blocks of size 2^( 4) =       0.000534001813
  error estimate for blocks of size 2^( 5) =       0.000545081229
  error estimate for blocks of size 2^( 6) =       0.000551399014
  error estimate for blocks of size 2^( 7) =       0.000559147847

      target function =      -0.747724171770
              le_mean =     -22.814312054468
             les_mean =     520.939978484473
             stat err =       0.000547407476
             autocorr =       1.381400312483
   target nu stat err =       0.000547407476
   target dn stat err =       0.002500086658
      target stat err =       0.002171859332
              std dev =       0.658667062998
             le_variance =       0.433842299878


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281431205447e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+31, overlap shift 5.8208e+32 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747729497397       residual = 2.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747729497397       residual = 4.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747729497397       residual = 7.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747729497397       residual = 2.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747729495168       residual = 2.83e-01           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+31 is 4.281075e-36

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+32, overlap shift 2.3283e+33 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747729497397       residual = 2.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747729497397       residual = 4.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747729497397       residual = 7.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747729497397       residual = 2.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+32 is 1.070269e-36

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+32, overlap shift 9.3132e+33 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747729497397       residual = 2.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747729497397       residual = 4.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747729497397       residual = 7.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747729495168       residual = 6.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+32 is 2.075983e-37

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.113680 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2036e+01
  </log>
  <optVariables href="FORM2.s068.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 68
    time step          = 0.05
    reference energy   = -22.8289
    reference variance = 0.496896
====================================================
  Execution time = 2.4666e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s068
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4729e-01
  Total weights = 1.9646e+06
  Execution time = 3.5152e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435758617435
                                         uncertainty =       0.002377469703

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435758617435
                                         uncertainty =       0.002377469703

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466801686
  error estimate for blocks of size 2^( 2) =       0.000492155114
  error estimate for blocks of size 2^( 3) =       0.000516161432
  error estimate for blocks of size 2^( 4) =       0.000534116331
  error estimate for blocks of size 2^( 5) =       0.000545920564
  error estimate for blocks of size 2^( 6) =       0.000554470963
  error estimate for blocks of size 2^( 7) =       0.000554601020

      target function =      -0.747600870558
              le_mean =     -22.815142008224
             les_mean =     520.977996868989
             stat err =       0.000547277220
             autocorr =       1.374516348059
   target nu stat err =       0.000547277220
   target dn stat err =       0.002859682110
      target stat err =       0.002463248018
              std dev =       0.660157275784
             le_variance =       0.435807628771

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435758617435
                                         uncertainty =       0.002377469703

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435758617435
                                         uncertainty =       0.002377469703

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466801686
  error estimate for blocks of size 2^( 2) =       0.000492155114
  error estimate for blocks of size 2^( 3) =       0.000516161432
  error estimate for blocks of size 2^( 4) =       0.000534116331
  error estimate for blocks of size 2^( 5) =       0.000545920564
  error estimate for blocks of size 2^( 6) =       0.000554470963
  error estimate for blocks of size 2^( 7) =       0.000554601020

      target function =      -0.747600870558
              le_mean =     -22.815142008224
             les_mean =     520.977996868989
             stat err =       0.000547277220
             autocorr =       1.374516348059
   target nu stat err =       0.000547277220
   target dn stat err =       0.002859682110
      target stat err =       0.002463248018
              std dev =       0.660157275784
             le_variance =       0.435807628771

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435758617435
                                         uncertainty =       0.002377469703

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435758617435
                                         uncertainty =       0.002377469703

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466801686
  error estimate for blocks of size 2^( 2) =       0.000492155114
  error estimate for blocks of size 2^( 3) =       0.000516161432
  error estimate for blocks of size 2^( 4) =       0.000534116331
  error estimate for blocks of size 2^( 5) =       0.000545920564
  error estimate for blocks of size 2^( 6) =       0.000554470963
  error estimate for blocks of size 2^( 7) =       0.000554601020

      target function =      -0.747600870558
              le_mean =     -22.815142008224
             les_mean =     520.977996868989
             stat err =       0.000547277220
             autocorr =       1.374516348059
   target nu stat err =       0.000547277220
   target dn stat err =       0.002859682110
      target stat err =       0.002463248018
              std dev =       0.660157275784
             le_variance =       0.435807628771

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435758617435
                                         uncertainty =       0.002377469703

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435758617435
                                         uncertainty =       0.002377469703

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466801686
  error estimate for blocks of size 2^( 2) =       0.000492155114
  error estimate for blocks of size 2^( 3) =       0.000516161432
  error estimate for blocks of size 2^( 4) =       0.000534116331
  error estimate for blocks of size 2^( 5) =       0.000545920564
  error estimate for blocks of size 2^( 6) =       0.000554470963
  error estimate for blocks of size 2^( 7) =       0.000554601020

      target function =      -0.747600870558
              le_mean =     -22.815142008224
             les_mean =     520.977996868989
             stat err =       0.000547277220
             autocorr =       1.374516348059
   target nu stat err =       0.000547277220
   target dn stat err =       0.002859682110
      target stat err =       0.002463248018
              std dev =       0.660157275784
             le_variance =       0.435807628771


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747600870558        initial  <--
     5.8208e+31     5.8208e+32             4.2811e-36        -0.747600870558
     2.3283e+32     2.3283e+33             1.0703e-36        -0.747600870558
     9.3132e+32     9.3132e+33             2.0760e-37        -0.747600870558

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.2589
  </log>
  <optVariables href="FORM2.s068.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4301e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s069 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s069 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=69  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2807e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 69
    time step          = 0.05
    reference energy   = -22.7281
    reference variance = 0.267841
====================================================
  Execution time = 2.5276e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s069
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5350e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5079e-01
  Total weights = 1.964616754e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5211e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438188500865
                                         uncertainty =       0.002892025099

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438188500865
                                         uncertainty =       0.002892025099

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468025927
  error estimate for blocks of size 2^( 2) =       0.000493678313
  error estimate for blocks of size 2^( 3) =       0.000517983438
  error estimate for blocks of size 2^( 4) =       0.000536224257
  error estimate for blocks of size 2^( 5) =       0.000548043140
  error estimate for blocks of size 2^( 6) =       0.000554016822
  error estimate for blocks of size 2^( 7) =       0.000556050155

      target function =      -0.744689992578
              le_mean =     -22.814696286595
             les_mean =     520.961154871495
             stat err =       0.000548583593
             autocorr =       1.373870520555
   target nu stat err =       0.000548583593
   target dn stat err =       0.003840555890
      target stat err =       0.003235737144
              std dev =       0.661888614129
             le_variance =       0.438096537514


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281469628659e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+32, overlap shift 5.8208e+33 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744702912457       residual = 1.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744702912457       residual = 1.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744702912457       residual = 3.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+32 is 2.627415e-37

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+33, overlap shift 2.3283e+34 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744702912457       residual = 1.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744702912457       residual = 1.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744702912457       residual = 3.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+33 is 6.568539e-38

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+33, overlap shift 9.3132e+34 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744702912457       residual = 1.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744702912457       residual = 1.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+33 is 1.647923e-38

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.114965 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9803e+01
  </log>
  <optVariables href="FORM2.s069.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 69
    time step          = 0.05
    reference energy   = -22.8184
    reference variance = 0.355729
====================================================
  Execution time = 2.4806e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s069
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4990e-01
  Total weights = 1.9649e+06
  Execution time = 3.5009e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437914569534
                                         uncertainty =       0.002777332031

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437914569534
                                         uncertainty =       0.002777332031

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467912276
  error estimate for blocks of size 2^( 2) =       0.000493278538
  error estimate for blocks of size 2^( 3) =       0.000517337135
  error estimate for blocks of size 2^( 4) =       0.000535576147
  error estimate for blocks of size 2^( 5) =       0.000546132363
  error estimate for blocks of size 2^( 6) =       0.000552789172
  error estimate for blocks of size 2^( 7) =       0.000556029717

      target function =      -0.745432373466
              le_mean =     -22.814912665087
             les_mean =     520.970136482701
             stat err =       0.000547631850
             autocorr =       1.369772735088
   target nu stat err =       0.000547631850
   target dn stat err =       0.003191044490
      target stat err =       0.002715715703
              std dev =       0.661727886967
             le_variance =       0.437883796390

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437914569534
                                         uncertainty =       0.002777332031

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437914569534
                                         uncertainty =       0.002777332031

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467912276
  error estimate for blocks of size 2^( 2) =       0.000493278538
  error estimate for blocks of size 2^( 3) =       0.000517337135
  error estimate for blocks of size 2^( 4) =       0.000535576147
  error estimate for blocks of size 2^( 5) =       0.000546132363
  error estimate for blocks of size 2^( 6) =       0.000552789172
  error estimate for blocks of size 2^( 7) =       0.000556029717

      target function =      -0.745432373466
              le_mean =     -22.814912665087
             les_mean =     520.970136482701
             stat err =       0.000547631850
             autocorr =       1.369772735088
   target nu stat err =       0.000547631850
   target dn stat err =       0.003191044490
      target stat err =       0.002715715703
              std dev =       0.661727886967
             le_variance =       0.437883796390

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437914569534
                                         uncertainty =       0.002777332031

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437914569534
                                         uncertainty =       0.002777332031

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467912276
  error estimate for blocks of size 2^( 2) =       0.000493278538
  error estimate for blocks of size 2^( 3) =       0.000517337135
  error estimate for blocks of size 2^( 4) =       0.000535576147
  error estimate for blocks of size 2^( 5) =       0.000546132363
  error estimate for blocks of size 2^( 6) =       0.000552789172
  error estimate for blocks of size 2^( 7) =       0.000556029717

      target function =      -0.745432373466
              le_mean =     -22.814912665087
             les_mean =     520.970136482701
             stat err =       0.000547631850
             autocorr =       1.369772735088
   target nu stat err =       0.000547631850
   target dn stat err =       0.003191044490
      target stat err =       0.002715715703
              std dev =       0.661727886967
             le_variance =       0.437883796390

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437914569534
                                         uncertainty =       0.002777332031

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437914569534
                                         uncertainty =       0.002777332031

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467912276
  error estimate for blocks of size 2^( 2) =       0.000493278538
  error estimate for blocks of size 2^( 3) =       0.000517337135
  error estimate for blocks of size 2^( 4) =       0.000535576147
  error estimate for blocks of size 2^( 5) =       0.000546132363
  error estimate for blocks of size 2^( 6) =       0.000552789172
  error estimate for blocks of size 2^( 7) =       0.000556029717

      target function =      -0.745432373466
              le_mean =     -22.814912665087
             les_mean =     520.970136482701
             stat err =       0.000547631850
             autocorr =       1.369772735088
   target nu stat err =       0.000547631850
   target dn stat err =       0.003191044490
      target stat err =       0.002715715703
              std dev =       0.661727886967
             le_variance =       0.437883796390


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745432373466        initial  <--
     5.8208e+32     5.8208e+33             2.6274e-37        -0.745432373466
     2.3283e+33     2.3283e+34             6.5685e-38        -0.745432373466
     9.3132e+33     9.3132e+34             1.6479e-38        -0.745432373466

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.3302
  </log>
  <optVariables href="FORM2.s069.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2202e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s070 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s070 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=70  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2807e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 70
    time step          = 0.05
    reference energy   = -22.8414
    reference variance = 0.402539
====================================================
  Execution time = 2.7312e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s070
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5373e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5247e-01
  Total weights = 1.964638895e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5127e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438040953276
                                         uncertainty =       0.002071419208

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438040953276
                                         uncertainty =       0.002071419208

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467953296
  error estimate for blocks of size 2^( 2) =       0.000493180047
  error estimate for blocks of size 2^( 3) =       0.000517150893
  error estimate for blocks of size 2^( 4) =       0.000535058667
  error estimate for blocks of size 2^( 5) =       0.000547140225
  error estimate for blocks of size 2^( 6) =       0.000553257601
  error estimate for blocks of size 2^( 7) =       0.000559564325

      target function =      -0.743307736165
              le_mean =     -22.814058806902
             les_mean =     520.933748297631
             stat err =       0.000548755204
             autocorr =       1.375156996200
   target nu stat err =       0.000548755204
   target dn stat err =       0.003263518001
      target stat err =       0.002755674811
              std dev =       0.661785898080
             le_variance =       0.437960574897


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281405880690e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+33, overlap shift 5.8208e+34 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743316920428       residual = 2.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743316920428       residual = 2.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743316920428       residual = 2.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+33 is 2.474967e-38

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+34, overlap shift 2.3283e+35 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743316920428       residual = 2.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743316920428       residual = 2.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743316920428       residual = 2.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+34 is 6.187418e-39

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+34, overlap shift 9.3132e+35 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743316920428       residual = 2.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743316920428       residual = 2.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743316920428       residual = 2.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+34 is 1.546855e-39

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.116355 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1832e+01
  </log>
  <optVariables href="FORM2.s070.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 70
    time step          = 0.05
    reference energy   = -22.8356
    reference variance = 0.411769
====================================================
  Execution time = 2.4614e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s070
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5171e-01
  Total weights = 1.9650e+06
  Execution time = 3.4927e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437125418139
                                         uncertainty =       0.002159818913

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437125418139
                                         uncertainty =       0.002159818913

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467693527
  error estimate for blocks of size 2^( 2) =       0.000493287671
  error estimate for blocks of size 2^( 3) =       0.000517179126
  error estimate for blocks of size 2^( 4) =       0.000535562229
  error estimate for blocks of size 2^( 5) =       0.000546936431
  error estimate for blocks of size 2^( 6) =       0.000553882013
  error estimate for blocks of size 2^( 7) =       0.000557759550

      target function =      -0.743935498802
              le_mean =     -22.814070585481
             les_mean =     520.933521994031
             stat err =       0.000548535056
             autocorr =       1.375580647626
   target nu stat err =       0.000548535056
   target dn stat err =       0.003543062048
      target stat err =       0.002985601700
              std dev =       0.661418528536
             le_variance =       0.437474469890

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437125418139
                                         uncertainty =       0.002159818913

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437125418139
                                         uncertainty =       0.002159818913

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467693527
  error estimate for blocks of size 2^( 2) =       0.000493287671
  error estimate for blocks of size 2^( 3) =       0.000517179126
  error estimate for blocks of size 2^( 4) =       0.000535562229
  error estimate for blocks of size 2^( 5) =       0.000546936431
  error estimate for blocks of size 2^( 6) =       0.000553882013
  error estimate for blocks of size 2^( 7) =       0.000557759550

      target function =      -0.743935498802
              le_mean =     -22.814070585481
             les_mean =     520.933521994031
             stat err =       0.000548535056
             autocorr =       1.375580647626
   target nu stat err =       0.000548535056
   target dn stat err =       0.003543062048
      target stat err =       0.002985601700
              std dev =       0.661418528536
             le_variance =       0.437474469890

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437125418139
                                         uncertainty =       0.002159818913

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437125418139
                                         uncertainty =       0.002159818913

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467693527
  error estimate for blocks of size 2^( 2) =       0.000493287671
  error estimate for blocks of size 2^( 3) =       0.000517179126
  error estimate for blocks of size 2^( 4) =       0.000535562229
  error estimate for blocks of size 2^( 5) =       0.000546936431
  error estimate for blocks of size 2^( 6) =       0.000553882013
  error estimate for blocks of size 2^( 7) =       0.000557759550

      target function =      -0.743935498802
              le_mean =     -22.814070585481
             les_mean =     520.933521994031
             stat err =       0.000548535056
             autocorr =       1.375580647626
   target nu stat err =       0.000548535056
   target dn stat err =       0.003543062048
      target stat err =       0.002985601700
              std dev =       0.661418528536
             le_variance =       0.437474469890

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437125418139
                                         uncertainty =       0.002159818913

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437125418139
                                         uncertainty =       0.002159818913

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467693527
  error estimate for blocks of size 2^( 2) =       0.000493287671
  error estimate for blocks of size 2^( 3) =       0.000517179126
  error estimate for blocks of size 2^( 4) =       0.000535562229
  error estimate for blocks of size 2^( 5) =       0.000546936431
  error estimate for blocks of size 2^( 6) =       0.000553882013
  error estimate for blocks of size 2^( 7) =       0.000557759550

      target function =      -0.743935498802
              le_mean =     -22.814070585481
             les_mean =     520.933521994031
             stat err =       0.000548535056
             autocorr =       1.375580647626
   target nu stat err =       0.000548535056
   target dn stat err =       0.003543062048
      target stat err =       0.002985601700
              std dev =       0.661418528536
             le_variance =       0.437474469890


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743935498802        initial  <--
     5.8208e+33     5.8208e+34             2.4750e-38        -0.743935498802
     2.3283e+34     2.3283e+35             6.1874e-39        -0.743935498802
     9.3132e+34     9.3132e+35             1.5469e-39        -0.743935498802

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.0992
  </log>
  <optVariables href="FORM2.s070.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3937e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s071 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s071 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=71  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2807e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 71
    time step          = 0.05
    reference energy   = -22.8351
    reference variance = 0.384937
====================================================
  Execution time = 2.5222e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s071
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5364e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4781e-01
  Total weights = 1.964521244e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4976e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434897950524
                                         uncertainty =       0.001984067927

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434897950524
                                         uncertainty =       0.001984067927

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466311483
  error estimate for blocks of size 2^( 2) =       0.000491780488
  error estimate for blocks of size 2^( 3) =       0.000515851392
  error estimate for blocks of size 2^( 4) =       0.000534986709
  error estimate for blocks of size 2^( 5) =       0.000546689412
  error estimate for blocks of size 2^( 6) =       0.000553153670
  error estimate for blocks of size 2^( 7) =       0.000556190070

      target function =      -0.747171999802
              le_mean =     -22.814964121738
             les_mean =     520.970394025732
             stat err =       0.000547754965
             autocorr =       1.379813613639
   target nu stat err =       0.000547754965
   target dn stat err =       0.002842131382
      target stat err =       0.002445824169
              std dev =       0.659464023827
             le_variance =       0.434892798722


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281496412174e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+34, overlap shift 5.8208e+35 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747179036133       residual = 2.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747179036133       residual = 2.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747179036133       residual = 5.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747179036133       residual = 2.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747179036133       residual = 6.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747070312500       residual = 1.53e+05           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+34 is 3.753598e-39

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+35, overlap shift 2.3283e+36 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747179036133       residual = 2.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747179036133       residual = 2.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747179036133       residual = 5.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747179036133       residual = 2.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747179036133       residual = 6.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747179034753       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746880796356       residual = 3.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =       0.383694114888       residual = 1.19e+00           smallest_sin_value = 1.00e+00
davidson iteration    8 stopping due to too large eigenvalue change
davidson solver did not converge after          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+35 is 1.045923e-39

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+35, overlap shift 9.3132e+36 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747179036133       residual = 2.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747179036133       residual = 2.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747179036133       residual = 5.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747179036133       residual = 2.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747192382812       residual = 9.21e+02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.750000000000       residual = 8.44e+11           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+35 is 1.906779e-40

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.118993 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9728e+01
  </log>
  <optVariables href="FORM2.s071.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 71
    time step          = 0.05
    reference energy   = -22.8351
    reference variance = 0.363971
====================================================
  Execution time = 2.4621e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s071
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4424e-01
  Total weights = 1.9648e+06
  Execution time = 3.4872e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431780519977
                                         uncertainty =       0.002036429619

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431780519977
                                         uncertainty =       0.002036429619

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464653721
  error estimate for blocks of size 2^( 2) =       0.000490126928
  error estimate for blocks of size 2^( 3) =       0.000514059056
  error estimate for blocks of size 2^( 4) =       0.000532154264
  error estimate for blocks of size 2^( 5) =       0.000544131223
  error estimate for blocks of size 2^( 6) =       0.000551791421
  error estimate for blocks of size 2^( 7) =       0.000555298423

      target function =      -0.750146175155
              le_mean =     -22.813749236822
             les_mean =     520.911394106840
             stat err =       0.000545843833
             autocorr =       1.379996471361
   target nu stat err =       0.000545843833
   target dn stat err =       0.003045482695
      target stat err =       0.002625243591
              std dev =       0.657119594597
             le_variance =       0.431806161603

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431780519977
                                         uncertainty =       0.002036429619

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431780519977
                                         uncertainty =       0.002036429619

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464653721
  error estimate for blocks of size 2^( 2) =       0.000490126928
  error estimate for blocks of size 2^( 3) =       0.000514059056
  error estimate for blocks of size 2^( 4) =       0.000532154264
  error estimate for blocks of size 2^( 5) =       0.000544131223
  error estimate for blocks of size 2^( 6) =       0.000551791421
  error estimate for blocks of size 2^( 7) =       0.000555298423

      target function =      -0.750146175155
              le_mean =     -22.813749236822
             les_mean =     520.911394106840
             stat err =       0.000545843833
             autocorr =       1.379996471361
   target nu stat err =       0.000545843833
   target dn stat err =       0.003045482695
      target stat err =       0.002625243591
              std dev =       0.657119594597
             le_variance =       0.431806161603

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431780519977
                                         uncertainty =       0.002036429619

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431780519977
                                         uncertainty =       0.002036429619

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464653721
  error estimate for blocks of size 2^( 2) =       0.000490126928
  error estimate for blocks of size 2^( 3) =       0.000514059056
  error estimate for blocks of size 2^( 4) =       0.000532154264
  error estimate for blocks of size 2^( 5) =       0.000544131223
  error estimate for blocks of size 2^( 6) =       0.000551791421
  error estimate for blocks of size 2^( 7) =       0.000555298423

      target function =      -0.750146175155
              le_mean =     -22.813749236822
             les_mean =     520.911394106840
             stat err =       0.000545843833
             autocorr =       1.379996471361
   target nu stat err =       0.000545843833
   target dn stat err =       0.003045482695
      target stat err =       0.002625243591
              std dev =       0.657119594597
             le_variance =       0.431806161603

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431780519977
                                         uncertainty =       0.002036429619

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431780519977
                                         uncertainty =       0.002036429619

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464653721
  error estimate for blocks of size 2^( 2) =       0.000490126928
  error estimate for blocks of size 2^( 3) =       0.000514059056
  error estimate for blocks of size 2^( 4) =       0.000532154264
  error estimate for blocks of size 2^( 5) =       0.000544131223
  error estimate for blocks of size 2^( 6) =       0.000551791421
  error estimate for blocks of size 2^( 7) =       0.000555298423

      target function =      -0.750146175155
              le_mean =     -22.813749236822
             les_mean =     520.911394106840
             stat err =       0.000545843833
             autocorr =       1.379996471361
   target nu stat err =       0.000545843833
   target dn stat err =       0.003045482695
      target stat err =       0.002625243591
              std dev =       0.657119594597
             le_variance =       0.431806161603


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.750146175155        initial  <--
     5.8208e+34     5.8208e+35             3.7536e-39        -0.750146175155
     2.3283e+35     2.3283e+36             1.0459e-39        -0.750146175155
     9.3132e+35     9.3132e+36             1.9068e-40        -0.750146175155

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.1064
  </log>
  <optVariables href="FORM2.s071.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.1840e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s072 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s072 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=72  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2808e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 72
    time step          = 0.05
    reference energy   = -22.8188
    reference variance = 0.292843
====================================================
  Execution time = 2.5986e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s072
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5357e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5348e-01
  Total weights = 1.964681327e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.8955e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440339179042
                                         uncertainty =       0.002382481278

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440339179042
                                         uncertainty =       0.002382481278

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469225424
  error estimate for blocks of size 2^( 2) =       0.000494738397
  error estimate for blocks of size 2^( 3) =       0.000519291582
  error estimate for blocks of size 2^( 4) =       0.000537298066
  error estimate for blocks of size 2^( 5) =       0.000549682153
  error estimate for blocks of size 2^( 6) =       0.000555472249
  error estimate for blocks of size 2^( 7) =       0.000561293775

      target function =      -0.742466617818
              le_mean =     -22.815242749499
             les_mean =     520.988784107627
             stat err =       0.000550936561
             autocorr =       1.378605846346
   target nu stat err =       0.000550936561
   target dn stat err =       0.003456170216
      target stat err =       0.002909845643
              std dev =       0.663584958612
             le_variance =       0.440344997296


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281524274950e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+35, overlap shift 5.8208e+36 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742477166674       residual = 1.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742477166674       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742477178574       residual = 1.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+35 is 2.292987e-40

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+36, overlap shift 2.3283e+37 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742477166674       residual = 1.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742477166674       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742477166674       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742477166674       residual = 6.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742477166674       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+36 is 5.836078e-41

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+36, overlap shift 9.3132e+37 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742477166674       residual = 1.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742477166674       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742477166674       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742477166674       residual = 6.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742477166674       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+36 is 1.459019e-41

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.120807 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0892e+01
  </log>
  <optVariables href="FORM2.s072.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 72
    time step          = 0.05
    reference energy   = -23.0117
    reference variance = 0.875882
====================================================
  Execution time = 2.4734e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s072
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4528e-01
  Total weights = 1.9648e+06
  Execution time = 3.4888e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433950689336
                                         uncertainty =       0.002125586253

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433950689336
                                         uncertainty =       0.002125586253

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465836611
  error estimate for blocks of size 2^( 2) =       0.000491426437
  error estimate for blocks of size 2^( 3) =       0.000516291547
  error estimate for blocks of size 2^( 4) =       0.000534954558
  error estimate for blocks of size 2^( 5) =       0.000545503108
  error estimate for blocks of size 2^( 6) =       0.000552208952
  error estimate for blocks of size 2^( 7) =       0.000557568107

      target function =      -0.749282528742
              le_mean =     -22.814085871452
             les_mean =     520.927791391164
             stat err =       0.000547558681
             autocorr =       1.381637470961
   target nu stat err =       0.000547558681
   target dn stat err =       0.002481470177
      target stat err =       0.002164925656
              std dev =       0.658792452697
             le_variance =       0.434007495730

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433950689336
                                         uncertainty =       0.002125586253

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433950689336
                                         uncertainty =       0.002125586253

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465836611
  error estimate for blocks of size 2^( 2) =       0.000491426437
  error estimate for blocks of size 2^( 3) =       0.000516291547
  error estimate for blocks of size 2^( 4) =       0.000534954558
  error estimate for blocks of size 2^( 5) =       0.000545503108
  error estimate for blocks of size 2^( 6) =       0.000552208952
  error estimate for blocks of size 2^( 7) =       0.000557568107

      target function =      -0.749282528742
              le_mean =     -22.814085871452
             les_mean =     520.927791391164
             stat err =       0.000547558681
             autocorr =       1.381637470962
   target nu stat err =       0.000547558681
   target dn stat err =       0.002481470177
      target stat err =       0.002164925656
              std dev =       0.658792452697
             le_variance =       0.434007495730

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433950689336
                                         uncertainty =       0.002125586253

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433950689336
                                         uncertainty =       0.002125586253

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465836611
  error estimate for blocks of size 2^( 2) =       0.000491426437
  error estimate for blocks of size 2^( 3) =       0.000516291547
  error estimate for blocks of size 2^( 4) =       0.000534954558
  error estimate for blocks of size 2^( 5) =       0.000545503108
  error estimate for blocks of size 2^( 6) =       0.000552208952
  error estimate for blocks of size 2^( 7) =       0.000557568107

      target function =      -0.749282528742
              le_mean =     -22.814085871452
             les_mean =     520.927791391164
             stat err =       0.000547558681
             autocorr =       1.381637470962
   target nu stat err =       0.000547558681
   target dn stat err =       0.002481470177
      target stat err =       0.002164925656
              std dev =       0.658792452697
             le_variance =       0.434007495730

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433950689336
                                         uncertainty =       0.002125586253

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433950689336
                                         uncertainty =       0.002125586253

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465836611
  error estimate for blocks of size 2^( 2) =       0.000491426437
  error estimate for blocks of size 2^( 3) =       0.000516291547
  error estimate for blocks of size 2^( 4) =       0.000534954558
  error estimate for blocks of size 2^( 5) =       0.000545503108
  error estimate for blocks of size 2^( 6) =       0.000552208952
  error estimate for blocks of size 2^( 7) =       0.000557568107

      target function =      -0.749282528742
              le_mean =     -22.814085871452
             les_mean =     520.927791391164
             stat err =       0.000547558681
             autocorr =       1.381637470962
   target nu stat err =       0.000547558681
   target dn stat err =       0.002481470177
      target stat err =       0.002164925656
              std dev =       0.658792452697
             le_variance =       0.434007495730


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.749282528742        initial  <--
     5.8208e+35     5.8208e+36             2.2930e-40        -0.749282528742
     2.3283e+36     2.3283e+37             5.8361e-41        -0.749282528742
     9.3132e+36     9.3132e+37             1.4590e-41        -0.749282528742

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.1957
  </log>
  <optVariables href="FORM2.s072.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3095e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s073 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s073 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=73  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2809e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 73
    time step          = 0.05
    reference energy   = -22.9022
    reference variance = 0.35596
====================================================
  Execution time = 2.5238e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s073
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5364e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4699e-01
  Total weights = 1.964859371e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5419e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436028802242
                                         uncertainty =       0.001732135792

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436028802242
                                         uncertainty =       0.001732135792

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466906322
  error estimate for blocks of size 2^( 2) =       0.000493139889
  error estimate for blocks of size 2^( 3) =       0.000517753276
  error estimate for blocks of size 2^( 4) =       0.000536477831
  error estimate for blocks of size 2^( 5) =       0.000548021763
  error estimate for blocks of size 2^( 6) =       0.000554652025
  error estimate for blocks of size 2^( 7) =       0.000557048116

      target function =      -0.747856596497
              le_mean =     -22.814693285733
             les_mean =     520.957217150420
             stat err =       0.000549049934
             autocorr =       1.382815306898
   target nu stat err =       0.000549049934
   target dn stat err =       0.002347409361
      target stat err =       0.002052418328
              std dev =       0.660305252572
             le_variance =       0.436003026574


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281469328573e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+36, overlap shift 5.8208e+37 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747861205678       residual = 2.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747861205678       residual = 2.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+36 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+37, overlap shift 2.3283e+38 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747861205678       residual = 2.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747861205678       residual = 2.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+37 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+37, overlap shift 9.3132e+38 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747861205678       residual = 2.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747861205678       residual = 2.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+37 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.121932 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9786e+01
  </log>
  <optVariables href="FORM2.s073.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 73
    time step          = 0.05
    reference energy   = -22.8281
    reference variance = 0.331713
====================================================
  Execution time = 2.4542e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s073
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4214e-01
  Total weights = 1.9645e+06
  Execution time = 3.4983e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431707755072
                                         uncertainty =       0.002039770577

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431707755072
                                         uncertainty =       0.002039770577

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464601210
  error estimate for blocks of size 2^( 2) =       0.000490282346
  error estimate for blocks of size 2^( 3) =       0.000514668383
  error estimate for blocks of size 2^( 4) =       0.000532787455
  error estimate for blocks of size 2^( 5) =       0.000544369978
  error estimate for blocks of size 2^( 6) =       0.000550266802
  error estimate for blocks of size 2^( 7) =       0.000553444763

      target function =      -0.751923943775
              le_mean =     -22.814368704812
             les_mean =     520.937554597577
             stat err =       0.000545217249
             autocorr =       1.377141295367
   target nu stat err =       0.000545217249
   target dn stat err =       0.002500050348
      target stat err =       0.002194829885
              std dev =       0.657045332631
             le_variance =       0.431708569132

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431707755072
                                         uncertainty =       0.002039770577

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431707755072
                                         uncertainty =       0.002039770577

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464601210
  error estimate for blocks of size 2^( 2) =       0.000490282346
  error estimate for blocks of size 2^( 3) =       0.000514668383
  error estimate for blocks of size 2^( 4) =       0.000532787455
  error estimate for blocks of size 2^( 5) =       0.000544369978
  error estimate for blocks of size 2^( 6) =       0.000550266802
  error estimate for blocks of size 2^( 7) =       0.000553444763

      target function =      -0.751923943775
              le_mean =     -22.814368704812
             les_mean =     520.937554597577
             stat err =       0.000545217249
             autocorr =       1.377141295366
   target nu stat err =       0.000545217249
   target dn stat err =       0.002500050348
      target stat err =       0.002194829885
              std dev =       0.657045332631
             le_variance =       0.431708569132

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431707755072
                                         uncertainty =       0.002039770577

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431707755072
                                         uncertainty =       0.002039770577

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464601210
  error estimate for blocks of size 2^( 2) =       0.000490282346
  error estimate for blocks of size 2^( 3) =       0.000514668383
  error estimate for blocks of size 2^( 4) =       0.000532787455
  error estimate for blocks of size 2^( 5) =       0.000544369978
  error estimate for blocks of size 2^( 6) =       0.000550266802
  error estimate for blocks of size 2^( 7) =       0.000553444763

      target function =      -0.751923943775
              le_mean =     -22.814368704812
             les_mean =     520.937554597577
             stat err =       0.000545217249
             autocorr =       1.377141295366
   target nu stat err =       0.000545217249
   target dn stat err =       0.002500050348
      target stat err =       0.002194829885
              std dev =       0.657045332631
             le_variance =       0.431708569132

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431707755072
                                         uncertainty =       0.002039770577

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.431707755072
                                         uncertainty =       0.002039770577

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000464601210
  error estimate for blocks of size 2^( 2) =       0.000490282346
  error estimate for blocks of size 2^( 3) =       0.000514668383
  error estimate for blocks of size 2^( 4) =       0.000532787455
  error estimate for blocks of size 2^( 5) =       0.000544369978
  error estimate for blocks of size 2^( 6) =       0.000550266802
  error estimate for blocks of size 2^( 7) =       0.000553444763

      target function =      -0.751923943775
              le_mean =     -22.814368704812
             les_mean =     520.937554597577
             stat err =       0.000545217249
             autocorr =       1.377141295366
   target nu stat err =       0.000545217249
   target dn stat err =       0.002500050348
      target stat err =       0.002194829885
              std dev =       0.657045332631
             le_variance =       0.431708569132


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.751923943775        initial  <--
     5.8208e+36     5.8208e+37             0.0000e+00        -0.751923943775
     2.3283e+37     2.3283e+38             0.0000e+00        -0.751923943775
     9.3132e+37     9.3132e+38             0.0000e+00        -0.751923943775

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.0473
  </log>
  <optVariables href="FORM2.s073.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.1839e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s074 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s074 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=74  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2810e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 74
    time step          = 0.05
    reference energy   = -22.8639
    reference variance = 0.295187
====================================================
  Execution time = 2.5290e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s074
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5381e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5072e-01
  Total weights = 1.964848825e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5567e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432770133379
                                         uncertainty =       0.002137885227

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432770133379
                                         uncertainty =       0.002137885227

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465152353
  error estimate for blocks of size 2^( 2) =       0.000491097628
  error estimate for blocks of size 2^( 3) =       0.000515649299
  error estimate for blocks of size 2^( 4) =       0.000533837309
  error estimate for blocks of size 2^( 5) =       0.000544980818
  error estimate for blocks of size 2^( 6) =       0.000552605931
  error estimate for blocks of size 2^( 7) =       0.000557038212

      target function =      -0.744718216745
              le_mean =     -22.814345670484
             les_mean =     520.945090942346
             stat err =       0.000547115568
             autocorr =       1.383463484359
   target nu stat err =       0.000547115568
   target dn stat err =       0.006619795209
      target stat err =       0.005508805854
              std dev =       0.657824765802
             le_variance =       0.432733422502


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281434567048e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+37, overlap shift 5.8208e+38 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744757790538       residual = 2.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744757790538       residual = 2.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+37 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+38, overlap shift 2.3283e+39 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744757790538       residual = 2.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744757790538       residual = 2.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+38 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+38, overlap shift 9.3132e+39 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744757790538       residual = 2.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744757790538       residual = 2.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+38 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.123056 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.4082e+01
  </log>
  <optVariables href="FORM2.s074.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 74
    time step          = 0.05
    reference energy   = -22.7697
    reference variance = 0.33978
====================================================
  Execution time = 2.4719e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s074
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4663e-01
  Total weights = 1.9647e+06
  Execution time = 3.5116e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435311016511
                                         uncertainty =       0.002090003700

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435311016511
                                         uncertainty =       0.002090003700

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466518557
  error estimate for blocks of size 2^( 2) =       0.000492288790
  error estimate for blocks of size 2^( 3) =       0.000516876025
  error estimate for blocks of size 2^( 4) =       0.000535558814
  error estimate for blocks of size 2^( 5) =       0.000547044881
  error estimate for blocks of size 2^( 6) =       0.000551751152
  error estimate for blocks of size 2^( 7) =       0.000557223777

      target function =      -0.748152566492
              le_mean =     -22.813864868197
             les_mean =     520.919057443799
             stat err =       0.000547894656
             autocorr =       1.379292203606
   target nu stat err =       0.000547894656
   target dn stat err =       0.002647897994
      target stat err =       0.002291536926
              std dev =       0.659756870724
             le_variance =       0.435279128468

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435311016511
                                         uncertainty =       0.002090003700

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435311016511
                                         uncertainty =       0.002090003700

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466518557
  error estimate for blocks of size 2^( 2) =       0.000492288790
  error estimate for blocks of size 2^( 3) =       0.000516876025
  error estimate for blocks of size 2^( 4) =       0.000535558814
  error estimate for blocks of size 2^( 5) =       0.000547044881
  error estimate for blocks of size 2^( 6) =       0.000551751152
  error estimate for blocks of size 2^( 7) =       0.000557223777

      target function =      -0.748152566492
              le_mean =     -22.813864868197
             les_mean =     520.919057443799
             stat err =       0.000547894656
             autocorr =       1.379292203606
   target nu stat err =       0.000547894656
   target dn stat err =       0.002647897994
      target stat err =       0.002291536926
              std dev =       0.659756870724
             le_variance =       0.435279128468

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435311016511
                                         uncertainty =       0.002090003700

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435311016511
                                         uncertainty =       0.002090003700

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466518557
  error estimate for blocks of size 2^( 2) =       0.000492288790
  error estimate for blocks of size 2^( 3) =       0.000516876025
  error estimate for blocks of size 2^( 4) =       0.000535558814
  error estimate for blocks of size 2^( 5) =       0.000547044881
  error estimate for blocks of size 2^( 6) =       0.000551751152
  error estimate for blocks of size 2^( 7) =       0.000557223777

      target function =      -0.748152566492
              le_mean =     -22.813864868197
             les_mean =     520.919057443799
             stat err =       0.000547894656
             autocorr =       1.379292203606
   target nu stat err =       0.000547894656
   target dn stat err =       0.002647897994
      target stat err =       0.002291536926
              std dev =       0.659756870724
             le_variance =       0.435279128468

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435311016511
                                         uncertainty =       0.002090003700

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435311016511
                                         uncertainty =       0.002090003700

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466518557
  error estimate for blocks of size 2^( 2) =       0.000492288790
  error estimate for blocks of size 2^( 3) =       0.000516876025
  error estimate for blocks of size 2^( 4) =       0.000535558814
  error estimate for blocks of size 2^( 5) =       0.000547044881
  error estimate for blocks of size 2^( 6) =       0.000551751152
  error estimate for blocks of size 2^( 7) =       0.000557223777

      target function =      -0.748152566492
              le_mean =     -22.813864868197
             les_mean =     520.919057443799
             stat err =       0.000547894656
             autocorr =       1.379292203606
   target nu stat err =       0.000547894656
   target dn stat err =       0.002647897994
      target stat err =       0.002291536926
              std dev =       0.659756870724
             le_variance =       0.435279128468


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748152566492        initial  <--
     5.8208e+37     5.8208e+38             0.0000e+00        -0.748152566492
     2.3283e+38     2.3283e+39             0.0000e+00        -0.748152566492
     9.3132e+38     9.3132e+39             0.0000e+00        -0.748152566492

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.3459
  </log>
  <optVariables href="FORM2.s074.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6433e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s075 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s075 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=75  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2810e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 75
    time step          = 0.05
    reference energy   = -22.8434
    reference variance = 0.308096
====================================================
  Execution time = 2.5284e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s075
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5320e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4651e-01
  Total weights = 1.964835084e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5197e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435573448294
                                         uncertainty =       0.002540599731

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435573448294
                                         uncertainty =       0.002540599731

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466613617
  error estimate for blocks of size 2^( 2) =       0.000492702239
  error estimate for blocks of size 2^( 3) =       0.000516932872
  error estimate for blocks of size 2^( 4) =       0.000534722233
  error estimate for blocks of size 2^( 5) =       0.000547724607
  error estimate for blocks of size 2^( 6) =       0.000553502350
  error estimate for blocks of size 2^( 7) =       0.000558383536

      target function =      -0.748253885409
              le_mean =     -22.814398538113
             les_mean =     520.943288012744
             stat err =       0.000548583182
             autocorr =       1.382197684165
   target nu stat err =       0.000548583182
   target dn stat err =       0.002849510244
      target stat err =       0.002456819650
              std dev =       0.659891305430
             le_variance =       0.435456534982


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281439853811e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+38, overlap shift 5.8208e+39 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748260963160       residual = 1.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748260963160       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748260963708       residual = 1.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+38 is 2.701515e-43

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+39, overlap shift 2.3283e+40 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748260963160       residual = 1.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748260963160       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748260963160       residual = 8.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748260498047       residual = 8.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+39 is 7.952090e-44

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+39, overlap shift 9.3132e+40 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748260963160       residual = 1.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748260963160       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748260963160       residual = 8.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748260498047       residual = 9.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+39 is 1.988022e-44

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.124670 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9810e+01
  </log>
  <optVariables href="FORM2.s075.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 75
    time step          = 0.05
    reference energy   = -22.7828
    reference variance = 0.296428
====================================================
  Execution time = 2.4428e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s075
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5494e-01
  Total weights = 1.9649e+06
  Execution time = 3.5096e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442033145994
                                         uncertainty =       0.003714040741

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442033145994
                                         uncertainty =       0.003714040741

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470143431
  error estimate for blocks of size 2^( 2) =       0.000496245591
  error estimate for blocks of size 2^( 3) =       0.000520716868
  error estimate for blocks of size 2^( 4) =       0.000539956916
  error estimate for blocks of size 2^( 5) =       0.000551329474
  error estimate for blocks of size 2^( 6) =       0.000556827760
  error estimate for blocks of size 2^( 7) =       0.000559154401

      target function =      -0.741275673754
              le_mean =     -22.813816451152
             les_mean =     520.925159138390
             stat err =       0.000551817138
             autocorr =       1.377620587905
   target nu stat err =       0.000551817138
   target dn stat err =       0.004126553791
      target stat err =       0.003433324249
              std dev =       0.664883215946
             le_variance =       0.442069690846

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442033145994
                                         uncertainty =       0.003714040741

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442033145994
                                         uncertainty =       0.003714040741

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470143431
  error estimate for blocks of size 2^( 2) =       0.000496245591
  error estimate for blocks of size 2^( 3) =       0.000520716868
  error estimate for blocks of size 2^( 4) =       0.000539956916
  error estimate for blocks of size 2^( 5) =       0.000551329474
  error estimate for blocks of size 2^( 6) =       0.000556827760
  error estimate for blocks of size 2^( 7) =       0.000559154401

      target function =      -0.741275673754
              le_mean =     -22.813816451152
             les_mean =     520.925159138390
             stat err =       0.000551817138
             autocorr =       1.377620587905
   target nu stat err =       0.000551817138
   target dn stat err =       0.004126553791
      target stat err =       0.003433324249
              std dev =       0.664883215946
             le_variance =       0.442069690846

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442033145994
                                         uncertainty =       0.003714040741

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442033145994
                                         uncertainty =       0.003714040741

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470143431
  error estimate for blocks of size 2^( 2) =       0.000496245591
  error estimate for blocks of size 2^( 3) =       0.000520716868
  error estimate for blocks of size 2^( 4) =       0.000539956916
  error estimate for blocks of size 2^( 5) =       0.000551329474
  error estimate for blocks of size 2^( 6) =       0.000556827760
  error estimate for blocks of size 2^( 7) =       0.000559154401

      target function =      -0.741275673754
              le_mean =     -22.813816451152
             les_mean =     520.925159138390
             stat err =       0.000551817138
             autocorr =       1.377620587905
   target nu stat err =       0.000551817138
   target dn stat err =       0.004126553791
      target stat err =       0.003433324249
              std dev =       0.664883215946
             le_variance =       0.442069690846

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442033145994
                                         uncertainty =       0.003714040741

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442033145994
                                         uncertainty =       0.003714040741

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470143431
  error estimate for blocks of size 2^( 2) =       0.000496245591
  error estimate for blocks of size 2^( 3) =       0.000520716868
  error estimate for blocks of size 2^( 4) =       0.000539956916
  error estimate for blocks of size 2^( 5) =       0.000551329474
  error estimate for blocks of size 2^( 6) =       0.000556827760
  error estimate for blocks of size 2^( 7) =       0.000559154401

      target function =      -0.741275673754
              le_mean =     -22.813816451152
             les_mean =     520.925159138390
             stat err =       0.000551817138
             autocorr =       1.377620587905
   target nu stat err =       0.000551817138
   target dn stat err =       0.004126553791
      target stat err =       0.003433324249
              std dev =       0.664883215946
             le_variance =       0.442069690846


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.741275673754        initial  <--
     5.8208e+38     5.8208e+39             2.7015e-43        -0.741275673754
     2.3283e+39     2.3283e+40             7.9521e-44        -0.741275673754
     9.3132e+39     9.3132e+40             1.9880e-44        -0.741275673754

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.0025
  </log>
  <optVariables href="FORM2.s075.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.1819e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s076 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s076 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=76  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2810e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 76
    time step          = 0.05
    reference energy   = -22.9284
    reference variance = 0.685015
====================================================
  Execution time = 2.5217e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s076
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5344e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4831e-01
  Total weights = 1.964864361e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4975e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436189254760
                                         uncertainty =       0.001975034778

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436189254760
                                         uncertainty =       0.001975034778

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467013736
  error estimate for blocks of size 2^( 2) =       0.000492767522
  error estimate for blocks of size 2^( 3) =       0.000517072042
  error estimate for blocks of size 2^( 4) =       0.000535628982
  error estimate for blocks of size 2^( 5) =       0.000549201734
  error estimate for blocks of size 2^( 6) =       0.000555576739
  error estimate for blocks of size 2^( 7) =       0.000561726068

      target function =      -0.746754100724
              le_mean =     -22.814179704482
             les_mean =     520.935104970663
             stat err =       0.000550533381
             autocorr =       1.389658233245
   target nu stat err =       0.000550533381
   target dn stat err =       0.002387415122
      target stat err =       0.002077324106
              std dev =       0.660457159393
             le_variance =       0.436203659394


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281417970448e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+39, overlap shift 5.8208e+40 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746758891939       residual = 2.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746758891939       residual = 2.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+39 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+40, overlap shift 2.3283e+41 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746758891939       residual = 2.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746758891939       residual = 2.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+40 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+40, overlap shift 9.3132e+41 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746758891939       residual = 2.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746758891939       residual = 2.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+40 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.125791 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9721e+01
  </log>
  <optVariables href="FORM2.s076.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 76
    time step          = 0.05
    reference energy   = -22.7778
    reference variance = 0.299685
====================================================
  Execution time = 2.6540e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s076
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5263e-01
  Total weights = 1.9647e+06
  Execution time = 3.5052e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439720985016
                                         uncertainty =       0.002028972187

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439720985016
                                         uncertainty =       0.002028972187

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468980831
  error estimate for blocks of size 2^( 2) =       0.000494227436
  error estimate for blocks of size 2^( 3) =       0.000518583150
  error estimate for blocks of size 2^( 4) =       0.000536640013
  error estimate for blocks of size 2^( 5) =       0.000548882720
  error estimate for blocks of size 2^( 6) =       0.000556270301
  error estimate for blocks of size 2^( 7) =       0.000559543364

      target function =      -0.743178032041
              le_mean =     -22.814429162897
             les_mean =     520.950805318550
             stat err =       0.000550334099
             autocorr =       1.377027652709
   target nu stat err =       0.000550334099
   target dn stat err =       0.002918242577
      target stat err =       0.002480069175
              std dev =       0.663239052328
             le_variance =       0.439886040533

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439720985016
                                         uncertainty =       0.002028972187

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439720985016
                                         uncertainty =       0.002028972187

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468980831
  error estimate for blocks of size 2^( 2) =       0.000494227436
  error estimate for blocks of size 2^( 3) =       0.000518583150
  error estimate for blocks of size 2^( 4) =       0.000536640013
  error estimate for blocks of size 2^( 5) =       0.000548882720
  error estimate for blocks of size 2^( 6) =       0.000556270301
  error estimate for blocks of size 2^( 7) =       0.000559543364

      target function =      -0.743178032041
              le_mean =     -22.814429162897
             les_mean =     520.950805318550
             stat err =       0.000550334099
             autocorr =       1.377027652703
   target nu stat err =       0.000550334099
   target dn stat err =       0.002918242577
      target stat err =       0.002480069175
              std dev =       0.663239052328
             le_variance =       0.439886040533

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439720985016
                                         uncertainty =       0.002028972187

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439720985016
                                         uncertainty =       0.002028972187

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468980831
  error estimate for blocks of size 2^( 2) =       0.000494227436
  error estimate for blocks of size 2^( 3) =       0.000518583150
  error estimate for blocks of size 2^( 4) =       0.000536640013
  error estimate for blocks of size 2^( 5) =       0.000548882720
  error estimate for blocks of size 2^( 6) =       0.000556270301
  error estimate for blocks of size 2^( 7) =       0.000559543364

      target function =      -0.743178032041
              le_mean =     -22.814429162897
             les_mean =     520.950805318550
             stat err =       0.000550334099
             autocorr =       1.377027652703
   target nu stat err =       0.000550334099
   target dn stat err =       0.002918242577
      target stat err =       0.002480069175
              std dev =       0.663239052328
             le_variance =       0.439886040533

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439720985016
                                         uncertainty =       0.002028972187

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439720985016
                                         uncertainty =       0.002028972187

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468980831
  error estimate for blocks of size 2^( 2) =       0.000494227436
  error estimate for blocks of size 2^( 3) =       0.000518583150
  error estimate for blocks of size 2^( 4) =       0.000536640013
  error estimate for blocks of size 2^( 5) =       0.000548882720
  error estimate for blocks of size 2^( 6) =       0.000556270301
  error estimate for blocks of size 2^( 7) =       0.000559543364

      target function =      -0.743178032041
              le_mean =     -22.814429162897
             les_mean =     520.950805318550
             stat err =       0.000550334099
             autocorr =       1.377027652703
   target nu stat err =       0.000550334099
   target dn stat err =       0.002918242577
      target stat err =       0.002480069175
              std dev =       0.663239052328
             le_variance =       0.439886040533


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743178032041        initial  <--
     5.8208e+39     5.8208e+40             0.0000e+00        -0.743178032041
     2.3283e+40     2.3283e+41             0.0000e+00        -0.743178032041
     9.3132e+40     9.3132e+41             0.0000e+00        -0.743178032041

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.0568
  </log>
  <optVariables href="FORM2.s076.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3829e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s077 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s077 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=77  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2810e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 77
    time step          = 0.05
    reference energy   = -22.8601
    reference variance = 0.344337
====================================================
  Execution time = 2.5421e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s077
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5335e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4602e-01
  Total weights = 1.964728946e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5216e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432817222034
                                         uncertainty =       0.002044366446

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.432817222034
                                         uncertainty =       0.002044366446

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465187601
  error estimate for blocks of size 2^( 2) =       0.000491127987
  error estimate for blocks of size 2^( 3) =       0.000515971376
  error estimate for blocks of size 2^( 4) =       0.000534517192
  error estimate for blocks of size 2^( 5) =       0.000546072255
  error estimate for blocks of size 2^( 6) =       0.000553993425
  error estimate for blocks of size 2^( 7) =       0.000555299611

      target function =      -0.748655028930
              le_mean =     -22.814016888689
             les_mean =     520.925391512427
             stat err =       0.000547470621
             autocorr =       1.385049758044
   target nu stat err =       0.000547470621
   target dn stat err =       0.002866561709
      target stat err =       0.002471465628
              std dev =       0.657874614214
             le_variance =       0.432799008027


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281401688869e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+40, overlap shift 5.8208e+41 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748662193813       residual = 2.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748662193813       residual = 2.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+40 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+41, overlap shift 2.3283e+42 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748662193813       residual = 2.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748662193813       residual = 2.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+41 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+41, overlap shift 9.3132e+42 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748662193813       residual = 2.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748662193813       residual = 2.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+41 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.126915 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9949e+01
  </log>
  <optVariables href="FORM2.s077.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 77
    time step          = 0.05
    reference energy   = -22.8407
    reference variance = 0.343259
====================================================
  Execution time = 2.4653e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s077
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2813e+01
  VMC Evar = 4.4917e-01
  Total weights = 1.9650e+06
  Execution time = 3.5259e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436782064296
                                         uncertainty =       0.002037445693

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436782064296
                                         uncertainty =       0.002037445693

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467284091
  error estimate for blocks of size 2^( 2) =       0.000492817111
  error estimate for blocks of size 2^( 3) =       0.000517639787
  error estimate for blocks of size 2^( 4) =       0.000535960257
  error estimate for blocks of size 2^( 5) =       0.000547673638
  error estimate for blocks of size 2^( 6) =       0.000554289449
  error estimate for blocks of size 2^( 7) =       0.000558295697

      target function =      -0.746035488570
              le_mean =     -22.813032125024
             les_mean =     520.883604313350
             stat err =       0.000549054760
             autocorr =       1.380604647330
   target nu stat err =       0.000549054760
   target dn stat err =       0.002816284156
      target stat err =       0.002411248417
              std dev =       0.660839499597
             le_variance =       0.436708844227

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436782064296
                                         uncertainty =       0.002037445693

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436782064296
                                         uncertainty =       0.002037445693

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467284091
  error estimate for blocks of size 2^( 2) =       0.000492817111
  error estimate for blocks of size 2^( 3) =       0.000517639787
  error estimate for blocks of size 2^( 4) =       0.000535960257
  error estimate for blocks of size 2^( 5) =       0.000547673638
  error estimate for blocks of size 2^( 6) =       0.000554289449
  error estimate for blocks of size 2^( 7) =       0.000558295697

      target function =      -0.746035488570
              le_mean =     -22.813032125024
             les_mean =     520.883604313350
             stat err =       0.000549054760
             autocorr =       1.380604647330
   target nu stat err =       0.000549054760
   target dn stat err =       0.002816284156
      target stat err =       0.002411248417
              std dev =       0.660839499597
             le_variance =       0.436708844227

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436782064296
                                         uncertainty =       0.002037445693

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436782064296
                                         uncertainty =       0.002037445693

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467284091
  error estimate for blocks of size 2^( 2) =       0.000492817111
  error estimate for blocks of size 2^( 3) =       0.000517639787
  error estimate for blocks of size 2^( 4) =       0.000535960257
  error estimate for blocks of size 2^( 5) =       0.000547673638
  error estimate for blocks of size 2^( 6) =       0.000554289449
  error estimate for blocks of size 2^( 7) =       0.000558295697

      target function =      -0.746035488570
              le_mean =     -22.813032125024
             les_mean =     520.883604313350
             stat err =       0.000549054760
             autocorr =       1.380604647330
   target nu stat err =       0.000549054760
   target dn stat err =       0.002816284156
      target stat err =       0.002411248417
              std dev =       0.660839499597
             le_variance =       0.436708844227

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436782064296
                                         uncertainty =       0.002037445693

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436782064296
                                         uncertainty =       0.002037445693

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467284091
  error estimate for blocks of size 2^( 2) =       0.000492817111
  error estimate for blocks of size 2^( 3) =       0.000517639787
  error estimate for blocks of size 2^( 4) =       0.000535960257
  error estimate for blocks of size 2^( 5) =       0.000547673638
  error estimate for blocks of size 2^( 6) =       0.000554289449
  error estimate for blocks of size 2^( 7) =       0.000558295697

      target function =      -0.746035488570
              le_mean =     -22.813032125024
             les_mean =     520.883604313350
             stat err =       0.000549054760
             autocorr =       1.380604647330
   target nu stat err =       0.000549054760
   target dn stat err =       0.002816284156
      target stat err =       0.002411248417
              std dev =       0.660839499597
             le_variance =       0.436708844227


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746035488570        initial  <--
     5.8208e+40     5.8208e+41             0.0000e+00        -0.746035488570
     2.3283e+41     2.3283e+42             0.0000e+00        -0.746035488570
     9.3132e+41     9.3132e+42             0.0000e+00        -0.746035488570

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.2057
  </log>
  <optVariables href="FORM2.s077.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2161e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s078 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s078 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=78  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2811e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 78
    time step          = 0.05
    reference energy   = -22.7469
    reference variance = 0.424388
====================================================
  Execution time = 2.5041e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s078
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5354e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4843e-01
  Total weights = 1.965004292e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5034e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436379930418
                                         uncertainty =       0.001944691954

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436379930418
                                         uncertainty =       0.001944691954

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467098778
  error estimate for blocks of size 2^( 2) =       0.000492583851
  error estimate for blocks of size 2^( 3) =       0.000516585297
  error estimate for blocks of size 2^( 4) =       0.000534522920
  error estimate for blocks of size 2^( 5) =       0.000546199011
  error estimate for blocks of size 2^( 6) =       0.000554532459
  error estimate for blocks of size 2^( 7) =       0.000560145027

      target function =      -0.746650183523
              le_mean =     -22.813711410566
             les_mean =     520.913860819537
             stat err =       0.000548849854
             autocorr =       1.380669227254
   target nu stat err =       0.000548849854
   target dn stat err =       0.002513048134
      target stat err =       0.002174715182
              std dev =       0.660577426185
             le_variance =       0.436362535985


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281371141057e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+41, overlap shift 5.8208e+42 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746655517280       residual = 2.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746655517280       residual = 3.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746655517280       residual = 2.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+41 is 3.227251e-46

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+42, overlap shift 2.3283e+43 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746655517280       residual = 2.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746655517280       residual = 3.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746655464172       residual = 2.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+42 is 8.068128e-47

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+42, overlap shift 9.3132e+43 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746655517280       residual = 2.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746655517280       residual = 3.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746655517280       residual = 2.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+42 is 2.017032e-47

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.128309 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9551e+01
  </log>
  <optVariables href="FORM2.s078.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 78
    time step          = 0.05
    reference energy   = -22.7414
    reference variance = 0.604077
====================================================
  Execution time = 2.6707e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s078
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5241e-01
  Total weights = 1.9645e+06
  Execution time = 3.5020e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438202966360
                                         uncertainty =       0.002277834471

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438202966360
                                         uncertainty =       0.002277834471

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468058492
  error estimate for blocks of size 2^( 2) =       0.000493606017
  error estimate for blocks of size 2^( 3) =       0.000518982602
  error estimate for blocks of size 2^( 4) =       0.000537401008
  error estimate for blocks of size 2^( 5) =       0.000547931202
  error estimate for blocks of size 2^( 6) =       0.000553294793
  error estimate for blocks of size 2^( 7) =       0.000556761685

      target function =      -0.743359791211
              le_mean =     -22.813811591534
             les_mean =     520.922405106136
             stat err =       0.000548847172
             autocorr =       1.374999699165
   target nu stat err =       0.000548847172
   target dn stat err =       0.003394034498
      target stat err =       0.002859976707
              std dev =       0.661934667496
             le_variance =       0.438157504033

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438202966360
                                         uncertainty =       0.002277834471

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438202966360
                                         uncertainty =       0.002277834471

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468058492
  error estimate for blocks of size 2^( 2) =       0.000493606017
  error estimate for blocks of size 2^( 3) =       0.000518982602
  error estimate for blocks of size 2^( 4) =       0.000537401008
  error estimate for blocks of size 2^( 5) =       0.000547931202
  error estimate for blocks of size 2^( 6) =       0.000553294793
  error estimate for blocks of size 2^( 7) =       0.000556761685

      target function =      -0.743359791211
              le_mean =     -22.813811591534
             les_mean =     520.922405106136
             stat err =       0.000548847172
             autocorr =       1.374999699165
   target nu stat err =       0.000548847172
   target dn stat err =       0.003394034498
      target stat err =       0.002859976707
              std dev =       0.661934667496
             le_variance =       0.438157504033

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438202966360
                                         uncertainty =       0.002277834471

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438202966360
                                         uncertainty =       0.002277834471

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468058492
  error estimate for blocks of size 2^( 2) =       0.000493606017
  error estimate for blocks of size 2^( 3) =       0.000518982602
  error estimate for blocks of size 2^( 4) =       0.000537401008
  error estimate for blocks of size 2^( 5) =       0.000547931202
  error estimate for blocks of size 2^( 6) =       0.000553294793
  error estimate for blocks of size 2^( 7) =       0.000556761685

      target function =      -0.743359791211
              le_mean =     -22.813811591534
             les_mean =     520.922405106136
             stat err =       0.000548847172
             autocorr =       1.374999699165
   target nu stat err =       0.000548847172
   target dn stat err =       0.003394034498
      target stat err =       0.002859976707
              std dev =       0.661934667496
             le_variance =       0.438157504033

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438202966360
                                         uncertainty =       0.002277834471

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438202966360
                                         uncertainty =       0.002277834471

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468058492
  error estimate for blocks of size 2^( 2) =       0.000493606017
  error estimate for blocks of size 2^( 3) =       0.000518982602
  error estimate for blocks of size 2^( 4) =       0.000537401008
  error estimate for blocks of size 2^( 5) =       0.000547931202
  error estimate for blocks of size 2^( 6) =       0.000553294793
  error estimate for blocks of size 2^( 7) =       0.000556761685

      target function =      -0.743359791211
              le_mean =     -22.813811591534
             les_mean =     520.922405106136
             stat err =       0.000548847172
             autocorr =       1.374999699165
   target nu stat err =       0.000548847172
   target dn stat err =       0.003394034498
      target stat err =       0.002859976707
              std dev =       0.661934667496
             le_variance =       0.438157504033


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743359791211        initial  <--
     5.8208e+41     5.8208e+42             3.2273e-46        -0.743359791211
     2.3283e+42     2.3283e+43             8.0681e-47        -0.743359791211
     9.3132e+42     9.3132e+43             2.0170e-47        -0.743359791211

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.2692
  </log>
  <optVariables href="FORM2.s078.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3827e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s079 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s079 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=79  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2810e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 79
    time step          = 0.05
    reference energy   = -22.7508
    reference variance = 0.799134
====================================================
  Execution time = 2.5114e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s079
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5322e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4877e-01
  Total weights = 1.964565554e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5261e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435984571339
                                         uncertainty =       0.001945228404

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435984571339
                                         uncertainty =       0.001945228404

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466907917
  error estimate for blocks of size 2^( 2) =       0.000492533484
  error estimate for blocks of size 2^( 3) =       0.000517251518
  error estimate for blocks of size 2^( 4) =       0.000535590181
  error estimate for blocks of size 2^( 5) =       0.000547443408
  error estimate for blocks of size 2^( 6) =       0.000554168432
  error estimate for blocks of size 2^( 7) =       0.000558218249

      target function =      -0.746368752208
              le_mean =     -22.813754299596
             les_mean =     520.916155793468
             stat err =       0.000548855068
             autocorr =       1.381824478527
   target nu stat err =       0.000548855068
   target dn stat err =       0.002703656721
      target stat err =       0.002325545141
              std dev =       0.660307508186
             le_variance =       0.436006005367


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281375429960e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+42, overlap shift 5.8208e+43 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746374933919       residual = 1.96e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746374933919       residual = 1.96e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+42 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+43, overlap shift 2.3283e+44 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746374933919       residual = 1.96e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746374933919       residual = 1.96e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+43 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+43, overlap shift 9.3132e+44 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746374933919       residual = 1.96e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746374933919       residual = 1.96e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+43 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.129450 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9647e+01
  </log>
  <optVariables href="FORM2.s079.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 79
    time step          = 0.05
    reference energy   = -22.9107
    reference variance = 0.391854
====================================================
  Execution time = 2.4475e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s079
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4977e-01
  Total weights = 1.9647e+06
  Execution time = 3.5030e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433963591090
                                         uncertainty =       0.001800933977

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433963591090
                                         uncertainty =       0.001800933977

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465787728
  error estimate for blocks of size 2^( 2) =       0.000491559933
  error estimate for blocks of size 2^( 3) =       0.000515566320
  error estimate for blocks of size 2^( 4) =       0.000534412510
  error estimate for blocks of size 2^( 5) =       0.000546000367
  error estimate for blocks of size 2^( 6) =       0.000551620188
  error estimate for blocks of size 2^( 7) =       0.000554695653

      target function =      -0.745534082149
              le_mean =     -22.814319190318
             les_mean =     520.942932750360
             stat err =       0.000546682179
             autocorr =       1.377506794289
   target nu stat err =       0.000546682179
   target dn stat err =       0.003430104748
      target stat err =       0.002907251571
              std dev =       0.658723322381
             le_variance =       0.433916415449

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433963591090
                                         uncertainty =       0.001800933977

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433963591090
                                         uncertainty =       0.001800933977

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465787728
  error estimate for blocks of size 2^( 2) =       0.000491559933
  error estimate for blocks of size 2^( 3) =       0.000515566320
  error estimate for blocks of size 2^( 4) =       0.000534412510
  error estimate for blocks of size 2^( 5) =       0.000546000367
  error estimate for blocks of size 2^( 6) =       0.000551620188
  error estimate for blocks of size 2^( 7) =       0.000554695653

      target function =      -0.745534082149
              le_mean =     -22.814319190318
             les_mean =     520.942932750360
             stat err =       0.000546682179
             autocorr =       1.377506794289
   target nu stat err =       0.000546682179
   target dn stat err =       0.003430104748
      target stat err =       0.002907251571
              std dev =       0.658723322381
             le_variance =       0.433916415449

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433963591090
                                         uncertainty =       0.001800933977

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433963591090
                                         uncertainty =       0.001800933977

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465787728
  error estimate for blocks of size 2^( 2) =       0.000491559933
  error estimate for blocks of size 2^( 3) =       0.000515566320
  error estimate for blocks of size 2^( 4) =       0.000534412510
  error estimate for blocks of size 2^( 5) =       0.000546000367
  error estimate for blocks of size 2^( 6) =       0.000551620188
  error estimate for blocks of size 2^( 7) =       0.000554695653

      target function =      -0.745534082149
              le_mean =     -22.814319190318
             les_mean =     520.942932750360
             stat err =       0.000546682179
             autocorr =       1.377506794289
   target nu stat err =       0.000546682179
   target dn stat err =       0.003430104748
      target stat err =       0.002907251571
              std dev =       0.658723322381
             le_variance =       0.433916415449

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433963591090
                                         uncertainty =       0.001800933977

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433963591090
                                         uncertainty =       0.001800933977

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465787728
  error estimate for blocks of size 2^( 2) =       0.000491559933
  error estimate for blocks of size 2^( 3) =       0.000515566320
  error estimate for blocks of size 2^( 4) =       0.000534412510
  error estimate for blocks of size 2^( 5) =       0.000546000367
  error estimate for blocks of size 2^( 6) =       0.000551620188
  error estimate for blocks of size 2^( 7) =       0.000554695653

      target function =      -0.745534082149
              le_mean =     -22.814319190318
             les_mean =     520.942932750360
             stat err =       0.000546682179
             autocorr =       1.377506794289
   target nu stat err =       0.000546682179
   target dn stat err =       0.003430104748
      target stat err =       0.002907251571
              std dev =       0.658723322381
             le_variance =       0.433916415449


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745534082149        initial  <--
     5.8208e+42     5.8208e+43             0.0000e+00        -0.745534082149
     2.3283e+43     2.3283e+44             0.0000e+00        -0.745534082149
     9.3132e+43     9.3132e+44             0.0000e+00        -0.745534082149

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.0036
  </log>
  <optVariables href="FORM2.s079.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.1999e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s080 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s080 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=80  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2810e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 80
    time step          = 0.05
    reference energy   = -22.8971
    reference variance = 0.323063
====================================================
  Execution time = 2.5160e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s080
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5371e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5153e-01
  Total weights = 1.964571808e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5202e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438977833391
                                         uncertainty =       0.003682683250

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438977833391
                                         uncertainty =       0.003682683250

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468540405
  error estimate for blocks of size 2^( 2) =       0.000493468159
  error estimate for blocks of size 2^( 3) =       0.000516790604
  error estimate for blocks of size 2^( 4) =       0.000535460847
  error estimate for blocks of size 2^( 5) =       0.000547951069
  error estimate for blocks of size 2^( 6) =       0.000553528086
  error estimate for blocks of size 2^( 7) =       0.000556606945

      target function =      -0.744074987939
              le_mean =     -22.815032480753
             les_mean =     520.977234238492
             stat err =       0.000548386737
             autocorr =       1.369871367590
   target nu stat err =       0.000548386737
   target dn stat err =       0.004255090884
      target stat err =       0.003569135008
              std dev =       0.662616194852
             le_variance =       0.439060221680


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281503248075e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+43, overlap shift 5.8208e+44 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744090942582       residual = 1.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744090942582       residual = 3.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744140625000       residual = 1.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+43 is 2.094354e-48

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+44, overlap shift 2.3283e+45 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744090942582       residual = 1.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744090942582       residual = 3.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742187500000       residual = 1.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+44 is 5.235886e-49

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+44, overlap shift 9.3132e+45 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744090942582       residual = 1.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744090942582       residual = 3.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742187500000       residual = 1.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+44 is 1.308971e-49

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.130856 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9688e+01
  </log>
  <optVariables href="FORM2.s080.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 80
    time step          = 0.05
    reference energy   = -22.7723
    reference variance = 0.428618
====================================================
  Execution time = 2.6721e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s080
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5128e-01
  Total weights = 1.9650e+06
  Execution time = 3.5027e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438576268743
                                         uncertainty =       0.002207292250

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438576268743
                                         uncertainty =       0.002207292250

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468314919
  error estimate for blocks of size 2^( 2) =       0.000493637521
  error estimate for blocks of size 2^( 3) =       0.000518039563
  error estimate for blocks of size 2^( 4) =       0.000535643558
  error estimate for blocks of size 2^( 5) =       0.000547430106
  error estimate for blocks of size 2^( 6) =       0.000553426005
  error estimate for blocks of size 2^( 7) =       0.000557218510

      target function =      -0.744288252713
              le_mean =     -22.814322669686
             les_mean =     520.944600836655
             stat err =       0.000548429545
             autocorr =       1.371404910089
   target nu stat err =       0.000548429545
   target dn stat err =       0.002883193623
      target stat err =       0.002458284676
              std dev =       0.662297309531
             le_variance =       0.438637726212

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438576268743
                                         uncertainty =       0.002207292250

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438576268743
                                         uncertainty =       0.002207292250

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468314919
  error estimate for blocks of size 2^( 2) =       0.000493637521
  error estimate for blocks of size 2^( 3) =       0.000518039563
  error estimate for blocks of size 2^( 4) =       0.000535643558
  error estimate for blocks of size 2^( 5) =       0.000547430106
  error estimate for blocks of size 2^( 6) =       0.000553426005
  error estimate for blocks of size 2^( 7) =       0.000557218510

      target function =      -0.744288252713
              le_mean =     -22.814322669686
             les_mean =     520.944600836655
             stat err =       0.000548429545
             autocorr =       1.371404910089
   target nu stat err =       0.000548429545
   target dn stat err =       0.002883193623
      target stat err =       0.002458284676
              std dev =       0.662297309531
             le_variance =       0.438637726212

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438576268743
                                         uncertainty =       0.002207292250

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438576268743
                                         uncertainty =       0.002207292250

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468314919
  error estimate for blocks of size 2^( 2) =       0.000493637521
  error estimate for blocks of size 2^( 3) =       0.000518039563
  error estimate for blocks of size 2^( 4) =       0.000535643558
  error estimate for blocks of size 2^( 5) =       0.000547430106
  error estimate for blocks of size 2^( 6) =       0.000553426005
  error estimate for blocks of size 2^( 7) =       0.000557218510

      target function =      -0.744288252713
              le_mean =     -22.814322669686
             les_mean =     520.944600836655
             stat err =       0.000548429545
             autocorr =       1.371404910089
   target nu stat err =       0.000548429545
   target dn stat err =       0.002883193623
      target stat err =       0.002458284676
              std dev =       0.662297309531
             le_variance =       0.438637726212

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438576268743
                                         uncertainty =       0.002207292250

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438576268743
                                         uncertainty =       0.002207292250

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468314919
  error estimate for blocks of size 2^( 2) =       0.000493637521
  error estimate for blocks of size 2^( 3) =       0.000518039563
  error estimate for blocks of size 2^( 4) =       0.000535643558
  error estimate for blocks of size 2^( 5) =       0.000547430106
  error estimate for blocks of size 2^( 6) =       0.000553426005
  error estimate for blocks of size 2^( 7) =       0.000557218510

      target function =      -0.744288252713
              le_mean =     -22.814322669686
             les_mean =     520.944600836655
             stat err =       0.000548429545
             autocorr =       1.371404910089
   target nu stat err =       0.000548429545
   target dn stat err =       0.002883193623
      target stat err =       0.002458284676
              std dev =       0.662297309531
             le_variance =       0.438637726212


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744288252713        initial  <--
     5.8208e+43     5.8208e+44             2.0944e-48        -0.744288252713
     2.3283e+44     2.3283e+45             5.2359e-49        -0.744288252713
     9.3132e+44     9.3132e+45             1.3090e-49        -0.744288252713

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.2427
  </log>
  <optVariables href="FORM2.s080.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3937e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s081 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s081 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=81  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2811e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 81
    time step          = 0.05
    reference energy   = -22.8249
    reference variance = 0.548746
====================================================
  Execution time = 2.5446e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s081
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5362e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5091e-01
  Total weights = 1.964955208e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4786e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436088040283
                                         uncertainty =       0.002555772580

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436088040283
                                         uncertainty =       0.002555772580

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466940542
  error estimate for blocks of size 2^( 2) =       0.000492963823
  error estimate for blocks of size 2^( 3) =       0.000517744031
  error estimate for blocks of size 2^( 4) =       0.000535641394
  error estimate for blocks of size 2^( 5) =       0.000547045408
  error estimate for blocks of size 2^( 6) =       0.000554435466
  error estimate for blocks of size 2^( 7) =       0.000556594494

      target function =      -0.744587140290
              le_mean =     -22.814761578281
             les_mean =     520.964256103601
             stat err =       0.000548429190
             autocorr =       1.379488101823
   target nu stat err =       0.000548429190
   target dn stat err =       0.004087224144
      target stat err =       0.003435778109
              std dev =       0.660353646878
             le_variance =       0.436066938945


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281476157828e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+44, overlap shift 5.8208e+45 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744601829457       residual = 2.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744601829457       residual = 3.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744602203369       residual = 2.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+44 is 3.332412e-49

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+45, overlap shift 2.3283e+46 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744601829457       residual = 2.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744601829457       residual = 3.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744598388672       residual = 2.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+45 is 8.331029e-50

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+45, overlap shift 9.3132e+46 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744601829457       residual = 2.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744601829457       residual = 3.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744598388672       residual = 2.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+45 is 2.082757e-50

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.132268 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9931e+01
  </log>
  <optVariables href="FORM2.s081.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 81
    time step          = 0.05
    reference energy   = -22.7836
    reference variance = 0.391922
====================================================
  Execution time = 2.4654e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s081
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2813e+01
  VMC Evar = 4.4860e-01
  Total weights = 1.9646e+06
  Execution time = 3.4983e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435970300894
                                         uncertainty =       0.002396223691

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435970300894
                                         uncertainty =       0.002396223691

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466866613
  error estimate for blocks of size 2^( 2) =       0.000492306534
  error estimate for blocks of size 2^( 3) =       0.000516953142
  error estimate for blocks of size 2^( 4) =       0.000535282223
  error estimate for blocks of size 2^( 5) =       0.000548024203
  error estimate for blocks of size 2^( 6) =       0.000554605965
  error estimate for blocks of size 2^( 7) =       0.000558803727

      target function =      -0.746505270952
              le_mean =     -22.813335494513
             les_mean =     520.896880292448
             stat err =       0.000549179030
             autocorr =       1.383701005907
   target nu stat err =       0.000549179030
   target dn stat err =       0.002832756856
      target stat err =       0.002428542162
              std dev =       0.660249095291
             le_variance =       0.435928867833

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435970300894
                                         uncertainty =       0.002396223691

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435970300894
                                         uncertainty =       0.002396223691

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466866613
  error estimate for blocks of size 2^( 2) =       0.000492306534
  error estimate for blocks of size 2^( 3) =       0.000516953142
  error estimate for blocks of size 2^( 4) =       0.000535282223
  error estimate for blocks of size 2^( 5) =       0.000548024203
  error estimate for blocks of size 2^( 6) =       0.000554605965
  error estimate for blocks of size 2^( 7) =       0.000558803727

      target function =      -0.746505270952
              le_mean =     -22.813335494513
             les_mean =     520.896880292448
             stat err =       0.000549179030
             autocorr =       1.383701005905
   target nu stat err =       0.000549179030
   target dn stat err =       0.002832756856
      target stat err =       0.002428542162
              std dev =       0.660249095291
             le_variance =       0.435928867833

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435970300894
                                         uncertainty =       0.002396223691

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435970300894
                                         uncertainty =       0.002396223691

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466866613
  error estimate for blocks of size 2^( 2) =       0.000492306534
  error estimate for blocks of size 2^( 3) =       0.000516953142
  error estimate for blocks of size 2^( 4) =       0.000535282223
  error estimate for blocks of size 2^( 5) =       0.000548024203
  error estimate for blocks of size 2^( 6) =       0.000554605965
  error estimate for blocks of size 2^( 7) =       0.000558803727

      target function =      -0.746505270952
              le_mean =     -22.813335494513
             les_mean =     520.896880292448
             stat err =       0.000549179030
             autocorr =       1.383701005905
   target nu stat err =       0.000549179030
   target dn stat err =       0.002832756856
      target stat err =       0.002428542162
              std dev =       0.660249095291
             le_variance =       0.435928867833

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435970300894
                                         uncertainty =       0.002396223691

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435970300894
                                         uncertainty =       0.002396223691

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466866613
  error estimate for blocks of size 2^( 2) =       0.000492306534
  error estimate for blocks of size 2^( 3) =       0.000516953142
  error estimate for blocks of size 2^( 4) =       0.000535282223
  error estimate for blocks of size 2^( 5) =       0.000548024203
  error estimate for blocks of size 2^( 6) =       0.000554605965
  error estimate for blocks of size 2^( 7) =       0.000558803727

      target function =      -0.746505270952
              le_mean =     -22.813335494513
             les_mean =     520.896880292448
             stat err =       0.000549179030
             autocorr =       1.383701005905
   target nu stat err =       0.000549179030
   target dn stat err =       0.002832756856
      target stat err =       0.002428542162
              std dev =       0.660249095291
             le_variance =       0.435928867833


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746505270952        initial  <--
     5.8208e+44     5.8208e+45             3.3324e-49        -0.746505270952
     2.3283e+45     2.3283e+46             8.3310e-50        -0.746505270952
     9.3132e+45     9.3132e+46             2.0828e-50        -0.746505270952

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.1470
  </log>
  <optVariables href="FORM2.s081.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2085e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s082 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s082 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=82  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2811e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 82
    time step          = 0.05
    reference energy   = -22.8551
    reference variance = 0.31448
====================================================
  Execution time = 2.5357e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s082
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5335e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4543e-01
  Total weights = 1.964954417e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5281e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434250448544
                                         uncertainty =       0.002194486045

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434250448544
                                         uncertainty =       0.002194486045

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465932962
  error estimate for blocks of size 2^( 2) =       0.000491666990
  error estimate for blocks of size 2^( 3) =       0.000515416357
  error estimate for blocks of size 2^( 4) =       0.000534106951
  error estimate for blocks of size 2^( 5) =       0.000545899100
  error estimate for blocks of size 2^( 6) =       0.000551923012
  error estimate for blocks of size 2^( 7) =       0.000553590528

      target function =      -0.749159730881
              le_mean =     -22.814830685112
             les_mean =     520.961926882534
             stat err =       0.000546379898
             autocorr =       1.375126192351
   target nu stat err =       0.000546379898
   target dn stat err =       0.002631383699
      target stat err =       0.002287019961
              std dev =       0.658928714297
             le_variance =       0.434187050525


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281483068511e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+45, overlap shift 5.8208e+46 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749165675589       residual = 2.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749165675589       residual = 3.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749165675589       residual = 2.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+45 is 2.657576e-50

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+46, overlap shift 2.3283e+47 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749165675589       residual = 2.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749165675589       residual = 3.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749165675589       residual = 2.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+46 is 6.643941e-51

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+46, overlap shift 9.3132e+47 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749165675589       residual = 2.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749165675589       residual = 3.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749165675589       residual = 2.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+46 is 1.660985e-51

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.133687 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9892e+01
  </log>
  <optVariables href="FORM2.s082.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 82
    time step          = 0.05
    reference energy   = -22.719
    reference variance = 0.342489
====================================================
  Execution time = 2.6734e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s082
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.6565e-01
  Total weights = 1.9647e+06
  Execution time = 3.4931e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435966145176
                                         uncertainty =       0.002642756949

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435966145176
                                         uncertainty =       0.002642756949

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466892820
  error estimate for blocks of size 2^( 2) =       0.000492133288
  error estimate for blocks of size 2^( 3) =       0.000516248331
  error estimate for blocks of size 2^( 4) =       0.000534413161
  error estimate for blocks of size 2^( 5) =       0.000546486230
  error estimate for blocks of size 2^( 6) =       0.000553039802
  error estimate for blocks of size 2^( 7) =       0.000559182928

      target function =      -0.732424780721
              le_mean =     -22.814596654666
             les_mean =     520.971472867616
             stat err =       0.000548280530
             autocorr =       1.379022198247
   target nu stat err =       0.000548280530
   target dn stat err =       0.014392314702
      target stat err =       0.011536146032
              std dev =       0.660286158648
             le_variance =       0.435977811302

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435966145176
                                         uncertainty =       0.002642756949

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435966145176
                                         uncertainty =       0.002642756949

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466892820
  error estimate for blocks of size 2^( 2) =       0.000492133288
  error estimate for blocks of size 2^( 3) =       0.000516248331
  error estimate for blocks of size 2^( 4) =       0.000534413161
  error estimate for blocks of size 2^( 5) =       0.000546486230
  error estimate for blocks of size 2^( 6) =       0.000553039802
  error estimate for blocks of size 2^( 7) =       0.000559182928

      target function =      -0.732424780721
              le_mean =     -22.814596654666
             les_mean =     520.971472867616
             stat err =       0.000548280530
             autocorr =       1.379022198247
   target nu stat err =       0.000548280530
   target dn stat err =       0.014392314702
      target stat err =       0.011536146032
              std dev =       0.660286158648
             le_variance =       0.435977811302

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435966145176
                                         uncertainty =       0.002642756949

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435966145176
                                         uncertainty =       0.002642756949

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466892820
  error estimate for blocks of size 2^( 2) =       0.000492133288
  error estimate for blocks of size 2^( 3) =       0.000516248331
  error estimate for blocks of size 2^( 4) =       0.000534413161
  error estimate for blocks of size 2^( 5) =       0.000546486230
  error estimate for blocks of size 2^( 6) =       0.000553039802
  error estimate for blocks of size 2^( 7) =       0.000559182928

      target function =      -0.732424780721
              le_mean =     -22.814596654666
             les_mean =     520.971472867616
             stat err =       0.000548280530
             autocorr =       1.379022198247
   target nu stat err =       0.000548280530
   target dn stat err =       0.014392314702
      target stat err =       0.011536146032
              std dev =       0.660286158648
             le_variance =       0.435977811302

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435966145176
                                         uncertainty =       0.002642756949

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435966145176
                                         uncertainty =       0.002642756949

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466892820
  error estimate for blocks of size 2^( 2) =       0.000492133288
  error estimate for blocks of size 2^( 3) =       0.000516248331
  error estimate for blocks of size 2^( 4) =       0.000534413161
  error estimate for blocks of size 2^( 5) =       0.000546486230
  error estimate for blocks of size 2^( 6) =       0.000553039802
  error estimate for blocks of size 2^( 7) =       0.000559182928

      target function =      -0.732424780721
              le_mean =     -22.814596654666
             les_mean =     520.971472867616
             stat err =       0.000548280530
             autocorr =       1.379022198247
   target nu stat err =       0.000548280530
   target dn stat err =       0.014392314702
      target stat err =       0.011536146032
              std dev =       0.660286158648
             le_variance =       0.435977811302


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.732424780721        initial  <--
     5.8208e+45     5.8208e+46             2.6576e-50        -0.732424780721
     2.3283e+46     2.3283e+47             6.6439e-51        -0.732424780721
     9.3132e+46     9.3132e+47             1.6610e-51        -0.732424780721

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.1995
  </log>
  <optVariables href="FORM2.s082.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4098e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s083 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s083 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=83  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2810e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 83
    time step          = 0.05
    reference energy   = -22.8142
    reference variance = 0.423606
====================================================
  Execution time = 2.5067e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s083
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5336e+04
  VMC Eavg = -2.2813e+01
  VMC Evar = 4.4916e-01
  Total weights = 1.964726463e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5085e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434820095037
                                         uncertainty =       0.002647017404

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434820095037
                                         uncertainty =       0.002647017404

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466311869
  error estimate for blocks of size 2^( 2) =       0.000492316922
  error estimate for blocks of size 2^( 3) =       0.000516567371
  error estimate for blocks of size 2^( 4) =       0.000534517673
  error estimate for blocks of size 2^( 5) =       0.000544949902
  error estimate for blocks of size 2^( 6) =       0.000551402057
  error estimate for blocks of size 2^( 7) =       0.000554707845

      target function =      -0.746040402270
              le_mean =     -22.813481485032
             les_mean =     520.904095506295
             stat err =       0.000546394369
             autocorr =       1.372965076240
   target nu stat err =       0.000546394369
   target dn stat err =       0.003765323693
      target stat err =       0.003179704128
              std dev =       0.659464569743
             le_variance =       0.434893518746


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281348148503e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+46, overlap shift 5.8208e+47 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746052951480       residual = 2.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746052951480       residual = 2.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+46 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+47, overlap shift 2.3283e+48 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746052951480       residual = 2.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746052951480       residual = 2.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+47 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+47, overlap shift 9.3132e+48 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746052951480       residual = 2.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746052951480       residual = 2.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+47 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.134797 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9582e+01
  </log>
  <optVariables href="FORM2.s083.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 83
    time step          = 0.05
    reference energy   = -22.8352
    reference variance = 0.319588
====================================================
  Execution time = 2.4403e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s083
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4934e-01
  Total weights = 1.9647e+06
  Execution time = 3.4919e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435369646833
                                         uncertainty =       0.001907101451

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435369646833
                                         uncertainty =       0.001907101451

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466584285
  error estimate for blocks of size 2^( 2) =       0.000492238140
  error estimate for blocks of size 2^( 3) =       0.000517043832
  error estimate for blocks of size 2^( 4) =       0.000535338392
  error estimate for blocks of size 2^( 5) =       0.000546941728
  error estimate for blocks of size 2^( 6) =       0.000553153905
  error estimate for blocks of size 2^( 7) =       0.000555245009

      target function =      -0.745890795389
              le_mean =     -22.814823153206
             les_mean =     520.965499417018
             stat err =       0.000547669759
             autocorr =       1.377771851126
   target nu stat err =       0.000547669759
   target dn stat err =       0.003231576961
      target stat err =       0.002751425772
              std dev =       0.659849823170
             le_variance =       0.435401789137

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435369646833
                                         uncertainty =       0.001907101451

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435369646833
                                         uncertainty =       0.001907101451

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466584285
  error estimate for blocks of size 2^( 2) =       0.000492238140
  error estimate for blocks of size 2^( 3) =       0.000517043832
  error estimate for blocks of size 2^( 4) =       0.000535338392
  error estimate for blocks of size 2^( 5) =       0.000546941728
  error estimate for blocks of size 2^( 6) =       0.000553153905
  error estimate for blocks of size 2^( 7) =       0.000555245009

      target function =      -0.745890795389
              le_mean =     -22.814823153206
             les_mean =     520.965499417018
             stat err =       0.000547669759
             autocorr =       1.377771851125
   target nu stat err =       0.000547669759
   target dn stat err =       0.003231576961
      target stat err =       0.002751425772
              std dev =       0.659849823170
             le_variance =       0.435401789137

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435369646833
                                         uncertainty =       0.001907101451

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435369646833
                                         uncertainty =       0.001907101451

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466584285
  error estimate for blocks of size 2^( 2) =       0.000492238140
  error estimate for blocks of size 2^( 3) =       0.000517043832
  error estimate for blocks of size 2^( 4) =       0.000535338392
  error estimate for blocks of size 2^( 5) =       0.000546941728
  error estimate for blocks of size 2^( 6) =       0.000553153905
  error estimate for blocks of size 2^( 7) =       0.000555245009

      target function =      -0.745890795389
              le_mean =     -22.814823153206
             les_mean =     520.965499417018
             stat err =       0.000547669759
             autocorr =       1.377771851125
   target nu stat err =       0.000547669759
   target dn stat err =       0.003231576961
      target stat err =       0.002751425772
              std dev =       0.659849823170
             le_variance =       0.435401789137

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435369646833
                                         uncertainty =       0.001907101451

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435369646833
                                         uncertainty =       0.001907101451

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466584285
  error estimate for blocks of size 2^( 2) =       0.000492238140
  error estimate for blocks of size 2^( 3) =       0.000517043832
  error estimate for blocks of size 2^( 4) =       0.000535338392
  error estimate for blocks of size 2^( 5) =       0.000546941728
  error estimate for blocks of size 2^( 6) =       0.000553153905
  error estimate for blocks of size 2^( 7) =       0.000555245009

      target function =      -0.745890795389
              le_mean =     -22.814823153206
             les_mean =     520.965499417018
             stat err =       0.000547669759
             autocorr =       1.377771851125
   target nu stat err =       0.000547669759
   target dn stat err =       0.003231576961
      target stat err =       0.002751425772
              std dev =       0.659849823170
             le_variance =       0.435401789137


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745890795389        initial  <--
     5.8208e+46     5.8208e+47             0.0000e+00        -0.745890795389
     2.3283e+47     2.3283e+48             0.0000e+00        -0.745890795389
     9.3132e+47     9.3132e+48             0.0000e+00        -0.745890795389

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 41.8622
  </log>
  <optVariables href="FORM2.s083.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.1450e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s084 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s084 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=84  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2811e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 84
    time step          = 0.05
    reference energy   = -22.8573
    reference variance = 0.372744
====================================================
  Execution time = 2.5171e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s084
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5335e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5692e-01
  Total weights = 1.964642285e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5190e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441898881708
                                         uncertainty =       0.003537299215

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441898881708
                                         uncertainty =       0.003537299215

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470000358
  error estimate for blocks of size 2^( 2) =       0.000495373367
  error estimate for blocks of size 2^( 3) =       0.000519760096
  error estimate for blocks of size 2^( 4) =       0.000537869518
  error estimate for blocks of size 2^( 5) =       0.000549663633
  error estimate for blocks of size 2^( 6) =       0.000556169150
  error estimate for blocks of size 2^( 7) =       0.000559917537

      target function =      -0.739644329482
              le_mean =     -22.814476191809
             les_mean =     520.957241929566
             stat err =       0.000550904960
             autocorr =       1.373905895055
   target nu stat err =       0.000550904960
   target dn stat err =       0.005074133807
      target stat err =       0.004184876011
              std dev =       0.664680880501
             le_variance =       0.441800672904


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281447619181e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+47, overlap shift 5.8208e+48 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.739667151367       residual = 2.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.739667151367       residual = 5.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.739685058594       residual = 2.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+47 is 2.929996e-52

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+48, overlap shift 2.3283e+49 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.739667151367       residual = 2.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.739667151367       residual = 5.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.739624023438       residual = 2.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+48 is 7.324989e-53

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+48, overlap shift 9.3132e+49 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.739667151367       residual = 2.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.739667151367       residual = 5.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.739746093750       residual = 2.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+48 is 1.831247e-53

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.136185 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9696e+01
  </log>
  <optVariables href="FORM2.s084.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 84
    time step          = 0.05
    reference energy   = -22.9474
    reference variance = 1.00009
====================================================
  Execution time = 2.6927e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s084
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4796e-01
  Total weights = 1.9647e+06
  Execution time = 3.5110e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436555783851
                                         uncertainty =       0.001834759709

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436555783851
                                         uncertainty =       0.001834759709

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467207700
  error estimate for blocks of size 2^( 2) =       0.000493052471
  error estimate for blocks of size 2^( 3) =       0.000516634441
  error estimate for blocks of size 2^( 4) =       0.000534828752
  error estimate for blocks of size 2^( 5) =       0.000546110119
  error estimate for blocks of size 2^( 6) =       0.000552608604
  error estimate for blocks of size 2^( 7) =       0.000555209412

      target function =      -0.747041505076
              le_mean =     -22.814580117406
             les_mean =     520.953030645015
             stat err =       0.000547189222
             autocorr =       1.371687199126
   target nu stat err =       0.000547189222
   target dn stat err =       0.002402532291
      target stat err =       0.002091034616
              std dev =       0.660731465458
             le_variance =       0.436566069446

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436555783851
                                         uncertainty =       0.001834759709

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436555783851
                                         uncertainty =       0.001834759709

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467207700
  error estimate for blocks of size 2^( 2) =       0.000493052471
  error estimate for blocks of size 2^( 3) =       0.000516634441
  error estimate for blocks of size 2^( 4) =       0.000534828752
  error estimate for blocks of size 2^( 5) =       0.000546110119
  error estimate for blocks of size 2^( 6) =       0.000552608604
  error estimate for blocks of size 2^( 7) =       0.000555209412

      target function =      -0.747041505076
              le_mean =     -22.814580117406
             les_mean =     520.953030645015
             stat err =       0.000547189222
             autocorr =       1.371687199126
   target nu stat err =       0.000547189222
   target dn stat err =       0.002402532291
      target stat err =       0.002091034616
              std dev =       0.660731465458
             le_variance =       0.436566069446

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436555783851
                                         uncertainty =       0.001834759709

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436555783851
                                         uncertainty =       0.001834759709

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467207700
  error estimate for blocks of size 2^( 2) =       0.000493052471
  error estimate for blocks of size 2^( 3) =       0.000516634441
  error estimate for blocks of size 2^( 4) =       0.000534828752
  error estimate for blocks of size 2^( 5) =       0.000546110119
  error estimate for blocks of size 2^( 6) =       0.000552608604
  error estimate for blocks of size 2^( 7) =       0.000555209412

      target function =      -0.747041505076
              le_mean =     -22.814580117406
             les_mean =     520.953030645015
             stat err =       0.000547189222
             autocorr =       1.371687199126
   target nu stat err =       0.000547189222
   target dn stat err =       0.002402532291
      target stat err =       0.002091034616
              std dev =       0.660731465458
             le_variance =       0.436566069446

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436555783851
                                         uncertainty =       0.001834759709

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436555783851
                                         uncertainty =       0.001834759709

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467207700
  error estimate for blocks of size 2^( 2) =       0.000493052471
  error estimate for blocks of size 2^( 3) =       0.000516634441
  error estimate for blocks of size 2^( 4) =       0.000534828752
  error estimate for blocks of size 2^( 5) =       0.000546110119
  error estimate for blocks of size 2^( 6) =       0.000552608604
  error estimate for blocks of size 2^( 7) =       0.000555209412

      target function =      -0.747041505076
              le_mean =     -22.814580117406
             les_mean =     520.953030645015
             stat err =       0.000547189222
             autocorr =       1.371687199126
   target nu stat err =       0.000547189222
   target dn stat err =       0.002402532291
      target stat err =       0.002091034616
              std dev =       0.660731465458
             le_variance =       0.436566069446


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747041505076        initial  <--
     5.8208e+47     5.8208e+48             2.9300e-52        -0.747041505076
     2.3283e+48     2.3283e+49             7.3250e-53        -0.747041505076
     9.3132e+48     9.3132e+49             1.8312e-53        -0.747041505076

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.4901
  </log>
  <optVariables href="FORM2.s084.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4193e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s085 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s085 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=85  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2812e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 85
    time step          = 0.05
    reference energy   = -22.8283
    reference variance = 0.316591
====================================================
  Execution time = 2.5883e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s085
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5320e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4844e-01
  Total weights = 1.964530694e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5142e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435249916166
                                         uncertainty =       0.002429010810

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435249916166
                                         uncertainty =       0.002429010810

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466447555
  error estimate for blocks of size 2^( 2) =       0.000491839319
  error estimate for blocks of size 2^( 3) =       0.000515559183
  error estimate for blocks of size 2^( 4) =       0.000534081206
  error estimate for blocks of size 2^( 5) =       0.000545942741
  error estimate for blocks of size 2^( 6) =       0.000552413284
  error estimate for blocks of size 2^( 7) =       0.000557147009

      target function =      -0.746638372691
              le_mean =     -22.813655901582
             les_mean =     520.911337712327
             stat err =       0.000547396060
             autocorr =       1.377202153455
   target nu stat err =       0.000547396060
   target dn stat err =       0.003226727873
      target stat err =       0.002748019821
              std dev =       0.659656458050
             le_variance =       0.435146642647


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281365590158e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+48, overlap shift 5.8208e+49 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746647379337       residual = 2.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746647379337       residual = 2.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+48 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+49, overlap shift 2.3283e+50 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746647379337       residual = 2.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746647379337       residual = 2.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+49 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+49, overlap shift 9.3132e+50 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746647379337       residual = 2.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746647379337       residual = 2.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+49 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.137330 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0404e+01
  </log>
  <optVariables href="FORM2.s085.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 85
    time step          = 0.05
    reference energy   = -22.8378
    reference variance = 0.32352
====================================================
  Execution time = 2.4698e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s085
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4656e-01
  Total weights = 1.9649e+06
  Execution time = 3.4907e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434352379990
                                         uncertainty =       0.002053879212

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434352379990
                                         uncertainty =       0.002053879212

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466014578
  error estimate for blocks of size 2^( 2) =       0.000492222153
  error estimate for blocks of size 2^( 3) =       0.000516669222
  error estimate for blocks of size 2^( 4) =       0.000534924173
  error estimate for blocks of size 2^( 5) =       0.000546785689
  error estimate for blocks of size 2^( 6) =       0.000554313828
  error estimate for blocks of size 2^( 7) =       0.000559161338

      target function =      -0.748209625625
              le_mean =     -22.814240720511
             les_mean =     520.936138927862
             stat err =       0.000548796257
             autocorr =       1.386830153822
   target nu stat err =       0.000548796257
   target dn stat err =       0.002909972908
      target stat err =       0.002504926797
              std dev =       0.659044136252
             le_variance =       0.434339173528

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434352379990
                                         uncertainty =       0.002053879212

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434352379990
                                         uncertainty =       0.002053879212

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466014578
  error estimate for blocks of size 2^( 2) =       0.000492222153
  error estimate for blocks of size 2^( 3) =       0.000516669222
  error estimate for blocks of size 2^( 4) =       0.000534924173
  error estimate for blocks of size 2^( 5) =       0.000546785689
  error estimate for blocks of size 2^( 6) =       0.000554313828
  error estimate for blocks of size 2^( 7) =       0.000559161338

      target function =      -0.748209625625
              le_mean =     -22.814240720511
             les_mean =     520.936138927862
             stat err =       0.000548796257
             autocorr =       1.386830153822
   target nu stat err =       0.000548796257
   target dn stat err =       0.002909972908
      target stat err =       0.002504926797
              std dev =       0.659044136252
             le_variance =       0.434339173528

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434352379990
                                         uncertainty =       0.002053879212

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434352379990
                                         uncertainty =       0.002053879212

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466014578
  error estimate for blocks of size 2^( 2) =       0.000492222153
  error estimate for blocks of size 2^( 3) =       0.000516669222
  error estimate for blocks of size 2^( 4) =       0.000534924173
  error estimate for blocks of size 2^( 5) =       0.000546785689
  error estimate for blocks of size 2^( 6) =       0.000554313828
  error estimate for blocks of size 2^( 7) =       0.000559161338

      target function =      -0.748209625625
              le_mean =     -22.814240720511
             les_mean =     520.936138927862
             stat err =       0.000548796257
             autocorr =       1.386830153822
   target nu stat err =       0.000548796257
   target dn stat err =       0.002909972908
      target stat err =       0.002504926797
              std dev =       0.659044136252
             le_variance =       0.434339173528

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434352379990
                                         uncertainty =       0.002053879212

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434352379990
                                         uncertainty =       0.002053879212

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466014578
  error estimate for blocks of size 2^( 2) =       0.000492222153
  error estimate for blocks of size 2^( 3) =       0.000516669222
  error estimate for blocks of size 2^( 4) =       0.000534924173
  error estimate for blocks of size 2^( 5) =       0.000546785689
  error estimate for blocks of size 2^( 6) =       0.000554313828
  error estimate for blocks of size 2^( 7) =       0.000559161338

      target function =      -0.748209625625
              le_mean =     -22.814240720511
             les_mean =     520.936138927862
             stat err =       0.000548796257
             autocorr =       1.386830153822
   target nu stat err =       0.000548796257
   target dn stat err =       0.002909972908
      target stat err =       0.002504926797
              std dev =       0.659044136252
             le_variance =       0.434339173528


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748209625625        initial  <--
     5.8208e+48     5.8208e+49             0.0000e+00        -0.748209625625
     2.3283e+49     2.3283e+50             0.0000e+00        -0.748209625625
     9.3132e+49     9.3132e+50             0.0000e+00        -0.748209625625

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.1719
  </log>
  <optVariables href="FORM2.s085.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2582e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s086 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s086 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=86  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2812e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 86
    time step          = 0.05
    reference energy   = -22.8138
    reference variance = 0.360454
====================================================
  Execution time = 2.5100e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s086
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5363e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5281e-01
  Total weights = 1.964874547e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5229e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437950756863
                                         uncertainty =       0.002176105575

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437950756863
                                         uncertainty =       0.002176105575

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467926311
  error estimate for blocks of size 2^( 2) =       0.000493690005
  error estimate for blocks of size 2^( 3) =       0.000517965116
  error estimate for blocks of size 2^( 4) =       0.000536694562
  error estimate for blocks of size 2^( 5) =       0.000549575314
  error estimate for blocks of size 2^( 6) =       0.000556548322
  error estimate for blocks of size 2^( 7) =       0.000561863352

      target function =      -0.743018949517
              le_mean =     -22.814894724424
             les_mean =     520.972236096926
             stat err =       0.000551170387
             autocorr =       1.387448334414
   target nu stat err =       0.000551170387
   target dn stat err =       0.003382060906
      target stat err =       0.002852944452
              std dev =       0.661747735853
             le_variance =       0.437910065906


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281489472442e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+49, overlap shift 5.8208e+50 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743028868652       residual = 2.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743028868652       residual = 2.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+49 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+50, overlap shift 2.3283e+51 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743028868652       residual = 2.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743028868652       residual = 2.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+50 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+50, overlap shift 9.3132e+51 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743028868652       residual = 2.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743028868652       residual = 2.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+50 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.138460 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9629e+01
  </log>
  <optVariables href="FORM2.s086.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 86
    time step          = 0.05
    reference energy   = -22.8949
    reference variance = 0.373149
====================================================
  Execution time = 2.6489e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s086
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4496e-01
  Total weights = 1.9648e+06
  Execution time = 3.4982e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434089249180
                                         uncertainty =       0.001729303189

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434089249180
                                         uncertainty =       0.001729303189

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465890533
  error estimate for blocks of size 2^( 2) =       0.000491609884
  error estimate for blocks of size 2^( 3) =       0.000516008477
  error estimate for blocks of size 2^( 4) =       0.000533493662
  error estimate for blocks of size 2^( 5) =       0.000544821093
  error estimate for blocks of size 2^( 6) =       0.000550312174
  error estimate for blocks of size 2^( 7) =       0.000555215238

      target function =      -0.749549482546
              le_mean =     -22.813948364194
             les_mean =     520.921198783362
             stat err =       0.000545960542
             autocorr =       1.373266231550
   target nu stat err =       0.000545960542
   target dn stat err =       0.002190257947
      target stat err =       0.001932708626
              std dev =       0.658868710504
             le_variance =       0.434107977681

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434089249180
                                         uncertainty =       0.001729303189

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434089249180
                                         uncertainty =       0.001729303189

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465890533
  error estimate for blocks of size 2^( 2) =       0.000491609884
  error estimate for blocks of size 2^( 3) =       0.000516008477
  error estimate for blocks of size 2^( 4) =       0.000533493662
  error estimate for blocks of size 2^( 5) =       0.000544821093
  error estimate for blocks of size 2^( 6) =       0.000550312174
  error estimate for blocks of size 2^( 7) =       0.000555215238

      target function =      -0.749549482546
              le_mean =     -22.813948364194
             les_mean =     520.921198783362
             stat err =       0.000545960542
             autocorr =       1.373266231551
   target nu stat err =       0.000545960542
   target dn stat err =       0.002190257947
      target stat err =       0.001932708626
              std dev =       0.658868710504
             le_variance =       0.434107977681

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434089249180
                                         uncertainty =       0.001729303189

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434089249180
                                         uncertainty =       0.001729303189

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465890533
  error estimate for blocks of size 2^( 2) =       0.000491609884
  error estimate for blocks of size 2^( 3) =       0.000516008477
  error estimate for blocks of size 2^( 4) =       0.000533493662
  error estimate for blocks of size 2^( 5) =       0.000544821093
  error estimate for blocks of size 2^( 6) =       0.000550312174
  error estimate for blocks of size 2^( 7) =       0.000555215238

      target function =      -0.749549482546
              le_mean =     -22.813948364194
             les_mean =     520.921198783362
             stat err =       0.000545960542
             autocorr =       1.373266231551
   target nu stat err =       0.000545960542
   target dn stat err =       0.002190257947
      target stat err =       0.001932708626
              std dev =       0.658868710504
             le_variance =       0.434107977681

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434089249180
                                         uncertainty =       0.001729303189

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434089249180
                                         uncertainty =       0.001729303189

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465890533
  error estimate for blocks of size 2^( 2) =       0.000491609884
  error estimate for blocks of size 2^( 3) =       0.000516008477
  error estimate for blocks of size 2^( 4) =       0.000533493662
  error estimate for blocks of size 2^( 5) =       0.000544821093
  error estimate for blocks of size 2^( 6) =       0.000550312174
  error estimate for blocks of size 2^( 7) =       0.000555215238

      target function =      -0.749549482546
              le_mean =     -22.813948364194
             les_mean =     520.921198783362
             stat err =       0.000545960542
             autocorr =       1.373266231551
   target nu stat err =       0.000545960542
   target dn stat err =       0.002190257947
      target stat err =       0.001932708626
              std dev =       0.658868710504
             le_variance =       0.434107977681


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.749549482546        initial  <--
     5.8208e+49     5.8208e+50             0.0000e+00        -0.749549482546
     2.3283e+50     2.3283e+51             0.0000e+00        -0.749549482546
     9.3132e+50     9.3132e+51             0.0000e+00        -0.749549482546

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.9858
  </log>
  <optVariables href="FORM2.s086.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3621e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s087 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s087 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=87  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2812e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 87
    time step          = 0.05
    reference energy   = -22.6834
    reference variance = 0.856445
====================================================
  Execution time = 2.5544e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s087
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5382e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4648e-01
  Total weights = 1.964756320e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4796e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435101488279
                                         uncertainty =       0.001722158021

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435101488279
                                         uncertainty =       0.001722158021

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466427701
  error estimate for blocks of size 2^( 2) =       0.000492066823
  error estimate for blocks of size 2^( 3) =       0.000516317352
  error estimate for blocks of size 2^( 4) =       0.000534534625
  error estimate for blocks of size 2^( 5) =       0.000546825606
  error estimate for blocks of size 2^( 6) =       0.000553183344
  error estimate for blocks of size 2^( 7) =       0.000557836201

      target function =      -0.748274029907
              le_mean =     -22.814110681895
             les_mean =     520.930129548476
             stat err =       0.000548094944
             autocorr =       1.380838607611
   target nu stat err =       0.000548094944
   target dn stat err =       0.002586434223
      target stat err =       0.002243749251
              std dev =       0.659628381186
             le_variance =       0.435109601266


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281411068190e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+50, overlap shift 5.8208e+51 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748279826134       residual = 1.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748279826134       residual = 1.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+50 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+51, overlap shift 2.3283e+52 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748279826134       residual = 1.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748279826134       residual = 1.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+51 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+51, overlap shift 9.3132e+52 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748279826134       residual = 1.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748279826134       residual = 1.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+51 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.139591 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0030e+01
  </log>
  <optVariables href="FORM2.s087.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 87
    time step          = 0.05
    reference energy   = -22.8345
    reference variance = 0.265335
====================================================
  Execution time = 2.4539e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s087
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4429e-01
  Total weights = 1.9647e+06
  Execution time = 3.4845e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434262371774
                                         uncertainty =       0.001853820788

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434262371774
                                         uncertainty =       0.001853820788

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466021508
  error estimate for blocks of size 2^( 2) =       0.000491471918
  error estimate for blocks of size 2^( 3) =       0.000516451793
  error estimate for blocks of size 2^( 4) =       0.000535022438
  error estimate for blocks of size 2^( 5) =       0.000546537389
  error estimate for blocks of size 2^( 6) =       0.000553622504
  error estimate for blocks of size 2^( 7) =       0.000558870017

      target function =      -0.750115745740
              le_mean =     -22.814284913353
             les_mean =     520.935881880251
             stat err =       0.000548513087
             autocorr =       1.385358154089
   target nu stat err =       0.000548513087
   target dn stat err =       0.002208206787
      target stat err =       0.001951648327
              std dev =       0.659053937430
             le_variance =       0.434352092442

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434262371774
                                         uncertainty =       0.001853820788

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434262371774
                                         uncertainty =       0.001853820788

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466021508
  error estimate for blocks of size 2^( 2) =       0.000491471918
  error estimate for blocks of size 2^( 3) =       0.000516451793
  error estimate for blocks of size 2^( 4) =       0.000535022438
  error estimate for blocks of size 2^( 5) =       0.000546537389
  error estimate for blocks of size 2^( 6) =       0.000553622504
  error estimate for blocks of size 2^( 7) =       0.000558870017

      target function =      -0.750115745740
              le_mean =     -22.814284913353
             les_mean =     520.935881880251
             stat err =       0.000548513087
             autocorr =       1.385358154089
   target nu stat err =       0.000548513087
   target dn stat err =       0.002208206787
      target stat err =       0.001951648327
              std dev =       0.659053937430
             le_variance =       0.434352092442

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434262371774
                                         uncertainty =       0.001853820788

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434262371774
                                         uncertainty =       0.001853820788

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466021508
  error estimate for blocks of size 2^( 2) =       0.000491471918
  error estimate for blocks of size 2^( 3) =       0.000516451793
  error estimate for blocks of size 2^( 4) =       0.000535022438
  error estimate for blocks of size 2^( 5) =       0.000546537389
  error estimate for blocks of size 2^( 6) =       0.000553622504
  error estimate for blocks of size 2^( 7) =       0.000558870017

      target function =      -0.750115745740
              le_mean =     -22.814284913353
             les_mean =     520.935881880251
             stat err =       0.000548513087
             autocorr =       1.385358154089
   target nu stat err =       0.000548513087
   target dn stat err =       0.002208206787
      target stat err =       0.001951648327
              std dev =       0.659053937430
             le_variance =       0.434352092442

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434262371774
                                         uncertainty =       0.001853820788

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434262371774
                                         uncertainty =       0.001853820788

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466021508
  error estimate for blocks of size 2^( 2) =       0.000491471918
  error estimate for blocks of size 2^( 3) =       0.000516451793
  error estimate for blocks of size 2^( 4) =       0.000535022438
  error estimate for blocks of size 2^( 5) =       0.000546537389
  error estimate for blocks of size 2^( 6) =       0.000553622504
  error estimate for blocks of size 2^( 7) =       0.000558870017

      target function =      -0.750115745740
              le_mean =     -22.814284913353
             les_mean =     520.935881880251
             stat err =       0.000548513087
             autocorr =       1.385358154089
   target nu stat err =       0.000548513087
   target dn stat err =       0.002208206787
      target stat err =       0.001951648327
              std dev =       0.659053937430
             le_variance =       0.434352092442


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.750115745740        initial  <--
     5.8208e+50     5.8208e+51             0.0000e+00        -0.750115745740
     2.3283e+51     2.3283e+52             0.0000e+00        -0.750115745740
     9.3132e+51     9.3132e+52             0.0000e+00        -0.750115745740

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 41.9924
  </log>
  <optVariables href="FORM2.s087.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2029e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s088 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s088 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=88  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2812e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 88
    time step          = 0.05
    reference energy   = -22.808
    reference variance = 0.317565
====================================================
  Execution time = 2.5157e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s088
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5344e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4779e-01
  Total weights = 1.964860046e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4943e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434730160890
                                         uncertainty =       0.001924404338

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434730160890
                                         uncertainty =       0.001924404338

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466205559
  error estimate for blocks of size 2^( 2) =       0.000491900145
  error estimate for blocks of size 2^( 3) =       0.000516460961
  error estimate for blocks of size 2^( 4) =       0.000534576345
  error estimate for blocks of size 2^( 5) =       0.000546232685
  error estimate for blocks of size 2^( 6) =       0.000554917991
  error estimate for blocks of size 2^( 7) =       0.000556436939

      target function =      -0.747183995021
              le_mean =     -22.813549715926
             les_mean =     520.905840158199
             stat err =       0.000548040990
             autocorr =       1.381882728778
   target nu stat err =       0.000548040990
   target dn stat err =       0.002519109521
      target stat err =       0.002181765492
              std dev =       0.659314224657
             le_variance =       0.434695246835


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281354971593e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+51, overlap shift 5.8208e+52 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747189368309       residual = 1.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747189368309       residual = 1.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+51 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+52, overlap shift 2.3283e+53 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747189368309       residual = 1.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747189368309       residual = 1.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+52 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+52, overlap shift 9.3132e+53 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747189368309       residual = 1.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747189368309       residual = 1.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+52 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.140714 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9658e+01
  </log>
  <optVariables href="FORM2.s088.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 88
    time step          = 0.05
    reference energy   = -22.8241
    reference variance = 0.29584
====================================================
  Execution time = 2.4501e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s088
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5339e-01
  Total weights = 1.9644e+06
  Execution time = 3.8936e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440295235841
                                         uncertainty =       0.002241463585

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440295235841
                                         uncertainty =       0.002241463585

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469226000
  error estimate for blocks of size 2^( 2) =       0.000494991272
  error estimate for blocks of size 2^( 3) =       0.000518793425
  error estimate for blocks of size 2^( 4) =       0.000537616239
  error estimate for blocks of size 2^( 5) =       0.000548262762
  error estimate for blocks of size 2^( 6) =       0.000553660934
  error estimate for blocks of size 2^( 7) =       0.000556617313

      target function =      -0.742548621329
              le_mean =     -22.814618935390
             les_mean =     520.960226521507
             stat err =       0.000549039312
             autocorr =       1.369123885524
   target nu stat err =       0.000549039312
   target dn stat err =       0.003154829700
      target stat err =       0.002665429542
              std dev =       0.663585772508
             le_variance =       0.440346077474

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440295235841
                                         uncertainty =       0.002241463585

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440295235841
                                         uncertainty =       0.002241463585

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469226000
  error estimate for blocks of size 2^( 2) =       0.000494991272
  error estimate for blocks of size 2^( 3) =       0.000518793425
  error estimate for blocks of size 2^( 4) =       0.000537616239
  error estimate for blocks of size 2^( 5) =       0.000548262762
  error estimate for blocks of size 2^( 6) =       0.000553660934
  error estimate for blocks of size 2^( 7) =       0.000556617313

      target function =      -0.742548621329
              le_mean =     -22.814618935390
             les_mean =     520.960226521507
             stat err =       0.000549039312
             autocorr =       1.369123885521
   target nu stat err =       0.000549039312
   target dn stat err =       0.003154829700
      target stat err =       0.002665429542
              std dev =       0.663585772508
             le_variance =       0.440346077474

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440295235841
                                         uncertainty =       0.002241463585

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440295235841
                                         uncertainty =       0.002241463585

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469226000
  error estimate for blocks of size 2^( 2) =       0.000494991272
  error estimate for blocks of size 2^( 3) =       0.000518793425
  error estimate for blocks of size 2^( 4) =       0.000537616239
  error estimate for blocks of size 2^( 5) =       0.000548262762
  error estimate for blocks of size 2^( 6) =       0.000553660934
  error estimate for blocks of size 2^( 7) =       0.000556617313

      target function =      -0.742548621329
              le_mean =     -22.814618935390
             les_mean =     520.960226521507
             stat err =       0.000549039312
             autocorr =       1.369123885521
   target nu stat err =       0.000549039312
   target dn stat err =       0.003154829700
      target stat err =       0.002665429542
              std dev =       0.663585772508
             le_variance =       0.440346077474

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440295235841
                                         uncertainty =       0.002241463585

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440295235841
                                         uncertainty =       0.002241463585

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469226000
  error estimate for blocks of size 2^( 2) =       0.000494991272
  error estimate for blocks of size 2^( 3) =       0.000518793425
  error estimate for blocks of size 2^( 4) =       0.000537616239
  error estimate for blocks of size 2^( 5) =       0.000548262762
  error estimate for blocks of size 2^( 6) =       0.000553660934
  error estimate for blocks of size 2^( 7) =       0.000556617313

      target function =      -0.742548621329
              le_mean =     -22.814618935390
             les_mean =     520.960226521507
             stat err =       0.000549039312
             autocorr =       1.369123885521
   target nu stat err =       0.000549039312
   target dn stat err =       0.003154829700
      target stat err =       0.002665429542
              std dev =       0.663585772508
             le_variance =       0.440346077474


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.742548621329        initial  <--
     5.8208e+51     5.8208e+52             0.0000e+00        -0.742548621329
     2.3283e+52     2.3283e+53             0.0000e+00        -0.742548621329
     9.3132e+52     9.3132e+53             0.0000e+00        -0.742548621329

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.6958
  </log>
  <optVariables href="FORM2.s088.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2375e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s089 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s089 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=89  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2812e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 89
    time step          = 0.05
    reference energy   = -22.7907
    reference variance = 0.524674
====================================================
  Execution time = 2.5234e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s089
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5342e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5310e-01
  Total weights = 1.964781166e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5275e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440185532706
                                         uncertainty =       0.002363495303

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440185532706
                                         uncertainty =       0.002363495303

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469111057
  error estimate for blocks of size 2^( 2) =       0.000494892102
  error estimate for blocks of size 2^( 3) =       0.000519776425
  error estimate for blocks of size 2^( 4) =       0.000537437798
  error estimate for blocks of size 2^( 5) =       0.000548814518
  error estimate for blocks of size 2^( 6) =       0.000556604496
  error estimate for blocks of size 2^( 7) =       0.000560011345

      target function =      -0.742789924957
              le_mean =     -22.814673517063
             les_mean =     520.962424916798
             stat err =       0.000550717039
             autocorr =       1.378179192119
   target nu stat err =       0.000550717039
   target dn stat err =       0.002927576798
      target stat err =       0.002486013774
              std dev =       0.663423219205
             le_variance =       0.440130367780


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281467351706e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+52, overlap shift 5.8208e+53 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742797326127       residual = 2.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742797326127       residual = 2.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+52 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+53, overlap shift 2.3283e+54 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742797326127       residual = 2.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742797326127       residual = 2.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+53 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+53, overlap shift 9.3132e+54 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742797326127       residual = 2.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742797326127       residual = 2.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+53 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.141847 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9768e+01
  </log>
  <optVariables href="FORM2.s089.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 89
    time step          = 0.05
    reference energy   = -22.869
    reference variance = 0.649663
====================================================
  Execution time = 2.5156e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s089
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4553e-01
  Total weights = 1.9649e+06
  Execution time = 3.4964e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433226778193
                                         uncertainty =       0.002022220084

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433226778193
                                         uncertainty =       0.002022220084

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465424521
  error estimate for blocks of size 2^( 2) =       0.000491151457
  error estimate for blocks of size 2^( 3) =       0.000515379627
  error estimate for blocks of size 2^( 4) =       0.000533331143
  error estimate for blocks of size 2^( 5) =       0.000544762396
  error estimate for blocks of size 2^( 6) =       0.000550753753
  error estimate for blocks of size 2^( 7) =       0.000552610382

      target function =      -0.749065293602
              le_mean =     -22.813867017233
             les_mean =     520.918058943103
             stat err =       0.000545364419
             autocorr =       1.373014359124
   target nu stat err =       0.000545364419
   target dn stat err =       0.003225810079
      target stat err =       0.002765096151
              std dev =       0.658209669274
             le_variance =       0.433239968725

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433226778193
                                         uncertainty =       0.002022220084

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433226778193
                                         uncertainty =       0.002022220084

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465424521
  error estimate for blocks of size 2^( 2) =       0.000491151457
  error estimate for blocks of size 2^( 3) =       0.000515379627
  error estimate for blocks of size 2^( 4) =       0.000533331143
  error estimate for blocks of size 2^( 5) =       0.000544762396
  error estimate for blocks of size 2^( 6) =       0.000550753753
  error estimate for blocks of size 2^( 7) =       0.000552610382

      target function =      -0.749065293602
              le_mean =     -22.813867017233
             les_mean =     520.918058943103
             stat err =       0.000545364419
             autocorr =       1.373014359124
   target nu stat err =       0.000545364419
   target dn stat err =       0.003225810079
      target stat err =       0.002765096151
              std dev =       0.658209669274
             le_variance =       0.433239968725

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433226778193
                                         uncertainty =       0.002022220084

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433226778193
                                         uncertainty =       0.002022220084

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465424521
  error estimate for blocks of size 2^( 2) =       0.000491151457
  error estimate for blocks of size 2^( 3) =       0.000515379627
  error estimate for blocks of size 2^( 4) =       0.000533331143
  error estimate for blocks of size 2^( 5) =       0.000544762396
  error estimate for blocks of size 2^( 6) =       0.000550753753
  error estimate for blocks of size 2^( 7) =       0.000552610382

      target function =      -0.749065293602
              le_mean =     -22.813867017233
             les_mean =     520.918058943103
             stat err =       0.000545364419
             autocorr =       1.373014359124
   target nu stat err =       0.000545364419
   target dn stat err =       0.003225810079
      target stat err =       0.002765096151
              std dev =       0.658209669274
             le_variance =       0.433239968725

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433226778193
                                         uncertainty =       0.002022220084

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433226778193
                                         uncertainty =       0.002022220084

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465424521
  error estimate for blocks of size 2^( 2) =       0.000491151457
  error estimate for blocks of size 2^( 3) =       0.000515379627
  error estimate for blocks of size 2^( 4) =       0.000533331143
  error estimate for blocks of size 2^( 5) =       0.000544762396
  error estimate for blocks of size 2^( 6) =       0.000550753753
  error estimate for blocks of size 2^( 7) =       0.000552610382

      target function =      -0.749065293602
              le_mean =     -22.813867017233
             les_mean =     520.918058943103
             stat err =       0.000545364419
             autocorr =       1.373014359124
   target nu stat err =       0.000545364419
   target dn stat err =       0.003225810079
      target stat err =       0.002765096151
              std dev =       0.658209669274
             le_variance =       0.433239968725


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.749065293602        initial  <--
     5.8208e+52     5.8208e+53             0.0000e+00        -0.749065293602
     2.3283e+53     2.3283e+54             0.0000e+00        -0.749065293602
     9.3132e+53     9.3132e+54             0.0000e+00        -0.749065293602

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.6357
  </log>
  <optVariables href="FORM2.s089.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.2410e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s090 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s090 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=90  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2812e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 90
    time step          = 0.05
    reference energy   = -22.8762
    reference variance = 0.57576
====================================================
  Execution time = 2.5109e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s090
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5336e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.7053e-01
  Total weights = 1.964766933e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4956e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436291895942
                                         uncertainty =       0.002297076755

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436291895942
                                         uncertainty =       0.002297076755

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467044407
  error estimate for blocks of size 2^( 2) =       0.000492629829
  error estimate for blocks of size 2^( 3) =       0.000517547739
  error estimate for blocks of size 2^( 4) =       0.000535589135
  error estimate for blocks of size 2^( 5) =       0.000547848091
  error estimate for blocks of size 2^( 6) =       0.000554238347
  error estimate for blocks of size 2^( 7) =       0.000556508479

      target function =      -0.728226721312
              le_mean =     -22.813890835106
             les_mean =     520.944142431102
             stat err =       0.000548546013
             autocorr =       1.379462105200
   target nu stat err =       0.000548546013
   target dn stat err =       0.024482152428
      target stat err =       0.019370800658
              std dev =       0.660500534380
             le_variance =       0.436260955916


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281389083511e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+53, overlap shift 5.8208e+54 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.728740042557       residual = 2.34e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.728740042557       residual = 2.34e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+53 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+54, overlap shift 2.3283e+55 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.728740042557       residual = 2.34e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.728740042557       residual = 2.34e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+54 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+54, overlap shift 9.3132e+55 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.728740042557       residual = 2.34e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.728740042557       residual = 2.34e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+54 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.143014 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9611e+01
  </log>
  <optVariables href="FORM2.s090.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 90
    time step          = 0.05
    reference energy   = -22.7939
    reference variance = 0.472777
====================================================
  Execution time = 2.4669e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s090
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5152e-01
  Total weights = 1.9644e+06
  Execution time = 3.4951e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436983217162
                                         uncertainty =       0.001947754165

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436983217162
                                         uncertainty =       0.001947754165

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467425326
  error estimate for blocks of size 2^( 2) =       0.000493399820
  error estimate for blocks of size 2^( 3) =       0.000518095841
  error estimate for blocks of size 2^( 4) =       0.000535748943
  error estimate for blocks of size 2^( 5) =       0.000547468768
  error estimate for blocks of size 2^( 6) =       0.000554749047
  error estimate for blocks of size 2^( 7) =       0.000560490440

      target function =      -0.744090572133
              le_mean =     -22.814586212659
             les_mean =     520.956864320320
             stat err =       0.000549614300
             autocorr =       1.382584130702
   target nu stat err =       0.000549614300
   target dn stat err =       0.002937215289
      target stat err =       0.002501560217
              std dev =       0.661039235430
             le_variance =       0.436972870778

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436983217162
                                         uncertainty =       0.001947754165

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436983217162
                                         uncertainty =       0.001947754165

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467425326
  error estimate for blocks of size 2^( 2) =       0.000493399820
  error estimate for blocks of size 2^( 3) =       0.000518095841
  error estimate for blocks of size 2^( 4) =       0.000535748943
  error estimate for blocks of size 2^( 5) =       0.000547468768
  error estimate for blocks of size 2^( 6) =       0.000554749047
  error estimate for blocks of size 2^( 7) =       0.000560490440

      target function =      -0.744090572133
              le_mean =     -22.814586212659
             les_mean =     520.956864320320
             stat err =       0.000549614300
             autocorr =       1.382584130704
   target nu stat err =       0.000549614300
   target dn stat err =       0.002937215289
      target stat err =       0.002501560217
              std dev =       0.661039235430
             le_variance =       0.436972870778

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436983217162
                                         uncertainty =       0.001947754165

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436983217162
                                         uncertainty =       0.001947754165

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467425326
  error estimate for blocks of size 2^( 2) =       0.000493399820
  error estimate for blocks of size 2^( 3) =       0.000518095841
  error estimate for blocks of size 2^( 4) =       0.000535748943
  error estimate for blocks of size 2^( 5) =       0.000547468768
  error estimate for blocks of size 2^( 6) =       0.000554749047
  error estimate for blocks of size 2^( 7) =       0.000560490440

      target function =      -0.744090572133
              le_mean =     -22.814586212659
             les_mean =     520.956864320320
             stat err =       0.000549614300
             autocorr =       1.382584130704
   target nu stat err =       0.000549614300
   target dn stat err =       0.002937215289
      target stat err =       0.002501560217
              std dev =       0.661039235430
             le_variance =       0.436972870778

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436983217162
                                         uncertainty =       0.001947754165

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436983217162
                                         uncertainty =       0.001947754165

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467425326
  error estimate for blocks of size 2^( 2) =       0.000493399820
  error estimate for blocks of size 2^( 3) =       0.000518095841
  error estimate for blocks of size 2^( 4) =       0.000535748943
  error estimate for blocks of size 2^( 5) =       0.000547468768
  error estimate for blocks of size 2^( 6) =       0.000554749047
  error estimate for blocks of size 2^( 7) =       0.000560490440

      target function =      -0.744090572133
              le_mean =     -22.814586212659
             les_mean =     520.956864320320
             stat err =       0.000549614300
             autocorr =       1.382584130704
   target nu stat err =       0.000549614300
   target dn stat err =       0.002937215289
      target stat err =       0.002501560217
              std dev =       0.661039235430
             le_variance =       0.436972870778


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744090572133        initial  <--
     5.8208e+53     5.8208e+54             0.0000e+00        -0.744090572133
     2.3283e+54     2.3283e+55             0.0000e+00        -0.744090572133
     9.3132e+54     9.3132e+55             0.0000e+00        -0.744090572133

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.1903
  </log>
  <optVariables href="FORM2.s090.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3808e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s091 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s091 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=91  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2812e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 91
    time step          = 0.05
    reference energy   = -22.8367
    reference variance = 0.508667
====================================================
  Execution time = 2.5086e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s091
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5359e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4361e-01
  Total weights = 1.964715812e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5115e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433307378537
                                         uncertainty =       0.001545727059

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433307378537
                                         uncertainty =       0.001545727059

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465434446
  error estimate for blocks of size 2^( 2) =       0.000490890302
  error estimate for blocks of size 2^( 3) =       0.000515687845
  error estimate for blocks of size 2^( 4) =       0.000533704154
  error estimate for blocks of size 2^( 5) =       0.000545375739
  error estimate for blocks of size 2^( 6) =       0.000553725330
  error estimate for blocks of size 2^( 7) =       0.000559057886

      target function =      -0.750688490184
              le_mean =     -22.814829812995
             les_mean =     520.960067738017
             stat err =       0.000547965777
             autocorr =       1.386084886743
   target nu stat err =       0.000547965777
   target dn stat err =       0.002203517428
      target stat err =       0.001952135323
              std dev =       0.658223706076
             le_variance =       0.433258447240


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281482981300e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+54, overlap shift 5.8208e+55 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750692597905       residual = 2.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750692597905       residual = 3.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.750000000000       residual = 2.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+54 is 3.257822e-59

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+55, overlap shift 2.3283e+56 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750692597905       residual = 2.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750692597905       residual = 3.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.750692597905       residual = 2.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+55 is 8.144554e-60

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+55, overlap shift 9.3132e+56 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750692597905       residual = 2.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750692597905       residual = 3.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.750000000000       residual = 2.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+55 is 2.036138e-60

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.144421 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9604e+01
  </log>
  <optVariables href="FORM2.s091.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 91
    time step          = 0.05
    reference energy   = -22.8137
    reference variance = 0.350869
====================================================
  Execution time = 2.4430e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s091
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4942e-01
  Total weights = 1.9650e+06
  Execution time = 3.4813e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436443195724
                                         uncertainty =       0.002426249544

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436443195724
                                         uncertainty =       0.002426249544

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467166874
  error estimate for blocks of size 2^( 2) =       0.000492701453
  error estimate for blocks of size 2^( 3) =       0.000516894428
  error estimate for blocks of size 2^( 4) =       0.000535635435
  error estimate for blocks of size 2^( 5) =       0.000546633896
  error estimate for blocks of size 2^( 6) =       0.000552185053
  error estimate for blocks of size 2^( 7) =       0.000556639021

      target function =      -0.745824862104
              le_mean =     -22.814712672992
             les_mean =     520.960538987332
             stat err =       0.000547773351
             autocorr =       1.374857603298
   target nu stat err =       0.000547773351
   target dn stat err =       0.003029830820
      target stat err =       0.002587505700
              std dev =       0.660673729666
             le_variance =       0.436489777071

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436443195724
                                         uncertainty =       0.002426249544

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436443195724
                                         uncertainty =       0.002426249544

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467166874
  error estimate for blocks of size 2^( 2) =       0.000492701453
  error estimate for blocks of size 2^( 3) =       0.000516894428
  error estimate for blocks of size 2^( 4) =       0.000535635435
  error estimate for blocks of size 2^( 5) =       0.000546633896
  error estimate for blocks of size 2^( 6) =       0.000552185053
  error estimate for blocks of size 2^( 7) =       0.000556639021

      target function =      -0.745824862104
              le_mean =     -22.814712672992
             les_mean =     520.960538987332
             stat err =       0.000547773351
             autocorr =       1.374857603298
   target nu stat err =       0.000547773351
   target dn stat err =       0.003029830820
      target stat err =       0.002587505700
              std dev =       0.660673729666
             le_variance =       0.436489777071

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436443195724
                                         uncertainty =       0.002426249544

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436443195724
                                         uncertainty =       0.002426249544

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467166874
  error estimate for blocks of size 2^( 2) =       0.000492701453
  error estimate for blocks of size 2^( 3) =       0.000516894428
  error estimate for blocks of size 2^( 4) =       0.000535635435
  error estimate for blocks of size 2^( 5) =       0.000546633896
  error estimate for blocks of size 2^( 6) =       0.000552185053
  error estimate for blocks of size 2^( 7) =       0.000556639021

      target function =      -0.745824862104
              le_mean =     -22.814712672992
             les_mean =     520.960538987332
             stat err =       0.000547773351
             autocorr =       1.374857603298
   target nu stat err =       0.000547773351
   target dn stat err =       0.003029830820
      target stat err =       0.002587505700
              std dev =       0.660673729666
             le_variance =       0.436489777071

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436443195724
                                         uncertainty =       0.002426249544

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436443195724
                                         uncertainty =       0.002426249544

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467166874
  error estimate for blocks of size 2^( 2) =       0.000492701453
  error estimate for blocks of size 2^( 3) =       0.000516894428
  error estimate for blocks of size 2^( 4) =       0.000535635435
  error estimate for blocks of size 2^( 5) =       0.000546633896
  error estimate for blocks of size 2^( 6) =       0.000552185053
  error estimate for blocks of size 2^( 7) =       0.000556639021

      target function =      -0.745824862104
              le_mean =     -22.814712672992
             les_mean =     520.960538987332
             stat err =       0.000547773351
             autocorr =       1.374857603298
   target nu stat err =       0.000547773351
   target dn stat err =       0.003029830820
      target stat err =       0.002587505700
              std dev =       0.660673729666
             le_variance =       0.436489777071


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745824862104        initial  <--
     5.8208e+54     5.8208e+55             3.2578e-59        -0.745824862104
     2.3283e+55     2.3283e+56             8.1446e-60        -0.745824862104
     9.3132e+55     9.3132e+56             2.0361e-60        -0.745824862104

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 41.8741
  </log>
  <optVariables href="FORM2.s091.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.1486e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s092 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s092 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=92  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2812e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 92
    time step          = 0.05
    reference energy   = -22.7402
    reference variance = 0.331345
====================================================
  Execution time = 2.5233e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s092
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5367e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4386e-01
  Total weights = 1.964831769e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4967e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433217454580
                                         uncertainty =       0.001947436243

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433217454580
                                         uncertainty =       0.001947436243

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465477428
  error estimate for blocks of size 2^( 2) =       0.000491328127
  error estimate for blocks of size 2^( 3) =       0.000516004958
  error estimate for blocks of size 2^( 4) =       0.000534959254
  error estimate for blocks of size 2^( 5) =       0.000547156503
  error estimate for blocks of size 2^( 6) =       0.000554119093
  error estimate for blocks of size 2^( 7) =       0.000560594447

      target function =      -0.750470411072
              le_mean =     -22.814120265932
             les_mean =     520.927944749139
             stat err =       0.000549207324
             autocorr =       1.392115882157
   target nu stat err =       0.000549207324
   target dn stat err =       0.002326629418
      target stat err =       0.002047787405
              std dev =       0.658284492146
             le_variance =       0.433338472599


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281412026593e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+55, overlap shift 5.8208e+56 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750474956121       residual = 2.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750474956121       residual = 2.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+55 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+56, overlap shift 2.3283e+57 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750474956121       residual = 2.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750474956121       residual = 2.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+56 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+56, overlap shift 9.3132e+57 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750474956121       residual = 2.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750474956121       residual = 2.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+56 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.145569 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9736e+01
  </log>
  <optVariables href="FORM2.s092.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 92
    time step          = 0.05
    reference energy   = -22.8486
    reference variance = 0.422098
====================================================
  Execution time = 2.5132e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s092
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4773e-01
  Total weights = 1.9645e+06
  Execution time = 3.5122e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434520227167
                                         uncertainty =       0.002220975982

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434520227167
                                         uncertainty =       0.002220975982

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466094154
  error estimate for blocks of size 2^( 2) =       0.000491287869
  error estimate for blocks of size 2^( 3) =       0.000515486423
  error estimate for blocks of size 2^( 4) =       0.000533733710
  error estimate for blocks of size 2^( 5) =       0.000546137656
  error estimate for blocks of size 2^( 6) =       0.000553561015
  error estimate for blocks of size 2^( 7) =       0.000555431121

      target function =      -0.747228766671
              le_mean =     -22.814608113902
             les_mean =     520.954074021269
             stat err =       0.000547215875
             autocorr =       1.378383500733
   target nu stat err =       0.000547215875
   target dn stat err =       0.003738122427
      target stat err =       0.003172954775
              std dev =       0.659156673288
             le_variance =       0.434487519940

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434520227167
                                         uncertainty =       0.002220975982

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434520227167
                                         uncertainty =       0.002220975982

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466094154
  error estimate for blocks of size 2^( 2) =       0.000491287869
  error estimate for blocks of size 2^( 3) =       0.000515486423
  error estimate for blocks of size 2^( 4) =       0.000533733710
  error estimate for blocks of size 2^( 5) =       0.000546137656
  error estimate for blocks of size 2^( 6) =       0.000553561015
  error estimate for blocks of size 2^( 7) =       0.000555431121

      target function =      -0.747228766671
              le_mean =     -22.814608113902
             les_mean =     520.954074021269
             stat err =       0.000547215875
             autocorr =       1.378383500733
   target nu stat err =       0.000547215875
   target dn stat err =       0.003738122427
      target stat err =       0.003172954775
              std dev =       0.659156673288
             le_variance =       0.434487519940

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434520227167
                                         uncertainty =       0.002220975982

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434520227167
                                         uncertainty =       0.002220975982

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466094154
  error estimate for blocks of size 2^( 2) =       0.000491287869
  error estimate for blocks of size 2^( 3) =       0.000515486423
  error estimate for blocks of size 2^( 4) =       0.000533733710
  error estimate for blocks of size 2^( 5) =       0.000546137656
  error estimate for blocks of size 2^( 6) =       0.000553561015
  error estimate for blocks of size 2^( 7) =       0.000555431121

      target function =      -0.747228766671
              le_mean =     -22.814608113902
             les_mean =     520.954074021269
             stat err =       0.000547215875
             autocorr =       1.378383500733
   target nu stat err =       0.000547215875
   target dn stat err =       0.003738122427
      target stat err =       0.003172954775
              std dev =       0.659156673288
             le_variance =       0.434487519940

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434520227167
                                         uncertainty =       0.002220975982

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434520227167
                                         uncertainty =       0.002220975982

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466094154
  error estimate for blocks of size 2^( 2) =       0.000491287869
  error estimate for blocks of size 2^( 3) =       0.000515486423
  error estimate for blocks of size 2^( 4) =       0.000533733710
  error estimate for blocks of size 2^( 5) =       0.000546137656
  error estimate for blocks of size 2^( 6) =       0.000553561015
  error estimate for blocks of size 2^( 7) =       0.000555431121

      target function =      -0.747228766671
              le_mean =     -22.814608113902
             les_mean =     520.954074021269
             stat err =       0.000547215875
             autocorr =       1.378383500733
   target nu stat err =       0.000547215875
   target dn stat err =       0.003738122427
      target stat err =       0.003172954775
              std dev =       0.659156673288
             le_variance =       0.434487519940


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747228766671        initial  <--
     5.8208e+55     5.8208e+56             0.0000e+00        -0.747228766671
     2.3283e+56     2.3283e+57             0.0000e+00        -0.747228766671
     9.3132e+56     9.3132e+57             0.0000e+00        -0.747228766671

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.6055
  </log>
  <optVariables href="FORM2.s092.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5552e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s093 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s093 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=93  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2812e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 93
    time step          = 0.05
    reference energy   = -22.7873
    reference variance = 0.30887
====================================================
  Execution time = 2.5091e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s093
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5351e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4873e-01
  Total weights = 1.964567098e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.4954e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437332339217
                                         uncertainty =       0.002259189766

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437332339217
                                         uncertainty =       0.002259189766

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467588595
  error estimate for blocks of size 2^( 2) =       0.000493277401
  error estimate for blocks of size 2^( 3) =       0.000517479634
  error estimate for blocks of size 2^( 4) =       0.000535983828
  error estimate for blocks of size 2^( 5) =       0.000546960586
  error estimate for blocks of size 2^( 6) =       0.000554272572
  error estimate for blocks of size 2^( 7) =       0.000559479780

      target function =      -0.746403630820
              le_mean =     -22.814639199523
             les_mean =     520.956492296000
             stat err =       0.000549174192
             autocorr =       1.379406980027
   target nu stat err =       0.000549174192
   target dn stat err =       0.002603674459
      target stat err =       0.002248837531
              std dev =       0.661270132789
             le_variance =       0.437278188519


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281463919952e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+56, overlap shift 5.8208e+57 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746409445113       residual = 1.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746409445113       residual = 1.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+56 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+57, overlap shift 2.3283e+58 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746409445113       residual = 1.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746409445113       residual = 1.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+57 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+57, overlap shift 9.3132e+58 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746409445113       residual = 1.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746409445113       residual = 1.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+57 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.146710 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9593e+01
  </log>
  <optVariables href="FORM2.s093.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 93
    time step          = 0.05
    reference energy   = -22.7952
    reference variance = 0.269657
====================================================
  Execution time = 2.4424e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s093
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.4747e-01
  Total weights = 1.9648e+06
  Execution time = 3.4875e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436018586390
                                         uncertainty =       0.001843654392

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436018586390
                                         uncertainty =       0.001843654392

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466905345
  error estimate for blocks of size 2^( 2) =       0.000492740621
  error estimate for blocks of size 2^( 3) =       0.000517207515
  error estimate for blocks of size 2^( 4) =       0.000535707112
  error estimate for blocks of size 2^( 5) =       0.000547894342
  error estimate for blocks of size 2^( 6) =       0.000554343971
  error estimate for blocks of size 2^( 7) =       0.000559764749

      target function =      -0.747454261070
              le_mean =     -22.814912132184
             les_mean =     520.967685936602
             stat err =       0.000549427544
             autocorr =       1.384723821163
   target nu stat err =       0.000549427544
   target dn stat err =       0.002328201679
      target stat err =       0.002035825671
              std dev =       0.660303871319
             le_variance =       0.436001202479

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436018586390
                                         uncertainty =       0.001843654392

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436018586390
                                         uncertainty =       0.001843654392

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466905345
  error estimate for blocks of size 2^( 2) =       0.000492740621
  error estimate for blocks of size 2^( 3) =       0.000517207515
  error estimate for blocks of size 2^( 4) =       0.000535707112
  error estimate for blocks of size 2^( 5) =       0.000547894342
  error estimate for blocks of size 2^( 6) =       0.000554343971
  error estimate for blocks of size 2^( 7) =       0.000559764749

      target function =      -0.747454261070
              le_mean =     -22.814912132184
             les_mean =     520.967685936602
             stat err =       0.000549427544
             autocorr =       1.384723821163
   target nu stat err =       0.000549427544
   target dn stat err =       0.002328201679
      target stat err =       0.002035825671
              std dev =       0.660303871319
             le_variance =       0.436001202479

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436018586390
                                         uncertainty =       0.001843654392

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436018586390
                                         uncertainty =       0.001843654392

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466905345
  error estimate for blocks of size 2^( 2) =       0.000492740621
  error estimate for blocks of size 2^( 3) =       0.000517207515
  error estimate for blocks of size 2^( 4) =       0.000535707112
  error estimate for blocks of size 2^( 5) =       0.000547894342
  error estimate for blocks of size 2^( 6) =       0.000554343971
  error estimate for blocks of size 2^( 7) =       0.000559764749

      target function =      -0.747454261070
              le_mean =     -22.814912132184
             les_mean =     520.967685936602
             stat err =       0.000549427544
             autocorr =       1.384723821163
   target nu stat err =       0.000549427544
   target dn stat err =       0.002328201679
      target stat err =       0.002035825671
              std dev =       0.660303871319
             le_variance =       0.436001202479

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436018586390
                                         uncertainty =       0.001843654392

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436018586390
                                         uncertainty =       0.001843654392

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466905345
  error estimate for blocks of size 2^( 2) =       0.000492740621
  error estimate for blocks of size 2^( 3) =       0.000517207515
  error estimate for blocks of size 2^( 4) =       0.000535707112
  error estimate for blocks of size 2^( 5) =       0.000547894342
  error estimate for blocks of size 2^( 6) =       0.000554343971
  error estimate for blocks of size 2^( 7) =       0.000559764749

      target function =      -0.747454261070
              le_mean =     -22.814912132184
             les_mean =     520.967685936602
             stat err =       0.000549427544
             autocorr =       1.384723821163
   target nu stat err =       0.000549427544
   target dn stat err =       0.002328201679
      target stat err =       0.002035825671
              std dev =       0.660303871319
             le_variance =       0.436001202479


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747454261070        initial  <--
     5.8208e+56     5.8208e+57             0.0000e+00        -0.747454261070
     2.3283e+57     2.3283e+58             0.0000e+00        -0.747454261070
     9.3132e+57     9.3132e+58             0.0000e+00        -0.747454261070

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 41.8693
  </log>
  <optVariables href="FORM2.s093.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.1469e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s094 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s094 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=94  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2812e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 94
    time step          = 0.05
    reference energy   = -22.9024
    reference variance = 0.405496
====================================================
  Execution time = 2.5228e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s094
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5336e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4647e-01
  Total weights = 1.964864310e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5318e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435060977972
                                         uncertainty =       0.001968173096

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435060977972
                                         uncertainty =       0.001968173096

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466378726
  error estimate for blocks of size 2^( 2) =       0.000492054687
  error estimate for blocks of size 2^( 3) =       0.000516553192
  error estimate for blocks of size 2^( 4) =       0.000534992734
  error estimate for blocks of size 2^( 5) =       0.000545629065
  error estimate for blocks of size 2^( 6) =       0.000551981539
  error estimate for blocks of size 2^( 7) =       0.000558250810

      target function =      -0.748288419973
              le_mean =     -22.813921785335
             les_mean =     520.921494432382
             stat err =       0.000547713537
             autocorr =       1.379207107502
   target nu stat err =       0.000547713537
   target dn stat err =       0.002206204822
      target stat err =       0.001939702608
              std dev =       0.659559118899
             le_variance =       0.435018231323


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281392178534e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+57, overlap shift 5.8208e+58 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748292437408       residual = 2.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748292437408       residual = 2.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+57 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+58, overlap shift 2.3283e+59 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748292437408       residual = 2.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748292437408       residual = 2.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+58 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+58, overlap shift 9.3132e+59 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748292437408       residual = 2.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748292437408       residual = 2.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+58 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.147849 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9766e+01
  </log>
  <optVariables href="FORM2.s094.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 94
    time step          = 0.05
    reference energy   = -22.8287
    reference variance = 0.521713
====================================================
  Execution time = 2.4624e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s094
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5486e-01
  Total weights = 1.9648e+06
  Execution time = 3.5126e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439302280082
                                         uncertainty =       0.002294024111

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439302280082
                                         uncertainty =       0.002294024111

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468682714
  error estimate for blocks of size 2^( 2) =       0.000494626722
  error estimate for blocks of size 2^( 3) =       0.000518645140
  error estimate for blocks of size 2^( 4) =       0.000536571493
  error estimate for blocks of size 2^( 5) =       0.000549190230
  error estimate for blocks of size 2^( 6) =       0.000553588496
  error estimate for blocks of size 2^( 7) =       0.000553752403

      target function =      -0.741336671197
              le_mean =     -22.814460929635
             les_mean =     520.954488804788
             stat err =       0.000548275656
             autocorr =       1.368485038133
   target nu stat err =       0.000548275656
   target dn stat err =       0.003824107603
      target stat err =       0.003192748375
              std dev =       0.662817450615
             le_variance =       0.439326972840

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439302280082
                                         uncertainty =       0.002294024111

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439302280082
                                         uncertainty =       0.002294024111

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468682714
  error estimate for blocks of size 2^( 2) =       0.000494626722
  error estimate for blocks of size 2^( 3) =       0.000518645140
  error estimate for blocks of size 2^( 4) =       0.000536571493
  error estimate for blocks of size 2^( 5) =       0.000549190230
  error estimate for blocks of size 2^( 6) =       0.000553588496
  error estimate for blocks of size 2^( 7) =       0.000553752403

      target function =      -0.741336671197
              le_mean =     -22.814460929635
             les_mean =     520.954488804788
             stat err =       0.000548275656
             autocorr =       1.368485038134
   target nu stat err =       0.000548275656
   target dn stat err =       0.003824107603
      target stat err =       0.003192748375
              std dev =       0.662817450615
             le_variance =       0.439326972840

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439302280082
                                         uncertainty =       0.002294024111

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439302280082
                                         uncertainty =       0.002294024111

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468682714
  error estimate for blocks of size 2^( 2) =       0.000494626722
  error estimate for blocks of size 2^( 3) =       0.000518645140
  error estimate for blocks of size 2^( 4) =       0.000536571493
  error estimate for blocks of size 2^( 5) =       0.000549190230
  error estimate for blocks of size 2^( 6) =       0.000553588496
  error estimate for blocks of size 2^( 7) =       0.000553752403

      target function =      -0.741336671197
              le_mean =     -22.814460929635
             les_mean =     520.954488804788
             stat err =       0.000548275656
             autocorr =       1.368485038134
   target nu stat err =       0.000548275656
   target dn stat err =       0.003824107603
      target stat err =       0.003192748375
              std dev =       0.662817450615
             le_variance =       0.439326972840

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439302280082
                                         uncertainty =       0.002294024111

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439302280082
                                         uncertainty =       0.002294024111

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468682714
  error estimate for blocks of size 2^( 2) =       0.000494626722
  error estimate for blocks of size 2^( 3) =       0.000518645140
  error estimate for blocks of size 2^( 4) =       0.000536571493
  error estimate for blocks of size 2^( 5) =       0.000549190230
  error estimate for blocks of size 2^( 6) =       0.000553588496
  error estimate for blocks of size 2^( 7) =       0.000553752403

      target function =      -0.741336671197
              le_mean =     -22.814460929635
             les_mean =     520.954488804788
             stat err =       0.000548275656
             autocorr =       1.368485038134
   target nu stat err =       0.000548275656
   target dn stat err =       0.003824107603
      target stat err =       0.003192748375
              std dev =       0.662817450615
             le_variance =       0.439326972840


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.741336671197        initial  <--
     5.8208e+57     5.8208e+58             0.0000e+00        -0.741336671197
     2.3283e+58     2.3283e+59             0.0000e+00        -0.741336671197
     9.3132e+58     9.3132e+59             0.0000e+00        -0.741336671197

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.1626
  </log>
  <optVariables href="FORM2.s094.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4935e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s095 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s095 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=95  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2813e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 95
    time step          = 0.05
    reference energy   = -22.8054
    reference variance = 0.402571
====================================================
  Execution time = 2.5139e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s095
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5347e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4972e-01
  Total weights = 1.964804127e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5308e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436214556119
                                         uncertainty =       0.002066098042

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436214556119
                                         uncertainty =       0.002066098042

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467031478
  error estimate for blocks of size 2^( 2) =       0.000492656608
  error estimate for blocks of size 2^( 3) =       0.000517345920
  error estimate for blocks of size 2^( 4) =       0.000534979627
  error estimate for blocks of size 2^( 5) =       0.000547379878
  error estimate for blocks of size 2^( 6) =       0.000553429004
  error estimate for blocks of size 2^( 7) =       0.000558539542

      target function =      -0.745576093371
              le_mean =     -22.814188032739
             les_mean =     520.936893513827
             stat err =       0.000548582013
             autocorr =       1.379719562736
   target nu stat err =       0.000548582013
   target dn stat err =       0.003906335574
      target stat err =       0.003294409154
              std dev =       0.660482249703
             le_variance =       0.436236802172


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281418803274e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+58, overlap shift 5.8208e+59 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745589691282       residual = 1.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745589691282       residual = 1.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+58 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+59, overlap shift 2.3283e+60 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745589691282       residual = 1.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745589691282       residual = 1.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+59 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+59, overlap shift 9.3132e+60 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745589691282       residual = 1.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745589691282       residual = 1.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+59 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.148991 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9679e+01
  </log>
  <optVariables href="FORM2.s095.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 95
    time step          = 0.05
    reference energy   = -22.788
    reference variance = 0.325545
====================================================
  Execution time = 2.4530e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s095
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2813e+01
  VMC Evar = 4.5075e-01
  Total weights = 1.9650e+06
  Execution time = 3.4845e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438590466418
                                         uncertainty =       0.003772560299

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438590466418
                                         uncertainty =       0.003772560299

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468227416
  error estimate for blocks of size 2^( 2) =       0.000493340531
  error estimate for blocks of size 2^( 3) =       0.000517512911
  error estimate for blocks of size 2^( 4) =       0.000535749593
  error estimate for blocks of size 2^( 5) =       0.000547576242
  error estimate for blocks of size 2^( 6) =       0.000553422709
  error estimate for blocks of size 2^( 7) =       0.000559274836

      target function =      -0.744720093833
              le_mean =     -22.813329262755
             les_mean =     520.898741833490
             stat err =       0.000549005845
             autocorr =       1.374802324829
   target nu stat err =       0.000549005845
   target dn stat err =       0.004229126910
      target stat err =       0.003545160099
              std dev =       0.662173562006
             le_variance =       0.438473826219

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438590466418
                                         uncertainty =       0.003772560299

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438590466418
                                         uncertainty =       0.003772560299

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468227416
  error estimate for blocks of size 2^( 2) =       0.000493340531
  error estimate for blocks of size 2^( 3) =       0.000517512911
  error estimate for blocks of size 2^( 4) =       0.000535749593
  error estimate for blocks of size 2^( 5) =       0.000547576242
  error estimate for blocks of size 2^( 6) =       0.000553422709
  error estimate for blocks of size 2^( 7) =       0.000559274836

      target function =      -0.744720093833
              le_mean =     -22.813329262755
             les_mean =     520.898741833490
             stat err =       0.000549005845
             autocorr =       1.374802324829
   target nu stat err =       0.000549005845
   target dn stat err =       0.004229126910
      target stat err =       0.003545160099
              std dev =       0.662173562006
             le_variance =       0.438473826219

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438590466418
                                         uncertainty =       0.003772560299

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438590466418
                                         uncertainty =       0.003772560299

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468227416
  error estimate for blocks of size 2^( 2) =       0.000493340531
  error estimate for blocks of size 2^( 3) =       0.000517512911
  error estimate for blocks of size 2^( 4) =       0.000535749593
  error estimate for blocks of size 2^( 5) =       0.000547576242
  error estimate for blocks of size 2^( 6) =       0.000553422709
  error estimate for blocks of size 2^( 7) =       0.000559274836

      target function =      -0.744720093833
              le_mean =     -22.813329262755
             les_mean =     520.898741833490
             stat err =       0.000549005845
             autocorr =       1.374802324829
   target nu stat err =       0.000549005845
   target dn stat err =       0.004229126910
      target stat err =       0.003545160099
              std dev =       0.662173562006
             le_variance =       0.438473826219

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438590466418
                                         uncertainty =       0.003772560299

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438590466418
                                         uncertainty =       0.003772560299

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468227416
  error estimate for blocks of size 2^( 2) =       0.000493340531
  error estimate for blocks of size 2^( 3) =       0.000517512911
  error estimate for blocks of size 2^( 4) =       0.000535749593
  error estimate for blocks of size 2^( 5) =       0.000547576242
  error estimate for blocks of size 2^( 6) =       0.000553422709
  error estimate for blocks of size 2^( 7) =       0.000559274836

      target function =      -0.744720093833
              le_mean =     -22.813329262755
             les_mean =     520.898741833490
             stat err =       0.000549005845
             autocorr =       1.374802324829
   target nu stat err =       0.000549005845
   target dn stat err =       0.004229126910
      target stat err =       0.003545160099
              std dev =       0.662173562006
             le_variance =       0.438473826219


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744720093833        initial  <--
     5.8208e+58     5.8208e+59             0.0000e+00        -0.744720093833
     2.3283e+59     2.3283e+60             0.0000e+00        -0.744720093833
     9.3132e+59     9.3132e+60             0.0000e+00        -0.744720093833

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 41.9757
  </log>
  <optVariables href="FORM2.s095.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.1671e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s096 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s096 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=96  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2812e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 96
    time step          = 0.05
    reference energy   = -22.7568
    reference variance = 0.30753
====================================================
  Execution time = 2.5140e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s096
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5336e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5850e-01
  Total weights = 1.964718569e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5196e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438161024469
                                         uncertainty =       0.002726054792

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438161024469
                                         uncertainty =       0.002726054792

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468027048
  error estimate for blocks of size 2^( 2) =       0.000493738434
  error estimate for blocks of size 2^( 3) =       0.000518019561
  error estimate for blocks of size 2^( 4) =       0.000536197545
  error estimate for blocks of size 2^( 5) =       0.000548524437
  error estimate for blocks of size 2^( 6) =       0.000555772199
  error estimate for blocks of size 2^( 7) =       0.000558483986

      target function =      -0.738322011689
              le_mean =     -22.814202902556
             les_mean =     520.946357670450
             stat err =       0.000549744542
             autocorr =       1.379685011722
   target nu stat err =       0.000549744542
   target dn stat err =       0.008000268080
      target stat err =       0.006530666380
              std dev =       0.661890199443
             le_variance =       0.438098636119


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281420290256e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+59, overlap shift 5.8208e+60 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.738378460511       residual = 3.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.738378460511       residual = 3.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+59 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+60, overlap shift 2.3283e+61 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.738378460511       residual = 3.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.738378460511       residual = 3.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+60 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+60, overlap shift 9.3132e+61 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.738378460511       residual = 3.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.738378460511       residual = 3.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+60 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.150168 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9666e+01
  </log>
  <optVariables href="FORM2.s096.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 96
    time step          = 0.05
    reference energy   = -22.8475
    reference variance = 0.229806
====================================================
  Execution time = 2.4594e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s096
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4697e-01
  Total weights = 1.9648e+06
  Execution time = 3.4970e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435427966815
                                         uncertainty =       0.002070914311

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435427966815
                                         uncertainty =       0.002070914311

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466617825
  error estimate for blocks of size 2^( 2) =       0.000492558686
  error estimate for blocks of size 2^( 3) =       0.000516599750
  error estimate for blocks of size 2^( 4) =       0.000534986350
  error estimate for blocks of size 2^( 5) =       0.000545883843
  error estimate for blocks of size 2^( 6) =       0.000554961427
  error estimate for blocks of size 2^( 7) =       0.000559687016

      target function =      -0.747866209527
              le_mean =     -22.814288346193
             les_mean =     520.938725970081
             stat err =       0.000548879659
             autocorr =       1.383667128179
   target nu stat err =       0.000548879659
   target dn stat err =       0.002566922251
      target stat err =       0.002226576502
              std dev =       0.659897256076
             le_variance =       0.435464388577

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435427966815
                                         uncertainty =       0.002070914311

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435427966815
                                         uncertainty =       0.002070914311

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466617825
  error estimate for blocks of size 2^( 2) =       0.000492558686
  error estimate for blocks of size 2^( 3) =       0.000516599750
  error estimate for blocks of size 2^( 4) =       0.000534986350
  error estimate for blocks of size 2^( 5) =       0.000545883843
  error estimate for blocks of size 2^( 6) =       0.000554961427
  error estimate for blocks of size 2^( 7) =       0.000559687016

      target function =      -0.747866209527
              le_mean =     -22.814288346193
             les_mean =     520.938725970081
             stat err =       0.000548879659
             autocorr =       1.383667128178
   target nu stat err =       0.000548879659
   target dn stat err =       0.002566922251
      target stat err =       0.002226576502
              std dev =       0.659897256076
             le_variance =       0.435464388577

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435427966815
                                         uncertainty =       0.002070914311

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435427966815
                                         uncertainty =       0.002070914311

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466617825
  error estimate for blocks of size 2^( 2) =       0.000492558686
  error estimate for blocks of size 2^( 3) =       0.000516599750
  error estimate for blocks of size 2^( 4) =       0.000534986350
  error estimate for blocks of size 2^( 5) =       0.000545883843
  error estimate for blocks of size 2^( 6) =       0.000554961427
  error estimate for blocks of size 2^( 7) =       0.000559687016

      target function =      -0.747866209527
              le_mean =     -22.814288346193
             les_mean =     520.938725970081
             stat err =       0.000548879659
             autocorr =       1.383667128178
   target nu stat err =       0.000548879659
   target dn stat err =       0.002566922251
      target stat err =       0.002226576502
              std dev =       0.659897256076
             le_variance =       0.435464388577

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435427966815
                                         uncertainty =       0.002070914311

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435427966815
                                         uncertainty =       0.002070914311

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466617825
  error estimate for blocks of size 2^( 2) =       0.000492558686
  error estimate for blocks of size 2^( 3) =       0.000516599750
  error estimate for blocks of size 2^( 4) =       0.000534986350
  error estimate for blocks of size 2^( 5) =       0.000545883843
  error estimate for blocks of size 2^( 6) =       0.000554961427
  error estimate for blocks of size 2^( 7) =       0.000559687016

      target function =      -0.747866209527
              le_mean =     -22.814288346193
             les_mean =     520.938725970081
             stat err =       0.000548879659
             autocorr =       1.383667128178
   target nu stat err =       0.000548879659
   target dn stat err =       0.002566922251
      target stat err =       0.002226576502
              std dev =       0.659897256076
             le_variance =       0.435464388577


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747866209527        initial  <--
     5.8208e+59     5.8208e+60             0.0000e+00        -0.747866209527
     2.3283e+60     2.3283e+61             0.0000e+00        -0.747866209527
     9.3132e+60     9.3132e+61             0.0000e+00        -0.747866209527

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.3102
  </log>
  <optVariables href="FORM2.s096.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4982e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s097 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s097 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=97  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2812e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 97
    time step          = 0.05
    reference energy   = -22.793
    reference variance = 0.356433
====================================================
  Execution time = 2.5228e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s097
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5356e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4960e-01
  Total weights = 1.964917802e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5248e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437022234174
                                         uncertainty =       0.002309832408

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437022234174
                                         uncertainty =       0.002309832408

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467433221
  error estimate for blocks of size 2^( 2) =       0.000492839761
  error estimate for blocks of size 2^( 3) =       0.000517250563
  error estimate for blocks of size 2^( 4) =       0.000535681391
  error estimate for blocks of size 2^( 5) =       0.000546805197
  error estimate for blocks of size 2^( 6) =       0.000554338170
  error estimate for blocks of size 2^( 7) =       0.000558538253

      target function =      -0.745681139142
              le_mean =     -22.814459347366
             les_mean =     520.949153693838
             stat err =       0.000548840753
             autocorr =       1.378648496803
   target nu stat err =       0.000548840753
   target dn stat err =       0.002969068464
      target stat err =       0.002536897098
              std dev =       0.661050401244
             le_variance =       0.436987632984


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281445934737e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+60, overlap shift 5.8208e+61 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745688815601       residual = 1.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745688815601       residual = 2.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+60 is 2.956788e-65

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+61, overlap shift 2.3283e+62 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745688815601       residual = 1.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745688815601       residual = 2.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+61 is 7.391970e-66

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+61, overlap shift 9.3132e+62 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745688815601       residual = 1.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745688815601       residual = 2.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+61 is 1.847992e-66

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.151294 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9759e+01
  </log>
  <optVariables href="FORM2.s097.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 97
    time step          = 0.05
    reference energy   = -22.8279
    reference variance = 0.301518
====================================================
  Execution time = 2.4431e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s097
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5063e-01
  Total weights = 1.9648e+06
  Execution time = 3.4974e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436949988439
                                         uncertainty =       0.002466601604

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436949988439
                                         uncertainty =       0.002466601604

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467457162
  error estimate for blocks of size 2^( 2) =       0.000493070335
  error estimate for blocks of size 2^( 3) =       0.000517278169
  error estimate for blocks of size 2^( 4) =       0.000534583710
  error estimate for blocks of size 2^( 5) =       0.000548076577
  error estimate for blocks of size 2^( 6) =       0.000555832345
  error estimate for blocks of size 2^( 7) =       0.000557383448

      target function =      -0.744828600616
              le_mean =     -22.814488445176
             les_mean =     520.951509091670
             stat err =       0.000548969020
             autocorr =       1.379151695246
   target nu stat err =       0.000548969020
   target dn stat err =       0.003169138923
      target stat err =       0.002692388738
              std dev =       0.661084257749
             le_variance =       0.437032395844

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436949988439
                                         uncertainty =       0.002466601604

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436949988439
                                         uncertainty =       0.002466601604

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467457162
  error estimate for blocks of size 2^( 2) =       0.000493070335
  error estimate for blocks of size 2^( 3) =       0.000517278169
  error estimate for blocks of size 2^( 4) =       0.000534583710
  error estimate for blocks of size 2^( 5) =       0.000548076577
  error estimate for blocks of size 2^( 6) =       0.000555832345
  error estimate for blocks of size 2^( 7) =       0.000557383448

      target function =      -0.744828600616
              le_mean =     -22.814488445176
             les_mean =     520.951509091670
             stat err =       0.000548969020
             autocorr =       1.379151695245
   target nu stat err =       0.000548969020
   target dn stat err =       0.003169138923
      target stat err =       0.002692388738
              std dev =       0.661084257749
             le_variance =       0.437032395844

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436949988439
                                         uncertainty =       0.002466601604

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436949988439
                                         uncertainty =       0.002466601604

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467457162
  error estimate for blocks of size 2^( 2) =       0.000493070335
  error estimate for blocks of size 2^( 3) =       0.000517278169
  error estimate for blocks of size 2^( 4) =       0.000534583710
  error estimate for blocks of size 2^( 5) =       0.000548076577
  error estimate for blocks of size 2^( 6) =       0.000555832345
  error estimate for blocks of size 2^( 7) =       0.000557383448

      target function =      -0.744828600616
              le_mean =     -22.814488445176
             les_mean =     520.951509091670
             stat err =       0.000548969020
             autocorr =       1.379151695245
   target nu stat err =       0.000548969020
   target dn stat err =       0.003169138923
      target stat err =       0.002692388738
              std dev =       0.661084257749
             le_variance =       0.437032395844

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436949988439
                                         uncertainty =       0.002466601604

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436949988439
                                         uncertainty =       0.002466601604

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467457162
  error estimate for blocks of size 2^( 2) =       0.000493070335
  error estimate for blocks of size 2^( 3) =       0.000517278169
  error estimate for blocks of size 2^( 4) =       0.000534583710
  error estimate for blocks of size 2^( 5) =       0.000548076577
  error estimate for blocks of size 2^( 6) =       0.000555832345
  error estimate for blocks of size 2^( 7) =       0.000557383448

      target function =      -0.744828600616
              le_mean =     -22.814488445176
             les_mean =     520.951509091670
             stat err =       0.000548969020
             autocorr =       1.379151695245
   target nu stat err =       0.000548969020
   target dn stat err =       0.003169138923
      target stat err =       0.002692388738
              std dev =       0.661084257749
             le_variance =       0.437032395844


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744828600616        initial  <--
     5.8208e+60     5.8208e+61             2.9568e-65        -0.744828600616
     2.3283e+61     2.3283e+62             7.3920e-66        -0.744828600616
     9.3132e+61     9.3132e+62             1.8480e-66        -0.744828600616

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.0175
  </log>
  <optVariables href="FORM2.s097.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.1783e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s098 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s098 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=98  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2812e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 98
    time step          = 0.05
    reference energy   = -22.9193
    reference variance = 0.767431
====================================================
  Execution time = 2.5234e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s098
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5343e+04
  VMC Eavg = -2.2815e+01
  VMC Evar = 4.5174e-01
  Total weights = 1.964730845e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5175e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439035864135
                                         uncertainty =       0.002841009946

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439035864135
                                         uncertainty =       0.002841009946

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468532361
  error estimate for blocks of size 2^( 2) =       0.000494294442
  error estimate for blocks of size 2^( 3) =       0.000518776920
  error estimate for blocks of size 2^( 4) =       0.000537285546
  error estimate for blocks of size 2^( 5) =       0.000548287818
  error estimate for blocks of size 2^( 6) =       0.000554215347
  error estimate for blocks of size 2^( 7) =       0.000558482655

      target function =      -0.743903170667
              le_mean =     -22.814724114225
             les_mean =     520.963375246322
             stat err =       0.000549567842
             autocorr =       1.375825764198
   target nu stat err =       0.000549567842
   target dn stat err =       0.003944657679
      target stat err =       0.003313820327
              std dev =       0.662604819967
             le_variance =       0.439045147443


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281472411423e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+61, overlap shift 5.8208e+62 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743917068636       residual = 3.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743917068636       residual = 3.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743917068636       residual = 8.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743917068636       residual = 3.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743917068636       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743917067997       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743871019852       residual = 3.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    7 stopping due to too large eigenvalue change
davidson solver did not converge after          7 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+61 is 6.227465e-66

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+62, overlap shift 2.3283e+63 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743917068636       residual = 3.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743917068636       residual = 3.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743917068636       residual = 8.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743917068636       residual = 3.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743917060681       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743917068549       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741940852902       residual = 3.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =       5.516577405742       residual = 3.65e+01           smallest_sin_value = 1.00e+00
davidson iteration    8 stopping due to too large eigenvalue change
davidson solver did not converge after          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+62 is 1.527409e-66

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+62, overlap shift 9.3132e+63 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743917068636       residual = 3.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743917068636       residual = 3.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743917068636       residual = 8.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743917068636       residual = 3.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743917068636       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743917068524       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+62 is 3.818522e-67

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.154096 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9760e+01
  </log>
  <optVariables href="FORM2.s098.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 98
    time step          = 0.05
    reference energy   = -22.8355
    reference variance = 0.337664
====================================================
  Execution time = 2.4454e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s098
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.4806e-01
  Total weights = 1.9646e+06
  Execution time = 3.5066e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437471011317
                                         uncertainty =       0.002462930760

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437471011317
                                         uncertainty =       0.002462930760

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467693311
  error estimate for blocks of size 2^( 2) =       0.000493175850
  error estimate for blocks of size 2^( 3) =       0.000517506916
  error estimate for blocks of size 2^( 4) =       0.000535819119
  error estimate for blocks of size 2^( 5) =       0.000548385944
  error estimate for blocks of size 2^( 6) =       0.000555797043
  error estimate for blocks of size 2^( 7) =       0.000557723484

      target function =      -0.746954325813
              le_mean =     -22.814234020690
             les_mean =     520.937338886214
             stat err =       0.000549431398
             autocorr =       1.380081169137
   target nu stat err =       0.000549431398
   target dn stat err =       0.003038511024
      target stat err =       0.002600731324
              std dev =       0.661418223847
             le_variance =       0.437474066837

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437471011317
                                         uncertainty =       0.002462930760

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437471011317
                                         uncertainty =       0.002462930760

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467693311
  error estimate for blocks of size 2^( 2) =       0.000493175850
  error estimate for blocks of size 2^( 3) =       0.000517506916
  error estimate for blocks of size 2^( 4) =       0.000535819119
  error estimate for blocks of size 2^( 5) =       0.000548385944
  error estimate for blocks of size 2^( 6) =       0.000555797043
  error estimate for blocks of size 2^( 7) =       0.000557723484

      target function =      -0.746954325813
              le_mean =     -22.814234020690
             les_mean =     520.937338886214
             stat err =       0.000549431398
             autocorr =       1.380081169137
   target nu stat err =       0.000549431398
   target dn stat err =       0.003038511024
      target stat err =       0.002600731324
              std dev =       0.661418223847
             le_variance =       0.437474066837

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437471011317
                                         uncertainty =       0.002462930760

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437471011317
                                         uncertainty =       0.002462930760

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467693311
  error estimate for blocks of size 2^( 2) =       0.000493175850
  error estimate for blocks of size 2^( 3) =       0.000517506916
  error estimate for blocks of size 2^( 4) =       0.000535819119
  error estimate for blocks of size 2^( 5) =       0.000548385944
  error estimate for blocks of size 2^( 6) =       0.000555797043
  error estimate for blocks of size 2^( 7) =       0.000557723484

      target function =      -0.746954325813
              le_mean =     -22.814234020690
             les_mean =     520.937338886214
             stat err =       0.000549431398
             autocorr =       1.380081169137
   target nu stat err =       0.000549431398
   target dn stat err =       0.003038511024
      target stat err =       0.002600731324
              std dev =       0.661418223847
             le_variance =       0.437474066837

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437471011317
                                         uncertainty =       0.002462930760

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437471011317
                                         uncertainty =       0.002462930760

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467693311
  error estimate for blocks of size 2^( 2) =       0.000493175850
  error estimate for blocks of size 2^( 3) =       0.000517506916
  error estimate for blocks of size 2^( 4) =       0.000535819119
  error estimate for blocks of size 2^( 5) =       0.000548385944
  error estimate for blocks of size 2^( 6) =       0.000555797043
  error estimate for blocks of size 2^( 7) =       0.000557723484

      target function =      -0.746954325813
              le_mean =     -22.814234020690
             les_mean =     520.937338886214
             stat err =       0.000549431398
             autocorr =       1.380081169137
   target nu stat err =       0.000549431398
   target dn stat err =       0.003038511024
      target stat err =       0.002600731324
              std dev =       0.661418223847
             le_variance =       0.437474066837


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746954325813        initial  <--
     5.8208e+61     5.8208e+62             6.2275e-66        -0.746954325813
     2.3283e+62     2.3283e+63             1.5274e-66        -0.746954325813
     9.3132e+62     9.3132e+63             3.8185e-67        -0.746954325813

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 41.9905
  </log>
  <optVariables href="FORM2.s098.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.1768e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s099 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s099 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=99  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2813e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 99
    time step          = 0.05
    reference energy   = -22.694
    reference variance = 0.371533
====================================================
  Execution time = 2.7389e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s099
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5359e+04
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5197e-01
  Total weights = 1.964488564e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.5184e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437375028905
                                         uncertainty =       0.002229193716

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437375028905
                                         uncertainty =       0.002229193716

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467656444
  error estimate for blocks of size 2^( 2) =       0.000493664120
  error estimate for blocks of size 2^( 3) =       0.000518259343
  error estimate for blocks of size 2^( 4) =       0.000537204926
  error estimate for blocks of size 2^( 5) =       0.000548881222
  error estimate for blocks of size 2^( 6) =       0.000555551428
  error estimate for blocks of size 2^( 7) =       0.000560295212

      target function =      -0.743719146883
              le_mean =     -22.813778449895
             les_mean =     520.920456715449
             stat err =       0.000550483197
             autocorr =       1.385588557696
   target nu stat err =       0.000550483197
   target dn stat err =       0.003372202406
      target stat err =       0.002845347532
              std dev =       0.661366085441
             le_variance =       0.437405098972


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.281377844989e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+62, overlap shift 5.8208e+63 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743729120361       residual = 2.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743729120361       residual = 2.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+62 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+63, overlap shift 2.3283e+64 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743729120361       residual = 2.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743729120361       residual = 2.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+63 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+63, overlap shift 9.3132e+64 and omega -2.3485e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743729120361       residual = 2.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743729120361       residual = 2.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+63 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.155231 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1914e+01
  </log>
  <optVariables href="FORM2.s099.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 99
    time step          = 0.05
    reference energy   = -22.7573
    reference variance = 0.362212
====================================================
  Execution time = 2.4628e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s099
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2814e+01
  VMC Evar = 4.5896e-01
  Total weights = 1.9647e+06
  Execution time = 3.5110e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440617015107
                                         uncertainty =       0.003739705440

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440617015107
                                         uncertainty =       0.003739705440

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469391211
  error estimate for blocks of size 2^( 2) =       0.000494825581
  error estimate for blocks of size 2^( 3) =       0.000519047315
  error estimate for blocks of size 2^( 4) =       0.000537685246
  error estimate for blocks of size 2^( 5) =       0.000549862563
  error estimate for blocks of size 2^( 6) =       0.000557052734
  error estimate for blocks of size 2^( 7) =       0.000560463892

      target function =      -0.737973597166
              le_mean =     -22.813858043971
             les_mean =     520.931077855049
             stat err =       0.000551266109
             autocorr =       1.379280765227
   target nu stat err =       0.000551266109
   target dn stat err =       0.006586435655
      target stat err =       0.005379750948
              std dev =       0.663819416912
             le_variance =       0.440656218270

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440617015107
                                         uncertainty =       0.003739705440

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440617015107
                                         uncertainty =       0.003739705440

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469391211
  error estimate for blocks of size 2^( 2) =       0.000494825581
  error estimate for blocks of size 2^( 3) =       0.000519047315
  error estimate for blocks of size 2^( 4) =       0.000537685246
  error estimate for blocks of size 2^( 5) =       0.000549862563
  error estimate for blocks of size 2^( 6) =       0.000557052734
  error estimate for blocks of size 2^( 7) =       0.000560463892

      target function =      -0.737973597166
              le_mean =     -22.813858043971
             les_mean =     520.931077855049
             stat err =       0.000551266109
             autocorr =       1.379280765232
   target nu stat err =       0.000551266109
   target dn stat err =       0.006586435655
      target stat err =       0.005379750948
              std dev =       0.663819416912
             le_variance =       0.440656218270

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440617015107
                                         uncertainty =       0.003739705440

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440617015107
                                         uncertainty =       0.003739705440

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469391211
  error estimate for blocks of size 2^( 2) =       0.000494825581
  error estimate for blocks of size 2^( 3) =       0.000519047315
  error estimate for blocks of size 2^( 4) =       0.000537685246
  error estimate for blocks of size 2^( 5) =       0.000549862563
  error estimate for blocks of size 2^( 6) =       0.000557052734
  error estimate for blocks of size 2^( 7) =       0.000560463892

      target function =      -0.737973597166
              le_mean =     -22.813858043971
             les_mean =     520.931077855049
             stat err =       0.000551266109
             autocorr =       1.379280765232
   target nu stat err =       0.000551266109
   target dn stat err =       0.006586435655
      target stat err =       0.005379750948
              std dev =       0.663819416912
             le_variance =       0.440656218270

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440617015107
                                         uncertainty =       0.003739705440

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440617015107
                                         uncertainty =       0.003739705440

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469391211
  error estimate for blocks of size 2^( 2) =       0.000494825581
  error estimate for blocks of size 2^( 3) =       0.000519047315
  error estimate for blocks of size 2^( 4) =       0.000537685246
  error estimate for blocks of size 2^( 5) =       0.000549862563
  error estimate for blocks of size 2^( 6) =       0.000557052734
  error estimate for blocks of size 2^( 7) =       0.000560463892

      target function =      -0.737973597166
              le_mean =     -22.813858043971
             les_mean =     520.931077855049
             stat err =       0.000551266109
             autocorr =       1.379280765232
   target nu stat err =       0.000551266109
   target dn stat err =       0.006586435655
      target stat err =       0.005379750948
              std dev =       0.663819416912
             le_variance =       0.440656218270


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.737973597166        initial  <--
     5.8208e+62     5.8208e+63             0.0000e+00        -0.737973597166
     2.3283e+63     2.3283e+64             0.0000e+00        -0.737973597166
     9.3132e+63     9.3132e+64             0.0000e+00        -0.737973597166

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 42.1866
  </log>
  <optVariables href="FORM2.s099.opt.xml">
ci_01                 1.086457e-01 3 1  ON 0
ci_02                -2.430069e-02 3 1  ON 1
ci_03                -2.454259e-02 3 1  ON 2
ci_04                 2.241723e-02 3 1  ON 3
ci_05                -1.919573e-02 3 1  ON 4
ci_06                -1.972848e-02 3 1  ON 5
ci_07                 2.582836e-02 3 1  ON 6
ci_08                -4.237790e-03 3 1  ON 7
ci_09                -7.571076e-03 3 1  ON 8
ci_10                -7.620435e-03 3 1  ON 9
ci_11                 1.374044e-02 3 1  ON 10
ci_12                 6.968724e-03 3 1  ON 11
ci_13                 1.379009e-02 3 1  ON 12
ci_14                 1.283313e-02 3 1  ON 13
ci_15                 5.313774e-03 3 1  ON 14
ci_16                 5.754240e-03 3 1  ON 15
ci_17                -5.096165e-03 3 1  ON 16
ci_18                -5.605402e-03 3 1  ON 17
ci_19                 1.024800e-02 3 1  ON 18
ci_20                 6.250717e-03 3 1  ON 19
ci_21                 8.485503e-03 3 1  ON 20
ci_22                 8.839749e-03 3 1  ON 21
ci_23                 4.202322e-03 3 1  ON 22
ci_24                 5.084343e-03 3 1  ON 23
ci_25                 2.980069e-03 3 1  ON 24
ci_26                 3.785795e-03 3 1  ON 25
ci_27                 3.331340e-03 3 1  ON 26
ci_28                 7.872389e-04 3 1  ON 27
ci_29                 1.174323e-03 3 1  ON 28
ci_30                -7.246627e-04 3 1  ON 29
ci_31                 1.001322e-03 3 1  ON 30
ci_32                -6.569576e-04 3 1  ON 31
ci_33                -1.040899e-03 3 1  ON 32
ci_34                 1.204367e-03 3 1  ON 33
ci_35                 1.322335e-03 3 1  ON 34
ci_36                -6.185565e-04 3 1  ON 35
ci_37                -5.412163e-04 3 1  ON 36
ci_38                -2.597115e-04 3 1  ON 37
ci_39                -1.577525e-04 3 1  ON 38
ci_40                -1.841475e-03 3 1  ON 39
ci_41                -5.607322e-04 3 1  ON 40
ci_42                -1.608173e-03 3 1  ON 41
ci_43                -1.376329e-03 3 1  ON 42
ci_44                -2.230082e-03 3 1  ON 43
ci_45                -2.703699e-04 3 1  ON 44
ci_46                -1.593569e-03 3 1  ON 45
ci_47                 1.399358e-03 3 1  ON 46
ci_48                 2.889674e-03 3 1  ON 47
ci_49                -8.681694e-04 3 1  ON 48
ci_50                -7.822035e-04 3 1  ON 49
ci_51                -4.942082e-04 3 1  ON 50
ci_52                -5.953000e-04 3 1  ON 51
ci_53                -7.835993e-04 3 1  ON 52
ci_54                -1.101466e-03 3 1  ON 53
ci_55                -1.210924e-03 3 1  ON 54
ci_56                 1.132790e-03 3 1  ON 55
ci_57                 2.080342e-03 3 1  ON 56
ci_58                -2.645373e-04 3 1  ON 57
ci_59                -5.633216e-04 3 1  ON 58
ci_60                 7.417428e-05 3 1  ON 59
ci_61                -1.004318e-03 3 1  ON 60
ci_62                -3.909001e-04 3 1  ON 61
ci_63                -2.761674e-04 3 1  ON 62
ci_64                -5.992980e-04 3 1  ON 63
ci_65                -4.197960e-05 3 1  ON 64
ci_66                -1.519712e-04 3 1  ON 65
ci_67                -2.334992e-04 3 1  ON 66
ci_68                -1.705167e-03 3 1  ON 67
ci_69                -1.774669e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4105e+01 secs
  Total Execution time = 7.3176e+03 secs

=========================================================
  A new xml input file : FORM2.s099.cont.xml
