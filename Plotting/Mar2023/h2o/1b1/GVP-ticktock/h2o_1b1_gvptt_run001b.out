Rank =    0  Free Memory = 70800 MB
Rank =    1  Free Memory = 70800 MB
Rank =    2  Free Memory = 70800 MB
Rank =    3  Free Memory = 70800 MB
Rank =    4  Free Memory = 70800 MB
Rank =    5  Free Memory = 70800 MB
Rank =    6  Free Memory = 70800 MB
Rank =    7  Free Memory = 70800 MB
Rank =    8  Free Memory = 70800 MB
Rank =    9  Free Memory = 70799 MB
Rank =   10  Free Memory = 70799 MB
Rank =   11  Free Memory = 70799 MB
Rank =   12  Free Memory = 70798 MB
Rank =   13  Free Memory = 70798 MB
Rank =   14  Free Memory = 70798 MB
Rank =   15  Free Memory = 70785 MB
Rank =   16  Free Memory = 70784 MB
Rank =   17  Free Memory = 70784 MB
Rank =   18  Free Memory = 70783 MB
Rank =   19  Free Memory = 70783 MB
Rank =   20  Free Memory = 70783 MB
Rank =   21  Free Memory = 70783 MB
Rank =   22  Free Memory = 70783 MB
Rank =   23  Free Memory = 70783 MB
Rank =   24  Free Memory = 70783 MB
Rank =   25  Free Memory = 70783 MB
Rank =   26  Free Memory = 70783 MB
Rank =   27  Free Memory = 70783 MB
Rank =   28  Free Memory = 70783 MB
Rank =   29  Free Memory = 70783 MB
Rank =   30  Free Memory = 70783 MB
Rank =   31  Free Memory = 70783 MB
Rank =   32  Free Memory = 72770 MB
Rank =   33  Free Memory = 72770 MB
Rank =   34  Free Memory = 72770 MB
Rank =   35  Free Memory = 72770 MB
Rank =   36  Free Memory = 72770 MB
Rank =   37  Free Memory = 72770 MB
Rank =   38  Free Memory = 72770 MB
Rank =   39  Free Memory = 72770 MB
Rank =   40  Free Memory = 72770 MB
Rank =   41  Free Memory = 72770 MB
Rank =   42  Free Memory = 72770 MB
Rank =   43  Free Memory = 72770 MB
Rank =   44  Free Memory = 72770 MB
Rank =   45  Free Memory = 72770 MB
Rank =   46  Free Memory = 72770 MB
Rank =   47  Free Memory = 72770 MB
Rank =   48  Free Memory = 72770 MB
Rank =   49  Free Memory = 72770 MB
Rank =   50  Free Memory = 72770 MB
Rank =   51  Free Memory = 72770 MB
Rank =   52  Free Memory = 72770 MB
Rank =   53  Free Memory = 72770 MB
Rank =   54  Free Memory = 72770 MB
Rank =   55  Free Memory = 72770 MB
Rank =   56  Free Memory = 72770 MB
Rank =   57  Free Memory = 72770 MB
Rank =   58  Free Memory = 72770 MB
Rank =   59  Free Memory = 72770 MB
Rank =   60  Free Memory = 72770 MB
Rank =   61  Free Memory = 72770 MB
Rank =   62  Free Memory = 72770 MB
Rank =   63  Free Memory = 72770 MB
Rank =   64  Free Memory = 89405 MB
Rank =   65  Free Memory = 89405 MB
Rank =   66  Free Memory = 89405 MB
Rank =   67  Free Memory = 89405 MB
Rank =   68  Free Memory = 89405 MB
Rank =   69  Free Memory = 89405 MB
Rank =   70  Free Memory = 89405 MB
Rank =   71  Free Memory = 89405 MB
Rank =   72  Free Memory = 89405 MB
Rank =   73  Free Memory = 89405 MB
Rank =   74  Free Memory = 89404 MB
Rank =   75  Free Memory = 89404 MB
Rank =   76  Free Memory = 89404 MB
Rank =   77  Free Memory = 89404 MB
Rank =   78  Free Memory = 89404 MB
Rank =   79  Free Memory = 89404 MB
Rank =   80  Free Memory = 89404 MB
Rank =   81  Free Memory = 89404 MB
Rank =   82  Free Memory = 89404 MB
Rank =   83  Free Memory = 89404 MB
Rank =   84  Free Memory = 89404 MB
Rank =   85  Free Memory = 89404 MB
Rank =   86  Free Memory = 89404 MB
Rank =   87  Free Memory = 89404 MB
Rank =   88  Free Memory = 89404 MB
Rank =   89  Free Memory = 89404 MB
Rank =   90  Free Memory = 89404 MB
Rank =   91  Free Memory = 89404 MB
Rank =   92  Free Memory = 89404 MB
Rank =   93  Free Memory = 89404 MB
Rank =   94  Free Memory = 89404 MB
Rank =   95  Free Memory = 89404 MB
Rank =   96  Free Memory = 62584 MB
Rank =   97  Free Memory = 62584 MB
Rank =   98  Free Memory = 62584 MB
Rank =   99  Free Memory = 62584 MB
Rank =  100  Free Memory = 62584 MB
Rank =  101  Free Memory = 62584 MB
Rank =  102  Free Memory = 62584 MB
Rank =  103  Free Memory = 62584 MB
Rank =  104  Free Memory = 62584 MB
Rank =  105  Free Memory = 62583 MB
Rank =  106  Free Memory = 62583 MB
Rank =  107  Free Memory = 62583 MB
Rank =  108  Free Memory = 62583 MB
Rank =  109  Free Memory = 62583 MB
Rank =  110  Free Memory = 62583 MB
Rank =  111  Free Memory = 62583 MB
Rank =  112  Free Memory = 62583 MB
Rank =  113  Free Memory = 62583 MB
Rank =  114  Free Memory = 62582 MB
Rank =  115  Free Memory = 62582 MB
Rank =  116  Free Memory = 62582 MB
Rank =  117  Free Memory = 62582 MB
Rank =  118  Free Memory = 62582 MB
Rank =  119  Free Memory = 62582 MB
Rank =  120  Free Memory = 62582 MB
Rank =  121  Free Memory = 62582 MB
Rank =  122  Free Memory = 62582 MB
Rank =  123  Free Memory = 62582 MB
Rank =  124  Free Memory = 62582 MB
Rank =  125  Free Memory = 62582 MB
Rank =  126  Free Memory = 62582 MB
Rank =  127  Free Memory = 62582 MB
  Input file(s): opt_h2o_1b1_gvptt_run001b.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: a1d851bbe8d902a0d3168a885b757a378aeaab54-dirty
  Last git commit date: Mon Feb 13 11:52:39 2023 -0800
  Last git commit subject: Print param update magnitude and largest update
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_1b1_gvptt_run001b.xml

  Project = H2O
  date    = 2023-03-02 16:12:32 PST
  host    = n0082.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 880

  Range of prime numbers to use as seeds over processors and threads = 6857-8017


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 3.027108e-01    1         1  ON     0
     uu_1                 1.395499e-01    1         1  ON     1
     uu_2                 4.158458e-02    1         1  ON     2
     uu_3                -1.946409e-02    1         1  ON     3
     uu_4                -6.333239e-02    1         1  ON     4
     uu_5                -9.587524e-02    1         1  ON     5
     uu_6                -1.205706e-01    1         1  ON     6
     uu_7                -1.310580e-01    1         1  ON     7
     uu_8                -1.203232e-01    1         1  ON     8
     uu_9                -9.277332e-02    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 4.114416e-01    1         1  ON     0
     ud_1                 1.583401e-01    1         1  ON     1
     ud_2                 6.092685e-02    1         1  ON     2
     ud_3                 2.699750e-03    1         1  ON     3
     ud_4                -5.713986e-02    1         1  ON     4
     ud_5                -1.014997e-01    1         1  ON     5
     ud_6                -1.286687e-01    1         1  ON     6
     ud_7                -1.435029e-01    1         1  ON     7
     ud_8                -1.424319e-01    1         1  ON     8
     ud_9                -1.344547e-01    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.043100e-01    1         1  ON     0
     eO_1                -4.137154e-01    1         1  ON     1
     eO_2                -3.185752e-02    1         1  ON     2
     eO_3                 2.692030e-01    1         1  ON     3
     eO_4                 4.916456e-01    1         1  ON     4
     eO_5                 4.596091e-01    1         1  ON     5
     eO_6                 2.360353e-01    1         1  ON     6
     eO_7                -5.591968e-02    1         1  ON     7
     eO_8                -1.959242e-01    1         1  ON     8
     eO_9                -5.768884e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.099404e-01    1         1  ON     0
     eH1_1                -1.274877e-01    1         1  ON     1
     eH1_2                -8.838243e-02    1         1  ON     2
     eH1_3                -3.738645e-02    1         1  ON     3
     eH1_4                 1.159942e-02    1         1  ON     4
     eH1_5                 4.473069e-02    1         1  ON     5
     eH1_6                 9.476145e-02    1         1  ON     6
     eH1_7                 1.381756e-01    1         1  ON     7
     eH1_8                 1.456924e-01    1         1  ON     8
     eH1_9                 3.283823e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.088198e-01    1         1  ON     0
     eH2_1                -1.265485e-01    1         1  ON     1
     eH2_2                -8.741031e-02    1         1  ON     2
     eH2_3                -3.640778e-02    1         1  ON     3
     eH2_4                 1.289653e-02    1         1  ON     4
     eH2_5                 4.794967e-02    1         1  ON     5
     eH2_6                 1.006131e-01    1         1  ON     6
     eH2_7                 1.496008e-01    1         1  ON     7
     eH2_8                 1.537439e-01    1         1  ON     8
     eH2_9                 1.292423e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 75 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 1.670104e+00
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 30 unique up determinants.
Found 30 unique down determinants.
Number of terms in pairs array: 20
Number of terms in pairs array: 20
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 3.3900e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u  6.1002844054e-01  1.3250453608e-01 -4.2267217978e-01
    u -4.3494847795e-01 -2.3203549626e-01  1.0876787134e-01
    u -1.5984350305e-01  8.1842956548e-01  5.1837161342e-02
    u  1.1948334779e+00  1.4453040952e+00  1.6346730752e+00
    d -9.5054657961e-01  2.3768909128e-01 -6.0876959125e-01
    d -2.0429807517e-01  1.5546410594e+00 -1.0292769217e-01
    d  4.7451519973e-01  3.4811618685e-02  3.5425821429e-01
    d -8.6403568621e-02 -1.8286319639e+00  9.9844026831e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.9364
    reference variance = 0.382645
====================================================
  Execution time = 2.0556e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2948e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4566e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329450843564
                                         uncertainty =       0.005030332360

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329450843564
                                         uncertainty =       0.005030332360

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405879323
  error estimate for blocks of size 2^( 2) =       0.000419678487
  error estimate for blocks of size 2^( 3) =       0.000433370088
  error estimate for blocks of size 2^( 4) =       0.000445893189
  error estimate for blocks of size 2^( 5) =       0.000456457079
  error estimate for blocks of size 2^( 6) =       0.000463285700
  error estimate for blocks of size 2^( 7) =       0.000467596633

      target function =                  N/A
              le_mean =     -16.903918164909
             les_mean =     286.071925211485
             stat err =       0.000458308150
             autocorr =       1.275032647674
              std dev =       0.574000043786
             le_variance =       0.329476050266


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.690391816491e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903918164909       residual = 2.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904124764305       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904269920010       residual = 2.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904321876671       residual = 2.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904412406063       residual = 5.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904438103383       residual = 2.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904441140451       residual = 6.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904442508844       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.904444007623       residual = 7.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.904445293163       residual = 4.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.904445979818       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.904445556583       residual = 3.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.904445983886       residual = 9.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.172287e-02

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903918164909       residual = 2.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904002675595       residual = 1.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904069876361       residual = 3.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904087314190       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904122917199       residual = 5.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904128592896       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904130426295       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904129961349       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.904129928903       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.904130079126       residual = 5.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.904130326660       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.904130287752       residual = 1.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 4.027139e-03

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903918164909       residual = 2.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903943288421       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.903964873373       residual = 3.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.903970024482       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.903979706164       residual = 7.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.903981755447       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.903982117868       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.903982070235       residual = 5.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.903981940590       residual = 3.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.903982016108       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.903982017479       residual = 4.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 1.127409e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.008289 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6026e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  3.026690e-01                 1 1 ON  0
uu_1  1.393547e-01                 1 1 ON  1
uu_2  4.121754e-02                 1 1 ON  2
uu_3  -1.928237e-02                1 1 ON  3
uu_4  -6.285702e-02                1 1 ON  4
uu_5  -9.578720e-02                1 1 ON  5
uu_6  -1.206868e-01                1 1 ON  6
uu_7  -1.311710e-01                1 1 ON  7
uu_8  -1.205030e-01                1 1 ON  8
uu_9  -9.274653e-02                1 1 ON  9
ud_0  4.148412e-01                 1 1 ON  10
ud_1  1.608333e-01                 1 1 ON  11
ud_2  5.908650e-02                 1 1 ON  12
ud_3  5.330056e-04                 1 1 ON  13
ud_4  -5.755374e-02                1 1 ON  14
ud_5  -1.016907e-01                1 1 ON  15
ud_6  -1.290987e-01                1 1 ON  16
ud_7  -1.439107e-01                1 1 ON  17
ud_8  -1.427880e-01                1 1 ON  18
ud_9  -1.345432e-01                1 1 ON  19
eO_0  -7.083371e-01                1 1 ON  20
eO_1  -4.143152e-01                1 1 ON  21
eO_2  -2.877320e-02                1 1 ON  22
eO_3  2.714394e-01                 1 1 ON  23
eO_4  4.919136e-01                 1 1 ON  24
eO_5  4.591047e-01                 1 1 ON  25
eO_6  2.358728e-01                 1 1 ON  26
eO_7  -5.588781e-02                1 1 ON  27
eO_8  -1.960951e-01                1 1 ON  28
eO_9  -5.781887e-02                1 1 ON  29
eH1_0 -2.112494e-01                1 1 ON  30
eH1_1 -1.275554e-01                1 1 ON  31
eH1_2 -8.812681e-02                1 1 ON  32
eH1_3 -3.700191e-02                1 1 ON  33
eH1_4 1.188539e-02                 1 1 ON  34
eH1_5 4.480004e-02                 1 1 ON  35
eH1_6 9.479114e-02                 1 1 ON  36
eH1_7 1.382213e-01                 1 1 ON  37
eH1_8 1.458394e-01                 1 1 ON  38
eH1_9 3.299275e-02                 1 1 ON  39
eH2_0 -2.101234e-01                1 1 ON  40
eH2_1 -1.265827e-01                1 1 ON  41
eH2_2 -8.708091e-02                1 1 ON  42
eH2_3 -3.588587e-02                1 1 ON  43
eH2_4 1.324804e-02                 1 1 ON  44
eH2_5 4.786889e-02                 1 1 ON  45
eH2_6 1.005327e-01                 1 1 ON  46
eH2_7 1.495280e-01                 1 1 ON  47
eH2_8 1.539175e-01                 1 1 ON  48
eH2_9 1.314358e-02                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.8649
    reference variance = 0.323814
====================================================
  Execution time = 2.0522e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2568e-01
  Total weights = 2.0000e+06
  Execution time = 1.9038e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324750455494
                                         uncertainty =       0.003105831404

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324750455494
                                         uncertainty =       0.003105831404

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402949812
  error estimate for blocks of size 2^( 2) =       0.000416912175
  error estimate for blocks of size 2^( 3) =       0.000431213545
  error estimate for blocks of size 2^( 4) =       0.000443400097
  error estimate for blocks of size 2^( 5) =       0.000453609769
  error estimate for blocks of size 2^( 6) =       0.000460850181
  error estimate for blocks of size 2^( 7) =       0.000466208120

      target function =                  N/A
              le_mean =     -16.904478271262
             les_mean =     286.086122563694
             stat err =       0.000456017042
             autocorr =       1.280737807639
              std dev =       0.569857089534
             le_variance =       0.324737102492

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328513082647
                                         uncertainty =       0.003184272420

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328513082647
                                         uncertainty =       0.003184272420

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405277401
  error estimate for blocks of size 2^( 2) =       0.000418552830
  error estimate for blocks of size 2^( 3) =       0.000432235056
  error estimate for blocks of size 2^( 4) =       0.000444046935
  error estimate for blocks of size 2^( 5) =       0.000454074993
  error estimate for blocks of size 2^( 6) =       0.000461315424
  error estimate for blocks of size 2^( 7) =       0.000466503884

      target function =                  N/A
              le_mean =     -16.904562448345
             les_mean =     286.092730948730
             stat err =       0.000456485309
             autocorr =       1.268670486902
              std dev =       0.573148796551
             le_variance =       0.328499542987

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327272439250
                                         uncertainty =       0.003161652324

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327272439250
                                         uncertainty =       0.003161652324

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404511338
  error estimate for blocks of size 2^( 2) =       0.000417915369
  error estimate for blocks of size 2^( 3) =       0.000431714296
  error estimate for blocks of size 2^( 4) =       0.000443597939
  error estimate for blocks of size 2^( 5) =       0.000453672608
  error estimate for blocks of size 2^( 6) =       0.000460925430
  error estimate for blocks of size 2^( 7) =       0.000466138267

      target function =                  N/A
              le_mean =     -16.904507401878
             les_mean =     286.089629181107
             stat err =       0.000456083561
             autocorr =       1.271239680845
              std dev =       0.572065419844
             le_variance =       0.327258844582

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324918469878
                                         uncertainty =       0.003113003768

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324918469878
                                         uncertainty =       0.003113003768

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403054016
  error estimate for blocks of size 2^( 2) =       0.000416924028
  error estimate for blocks of size 2^( 3) =       0.000431144811
  error estimate for blocks of size 2^( 4) =       0.000443283916
  error estimate for blocks of size 2^( 5) =       0.000453474896
  error estimate for blocks of size 2^( 6) =       0.000460718100
  error estimate for blocks of size 2^( 7) =       0.000466053270

      target function =                  N/A
              le_mean =     -16.904456786343
             les_mean =     286.085564159027
             stat err =       0.000455882545
             autocorr =       1.279320687616
              std dev =       0.570004456246
             le_variance =       0.324905080141


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904478271262        initial
     2.5000e-01     2.5000e+00             1.1723e-02       -16.904562448345  <--
     1.0000e+00     1.0000e+01             4.0271e-03       -16.904507401878
     4.0000e+00     4.0000e+01             1.1274e-03       -16.904456786343

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 3.0160e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 3.028849e-01 1 1  ON 0
 uu_1                 1.391310e-01 1 1  ON 1
 uu_2                 4.062473e-02 1 1  ON 2
 uu_3                -1.934010e-02 1 1  ON 3
 uu_4                -6.231478e-02 1 1  ON 4
 uu_5                -9.543291e-02 1 1  ON 5
 uu_6                -1.208223e-01 1 1  ON 6
 uu_7                -1.314911e-01 1 1  ON 7
 uu_8                -1.210299e-01 1 1  ON 8
 uu_9                -9.269393e-02 1 1  ON 9
 ud_0                 4.209576e-01 1 1  ON 10
 ud_1                 1.643198e-01 1 1  ON 11
 ud_2                 5.742941e-02 1 1  ON 12
 ud_3                -3.114462e-03 1 1  ON 13
 ud_4                -5.914658e-02 1 1  ON 14
 ud_5                -1.021591e-01 1 1  ON 15
 ud_6                -1.296711e-01 1 1  ON 16
 ud_7                -1.446283e-01 1 1  ON 17
 ud_8                -1.435815e-01 1 1  ON 18
 ud_9                -1.347281e-01 1 1  ON 19
 eO_0                -7.160329e-01 1 1  ON 20
 eO_1                -4.160214e-01 1 1  ON 21
 eO_2                -2.399298e-02 1 1  ON 22
 eO_3                 2.763311e-01 1 1  ON 23
 eO_4                 4.935361e-01 1 1  ON 24
 eO_5                 4.584111e-01 1 1  ON 25
 eO_6                 2.354605e-01 1 1  ON 26
 eO_7                -5.577381e-02 1 1  ON 27
 eO_8                -1.965552e-01 1 1  ON 28
 eO_9                -5.818640e-02 1 1  ON 29
eH1_0                -2.143263e-01 1 1  ON 30
eH1_1                -1.279612e-01 1 1  ON 31
eH1_2                -8.749029e-02 1 1  ON 32
eH1_3                -3.628765e-02 1 1  ON 33
eH1_4                 1.235813e-02 1 1  ON 34
eH1_5                 4.508951e-02 1 1  ON 35
eH1_6                 9.506173e-02 1 1  ON 36
eH1_7                 1.384081e-01 1 1  ON 37
eH1_8                 1.462766e-01 1 1  ON 38
eH1_9                 3.345110e-02 1 1  ON 39
eH2_0                -2.131356e-01 1 1  ON 40
eH2_1                -1.268216e-01 1 1  ON 41
eH2_2                -8.623872e-02 1 1  ON 42
eH2_3                -3.491424e-02 1 1  ON 43
eH2_4                 1.389651e-02 1 1  ON 44
eH2_5                 4.781179e-02 1 1  ON 45
eH2_6                 1.004742e-01 1 1  ON 46
eH2_7                 1.493540e-01 1 1  ON 47
eH2_8                 1.544170e-01 1 1  ON 48
eH2_9                 1.378666e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6193e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.9857
    reference variance = 0.996507
====================================================
  Execution time = 2.0705e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.3058e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5579e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330554509342
                                         uncertainty =       0.008885457512

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330554509342
                                         uncertainty =       0.008885457512

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406558677
  error estimate for blocks of size 2^( 2) =       0.000420180729
  error estimate for blocks of size 2^( 3) =       0.000434694425
  error estimate for blocks of size 2^( 4) =       0.000448488575
  error estimate for blocks of size 2^( 5) =       0.000460242691
  error estimate for blocks of size 2^( 6) =       0.000469442815
  error estimate for blocks of size 2^( 7) =       0.000476120607

      target function =                  N/A
              le_mean =     -16.904265721414
             les_mean =     286.084779331184
             stat err =       0.000463573672
             autocorr =       1.300142801745
              std dev =       0.574960795438
             le_variance =       0.330579916290


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690426572141e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904265721414       residual = 5.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904346178751       residual = 2.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904424420821       residual = 7.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904494483962       residual = 7.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904510765395       residual = 3.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904536754596       residual = 2.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904554137872       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904565594724       residual = 5.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.904573265743       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.904576729613       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.904578381892       residual = 8.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.904579091280       residual = 3.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.904581475848       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.904581240609       residual = 6.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.904580562681       residual = 2.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.904581401124       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.904581370134       residual = 6.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 1.850968e-02

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904265721414       residual = 5.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904314315435       residual = 2.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904363266411       residual = 7.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904390050069       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904409207777       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904420426072       residual = 9.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904425867896       residual = 3.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904429351382       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.904430736568       residual = 4.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.904431490729       residual = 2.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.904431335503       residual = 5.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.904431164545       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.904431336006       residual = 3.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 7.953917e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904265721414       residual = 5.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904284526207       residual = 2.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904304917660       residual = 8.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904311408210       residual = 7.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904320793769       residual = 9.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904324015325       residual = 4.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904324978607       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904325655359       residual = 5.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.904326041075       residual = 5.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.904326092767       residual = 2.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.904326023685       residual = 4.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 2.601217e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.015056 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6273e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.033231e-01 1 1  ON 0
 uu_1                 1.388965e-01 1 1  ON 1
 uu_2                 4.001761e-02 1 1  ON 2
 uu_3                -1.972219e-02 1 1  ON 3
 uu_4                -6.242376e-02 1 1  ON 4
 uu_5                -9.517207e-02 1 1  ON 5
 uu_6                -1.207095e-01 1 1  ON 6
 uu_7                -1.317646e-01 1 1  ON 7
 uu_8                -1.216478e-01 1 1  ON 8
 uu_9                -9.259303e-02 1 1  ON 9
 ud_0                 4.267523e-01 1 1  ON 10
 ud_1                 1.673066e-01 1 1  ON 11
 ud_2                 5.639077e-02 1 1  ON 12
 ud_3                -6.459731e-03 1 1  ON 13
 ud_4                -6.112444e-02 1 1  ON 14
 ud_5                -1.029662e-01 1 1  ON 15
 ud_6                -1.302096e-01 1 1  ON 16
 ud_7                -1.453592e-01 1 1  ON 17
 ud_8                -1.442393e-01 1 1  ON 18
 ud_9                -1.344170e-01 1 1  ON 19
 eO_0                -7.239868e-01 1 1  ON 20
 eO_1                -4.182981e-01 1 1  ON 21
 eO_2                -2.004125e-02 1 1  ON 22
 eO_3                 2.811865e-01 1 1  ON 23
 eO_4                 4.958691e-01 1 1  ON 24
 eO_5                 4.584969e-01 1 1  ON 25
 eO_6                 2.353600e-01 1 1  ON 26
 eO_7                -5.564897e-02 1 1  ON 27
 eO_8                -1.970681e-01 1 1  ON 28
 eO_9                -5.863004e-02 1 1  ON 29
eH1_0                -2.179512e-01 1 1  ON 30
eH1_1                -1.283979e-01 1 1  ON 31
eH1_2                -8.682978e-02 1 1  ON 32
eH1_3                -3.549311e-02 1 1  ON 33
eH1_4                 1.282210e-02 1 1  ON 34
eH1_5                 4.509997e-02 1 1  ON 35
eH1_6                 9.515650e-02 1 1  ON 36
eH1_7                 1.386025e-01 1 1  ON 37
eH1_8                 1.470637e-01 1 1  ON 38
eH1_9                 3.438905e-02 1 1  ON 39
eH2_0                -2.164682e-01 1 1  ON 40
eH2_1                -1.273788e-01 1 1  ON 41
eH2_2                -8.551772e-02 1 1  ON 42
eH2_3                -3.401062e-02 1 1  ON 43
eH2_4                 1.427525e-02 1 1  ON 44
eH2_5                 4.843966e-02 1 1  ON 45
eH2_6                 1.005500e-01 1 1  ON 46
eH2_7                 1.492401e-01 1 1  ON 47
eH2_8                 1.549898e-01 1 1  ON 48
eH2_9                 1.445919e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.9459
    reference variance = 0.250011
====================================================
  Execution time = 2.0120e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2241e-01
  Total weights = 2.0000e+06
  Execution time = 1.9257e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319194029598
                                         uncertainty =       0.002939710793

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319194029598
                                         uncertainty =       0.002939710793

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399472388
  error estimate for blocks of size 2^( 2) =       0.000412842050
  error estimate for blocks of size 2^( 3) =       0.000426017532
  error estimate for blocks of size 2^( 4) =       0.000438372538
  error estimate for blocks of size 2^( 5) =       0.000449452620
  error estimate for blocks of size 2^( 6) =       0.000457798536
  error estimate for blocks of size 2^( 7) =       0.000461526847

      target function =                  N/A
              le_mean =     -16.905507788590
             les_mean =     286.115349807247
             stat err =       0.000451787635
             autocorr =       1.279072469297
              std dev =       0.564939268199
             le_variance =       0.319156376753

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325812060076
                                         uncertainty =       0.003028014749

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325812060076
                                         uncertainty =       0.003028014749

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403595040
  error estimate for blocks of size 2^( 2) =       0.000416485819
  error estimate for blocks of size 2^( 3) =       0.000429217466
  error estimate for blocks of size 2^( 4) =       0.000441214057
  error estimate for blocks of size 2^( 5) =       0.000452050313
  error estimate for blocks of size 2^( 6) =       0.000460225695
  error estimate for blocks of size 2^( 7) =       0.000463987861

      target function =                  N/A
              le_mean =     -16.905472360286
             les_mean =     286.120773473931
             stat err =       0.000454369481
             autocorr =       1.267437833154
              std dev =       0.570769579111
             le_variance =       0.325777912438

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326486181406
                                         uncertainty =       0.003048584835

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326486181406
                                         uncertainty =       0.003048584835

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404012602
  error estimate for blocks of size 2^( 2) =       0.000416875404
  error estimate for blocks of size 2^( 3) =       0.000429582727
  error estimate for blocks of size 2^( 4) =       0.000441569689
  error estimate for blocks of size 2^( 5) =       0.000452398103
  error estimate for blocks of size 2^( 6) =       0.000460588246
  error estimate for blocks of size 2^( 7) =       0.000464368954

      target function =                  N/A
              le_mean =     -16.905491077616
             les_mean =     286.122080777706
             stat err =       0.000454731248
             autocorr =       1.266834184043
              std dev =       0.571360101484
             le_variance =       0.326452365568

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320342938890
                                         uncertainty =       0.002962328354

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320342938890
                                         uncertainty =       0.002962328354

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400191201
  error estimate for blocks of size 2^( 2) =       0.000413446521
  error estimate for blocks of size 2^( 3) =       0.000426518918
  error estimate for blocks of size 2^( 4) =       0.000438798537
  error estimate for blocks of size 2^( 5) =       0.000449829851
  error estimate for blocks of size 2^( 6) =       0.000458147308
  error estimate for blocks of size 2^( 7) =       0.000461886907

      target function =                  N/A
              le_mean =     -16.905462174197
             les_mean =     286.114957157954
             stat err =       0.000452165651
             autocorr =       1.276615355383
              std dev =       0.565955824173
             le_variance =       0.320305994916


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905507788590        initial  <--
     6.2500e-02     6.2500e-01             1.8510e-02       -16.905472360286
     2.5000e-01     2.5000e+00             7.9539e-03       -16.905491077616
     1.0000e+00     1.0000e+01             2.6012e-03       -16.905462174197

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8798
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.028849e-01 1 1  ON 0
 uu_1                 1.391310e-01 1 1  ON 1
 uu_2                 4.062473e-02 1 1  ON 2
 uu_3                -1.934010e-02 1 1  ON 3
 uu_4                -6.231478e-02 1 1  ON 4
 uu_5                -9.543291e-02 1 1  ON 5
 uu_6                -1.208223e-01 1 1  ON 6
 uu_7                -1.314911e-01 1 1  ON 7
 uu_8                -1.210299e-01 1 1  ON 8
 uu_9                -9.269393e-02 1 1  ON 9
 ud_0                 4.209576e-01 1 1  ON 10
 ud_1                 1.643198e-01 1 1  ON 11
 ud_2                 5.742941e-02 1 1  ON 12
 ud_3                -3.114462e-03 1 1  ON 13
 ud_4                -5.914658e-02 1 1  ON 14
 ud_5                -1.021591e-01 1 1  ON 15
 ud_6                -1.296711e-01 1 1  ON 16
 ud_7                -1.446283e-01 1 1  ON 17
 ud_8                -1.435815e-01 1 1  ON 18
 ud_9                -1.347281e-01 1 1  ON 19
 eO_0                -7.160329e-01 1 1  ON 20
 eO_1                -4.160214e-01 1 1  ON 21
 eO_2                -2.399298e-02 1 1  ON 22
 eO_3                 2.763311e-01 1 1  ON 23
 eO_4                 4.935361e-01 1 1  ON 24
 eO_5                 4.584111e-01 1 1  ON 25
 eO_6                 2.354605e-01 1 1  ON 26
 eO_7                -5.577381e-02 1 1  ON 27
 eO_8                -1.965552e-01 1 1  ON 28
 eO_9                -5.818640e-02 1 1  ON 29
eH1_0                -2.143263e-01 1 1  ON 30
eH1_1                -1.279612e-01 1 1  ON 31
eH1_2                -8.749029e-02 1 1  ON 32
eH1_3                -3.628765e-02 1 1  ON 33
eH1_4                 1.235813e-02 1 1  ON 34
eH1_5                 4.508951e-02 1 1  ON 35
eH1_6                 9.506173e-02 1 1  ON 36
eH1_7                 1.384081e-01 1 1  ON 37
eH1_8                 1.462766e-01 1 1  ON 38
eH1_9                 3.345110e-02 1 1  ON 39
eH2_0                -2.131356e-01 1 1  ON 40
eH2_1                -1.268216e-01 1 1  ON 41
eH2_2                -8.623872e-02 1 1  ON 42
eH2_3                -3.491424e-02 1 1  ON 43
eH2_4                 1.389651e-02 1 1  ON 44
eH2_5                 4.781179e-02 1 1  ON 45
eH2_6                 1.004742e-01 1 1  ON 46
eH2_7                 1.493540e-01 1 1  ON 47
eH2_8                 1.544170e-01 1 1  ON 48
eH2_9                 1.378666e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6159e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6933e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.9296
    reference variance = 0.561919
====================================================
  Execution time = 2.0524e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3100e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5272e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331033240656
                                         uncertainty =       0.003487718469

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331033240656
                                         uncertainty =       0.003487718469

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406819871
  error estimate for blocks of size 2^( 2) =       0.000420196157
  error estimate for blocks of size 2^( 3) =       0.000433966128
  error estimate for blocks of size 2^( 4) =       0.000447198316
  error estimate for blocks of size 2^( 5) =       0.000456489670
  error estimate for blocks of size 2^( 6) =       0.000463882885
  error estimate for blocks of size 2^( 7) =       0.000470206566

      target function =                  N/A
              le_mean =     -16.905182699125
             les_mean =     286.116206740432
             stat err =       0.000459444359
             autocorr =       1.275444400997
              std dev =       0.575330179221
             le_variance =       0.331004815123


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690518269913e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905182699125       residual = 5.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905203719371       residual = 3.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905234933157       residual = 6.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905244877270       residual = 9.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905259965467       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905266197866       residual = 3.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905266186253       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905266118058       residual = 8.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905266103949       residual = 9.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905266426393       residual = 5.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905266575040       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905266544962       residual = 1.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 3.714381e-03

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905182699125       residual = 5.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905189309655       residual = 3.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905199779036       residual = 6.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905202198691       residual = 7.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905207164378       residual = 9.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905208225147       residual = 5.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905208524824       residual = 6.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905208370804       residual = 2.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905208348955       residual = 2.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905208394428       residual = 9.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 1.077763e-03

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905182699125       residual = 5.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905184465671       residual = 3.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905187332343       residual = 6.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905187942551       residual = 7.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905189257315       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905189486616       residual = 4.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905189578318       residual = 4.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905189546580       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905189533788       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905189545625       residual = 3.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 2.816182e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.019186 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6059e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.028875e-01 1 1  ON 0
 uu_1                 1.391250e-01 1 1  ON 1
 uu_2                 4.055705e-02 1 1  ON 2
 uu_3                -1.927478e-02 1 1  ON 3
 uu_4                -6.221894e-02 1 1  ON 4
 uu_5                -9.537243e-02 1 1  ON 5
 uu_6                -1.208481e-01 1 1  ON 6
 uu_7                -1.315763e-01 1 1  ON 7
 uu_8                -1.211226e-01 1 1  ON 8
 uu_9                -9.273680e-02 1 1  ON 9
 ud_0                 4.218979e-01 1 1  ON 10
 ud_1                 1.648660e-01 1 1  ON 11
 ud_2                 5.715947e-02 1 1  ON 12
 ud_3                -3.655628e-03 1 1  ON 13
 ud_4                -5.932056e-02 1 1  ON 14
 ud_5                -1.021804e-01 1 1  ON 15
 ud_6                -1.297614e-01 1 1  ON 16
 ud_7                -1.447202e-01 1 1  ON 17
 ud_8                -1.437089e-01 1 1  ON 18
 ud_9                -1.348258e-01 1 1  ON 19
 eO_0                -7.171106e-01 1 1  ON 20
 eO_1                -4.162213e-01 1 1  ON 21
 eO_2                -2.330574e-02 1 1  ON 22
 eO_3                 2.769651e-01 1 1  ON 23
 eO_4                 4.937446e-01 1 1  ON 24
 eO_5                 4.583505e-01 1 1  ON 25
 eO_6                 2.354370e-01 1 1  ON 26
 eO_7                -5.576790e-02 1 1  ON 27
 eO_8                -1.966527e-01 1 1  ON 28
 eO_9                -5.825292e-02 1 1  ON 29
eH1_0                -2.147584e-01 1 1  ON 30
eH1_1                -1.280054e-01 1 1  ON 31
eH1_2                -8.743258e-02 1 1  ON 32
eH1_3                -3.615344e-02 1 1  ON 33
eH1_4                 1.246833e-02 1 1  ON 34
eH1_5                 4.511616e-02 1 1  ON 35
eH1_6                 9.506295e-02 1 1  ON 36
eH1_7                 1.384596e-01 1 1  ON 37
eH1_8                 1.463389e-01 1 1  ON 38
eH1_9                 3.349977e-02 1 1  ON 39
eH2_0                -2.135126e-01 1 1  ON 40
eH2_1                -1.268667e-01 1 1  ON 41
eH2_2                -8.616360e-02 1 1  ON 42
eH2_3                -3.478702e-02 1 1  ON 43
eH2_4                 1.397586e-02 1 1  ON 44
eH2_5                 4.783470e-02 1 1  ON 45
eH2_6                 1.004799e-01 1 1  ON 46
eH2_7                 1.493327e-01 1 1  ON 47
eH2_8                 1.544863e-01 1 1  ON 48
eH2_9                 1.386243e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.8547
    reference variance = 0.188422
====================================================
  Execution time = 1.9974e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2326e-01
  Total weights = 2.0000e+06
  Execution time = 1.9219e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322840025233
                                         uncertainty =       0.003165750911

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322840025233
                                         uncertainty =       0.003165750911

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401720980
  error estimate for blocks of size 2^( 2) =       0.000414836453
  error estimate for blocks of size 2^( 3) =       0.000428956535
  error estimate for blocks of size 2^( 4) =       0.000441538310
  error estimate for blocks of size 2^( 5) =       0.000452245067
  error estimate for blocks of size 2^( 6) =       0.000461952078
  error estimate for blocks of size 2^( 7) =       0.000466356070

      target function =                  N/A
              le_mean =     -16.904855453332
             les_mean =     286.096897227680
             stat err =       0.000455522881
             autocorr =       1.285793919259
              std dev =       0.568119257725
             le_variance =       0.322759490998

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324550197450
                                         uncertainty =       0.003182340480

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324550197450
                                         uncertainty =       0.003182340480

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402783924
  error estimate for blocks of size 2^( 2) =       0.000415733133
  error estimate for blocks of size 2^( 3) =       0.000429712303
  error estimate for blocks of size 2^( 4) =       0.000442211980
  error estimate for blocks of size 2^( 5) =       0.000452856851
  error estimate for blocks of size 2^( 6) =       0.000462566972
  error estimate for blocks of size 2^( 7) =       0.000466863594

      target function =                  N/A
              le_mean =     -16.904842913415
             les_mean =     286.098183544220
             stat err =       0.000456124849
             autocorr =       1.282399110112
              std dev =       0.569622488344
             le_variance =       0.324469779227

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323870844613
                                         uncertainty =       0.003175585012

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323870844613
                                         uncertainty =       0.003175585012

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402362020
  error estimate for blocks of size 2^( 2) =       0.000415371174
  error estimate for blocks of size 2^( 3) =       0.000429401270
  error estimate for blocks of size 2^( 4) =       0.000441930964
  error estimate for blocks of size 2^( 5) =       0.000452599220
  error estimate for blocks of size 2^( 6) =       0.000462305868
  error estimate for blocks of size 2^( 7) =       0.000466640101

      target function =                  N/A
              le_mean =     -16.904842412204
             les_mean =     286.097487210159
             stat err =       0.000455869038
             autocorr =       1.283648842273
              std dev =       0.569025825958
             le_variance =       0.323790390607

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322971228898
                                         uncertainty =       0.003167028949

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322971228898
                                         uncertainty =       0.003167028949

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401802630
  error estimate for blocks of size 2^( 2) =       0.000414903358
  error estimate for blocks of size 2^( 3) =       0.000429011026
  error estimate for blocks of size 2^( 4) =       0.000441585629
  error estimate for blocks of size 2^( 5) =       0.000452287202
  error estimate for blocks of size 2^( 6) =       0.000461994080
  error estimate for blocks of size 2^( 7) =       0.000466388607

      target function =                  N/A
              le_mean =     -16.904852635507
             les_mean =     286.096933173018
             stat err =       0.000455563880
             autocorr =       1.285502768636
              std dev =       0.568234728120
             le_variance =       0.322890706242


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904855453332        initial  <--
     6.2500e-01     6.2500e+00             3.7144e-03       -16.904842913415
     2.5000e+00     2.5000e+01             1.0778e-03       -16.904842412204
     1.0000e+01     1.0000e+02             2.8162e-04       -16.904852635507

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7108
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.028849e-01 1 1  ON 0
 uu_1                 1.391310e-01 1 1  ON 1
 uu_2                 4.062473e-02 1 1  ON 2
 uu_3                -1.934010e-02 1 1  ON 3
 uu_4                -6.231478e-02 1 1  ON 4
 uu_5                -9.543291e-02 1 1  ON 5
 uu_6                -1.208223e-01 1 1  ON 6
 uu_7                -1.314911e-01 1 1  ON 7
 uu_8                -1.210299e-01 1 1  ON 8
 uu_9                -9.269393e-02 1 1  ON 9
 ud_0                 4.209576e-01 1 1  ON 10
 ud_1                 1.643198e-01 1 1  ON 11
 ud_2                 5.742941e-02 1 1  ON 12
 ud_3                -3.114462e-03 1 1  ON 13
 ud_4                -5.914658e-02 1 1  ON 14
 ud_5                -1.021591e-01 1 1  ON 15
 ud_6                -1.296711e-01 1 1  ON 16
 ud_7                -1.446283e-01 1 1  ON 17
 ud_8                -1.435815e-01 1 1  ON 18
 ud_9                -1.347281e-01 1 1  ON 19
 eO_0                -7.160329e-01 1 1  ON 20
 eO_1                -4.160214e-01 1 1  ON 21
 eO_2                -2.399298e-02 1 1  ON 22
 eO_3                 2.763311e-01 1 1  ON 23
 eO_4                 4.935361e-01 1 1  ON 24
 eO_5                 4.584111e-01 1 1  ON 25
 eO_6                 2.354605e-01 1 1  ON 26
 eO_7                -5.577381e-02 1 1  ON 27
 eO_8                -1.965552e-01 1 1  ON 28
 eO_9                -5.818640e-02 1 1  ON 29
eH1_0                -2.143263e-01 1 1  ON 30
eH1_1                -1.279612e-01 1 1  ON 31
eH1_2                -8.749029e-02 1 1  ON 32
eH1_3                -3.628765e-02 1 1  ON 33
eH1_4                 1.235813e-02 1 1  ON 34
eH1_5                 4.508951e-02 1 1  ON 35
eH1_6                 9.506173e-02 1 1  ON 36
eH1_7                 1.384081e-01 1 1  ON 37
eH1_8                 1.462766e-01 1 1  ON 38
eH1_9                 3.345110e-02 1 1  ON 39
eH2_0                -2.131356e-01 1 1  ON 40
eH2_1                -1.268216e-01 1 1  ON 41
eH2_2                -8.623872e-02 1 1  ON 42
eH2_3                -3.491424e-02 1 1  ON 43
eH2_4                 1.389651e-02 1 1  ON 44
eH2_5                 4.781179e-02 1 1  ON 45
eH2_6                 1.004742e-01 1 1  ON 46
eH2_7                 1.493540e-01 1 1  ON 47
eH2_8                 1.544170e-01 1 1  ON 48
eH2_9                 1.378666e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5776e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6920e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.9671
    reference variance = 0.36153
====================================================
  Execution time = 2.0512e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3496e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5807e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334851426711
                                         uncertainty =       0.004641469833

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334851426711
                                         uncertainty =       0.004641469833

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409244535
  error estimate for blocks of size 2^( 2) =       0.000422086687
  error estimate for blocks of size 2^( 3) =       0.000435035192
  error estimate for blocks of size 2^( 4) =       0.000446518265
  error estimate for blocks of size 2^( 5) =       0.000456491591
  error estimate for blocks of size 2^( 6) =       0.000463289533
  error estimate for blocks of size 2^( 7) =       0.000466373944

      target function =                  N/A
              le_mean =     -16.905746414459
             les_mean =     286.139223840806
             stat err =       0.000458168333
             autocorr =       1.253384620828
              std dev =       0.578759171247
             le_variance =       0.334962178303


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690574641446e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905746414459       residual = 5.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905749527080       residual = 3.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905754029039       residual = 6.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905755731721       residual = 7.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905757848813       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905757906248       residual = 4.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905757705054       residual = 4.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905757800577       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905757873687       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905757879631       residual = 5.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 4.532247e-04

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905746414459       residual = 5.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905747213568       residual = 3.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905748379022       residual = 6.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905748805684       residual = 7.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905749350865       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905749368858       residual = 4.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905749314248       residual = 4.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905749337407       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905749354599       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905749356546       residual = 3.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+01 is 1.154215e-04

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905746414459       residual = 5.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905746615590       residual = 3.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905746909577       residual = 6.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905747016338       residual = 7.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905747153616       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905747158378       residual = 3.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905747144472       residual = 4.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905747150192       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905747154432       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905747154943       residual = 3.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+02 is 2.899249e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.022831 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6100e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.028856e-01 1 1  ON 0
 uu_1                 1.391309e-01 1 1  ON 1
 uu_2                 4.061250e-02 1 1  ON 2
 uu_3                -1.933452e-02 1 1  ON 3
 uu_4                -6.230812e-02 1 1  ON 4
 uu_5                -9.542503e-02 1 1  ON 5
 uu_6                -1.208246e-01 1 1  ON 6
 uu_7                -1.314984e-01 1 1  ON 7
 uu_8                -1.210387e-01 1 1  ON 8
 uu_9                -9.269692e-02 1 1  ON 9
 ud_0                 4.210545e-01 1 1  ON 10
 ud_1                 1.643795e-01 1 1  ON 11
 ud_2                 5.739911e-02 1 1  ON 12
 ud_3                -3.172256e-03 1 1  ON 13
 ud_4                -5.916429e-02 1 1  ON 14
 ud_5                -1.021663e-01 1 1  ON 15
 ud_6                -1.296811e-01 1 1  ON 16
 ud_7                -1.446459e-01 1 1  ON 17
 ud_8                -1.435956e-01 1 1  ON 18
 ud_9                -1.347305e-01 1 1  ON 19
 eO_0                -7.161483e-01 1 1  ON 20
 eO_1                -4.160396e-01 1 1  ON 21
 eO_2                -2.391815e-02 1 1  ON 22
 eO_3                 2.764001e-01 1 1  ON 23
 eO_4                 4.935553e-01 1 1  ON 24
 eO_5                 4.584011e-01 1 1  ON 25
 eO_6                 2.354565e-01 1 1  ON 26
 eO_7                -5.577534e-02 1 1  ON 27
 eO_8                -1.965639e-01 1 1  ON 28
 eO_9                -5.819171e-02 1 1  ON 29
eH1_0                -2.143675e-01 1 1  ON 30
eH1_1                -1.279661e-01 1 1  ON 31
eH1_2                -8.748348e-02 1 1  ON 32
eH1_3                -3.627311e-02 1 1  ON 33
eH1_4                 1.236320e-02 1 1  ON 34
eH1_5                 4.509576e-02 1 1  ON 35
eH1_6                 9.506508e-02 1 1  ON 36
eH1_7                 1.384070e-01 1 1  ON 37
eH1_8                 1.462809e-01 1 1  ON 38
eH1_9                 3.345700e-02 1 1  ON 39
eH2_0                -2.131749e-01 1 1  ON 40
eH2_1                -1.268312e-01 1 1  ON 41
eH2_2                -8.623058e-02 1 1  ON 42
eH2_3                -3.490127e-02 1 1  ON 43
eH2_4                 1.390298e-02 1 1  ON 44
eH2_5                 4.781946e-02 1 1  ON 45
eH2_6                 1.004749e-01 1 1  ON 46
eH2_7                 1.493503e-01 1 1  ON 47
eH2_8                 1.544241e-01 1 1  ON 48
eH2_9                 1.379601e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.8651
    reference variance = 0.148092
====================================================
  Execution time = 2.0132e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2839e-01
  Total weights = 2.0000e+06
  Execution time = 1.9393e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328340485550
                                         uncertainty =       0.006039466173

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328340485550
                                         uncertainty =       0.006039466173

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405175341
  error estimate for blocks of size 2^( 2) =       0.000418554098
  error estimate for blocks of size 2^( 3) =       0.000432109995
  error estimate for blocks of size 2^( 4) =       0.000444493402
  error estimate for blocks of size 2^( 5) =       0.000454782872
  error estimate for blocks of size 2^( 6) =       0.000462514315
  error estimate for blocks of size 2^( 7) =       0.000467401631

      target function =                  N/A
              le_mean =     -16.905247371757
             les_mean =     286.115722649521
             stat err =       0.000457298055
             autocorr =       1.273833588818
              std dev =       0.573004461933
             le_variance =       0.328334113396

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328546035946
                                         uncertainty =       0.006041743873

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328546035946
                                         uncertainty =       0.006041743873

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405302091
  error estimate for blocks of size 2^( 2) =       0.000418658736
  error estimate for blocks of size 2^( 3) =       0.000432195201
  error estimate for blocks of size 2^( 4) =       0.000444566319
  error estimate for blocks of size 2^( 5) =       0.000454846740
  error estimate for blocks of size 2^( 6) =       0.000462572673
  error estimate for blocks of size 2^( 7) =       0.000467453280

      target function =                  N/A
              le_mean =     -16.905248319650
             les_mean =     286.115960155410
             stat err =       0.000457359753
             autocorr =       1.273380514407
              std dev =       0.573183714565
             le_variance =       0.328539570642

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328445276542
                                         uncertainty =       0.006040650105

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328445276542
                                         uncertainty =       0.006040650105

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405239965
  error estimate for blocks of size 2^( 2) =       0.000418607309
  error estimate for blocks of size 2^( 3) =       0.000432153195
  error estimate for blocks of size 2^( 4) =       0.000444530252
  error estimate for blocks of size 2^( 5) =       0.000454815054
  error estimate for blocks of size 2^( 6) =       0.000462543700
  error estimate for blocks of size 2^( 7) =       0.000467427529

      target function =                  N/A
              le_mean =     -16.905247757787
             les_mean =     286.115840446010
             stat err =       0.000457329134
             autocorr =       1.273600437475
              std dev =       0.573095854165
             le_variance =       0.328438858061

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328353596389
                                         uncertainty =       0.006039615627

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328353596389
                                         uncertainty =       0.006039615627

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405183427
  error estimate for blocks of size 2^( 2) =       0.000418560742
  error estimate for blocks of size 2^( 3) =       0.000432115375
  error estimate for blocks of size 2^( 4) =       0.000444497981
  error estimate for blocks of size 2^( 5) =       0.000454786862
  error estimate for blocks of size 2^( 6) =       0.000462517955
  error estimate for blocks of size 2^( 7) =       0.000467404830

      target function =                  N/A
              le_mean =     -16.905247408612
             les_mean =     286.115737000674
             stat err =       0.000457301907
             autocorr =       1.273804206651
              std dev =       0.573015897209
             le_variance =       0.328347218454


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905247371757        initial
     6.2500e+00     6.2500e+01             4.5322e-04       -16.905248319650  <--
     2.5000e+01     2.5000e+02             1.1542e-04       -16.905247757787
     1.0000e+02     1.0000e+03             2.8992e-05       -16.905247408612

*****************************************************************************
Applying the update for shift_i =   6.2500e+00     and shift_s =   6.2500e+01
*****************************************************************************

  Execution time = 2.9927e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.028884e-01 1 1  ON 0
 uu_1                 1.391303e-01 1 1  ON 1
 uu_2                 4.057769e-02 1 1  ON 2
 uu_3                -1.932023e-02 1 1  ON 3
 uu_4                -6.228863e-02 1 1  ON 4
 uu_5                -9.540162e-02 1 1  ON 5
 uu_6                -1.208310e-01 1 1  ON 6
 uu_7                -1.315199e-01 1 1  ON 7
 uu_8                -1.210649e-01 1 1  ON 8
 uu_9                -9.270592e-02 1 1  ON 9
 ud_0                 4.213380e-01 1 1  ON 10
 ud_1                 1.645505e-01 1 1  ON 11
 ud_2                 5.731638e-02 1 1  ON 12
 ud_3                -3.340345e-03 1 1  ON 13
 ud_4                -5.921889e-02 1 1  ON 14
 ud_5                -1.021871e-01 1 1  ON 15
 ud_6                -1.297100e-01 1 1  ON 16
 ud_7                -1.446977e-01 1 1  ON 17
 ud_8                -1.436373e-01 1 1  ON 18
 ud_9                -1.347377e-01 1 1  ON 19
 eO_0                -7.164861e-01 1 1  ON 20
 eO_1                -4.160944e-01 1 1  ON 21
 eO_2                -2.370203e-02 1 1  ON 22
 eO_3                 2.766045e-01 1 1  ON 23
 eO_4                 4.936141e-01 1 1  ON 24
 eO_5                 4.583725e-01 1 1  ON 25
 eO_6                 2.354447e-01 1 1  ON 26
 eO_7                -5.577987e-02 1 1  ON 27
 eO_8                -1.965897e-01 1 1  ON 28
 eO_9                -5.820755e-02 1 1  ON 29
eH1_0                -2.144897e-01 1 1  ON 30
eH1_1                -1.279815e-01 1 1  ON 31
eH1_2                -8.746275e-02 1 1  ON 32
eH1_3                -3.623068e-02 1 1  ON 33
eH1_4                 1.237815e-02 1 1  ON 34
eH1_5                 4.511465e-02 1 1  ON 35
eH1_6                 9.507544e-02 1 1  ON 36
eH1_7                 1.384038e-01 1 1  ON 37
eH1_8                 1.462936e-01 1 1  ON 38
eH1_9                 3.347462e-02 1 1  ON 39
eH2_0                -2.132917e-01 1 1  ON 40
eH2_1                -1.268598e-01 1 1  ON 41
eH2_2                -8.620618e-02 1 1  ON 42
eH2_3                -3.486339e-02 1 1  ON 43
eH2_4                 1.392192e-02 1 1  ON 44
eH2_5                 4.784258e-02 1 1  ON 45
eH2_6                 1.004771e-01 1 1  ON 46
eH2_7                 1.493390e-01 1 1  ON 47
eH2_8                 1.544453e-01 1 1  ON 48
eH2_9                 1.382397e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6032e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6919e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.9055
    reference variance = 0.150489
====================================================
  Execution time = 2.0573e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.2811e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5250e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328132557342
                                         uncertainty =       0.004193016734

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328132557342
                                         uncertainty =       0.004193016734

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405034651
  error estimate for blocks of size 2^( 2) =       0.000418164516
  error estimate for blocks of size 2^( 3) =       0.000431654956
  error estimate for blocks of size 2^( 4) =       0.000444644904
  error estimate for blocks of size 2^( 5) =       0.000454696838
  error estimate for blocks of size 2^( 6) =       0.000462929792
  error estimate for blocks of size 2^( 7) =       0.000467888985

      target function =                  N/A
              le_mean =     -16.905707514593
             les_mean =     286.131052541836
             stat err =       0.000457540130
             autocorr =       1.276068606067
              std dev =       0.572805496590
             le_variance =       0.328106136924


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690570751459e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905707514593       residual = 4.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905725116892       residual = 2.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905738806358       residual = 5.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905740970241       residual = 8.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905750224958       residual = 7.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905750515761       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905750994532       residual = 7.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905750794729       residual = 3.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905750940309       residual = 2.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905750990454       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905751064096       residual = 2.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 1.639681e-03

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905707514593       residual = 4.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905712368659       residual = 2.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905716417150       residual = 5.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905716866035       residual = 7.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905719448108       residual = 5.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905719541315       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905719458879       residual = 4.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905719546472       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905719518949       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905719543346       residual = 3.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 4.398189e-04

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905707514593       residual = 4.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905708760200       residual = 2.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905709820245       residual = 5.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905709928354       residual = 7.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905710589947       residual = 5.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905710618744       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905710588126       residual = 4.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905710608739       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905710601334       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905710607546       residual = 2.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+01 is 1.120841e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.026701 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6105e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.028783e-01 1 1  ON 0
 uu_1                 1.391178e-01 1 1  ON 1
 uu_2                 4.055329e-02 1 1  ON 2
 uu_3                -1.930843e-02 1 1  ON 3
 uu_4                -6.226855e-02 1 1  ON 4
 uu_5                -9.537714e-02 1 1  ON 5
 uu_6                -1.208186e-01 1 1  ON 6
 uu_7                -1.315331e-01 1 1  ON 7
 uu_8                -1.210998e-01 1 1  ON 8
 uu_9                -9.271849e-02 1 1  ON 9
 ud_0                 4.217018e-01 1 1  ON 10
 ud_1                 1.647626e-01 1 1  ON 11
 ud_2                 5.721854e-02 1 1  ON 12
 ud_3                -3.552317e-03 1 1  ON 13
 ud_4                -5.928260e-02 1 1  ON 14
 ud_5                -1.022106e-01 1 1  ON 15
 ud_6                -1.297522e-01 1 1  ON 16
 ud_7                -1.447360e-01 1 1  ON 17
 ud_8                -1.436876e-01 1 1  ON 18
 ud_9                -1.347643e-01 1 1  ON 19
 eO_0                -7.169259e-01 1 1  ON 20
 eO_1                -4.161578e-01 1 1  ON 21
 eO_2                -2.343297e-02 1 1  ON 22
 eO_3                 2.768544e-01 1 1  ON 23
 eO_4                 4.936968e-01 1 1  ON 24
 eO_5                 4.583387e-01 1 1  ON 25
 eO_6                 2.354356e-01 1 1  ON 26
 eO_7                -5.577611e-02 1 1  ON 27
 eO_8                -1.966210e-01 1 1  ON 28
 eO_9                -5.823183e-02 1 1  ON 29
eH1_0                -2.146654e-01 1 1  ON 30
eH1_1                -1.280116e-01 1 1  ON 31
eH1_2                -8.742771e-02 1 1  ON 32
eH1_3                -3.618163e-02 1 1  ON 33
eH1_4                 1.241898e-02 1 1  ON 34
eH1_5                 4.513506e-02 1 1  ON 35
eH1_6                 9.508863e-02 1 1  ON 36
eH1_7                 1.384096e-01 1 1  ON 37
eH1_8                 1.463140e-01 1 1  ON 38
eH1_9                 3.350221e-02 1 1  ON 39
eH2_0                -2.134586e-01 1 1  ON 40
eH2_1                -1.268699e-01 1 1  ON 41
eH2_2                -8.618929e-02 1 1  ON 42
eH2_3                -3.480477e-02 1 1  ON 43
eH2_4                 1.397209e-02 1 1  ON 44
eH2_5                 4.786552e-02 1 1  ON 45
eH2_6                 1.004692e-01 1 1  ON 46
eH2_7                 1.493161e-01 1 1  ON 47
eH2_8                 1.544630e-01 1 1  ON 48
eH2_9                 1.386277e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.9423
    reference variance = 0.22379
====================================================
  Execution time = 2.0313e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3428e-01
  Total weights = 2.0000e+06
  Execution time = 1.9323e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334153025990
                                         uncertainty =       0.006178362015

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334153025990
                                         uncertainty =       0.006178362015

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408706285
  error estimate for blocks of size 2^( 2) =       0.000422039855
  error estimate for blocks of size 2^( 3) =       0.000435886665
  error estimate for blocks of size 2^( 4) =       0.000447961240
  error estimate for blocks of size 2^( 5) =       0.000458317393
  error estimate for blocks of size 2^( 6) =       0.000465444264
  error estimate for blocks of size 2^( 7) =       0.000470221132

      target function =                  N/A
              le_mean =     -16.904776998180
             les_mean =     286.105566845151
             stat err =       0.000460486007
             autocorr =       1.269434344651
              std dev =       0.577997970585
             le_variance =       0.334081654000

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334880164279
                                         uncertainty =       0.006198328700

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334880164279
                                         uncertainty =       0.006198328700

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409150759
  error estimate for blocks of size 2^( 2) =       0.000422411197
  error estimate for blocks of size 2^( 3) =       0.000436195693
  error estimate for blocks of size 2^( 4) =       0.000448232641
  error estimate for blocks of size 2^( 5) =       0.000458574992
  error estimate for blocks of size 2^( 6) =       0.000465691439
  error estimate for blocks of size 2^( 7) =       0.000470487829

      target function =                  N/A
              le_mean =     -16.904785918554
             les_mean =     286.106595472267
             stat err =       0.000460746726
             autocorr =       1.268112525293
              std dev =       0.578626552721
             le_variance =       0.334808687514

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334544564943
                                         uncertainty =       0.006187997128

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334544564943
                                         uncertainty =       0.006187997128

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408945676
  error estimate for blocks of size 2^( 2) =       0.000422238339
  error estimate for blocks of size 2^( 3) =       0.000436050110
  error estimate for blocks of size 2^( 4) =       0.000448103892
  error estimate for blocks of size 2^( 5) =       0.000458452631
  error estimate for blocks of size 2^( 6) =       0.000465573778
  error estimate for blocks of size 2^( 7) =       0.000470361546

      target function =                  N/A
              le_mean =     -16.904780994757
             les_mean =     286.106093444709
             stat err =       0.000460622962
             autocorr =       1.268702883195
              std dev =       0.578336520766
             le_variance =       0.334473131252

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334202200012
                                         uncertainty =       0.006179527301

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334202200012
                                         uncertainty =       0.006179527301

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408736358
  error estimate for blocks of size 2^( 2) =       0.000422064601
  error estimate for blocks of size 2^( 3) =       0.000435906850
  error estimate for blocks of size 2^( 4) =       0.000447978736
  error estimate for blocks of size 2^( 5) =       0.000458333937
  error estimate for blocks of size 2^( 6) =       0.000465460078
  error estimate for blocks of size 2^( 7) =       0.000470238346

      target function =                  N/A
              le_mean =     -16.904777363161
             les_mean =     286.105628350966
             stat err =       0.000460502775
             autocorr =       1.269339986831
              std dev =       0.578040500309
             le_variance =       0.334130819997


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904776998180        initial
     1.5625e+00     1.5625e+01             1.6397e-03       -16.904785918554  <--
     6.2500e+00     6.2500e+01             4.3982e-04       -16.904780994757
     2.5000e+01     2.5000e+02             1.1208e-04       -16.904777363161

*****************************************************************************
Applying the update for shift_i =   1.5625e+00     and shift_s =   1.5625e+01
*****************************************************************************

  Execution time = 3.0094e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.028696e-01 1 1  ON 0
 uu_1                 1.390897e-01 1 1  ON 1
 uu_2                 4.048687e-02 1 1  ON 2
 uu_3                -1.929434e-02 1 1  ON 3
 uu_4                -6.222319e-02 1 1  ON 4
 uu_5                -9.530917e-02 1 1  ON 5
 uu_6                -1.207828e-01 1 1  ON 6
 uu_7                -1.315698e-01 1 1  ON 7
 uu_8                -1.212024e-01 1 1  ON 8
 uu_9                -9.275630e-02 1 1  ON 9
 ud_0                 4.226856e-01 1 1  ON 10
 ud_1                 1.653115e-01 1 1  ON 11
 ud_2                 5.700848e-02 1 1  ON 12
 ud_3                -4.107210e-03 1 1  ON 13
 ud_4                -5.949007e-02 1 1  ON 14
 ud_5                -1.022763e-01 1 1  ON 15
 ud_6                -1.298594e-01 1 1  ON 16
 ud_7                -1.448390e-01 1 1  ON 17
 ud_8                -1.438303e-01 1 1  ON 18
 ud_9                -1.348413e-01 1 1  ON 19
 eO_0                -7.181258e-01 1 1  ON 20
 eO_1                -4.163667e-01 1 1  ON 21
 eO_2                -2.272582e-02 1 1  ON 22
 eO_3                 2.775581e-01 1 1  ON 23
 eO_4                 4.939613e-01 1 1  ON 24
 eO_5                 4.582600e-01 1 1  ON 25
 eO_6                 2.354110e-01 1 1  ON 26
 eO_7                -5.576335e-02 1 1  ON 27
 eO_8                -1.967138e-01 1 1  ON 28
 eO_9                -5.830452e-02 1 1  ON 29
eH1_0                -2.151707e-01 1 1  ON 30
eH1_1                -1.281030e-01 1 1  ON 31
eH1_2                -8.732410e-02 1 1  ON 32
eH1_3                -3.604979e-02 1 1  ON 33
eH1_4                 1.253122e-02 1 1  ON 34
eH1_5                 4.519558e-02 1 1  ON 35
eH1_6                 9.513222e-02 1 1  ON 36
eH1_7                 1.384291e-01 1 1  ON 37
eH1_8                 1.463760e-01 1 1  ON 38
eH1_9                 3.358560e-02 1 1  ON 39
eH2_0                -2.139372e-01 1 1  ON 40
eH2_1                -1.269106e-01 1 1  ON 41
eH2_2                -8.613065e-02 1 1  ON 42
eH2_3                -3.464769e-02 1 1  ON 43
eH2_4                 1.411290e-02 1 1  ON 44
eH2_5                 4.793456e-02 1 1  ON 45
eH2_6                 1.004508e-01 1 1  ON 46
eH2_7                 1.492494e-01 1 1  ON 47
eH2_8                 1.545166e-01 1 1  ON 48
eH2_9                 1.397972e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6205e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6920e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.9489
    reference variance = 0.328078
====================================================
  Execution time = 2.2818e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2706e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5824e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327079475647
                                         uncertainty =       0.006255390768

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327079475647
                                         uncertainty =       0.006255390768

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404385664
  error estimate for blocks of size 2^( 2) =       0.000417755219
  error estimate for blocks of size 2^( 3) =       0.000430885917
  error estimate for blocks of size 2^( 4) =       0.000443728602
  error estimate for blocks of size 2^( 5) =       0.000454776503
  error estimate for blocks of size 2^( 6) =       0.000463228493
  error estimate for blocks of size 2^( 7) =       0.000468292982

      target function =                  N/A
              le_mean =     -16.904760470222
             les_mean =     286.097981922219
             stat err =       0.000457506645
             autocorr =       1.279980375817
              std dev =       0.571887690183
             le_variance =       0.327055530183


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690476047022e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904760470222       residual = 3.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904782066878       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904798770540       residual = 4.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904821924282       residual = 8.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904834271783       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904842537391       residual = 4.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904843962991       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904841784836       residual = 9.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.904840850022       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.904842090543       residual = 9.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.904842341174       residual = 2.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.904842359610       residual = 5.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 4.706032e-03

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904760470222       residual = 3.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904767827492       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904773836575       residual = 4.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904778053377       residual = 7.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904784493312       residual = 6.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904786451302       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904787064136       residual = 6.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904786845998       residual = 2.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.904786469500       residual = 2.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.904786547250       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.904786559385       residual = 2.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 1.407815e-03

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904760470222       residual = 3.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904762492931       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904764195072       residual = 4.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904765110133       residual = 6.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904766887803       residual = 6.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904767297473       residual = 3.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904767588695       residual = 4.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904767559406       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.904767497961       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.904767501409       residual = 5.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 3.717717e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.031057 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8408e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.029575e-01 1 1  ON 0
 uu_1                 1.390724e-01 1 1  ON 1
 uu_2                 4.039683e-02 1 1  ON 2
 uu_3                -1.930555e-02 1 1  ON 3
 uu_4                -6.215937e-02 1 1  ON 4
 uu_5                -9.524505e-02 1 1  ON 5
 uu_6                -1.207459e-01 1 1  ON 6
 uu_7                -1.316022e-01 1 1  ON 7
 uu_8                -1.213086e-01 1 1  ON 8
 uu_9                -9.286220e-02 1 1  ON 9
 ud_0                 4.239927e-01 1 1  ON 10
 ud_1                 1.659926e-01 1 1  ON 11
 ud_2                 5.679565e-02 1 1  ON 12
 ud_3                -4.783639e-03 1 1  ON 13
 ud_4                -5.983041e-02 1 1  ON 14
 ud_5                -1.023109e-01 1 1  ON 15
 ud_6                -1.299862e-01 1 1  ON 16
 ud_7                -1.450367e-01 1 1  ON 17
 ud_8                -1.440858e-01 1 1  ON 18
 ud_9                -1.349626e-01 1 1  ON 19
 eO_0                -7.195336e-01 1 1  ON 20
 eO_1                -4.168244e-01 1 1  ON 21
 eO_2                -2.190392e-02 1 1  ON 22
 eO_3                 2.785143e-01 1 1  ON 23
 eO_4                 4.943702e-01 1 1  ON 24
 eO_5                 4.581903e-01 1 1  ON 25
 eO_6                 2.353937e-01 1 1  ON 26
 eO_7                -5.573640e-02 1 1  ON 27
 eO_8                -1.968490e-01 1 1  ON 28
 eO_9                -5.841381e-02 1 1  ON 29
eH1_0                -2.157831e-01 1 1  ON 30
eH1_1                -1.281764e-01 1 1  ON 31
eH1_2                -8.718560e-02 1 1  ON 32
eH1_3                -3.585293e-02 1 1  ON 33
eH1_4                 1.259787e-02 1 1  ON 34
eH1_5                 4.522034e-02 1 1  ON 35
eH1_6                 9.514685e-02 1 1  ON 36
eH1_7                 1.384840e-01 1 1  ON 37
eH1_8                 1.465017e-01 1 1  ON 38
eH1_9                 3.367185e-02 1 1  ON 39
eH2_0                -2.145256e-01 1 1  ON 40
eH2_1                -1.270342e-01 1 1  ON 41
eH2_2                -8.597633e-02 1 1  ON 42
eH2_3                -3.444625e-02 1 1  ON 43
eH2_4                 1.428859e-02 1 1  ON 44
eH2_5                 4.795554e-02 1 1  ON 45
eH2_6                 1.004294e-01 1 1  ON 46
eH2_7                 1.491969e-01 1 1  ON 47
eH2_8                 1.546378e-01 1 1  ON 48
eH2_9                 1.410871e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.8228
    reference variance = 0.14726
====================================================
  Execution time = 2.0056e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3878e-01
  Total weights = 2.0000e+06
  Execution time = 1.9179e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337860445116
                                         uncertainty =       0.004968359000

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337860445116
                                         uncertainty =       0.004968359000

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411089179
  error estimate for blocks of size 2^( 2) =       0.000424427678
  error estimate for blocks of size 2^( 3) =       0.000438019864
  error estimate for blocks of size 2^( 4) =       0.000451023561
  error estimate for blocks of size 2^( 5) =       0.000462615907
  error estimate for blocks of size 2^( 6) =       0.000470999000
  error estimate for blocks of size 2^( 7) =       0.000476481051

      target function =                  N/A
              le_mean =     -16.904845777332
             les_mean =     286.111799212889
             stat err =       0.000465279880
             autocorr =       1.281021607045
              std dev =       0.581367892549
             le_variance =       0.337988626487

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340261081783
                                         uncertainty =       0.005028932765

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340261081783
                                         uncertainty =       0.005028932765

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412548918
  error estimate for blocks of size 2^( 2) =       0.000425714144
  error estimate for blocks of size 2^( 3) =       0.000439142015
  error estimate for blocks of size 2^( 4) =       0.000452037444
  error estimate for blocks of size 2^( 5) =       0.000463548236
  error estimate for blocks of size 2^( 6) =       0.000471954583
  error estimate for blocks of size 2^( 7) =       0.000477459090

      target function =                  N/A
              le_mean =     -16.904866354972
             les_mean =     286.114899528170
             stat err =       0.000466249838
             autocorr =       1.277281093190
              std dev =       0.583432274464
             le_variance =       0.340393218886

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339474565003
                                         uncertainty =       0.005009733843

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339474565003
                                         uncertainty =       0.005009733843

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412071257
  error estimate for blocks of size 2^( 2) =       0.000425290049
  error estimate for blocks of size 2^( 3) =       0.000438769204
  error estimate for blocks of size 2^( 4) =       0.000451699219
  error estimate for blocks of size 2^( 5) =       0.000463233525
  error estimate for blocks of size 2^( 6) =       0.000471631610
  error estimate for blocks of size 2^( 7) =       0.000477125801

      target function =                  N/A
              le_mean =     -16.904855074615
             les_mean =     286.113730365470
             stat err =       0.000465922539
             autocorr =       1.278447195777
              std dev =       0.582756760172
             le_variance =       0.339605441526

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338076589408
                                         uncertainty =       0.004974111500

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338076589408
                                         uncertainty =       0.004974111500

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411220832
  error estimate for blocks of size 2^( 2) =       0.000424542059
  error estimate for blocks of size 2^( 3) =       0.000438118064
  error estimate for blocks of size 2^( 4) =       0.000451111303
  error estimate for blocks of size 2^( 5) =       0.000462695368
  error estimate for blocks of size 2^( 6) =       0.000471080472
  error estimate for blocks of size 2^( 7) =       0.000476564148

      target function =                  N/A
              le_mean =     -16.904845573124
             les_mean =     286.112008827409
             stat err =       0.000465362823
             autocorr =       1.280657966032
              std dev =       0.581554077733
             le_variance =       0.338205145327


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904845777332        initial
     3.9062e-01     3.9062e+00             4.7060e-03       -16.904866354972  <--
     1.5625e+00     1.5625e+01             1.4078e-03       -16.904855074615
     6.2500e+00     6.2500e+01             3.7177e-04       -16.904845573124

*****************************************************************************
Applying the update for shift_i =   3.9062e-01     and shift_s =   3.9062e+00
*****************************************************************************

  Execution time = 2.9766e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.032618e-01 1 1  ON 0
 uu_1                 1.391113e-01 1 1  ON 1
 uu_2                 4.022861e-02 1 1  ON 2
 uu_3                -1.943079e-02 1 1  ON 3
 uu_4                -6.212519e-02 1 1  ON 4
 uu_5                -9.509991e-02 1 1  ON 5
 uu_6                -1.206396e-01 1 1  ON 6
 uu_7                -1.316633e-01 1 1  ON 7
 uu_8                -1.215933e-01 1 1  ON 8
 uu_9                -9.317150e-02 1 1  ON 9
 ud_0                 4.267065e-01 1 1  ON 10
 ud_1                 1.674085e-01 1 1  ON 11
 ud_2                 5.667368e-02 1 1  ON 12
 ud_3                -6.054338e-03 1 1  ON 13
 ud_4                -6.070219e-02 1 1  ON 14
 ud_5                -1.024953e-01 1 1  ON 15
 ud_6                -1.302039e-01 1 1  ON 16
 ud_7                -1.454508e-01 1 1  ON 17
 ud_8                -1.447356e-01 1 1  ON 18
 ud_9                -1.352978e-01 1 1  ON 19
 eO_0                -7.228318e-01 1 1  ON 20
 eO_1                -4.180365e-01 1 1  ON 21
 eO_2                -2.033555e-02 1 1  ON 22
 eO_3                 2.807986e-01 1 1  ON 23
 eO_4                 4.956729e-01 1 1  ON 24
 eO_5                 4.582138e-01 1 1  ON 25
 eO_6                 2.353845e-01 1 1  ON 26
 eO_7                -5.564299e-02 1 1  ON 27
 eO_8                -1.972325e-01 1 1  ON 28
 eO_9                -5.873300e-02 1 1  ON 29
eH1_0                -2.173323e-01 1 1  ON 30
eH1_1                -1.283985e-01 1 1  ON 31
eH1_2                -8.689166e-02 1 1  ON 32
eH1_3                -3.541013e-02 1 1  ON 33
eH1_4                 1.272081e-02 1 1  ON 34
eH1_5                 4.528434e-02 1 1  ON 35
eH1_6                 9.524039e-02 1 1  ON 36
eH1_7                 1.386679e-01 1 1  ON 37
eH1_8                 1.468784e-01 1 1  ON 38
eH1_9                 3.393037e-02 1 1  ON 39
eH2_0                -2.160296e-01 1 1  ON 40
eH2_1                -1.273483e-01 1 1  ON 41
eH2_2                -8.564380e-02 1 1  ON 42
eH2_3                -3.396291e-02 1 1  ON 43
eH2_4                 1.467068e-02 1 1  ON 44
eH2_5                 4.802962e-02 1 1  ON 45
eH2_6                 1.004194e-01 1 1  ON 46
eH2_7                 1.490641e-01 1 1  ON 47
eH2_8                 1.549933e-01 1 1  ON 48
eH2_9                 1.448984e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8180e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6914e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.8186
    reference variance = 0.248362
====================================================
  Execution time = 2.0606e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4027e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5528e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340322857360
                                         uncertainty =       0.007075222056

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340322857360
                                         uncertainty =       0.007075222056

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412477126
  error estimate for blocks of size 2^( 2) =       0.000425633791
  error estimate for blocks of size 2^( 3) =       0.000439095679
  error estimate for blocks of size 2^( 4) =       0.000451552466
  error estimate for blocks of size 2^( 5) =       0.000463791321
  error estimate for blocks of size 2^( 6) =       0.000473649682
  error estimate for blocks of size 2^( 7) =       0.000481447842

      target function =                  N/A
              le_mean =     -16.904848422271
             les_mean =     286.114174768434
             stat err =       0.000467610328
             autocorr =       1.285193292519
              std dev =       0.583330745484
             le_variance =       0.340274758627


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690484842227e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904848422271       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904871152097       residual = 7.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904914355639       residual = 3.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904943635456       residual = 1.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904948792519       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904955080816       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904963365018       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904966232874       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.904964901798       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.904964784470       residual = 6.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.904965224006       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.904966845479       residual = 8.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.904966175354       residual = 3.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.904966521012       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.904966681214       residual = 3.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-02 is 1.065610e-02

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904848422271       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904859956799       residual = 7.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904882521298       residual = 3.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904892545516       residual = 4.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904897051661       residual = 8.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904898214497       residual = 3.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904900225752       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904901499672       residual = 6.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.904901332136       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.904900881286       residual = 6.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.904900889361       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.904901118233       residual = 3.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 3.997939e-03

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904848422271       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904852305745       residual = 7.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904860131245       residual = 3.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904862511948       residual = 3.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904864716494       residual = 5.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904865013447       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904865267383       residual = 3.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904865565215       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.904865556151       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.904865477028       residual = 7.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 1.193541e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.036492 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6168e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.037192e-01 1 1  ON 0
 uu_1                 1.391113e-01 1 1  ON 1
 uu_2                 3.988930e-02 1 1  ON 2
 uu_3                -1.980173e-02 1 1  ON 3
 uu_4                -6.237196e-02 1 1  ON 4
 uu_5                -9.511005e-02 1 1  ON 5
 uu_6                -1.207204e-01 1 1  ON 6
 uu_7                -1.319337e-01 1 1  ON 7
 uu_8                -1.217983e-01 1 1  ON 8
 uu_9                -9.299966e-02 1 1  ON 9
 ud_0                 4.294420e-01 1 1  ON 10
 ud_1                 1.685932e-01 1 1  ON 11
 ud_2                 5.635795e-02 1 1  ON 12
 ud_3                -7.532864e-03 1 1  ON 13
 ud_4                -6.180503e-02 1 1  ON 14
 ud_5                -1.030472e-01 1 1  ON 15
 ud_6                -1.302894e-01 1 1  ON 16
 ud_7                -1.458740e-01 1 1  ON 17
 ud_8                -1.451148e-01 1 1  ON 18
 ud_9                -1.351142e-01 1 1  ON 19
 eO_0                -7.268298e-01 1 1  ON 20
 eO_1                -4.193237e-01 1 1  ON 21
 eO_2                -1.856694e-02 1 1  ON 22
 eO_3                 2.831077e-01 1 1  ON 23
 eO_4                 4.974015e-01 1 1  ON 24
 eO_5                 4.582912e-01 1 1  ON 25
 eO_6                 2.351114e-01 1 1  ON 26
 eO_7                -5.558042e-02 1 1  ON 27
 eO_8                -1.974155e-01 1 1  ON 28
 eO_9                -5.893322e-02 1 1  ON 29
eH1_0                -2.193356e-01 1 1  ON 30
eH1_1                -1.287936e-01 1 1  ON 31
eH1_2                -8.663141e-02 1 1  ON 32
eH1_3                -3.519059e-02 1 1  ON 33
eH1_4                 1.298771e-02 1 1  ON 34
eH1_5                 4.538508e-02 1 1  ON 35
eH1_6                 9.552308e-02 1 1  ON 36
eH1_7                 1.389649e-01 1 1  ON 37
eH1_8                 1.472964e-01 1 1  ON 38
eH1_9                 3.439413e-02 1 1  ON 39
eH2_0                -2.179541e-01 1 1  ON 40
eH2_1                -1.276143e-01 1 1  ON 41
eH2_2                -8.546346e-02 1 1  ON 42
eH2_3                -3.357136e-02 1 1  ON 43
eH2_4                 1.474735e-02 1 1  ON 44
eH2_5                 4.825116e-02 1 1  ON 45
eH2_6                 1.005320e-01 1 1  ON 46
eH2_7                 1.489914e-01 1 1  ON 47
eH2_8                 1.554934e-01 1 1  ON 48
eH2_9                 1.513368e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.871
    reference variance = 0.272858
====================================================
  Execution time = 2.0254e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4326e-01
  Total weights = 2.0000e+06
  Execution time = 1.9377e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341366589203
                                         uncertainty =       0.007218492854

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341366589203
                                         uncertainty =       0.007218492854

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413110749
  error estimate for blocks of size 2^( 2) =       0.000425817242
  error estimate for blocks of size 2^( 3) =       0.000439074386
  error estimate for blocks of size 2^( 4) =       0.000450603487
  error estimate for blocks of size 2^( 5) =       0.000461432002
  error estimate for blocks of size 2^( 6) =       0.000467869817
  error estimate for blocks of size 2^( 7) =       0.000470184201

      target function =                  N/A
              le_mean =     -16.905248265803
             les_mean =     286.128739739395
             stat err =       0.000462522377
             autocorr =       1.253523577351
              std dev =       0.584226823783
             le_variance =       0.341320981627

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345623216502
                                         uncertainty =       0.007213805214

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345623216502
                                         uncertainty =       0.007213805214

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415677939
  error estimate for blocks of size 2^( 2) =       0.000428157928
  error estimate for blocks of size 2^( 3) =       0.000441205256
  error estimate for blocks of size 2^( 4) =       0.000452561091
  error estimate for blocks of size 2^( 5) =       0.000463299444
  error estimate for blocks of size 2^( 6) =       0.000469629111
  error estimate for blocks of size 2^( 7) =       0.000471829169

      target function =                  N/A
              le_mean =     -16.905249176049
             les_mean =     286.133025828651
             stat err =       0.000464329703
             autocorr =       1.247782763569
              std dev =       0.587857378239
             le_variance =       0.345576297150

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345387312392
                                         uncertainty =       0.007211059423

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345387312392
                                         uncertainty =       0.007211059423

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415536058
  error estimate for blocks of size 2^( 2) =       0.000428025808
  error estimate for blocks of size 2^( 3) =       0.000441088273
  error estimate for blocks of size 2^( 4) =       0.000452459688
  error estimate for blocks of size 2^( 5) =       0.000463215696
  error estimate for blocks of size 2^( 6) =       0.000469557248
  error estimate for blocks of size 2^( 7) =       0.000471767895

      target function =                  N/A
              le_mean =     -16.905242859383
             les_mean =     286.132576393420
             stat err =       0.000464250132
             autocorr =       1.248207074184
              std dev =       0.587656729184
             le_variance =       0.345340431355

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342007329231
                                         uncertainty =       0.007217016737

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342007329231
                                         uncertainty =       0.007217016737

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413498185
  error estimate for blocks of size 2^( 2) =       0.000426165166
  error estimate for blocks of size 2^( 3) =       0.000439387755
  error estimate for blocks of size 2^( 4) =       0.000450889476
  error estimate for blocks of size 2^( 5) =       0.000461706058
  error estimate for blocks of size 2^( 6) =       0.000468127784
  error estimate for blocks of size 2^( 7) =       0.000470425129

      target function =                  N/A
              le_mean =     -16.905240120153
             les_mean =     286.129104847606
             stat err =       0.000462787112
             autocorr =       1.252608328828
              std dev =       0.584774741725
             le_variance =       0.341961498560


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905248265803        initial
     9.7656e-02     9.7656e-01             1.0656e-02       -16.905249176049  <--
     3.9062e-01     3.9062e+00             3.9979e-03       -16.905242859383
     1.5625e+00     1.5625e+01             1.1935e-03       -16.905240120153

*****************************************************************************
Applying the update for shift_i =   9.7656e-02     and shift_s =   9.7656e-01
*****************************************************************************

  Execution time = 3.0025e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.046444e-01 1 1  ON 0
 uu_1                 1.393366e-01 1 1  ON 1
 uu_2                 3.951836e-02 1 1  ON 2
 uu_3                -2.062016e-02 1 1  ON 3
 uu_4                -6.328618e-02 1 1  ON 4
 uu_5                -9.565451e-02 1 1  ON 5
 uu_6                -1.210452e-01 1 1  ON 6
 uu_7                -1.324952e-01 1 1  ON 7
 uu_8                -1.224390e-01 1 1  ON 8
 uu_9                -9.264600e-02 1 1  ON 9
 ud_0                 4.327695e-01 1 1  ON 10
 ud_1                 1.703949e-01 1 1  ON 11
 ud_2                 5.650873e-02 1 1  ON 12
 ud_3                -9.062540e-03 1 1  ON 13
 ud_4                -6.368399e-02 1 1  ON 14
 ud_5                -1.042740e-01 1 1  ON 15
 ud_6                -1.307487e-01 1 1  ON 16
 ud_7                -1.464139e-01 1 1  ON 17
 ud_8                -1.459148e-01 1 1  ON 18
 ud_9                -1.346605e-01 1 1  ON 19
 eO_0                -7.334879e-01 1 1  ON 20
 eO_1                -4.225051e-01 1 1  ON 21
 eO_2                -1.716170e-02 1 1  ON 22
 eO_3                 2.869530e-01 1 1  ON 23
 eO_4                 5.014922e-01 1 1  ON 24
 eO_5                 4.598361e-01 1 1  ON 25
 eO_6                 2.350298e-01 1 1  ON 26
 eO_7                -5.536525e-02 1 1  ON 27
 eO_8                -1.979738e-01 1 1  ON 28
 eO_9                -5.954068e-02 1 1  ON 29
eH1_0                -2.230683e-01 1 1  ON 30
eH1_1                -1.299150e-01 1 1  ON 31
eH1_2                -8.678880e-02 1 1  ON 32
eH1_3                -3.517498e-02 1 1  ON 33
eH1_4                 1.304394e-02 1 1  ON 34
eH1_5                 4.543178e-02 1 1  ON 35
eH1_6                 9.635974e-02 1 1  ON 36
eH1_7                 1.400393e-01 1 1  ON 37
eH1_8                 1.485966e-01 1 1  ON 38
eH1_9                 3.580151e-02 1 1  ON 39
eH2_0                -2.214913e-01 1 1  ON 40
eH2_1                -1.285550e-01 1 1  ON 41
eH2_2                -8.561395e-02 1 1  ON 42
eH2_3                -3.338460e-02 1 1  ON 43
eH2_4                 1.461727e-02 1 1  ON 44
eH2_5                 4.841258e-02 1 1  ON 45
eH2_6                 1.009893e-01 1 1  ON 46
eH2_7                 1.490879e-01 1 1  ON 47
eH2_8                 1.570073e-01 1 1  ON 48
eH2_9                 1.706043e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6197e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.8842
    reference variance = 0.410304
====================================================
  Execution time = 2.0582e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.3335e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5309e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333144814062
                                         uncertainty =       0.004950003179

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333144814062
                                         uncertainty =       0.004950003179

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408255984
  error estimate for blocks of size 2^( 2) =       0.000421208615
  error estimate for blocks of size 2^( 3) =       0.000434728110
  error estimate for blocks of size 2^( 4) =       0.000447790515
  error estimate for blocks of size 2^( 5) =       0.000458027938
  error estimate for blocks of size 2^( 6) =       0.000466601589
  error estimate for blocks of size 2^( 7) =       0.000471492468

      target function =                  N/A
              le_mean =     -16.904200517812
             les_mean =     286.085340876839
             stat err =       0.000460978128
             autocorr =       1.274956949673
              std dev =       0.577361149638
             le_variance =       0.333345897111


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690420051781e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-02, overlap shift 2.4414e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904200517812       residual = 2.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904208387380       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904218760334       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904226968494       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904235076404       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904248578067       residual = 5.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904249944227       residual = 4.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904255085816       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.904258665986       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.904257659747       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.904258182310       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.904264075821       residual = 7.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.904266414407       residual = 3.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.904267365284       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.904268156637       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.904268951766       residual = 6.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.904269765658       residual = 4.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.904269747906       residual = 2.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.904269823061       residual = 8.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-02 is 1.429225e-02

solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904200517812       residual = 2.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904206423078       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904214534878       residual = 9.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904220822298       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904225002766       residual = 7.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904231202511       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904230815108       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904232061865       residual = 9.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.904232622280       residual = 4.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.904232040145       residual = 3.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.904231668677       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.904232532120       residual = 4.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.904233061374       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.904232894237       residual = 6.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-02 is 6.262594e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904200517812       residual = 2.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904203472764       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904207862878       residual = 7.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904210510394       residual = 7.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904211901729       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904213043640       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904213274274       residual = 2.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904213043260       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.904213188666       residual = 4.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.904213126247       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.904213016291       residual = 5.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 2.160005e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.045015 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6125e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.053019e-01 1 1  ON 0
 uu_1                 1.394189e-01 1 1  ON 1
 uu_2                 3.898419e-02 1 1  ON 2
 uu_3                -2.145777e-02 1 1  ON 3
 uu_4                -6.426667e-02 1 1  ON 4
 uu_5                -9.676745e-02 1 1  ON 5
 uu_6                -1.214007e-01 1 1  ON 6
 uu_7                -1.323947e-01 1 1  ON 7
 uu_8                -1.225512e-01 1 1  ON 8
 uu_9                -9.244550e-02 1 1  ON 9
 ud_0                 4.356578e-01 1 1  ON 10
 ud_1                 1.724590e-01 1 1  ON 11
 ud_2                 5.727461e-02 1 1  ON 12
 ud_3                -9.804102e-03 1 1  ON 13
 ud_4                -6.517315e-02 1 1  ON 14
 ud_5                -1.052332e-01 1 1  ON 15
 ud_6                -1.316610e-01 1 1  ON 16
 ud_7                -1.471635e-01 1 1  ON 17
 ud_8                -1.468815e-01 1 1  ON 18
 ud_9                -1.344125e-01 1 1  ON 19
 eO_0                -7.397505e-01 1 1  ON 20
 eO_1                -4.258856e-01 1 1  ON 21
 eO_2                -1.717837e-02 1 1  ON 22
 eO_3                 2.907960e-01 1 1  ON 23
 eO_4                 5.058850e-01 1 1  ON 24
 eO_5                 4.621638e-01 1 1  ON 25
 eO_6                 2.364726e-01 1 1  ON 26
 eO_7                -5.470915e-02 1 1  ON 27
 eO_8                -1.994760e-01 1 1  ON 28
 eO_9                -6.082188e-02 1 1  ON 29
eH1_0                -2.263045e-01 1 1  ON 30
eH1_1                -1.315934e-01 1 1  ON 31
eH1_2                -8.779159e-02 1 1  ON 32
eH1_3                -3.531170e-02 1 1  ON 33
eH1_4                 1.260121e-02 1 1  ON 34
eH1_5                 4.552425e-02 1 1  ON 35
eH1_6                 9.721989e-02 1 1  ON 36
eH1_7                 1.414320e-01 1 1  ON 37
eH1_8                 1.509845e-01 1 1  ON 38
eH1_9                 3.729891e-02 1 1  ON 39
eH2_0                -2.245832e-01 1 1  ON 40
eH2_1                -1.299545e-01 1 1  ON 41
eH2_2                -8.617508e-02 1 1  ON 42
eH2_3                -3.393628e-02 1 1  ON 43
eH2_4                 1.400358e-02 1 1  ON 44
eH2_5                 4.773741e-02 1 1  ON 45
eH2_6                 1.023988e-01 1 1  ON 46
eH2_7                 1.497476e-01 1 1  ON 47
eH2_8                 1.593554e-01 1 1  ON 48
eH2_9                 1.944876e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.9344
    reference variance = 0.325844
====================================================
  Execution time = 2.0370e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3347e-01
  Total weights = 2.0000e+06
  Execution time = 1.9202e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331657995591
                                         uncertainty =       0.004295671723

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331657995591
                                         uncertainty =       0.004295671723

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407212264
  error estimate for blocks of size 2^( 2) =       0.000420002883
  error estimate for blocks of size 2^( 3) =       0.000433563944
  error estimate for blocks of size 2^( 4) =       0.000445688233
  error estimate for blocks of size 2^( 5) =       0.000456097581
  error estimate for blocks of size 2^( 6) =       0.000464778603
  error estimate for blocks of size 2^( 7) =       0.000469625835

      target function =                  N/A
              le_mean =     -16.905466575097
             les_mean =     286.126443611385
             stat err =       0.000459047563
             autocorr =       1.270789666405
              std dev =       0.575885106157
             le_variance =       0.331643655493

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335233647100
                                         uncertainty =       0.004335315438

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335233647100
                                         uncertainty =       0.004335315438

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409401380
  error estimate for blocks of size 2^( 2) =       0.000422098358
  error estimate for blocks of size 2^( 3) =       0.000435534969
  error estimate for blocks of size 2^( 4) =       0.000447549252
  error estimate for blocks of size 2^( 5) =       0.000457880363
  error estimate for blocks of size 2^( 6) =       0.000466396380
  error estimate for blocks of size 2^( 7) =       0.000471251302

      target function =                  N/A
              le_mean =     -16.905477628421
             les_mean =     286.130392656605
             stat err =       0.000460769324
             autocorr =       1.266684665092
              std dev =       0.578980983421
             le_variance =       0.335218979163

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335427720878
                                         uncertainty =       0.004336064245

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335427720878
                                         uncertainty =       0.004336064245

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409519887
  error estimate for blocks of size 2^( 2) =       0.000422206111
  error estimate for blocks of size 2^( 3) =       0.000435644534
  error estimate for blocks of size 2^( 4) =       0.000447675052
  error estimate for blocks of size 2^( 5) =       0.000458039594
  error estimate for blocks of size 2^( 6) =       0.000466559559
  error estimate for blocks of size 2^( 7) =       0.000471436760

      target function =                  N/A
              le_mean =     -16.905484372094
             les_mean =     286.130814762914
             stat err =       0.000460927741
             autocorr =       1.266822305615
              std dev =       0.579148578086
             le_variance =       0.335413075499

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332383624893
                                         uncertainty =       0.004304485257

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332383624893
                                         uncertainty =       0.004304485257

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407657450
  error estimate for blocks of size 2^( 2) =       0.000420422110
  error estimate for blocks of size 2^( 3) =       0.000433955992
  error estimate for blocks of size 2^( 4) =       0.000446061846
  error estimate for blocks of size 2^( 5) =       0.000456464765
  error estimate for blocks of size 2^( 6) =       0.000465115059
  error estimate for blocks of size 2^( 7) =       0.000469970044

      target function =                  N/A
              le_mean =     -16.905463212045
             les_mean =     286.127055441422
             stat err =       0.000459402929
             autocorr =       1.269979617037
              std dev =       0.576514695216
             le_variance =       0.332369193800


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905466575097        initial
     2.4414e-02     2.4414e-01             1.4292e-02       -16.905477628421
     9.7656e-02     9.7656e-01             6.2626e-03       -16.905484372094  <--
     3.9062e-01     3.9062e+00             2.1600e-03       -16.905463212045

*****************************************************************************
Applying the update for shift_i =   9.7656e-02     and shift_s =   9.7656e-01
*****************************************************************************

  Execution time = 3.0132e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.053019e-01 1 1  ON 0
 uu_1                 1.394189e-01 1 1  ON 1
 uu_2                 3.898419e-02 1 1  ON 2
 uu_3                -2.145777e-02 1 1  ON 3
 uu_4                -6.426667e-02 1 1  ON 4
 uu_5                -9.676745e-02 1 1  ON 5
 uu_6                -1.214007e-01 1 1  ON 6
 uu_7                -1.323947e-01 1 1  ON 7
 uu_8                -1.225512e-01 1 1  ON 8
 uu_9                -9.244550e-02 1 1  ON 9
 ud_0                 4.356578e-01 1 1  ON 10
 ud_1                 1.724590e-01 1 1  ON 11
 ud_2                 5.727461e-02 1 1  ON 12
 ud_3                -9.804102e-03 1 1  ON 13
 ud_4                -6.517315e-02 1 1  ON 14
 ud_5                -1.052332e-01 1 1  ON 15
 ud_6                -1.316610e-01 1 1  ON 16
 ud_7                -1.471635e-01 1 1  ON 17
 ud_8                -1.468815e-01 1 1  ON 18
 ud_9                -1.344125e-01 1 1  ON 19
 eO_0                -7.397505e-01 1 1  ON 20
 eO_1                -4.258856e-01 1 1  ON 21
 eO_2                -1.717837e-02 1 1  ON 22
 eO_3                 2.907960e-01 1 1  ON 23
 eO_4                 5.058850e-01 1 1  ON 24
 eO_5                 4.621638e-01 1 1  ON 25
 eO_6                 2.364726e-01 1 1  ON 26
 eO_7                -5.470915e-02 1 1  ON 27
 eO_8                -1.994760e-01 1 1  ON 28
 eO_9                -6.082188e-02 1 1  ON 29
eH1_0                -2.263045e-01 1 1  ON 30
eH1_1                -1.315934e-01 1 1  ON 31
eH1_2                -8.779159e-02 1 1  ON 32
eH1_3                -3.531170e-02 1 1  ON 33
eH1_4                 1.260121e-02 1 1  ON 34
eH1_5                 4.552425e-02 1 1  ON 35
eH1_6                 9.721989e-02 1 1  ON 36
eH1_7                 1.414320e-01 1 1  ON 37
eH1_8                 1.509845e-01 1 1  ON 38
eH1_9                 3.729891e-02 1 1  ON 39
eH2_0                -2.245832e-01 1 1  ON 40
eH2_1                -1.299545e-01 1 1  ON 41
eH2_2                -8.617508e-02 1 1  ON 42
eH2_3                -3.393628e-02 1 1  ON 43
eH2_4                 1.400358e-02 1 1  ON 44
eH2_5                 4.773741e-02 1 1  ON 45
eH2_6                 1.023988e-01 1 1  ON 46
eH2_7                 1.497476e-01 1 1  ON 47
eH2_8                 1.593554e-01 1 1  ON 48
eH2_9                 1.944876e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6290e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.8982
    reference variance = 0.199063
====================================================
  Execution time = 2.0790e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3253e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5266e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332569920335
                                         uncertainty =       0.002947819938

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332569920335
                                         uncertainty =       0.002947819938

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407757855
  error estimate for blocks of size 2^( 2) =       0.000420651913
  error estimate for blocks of size 2^( 3) =       0.000433832884
  error estimate for blocks of size 2^( 4) =       0.000445917118
  error estimate for blocks of size 2^( 5) =       0.000456988395
  error estimate for blocks of size 2^( 6) =       0.000466133989
  error estimate for blocks of size 2^( 7) =       0.000471542953

      target function =                  N/A
              le_mean =     -16.905806597414
             les_mean =     286.138829479379
             stat err =       0.000460145614
             autocorr =       1.273461741226
              std dev =       0.576656688567
             le_variance =       0.332532936469


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690580659741e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-02, overlap shift 2.4414e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905806597414       residual = 8.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905809805746       residual = 6.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905814418299       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905816037728       residual = 6.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905824280651       residual = 4.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905825228150       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905826821716       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905831052689       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905830995933       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905830738844       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905833607664       residual = 7.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905835748327       residual = 3.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905838917727       residual = 2.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905839525339       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.905838810542       residual = 5.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.905839234329       residual = 4.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.905839390648       residual = 1.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.905838831886       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.905838993022       residual = 4.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-02 is 1.045501e-02

solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905806597414       residual = 8.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905809051805       residual = 5.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905812206824       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905813846033       residual = 4.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905816894026       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905816815532       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905818471324       residual = 6.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905819215358       residual = 3.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905818187817       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905818625664       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905818557106       residual = 7.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905818850248       residual = 2.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905819444215       residual = 7.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-02 is 4.121598e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905806597414       residual = 8.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905807862578       residual = 4.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905809610337       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905810756699       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905810325727       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905810653648       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905811127392       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905811069031       residual = 4.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905811013724       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905810960092       residual = 6.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 1.357368e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.052419 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6328e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.060786e-01 1 1  ON 0
 uu_1                 1.397505e-01 1 1  ON 1
 uu_2                 3.902102e-02 1 1  ON 2
 uu_3                -2.184111e-02 1 1  ON 3
 uu_4                -6.522663e-02 1 1  ON 4
 uu_5                -9.721306e-02 1 1  ON 5
 uu_6                -1.224244e-01 1 1  ON 6
 uu_7                -1.333098e-01 1 1  ON 7
 uu_8                -1.229877e-01 1 1  ON 8
 uu_9                -9.214168e-02 1 1  ON 9
 ud_0                 4.367480e-01 1 1  ON 10
 ud_1                 1.732846e-01 1 1  ON 11
 ud_2                 5.782640e-02 1 1  ON 12
 ud_3                -9.931975e-03 1 1  ON 13
 ud_4                -6.585636e-02 1 1  ON 14
 ud_5                -1.059371e-01 1 1  ON 15
 ud_6                -1.322773e-01 1 1  ON 16
 ud_7                -1.473600e-01 1 1  ON 17
 ud_8                -1.475509e-01 1 1  ON 18
 ud_9                -1.345096e-01 1 1  ON 19
 eO_0                -7.438721e-01 1 1  ON 20
 eO_1                -4.284447e-01 1 1  ON 21
 eO_2                -1.738744e-02 1 1  ON 22
 eO_3                 2.930261e-01 1 1  ON 23
 eO_4                 5.089903e-01 1 1  ON 24
 eO_5                 4.645606e-01 1 1  ON 25
 eO_6                 2.373542e-01 1 1  ON 26
 eO_7                -5.392367e-02 1 1  ON 27
 eO_8                -2.006718e-01 1 1  ON 28
 eO_9                -6.198166e-02 1 1  ON 29
eH1_0                -2.288354e-01 1 1  ON 30
eH1_1                -1.324579e-01 1 1  ON 31
eH1_2                -8.812781e-02 1 1  ON 32
eH1_3                -3.557581e-02 1 1  ON 33
eH1_4                 1.164863e-02 1 1  ON 34
eH1_5                 4.489798e-02 1 1  ON 35
eH1_6                 9.804984e-02 1 1  ON 36
eH1_7                 1.424233e-01 1 1  ON 37
eH1_8                 1.528082e-01 1 1  ON 38
eH1_9                 3.917835e-02 1 1  ON 39
eH2_0                -2.269344e-01 1 1  ON 40
eH2_1                -1.309844e-01 1 1  ON 41
eH2_2                -8.674224e-02 1 1  ON 42
eH2_3                -3.452252e-02 1 1  ON 43
eH2_4                 1.371136e-02 1 1  ON 44
eH2_5                 4.763709e-02 1 1  ON 45
eH2_6                 1.021296e-01 1 1  ON 46
eH2_7                 1.499438e-01 1 1  ON 47
eH2_8                 1.614359e-01 1 1  ON 48
eH2_9                 2.200779e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.8879
    reference variance = 0.172081
====================================================
  Execution time = 2.0545e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4862e-01
  Total weights = 2.0000e+06
  Execution time = 1.9212e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347993442486
                                         uncertainty =       0.009674234758

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347993442486
                                         uncertainty =       0.009674234758

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417100802
  error estimate for blocks of size 2^( 2) =       0.000429745648
  error estimate for blocks of size 2^( 3) =       0.000443051765
  error estimate for blocks of size 2^( 4) =       0.000455668931
  error estimate for blocks of size 2^( 5) =       0.000467487382
  error estimate for blocks of size 2^( 6) =       0.000472858169
  error estimate for blocks of size 2^( 7) =       0.000476026024

      target function =                  N/A
              le_mean =     -16.905560943391
             les_mean =     286.145936795183
             stat err =       0.000468010126
             autocorr =       1.259007884705
              std dev =       0.589869611398
             le_variance =       0.347946158451

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349682718417
                                         uncertainty =       0.009761256387

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349682718417
                                         uncertainty =       0.009761256387

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418111883
  error estimate for blocks of size 2^( 2) =       0.000430729562
  error estimate for blocks of size 2^( 3) =       0.000443986897
  error estimate for blocks of size 2^( 4) =       0.000456525666
  error estimate for blocks of size 2^( 5) =       0.000468264519
  error estimate for blocks of size 2^( 6) =       0.000473586218
  error estimate for blocks of size 2^( 7) =       0.000476787690

      target function =                  N/A
              le_mean =     -16.905560646721
             les_mean =     286.147615697798
             stat err =       0.000468791023
             autocorr =       1.257110788356
              std dev =       0.591299494893
             le_variance =       0.349635092660

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349387412455
                                         uncertainty =       0.009769561404

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349387412455
                                         uncertainty =       0.009769561404

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417935323
  error estimate for blocks of size 2^( 2) =       0.000430561115
  error estimate for blocks of size 2^( 3) =       0.000443836843
  error estimate for blocks of size 2^( 4) =       0.000456404953
  error estimate for blocks of size 2^( 5) =       0.000468159786
  error estimate for blocks of size 2^( 6) =       0.000473500237
  error estimate for blocks of size 2^( 7) =       0.000476716018

      target function =                  N/A
              le_mean =     -16.905561780163
             les_mean =     286.147358797252
             stat err =       0.000468695249
             autocorr =       1.257659120261
              std dev =       0.591049802472
             le_variance =       0.349339869002

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348148749377
                                         uncertainty =       0.009694371155

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348148749377
                                         uncertainty =       0.009694371155

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417193866
  error estimate for blocks of size 2^( 2) =       0.000429836909
  error estimate for blocks of size 2^( 3) =       0.000443140078
  error estimate for blocks of size 2^( 4) =       0.000455752851
  error estimate for blocks of size 2^( 5) =       0.000467561521
  error estimate for blocks of size 2^( 6) =       0.000472930152
  error estimate for blocks of size 2^( 7) =       0.000476108776

      target function =                  N/A
              le_mean =     -16.905558601290
             les_mean =     286.146012890927
             stat err =       0.000468088325
             autocorr =       1.258866830053
              std dev =       0.590001223168
             le_variance =       0.348101443339


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905560943391        initial
     2.4414e-02     2.4414e-01             1.0455e-02       -16.905560646721
     9.7656e-02     9.7656e-01             4.1216e-03       -16.905561780163  <--
     3.9062e-01     3.9062e+00             1.3574e-03       -16.905558601290

*****************************************************************************
Applying the update for shift_i =   9.7656e-02     and shift_s =   9.7656e-01
*****************************************************************************

  Execution time = 3.0307e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.060786e-01 1 1  ON 0
 uu_1                 1.397505e-01 1 1  ON 1
 uu_2                 3.902102e-02 1 1  ON 2
 uu_3                -2.184111e-02 1 1  ON 3
 uu_4                -6.522663e-02 1 1  ON 4
 uu_5                -9.721306e-02 1 1  ON 5
 uu_6                -1.224244e-01 1 1  ON 6
 uu_7                -1.333098e-01 1 1  ON 7
 uu_8                -1.229877e-01 1 1  ON 8
 uu_9                -9.214168e-02 1 1  ON 9
 ud_0                 4.367480e-01 1 1  ON 10
 ud_1                 1.732846e-01 1 1  ON 11
 ud_2                 5.782640e-02 1 1  ON 12
 ud_3                -9.931975e-03 1 1  ON 13
 ud_4                -6.585636e-02 1 1  ON 14
 ud_5                -1.059371e-01 1 1  ON 15
 ud_6                -1.322773e-01 1 1  ON 16
 ud_7                -1.473600e-01 1 1  ON 17
 ud_8                -1.475509e-01 1 1  ON 18
 ud_9                -1.345096e-01 1 1  ON 19
 eO_0                -7.438721e-01 1 1  ON 20
 eO_1                -4.284447e-01 1 1  ON 21
 eO_2                -1.738744e-02 1 1  ON 22
 eO_3                 2.930261e-01 1 1  ON 23
 eO_4                 5.089903e-01 1 1  ON 24
 eO_5                 4.645606e-01 1 1  ON 25
 eO_6                 2.373542e-01 1 1  ON 26
 eO_7                -5.392367e-02 1 1  ON 27
 eO_8                -2.006718e-01 1 1  ON 28
 eO_9                -6.198166e-02 1 1  ON 29
eH1_0                -2.288354e-01 1 1  ON 30
eH1_1                -1.324579e-01 1 1  ON 31
eH1_2                -8.812781e-02 1 1  ON 32
eH1_3                -3.557581e-02 1 1  ON 33
eH1_4                 1.164863e-02 1 1  ON 34
eH1_5                 4.489798e-02 1 1  ON 35
eH1_6                 9.804984e-02 1 1  ON 36
eH1_7                 1.424233e-01 1 1  ON 37
eH1_8                 1.528082e-01 1 1  ON 38
eH1_9                 3.917835e-02 1 1  ON 39
eH2_0                -2.269344e-01 1 1  ON 40
eH2_1                -1.309844e-01 1 1  ON 41
eH2_2                -8.674224e-02 1 1  ON 42
eH2_3                -3.452252e-02 1 1  ON 43
eH2_4                 1.371136e-02 1 1  ON 44
eH2_5                 4.763709e-02 1 1  ON 45
eH2_6                 1.021296e-01 1 1  ON 46
eH2_7                 1.499438e-01 1 1  ON 47
eH2_8                 1.614359e-01 1 1  ON 48
eH2_9                 2.200779e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6640e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.8804
    reference variance = 0.233608
====================================================
  Execution time = 2.1117e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4338e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5908e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343467791096
                                         uncertainty =       0.005516985912

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343467791096
                                         uncertainty =       0.005516985912

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414352435
  error estimate for blocks of size 2^( 2) =       0.000427156255
  error estimate for blocks of size 2^( 3) =       0.000440869421
  error estimate for blocks of size 2^( 4) =       0.000453250336
  error estimate for blocks of size 2^( 5) =       0.000464770718
  error estimate for blocks of size 2^( 6) =       0.000472819732
  error estimate for blocks of size 2^( 7) =       0.000476101314

      target function =                  N/A
              le_mean =     -16.905683091925
             les_mean =     286.145496513466
             stat err =       0.000466735525
             autocorr =       1.268825579902
              std dev =       0.585982832998
             le_variance =       0.343375880568


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690568309192e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-02, overlap shift 2.4414e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905683091925       residual = 7.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905684253254       residual = 9.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905685807703       residual = 5.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905686942223       residual = 4.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905688847288       residual = 4.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905700835363       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905705234648       residual = 4.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905705961029       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905710342875       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905713439740       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905713592852       residual = 4.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905714618797       residual = 3.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905714796181       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905714574725       residual = 7.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.905715496694       residual = 4.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.905716703321       residual = 3.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.905716711379       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.905716553746       residual = 6.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-02 is 9.512871e-03

solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905683091925       residual = 7.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905683865289       residual = 7.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905684575922       residual = 5.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905685048269       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905686587002       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905693642631       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905693454888       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905693726669       residual = 5.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905695057739       residual = 2.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905695033483       residual = 7.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905694909708       residual = 4.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905694957741       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905694860417       residual = 7.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-02 is 2.999452e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905683091925       residual = 7.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905683422949       residual = 6.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905683542625       residual = 5.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905683615642       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905684824788       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905686877828       residual = 3.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905686285348       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905686556430       residual = 4.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905686673571       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905686593292       residual = 4.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 8.344172e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.059337 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6718e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.067107e-01 1 1  ON 0
 uu_1                 1.404593e-01 1 1  ON 1
 uu_2                 3.940268e-02 1 1  ON 2
 uu_3                -2.198179e-02 1 1  ON 3
 uu_4                -6.545334e-02 1 1  ON 4
 uu_5                -9.788713e-02 1 1  ON 5
 uu_6                -1.224355e-01 1 1  ON 6
 uu_7                -1.343939e-01 1 1  ON 7
 uu_8                -1.243479e-01 1 1  ON 8
 uu_9                -9.341072e-02 1 1  ON 9
 ud_0                 4.381675e-01 1 1  ON 10
 ud_1                 1.743474e-01 1 1  ON 11
 ud_2                 5.855035e-02 1 1  ON 12
 ud_3                -9.756049e-03 1 1  ON 13
 ud_4                -6.623318e-02 1 1  ON 14
 ud_5                -1.064503e-01 1 1  ON 15
 ud_6                -1.328424e-01 1 1  ON 16
 ud_7                -1.480746e-01 1 1  ON 17
 ud_8                -1.483626e-01 1 1  ON 18
 ud_9                -1.348768e-01 1 1  ON 19
 eO_0                -7.466150e-01 1 1  ON 20
 eO_1                -4.306121e-01 1 1  ON 21
 eO_2                -1.810672e-02 1 1  ON 22
 eO_3                 2.944940e-01 1 1  ON 23
 eO_4                 5.114377e-01 1 1  ON 24
 eO_5                 4.675601e-01 1 1  ON 25
 eO_6                 2.389865e-01 1 1  ON 26
 eO_7                -5.349366e-02 1 1  ON 27
 eO_8                -2.024739e-01 1 1  ON 28
 eO_9                -6.332421e-02 1 1  ON 29
eH1_0                -2.302580e-01 1 1  ON 30
eH1_1                -1.332209e-01 1 1  ON 31
eH1_2                -8.909119e-02 1 1  ON 32
eH1_3                -3.610602e-02 1 1  ON 33
eH1_4                 1.155846e-02 1 1  ON 34
eH1_5                 4.455191e-02 1 1  ON 35
eH1_6                 9.788348e-02 1 1  ON 36
eH1_7                 1.432998e-01 1 1  ON 37
eH1_8                 1.549948e-01 1 1  ON 38
eH1_9                 4.070368e-02 1 1  ON 39
eH2_0                -2.289686e-01 1 1  ON 40
eH2_1                -1.323070e-01 1 1  ON 41
eH2_2                -8.754023e-02 1 1  ON 42
eH2_3                -3.438838e-02 1 1  ON 43
eH2_4                 1.354038e-02 1 1  ON 44
eH2_5                 4.700979e-02 1 1  ON 45
eH2_6                 1.020763e-01 1 1  ON 46
eH2_7                 1.501788e-01 1 1  ON 47
eH2_8                 1.633778e-01 1 1  ON 48
eH2_9                 2.435380e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.9696
    reference variance = 0.413876
====================================================
  Execution time = 2.0368e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3933e-01
  Total weights = 2.0000e+06
  Execution time = 1.9261e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338620240841
                                         uncertainty =       0.004080375387

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338620240841
                                         uncertainty =       0.004080375387

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411452695
  error estimate for blocks of size 2^( 2) =       0.000423955024
  error estimate for blocks of size 2^( 3) =       0.000436968228
  error estimate for blocks of size 2^( 4) =       0.000448424524
  error estimate for blocks of size 2^( 5) =       0.000459758892
  error estimate for blocks of size 2^( 6) =       0.000468066750
  error estimate for blocks of size 2^( 7) =       0.000472686708

      target function =                  N/A
              le_mean =     -16.904944890043
             les_mean =     286.115748207138
             stat err =       0.000462234219
             autocorr =       1.262072668879
              std dev =       0.581881982053
             le_variance =       0.338586641038

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340201078169
                                         uncertainty =       0.004092663545

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340201078169
                                         uncertainty =       0.004092663545

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412411556
  error estimate for blocks of size 2^( 2) =       0.000424866242
  error estimate for blocks of size 2^( 3) =       0.000437798209
  error estimate for blocks of size 2^( 4) =       0.000449145358
  error estimate for blocks of size 2^( 5) =       0.000460405931
  error estimate for blocks of size 2^( 6) =       0.000468685334
  error estimate for blocks of size 2^( 7) =       0.000473286929

      target function =                  N/A
              le_mean =     -16.904940984201
             les_mean =     286.117196091648
             stat err =       0.000462880888
             autocorr =       1.259728189895
              std dev =       0.583238015241
             le_variance =       0.340166582422

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340131120220
                                         uncertainty =       0.004091630907

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340131120220
                                         uncertainty =       0.004091630907

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412369342
  error estimate for blocks of size 2^( 2) =       0.000424821069
  error estimate for blocks of size 2^( 3) =       0.000437760619
  error estimate for blocks of size 2^( 4) =       0.000449124250
  error estimate for blocks of size 2^( 5) =       0.000460404829
  error estimate for blocks of size 2^( 6) =       0.000468704646
  error estimate for blocks of size 2^( 7) =       0.000473312836

      target function =                  N/A
              le_mean =     -16.904938095099
             les_mean =     286.117028778119
             stat err =       0.000462886640
             autocorr =       1.260017428452
              std dev =       0.583178316686
             le_variance =       0.340096949053

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338909081727
                                         uncertainty =       0.004082736037

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338909081727
                                         uncertainty =       0.004082736037

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411628129
  error estimate for blocks of size 2^( 2) =       0.000424118539
  error estimate for blocks of size 2^( 3) =       0.000437117538
  error estimate for blocks of size 2^( 4) =       0.000448556416
  error estimate for blocks of size 2^( 5) =       0.000459882031
  error estimate for blocks of size 2^( 6) =       0.000468191204
  error estimate for blocks of size 2^( 7) =       0.000472808676

      target function =                  N/A
              le_mean =     -16.904941127596
             les_mean =     286.115909790633
             stat err =       0.000462359582
             autocorr =       1.261681210613
              std dev =       0.582130082198
             le_variance =       0.338875432600


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904944890043        initial  <--
     2.4414e-02     2.4414e-01             9.5129e-03       -16.904940984201
     9.7656e-02     9.7656e-01             2.9995e-03       -16.904938095099
     3.9062e-01     3.9062e+00             8.3442e-04       -16.904941127596

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.1086
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.060786e-01 1 1  ON 0
 uu_1                 1.397505e-01 1 1  ON 1
 uu_2                 3.902102e-02 1 1  ON 2
 uu_3                -2.184111e-02 1 1  ON 3
 uu_4                -6.522663e-02 1 1  ON 4
 uu_5                -9.721306e-02 1 1  ON 5
 uu_6                -1.224244e-01 1 1  ON 6
 uu_7                -1.333098e-01 1 1  ON 7
 uu_8                -1.229877e-01 1 1  ON 8
 uu_9                -9.214168e-02 1 1  ON 9
 ud_0                 4.367480e-01 1 1  ON 10
 ud_1                 1.732846e-01 1 1  ON 11
 ud_2                 5.782640e-02 1 1  ON 12
 ud_3                -9.931975e-03 1 1  ON 13
 ud_4                -6.585636e-02 1 1  ON 14
 ud_5                -1.059371e-01 1 1  ON 15
 ud_6                -1.322773e-01 1 1  ON 16
 ud_7                -1.473600e-01 1 1  ON 17
 ud_8                -1.475509e-01 1 1  ON 18
 ud_9                -1.345096e-01 1 1  ON 19
 eO_0                -7.438721e-01 1 1  ON 20
 eO_1                -4.284447e-01 1 1  ON 21
 eO_2                -1.738744e-02 1 1  ON 22
 eO_3                 2.930261e-01 1 1  ON 23
 eO_4                 5.089903e-01 1 1  ON 24
 eO_5                 4.645606e-01 1 1  ON 25
 eO_6                 2.373542e-01 1 1  ON 26
 eO_7                -5.392367e-02 1 1  ON 27
 eO_8                -2.006718e-01 1 1  ON 28
 eO_9                -6.198166e-02 1 1  ON 29
eH1_0                -2.288354e-01 1 1  ON 30
eH1_1                -1.324579e-01 1 1  ON 31
eH1_2                -8.812781e-02 1 1  ON 32
eH1_3                -3.557581e-02 1 1  ON 33
eH1_4                 1.164863e-02 1 1  ON 34
eH1_5                 4.489798e-02 1 1  ON 35
eH1_6                 9.804984e-02 1 1  ON 36
eH1_7                 1.424233e-01 1 1  ON 37
eH1_8                 1.528082e-01 1 1  ON 38
eH1_9                 3.917835e-02 1 1  ON 39
eH2_0                -2.269344e-01 1 1  ON 40
eH2_1                -1.309844e-01 1 1  ON 41
eH2_2                -8.674224e-02 1 1  ON 42
eH2_3                -3.452252e-02 1 1  ON 43
eH2_4                 1.371136e-02 1 1  ON 44
eH2_5                 4.763709e-02 1 1  ON 45
eH2_6                 1.021296e-01 1 1  ON 46
eH2_7                 1.499438e-01 1 1  ON 47
eH2_8                 1.614359e-01 1 1  ON 48
eH2_9                 2.200779e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6832e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.8884
    reference variance = 0.278998
====================================================
  Execution time = 2.1170e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3734e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0764e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337406171948
                                         uncertainty =       0.004283797921

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337406171948
                                         uncertainty =       0.004283797921

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410693837
  error estimate for blocks of size 2^( 2) =       0.000423494206
  error estimate for blocks of size 2^( 3) =       0.000437126997
  error estimate for blocks of size 2^( 4) =       0.000449710802
  error estimate for blocks of size 2^( 5) =       0.000460956068
  error estimate for blocks of size 2^( 6) =       0.000470104631
  error estimate for blocks of size 2^( 7) =       0.000474349892

      target function =                  N/A
              le_mean =     -16.905016349380
             les_mean =     286.116916460371
             stat err =       0.000463780348
             autocorr =       1.275229387214
              std dev =       0.580808794913
             le_variance =       0.337338856248


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690501634938e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905016349380       residual = 5.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905017013931       residual = 4.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905017707617       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905017526910       residual = 3.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905020496429       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905020835418       residual = 4.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905020548647       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905021018644       residual = 7.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905020818627       residual = 2.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905020949199       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905020692066       residual = 4.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-01 is 1.372398e-03

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905016349380       residual = 5.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905016617267       residual = 4.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905016966002       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905016797372       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905017446574       residual = 8.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905017939896       residual = 2.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905017717426       residual = 3.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905017795855       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905017747788       residual = 3.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-01 is 3.702026e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905016349380       residual = 5.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905016428459       residual = 4.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905016540131       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905016491815       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905016633662       residual = 7.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905016784324       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905016742114       residual = 2.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905016761535       residual = 7.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 9.471785e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.062725 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8728e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.060855e-01 1 1  ON 0
 uu_1                 1.398674e-01 1 1  ON 1
 uu_2                 3.908159e-02 1 1  ON 2
 uu_3                -2.183964e-02 1 1  ON 3
 uu_4                -6.518006e-02 1 1  ON 4
 uu_5                -9.730521e-02 1 1  ON 5
 uu_6                -1.224867e-01 1 1  ON 6
 uu_7                -1.334176e-01 1 1  ON 7
 uu_8                -1.231072e-01 1 1  ON 8
 uu_9                -9.218993e-02 1 1  ON 9
 ud_0                 4.368482e-01 1 1  ON 10
 ud_1                 1.734523e-01 1 1  ON 11
 ud_2                 5.781790e-02 1 1  ON 12
 ud_3                -1.002176e-02 1 1  ON 13
 ud_4                -6.594583e-02 1 1  ON 14
 ud_5                -1.059893e-01 1 1  ON 15
 ud_6                -1.322724e-01 1 1  ON 16
 ud_7                -1.474315e-01 1 1  ON 17
 ud_8                -1.476414e-01 1 1  ON 18
 ud_9                -1.344943e-01 1 1  ON 19
 eO_0                -7.442104e-01 1 1  ON 20
 eO_1                -4.287870e-01 1 1  ON 21
 eO_2                -1.740944e-02 1 1  ON 22
 eO_3                 2.932371e-01 1 1  ON 23
 eO_4                 5.093605e-01 1 1  ON 24
 eO_5                 4.647964e-01 1 1  ON 25
 eO_6                 2.374889e-01 1 1  ON 26
 eO_7                -5.393298e-02 1 1  ON 27
 eO_8                -2.008024e-01 1 1  ON 28
 eO_9                -6.208283e-02 1 1  ON 29
eH1_0                -2.289741e-01 1 1  ON 30
eH1_1                -1.325282e-01 1 1  ON 31
eH1_2                -8.826517e-02 1 1  ON 32
eH1_3                -3.564988e-02 1 1  ON 33
eH1_4                 1.160525e-02 1 1  ON 34
eH1_5                 4.478633e-02 1 1  ON 35
eH1_6                 9.816229e-02 1 1  ON 36
eH1_7                 1.425893e-01 1 1  ON 37
eH1_8                 1.529669e-01 1 1  ON 38
eH1_9                 3.931267e-02 1 1  ON 39
eH2_0                -2.271104e-01 1 1  ON 40
eH2_1                -1.310596e-01 1 1  ON 41
eH2_2                -8.684507e-02 1 1  ON 42
eH2_3                -3.451516e-02 1 1  ON 43
eH2_4                 1.354958e-02 1 1  ON 44
eH2_5                 4.765732e-02 1 1  ON 45
eH2_6                 1.021099e-01 1 1  ON 46
eH2_7                 1.499542e-01 1 1  ON 47
eH2_8                 1.616439e-01 1 1  ON 48
eH2_9                 2.228150e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.9331
    reference variance = 0.202847
====================================================
  Execution time = 2.0512e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3421e-01
  Total weights = 2.0000e+06
  Execution time = 1.9344e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334139474839
                                         uncertainty =       0.006071020391

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334139474839
                                         uncertainty =       0.006071020391

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408738543
  error estimate for blocks of size 2^( 2) =       0.000421502472
  error estimate for blocks of size 2^( 3) =       0.000434175523
  error estimate for blocks of size 2^( 4) =       0.000445419851
  error estimate for blocks of size 2^( 5) =       0.000454791630
  error estimate for blocks of size 2^( 6) =       0.000461140744
  error estimate for blocks of size 2^( 7) =       0.000465001746

      target function =                  N/A
              le_mean =     -16.906289822840
             les_mean =     286.156769800333
             stat err =       0.000456588493
             autocorr =       1.247839526200
              std dev =       0.578043591374
             le_variance =       0.334134393528

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334446476594
                                         uncertainty =       0.006089454616

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334446476594
                                         uncertainty =       0.006089454616

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408926579
  error estimate for blocks of size 2^( 2) =       0.000421682199
  error estimate for blocks of size 2^( 3) =       0.000434340523
  error estimate for blocks of size 2^( 4) =       0.000445566790
  error estimate for blocks of size 2^( 5) =       0.000454926174
  error estimate for blocks of size 2^( 6) =       0.000461273624
  error estimate for blocks of size 2^( 7) =       0.000465143679

      target function =                  N/A
              le_mean =     -16.906287074543
             les_mean =     286.156984373142
             stat err =       0.000456727566
             autocorr =       1.247451793786
              std dev =       0.578309513594
             le_variance =       0.334441893513

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334291656231
                                         uncertainty =       0.006085950949

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334291656231
                                         uncertainty =       0.006085950949

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408831819
  error estimate for blocks of size 2^( 2) =       0.000421590472
  error estimate for blocks of size 2^( 3) =       0.000434254208
  error estimate for blocks of size 2^( 4) =       0.000445485774
  error estimate for blocks of size 2^( 5) =       0.000454849241
  error estimate for blocks of size 2^( 6) =       0.000461200235
  error estimate for blocks of size 2^( 7) =       0.000465068557

      target function =                  N/A
              le_mean =     -16.906287376204
             les_mean =     286.156839592732
             stat err =       0.000456650952
             autocorr =       1.247611459637
              std dev =       0.578175503711
             le_variance =       0.334286913092

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334153379031
                                         uncertainty =       0.006073222135

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334153379031
                                         uncertainty =       0.006073222135

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408747078
  error estimate for blocks of size 2^( 2) =       0.000421510403
  error estimate for blocks of size 2^( 3) =       0.000434182288
  error estimate for blocks of size 2^( 4) =       0.000445424824
  error estimate for blocks of size 2^( 5) =       0.000454795414
  error estimate for blocks of size 2^( 6) =       0.000461145074
  error estimate for blocks of size 2^( 7) =       0.000465007193

      target function =                  N/A
              le_mean =     -16.906289430878
             les_mean =     286.156770501500
             stat err =       0.000456593126
             autocorr =       1.247812740301
              std dev =       0.578055661635
             le_variance =       0.334148347948


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906289822840        initial  <--
     2.4414e-01     2.4414e+00             1.3724e-03       -16.906287074543
     9.7656e-01     9.7656e+00             3.7020e-04       -16.906287376204
     3.9062e+00     3.9062e+01             9.4718e-05       -16.906289430878

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.2559
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.060786e-01 1 1  ON 0
 uu_1                 1.397505e-01 1 1  ON 1
 uu_2                 3.902102e-02 1 1  ON 2
 uu_3                -2.184111e-02 1 1  ON 3
 uu_4                -6.522663e-02 1 1  ON 4
 uu_5                -9.721306e-02 1 1  ON 5
 uu_6                -1.224244e-01 1 1  ON 6
 uu_7                -1.333098e-01 1 1  ON 7
 uu_8                -1.229877e-01 1 1  ON 8
 uu_9                -9.214168e-02 1 1  ON 9
 ud_0                 4.367480e-01 1 1  ON 10
 ud_1                 1.732846e-01 1 1  ON 11
 ud_2                 5.782640e-02 1 1  ON 12
 ud_3                -9.931975e-03 1 1  ON 13
 ud_4                -6.585636e-02 1 1  ON 14
 ud_5                -1.059371e-01 1 1  ON 15
 ud_6                -1.322773e-01 1 1  ON 16
 ud_7                -1.473600e-01 1 1  ON 17
 ud_8                -1.475509e-01 1 1  ON 18
 ud_9                -1.345096e-01 1 1  ON 19
 eO_0                -7.438721e-01 1 1  ON 20
 eO_1                -4.284447e-01 1 1  ON 21
 eO_2                -1.738744e-02 1 1  ON 22
 eO_3                 2.930261e-01 1 1  ON 23
 eO_4                 5.089903e-01 1 1  ON 24
 eO_5                 4.645606e-01 1 1  ON 25
 eO_6                 2.373542e-01 1 1  ON 26
 eO_7                -5.392367e-02 1 1  ON 27
 eO_8                -2.006718e-01 1 1  ON 28
 eO_9                -6.198166e-02 1 1  ON 29
eH1_0                -2.288354e-01 1 1  ON 30
eH1_1                -1.324579e-01 1 1  ON 31
eH1_2                -8.812781e-02 1 1  ON 32
eH1_3                -3.557581e-02 1 1  ON 33
eH1_4                 1.164863e-02 1 1  ON 34
eH1_5                 4.489798e-02 1 1  ON 35
eH1_6                 9.804984e-02 1 1  ON 36
eH1_7                 1.424233e-01 1 1  ON 37
eH1_8                 1.528082e-01 1 1  ON 38
eH1_9                 3.917835e-02 1 1  ON 39
eH2_0                -2.269344e-01 1 1  ON 40
eH2_1                -1.309844e-01 1 1  ON 41
eH2_2                -8.674224e-02 1 1  ON 42
eH2_3                -3.452252e-02 1 1  ON 43
eH2_4                 1.371136e-02 1 1  ON 44
eH2_5                 4.763709e-02 1 1  ON 45
eH2_6                 1.021296e-01 1 1  ON 46
eH2_7                 1.499438e-01 1 1  ON 47
eH2_8                 1.614359e-01 1 1  ON 48
eH2_9                 2.200779e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9080e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.8875
    reference variance = 0.474433
====================================================
  Execution time = 2.0820e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3453e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5351e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334415910629
                                         uncertainty =       0.003665910490

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334415910629
                                         uncertainty =       0.003665910490

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408980890
  error estimate for blocks of size 2^( 2) =       0.000421639065
  error estimate for blocks of size 2^( 3) =       0.000434790376
  error estimate for blocks of size 2^( 4) =       0.000447464757
  error estimate for blocks of size 2^( 5) =       0.000456536850
  error estimate for blocks of size 2^( 6) =       0.000466532993
  error estimate for blocks of size 2^( 7) =       0.000471190708

      target function =                  N/A
              le_mean =     -16.905673861003
             les_mean =     286.136339264599
             stat err =       0.000460431327
             autocorr =       1.267429168645
              std dev =       0.578386321813
             le_variance =       0.334530737260


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690567386100e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905673861003       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905674008317       residual = 4.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905674033210       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905674153515       residual = 4.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905674267031       residual = 9.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905674258236       residual = 2.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905674552782       residual = 5.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905674518105       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905674467137       residual = 1.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+00 is 1.445527e-04

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905673861003       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905673898539       residual = 4.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905673904609       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905673931402       residual = 3.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905673956490       residual = 9.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905673953193       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905674025878       residual = 4.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905674021341       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905674009390       residual = 9.76e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+00 is 3.798983e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905673861003       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905673870432       residual = 4.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905673871939       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905673878428       residual = 3.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905673884425       residual = 8.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905673883536       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905673901587       residual = 4.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905673900720       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905673897826       residual = 8.29e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+01 is 9.628586e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.065910 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6362e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.060844e-01 1 1  ON 0
 uu_1                 1.397616e-01 1 1  ON 1
 uu_2                 3.902694e-02 1 1  ON 2
 uu_3                -2.184702e-02 1 1  ON 3
 uu_4                -6.521341e-02 1 1  ON 4
 uu_5                -9.722648e-02 1 1  ON 5
 uu_6                -1.224208e-01 1 1  ON 6
 uu_7                -1.333238e-01 1 1  ON 7
 uu_8                -1.230114e-01 1 1  ON 8
 uu_9                -9.215209e-02 1 1  ON 9
 ud_0                 4.367688e-01 1 1  ON 10
 ud_1                 1.733080e-01 1 1  ON 11
 ud_2                 5.783867e-02 1 1  ON 12
 ud_3                -9.934961e-03 1 1  ON 13
 ud_4                -6.585279e-02 1 1  ON 14
 ud_5                -1.059497e-01 1 1  ON 15
 ud_6                -1.322807e-01 1 1  ON 16
 ud_7                -1.473817e-01 1 1  ON 17
 ud_8                -1.475660e-01 1 1  ON 18
 ud_9                -1.345154e-01 1 1  ON 19
 eO_0                -7.438933e-01 1 1  ON 20
 eO_1                -4.284827e-01 1 1  ON 21
 eO_2                -1.738586e-02 1 1  ON 22
 eO_3                 2.930499e-01 1 1  ON 23
 eO_4                 5.090184e-01 1 1  ON 24
 eO_5                 4.645844e-01 1 1  ON 25
 eO_6                 2.373665e-01 1 1  ON 26
 eO_7                -5.392249e-02 1 1  ON 27
 eO_8                -2.006902e-01 1 1  ON 28
 eO_9                -6.199365e-02 1 1  ON 29
eH1_0                -2.288495e-01 1 1  ON 30
eH1_1                -1.324683e-01 1 1  ON 31
eH1_2                -8.814216e-02 1 1  ON 32
eH1_3                -3.557540e-02 1 1  ON 33
eH1_4                 1.164839e-02 1 1  ON 34
eH1_5                 4.489455e-02 1 1  ON 35
eH1_6                 9.804461e-02 1 1  ON 36
eH1_7                 1.424317e-01 1 1  ON 37
eH1_8                 1.528255e-01 1 1  ON 38
eH1_9                 3.919780e-02 1 1  ON 39
eH2_0                -2.269525e-01 1 1  ON 40
eH2_1                -1.310039e-01 1 1  ON 41
eH2_2                -8.675824e-02 1 1  ON 42
eH2_3                -3.451300e-02 1 1  ON 43
eH2_4                 1.370026e-02 1 1  ON 44
eH2_5                 4.763947e-02 1 1  ON 45
eH2_6                 1.021380e-01 1 1  ON 46
eH2_7                 1.499479e-01 1 1  ON 47
eH2_8                 1.614548e-01 1 1  ON 48
eH2_9                 2.202997e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.933
    reference variance = 0.65243
====================================================
  Execution time = 2.0943e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3801e-01
  Total weights = 2.0000e+06
  Execution time = 1.9348e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338025587004
                                         uncertainty =       0.003674604990

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338025587004
                                         uncertainty =       0.003674604990

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411095776
  error estimate for blocks of size 2^( 2) =       0.000423676822
  error estimate for blocks of size 2^( 3) =       0.000436827230
  error estimate for blocks of size 2^( 4) =       0.000448778633
  error estimate for blocks of size 2^( 5) =       0.000460760079
  error estimate for blocks of size 2^( 6) =       0.000467972724
  error estimate for blocks of size 2^( 7) =       0.000469944351

      target function =                  N/A
              le_mean =     -16.905224987787
             les_mean =     286.124631192309
             stat err =       0.000461863947
             autocorr =       1.262240457770
              std dev =       0.581377221434
             le_variance =       0.337999473602

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338056540785
                                         uncertainty =       0.003674715923

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338056540785
                                         uncertainty =       0.003674715923

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411114610
  error estimate for blocks of size 2^( 2) =       0.000423694242
  error estimate for blocks of size 2^( 3) =       0.000436841780
  error estimate for blocks of size 2^( 4) =       0.000448790691
  error estimate for blocks of size 2^( 5) =       0.000460769922
  error estimate for blocks of size 2^( 6) =       0.000467982075
  error estimate for blocks of size 2^( 7) =       0.000469951950

      target function =                  N/A
              le_mean =     -16.905225373416
             les_mean =     286.124675202904
             stat err =       0.000461873659
             autocorr =       1.262177887655
              std dev =       0.581403857845
             le_variance =       0.338030445917

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338040191788
                                         uncertainty =       0.003674641796

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338040191788
                                         uncertainty =       0.003674641796

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411104664
  error estimate for blocks of size 2^( 2) =       0.000423685014
  error estimate for blocks of size 2^( 3) =       0.000436833950
  error estimate for blocks of size 2^( 4) =       0.000448784091
  error estimate for blocks of size 2^( 5) =       0.000460764382
  error estimate for blocks of size 2^( 6) =       0.000467976811
  error estimate for blocks of size 2^( 7) =       0.000469947515

      target function =                  N/A
              le_mean =     -16.905225182943
             les_mean =     286.124652405768
             stat err =       0.000461868200
             autocorr =       1.262209126352
              std dev =       0.581389790720
             le_variance =       0.338014088754

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338027367917
                                         uncertainty =       0.003674608840

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338027367917
                                         uncertainty =       0.003674608840

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411096860
  error estimate for blocks of size 2^( 2) =       0.000423677820
  error estimate for blocks of size 2^( 3) =       0.000436828042
  error estimate for blocks of size 2^( 4) =       0.000448779287
  error estimate for blocks of size 2^( 5) =       0.000460760587
  error estimate for blocks of size 2^( 6) =       0.000467973206
  error estimate for blocks of size 2^( 7) =       0.000469944716

      target function =                  N/A
              le_mean =     -16.905225011597
             les_mean =     286.124633779581
             stat err =       0.000461864449
             autocorr =       1.262236547701
              std dev =       0.581378754213
             le_variance =       0.338001255851


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905224987787        initial
     2.4414e+00     2.4414e+01             1.4455e-04       -16.905225373416  <--
     9.7656e+00     9.7656e+01             3.7990e-05       -16.905225182943
     3.9062e+01     3.9062e+02             9.6286e-06       -16.905225011597

*****************************************************************************
Applying the update for shift_i =   2.4414e+00     and shift_s =   2.4414e+01
*****************************************************************************

  Execution time = 3.0709e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.061022e-01 1 1  ON 0
 uu_1                 1.397933e-01 1 1  ON 1
 uu_2                 3.904416e-02 1 1  ON 2
 uu_3                -2.186045e-02 1 1  ON 3
 uu_4                -6.518037e-02 1 1  ON 4
 uu_5                -9.726182e-02 1 1  ON 5
 uu_6                -1.224123e-01 1 1  ON 6
 uu_7                -1.333646e-01 1 1  ON 7
 uu_8                -1.230817e-01 1 1  ON 8
 uu_9                -9.218353e-02 1 1  ON 9
 ud_0                 4.368316e-01 1 1  ON 10
 ud_1                 1.733743e-01 1 1  ON 11
 ud_2                 5.787471e-02 1 1  ON 12
 ud_3                -9.940330e-03 1 1  ON 13
 ud_4                -6.584514e-02 1 1  ON 14
 ud_5                -1.059842e-01 1 1  ON 15
 ud_6                -1.322923e-01 1 1  ON 16
 ud_7                -1.474445e-01 1 1  ON 17
 ud_8                -1.476109e-01 1 1  ON 18
 ud_9                -1.345331e-01 1 1  ON 19
 eO_0                -7.439592e-01 1 1  ON 20
 eO_1                -4.285893e-01 1 1  ON 21
 eO_2                -1.738449e-02 1 1  ON 22
 eO_3                 2.931192e-01 1 1  ON 23
 eO_4                 5.091035e-01 1 1  ON 24
 eO_5                 4.646552e-01 1 1  ON 25
 eO_6                 2.374031e-01 1 1  ON 26
 eO_7                -5.391891e-02 1 1  ON 27
 eO_8                -2.007452e-01 1 1  ON 28
 eO_9                -6.202944e-02 1 1  ON 29
eH1_0                -2.288919e-01 1 1  ON 30
eH1_1                -1.324990e-01 1 1  ON 31
eH1_2                -8.818327e-02 1 1  ON 32
eH1_3                -3.557551e-02 1 1  ON 33
eH1_4                 1.164648e-02 1 1  ON 34
eH1_5                 4.488507e-02 1 1  ON 35
eH1_6                 9.802927e-02 1 1  ON 36
eH1_7                 1.424568e-01 1 1  ON 37
eH1_8                 1.528769e-01 1 1  ON 38
eH1_9                 3.925579e-02 1 1  ON 39
eH2_0                -2.270073e-01 1 1  ON 40
eH2_1                -1.310600e-01 1 1  ON 41
eH2_2                -8.680459e-02 1 1  ON 42
eH2_3                -3.448854e-02 1 1  ON 43
eH2_4                 1.366845e-02 1 1  ON 44
eH2_5                 4.764648e-02 1 1  ON 45
eH2_6                 1.021630e-01 1 1  ON 46
eH2_7                 1.499604e-01 1 1  ON 47
eH2_8                 1.615112e-01 1 1  ON 48
eH2_9                 2.209607e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7087e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.9168
    reference variance = 0.253422
====================================================
  Execution time = 2.0954e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3739e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5311e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337410234935
                                         uncertainty =       0.004493032590

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337410234935
                                         uncertainty =       0.004493032590

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410723255
  error estimate for blocks of size 2^( 2) =       0.000423363778
  error estimate for blocks of size 2^( 3) =       0.000437278928
  error estimate for blocks of size 2^( 4) =       0.000449452706
  error estimate for blocks of size 2^( 5) =       0.000460935863
  error estimate for blocks of size 2^( 6) =       0.000469389438
  error estimate for blocks of size 2^( 7) =       0.000472901533

      target function =                  N/A
              le_mean =     -16.905309636231
             les_mean =     286.126880912244
             stat err =       0.000463169885
             autocorr =       1.271692301193
              std dev =       0.580850397345
             le_variance =       0.337387184096


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690530963623e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905309636231       residual = 5.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905309857403       residual = 4.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905310442012       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905311246094       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905310730725       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905311656793       residual = 3.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905311971689       residual = 6.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905311741710       residual = 2.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905311830354       residual = 4.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-01 is 4.969498e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905309636231       residual = 5.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905309701423       residual = 4.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905309950093       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905310166642       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905309993530       residual = 7.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905310194019       residual = 2.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905310264229       residual = 2.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905310229845       residual = 9.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+00 is 1.288319e-04

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905309636231       residual = 5.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905309653292       residual = 4.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905309726127       residual = 3.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905309781890       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905309736112       residual = 7.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905309782695       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905309797299       residual = 1.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905309791345       residual = 6.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+00 is 3.294118e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.068777 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6492e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.061147e-01 1 1  ON 0
 uu_1                 1.398426e-01 1 1  ON 1
 uu_2                 3.904991e-02 1 1  ON 2
 uu_3                -2.184509e-02 1 1  ON 3
 uu_4                -6.518391e-02 1 1  ON 4
 uu_5                -9.727331e-02 1 1  ON 5
 uu_6                -1.223975e-01 1 1  ON 6
 uu_7                -1.333886e-01 1 1  ON 7
 uu_8                -1.231769e-01 1 1  ON 8
 uu_9                -9.224097e-02 1 1  ON 9
 ud_0                 4.369272e-01 1 1  ON 10
 ud_1                 1.734602e-01 1 1  ON 11
 ud_2                 5.787476e-02 1 1  ON 12
 ud_3                -9.936256e-03 1 1  ON 13
 ud_4                -6.588231e-02 1 1  ON 14
 ud_5                -1.060271e-01 1 1  ON 15
 ud_6                -1.323305e-01 1 1  ON 16
 ud_7                -1.474423e-01 1 1  ON 17
 ud_8                -1.476433e-01 1 1  ON 18
 ud_9                -1.345705e-01 1 1  ON 19
 eO_0                -7.440881e-01 1 1  ON 20
 eO_1                -4.286927e-01 1 1  ON 21
 eO_2                -1.739216e-02 1 1  ON 22
 eO_3                 2.931952e-01 1 1  ON 23
 eO_4                 5.092071e-01 1 1  ON 24
 eO_5                 4.647651e-01 1 1  ON 25
 eO_6                 2.374653e-01 1 1  ON 26
 eO_7                -5.389432e-02 1 1  ON 27
 eO_8                -2.008224e-01 1 1  ON 28
 eO_9                -6.208132e-02 1 1  ON 29
eH1_0                -2.289727e-01 1 1  ON 30
eH1_1                -1.325590e-01 1 1  ON 31
eH1_2                -8.824472e-02 1 1  ON 32
eH1_3                -3.557729e-02 1 1  ON 33
eH1_4                 1.161829e-02 1 1  ON 34
eH1_5                 4.490817e-02 1 1  ON 35
eH1_6                 9.805418e-02 1 1  ON 36
eH1_7                 1.424994e-01 1 1  ON 37
eH1_8                 1.529494e-01 1 1  ON 38
eH1_9                 3.931661e-02 1 1  ON 39
eH2_0                -2.270865e-01 1 1  ON 40
eH2_1                -1.310617e-01 1 1  ON 41
eH2_2                -8.687196e-02 1 1  ON 42
eH2_3                -3.447113e-02 1 1  ON 43
eH2_4                 1.364394e-02 1 1  ON 44
eH2_5                 4.763700e-02 1 1  ON 45
eH2_6                 1.021605e-01 1 1  ON 46
eH2_7                 1.499635e-01 1 1  ON 47
eH2_8                 1.615917e-01 1 1  ON 48
eH2_9                 2.218685e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.9572
    reference variance = 0.389566
====================================================
  Execution time = 2.0547e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.4005e-01
  Total weights = 2.0000e+06
  Execution time = 1.9403e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340074113759
                                         uncertainty =       0.005615938812

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340074113759
                                         uncertainty =       0.005615938812

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412297116
  error estimate for blocks of size 2^( 2) =       0.000425832227
  error estimate for blocks of size 2^( 3) =       0.000440383284
  error estimate for blocks of size 2^( 4) =       0.000454332461
  error estimate for blocks of size 2^( 5) =       0.000468197636
  error estimate for blocks of size 2^( 6) =       0.000479112806
  error estimate for blocks of size 2^( 7) =       0.000486515951

      target function =                  N/A
              le_mean =     -16.904471589582
             les_mean =     286.101137376109
             stat err =       0.000472039713
             autocorr =       1.310800151406
              std dev =       0.583076172650
             le_variance =       0.339977823112

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340314795856
                                         uncertainty =       0.005615499048

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340314795856
                                         uncertainty =       0.005615499048

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412442940
  error estimate for blocks of size 2^( 2) =       0.000425967150
  error estimate for blocks of size 2^( 3) =       0.000440506264
  error estimate for blocks of size 2^( 4) =       0.000454444294
  error estimate for blocks of size 2^( 5) =       0.000468304107
  error estimate for blocks of size 2^( 6) =       0.000479215910
  error estimate for blocks of size 2^( 7) =       0.000486615950

      target function =                  N/A
              le_mean =     -16.904469711993
             les_mean =     286.101314430901
             stat err =       0.000472145065
             autocorr =       1.310458168112
              std dev =       0.583282399276
             le_variance =       0.340218357305

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340223902145
                                         uncertainty =       0.005615376548

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340223902145
                                         uncertainty =       0.005615376548

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412387868
  error estimate for blocks of size 2^( 2) =       0.000425915938
  error estimate for blocks of size 2^( 3) =       0.000440459647
  error estimate for blocks of size 2^( 4) =       0.000454402315
  error estimate for blocks of size 2^( 5) =       0.000468264617
  error estimate for blocks of size 2^( 6) =       0.000479178120
  error estimate for blocks of size 2^( 7) =       0.000486579158

      target function =                  N/A
              le_mean =     -16.904470179294
             les_mean =     286.101239380486
             stat err =       0.000472106052
             autocorr =       1.310591584494
              std dev =       0.583204516356
             le_variance =       0.340127507899

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340093685297
                                         uncertainty =       0.005615833130

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340093685297
                                         uncertainty =       0.005615833130

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412308974
  error estimate for blocks of size 2^( 2) =       0.000425843131
  error estimate for blocks of size 2^( 3) =       0.000440393205
  error estimate for blocks of size 2^( 4) =       0.000454341529
  error estimate for blocks of size 2^( 5) =       0.000468206337
  error estimate for blocks of size 2^( 6) =       0.000479121305
  error estimate for blocks of size 2^( 7) =       0.000486524146

      target function =                  N/A
              le_mean =     -16.904471377068
             les_mean =     286.101149748264
             stat err =       0.000472048329
             autocorr =       1.310772599622
              std dev =       0.583092942983
             le_variance =       0.339997380156


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904471589582        initial  <--
     6.1035e-01     6.1035e+00             4.9695e-04       -16.904469711993
     2.4414e+00     2.4414e+01             1.2883e-04       -16.904470179294
     9.7656e+00     9.7656e+01             3.2941e-05       -16.904471377068

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.3339
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.061022e-01 1 1  ON 0
 uu_1                 1.397933e-01 1 1  ON 1
 uu_2                 3.904416e-02 1 1  ON 2
 uu_3                -2.186045e-02 1 1  ON 3
 uu_4                -6.518037e-02 1 1  ON 4
 uu_5                -9.726182e-02 1 1  ON 5
 uu_6                -1.224123e-01 1 1  ON 6
 uu_7                -1.333646e-01 1 1  ON 7
 uu_8                -1.230817e-01 1 1  ON 8
 uu_9                -9.218353e-02 1 1  ON 9
 ud_0                 4.368316e-01 1 1  ON 10
 ud_1                 1.733743e-01 1 1  ON 11
 ud_2                 5.787471e-02 1 1  ON 12
 ud_3                -9.940330e-03 1 1  ON 13
 ud_4                -6.584514e-02 1 1  ON 14
 ud_5                -1.059842e-01 1 1  ON 15
 ud_6                -1.322923e-01 1 1  ON 16
 ud_7                -1.474445e-01 1 1  ON 17
 ud_8                -1.476109e-01 1 1  ON 18
 ud_9                -1.345331e-01 1 1  ON 19
 eO_0                -7.439592e-01 1 1  ON 20
 eO_1                -4.285893e-01 1 1  ON 21
 eO_2                -1.738449e-02 1 1  ON 22
 eO_3                 2.931192e-01 1 1  ON 23
 eO_4                 5.091035e-01 1 1  ON 24
 eO_5                 4.646552e-01 1 1  ON 25
 eO_6                 2.374031e-01 1 1  ON 26
 eO_7                -5.391891e-02 1 1  ON 27
 eO_8                -2.007452e-01 1 1  ON 28
 eO_9                -6.202944e-02 1 1  ON 29
eH1_0                -2.288919e-01 1 1  ON 30
eH1_1                -1.324990e-01 1 1  ON 31
eH1_2                -8.818327e-02 1 1  ON 32
eH1_3                -3.557551e-02 1 1  ON 33
eH1_4                 1.164648e-02 1 1  ON 34
eH1_5                 4.488507e-02 1 1  ON 35
eH1_6                 9.802927e-02 1 1  ON 36
eH1_7                 1.424568e-01 1 1  ON 37
eH1_8                 1.528769e-01 1 1  ON 38
eH1_9                 3.925579e-02 1 1  ON 39
eH2_0                -2.270073e-01 1 1  ON 40
eH2_1                -1.310600e-01 1 1  ON 41
eH2_2                -8.680459e-02 1 1  ON 42
eH2_3                -3.448854e-02 1 1  ON 43
eH2_4                 1.366845e-02 1 1  ON 44
eH2_5                 4.764648e-02 1 1  ON 45
eH2_6                 1.021630e-01 1 1  ON 46
eH2_7                 1.499604e-01 1 1  ON 47
eH2_8                 1.615112e-01 1 1  ON 48
eH2_9                 2.209607e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6831e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.8606
    reference variance = 0.159249
====================================================
  Execution time = 2.1299e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3666e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5576e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336741724513
                                         uncertainty =       0.002606808819

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336741724513
                                         uncertainty =       0.002606808819

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410279743
  error estimate for blocks of size 2^( 2) =       0.000423145836
  error estimate for blocks of size 2^( 3) =       0.000435768757
  error estimate for blocks of size 2^( 4) =       0.000448619121
  error estimate for blocks of size 2^( 5) =       0.000459399711
  error estimate for blocks of size 2^( 6) =       0.000466705042
  error estimate for blocks of size 2^( 7) =       0.000471439863

      target function =                  N/A
              le_mean =     -16.906132441833
             les_mean =     286.153972907707
             stat err =       0.000461540934
             autocorr =       1.265494610187
              std dev =       0.580223177108
             le_variance =       0.336658935253


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690613244183e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906132441833       residual = 5.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906132459578       residual = 4.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906132642272       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906132578449       residual = 9.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906132704846       residual = 5.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906132710902       residual = 2.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906132721597       residual = 4.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906132723080       residual = 8.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+00 is 5.582166e-05

solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906132441833       residual = 5.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906132446322       residual = 4.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906132493077       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906132477446       residual = 9.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906132502018       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906132511198       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906132512838       residual = 4.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906132513354       residual = 7.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+01 is 1.418163e-05

solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906132441833       residual = 5.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906132442958       residual = 4.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906132454717       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906132450844       residual = 9.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906132455974       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906132459250       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906132459658       residual = 4.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906132459795       residual = 6.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+01 is 3.560291e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.071458 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6863e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.061007e-01 1 1  ON 0
 uu_1                 1.397981e-01 1 1  ON 1
 uu_2                 3.904754e-02 1 1  ON 2
 uu_3                -2.185772e-02 1 1  ON 3
 uu_4                -6.517830e-02 1 1  ON 4
 uu_5                -9.726268e-02 1 1  ON 5
 uu_6                -1.224109e-01 1 1  ON 6
 uu_7                -1.333713e-01 1 1  ON 7
 uu_8                -1.230912e-01 1 1  ON 8
 uu_9                -9.218708e-02 1 1  ON 9
 ud_0                 4.368404e-01 1 1  ON 10
 ud_1                 1.733803e-01 1 1  ON 11
 ud_2                 5.787483e-02 1 1  ON 12
 ud_3                -9.936951e-03 1 1  ON 13
 ud_4                -6.584571e-02 1 1  ON 14
 ud_5                -1.059868e-01 1 1  ON 15
 ud_6                -1.322896e-01 1 1  ON 16
 ud_7                -1.474428e-01 1 1  ON 17
 ud_8                -1.476210e-01 1 1  ON 18
 ud_9                -1.345407e-01 1 1  ON 19
 eO_0                -7.439734e-01 1 1  ON 20
 eO_1                -4.285949e-01 1 1  ON 21
 eO_2                -1.738525e-02 1 1  ON 22
 eO_3                 2.931219e-01 1 1  ON 23
 eO_4                 5.091154e-01 1 1  ON 24
 eO_5                 4.646673e-01 1 1  ON 25
 eO_6                 2.374104e-01 1 1  ON 26
 eO_7                -5.391680e-02 1 1  ON 27
 eO_8                -2.007544e-01 1 1  ON 28
 eO_9                -6.203522e-02 1 1  ON 29
eH1_0                -2.288988e-01 1 1  ON 30
eH1_1                -1.325004e-01 1 1  ON 31
eH1_2                -8.818457e-02 1 1  ON 32
eH1_3                -3.558129e-02 1 1  ON 33
eH1_4                 1.164562e-02 1 1  ON 34
eH1_5                 4.488595e-02 1 1  ON 35
eH1_6                 9.802640e-02 1 1  ON 36
eH1_7                 1.424577e-01 1 1  ON 37
eH1_8                 1.528854e-01 1 1  ON 38
eH1_9                 3.926368e-02 1 1  ON 39
eH2_0                -2.270175e-01 1 1  ON 40
eH2_1                -1.310616e-01 1 1  ON 41
eH2_2                -8.680799e-02 1 1  ON 42
eH2_3                -3.448267e-02 1 1  ON 43
eH2_4                 1.366445e-02 1 1  ON 44
eH2_5                 4.764746e-02 1 1  ON 45
eH2_6                 1.021640e-01 1 1  ON 46
eH2_7                 1.499602e-01 1 1  ON 47
eH2_8                 1.615156e-01 1 1  ON 48
eH2_9                 2.210309e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.8795
    reference variance = 0.181872
====================================================
  Execution time = 2.0498e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3791e-01
  Total weights = 2.0000e+06
  Execution time = 1.9497e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337958149473
                                         uncertainty =       0.005273951087

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337958149473
                                         uncertainty =       0.005273951087

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411039779
  error estimate for blocks of size 2^( 2) =       0.000424520721
  error estimate for blocks of size 2^( 3) =       0.000437795408
  error estimate for blocks of size 2^( 4) =       0.000450131533
  error estimate for blocks of size 2^( 5) =       0.000461125198
  error estimate for blocks of size 2^( 6) =       0.000469103191
  error estimate for blocks of size 2^( 7) =       0.000475102357

      target function =                  N/A
              le_mean =     -16.906224021728
             les_mean =     286.158317904370
             stat err =       0.000463865570
             autocorr =       1.273551668281
              std dev =       0.581298030683
             le_variance =       0.337907400476

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337977252093
                                         uncertainty =       0.005274313263

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337977252093
                                         uncertainty =       0.005274313263

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411051393
  error estimate for blocks of size 2^( 2) =       0.000424531197
  error estimate for blocks of size 2^( 3) =       0.000437805129
  error estimate for blocks of size 2^( 4) =       0.000450140215
  error estimate for blocks of size 2^( 5) =       0.000461133234
  error estimate for blocks of size 2^( 6) =       0.000469111290
  error estimate for blocks of size 2^( 7) =       0.000475110618

      target function =                  N/A
              le_mean =     -16.906224128881
             les_mean =     286.158340622229
             stat err =       0.000463873839
             autocorr =       1.273525111819
              std dev =       0.581314454687
             le_variance =       0.337926495228

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337967991470
                                         uncertainty =       0.005274141303

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337967991470
                                         uncertainty =       0.005274141303

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411045763
  error estimate for blocks of size 2^( 2) =       0.000424526114
  error estimate for blocks of size 2^( 3) =       0.000437800417
  error estimate for blocks of size 2^( 4) =       0.000450136015
  error estimate for blocks of size 2^( 5) =       0.000461129347
  error estimate for blocks of size 2^( 6) =       0.000469107366
  error estimate for blocks of size 2^( 7) =       0.000475106626

      target function =                  N/A
              le_mean =     -16.906224080771
             les_mean =     286.158329738493
             stat err =       0.000463869838
             autocorr =       1.273538030031
              std dev =       0.581306492484
             le_variance =       0.337917238204

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337959388643
                                         uncertainty =       0.005273975178

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337959388643
                                         uncertainty =       0.005273975178

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411040533
  error estimate for blocks of size 2^( 2) =       0.000424521400
  error estimate for blocks of size 2^( 3) =       0.000437796039
  error estimate for blocks of size 2^( 4) =       0.000450132097
  error estimate for blocks of size 2^( 5) =       0.000461125720
  error estimate for blocks of size 2^( 6) =       0.000469103716
  error estimate for blocks of size 2^( 7) =       0.000475102895

      target function =                  N/A
              le_mean =     -16.906224029213
             les_mean =     286.158319396069
             stat err =       0.000463866107
             autocorr =       1.273549951500
              std dev =       0.581299096078
             le_variance =       0.337908639101


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906224021728        initial
     6.1035e+00     6.1035e+01             5.5822e-05       -16.906224128881  <--
     2.4414e+01     2.4414e+02             1.4182e-05       -16.906224080771
     9.7656e+01     9.7656e+02             3.5603e-06       -16.906224029213

*****************************************************************************
Applying the update for shift_i =   6.1035e+00     and shift_s =   6.1035e+01
*****************************************************************************

  Execution time = 3.0331e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.060971e-01 1 1  ON 0
 uu_1                 1.398124e-01 1 1  ON 1
 uu_2                 3.905748e-02 1 1  ON 2
 uu_3                -2.184968e-02 1 1  ON 3
 uu_4                -6.517238e-02 1 1  ON 4
 uu_5                -9.726517e-02 1 1  ON 5
 uu_6                -1.224067e-01 1 1  ON 6
 uu_7                -1.333910e-01 1 1  ON 7
 uu_8                -1.231195e-01 1 1  ON 8
 uu_9                -9.219776e-02 1 1  ON 9
 ud_0                 4.368665e-01 1 1  ON 10
 ud_1                 1.733980e-01 1 1  ON 11
 ud_2                 5.787623e-02 1 1  ON 12
 ud_3                -9.927568e-03 1 1  ON 13
 ud_4                -6.584690e-02 1 1  ON 14
 ud_5                -1.059947e-01 1 1  ON 15
 ud_6                -1.322820e-01 1 1  ON 16
 ud_7                -1.474376e-01 1 1  ON 17
 ud_8                -1.476511e-01 1 1  ON 18
 ud_9                -1.345636e-01 1 1  ON 19
 eO_0                -7.440151e-01 1 1  ON 20
 eO_1                -4.286121e-01 1 1  ON 21
 eO_2                -1.738767e-02 1 1  ON 22
 eO_3                 2.931299e-01 1 1  ON 23
 eO_4                 5.091507e-01 1 1  ON 24
 eO_5                 4.647034e-01 1 1  ON 25
 eO_6                 2.374322e-01 1 1  ON 26
 eO_7                -5.391047e-02 1 1  ON 27
 eO_8                -2.007820e-01 1 1  ON 28
 eO_9                -6.205251e-02 1 1  ON 29
eH1_0                -2.289192e-01 1 1  ON 30
eH1_1                -1.325051e-01 1 1  ON 31
eH1_2                -8.818864e-02 1 1  ON 32
eH1_3                -3.559826e-02 1 1  ON 33
eH1_4                 1.164283e-02 1 1  ON 34
eH1_5                 4.488858e-02 1 1  ON 35
eH1_6                 9.801792e-02 1 1  ON 36
eH1_7                 1.424601e-01 1 1  ON 37
eH1_8                 1.529107e-01 1 1  ON 38
eH1_9                 3.928724e-02 1 1  ON 39
eH2_0                -2.270480e-01 1 1  ON 40
eH2_1                -1.310666e-01 1 1  ON 41
eH2_2                -8.681777e-02 1 1  ON 42
eH2_3                -3.446586e-02 1 1  ON 43
eH2_4                 1.365299e-02 1 1  ON 44
eH2_5                 4.765028e-02 1 1  ON 45
eH2_6                 1.021670e-01 1 1  ON 46
eH2_7                 1.499595e-01 1 1  ON 47
eH2_8                 1.615285e-01 1 1  ON 48
eH2_9                 2.212405e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7199e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.9791
    reference variance = 0.286136
====================================================
  Execution time = 2.1045e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3540e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6422e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335516154340
                                         uncertainty =       0.003286074377

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335516154340
                                         uncertainty =       0.003286074377

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409514712
  error estimate for blocks of size 2^( 2) =       0.000422258213
  error estimate for blocks of size 2^( 3) =       0.000435850187
  error estimate for blocks of size 2^( 4) =       0.000447856419
  error estimate for blocks of size 2^( 5) =       0.000458762113
  error estimate for blocks of size 2^( 6) =       0.000467667599
  error estimate for blocks of size 2^( 7) =       0.000471744865

      target function =                  N/A
              le_mean =     -16.905963831661
             les_mean =     286.147017508640
             stat err =       0.000461507749
             autocorr =       1.270044614937
              std dev =       0.579141259907
             le_variance =       0.335404598927


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690596383166e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905963831661       residual = 7.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905963948524       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905964107588       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905964680615       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905964556775       residual = 5.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905964794123       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905964840711       residual = 3.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905964819631       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905964809446       residual = 9.07e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+00 is 1.886630e-04

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905963831661       residual = 7.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905963862036       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905963902578       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905964063359       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905964024574       residual = 5.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905964084470       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905964095461       residual = 2.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905964089977       residual = 7.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+00 is 4.919401e-05

solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905963831661       residual = 7.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905963839331       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905963849511       residual = 3.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905963891053       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905963880780       residual = 4.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905963895825       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905963898513       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905963897148       residual = 6.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+01 is 1.244609e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.074305 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6694e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.060929e-01 1 1  ON 0
 uu_1                 1.398406e-01 1 1  ON 1
 uu_2                 3.906566e-02 1 1  ON 2
 uu_3                -2.185111e-02 1 1  ON 3
 uu_4                -6.516696e-02 1 1  ON 4
 uu_5                -9.728897e-02 1 1  ON 5
 uu_6                -1.224150e-01 1 1  ON 6
 uu_7                -1.333973e-01 1 1  ON 7
 uu_8                -1.231342e-01 1 1  ON 8
 uu_9                -9.220630e-02 1 1  ON 9
 ud_0                 4.368847e-01 1 1  ON 10
 ud_1                 1.734230e-01 1 1  ON 11
 ud_2                 5.787394e-02 1 1  ON 12
 ud_3                -9.918988e-03 1 1  ON 13
 ud_4                -6.583990e-02 1 1  ON 14
 ud_5                -1.060019e-01 1 1  ON 15
 ud_6                -1.322905e-01 1 1  ON 16
 ud_7                -1.474437e-01 1 1  ON 17
 ud_8                -1.476673e-01 1 1  ON 18
 ud_9                -1.345770e-01 1 1  ON 19
 eO_0                -7.440642e-01 1 1  ON 20
 eO_1                -4.286484e-01 1 1  ON 21
 eO_2                -1.736961e-02 1 1  ON 22
 eO_3                 2.931364e-01 1 1  ON 23
 eO_4                 5.091861e-01 1 1  ON 24
 eO_5                 4.647451e-01 1 1  ON 25
 eO_6                 2.374535e-01 1 1  ON 26
 eO_7                -5.389975e-02 1 1  ON 27
 eO_8                -2.008059e-01 1 1  ON 28
 eO_9                -6.207279e-02 1 1  ON 29
eH1_0                -2.289483e-01 1 1  ON 30
eH1_1                -1.325298e-01 1 1  ON 31
eH1_2                -8.819284e-02 1 1  ON 32
eH1_3                -3.559260e-02 1 1  ON 33
eH1_4                 1.164694e-02 1 1  ON 34
eH1_5                 4.487389e-02 1 1  ON 35
eH1_6                 9.801821e-02 1 1  ON 36
eH1_7                 1.424820e-01 1 1  ON 37
eH1_8                 1.529375e-01 1 1  ON 38
eH1_9                 3.930756e-02 1 1  ON 39
eH2_0                -2.270836e-01 1 1  ON 40
eH2_1                -1.310770e-01 1 1  ON 41
eH2_2                -8.682990e-02 1 1  ON 42
eH2_3                -3.445196e-02 1 1  ON 43
eH2_4                 1.363416e-02 1 1  ON 44
eH2_5                 4.764069e-02 1 1  ON 45
eH2_6                 1.021662e-01 1 1  ON 46
eH2_7                 1.499635e-01 1 1  ON 47
eH2_8                 1.615567e-01 1 1  ON 48
eH2_9                 2.216104e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.9267
    reference variance = 0.204196
====================================================
  Execution time = 2.0389e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3714e-01
  Total weights = 2.0000e+06
  Execution time = 1.9089e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337219080287
                                         uncertainty =       0.006335533052

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337219080287
                                         uncertainty =       0.006335533052

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410563360
  error estimate for blocks of size 2^( 2) =       0.000423481870
  error estimate for blocks of size 2^( 3) =       0.000436158754
  error estimate for blocks of size 2^( 4) =       0.000448016195
  error estimate for blocks of size 2^( 5) =       0.000458516491
  error estimate for blocks of size 2^( 6) =       0.000467833361
  error estimate for blocks of size 2^( 7) =       0.000475561914

      target function =                  N/A
              le_mean =     -16.905716471034
             les_mean =     286.140373776384
             stat err =       0.000462481990
             autocorr =       1.268905477079
              std dev =       0.580624272624
             le_variance =       0.337124545961

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337265229916
                                         uncertainty =       0.006337243806

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337265229916
                                         uncertainty =       0.006337243806

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410591427
  error estimate for blocks of size 2^( 2) =       0.000423507111
  error estimate for blocks of size 2^( 3) =       0.000436181359
  error estimate for blocks of size 2^( 4) =       0.000448036161
  error estimate for blocks of size 2^( 5) =       0.000458533977
  error estimate for blocks of size 2^( 6) =       0.000467850466
  error estimate for blocks of size 2^( 7) =       0.000475576129

      target function =                  N/A
              le_mean =     -16.905716231631
             les_mean =     286.140411775267
             stat err =       0.000462499183
             autocorr =       1.268826340747
              std dev =       0.580663964293
             le_variance =       0.337170639428

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337241142492
                                         uncertainty =       0.006336398698

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337241142492
                                         uncertainty =       0.006336398698

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410576775
  error estimate for blocks of size 2^( 2) =       0.000423493722
  error estimate for blocks of size 2^( 3) =       0.000436169238
  error estimate for blocks of size 2^( 4) =       0.000448025304
  error estimate for blocks of size 2^( 5) =       0.000458524294
  error estimate for blocks of size 2^( 6) =       0.000467841083
  error estimate for blocks of size 2^( 7) =       0.000475567812

      target function =                  N/A
              le_mean =     -16.905716359521
             les_mean =     286.140392035867
             stat err =       0.000462489623
             autocorr =       1.268864446809
              std dev =       0.580643243194
             le_variance =       0.337146575867

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337221833907
                                         uncertainty =       0.006335641378

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337221833907
                                         uncertainty =       0.006335641378

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410565035
  error estimate for blocks of size 2^( 2) =       0.000423483343
  error estimate for blocks of size 2^( 3) =       0.000436160052
  error estimate for blocks of size 2^( 4) =       0.000448017315
  error estimate for blocks of size 2^( 5) =       0.000458517443
  error estimate for blocks of size 2^( 6) =       0.000467834308
  error estimate for blocks of size 2^( 7) =       0.000475562617

      target function =                  N/A
              le_mean =     -16.905716454956
             les_mean =     286.140375982186
             stat err =       0.000462482921
             autocorr =       1.268900233540
              std dev =       0.580626640271
             le_variance =       0.337127295392


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905716471034        initial  <--
     1.5259e+00     1.5259e+01             1.8866e-04       -16.905716231631
     6.1035e+00     6.1035e+01             4.9194e-05       -16.905716359521
     2.4414e+01     2.4414e+02             1.2446e-05       -16.905716454956

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0429
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.060971e-01 1 1  ON 0
 uu_1                 1.398124e-01 1 1  ON 1
 uu_2                 3.905748e-02 1 1  ON 2
 uu_3                -2.184968e-02 1 1  ON 3
 uu_4                -6.517238e-02 1 1  ON 4
 uu_5                -9.726517e-02 1 1  ON 5
 uu_6                -1.224067e-01 1 1  ON 6
 uu_7                -1.333910e-01 1 1  ON 7
 uu_8                -1.231195e-01 1 1  ON 8
 uu_9                -9.219776e-02 1 1  ON 9
 ud_0                 4.368665e-01 1 1  ON 10
 ud_1                 1.733980e-01 1 1  ON 11
 ud_2                 5.787623e-02 1 1  ON 12
 ud_3                -9.927568e-03 1 1  ON 13
 ud_4                -6.584690e-02 1 1  ON 14
 ud_5                -1.059947e-01 1 1  ON 15
 ud_6                -1.322820e-01 1 1  ON 16
 ud_7                -1.474376e-01 1 1  ON 17
 ud_8                -1.476511e-01 1 1  ON 18
 ud_9                -1.345636e-01 1 1  ON 19
 eO_0                -7.440151e-01 1 1  ON 20
 eO_1                -4.286121e-01 1 1  ON 21
 eO_2                -1.738767e-02 1 1  ON 22
 eO_3                 2.931299e-01 1 1  ON 23
 eO_4                 5.091507e-01 1 1  ON 24
 eO_5                 4.647034e-01 1 1  ON 25
 eO_6                 2.374322e-01 1 1  ON 26
 eO_7                -5.391047e-02 1 1  ON 27
 eO_8                -2.007820e-01 1 1  ON 28
 eO_9                -6.205251e-02 1 1  ON 29
eH1_0                -2.289192e-01 1 1  ON 30
eH1_1                -1.325051e-01 1 1  ON 31
eH1_2                -8.818864e-02 1 1  ON 32
eH1_3                -3.559826e-02 1 1  ON 33
eH1_4                 1.164283e-02 1 1  ON 34
eH1_5                 4.488858e-02 1 1  ON 35
eH1_6                 9.801792e-02 1 1  ON 36
eH1_7                 1.424601e-01 1 1  ON 37
eH1_8                 1.529107e-01 1 1  ON 38
eH1_9                 3.928724e-02 1 1  ON 39
eH2_0                -2.270480e-01 1 1  ON 40
eH2_1                -1.310666e-01 1 1  ON 41
eH2_2                -8.681777e-02 1 1  ON 42
eH2_3                -3.446586e-02 1 1  ON 43
eH2_4                 1.365299e-02 1 1  ON 44
eH2_5                 4.765028e-02 1 1  ON 45
eH2_6                 1.021670e-01 1 1  ON 46
eH2_7                 1.499595e-01 1 1  ON 47
eH2_8                 1.615285e-01 1 1  ON 48
eH2_9                 2.212405e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6742e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.9219
    reference variance = 0.264819
====================================================
  Execution time = 2.0985e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3886e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4937e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338920190517
                                         uncertainty =       0.005743811899

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338920190517
                                         uncertainty =       0.005743811899

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411621365
  error estimate for blocks of size 2^( 2) =       0.000423819028
  error estimate for blocks of size 2^( 3) =       0.000436742597
  error estimate for blocks of size 2^( 4) =       0.000448044907
  error estimate for blocks of size 2^( 5) =       0.000458166556
  error estimate for blocks of size 2^( 6) =       0.000465810131
  error estimate for blocks of size 2^( 7) =       0.000469090263

      target function =                  N/A
              le_mean =     -16.905086096370
             les_mean =     286.120800053192
             stat err =       0.000460277964
             autocorr =       1.250387286907
              std dev =       0.582120517530
             le_variance =       0.338864296929


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690508609637e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905086096370       residual = 7.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905086088470       residual = 8.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905086157096       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905086236549       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905086236296       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905086243197       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905086242476       residual = 3.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905086238506       residual = 8.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+01 is 3.052094e-05

solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905086096370       residual = 7.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905086094374       residual = 8.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905086111601       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905086131823       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905086131856       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905086133603       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905086133296       residual = 3.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905086132250       residual = 7.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+01 is 7.659983e-06

solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905086096370       residual = 7.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905086095870       residual = 8.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905086100181       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905086105260       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905086105274       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905086105712       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905086105628       residual = 3.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905086105363       residual = 7.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+02 is 1.916872e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.076977 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6485e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.060954e-01 1 1  ON 0
 uu_1                 1.398150e-01 1 1  ON 1
 uu_2                 3.905879e-02 1 1  ON 2
 uu_3                -2.185116e-02 1 1  ON 3
 uu_4                -6.517094e-02 1 1  ON 4
 uu_5                -9.726404e-02 1 1  ON 5
 uu_6                -1.224067e-01 1 1  ON 6
 uu_7                -1.333922e-01 1 1  ON 7
 uu_8                -1.231231e-01 1 1  ON 8
 uu_9                -9.219985e-02 1 1  ON 9
 ud_0                 4.368693e-01 1 1  ON 10
 ud_1                 1.734016e-01 1 1  ON 11
 ud_2                 5.787740e-02 1 1  ON 12
 ud_3                -9.927692e-03 1 1  ON 13
 ud_4                -6.584831e-02 1 1  ON 14
 ud_5                -1.059940e-01 1 1  ON 15
 ud_6                -1.322823e-01 1 1  ON 16
 ud_7                -1.474403e-01 1 1  ON 17
 ud_8                -1.476534e-01 1 1  ON 18
 ud_9                -1.345658e-01 1 1  ON 19
 eO_0                -7.440227e-01 1 1  ON 20
 eO_1                -4.286168e-01 1 1  ON 21
 eO_2                -1.738695e-02 1 1  ON 22
 eO_3                 2.931350e-01 1 1  ON 23
 eO_4                 5.091552e-01 1 1  ON 24
 eO_5                 4.647082e-01 1 1  ON 25
 eO_6                 2.374346e-01 1 1  ON 26
 eO_7                -5.391042e-02 1 1  ON 27
 eO_8                -2.007850e-01 1 1  ON 28
 eO_9                -6.205468e-02 1 1  ON 29
eH1_0                -2.289233e-01 1 1  ON 30
eH1_1                -1.325068e-01 1 1  ON 31
eH1_2                -8.818990e-02 1 1  ON 32
eH1_3                -3.559974e-02 1 1  ON 33
eH1_4                 1.164175e-02 1 1  ON 34
eH1_5                 4.489016e-02 1 1  ON 35
eH1_6                 9.802030e-02 1 1  ON 36
eH1_7                 1.424622e-01 1 1  ON 37
eH1_8                 1.529122e-01 1 1  ON 38
eH1_9                 3.928920e-02 1 1  ON 39
eH2_0                -2.270505e-01 1 1  ON 40
eH2_1                -1.310671e-01 1 1  ON 41
eH2_2                -8.681761e-02 1 1  ON 42
eH2_3                -3.446565e-02 1 1  ON 43
eH2_4                 1.365170e-02 1 1  ON 44
eH2_5                 4.764953e-02 1 1  ON 45
eH2_6                 1.021664e-01 1 1  ON 46
eH2_7                 1.499590e-01 1 1  ON 47
eH2_8                 1.615311e-01 1 1  ON 48
eH2_9                 2.212735e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.8629
    reference variance = 0.25644
====================================================
  Execution time = 2.2581e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.5513e-01
  Total weights = 2.0000e+06
  Execution time = 1.9268e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355193986800
                                         uncertainty =       0.018534512441

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355193986800
                                         uncertainty =       0.018534512441

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421382306
  error estimate for blocks of size 2^( 2) =       0.000434036610
  error estimate for blocks of size 2^( 3) =       0.000446429992
  error estimate for blocks of size 2^( 4) =       0.000458915790
  error estimate for blocks of size 2^( 5) =       0.000469203657
  error estimate for blocks of size 2^( 6) =       0.000477626099
  error estimate for blocks of size 2^( 7) =       0.000480294679

      target function =                  N/A
              le_mean =     -16.905226561688
             les_mean =     286.141811019902
             stat err =       0.000471510056
             autocorr =       1.252072072921
              std dev =       0.595924571967
             le_variance =       0.355126095474

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355196853127
                                         uncertainty =       0.018534767967

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355196853127
                                         uncertainty =       0.018534767967

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421384004
  error estimate for blocks of size 2^( 2) =       0.000434038135
  error estimate for blocks of size 2^( 3) =       0.000446431188
  error estimate for blocks of size 2^( 4) =       0.000458916784
  error estimate for blocks of size 2^( 5) =       0.000469204420
  error estimate for blocks of size 2^( 6) =       0.000477626339
  error estimate for blocks of size 2^( 7) =       0.000480294994

      target function =                  N/A
              le_mean =     -16.905226594125
             les_mean =     286.141814978992
             stat err =       0.000471510634
             autocorr =       1.252065050912
              std dev =       0.595926973594
             le_variance =       0.355128957857

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355195360753
                                         uncertainty =       0.018534640839

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355195360753
                                         uncertainty =       0.018534640839

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421383120
  error estimate for blocks of size 2^( 2) =       0.000434037338
  error estimate for blocks of size 2^( 3) =       0.000446430556
  error estimate for blocks of size 2^( 4) =       0.000458916255
  error estimate for blocks of size 2^( 5) =       0.000469204007
  error estimate for blocks of size 2^( 6) =       0.000477626183
  error estimate for blocks of size 2^( 7) =       0.000480294800

      target function =                  N/A
              le_mean =     -16.905226577971
             les_mean =     286.141812942401
             stat err =       0.000471510311
             autocorr =       1.252068589685
              std dev =       0.595925723088
             le_variance =       0.355127467438

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355194156511
                                         uncertainty =       0.018534528511

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355194156511
                                         uncertainty =       0.018534528511

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421382406
  error estimate for blocks of size 2^( 2) =       0.000434036699
  error estimate for blocks of size 2^( 3) =       0.000446430061
  error estimate for blocks of size 2^( 4) =       0.000458915847
  error estimate for blocks of size 2^( 5) =       0.000469203700
  error estimate for blocks of size 2^( 6) =       0.000477626109
  error estimate for blocks of size 2^( 7) =       0.000480294693

      target function =                  N/A
              le_mean =     -16.905226563708
             les_mean =     286.141811257674
             stat err =       0.000471510087
             autocorr =       1.252071638401
              std dev =       0.595924714151
             le_variance =       0.355126264936


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905226561688        initial
     1.5259e+01     1.5259e+02             3.0521e-05       -16.905226594125  <--
     6.1035e+01     6.1035e+02             7.6600e-06       -16.905226577971
     2.4414e+02     2.4414e+03             1.9169e-06       -16.905226563708

*****************************************************************************
Applying the update for shift_i =   1.5259e+01     and shift_s =   1.5259e+02
*****************************************************************************

  Execution time = 3.2307e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.060903e-01 1 1  ON 0
 uu_1                 1.398226e-01 1 1  ON 1
 uu_2                 3.906260e-02 1 1  ON 2
 uu_3                -2.185544e-02 1 1  ON 3
 uu_4                -6.516682e-02 1 1  ON 4
 uu_5                -9.726064e-02 1 1  ON 5
 uu_6                -1.224068e-01 1 1  ON 6
 uu_7                -1.333960e-01 1 1  ON 7
 uu_8                -1.231337e-01 1 1  ON 8
 uu_9                -9.220613e-02 1 1  ON 9
 ud_0                 4.368781e-01 1 1  ON 10
 ud_1                 1.734124e-01 1 1  ON 11
 ud_2                 5.788095e-02 1 1  ON 12
 ud_3                -9.928073e-03 1 1  ON 13
 ud_4                -6.585243e-02 1 1  ON 14
 ud_5                -1.059920e-01 1 1  ON 15
 ud_6                -1.322831e-01 1 1  ON 16
 ud_7                -1.474482e-01 1 1  ON 17
 ud_8                -1.476603e-01 1 1  ON 18
 ud_9                -1.345726e-01 1 1  ON 19
 eO_0                -7.440456e-01 1 1  ON 20
 eO_1                -4.286308e-01 1 1  ON 21
 eO_2                -1.738483e-02 1 1  ON 22
 eO_3                 2.931502e-01 1 1  ON 23
 eO_4                 5.091689e-01 1 1  ON 24
 eO_5                 4.647228e-01 1 1  ON 25
 eO_6                 2.374419e-01 1 1  ON 26
 eO_7                -5.391028e-02 1 1  ON 27
 eO_8                -2.007941e-01 1 1  ON 28
 eO_9                -6.206119e-02 1 1  ON 29
eH1_0                -2.289354e-01 1 1  ON 30
eH1_1                -1.325119e-01 1 1  ON 31
eH1_2                -8.819366e-02 1 1  ON 32
eH1_3                -3.560416e-02 1 1  ON 33
eH1_4                 1.163848e-02 1 1  ON 34
eH1_5                 4.489488e-02 1 1  ON 35
eH1_6                 9.802743e-02 1 1  ON 36
eH1_7                 1.424683e-01 1 1  ON 37
eH1_8                 1.529167e-01 1 1  ON 38
eH1_9                 3.929504e-02 1 1  ON 39
eH2_0                -2.270580e-01 1 1  ON 40
eH2_1                -1.310688e-01 1 1  ON 41
eH2_2                -8.681712e-02 1 1  ON 42
eH2_3                -3.446505e-02 1 1  ON 43
eH2_4                 1.364782e-02 1 1  ON 44
eH2_5                 4.764728e-02 1 1  ON 45
eH2_6                 1.021646e-01 1 1  ON 46
eH2_7                 1.499576e-01 1 1  ON 47
eH2_8                 1.615390e-01 1 1  ON 48
eH2_9                 2.213723e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8800e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.9418
    reference variance = 0.338219
====================================================
  Execution time = 2.1079e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3416e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5343e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334016284668
                                         uncertainty =       0.003075755040

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334016284668
                                         uncertainty =       0.003075755040

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408754393
  error estimate for blocks of size 2^( 2) =       0.000421546427
  error estimate for blocks of size 2^( 3) =       0.000435353033
  error estimate for blocks of size 2^( 4) =       0.000447186561
  error estimate for blocks of size 2^( 5) =       0.000456578104
  error estimate for blocks of size 2^( 6) =       0.000463310955
  error estimate for blocks of size 2^( 7) =       0.000466763762

      target function =                  N/A
              le_mean =     -16.906035594289
             les_mean =     286.148199655826
             stat err =       0.000458459845
             autocorr =       1.257991598786
              std dev =       0.578066006205
             le_variance =       0.334160307530


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690603559429e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906035594289       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906035639412       residual = 3.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906035906921       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906036000484       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906036160028       residual = 5.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906036194798       residual = 2.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906036127639       residual = 4.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906036098563       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906036093536       residual = 1.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+00 is 8.352687e-05

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906035594289       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906035605997       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906035675070       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906035697291       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906035749390       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906035740464       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906035733417       residual = 4.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906035727088       residual = 7.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+01 is 2.110874e-05

solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906035594289       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906035597244       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906035614655       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906035620144       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906035633717       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906035630565       residual = 2.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906035629882       residual = 4.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906035627930       residual = 7.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+01 is 5.294522e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.079835 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6621e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.060996e-01 1 1  ON 0
 uu_1                 1.398344e-01 1 1  ON 1
 uu_2                 3.906454e-02 1 1  ON 2
 uu_3                -2.185813e-02 1 1  ON 3
 uu_4                -6.516851e-02 1 1  ON 4
 uu_5                -9.726470e-02 1 1  ON 5
 uu_6                -1.224100e-01 1 1  ON 6
 uu_7                -1.334082e-01 1 1  ON 7
 uu_8                -1.231437e-01 1 1  ON 8
 uu_9                -9.220977e-02 1 1  ON 9
 ud_0                 4.368838e-01 1 1  ON 10
 ud_1                 1.734257e-01 1 1  ON 11
 ud_2                 5.788671e-02 1 1  ON 12
 ud_3                -9.929666e-03 1 1  ON 13
 ud_4                -6.585145e-02 1 1  ON 14
 ud_5                -1.059899e-01 1 1  ON 15
 ud_6                -1.322777e-01 1 1  ON 16
 ud_7                -1.474561e-01 1 1  ON 17
 ud_8                -1.476746e-01 1 1  ON 18
 ud_9                -1.345808e-01 1 1  ON 19
 eO_0                -7.440667e-01 1 1  ON 20
 eO_1                -4.286457e-01 1 1  ON 21
 eO_2                -1.737956e-02 1 1  ON 22
 eO_3                 2.931578e-01 1 1  ON 23
 eO_4                 5.091859e-01 1 1  ON 24
 eO_5                 4.647407e-01 1 1  ON 25
 eO_6                 2.374527e-01 1 1  ON 26
 eO_7                -5.391099e-02 1 1  ON 27
 eO_8                -2.008057e-01 1 1  ON 28
 eO_9                -6.206997e-02 1 1  ON 29
eH1_0                -2.289466e-01 1 1  ON 30
eH1_1                -1.325235e-01 1 1  ON 31
eH1_2                -8.820168e-02 1 1  ON 32
eH1_3                -3.560999e-02 1 1  ON 33
eH1_4                 1.163628e-02 1 1  ON 34
eH1_5                 4.489981e-02 1 1  ON 35
eH1_6                 9.803507e-02 1 1  ON 36
eH1_7                 1.424747e-01 1 1  ON 37
eH1_8                 1.529258e-01 1 1  ON 38
eH1_9                 3.930570e-02 1 1  ON 39
eH2_0                -2.270722e-01 1 1  ON 40
eH2_1                -1.310708e-01 1 1  ON 41
eH2_2                -8.682119e-02 1 1  ON 42
eH2_3                -3.445993e-02 1 1  ON 43
eH2_4                 1.363951e-02 1 1  ON 44
eH2_5                 4.764304e-02 1 1  ON 45
eH2_6                 1.021671e-01 1 1  ON 46
eH2_7                 1.499588e-01 1 1  ON 47
eH2_8                 1.615468e-01 1 1  ON 48
eH2_9                 2.215248e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.9048
    reference variance = 0.234064
====================================================
  Execution time = 2.0730e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3894e-01
  Total weights = 2.0000e+06
  Execution time = 1.9215e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339073537707
                                         uncertainty =       0.004112162533

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339073537707
                                         uncertainty =       0.004112162533

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411664658
  error estimate for blocks of size 2^( 2) =       0.000424162629
  error estimate for blocks of size 2^( 3) =       0.000437579555
  error estimate for blocks of size 2^( 4) =       0.000449748652
  error estimate for blocks of size 2^( 5) =       0.000460596373
  error estimate for blocks of size 2^( 6) =       0.000467800715
  error estimate for blocks of size 2^( 7) =       0.000470228530

      target function =                  N/A
              le_mean =     -16.905317440602
             les_mean =     286.128693178759
             stat err =       0.000462093567
             autocorr =       1.260006190696
              std dev =       0.582181742003
             le_variance =       0.338935580722

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339088632472
                                         uncertainty =       0.004112779995

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339088632472
                                         uncertainty =       0.004112779995

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411673806
  error estimate for blocks of size 2^( 2) =       0.000424170823
  error estimate for blocks of size 2^( 3) =       0.000437586295
  error estimate for blocks of size 2^( 4) =       0.000449754100
  error estimate for blocks of size 2^( 5) =       0.000460600666
  error estimate for blocks of size 2^( 6) =       0.000467804766
  error estimate for blocks of size 2^( 7) =       0.000470233541

      target function =                  N/A
              le_mean =     -16.905317346484
             les_mean =     286.128705060752
             stat err =       0.000462098268
             autocorr =       1.259975826514
              std dev =       0.582194679552
             le_variance =       0.338950644899

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339079216978
                                         uncertainty =       0.004112461792

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339079216978
                                         uncertainty =       0.004112461792

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411668097
  error estimate for blocks of size 2^( 2) =       0.000424165639
  error estimate for blocks of size 2^( 3) =       0.000437581873
  error estimate for blocks of size 2^( 4) =       0.000449750360
  error estimate for blocks of size 2^( 5) =       0.000460597481
  error estimate for blocks of size 2^( 6) =       0.000467801740
  error estimate for blocks of size 2^( 7) =       0.000470230091

      target function =                  N/A
              le_mean =     -16.905317390260
             les_mean =     286.128697140048
             stat err =       0.000462094918
             autocorr =       1.259992504112
              std dev =       0.582186605890
             le_variance =       0.338941244077

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339074213359
                                         uncertainty =       0.004112200023

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339074213359
                                         uncertainty =       0.004112200023

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411665067
  error estimate for blocks of size 2^( 2) =       0.000424162985
  error estimate for blocks of size 2^( 3) =       0.000437579824
  error estimate for blocks of size 2^( 4) =       0.000449748845
  error estimate for blocks of size 2^( 5) =       0.000460596491
  error estimate for blocks of size 2^( 6) =       0.000467800822
  error estimate for blocks of size 2^( 7) =       0.000470228705

      target function =                  N/A
              le_mean =     -16.905317433908
             les_mean =     286.128693626107
             stat err =       0.000462093716
             autocorr =       1.260004496596
              std dev =       0.582182320558
             le_variance =       0.338936254370


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905317440602        initial  <--
     3.8147e+00     3.8147e+01             8.3527e-05       -16.905317346484
     1.5259e+01     1.5259e+02             2.1109e-05       -16.905317390260
     6.1035e+01     6.1035e+02             5.2945e-06       -16.905317433908

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.4363
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.060903e-01 1 1  ON 0
 uu_1                 1.398226e-01 1 1  ON 1
 uu_2                 3.906260e-02 1 1  ON 2
 uu_3                -2.185544e-02 1 1  ON 3
 uu_4                -6.516682e-02 1 1  ON 4
 uu_5                -9.726064e-02 1 1  ON 5
 uu_6                -1.224068e-01 1 1  ON 6
 uu_7                -1.333960e-01 1 1  ON 7
 uu_8                -1.231337e-01 1 1  ON 8
 uu_9                -9.220613e-02 1 1  ON 9
 ud_0                 4.368781e-01 1 1  ON 10
 ud_1                 1.734124e-01 1 1  ON 11
 ud_2                 5.788095e-02 1 1  ON 12
 ud_3                -9.928073e-03 1 1  ON 13
 ud_4                -6.585243e-02 1 1  ON 14
 ud_5                -1.059920e-01 1 1  ON 15
 ud_6                -1.322831e-01 1 1  ON 16
 ud_7                -1.474482e-01 1 1  ON 17
 ud_8                -1.476603e-01 1 1  ON 18
 ud_9                -1.345726e-01 1 1  ON 19
 eO_0                -7.440456e-01 1 1  ON 20
 eO_1                -4.286308e-01 1 1  ON 21
 eO_2                -1.738483e-02 1 1  ON 22
 eO_3                 2.931502e-01 1 1  ON 23
 eO_4                 5.091689e-01 1 1  ON 24
 eO_5                 4.647228e-01 1 1  ON 25
 eO_6                 2.374419e-01 1 1  ON 26
 eO_7                -5.391028e-02 1 1  ON 27
 eO_8                -2.007941e-01 1 1  ON 28
 eO_9                -6.206119e-02 1 1  ON 29
eH1_0                -2.289354e-01 1 1  ON 30
eH1_1                -1.325119e-01 1 1  ON 31
eH1_2                -8.819366e-02 1 1  ON 32
eH1_3                -3.560416e-02 1 1  ON 33
eH1_4                 1.163848e-02 1 1  ON 34
eH1_5                 4.489488e-02 1 1  ON 35
eH1_6                 9.802743e-02 1 1  ON 36
eH1_7                 1.424683e-01 1 1  ON 37
eH1_8                 1.529167e-01 1 1  ON 38
eH1_9                 3.929504e-02 1 1  ON 39
eH2_0                -2.270580e-01 1 1  ON 40
eH2_1                -1.310688e-01 1 1  ON 41
eH2_2                -8.681712e-02 1 1  ON 42
eH2_3                -3.446505e-02 1 1  ON 43
eH2_4                 1.364782e-02 1 1  ON 44
eH2_5                 4.764728e-02 1 1  ON 45
eH2_6                 1.021646e-01 1 1  ON 46
eH2_7                 1.499576e-01 1 1  ON 47
eH2_8                 1.615390e-01 1 1  ON 48
eH2_9                 2.213723e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7062e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.8945
    reference variance = 0.307404
====================================================
  Execution time = 2.0967e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3486e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5095e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334865788525
                                         uncertainty =       0.003761203620

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334865788525
                                         uncertainty =       0.003761203620

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409180491
  error estimate for blocks of size 2^( 2) =       0.000421854722
  error estimate for blocks of size 2^( 3) =       0.000435396720
  error estimate for blocks of size 2^( 4) =       0.000448006529
  error estimate for blocks of size 2^( 5) =       0.000460207906
  error estimate for blocks of size 2^( 6) =       0.000467318155
  error estimate for blocks of size 2^( 7) =       0.000473795253

      target function =                  N/A
              le_mean =     -16.905968955490
             les_mean =     286.146643504914
             stat err =       0.000462331961
             autocorr =       1.276668068499
              std dev =       0.578668599748
             le_variance =       0.334857348334


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690596895549e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905968955490       residual = 3.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905968949648       residual = 5.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905968959033       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905968941294       residual = 9.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905968929509       residual = 3.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905968934903       residual = 3.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905968941857       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905968941987       residual = 4.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+01 is 9.353869e-06

solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905968955490       residual = 3.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905968954024       residual = 5.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905968956383       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905968951933       residual = 8.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905968948961       residual = 2.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905968950658       residual = 2.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905968952063       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905968952086       residual = 4.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+02 is 2.342998e-06

solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905968955490       residual = 3.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905968955124       residual = 5.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905968955714       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905968954600       residual = 8.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905968953856       residual = 2.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905968954306       residual = 2.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905968954632       residual = 2.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905968954638       residual = 4.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+02 is 5.860351e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.082561 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6483e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.060893e-01 1 1  ON 0
 uu_1                 1.398234e-01 1 1  ON 1
 uu_2                 3.906311e-02 1 1  ON 2
 uu_3                -2.185562e-02 1 1  ON 3
 uu_4                -6.516618e-02 1 1  ON 4
 uu_5                -9.726108e-02 1 1  ON 5
 uu_6                -1.224073e-01 1 1  ON 6
 uu_7                -1.333968e-01 1 1  ON 7
 uu_8                -1.231343e-01 1 1  ON 8
 uu_9                -9.220625e-02 1 1  ON 9
 ud_0                 4.368788e-01 1 1  ON 10
 ud_1                 1.734137e-01 1 1  ON 11
 ud_2                 5.788128e-02 1 1  ON 12
 ud_3                -9.928283e-03 1 1  ON 13
 ud_4                -6.585343e-02 1 1  ON 14
 ud_5                -1.059924e-01 1 1  ON 15
 ud_6                -1.322828e-01 1 1  ON 16
 ud_7                -1.474476e-01 1 1  ON 17
 ud_8                -1.476615e-01 1 1  ON 18
 ud_9                -1.345733e-01 1 1  ON 19
 eO_0                -7.440479e-01 1 1  ON 20
 eO_1                -4.286325e-01 1 1  ON 21
 eO_2                -1.738525e-02 1 1  ON 22
 eO_3                 2.931517e-01 1 1  ON 23
 eO_4                 5.091708e-01 1 1  ON 24
 eO_5                 4.647247e-01 1 1  ON 25
 eO_6                 2.374423e-01 1 1  ON 26
 eO_7                -5.390988e-02 1 1  ON 27
 eO_8                -2.007949e-01 1 1  ON 28
 eO_9                -6.206196e-02 1 1  ON 29
eH1_0                -2.289362e-01 1 1  ON 30
eH1_1                -1.325122e-01 1 1  ON 31
eH1_2                -8.819481e-02 1 1  ON 32
eH1_3                -3.560467e-02 1 1  ON 33
eH1_4                 1.163798e-02 1 1  ON 34
eH1_5                 4.489530e-02 1 1  ON 35
eH1_6                 9.802756e-02 1 1  ON 36
eH1_7                 1.424689e-01 1 1  ON 37
eH1_8                 1.529177e-01 1 1  ON 38
eH1_9                 3.929605e-02 1 1  ON 39
eH2_0                -2.270593e-01 1 1  ON 40
eH2_1                -1.310696e-01 1 1  ON 41
eH2_2                -8.681807e-02 1 1  ON 42
eH2_3                -3.446490e-02 1 1  ON 43
eH2_4                 1.364738e-02 1 1  ON 44
eH2_5                 4.764772e-02 1 1  ON 45
eH2_6                 1.021649e-01 1 1  ON 46
eH2_7                 1.499578e-01 1 1  ON 47
eH2_8                 1.615400e-01 1 1  ON 48
eH2_9                 2.213857e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.8936
    reference variance = 0.149817
====================================================
  Execution time = 2.0417e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3944e-01
  Total weights = 2.0000e+06
  Execution time = 1.9193e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339260026776
                                         uncertainty =       0.006297762043

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339260026776
                                         uncertainty =       0.006297762043

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411969519
  error estimate for blocks of size 2^( 2) =       0.000424689752
  error estimate for blocks of size 2^( 3) =       0.000437718039
  error estimate for blocks of size 2^( 4) =       0.000449352353
  error estimate for blocks of size 2^( 5) =       0.000460219024
  error estimate for blocks of size 2^( 6) =       0.000468373103
  error estimate for blocks of size 2^( 7) =       0.000473232536

      target function =                  N/A
              le_mean =     -16.905667526251
             les_mean =     286.141032107369
             stat err =       0.000462794254
             autocorr =       1.261960459591
              std dev =       0.582612880873
             le_variance =       0.339437768959

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339261090106
                                         uncertainty =       0.006298366820

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339261090106
                                         uncertainty =       0.006298366820

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411970163
  error estimate for blocks of size 2^( 2) =       0.000424690336
  error estimate for blocks of size 2^( 3) =       0.000437718510
  error estimate for blocks of size 2^( 4) =       0.000449352702
  error estimate for blocks of size 2^( 5) =       0.000460219333
  error estimate for blocks of size 2^( 6) =       0.000468373450
  error estimate for blocks of size 2^( 7) =       0.000473232824

      target function =                  N/A
              le_mean =     -16.905667512197
             les_mean =     286.141032693277
             stat err =       0.000462794577
             autocorr =       1.261958278222
              std dev =       0.582613791492
             le_variance =       0.339438830036

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339260548931
                                         uncertainty =       0.006298065729

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339260548931
                                         uncertainty =       0.006298065729

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411969835
  error estimate for blocks of size 2^( 2) =       0.000424690038
  error estimate for blocks of size 2^( 3) =       0.000437718268
  error estimate for blocks of size 2^( 4) =       0.000449352522
  error estimate for blocks of size 2^( 5) =       0.000460219173
  error estimate for blocks of size 2^( 6) =       0.000468373271
  error estimate for blocks of size 2^( 7) =       0.000473232675

      target function =                  N/A
              le_mean =     -16.905667519169
             les_mean =     286.141032388929
             stat err =       0.000462794410
             autocorr =       1.261959375596
              std dev =       0.582613327997
             le_variance =       0.339438289960

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339260091726
                                         uncertainty =       0.006297800044

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339260091726
                                         uncertainty =       0.006297800044

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411969558
  error estimate for blocks of size 2^( 2) =       0.000424689788
  error estimate for blocks of size 2^( 3) =       0.000437718067
  error estimate for blocks of size 2^( 4) =       0.000449352374
  error estimate for blocks of size 2^( 5) =       0.000460219043
  error estimate for blocks of size 2^( 6) =       0.000468373123
  error estimate for blocks of size 2^( 7) =       0.000473232553

      target function =                  N/A
              le_mean =     -16.905667525362
             les_mean =     286.141032142110
             stat err =       0.000462794273
             autocorr =       1.261960324301
              std dev =       0.582612936488
             le_variance =       0.339437833764


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905667526251        initial  <--
     3.8147e+01     3.8147e+02             9.3539e-06       -16.905667512197
     1.5259e+02     1.5259e+03             2.3430e-06       -16.905667519169
     6.1035e+02     6.1035e+03             5.8604e-07       -16.905667525362

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.1130
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.060903e-01 1 1  ON 0
 uu_1                 1.398226e-01 1 1  ON 1
 uu_2                 3.906260e-02 1 1  ON 2
 uu_3                -2.185544e-02 1 1  ON 3
 uu_4                -6.516682e-02 1 1  ON 4
 uu_5                -9.726064e-02 1 1  ON 5
 uu_6                -1.224068e-01 1 1  ON 6
 uu_7                -1.333960e-01 1 1  ON 7
 uu_8                -1.231337e-01 1 1  ON 8
 uu_9                -9.220613e-02 1 1  ON 9
 ud_0                 4.368781e-01 1 1  ON 10
 ud_1                 1.734124e-01 1 1  ON 11
 ud_2                 5.788095e-02 1 1  ON 12
 ud_3                -9.928073e-03 1 1  ON 13
 ud_4                -6.585243e-02 1 1  ON 14
 ud_5                -1.059920e-01 1 1  ON 15
 ud_6                -1.322831e-01 1 1  ON 16
 ud_7                -1.474482e-01 1 1  ON 17
 ud_8                -1.476603e-01 1 1  ON 18
 ud_9                -1.345726e-01 1 1  ON 19
 eO_0                -7.440456e-01 1 1  ON 20
 eO_1                -4.286308e-01 1 1  ON 21
 eO_2                -1.738483e-02 1 1  ON 22
 eO_3                 2.931502e-01 1 1  ON 23
 eO_4                 5.091689e-01 1 1  ON 24
 eO_5                 4.647228e-01 1 1  ON 25
 eO_6                 2.374419e-01 1 1  ON 26
 eO_7                -5.391028e-02 1 1  ON 27
 eO_8                -2.007941e-01 1 1  ON 28
 eO_9                -6.206119e-02 1 1  ON 29
eH1_0                -2.289354e-01 1 1  ON 30
eH1_1                -1.325119e-01 1 1  ON 31
eH1_2                -8.819366e-02 1 1  ON 32
eH1_3                -3.560416e-02 1 1  ON 33
eH1_4                 1.163848e-02 1 1  ON 34
eH1_5                 4.489488e-02 1 1  ON 35
eH1_6                 9.802743e-02 1 1  ON 36
eH1_7                 1.424683e-01 1 1  ON 37
eH1_8                 1.529167e-01 1 1  ON 38
eH1_9                 3.929504e-02 1 1  ON 39
eH2_0                -2.270580e-01 1 1  ON 40
eH2_1                -1.310688e-01 1 1  ON 41
eH2_2                -8.681712e-02 1 1  ON 42
eH2_3                -3.446505e-02 1 1  ON 43
eH2_4                 1.364782e-02 1 1  ON 44
eH2_5                 4.764728e-02 1 1  ON 45
eH2_6                 1.021646e-01 1 1  ON 46
eH2_7                 1.499576e-01 1 1  ON 47
eH2_8                 1.615390e-01 1 1  ON 48
eH2_9                 2.213723e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6601e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.927
    reference variance = 0.225443
====================================================
  Execution time = 2.1206e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.5363e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5822e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353657257107
                                         uncertainty =       0.013759231401

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353657257107
                                         uncertainty =       0.013759231401

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420492802
  error estimate for blocks of size 2^( 2) =       0.000432655983
  error estimate for blocks of size 2^( 3) =       0.000446005521
  error estimate for blocks of size 2^( 4) =       0.000458831882
  error estimate for blocks of size 2^( 5) =       0.000469014477
  error estimate for blocks of size 2^( 6) =       0.000478096897
  error estimate for blocks of size 2^( 7) =       0.000484346365

      target function =                  N/A
              le_mean =     -16.905346636170
             les_mean =     286.144373106061
             stat err =       0.000472572406
             autocorr =       1.263047212401
              std dev =       0.594666624084
             le_variance =       0.353628393799


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690534663617e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905346636170       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905346638701       residual = 3.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905346638674       residual = 5.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905346637833       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905346638141       residual = 5.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905346638565       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905346638481       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905346638858       residual = 7.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+02 is 9.160397e-07

solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905346636170       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905346636803       residual = 3.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905346636796       residual = 5.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905346636587       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905346636663       residual = 5.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905346636768       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905346636747       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905346636846       residual = 7.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+03 is 2.290654e-07

solving harmonic davidson linear method for identity shift 6.1035e+03, overlap shift 6.1035e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905346636170       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905346636329       residual = 3.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905346636327       residual = 5.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905346636273       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905346636294       residual = 5.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905346636320       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905346636314       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905346636309       residual = 7.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+03 is 5.726982e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.085240 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6795e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.060903e-01 1 1  ON 0
 uu_1                 1.398227e-01 1 1  ON 1
 uu_2                 3.906272e-02 1 1  ON 2
 uu_3                -2.185549e-02 1 1  ON 3
 uu_4                -6.516679e-02 1 1  ON 4
 uu_5                -9.726070e-02 1 1  ON 5
 uu_6                -1.224068e-01 1 1  ON 6
 uu_7                -1.333961e-01 1 1  ON 7
 uu_8                -1.231338e-01 1 1  ON 8
 uu_9                -9.220617e-02 1 1  ON 9
 ud_0                 4.368782e-01 1 1  ON 10
 ud_1                 1.734125e-01 1 1  ON 11
 ud_2                 5.788098e-02 1 1  ON 12
 ud_3                -9.928020e-03 1 1  ON 13
 ud_4                -6.585251e-02 1 1  ON 14
 ud_5                -1.059920e-01 1 1  ON 15
 ud_6                -1.322831e-01 1 1  ON 16
 ud_7                -1.474483e-01 1 1  ON 17
 ud_8                -1.476604e-01 1 1  ON 18
 ud_9                -1.345726e-01 1 1  ON 19
 eO_0                -7.440458e-01 1 1  ON 20
 eO_1                -4.286310e-01 1 1  ON 21
 eO_2                -1.738489e-02 1 1  ON 22
 eO_3                 2.931504e-01 1 1  ON 23
 eO_4                 5.091691e-01 1 1  ON 24
 eO_5                 4.647230e-01 1 1  ON 25
 eO_6                 2.374420e-01 1 1  ON 26
 eO_7                -5.391025e-02 1 1  ON 27
 eO_8                -2.007942e-01 1 1  ON 28
 eO_9                -6.206128e-02 1 1  ON 29
eH1_0                -2.289356e-01 1 1  ON 30
eH1_1                -1.325120e-01 1 1  ON 31
eH1_2                -8.819377e-02 1 1  ON 32
eH1_3                -3.560421e-02 1 1  ON 33
eH1_4                 1.163838e-02 1 1  ON 34
eH1_5                 4.489488e-02 1 1  ON 35
eH1_6                 9.802757e-02 1 1  ON 36
eH1_7                 1.424684e-01 1 1  ON 37
eH1_8                 1.529168e-01 1 1  ON 38
eH1_9                 3.929515e-02 1 1  ON 39
eH2_0                -2.270581e-01 1 1  ON 40
eH2_1                -1.310688e-01 1 1  ON 41
eH2_2                -8.681714e-02 1 1  ON 42
eH2_3                -3.446507e-02 1 1  ON 43
eH2_4                 1.364783e-02 1 1  ON 44
eH2_5                 4.764724e-02 1 1  ON 45
eH2_6                 1.021646e-01 1 1  ON 46
eH2_7                 1.499575e-01 1 1  ON 47
eH2_8                 1.615391e-01 1 1  ON 48
eH2_9                 2.213738e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.8835
    reference variance = 0.256362
====================================================
  Execution time = 2.0484e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3738e-01
  Total weights = 2.0000e+06
  Execution time = 1.9113e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337302130416
                                         uncertainty =       0.004185764806

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337302130416
                                         uncertainty =       0.004185764806

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410717873
  error estimate for blocks of size 2^( 2) =       0.000423237058
  error estimate for blocks of size 2^( 3) =       0.000436228663
  error estimate for blocks of size 2^( 4) =       0.000449414923
  error estimate for blocks of size 2^( 5) =       0.000460365745
  error estimate for blocks of size 2^( 6) =       0.000469233386
  error estimate for blocks of size 2^( 7) =       0.000471779456

      target function =                  N/A
              le_mean =     -16.905299417625
             les_mean =     286.126526572814
             stat err =       0.000462698377
             autocorr =       1.269137711833
              std dev =       0.580842785930
             le_variance =       0.337378341966

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337302336706
                                         uncertainty =       0.004185767042

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337302336706
                                         uncertainty =       0.004185767042

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410717998
  error estimate for blocks of size 2^( 2) =       0.000423237173
  error estimate for blocks of size 2^( 3) =       0.000436228761
  error estimate for blocks of size 2^( 4) =       0.000449415010
  error estimate for blocks of size 2^( 5) =       0.000460365826
  error estimate for blocks of size 2^( 6) =       0.000469233459
  error estimate for blocks of size 2^( 7) =       0.000471779510

      target function =                  N/A
              le_mean =     -16.905299419430
             les_mean =     286.126526839975
             stat err =       0.000462698451
             autocorr =       1.269137341912
              std dev =       0.580842963373
             le_variance =       0.337378548100

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337302233556
                                         uncertainty =       0.004185765923

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337302233556
                                         uncertainty =       0.004185765923

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410717935
  error estimate for blocks of size 2^( 2) =       0.000423237116
  error estimate for blocks of size 2^( 3) =       0.000436228712
  error estimate for blocks of size 2^( 4) =       0.000449414966
  error estimate for blocks of size 2^( 5) =       0.000460365785
  error estimate for blocks of size 2^( 6) =       0.000469233423
  error estimate for blocks of size 2^( 7) =       0.000471779483

      target function =                  N/A
              le_mean =     -16.905299418527
             les_mean =     286.126526706387
             stat err =       0.000462698414
             autocorr =       1.269137526815
              std dev =       0.580842874647
             le_variance =       0.337378445029

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337302143308
                                         uncertainty =       0.004185764945

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337302143308
                                         uncertainty =       0.004185764945

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410717881
  error estimate for blocks of size 2^( 2) =       0.000423237065
  error estimate for blocks of size 2^( 3) =       0.000436228669
  error estimate for blocks of size 2^( 4) =       0.000449414928
  error estimate for blocks of size 2^( 5) =       0.000460365750
  error estimate for blocks of size 2^( 6) =       0.000469233391
  error estimate for blocks of size 2^( 7) =       0.000471779459

      target function =                  N/A
              le_mean =     -16.905299417737
             les_mean =     286.126526589510
             stat err =       0.000462698382
             autocorr =       1.269137688711
              std dev =       0.580842797019
             le_variance =       0.337378354849


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905299417625        initial
     3.8147e+02     3.8147e+03             9.1604e-07       -16.905299419430  <--
     1.5259e+03     1.5259e+04             2.2907e-07       -16.905299418527
     6.1035e+03     6.1035e+04             5.7270e-08       -16.905299417737

*****************************************************************************
Applying the update for shift_i =   3.8147e+02     and shift_s =   3.8147e+03
*****************************************************************************

  Execution time = 3.0142e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.060902e-01 1 1  ON 0
 uu_1                 1.398230e-01 1 1  ON 1
 uu_2                 3.906310e-02 1 1  ON 2
 uu_3                -2.185563e-02 1 1  ON 3
 uu_4                -6.516672e-02 1 1  ON 4
 uu_5                -9.726089e-02 1 1  ON 5
 uu_6                -1.224067e-01 1 1  ON 6
 uu_7                -1.333964e-01 1 1  ON 7
 uu_8                -1.231342e-01 1 1  ON 8
 uu_9                -9.220627e-02 1 1  ON 9
 ud_0                 4.368786e-01 1 1  ON 10
 ud_1                 1.734128e-01 1 1  ON 11
 ud_2                 5.788104e-02 1 1  ON 12
 ud_3                -9.927864e-03 1 1  ON 13
 ud_4                -6.585275e-02 1 1  ON 14
 ud_5                -1.059922e-01 1 1  ON 15
 ud_6                -1.322830e-01 1 1  ON 16
 ud_7                -1.474484e-01 1 1  ON 17
 ud_8                -1.476605e-01 1 1  ON 18
 ud_9                -1.345728e-01 1 1  ON 19
 eO_0                -7.440463e-01 1 1  ON 20
 eO_1                -4.286317e-01 1 1  ON 21
 eO_2                -1.738507e-02 1 1  ON 22
 eO_3                 2.931508e-01 1 1  ON 23
 eO_4                 5.091698e-01 1 1  ON 24
 eO_5                 4.647235e-01 1 1  ON 25
 eO_6                 2.374422e-01 1 1  ON 26
 eO_7                -5.391017e-02 1 1  ON 27
 eO_8                -2.007945e-01 1 1  ON 28
 eO_9                -6.206153e-02 1 1  ON 29
eH1_0                -2.289360e-01 1 1  ON 30
eH1_1                -1.325121e-01 1 1  ON 31
eH1_2                -8.819410e-02 1 1  ON 32
eH1_3                -3.560438e-02 1 1  ON 33
eH1_4                 1.163811e-02 1 1  ON 34
eH1_5                 4.489489e-02 1 1  ON 35
eH1_6                 9.802799e-02 1 1  ON 36
eH1_7                 1.424687e-01 1 1  ON 37
eH1_8                 1.529171e-01 1 1  ON 38
eH1_9                 3.929546e-02 1 1  ON 39
eH2_0                -2.270585e-01 1 1  ON 40
eH2_1                -1.310688e-01 1 1  ON 41
eH2_2                -8.681721e-02 1 1  ON 42
eH2_3                -3.446513e-02 1 1  ON 43
eH2_4                 1.364786e-02 1 1  ON 44
eH2_5                 4.764714e-02 1 1  ON 45
eH2_6                 1.021645e-01 1 1  ON 46
eH2_7                 1.499574e-01 1 1  ON 47
eH2_8                 1.615394e-01 1 1  ON 48
eH2_9                 2.213783e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6942e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.8777
    reference variance = 0.491977
====================================================
  Execution time = 2.0761e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3220e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6078e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332247723264
                                         uncertainty =       0.002956455698

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332247723264
                                         uncertainty =       0.002956455698

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407555751
  error estimate for blocks of size 2^( 2) =       0.000420556848
  error estimate for blocks of size 2^( 3) =       0.000434454336
  error estimate for blocks of size 2^( 4) =       0.000447714594
  error estimate for blocks of size 2^( 5) =       0.000461508708
  error estimate for blocks of size 2^( 6) =       0.000473606910
  error estimate for blocks of size 2^( 7) =       0.000481090873

      target function =                  N/A
              le_mean =     -16.905277995948
             les_mean =     286.120627334237
             stat err =       0.000465980271
             autocorr =       1.307257096673
              std dev =       0.576370870245
             le_variance =       0.332203380067


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690527799595e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905277995948       residual = 5.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905277998564       residual = 5.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905277988916       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905277997089       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905278002492       residual = 3.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905278000515       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905278000899       residual = 3.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905278001229       residual = 5.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+01 is 3.550081e-06

solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905277995948       residual = 5.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905277996603       residual = 5.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905277994187       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905277996234       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905277997584       residual = 3.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905277997090       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905277997186       residual = 3.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905277997269       residual = 5.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+02 is 8.878028e-07

solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905277995948       residual = 5.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905277996111       residual = 5.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905277995507       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905277996019       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905277996349       residual = 3.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905277996233       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905277996257       residual = 3.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905277996278       residual = 5.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+03 is 2.219684e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.087906 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6376e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.060904e-01 1 1  ON 0
 uu_1                 1.398233e-01 1 1  ON 1
 uu_2                 3.906356e-02 1 1  ON 2
 uu_3                -2.185562e-02 1 1  ON 3
 uu_4                -6.516671e-02 1 1  ON 4
 uu_5                -9.726122e-02 1 1  ON 5
 uu_6                -1.224069e-01 1 1  ON 6
 uu_7                -1.333965e-01 1 1  ON 7
 uu_8                -1.231349e-01 1 1  ON 8
 uu_9                -9.220661e-02 1 1  ON 9
 ud_0                 4.368792e-01 1 1  ON 10
 ud_1                 1.734129e-01 1 1  ON 11
 ud_2                 5.788113e-02 1 1  ON 12
 ud_3                -9.927942e-03 1 1  ON 13
 ud_4                -6.585290e-02 1 1  ON 14
 ud_5                -1.059922e-01 1 1  ON 15
 ud_6                -1.322830e-01 1 1  ON 16
 ud_7                -1.474481e-01 1 1  ON 17
 ud_8                -1.476608e-01 1 1  ON 18
 ud_9                -1.345733e-01 1 1  ON 19
 eO_0                -7.440469e-01 1 1  ON 20
 eO_1                -4.286324e-01 1 1  ON 21
 eO_2                -1.738528e-02 1 1  ON 22
 eO_3                 2.931511e-01 1 1  ON 23
 eO_4                 5.091707e-01 1 1  ON 24
 eO_5                 4.647241e-01 1 1  ON 25
 eO_6                 2.374425e-01 1 1  ON 26
 eO_7                -5.390990e-02 1 1  ON 27
 eO_8                -2.007949e-01 1 1  ON 28
 eO_9                -6.206191e-02 1 1  ON 29
eH1_0                -2.289364e-01 1 1  ON 30
eH1_1                -1.325123e-01 1 1  ON 31
eH1_2                -8.819425e-02 1 1  ON 32
eH1_3                -3.560444e-02 1 1  ON 33
eH1_4                 1.163787e-02 1 1  ON 34
eH1_5                 4.489477e-02 1 1  ON 35
eH1_6                 9.802825e-02 1 1  ON 36
eH1_7                 1.424688e-01 1 1  ON 37
eH1_8                 1.529175e-01 1 1  ON 38
eH1_9                 3.929580e-02 1 1  ON 39
eH2_0                -2.270592e-01 1 1  ON 40
eH2_1                -1.310691e-01 1 1  ON 41
eH2_2                -8.681762e-02 1 1  ON 42
eH2_3                -3.446466e-02 1 1  ON 43
eH2_4                 1.364783e-02 1 1  ON 44
eH2_5                 4.764700e-02 1 1  ON 45
eH2_6                 1.021647e-01 1 1  ON 46
eH2_7                 1.499574e-01 1 1  ON 47
eH2_8                 1.615398e-01 1 1  ON 48
eH2_9                 2.213845e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.9581
    reference variance = 0.238888
====================================================
  Execution time = 2.0687e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2955e-01
  Total weights = 2.0000e+06
  Execution time = 1.9163e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329540712297
                                         uncertainty =       0.003142226445

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329540712297
                                         uncertainty =       0.003142226445

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405922157
  error estimate for blocks of size 2^( 2) =       0.000418665721
  error estimate for blocks of size 2^( 3) =       0.000432044281
  error estimate for blocks of size 2^( 4) =       0.000444703963
  error estimate for blocks of size 2^( 5) =       0.000455939652
  error estimate for blocks of size 2^( 6) =       0.000466681851
  error estimate for blocks of size 2^( 7) =       0.000474139885

      target function =                  N/A
              le_mean =     -16.904802491755
             les_mean =     286.101892715788
             stat err =       0.000460366338
             autocorr =       1.286238796737
              std dev =       0.574060619899
             le_variance =       0.329545595318

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329542417512
                                         uncertainty =       0.003142236120

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329542417512
                                         uncertainty =       0.003142236120

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405923208
  error estimate for blocks of size 2^( 2) =       0.000418666692
  error estimate for blocks of size 2^( 3) =       0.000432045188
  error estimate for blocks of size 2^( 4) =       0.000444704799
  error estimate for blocks of size 2^( 5) =       0.000455940445
  error estimate for blocks of size 2^( 6) =       0.000466682639
  error estimate for blocks of size 2^( 7) =       0.000474140645

      target function =                  N/A
              le_mean =     -16.904802497152
             les_mean =     286.101894604219
             stat err =       0.000460367132
             autocorr =       1.286236576663
              std dev =       0.574062105752
             le_variance =       0.329547301260

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329541566926
                                         uncertainty =       0.003142231293

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329541566926
                                         uncertainty =       0.003142231293

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405922684
  error estimate for blocks of size 2^( 2) =       0.000418666207
  error estimate for blocks of size 2^( 3) =       0.000432044736
  error estimate for blocks of size 2^( 4) =       0.000444704382
  error estimate for blocks of size 2^( 5) =       0.000455940049
  error estimate for blocks of size 2^( 6) =       0.000466682246
  error estimate for blocks of size 2^( 7) =       0.000474140266

      target function =                  N/A
              le_mean =     -16.904802494449
             les_mean =     286.101893661852
             stat err =       0.000460366736
             autocorr =       1.286237684337
              std dev =       0.574061364587
             le_variance =       0.329546450312

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329540819186
                                         uncertainty =       0.003142227051

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329540819186
                                         uncertainty =       0.003142227051

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405922223
  error estimate for blocks of size 2^( 2) =       0.000418665782
  error estimate for blocks of size 2^( 3) =       0.000432044338
  error estimate for blocks of size 2^( 4) =       0.000444704016
  error estimate for blocks of size 2^( 5) =       0.000455939701
  error estimate for blocks of size 2^( 6) =       0.000466681901
  error estimate for blocks of size 2^( 7) =       0.000474139933

      target function =                  N/A
              le_mean =     -16.904802492091
             les_mean =     286.101892834089
             stat err =       0.000460366388
             autocorr =       1.286238657618
              std dev =       0.574060713038
             le_variance =       0.329545702253


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904802491755        initial
     9.5367e+01     9.5367e+02             3.5501e-06       -16.904802497152  <--
     3.8147e+02     3.8147e+03             8.8780e-07       -16.904802494449
     1.5259e+03     1.5259e+04             2.2197e-07       -16.904802492091

*****************************************************************************
Applying the update for shift_i =   9.5367e+01     and shift_s =   9.5367e+02
*****************************************************************************

  Execution time = 3.0375e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.060911e-01 1 1  ON 0
 uu_1                 1.398242e-01 1 1  ON 1
 uu_2                 3.906494e-02 1 1  ON 2
 uu_3                -2.185559e-02 1 1  ON 3
 uu_4                -6.516667e-02 1 1  ON 4
 uu_5                -9.726219e-02 1 1  ON 5
 uu_6                -1.224074e-01 1 1  ON 6
 uu_7                -1.333968e-01 1 1  ON 7
 uu_8                -1.231367e-01 1 1  ON 8
 uu_9                -9.220763e-02 1 1  ON 9
 ud_0                 4.368811e-01 1 1  ON 10
 ud_1                 1.734131e-01 1 1  ON 11
 ud_2                 5.788138e-02 1 1  ON 12
 ud_3                -9.928178e-03 1 1  ON 13
 ud_4                -6.585334e-02 1 1  ON 14
 ud_5                -1.059922e-01 1 1  ON 15
 ud_6                -1.322828e-01 1 1  ON 16
 ud_7                -1.474472e-01 1 1  ON 17
 ud_8                -1.476618e-01 1 1  ON 18
 ud_9                -1.345745e-01 1 1  ON 19
 eO_0                -7.440486e-01 1 1  ON 20
 eO_1                -4.286344e-01 1 1  ON 21
 eO_2                -1.738590e-02 1 1  ON 22
 eO_3                 2.931520e-01 1 1  ON 23
 eO_4                 5.091733e-01 1 1  ON 24
 eO_5                 4.647260e-01 1 1  ON 25
 eO_6                 2.374432e-01 1 1  ON 26
 eO_7                -5.390909e-02 1 1  ON 27
 eO_8                -2.007962e-01 1 1  ON 28
 eO_9                -6.206307e-02 1 1  ON 29
eH1_0                -2.289376e-01 1 1  ON 30
eH1_1                -1.325130e-01 1 1  ON 31
eH1_2                -8.819469e-02 1 1  ON 32
eH1_3                -3.560463e-02 1 1  ON 33
eH1_4                 1.163714e-02 1 1  ON 34
eH1_5                 4.489444e-02 1 1  ON 35
eH1_6                 9.802902e-02 1 1  ON 36
eH1_7                 1.424693e-01 1 1  ON 37
eH1_8                 1.529188e-01 1 1  ON 38
eH1_9                 3.929685e-02 1 1  ON 39
eH2_0                -2.270612e-01 1 1  ON 40
eH2_1                -1.310702e-01 1 1  ON 41
eH2_2                -8.681885e-02 1 1  ON 42
eH2_3                -3.446326e-02 1 1  ON 43
eH2_4                 1.364776e-02 1 1  ON 44
eH2_5                 4.764657e-02 1 1  ON 45
eH2_6                 1.021651e-01 1 1  ON 46
eH2_7                 1.499573e-01 1 1  ON 47
eH2_8                 1.615411e-01 1 1  ON 48
eH2_9                 2.214033e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6771e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.9188
    reference variance = 0.511416
====================================================
  Execution time = 2.0750e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4125e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5016e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341261509591
                                         uncertainty =       0.006172677874

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341261509591
                                         uncertainty =       0.006172677874

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413065817
  error estimate for blocks of size 2^( 2) =       0.000426072224
  error estimate for blocks of size 2^( 3) =       0.000439097715
  error estimate for blocks of size 2^( 4) =       0.000451750553
  error estimate for blocks of size 2^( 5) =       0.000463202676
  error estimate for blocks of size 2^( 6) =       0.000470183536
  error estimate for blocks of size 2^( 7) =       0.000476692503

      target function =                  N/A
              le_mean =     -16.905837621724
             les_mean =     286.148592260163
             stat err =       0.000465457317
             autocorr =       1.269758737294
              std dev =       0.584163280838
             le_variance =       0.341246738679


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690583762172e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905837621724       residual = 5.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905837604240       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905837607948       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905837586356       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905837607154       residual = 9.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905837612713       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905837612006       residual = 2.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905837614775       residual = 5.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+01 is 1.539690e-05

solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905837621724       residual = 5.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905837617323       residual = 4.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905837618273       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905837612823       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905837618007       residual = 9.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905837619408       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905837619207       residual = 2.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905837619881       residual = 5.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+01 is 3.856581e-06

solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905837621724       residual = 5.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905837620622       residual = 4.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905837620861       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905837619495       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905837620790       residual = 9.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905837621141       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905837621089       residual = 2.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905837621257       residual = 5.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+02 is 9.646121e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.090532 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6259e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.060913e-01 1 1  ON 0
 uu_1                 1.398256e-01 1 1  ON 1
 uu_2                 3.906485e-02 1 1  ON 2
 uu_3                -2.185605e-02 1 1  ON 3
 uu_4                -6.516652e-02 1 1  ON 4
 uu_5                -9.726440e-02 1 1  ON 5
 uu_6                -1.224071e-01 1 1  ON 6
 uu_7                -1.333975e-01 1 1  ON 7
 uu_8                -1.231381e-01 1 1  ON 8
 uu_9                -9.220764e-02 1 1  ON 9
 ud_0                 4.368808e-01 1 1  ON 10
 ud_1                 1.734159e-01 1 1  ON 11
 ud_2                 5.788132e-02 1 1  ON 12
 ud_3                -9.928622e-03 1 1  ON 13
 ud_4                -6.585379e-02 1 1  ON 14
 ud_5                -1.059920e-01 1 1  ON 15
 ud_6                -1.322838e-01 1 1  ON 16
 ud_7                -1.474486e-01 1 1  ON 17
 ud_8                -1.476620e-01 1 1  ON 18
 ud_9                -1.345747e-01 1 1  ON 19
 eO_0                -7.440524e-01 1 1  ON 20
 eO_1                -4.286377e-01 1 1  ON 21
 eO_2                -1.738567e-02 1 1  ON 22
 eO_3                 2.931535e-01 1 1  ON 23
 eO_4                 5.091766e-01 1 1  ON 24
 eO_5                 4.647291e-01 1 1  ON 25
 eO_6                 2.374449e-01 1 1  ON 26
 eO_7                -5.390881e-02 1 1  ON 27
 eO_8                -2.007976e-01 1 1  ON 28
 eO_9                -6.206437e-02 1 1  ON 29
eH1_0                -2.289398e-01 1 1  ON 30
eH1_1                -1.325136e-01 1 1  ON 31
eH1_2                -8.819624e-02 1 1  ON 32
eH1_3                -3.560532e-02 1 1  ON 33
eH1_4                 1.163718e-02 1 1  ON 34
eH1_5                 4.489388e-02 1 1  ON 35
eH1_6                 9.802931e-02 1 1  ON 36
eH1_7                 1.424710e-01 1 1  ON 37
eH1_8                 1.529205e-01 1 1  ON 38
eH1_9                 3.929851e-02 1 1  ON 39
eH2_0                -2.270634e-01 1 1  ON 40
eH2_1                -1.310712e-01 1 1  ON 41
eH2_2                -8.681942e-02 1 1  ON 42
eH2_3                -3.446310e-02 1 1  ON 43
eH2_4                 1.364707e-02 1 1  ON 44
eH2_5                 4.764595e-02 1 1  ON 45
eH2_6                 1.021651e-01 1 1  ON 46
eH2_7                 1.499571e-01 1 1  ON 47
eH2_8                 1.615434e-01 1 1  ON 48
eH2_9                 2.214293e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.9299
    reference variance = 0.248893
====================================================
  Execution time = 2.0584e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3892e-01
  Total weights = 2.0000e+06
  Execution time = 1.9258e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338886410035
                                         uncertainty =       0.004891553333

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338886410035
                                         uncertainty =       0.004891553333

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411654005
  error estimate for blocks of size 2^( 2) =       0.000424235709
  error estimate for blocks of size 2^( 3) =       0.000437140361
  error estimate for blocks of size 2^( 4) =       0.000448475025
  error estimate for blocks of size 2^( 5) =       0.000458450032
  error estimate for blocks of size 2^( 6) =       0.000465815319
  error estimate for blocks of size 2^( 7) =       0.000471335953

      target function =                  N/A
              le_mean =     -16.905546370846
             les_mean =     286.136415966852
             stat err =       0.000461019082
             autocorr =       1.254218244749
              std dev =       0.582166676720
             le_variance =       0.338918039484

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338884632245
                                         uncertainty =       0.004891586405

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338884632245
                                         uncertainty =       0.004891586405

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411652925
  error estimate for blocks of size 2^( 2) =       0.000424234634
  error estimate for blocks of size 2^( 3) =       0.000437139157
  error estimate for blocks of size 2^( 4) =       0.000448473731
  error estimate for blocks of size 2^( 5) =       0.000458448806
  error estimate for blocks of size 2^( 6) =       0.000465813932
  error estimate for blocks of size 2^( 7) =       0.000471334514

      target function =                  N/A
              le_mean =     -16.905546284883
             les_mean =     286.136411281708
             stat err =       0.000461017746
             autocorr =       1.254217554774
              std dev =       0.582165149127
             le_variance =       0.338916260858

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338885468699
                                         uncertainty =       0.004891568642

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338885468699
                                         uncertainty =       0.004891568642

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411653433
  error estimate for blocks of size 2^( 2) =       0.000424235140
  error estimate for blocks of size 2^( 3) =       0.000437139728
  error estimate for blocks of size 2^( 4) =       0.000448474348
  error estimate for blocks of size 2^( 5) =       0.000458449390
  error estimate for blocks of size 2^( 6) =       0.000465814596
  error estimate for blocks of size 2^( 7) =       0.000471335204

      target function =                  N/A
              le_mean =     -16.905546326993
             les_mean =     286.136413542379
             stat err =       0.000461018385
             autocorr =       1.254217933056
              std dev =       0.582165867880
             le_variance =       0.338917097724

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338886290617
                                         uncertainty =       0.004891555207

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338886290617
                                         uncertainty =       0.004891555207

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411653932
  error estimate for blocks of size 2^( 2) =       0.000424235637
  error estimate for blocks of size 2^( 3) =       0.000437140281
  error estimate for blocks of size 2^( 4) =       0.000448474940
  error estimate for blocks of size 2^( 5) =       0.000458449951
  error estimate for blocks of size 2^( 6) =       0.000465815228
  error estimate for blocks of size 2^( 7) =       0.000471335858

      target function =                  N/A
              le_mean =     -16.905546365329
             les_mean =     286.136415660858
             stat err =       0.000461018994
             autocorr =       1.254218206880
              std dev =       0.582166574112
             le_variance =       0.338917920013


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905546370846        initial  <--
     2.3842e+01     2.3842e+02             1.5397e-05       -16.905546284883
     9.5367e+01     9.5367e+02             3.8566e-06       -16.905546326993
     3.8147e+02     3.8147e+03             9.6461e-07       -16.905546365329

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 32.8334
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.060911e-01 1 1  ON 0
 uu_1                 1.398242e-01 1 1  ON 1
 uu_2                 3.906494e-02 1 1  ON 2
 uu_3                -2.185559e-02 1 1  ON 3
 uu_4                -6.516667e-02 1 1  ON 4
 uu_5                -9.726219e-02 1 1  ON 5
 uu_6                -1.224074e-01 1 1  ON 6
 uu_7                -1.333968e-01 1 1  ON 7
 uu_8                -1.231367e-01 1 1  ON 8
 uu_9                -9.220763e-02 1 1  ON 9
 ud_0                 4.368811e-01 1 1  ON 10
 ud_1                 1.734131e-01 1 1  ON 11
 ud_2                 5.788138e-02 1 1  ON 12
 ud_3                -9.928178e-03 1 1  ON 13
 ud_4                -6.585334e-02 1 1  ON 14
 ud_5                -1.059922e-01 1 1  ON 15
 ud_6                -1.322828e-01 1 1  ON 16
 ud_7                -1.474472e-01 1 1  ON 17
 ud_8                -1.476618e-01 1 1  ON 18
 ud_9                -1.345745e-01 1 1  ON 19
 eO_0                -7.440486e-01 1 1  ON 20
 eO_1                -4.286344e-01 1 1  ON 21
 eO_2                -1.738590e-02 1 1  ON 22
 eO_3                 2.931520e-01 1 1  ON 23
 eO_4                 5.091733e-01 1 1  ON 24
 eO_5                 4.647260e-01 1 1  ON 25
 eO_6                 2.374432e-01 1 1  ON 26
 eO_7                -5.390909e-02 1 1  ON 27
 eO_8                -2.007962e-01 1 1  ON 28
 eO_9                -6.206307e-02 1 1  ON 29
eH1_0                -2.289376e-01 1 1  ON 30
eH1_1                -1.325130e-01 1 1  ON 31
eH1_2                -8.819469e-02 1 1  ON 32
eH1_3                -3.560463e-02 1 1  ON 33
eH1_4                 1.163714e-02 1 1  ON 34
eH1_5                 4.489444e-02 1 1  ON 35
eH1_6                 9.802902e-02 1 1  ON 36
eH1_7                 1.424693e-01 1 1  ON 37
eH1_8                 1.529188e-01 1 1  ON 38
eH1_9                 3.929685e-02 1 1  ON 39
eH2_0                -2.270612e-01 1 1  ON 40
eH2_1                -1.310702e-01 1 1  ON 41
eH2_2                -8.681885e-02 1 1  ON 42
eH2_3                -3.446326e-02 1 1  ON 43
eH2_4                 1.364776e-02 1 1  ON 44
eH2_5                 4.764657e-02 1 1  ON 45
eH2_6                 1.021651e-01 1 1  ON 46
eH2_7                 1.499573e-01 1 1  ON 47
eH2_8                 1.615411e-01 1 1  ON 48
eH2_9                 2.214033e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9097e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.9655
    reference variance = 0.283765
====================================================
  Execution time = 2.1065e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3329e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5399e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332787257861
                                         uncertainty =       0.002895173796

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332787257861
                                         uncertainty =       0.002895173796

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408219024
  error estimate for blocks of size 2^( 2) =       0.000421404148
  error estimate for blocks of size 2^( 3) =       0.000434607124
  error estimate for blocks of size 2^( 4) =       0.000446508768
  error estimate for blocks of size 2^( 5) =       0.000455291577
  error estimate for blocks of size 2^( 6) =       0.000462159352
  error estimate for blocks of size 2^( 7) =       0.000464969811

      target function =                  N/A
              le_mean =     -16.906278855472
             les_mean =     286.155550115398
             stat err =       0.000457232377
             autocorr =       1.254548543848
              std dev =       0.577308880107
             le_variance =       0.333285543050


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690627885547e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+02, overlap shift 2.3842e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906278855472       residual = 1.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906278857860       residual = 4.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906278862941       residual = 6.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906278862777       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906278867125       residual = 8.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906278865399       residual = 2.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906278865012       residual = 4.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906278866341       residual = 8.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+02 is 1.253868e-06

solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906278855472       residual = 1.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906278856069       residual = 4.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906278857341       residual = 6.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906278857300       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906278858387       residual = 8.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906278857956       residual = 2.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906278857858       residual = 4.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906278858190       residual = 8.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+02 is 3.135230e-07

solving harmonic davidson linear method for identity shift 3.8147e+03, overlap shift 3.8147e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906278855472       residual = 1.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906278855622       residual = 4.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906278855940       residual = 6.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906278855930       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906278856202       residual = 8.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906278856093       residual = 2.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906278856070       residual = 4.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906278856150       residual = 8.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+03 is 7.838423e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.093178 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6615e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.060911e-01 1 1  ON 0
 uu_1                 1.398243e-01 1 1  ON 1
 uu_2                 3.906509e-02 1 1  ON 2
 uu_3                -2.185554e-02 1 1  ON 3
 uu_4                -6.516660e-02 1 1  ON 4
 uu_5                -9.726214e-02 1 1  ON 5
 uu_6                -1.224074e-01 1 1  ON 6
 uu_7                -1.333969e-01 1 1  ON 7
 uu_8                -1.231370e-01 1 1  ON 8
 uu_9                -9.220782e-02 1 1  ON 9
 ud_0                 4.368814e-01 1 1  ON 10
 ud_1                 1.734134e-01 1 1  ON 11
 ud_2                 5.788149e-02 1 1  ON 12
 ud_3                -9.928139e-03 1 1  ON 13
 ud_4                -6.585336e-02 1 1  ON 14
 ud_5                -1.059923e-01 1 1  ON 15
 ud_6                -1.322828e-01 1 1  ON 16
 ud_7                -1.474472e-01 1 1  ON 17
 ud_8                -1.476620e-01 1 1  ON 18
 ud_9                -1.345748e-01 1 1  ON 19
 eO_0                -7.440489e-01 1 1  ON 20
 eO_1                -4.286347e-01 1 1  ON 21
 eO_2                -1.738578e-02 1 1  ON 22
 eO_3                 2.931521e-01 1 1  ON 23
 eO_4                 5.091736e-01 1 1  ON 24
 eO_5                 4.647263e-01 1 1  ON 25
 eO_6                 2.374434e-01 1 1  ON 26
 eO_7                -5.390902e-02 1 1  ON 27
 eO_8                -2.007964e-01 1 1  ON 28
 eO_9                -6.206327e-02 1 1  ON 29
eH1_0                -2.289379e-01 1 1  ON 30
eH1_1                -1.325131e-01 1 1  ON 31
eH1_2                -8.819471e-02 1 1  ON 32
eH1_3                -3.560462e-02 1 1  ON 33
eH1_4                 1.163719e-02 1 1  ON 34
eH1_5                 4.489441e-02 1 1  ON 35
eH1_6                 9.802900e-02 1 1  ON 36
eH1_7                 1.424694e-01 1 1  ON 37
eH1_8                 1.529190e-01 1 1  ON 38
eH1_9                 3.929700e-02 1 1  ON 39
eH2_0                -2.270615e-01 1 1  ON 40
eH2_1                -1.310705e-01 1 1  ON 41
eH2_2                -8.681886e-02 1 1  ON 42
eH2_3                -3.446316e-02 1 1  ON 43
eH2_4                 1.364778e-02 1 1  ON 44
eH2_5                 4.764661e-02 1 1  ON 45
eH2_6                 1.021652e-01 1 1  ON 46
eH2_7                 1.499574e-01 1 1  ON 47
eH2_8                 1.615412e-01 1 1  ON 48
eH2_9                 2.214047e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.958
    reference variance = 0.156788
====================================================
  Execution time = 2.0474e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3972e-01
  Total weights = 2.0000e+06
  Execution time = 1.9294e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339819225072
                                         uncertainty =       0.006328308213

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339819225072
                                         uncertainty =       0.006328308213

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412138289
  error estimate for blocks of size 2^( 2) =       0.000425141196
  error estimate for blocks of size 2^( 3) =       0.000438414276
  error estimate for blocks of size 2^( 4) =       0.000451382840
  error estimate for blocks of size 2^( 5) =       0.000462201329
  error estimate for blocks of size 2^( 6) =       0.000471643110
  error estimate for blocks of size 2^( 7) =       0.000478410521

      target function =                  N/A
              le_mean =     -16.905914214983
             les_mean =     286.149651213839
             stat err =       0.000465909450
             autocorr =       1.277959556644
              std dev =       0.582851558578
             le_variance =       0.339715939336

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339819366313
                                         uncertainty =       0.006328316120

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339819366313
                                         uncertainty =       0.006328316120

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412138375
  error estimate for blocks of size 2^( 2) =       0.000425141269
  error estimate for blocks of size 2^( 3) =       0.000438414333
  error estimate for blocks of size 2^( 4) =       0.000451382884
  error estimate for blocks of size 2^( 5) =       0.000462201365
  error estimate for blocks of size 2^( 6) =       0.000471643148
  error estimate for blocks of size 2^( 7) =       0.000478410558

      target function =                  N/A
              le_mean =     -16.905914216000
             les_mean =     286.149651389539
             stat err =       0.000465909489
             autocorr =       1.277959238793
              std dev =       0.582851679805
             le_variance =       0.339716080651

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339819295488
                                         uncertainty =       0.006328312174

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339819295488
                                         uncertainty =       0.006328312174

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412138332
  error estimate for blocks of size 2^( 2) =       0.000425141233
  error estimate for blocks of size 2^( 3) =       0.000438414304
  error estimate for blocks of size 2^( 4) =       0.000451382862
  error estimate for blocks of size 2^( 5) =       0.000462201347
  error estimate for blocks of size 2^( 6) =       0.000471643129
  error estimate for blocks of size 2^( 7) =       0.000478410540

      target function =                  N/A
              le_mean =     -16.905914215491
             les_mean =     286.149651301471
             stat err =       0.000465909469
             autocorr =       1.277959397882
              std dev =       0.582851619016
             le_variance =       0.339716009790

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339819233867
                                         uncertainty =       0.006328308708

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339819233867
                                         uncertainty =       0.006328308708

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412138295
  error estimate for blocks of size 2^( 2) =       0.000425141201
  error estimate for blocks of size 2^( 3) =       0.000438414280
  error estimate for blocks of size 2^( 4) =       0.000451382843
  error estimate for blocks of size 2^( 5) =       0.000462201331
  error estimate for blocks of size 2^( 6) =       0.000471643113
  error estimate for blocks of size 2^( 7) =       0.000478410523

      target function =                  N/A
              le_mean =     -16.905914215046
             les_mean =     286.149651224784
             stat err =       0.000465909452
             autocorr =       1.277959536796
              std dev =       0.582851566127
             le_variance =       0.339715948136


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905914214983        initial
     2.3842e+02     2.3842e+03             1.2539e-06       -16.905914216000  <--
     9.5367e+02     9.5367e+03             3.1352e-07       -16.905914215491
     3.8147e+03     3.8147e+04             7.8384e-08       -16.905914215046

*****************************************************************************
Applying the update for shift_i =   2.3842e+02     and shift_s =   2.3842e+03
*****************************************************************************

  Execution time = 3.0215e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.060912e-01 1 1  ON 0
 uu_1                 1.398245e-01 1 1  ON 1
 uu_2                 3.906555e-02 1 1  ON 2
 uu_3                -2.185541e-02 1 1  ON 3
 uu_4                -6.516639e-02 1 1  ON 4
 uu_5                -9.726199e-02 1 1  ON 5
 uu_6                -1.224075e-01 1 1  ON 6
 uu_7                -1.333972e-01 1 1  ON 7
 uu_8                -1.231377e-01 1 1  ON 8
 uu_9                -9.220839e-02 1 1  ON 9
 ud_0                 4.368822e-01 1 1  ON 10
 ud_1                 1.734142e-01 1 1  ON 11
 ud_2                 5.788182e-02 1 1  ON 12
 ud_3                -9.928023e-03 1 1  ON 13
 ud_4                -6.585344e-02 1 1  ON 14
 ud_5                -1.059926e-01 1 1  ON 15
 ud_6                -1.322829e-01 1 1  ON 16
 ud_7                -1.474472e-01 1 1  ON 17
 ud_8                -1.476624e-01 1 1  ON 18
 ud_9                -1.345755e-01 1 1  ON 19
 eO_0                -7.440498e-01 1 1  ON 20
 eO_1                -4.286354e-01 1 1  ON 21
 eO_2                -1.738539e-02 1 1  ON 22
 eO_3                 2.931523e-01 1 1  ON 23
 eO_4                 5.091745e-01 1 1  ON 24
 eO_5                 4.647271e-01 1 1  ON 25
 eO_6                 2.374439e-01 1 1  ON 26
 eO_7                -5.390882e-02 1 1  ON 27
 eO_8                -2.007971e-01 1 1  ON 28
 eO_9                -6.206386e-02 1 1  ON 29
eH1_0                -2.289387e-01 1 1  ON 30
eH1_1                -1.325135e-01 1 1  ON 31
eH1_2                -8.819476e-02 1 1  ON 32
eH1_3                -3.560460e-02 1 1  ON 33
eH1_4                 1.163731e-02 1 1  ON 34
eH1_5                 4.489433e-02 1 1  ON 35
eH1_6                 9.802894e-02 1 1  ON 36
eH1_7                 1.424697e-01 1 1  ON 37
eH1_8                 1.529195e-01 1 1  ON 38
eH1_9                 3.929747e-02 1 1  ON 39
eH2_0                -2.270623e-01 1 1  ON 40
eH2_1                -1.310713e-01 1 1  ON 41
eH2_2                -8.681891e-02 1 1  ON 42
eH2_3                -3.446286e-02 1 1  ON 43
eH2_4                 1.364785e-02 1 1  ON 44
eH2_5                 4.764675e-02 1 1  ON 45
eH2_6                 1.021654e-01 1 1  ON 46
eH2_7                 1.499576e-01 1 1  ON 47
eH2_8                 1.615416e-01 1 1  ON 48
eH2_9                 2.214091e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6834e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6912e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.8677
    reference variance = 0.307855
====================================================
  Execution time = 2.0906e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3368e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5286e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333666369527
                                         uncertainty =       0.002754968494

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333666369527
                                         uncertainty =       0.002754968494

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408462894
  error estimate for blocks of size 2^( 2) =       0.000421168107
  error estimate for blocks of size 2^( 3) =       0.000434700960
  error estimate for blocks of size 2^( 4) =       0.000447199127
  error estimate for blocks of size 2^( 5) =       0.000458667137
  error estimate for blocks of size 2^( 6) =       0.000466755503
  error estimate for blocks of size 2^( 7) =       0.000471229941

      target function =                  N/A
              le_mean =     -16.905057724837
             les_mean =     286.114660384806
             stat err =       0.000460962927
             autocorr =       1.273581602019
              std dev =       0.577653764447
             le_variance =       0.333683871580


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690505772484e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+01, overlap shift 5.9605e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905057724837       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905057723041       residual = 6.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905057727462       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905057734204       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905057736019       residual = 9.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905057729985       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905057734489       residual = 2.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905057734169       residual = 3.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+01 is 6.425791e-06

solving harmonic davidson linear method for identity shift 2.3842e+02, overlap shift 2.3842e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905057724837       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905057724387       residual = 6.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905057725491       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905057727163       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905057727622       residual = 9.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905057726108       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905057727234       residual = 2.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905057727159       residual = 3.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+02 is 1.607069e-06

solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905057724837       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905057724724       residual = 6.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905057725000       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905057725417       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905057725532       residual = 9.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905057725154       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905057725433       residual = 2.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905057725415       residual = 3.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+02 is 4.018061e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.095832 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6441e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.060914e-01 1 1  ON 0
 uu_1                 1.398252e-01 1 1  ON 1
 uu_2                 3.906547e-02 1 1  ON 2
 uu_3                -2.185542e-02 1 1  ON 3
 uu_4                -6.516629e-02 1 1  ON 4
 uu_5                -9.726216e-02 1 1  ON 5
 uu_6                -1.224071e-01 1 1  ON 6
 uu_7                -1.333976e-01 1 1  ON 7
 uu_8                -1.231386e-01 1 1  ON 8
 uu_9                -9.220896e-02 1 1  ON 9
 ud_0                 4.368827e-01 1 1  ON 10
 ud_1                 1.734151e-01 1 1  ON 11
 ud_2                 5.788214e-02 1 1  ON 12
 ud_3                -9.927789e-03 1 1  ON 13
 ud_4                -6.585342e-02 1 1  ON 14
 ud_5                -1.059932e-01 1 1  ON 15
 ud_6                -1.322830e-01 1 1  ON 16
 ud_7                -1.474471e-01 1 1  ON 17
 ud_8                -1.476630e-01 1 1  ON 18
 ud_9                -1.345761e-01 1 1  ON 19
 eO_0                -7.440511e-01 1 1  ON 20
 eO_1                -4.286367e-01 1 1  ON 21
 eO_2                -1.738552e-02 1 1  ON 22
 eO_3                 2.931528e-01 1 1  ON 23
 eO_4                 5.091757e-01 1 1  ON 24
 eO_5                 4.647287e-01 1 1  ON 25
 eO_6                 2.374448e-01 1 1  ON 26
 eO_7                -5.390869e-02 1 1  ON 27
 eO_8                -2.007979e-01 1 1  ON 28
 eO_9                -6.206452e-02 1 1  ON 29
eH1_0                -2.289399e-01 1 1  ON 30
eH1_1                -1.325138e-01 1 1  ON 31
eH1_2                -8.819560e-02 1 1  ON 32
eH1_3                -3.560457e-02 1 1  ON 33
eH1_4                 1.163772e-02 1 1  ON 34
eH1_5                 4.489423e-02 1 1  ON 35
eH1_6                 9.802915e-02 1 1  ON 36
eH1_7                 1.424703e-01 1 1  ON 37
eH1_8                 1.529202e-01 1 1  ON 38
eH1_9                 3.929800e-02 1 1  ON 39
eH2_0                -2.270634e-01 1 1  ON 40
eH2_1                -1.310716e-01 1 1  ON 41
eH2_2                -8.681903e-02 1 1  ON 42
eH2_3                -3.446284e-02 1 1  ON 43
eH2_4                 1.364766e-02 1 1  ON 44
eH2_5                 4.764667e-02 1 1  ON 45
eH2_6                 1.021655e-01 1 1  ON 46
eH2_7                 1.499575e-01 1 1  ON 47
eH2_8                 1.615423e-01 1 1  ON 48
eH2_9                 2.214187e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.9063
    reference variance = 0.337236
====================================================
  Execution time = 2.0586e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.2926e-01
  Total weights = 2.0000e+06
  Execution time = 1.9329e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329068685646
                                         uncertainty =       0.002490685563

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329068685646
                                         uncertainty =       0.002490685563

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405748768
  error estimate for blocks of size 2^( 2) =       0.000418497135
  error estimate for blocks of size 2^( 3) =       0.000431409973
  error estimate for blocks of size 2^( 4) =       0.000444192600
  error estimate for blocks of size 2^( 5) =       0.000453965230
  error estimate for blocks of size 2^( 6) =       0.000462371744
  error estimate for blocks of size 2^( 7) =       0.000465935857

      target function =                  N/A
              le_mean =     -16.905914400016
             les_mean =     286.139205661927
             stat err =       0.000456616358
             autocorr =       1.266451348289
              std dev =       0.573815410995
             le_variance =       0.329264125895

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329069364828
                                         uncertainty =       0.002490682630

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329069364828
                                         uncertainty =       0.002490682630

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405749187
  error estimate for blocks of size 2^( 2) =       0.000418497513
  error estimate for blocks of size 2^( 3) =       0.000431410278
  error estimate for blocks of size 2^( 4) =       0.000444192838
  error estimate for blocks of size 2^( 5) =       0.000453965439
  error estimate for blocks of size 2^( 6) =       0.000462371895
  error estimate for blocks of size 2^( 7) =       0.000465936004

      target function =                  N/A
              le_mean =     -16.905914403716
             les_mean =     286.139206466841
             stat err =       0.000456616544
             autocorr =       1.266449766998
              std dev =       0.573816003349
             le_variance =       0.329264805699

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329069023386
                                         uncertainty =       0.002490684069

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329069023386
                                         uncertainty =       0.002490684069

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405748977
  error estimate for blocks of size 2^( 2) =       0.000418497323
  error estimate for blocks of size 2^( 3) =       0.000431410125
  error estimate for blocks of size 2^( 4) =       0.000444192718
  error estimate for blocks of size 2^( 5) =       0.000453965334
  error estimate for blocks of size 2^( 6) =       0.000462371818
  error estimate for blocks of size 2^( 7) =       0.000465935929

      target function =                  N/A
              le_mean =     -16.905914401854
             les_mean =     286.139206062114
             stat err =       0.000456616450
             autocorr =       1.266450558214
              std dev =       0.573815705561
             le_variance =       0.329264463948

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329068727800
                                         uncertainty =       0.002490685375

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329068727800
                                         uncertainty =       0.002490685375

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405748794
  error estimate for blocks of size 2^( 2) =       0.000418497158
  error estimate for blocks of size 2^( 3) =       0.000431409992
  error estimate for blocks of size 2^( 4) =       0.000444192614
  error estimate for blocks of size 2^( 5) =       0.000453965243
  error estimate for blocks of size 2^( 6) =       0.000462371753
  error estimate for blocks of size 2^( 7) =       0.000465935866

      target function =                  N/A
              le_mean =     -16.905914400244
             les_mean =     286.139205711850
             stat err =       0.000456616369
             autocorr =       1.266451249549
              std dev =       0.573815447760
             le_variance =       0.329264168088


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905914400016        initial
     5.9605e+01     5.9605e+02             6.4258e-06       -16.905914403716  <--
     2.3842e+02     2.3842e+03             1.6071e-06       -16.905914401854
     9.5367e+02     9.5367e+03             4.0181e-07       -16.905914400244

*****************************************************************************
Applying the update for shift_i =   5.9605e+01     and shift_s =   5.9605e+02
*****************************************************************************

  Execution time = 3.0338e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.060918e-01 1 1  ON 0
 uu_1                 1.398269e-01 1 1  ON 1
 uu_2                 3.906523e-02 1 1  ON 2
 uu_3                -2.185545e-02 1 1  ON 3
 uu_4                -6.516599e-02 1 1  ON 4
 uu_5                -9.726268e-02 1 1  ON 5
 uu_6                -1.224057e-01 1 1  ON 6
 uu_7                -1.333989e-01 1 1  ON 7
 uu_8                -1.231414e-01 1 1  ON 8
 uu_9                -9.221067e-02 1 1  ON 9
 ud_0                 4.368843e-01 1 1  ON 10
 ud_1                 1.734178e-01 1 1  ON 11
 ud_2                 5.788308e-02 1 1  ON 12
 ud_3                -9.927091e-03 1 1  ON 13
 ud_4                -6.585338e-02 1 1  ON 14
 ud_5                -1.059949e-01 1 1  ON 15
 ud_6                -1.322832e-01 1 1  ON 16
 ud_7                -1.474468e-01 1 1  ON 17
 ud_8                -1.476647e-01 1 1  ON 18
 ud_9                -1.345779e-01 1 1  ON 19
 eO_0                -7.440550e-01 1 1  ON 20
 eO_1                -4.286407e-01 1 1  ON 21
 eO_2                -1.738590e-02 1 1  ON 22
 eO_3                 2.931541e-01 1 1  ON 23
 eO_4                 5.091793e-01 1 1  ON 24
 eO_5                 4.647336e-01 1 1  ON 25
 eO_6                 2.374476e-01 1 1  ON 26
 eO_7                -5.390829e-02 1 1  ON 27
 eO_8                -2.008004e-01 1 1  ON 28
 eO_9                -6.206651e-02 1 1  ON 29
eH1_0                -2.289436e-01 1 1  ON 30
eH1_1                -1.325147e-01 1 1  ON 31
eH1_2                -8.819811e-02 1 1  ON 32
eH1_3                -3.560448e-02 1 1  ON 33
eH1_4                 1.163895e-02 1 1  ON 34
eH1_5                 4.489393e-02 1 1  ON 35
eH1_6                 9.802977e-02 1 1  ON 36
eH1_7                 1.424720e-01 1 1  ON 37
eH1_8                 1.529222e-01 1 1  ON 38
eH1_9                 3.929959e-02 1 1  ON 39
eH2_0                -2.270668e-01 1 1  ON 40
eH2_1                -1.310723e-01 1 1  ON 41
eH2_2                -8.681941e-02 1 1  ON 42
eH2_3                -3.446275e-02 1 1  ON 43
eH2_4                 1.364709e-02 1 1  ON 44
eH2_5                 4.764642e-02 1 1  ON 45
eH2_6                 1.021660e-01 1 1  ON 46
eH2_7                 1.499572e-01 1 1  ON 47
eH2_8                 1.615442e-01 1 1  ON 48
eH2_9                 2.214476e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6785e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6911e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.8862
    reference variance = 0.20604
====================================================
  Execution time = 2.1038e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4200e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5504e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341866953148
                                         uncertainty =       0.007230864616

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341866953148
                                         uncertainty =       0.007230864616

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413520665
  error estimate for blocks of size 2^( 2) =       0.000425947973
  error estimate for blocks of size 2^( 3) =       0.000439301855
  error estimate for blocks of size 2^( 4) =       0.000451207610
  error estimate for blocks of size 2^( 5) =       0.000461924242
  error estimate for blocks of size 2^( 6) =       0.000469489478
  error estimate for blocks of size 2^( 7) =       0.000474158538

      target function =                  N/A
              le_mean =     -16.905499921775
             les_mean =     286.137926115251
             stat err =       0.000464194967
             autocorr =       1.260104083021
              std dev =       0.584806533071
             le_variance =       0.341998681123


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690549992177e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+01, overlap shift 1.4901e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905499921775       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905499990891       residual = 3.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905500051657       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905500133778       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905500167050       residual = 5.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905500179704       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905500162584       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905500172953       residual = 6.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+01 is 2.117967e-05

solving harmonic davidson linear method for identity shift 5.9605e+01, overlap shift 5.9605e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905499921775       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905499939118       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905499954557       residual = 4.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905499975485       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905499984128       residual = 5.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905499987133       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905499982722       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905499985304       residual = 5.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+01 is 5.363904e-06

solving harmonic davidson linear method for identity shift 2.3842e+02, overlap shift 2.3842e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905499921775       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905499926114       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905499929990       residual = 4.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905499935248       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905499937429       residual = 4.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905499938171       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905499937059       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905499937705       residual = 5.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+02 is 1.345380e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.098508 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6596e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.060914e-01 1 1  ON 0
 uu_1                 1.398300e-01 1 1  ON 1
 uu_2                 3.906640e-02 1 1  ON 2
 uu_3                -2.185454e-02 1 1  ON 3
 uu_4                -6.516462e-02 1 1  ON 4
 uu_5                -9.726420e-02 1 1  ON 5
 uu_6                -1.224067e-01 1 1  ON 6
 uu_7                -1.334012e-01 1 1  ON 7
 uu_8                -1.231451e-01 1 1  ON 8
 uu_9                -9.221255e-02 1 1  ON 9
 ud_0                 4.368896e-01 1 1  ON 10
 ud_1                 1.734194e-01 1 1  ON 11
 ud_2                 5.788400e-02 1 1  ON 12
 ud_3                -9.926199e-03 1 1  ON 13
 ud_4                -6.585566e-02 1 1  ON 14
 ud_5                -1.059962e-01 1 1  ON 15
 ud_6                -1.322837e-01 1 1  ON 16
 ud_7                -1.474471e-01 1 1  ON 17
 ud_8                -1.476661e-01 1 1  ON 18
 ud_9                -1.345804e-01 1 1  ON 19
 eO_0                -7.440586e-01 1 1  ON 20
 eO_1                -4.286454e-01 1 1  ON 21
 eO_2                -1.738746e-02 1 1  ON 22
 eO_3                 2.931580e-01 1 1  ON 23
 eO_4                 5.091840e-01 1 1  ON 24
 eO_5                 4.647374e-01 1 1  ON 25
 eO_6                 2.374496e-01 1 1  ON 26
 eO_7                -5.390688e-02 1 1  ON 27
 eO_8                -2.008036e-01 1 1  ON 28
 eO_9                -6.206903e-02 1 1  ON 29
eH1_0                -2.289473e-01 1 1  ON 30
eH1_1                -1.325168e-01 1 1  ON 31
eH1_2                -8.819927e-02 1 1  ON 32
eH1_3                -3.560365e-02 1 1  ON 33
eH1_4                 1.163919e-02 1 1  ON 34
eH1_5                 4.489239e-02 1 1  ON 35
eH1_6                 9.802928e-02 1 1  ON 36
eH1_7                 1.424755e-01 1 1  ON 37
eH1_8                 1.529246e-01 1 1  ON 38
eH1_9                 3.930179e-02 1 1  ON 39
eH2_0                -2.270709e-01 1 1  ON 40
eH2_1                -1.310753e-01 1 1  ON 41
eH2_2                -8.682076e-02 1 1  ON 42
eH2_3                -3.446182e-02 1 1  ON 43
eH2_4                 1.364624e-02 1 1  ON 44
eH2_5                 4.764748e-02 1 1  ON 45
eH2_6                 1.021670e-01 1 1  ON 46
eH2_7                 1.499581e-01 1 1  ON 47
eH2_8                 1.615463e-01 1 1  ON 48
eH2_9                 2.214809e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.9027
    reference variance = 0.337091
====================================================
  Execution time = 2.0558e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4103e-01
  Total weights = 2.0000e+06
  Execution time = 1.9220e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341090075075
                                         uncertainty =       0.003750170016

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341090075075
                                         uncertainty =       0.003750170016

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412935226
  error estimate for blocks of size 2^( 2) =       0.000425325638
  error estimate for blocks of size 2^( 3) =       0.000438425106
  error estimate for blocks of size 2^( 4) =       0.000450852668
  error estimate for blocks of size 2^( 5) =       0.000462360399
  error estimate for blocks of size 2^( 6) =       0.000470307216
  error estimate for blocks of size 2^( 7) =       0.000475823692

      target function =                  N/A
              le_mean =     -16.905458600912
             les_mean =     286.135561337979
             stat err =       0.000464835994
             autocorr =       1.267172193405
              std dev =       0.583978596640
             le_variance =       0.341031001334

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341103504594
                                         uncertainty =       0.003750271378

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341103504594
                                         uncertainty =       0.003750271378

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412943354
  error estimate for blocks of size 2^( 2) =       0.000425333217
  error estimate for blocks of size 2^( 3) =       0.000438432099
  error estimate for blocks of size 2^( 4) =       0.000450859304
  error estimate for blocks of size 2^( 5) =       0.000462366744
  error estimate for blocks of size 2^( 6) =       0.000470313280
  error estimate for blocks of size 2^( 7) =       0.000475829845

      target function =                  N/A
              le_mean =     -16.905458705877
             les_mean =     286.135578313387
             stat err =       0.000464842293
             autocorr =       1.267156652772
              std dev =       0.583990092221
             le_variance =       0.341044427813

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341096922417
                                         uncertainty =       0.003750221847

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341096922417
                                         uncertainty =       0.003750221847

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412939370
  error estimate for blocks of size 2^( 2) =       0.000425329503
  error estimate for blocks of size 2^( 3) =       0.000438428674
  error estimate for blocks of size 2^( 4) =       0.000450856055
  error estimate for blocks of size 2^( 5) =       0.000462363640
  error estimate for blocks of size 2^( 6) =       0.000470310313
  error estimate for blocks of size 2^( 7) =       0.000475826835

      target function =                  N/A
              le_mean =     -16.905458654323
             les_mean =     286.135569989645
             stat err =       0.000464839211
             autocorr =       1.267164297057
              std dev =       0.583984457955
             le_variance =       0.341037847133

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341090935126
                                         uncertainty =       0.003750176532

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341090935126
                                         uncertainty =       0.003750176532

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412935746
  error estimate for blocks of size 2^( 2) =       0.000425326123
  error estimate for blocks of size 2^( 3) =       0.000438425554
  error estimate for blocks of size 2^( 4) =       0.000450853093
  error estimate for blocks of size 2^( 5) =       0.000462360807
  error estimate for blocks of size 2^( 6) =       0.000470307605
  error estimate for blocks of size 2^( 7) =       0.000475824087

      target function =                  N/A
              le_mean =     -16.905458607604
             les_mean =     286.135562424090
             stat err =       0.000464836398
             autocorr =       1.267171202305
              std dev =       0.583979332846
             le_variance =       0.341031861191


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905458600912        initial
     1.4901e+01     1.4901e+02             2.1180e-05       -16.905458705877  <--
     5.9605e+01     5.9605e+02             5.3639e-06       -16.905458654323
     2.3842e+02     2.3842e+03             1.3454e-06       -16.905458607604

*****************************************************************************
Applying the update for shift_i =   1.4901e+01     and shift_s =   1.4901e+02
*****************************************************************************

  Execution time = 3.0261e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.060905e-01 1 1  ON 0
 uu_1                 1.398391e-01 1 1  ON 1
 uu_2                 3.906993e-02 1 1  ON 2
 uu_3                -2.185180e-02 1 1  ON 3
 uu_4                -6.516062e-02 1 1  ON 4
 uu_5                -9.726866e-02 1 1  ON 5
 uu_6                -1.224096e-01 1 1  ON 6
 uu_7                -1.334079e-01 1 1  ON 7
 uu_8                -1.231560e-01 1 1  ON 8
 uu_9                -9.221821e-02 1 1  ON 9
 ud_0                 4.369054e-01 1 1  ON 10
 ud_1                 1.734241e-01 1 1  ON 11
 ud_2                 5.788681e-02 1 1  ON 12
 ud_3                -9.923584e-03 1 1  ON 13
 ud_4                -6.586235e-02 1 1  ON 14
 ud_5                -1.060002e-01 1 1  ON 15
 ud_6                -1.322855e-01 1 1  ON 16
 ud_7                -1.474479e-01 1 1  ON 17
 ud_8                -1.476703e-01 1 1  ON 18
 ud_9                -1.345879e-01 1 1  ON 19
 eO_0                -7.440695e-01 1 1  ON 20
 eO_1                -4.286593e-01 1 1  ON 21
 eO_2                -1.739210e-02 1 1  ON 22
 eO_3                 2.931697e-01 1 1  ON 23
 eO_4                 5.091982e-01 1 1  ON 24
 eO_5                 4.647489e-01 1 1  ON 25
 eO_6                 2.374559e-01 1 1  ON 26
 eO_7                -5.390267e-02 1 1  ON 27
 eO_8                -2.008132e-01 1 1  ON 28
 eO_9                -6.207659e-02 1 1  ON 29
eH1_0                -2.289585e-01 1 1  ON 30
eH1_1                -1.325232e-01 1 1  ON 31
eH1_2                -8.820277e-02 1 1  ON 32
eH1_3                -3.560122e-02 1 1  ON 33
eH1_4                 1.163988e-02 1 1  ON 34
eH1_5                 4.488781e-02 1 1  ON 35
eH1_6                 9.802784e-02 1 1  ON 36
eH1_7                 1.424857e-01 1 1  ON 37
eH1_8                 1.529318e-01 1 1  ON 38
eH1_9                 3.930841e-02 1 1  ON 39
eH2_0                -2.270833e-01 1 1  ON 40
eH2_1                -1.310844e-01 1 1  ON 41
eH2_2                -8.682488e-02 1 1  ON 42
eH2_3                -3.445909e-02 1 1  ON 43
eH2_4                 1.364369e-02 1 1  ON 44
eH2_5                 4.765060e-02 1 1  ON 45
eH2_6                 1.021699e-01 1 1  ON 46
eH2_7                 1.499610e-01 1 1  ON 47
eH2_8                 1.615528e-01 1 1  ON 48
eH2_9                 2.215811e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6863e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.8758
    reference variance = 0.287825
====================================================
  Execution time = 2.1105e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3732e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6144e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337373009501
                                         uncertainty =       0.003595544388

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337373009501
                                         uncertainty =       0.003595544388

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410684189
  error estimate for blocks of size 2^( 2) =       0.000423288292
  error estimate for blocks of size 2^( 3) =       0.000436270860
  error estimate for blocks of size 2^( 4) =       0.000448565908
  error estimate for blocks of size 2^( 5) =       0.000458529919
  error estimate for blocks of size 2^( 6) =       0.000465722658
  error estimate for blocks of size 2^( 7) =       0.000470779364

      target function =                  N/A
              le_mean =     -16.905006799258
             les_mean =     286.116577721070
             stat err =       0.000460899462
             autocorr =       1.259494965394
              std dev =       0.580795150452
             le_variance =       0.337323006788


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690500679926e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+00, overlap shift 3.7253e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905006799258       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905006945598       residual = 4.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905006964193       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905006971775       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905007124663       residual = 4.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905007084313       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905007178551       residual = 1.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905007153812       residual = 6.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+00 is 8.594950e-05

solving harmonic davidson linear method for identity shift 1.4901e+01, overlap shift 1.4901e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905006799258       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905006836666       residual = 4.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905006841086       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905006842194       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905006877769       residual = 4.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905006869608       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905006892974       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905006886810       residual = 4.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+01 is 2.161695e-05

solving harmonic davidson linear method for identity shift 5.9605e+01, overlap shift 5.9605e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905006799258       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905006808663       residual = 4.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905006809752       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905006809975       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905006818686       residual = 4.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905006816761       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905006822594       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905006821064       residual = 4.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+01 is 5.413147e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.101247 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6726e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.060983e-01 1 1  ON 0
 uu_1                 1.398488e-01 1 1  ON 1
 uu_2                 3.907577e-02 1 1  ON 2
 uu_3                -2.184962e-02 1 1  ON 3
 uu_4                -6.516414e-02 1 1  ON 4
 uu_5                -9.727472e-02 1 1  ON 5
 uu_6                -1.224203e-01 1 1  ON 6
 uu_7                -1.334177e-01 1 1  ON 7
 uu_8                -1.231681e-01 1 1  ON 8
 uu_9                -9.222097e-02 1 1  ON 9
 ud_0                 4.369210e-01 1 1  ON 10
 ud_1                 1.734327e-01 1 1  ON 11
 ud_2                 5.788628e-02 1 1  ON 12
 ud_3                -9.919469e-03 1 1  ON 13
 ud_4                -6.587138e-02 1 1  ON 14
 ud_5                -1.060060e-01 1 1  ON 15
 ud_6                -1.322862e-01 1 1  ON 16
 ud_7                -1.474530e-01 1 1  ON 17
 ud_8                -1.476766e-01 1 1  ON 18
 ud_9                -1.345900e-01 1 1  ON 19
 eO_0                -7.440839e-01 1 1  ON 20
 eO_1                -4.286792e-01 1 1  ON 21
 eO_2                -1.740106e-02 1 1  ON 22
 eO_3                 2.931850e-01 1 1  ON 23
 eO_4                 5.092198e-01 1 1  ON 24
 eO_5                 4.647658e-01 1 1  ON 25
 eO_6                 2.374619e-01 1 1  ON 26
 eO_7                -5.390365e-02 1 1  ON 27
 eO_8                -2.008218e-01 1 1  ON 28
 eO_9                -6.208282e-02 1 1  ON 29
eH1_0                -2.289605e-01 1 1  ON 30
eH1_1                -1.325319e-01 1 1  ON 31
eH1_2                -8.821259e-02 1 1  ON 32
eH1_3                -3.559945e-02 1 1  ON 33
eH1_4                 1.163568e-02 1 1  ON 34
eH1_5                 4.488195e-02 1 1  ON 35
eH1_6                 9.802866e-02 1 1  ON 36
eH1_7                 1.424915e-01 1 1  ON 37
eH1_8                 1.529436e-01 1 1  ON 38
eH1_9                 3.931855e-02 1 1  ON 39
eH2_0                -2.270980e-01 1 1  ON 40
eH2_1                -1.310938e-01 1 1  ON 41
eH2_2                -8.682949e-02 1 1  ON 42
eH2_3                -3.445825e-02 1 1  ON 43
eH2_4                 1.363615e-02 1 1  ON 44
eH2_5                 4.765307e-02 1 1  ON 45
eH2_6                 1.021701e-01 1 1  ON 46
eH2_7                 1.499633e-01 1 1  ON 47
eH2_8                 1.615661e-01 1 1  ON 48
eH2_9                 2.217368e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.9126
    reference variance = 0.385655
====================================================
  Execution time = 2.0687e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4491e-01
  Total weights = 2.0000e+06
  Execution time = 1.9254e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345010878814
                                         uncertainty =       0.005509290392

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345010878814
                                         uncertainty =       0.005509290392

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415266481
  error estimate for blocks of size 2^( 2) =       0.000427725943
  error estimate for blocks of size 2^( 3) =       0.000441076880
  error estimate for blocks of size 2^( 4) =       0.000453368510
  error estimate for blocks of size 2^( 5) =       0.000464860755
  error estimate for blocks of size 2^( 6) =       0.000471234428
  error estimate for blocks of size 2^( 7) =       0.000476988332

      target function =                  N/A
              le_mean =     -16.905686105014
             les_mean =     286.147115009275
             stat err =       0.000466613006
             autocorr =       1.262582962873
              std dev =       0.587275489393
             le_variance =       0.344892500442

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345065050639
                                         uncertainty =       0.005510388502

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345065050639
                                         uncertainty =       0.005510388502

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415299081
  error estimate for blocks of size 2^( 2) =       0.000427756459
  error estimate for blocks of size 2^( 3) =       0.000441104942
  error estimate for blocks of size 2^( 4) =       0.000453394689
  error estimate for blocks of size 2^( 5) =       0.000464885443
  error estimate for blocks of size 2^( 6) =       0.000471258519
  error estimate for blocks of size 2^( 7) =       0.000477009521

      target function =                  N/A
              le_mean =     -16.905686149854
             les_mean =     286.147170677751
             stat err =       0.000466637043
             autocorr =       1.262514816455
              std dev =       0.587321592378
             le_variance =       0.344946652874

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345039521733
                                         uncertainty =       0.005509869073

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345039521733
                                         uncertainty =       0.005509869073

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415283718
  error estimate for blocks of size 2^( 2) =       0.000427742065
  error estimate for blocks of size 2^( 3) =       0.000441091714
  error estimate for blocks of size 2^( 4) =       0.000453382368
  error estimate for blocks of size 2^( 5) =       0.000464873846
  error estimate for blocks of size 2^( 6) =       0.000471247196
  error estimate for blocks of size 2^( 7) =       0.000476999506

      target function =                  N/A
              le_mean =     -16.905686127495
             les_mean =     286.147144402381
             stat err =       0.000466625729
             autocorr =       1.262546998026
              std dev =       0.587299866746
             le_variance =       0.344921133479

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345014510692
                                         uncertainty =       0.005509363732

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345014510692
                                         uncertainty =       0.005509363732

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415268667
  error estimate for blocks of size 2^( 2) =       0.000427727987
  error estimate for blocks of size 2^( 3) =       0.000441078760
  error estimate for blocks of size 2^( 4) =       0.000453370267
  error estimate for blocks of size 2^( 5) =       0.000464862416
  error estimate for blocks of size 2^( 6) =       0.000471236047
  error estimate for blocks of size 2^( 7) =       0.000476989747

      target function =                  N/A
              le_mean =     -16.905686107586
             les_mean =     286.147118726854
             stat err =       0.000466614619
             autocorr =       1.262578400748
              std dev =       0.587278580471
             le_variance =       0.344896131080


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905686105014        initial
     3.7253e+00     3.7253e+01             8.5950e-05       -16.905686149854  <--
     1.4901e+01     1.4901e+02             2.1617e-05       -16.905686127495
     5.9605e+01     5.9605e+02             5.4131e-06       -16.905686107586

*****************************************************************************
Applying the update for shift_i =   3.7253e+00     and shift_s =   3.7253e+01
*****************************************************************************

  Execution time = 3.0428e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.061216e-01 1 1  ON 0
 uu_1                 1.398768e-01 1 1  ON 1
 uu_2                 3.909297e-02 1 1  ON 2
 uu_3                -2.184333e-02 1 1  ON 3
 uu_4                -6.517435e-02 1 1  ON 4
 uu_5                -9.729284e-02 1 1  ON 5
 uu_6                -1.224518e-01 1 1  ON 6
 uu_7                -1.334468e-01 1 1  ON 7
 uu_8                -1.232042e-01 1 1  ON 8
 uu_9                -9.222928e-02 1 1  ON 9
 ud_0                 4.369653e-01 1 1  ON 10
 ud_1                 1.734575e-01 1 1  ON 11
 ud_2                 5.788708e-02 1 1  ON 12
 ud_3                -9.909058e-03 1 1  ON 13
 ud_4                -6.589600e-02 1 1  ON 14
 ud_5                -1.060241e-01 1 1  ON 15
 ud_6                -1.322885e-01 1 1  ON 16
 ud_7                -1.474679e-01 1 1  ON 17
 ud_8                -1.476951e-01 1 1  ON 18
 ud_9                -1.345962e-01 1 1  ON 19
 eO_0                -7.441280e-01 1 1  ON 20
 eO_1                -4.287371e-01 1 1  ON 21
 eO_2                -1.742737e-02 1 1  ON 22
 eO_3                 2.932300e-01 1 1  ON 23
 eO_4                 5.092842e-01 1 1  ON 24
 eO_5                 4.648163e-01 1 1  ON 25
 eO_6                 2.374804e-01 1 1  ON 26
 eO_7                -5.390655e-02 1 1  ON 27
 eO_8                -2.008476e-01 1 1  ON 28
 eO_9                -6.210148e-02 1 1  ON 29
eH1_0                -2.289670e-01 1 1  ON 30
eH1_1                -1.325580e-01 1 1  ON 31
eH1_2                -8.824129e-02 1 1  ON 32
eH1_3                -3.559514e-02 1 1  ON 33
eH1_4                 1.162361e-02 1 1  ON 34
eH1_5                 4.486454e-02 1 1  ON 35
eH1_6                 9.803113e-02 1 1  ON 36
eH1_7                 1.425089e-01 1 1  ON 37
eH1_8                 1.529788e-01 1 1  ON 38
eH1_9                 3.934889e-02 1 1  ON 39
eH2_0                -2.271419e-01 1 1  ON 40
eH2_1                -1.311211e-01 1 1  ON 41
eH2_2                -8.684382e-02 1 1  ON 42
eH2_3                -3.445631e-02 1 1  ON 43
eH2_4                 1.361405e-02 1 1  ON 44
eH2_5                 4.766001e-02 1 1  ON 45
eH2_6                 1.021705e-01 1 1  ON 46
eH2_7                 1.499704e-01 1 1  ON 47
eH2_8                 1.616060e-01 1 1  ON 48
eH2_9                 2.222024e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7159e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.9424
    reference variance = 0.246711
====================================================
  Execution time = 2.0966e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3087e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5601e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330939923591
                                         uncertainty =       0.003492715336

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330939923591
                                         uncertainty =       0.003492715336

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406735037
  error estimate for blocks of size 2^( 2) =       0.000419458956
  error estimate for blocks of size 2^( 3) =       0.000432500150
  error estimate for blocks of size 2^( 4) =       0.000445719223
  error estimate for blocks of size 2^( 5) =       0.000456610472
  error estimate for blocks of size 2^( 6) =       0.000464426900
  error estimate for blocks of size 2^( 7) =       0.000470226069

      target function =                  N/A
              le_mean =     -16.904742195678
             les_mean =     286.101175318009
             stat err =       0.000459245666
             autocorr =       1.274873113994
              std dev =       0.575210206014
             le_variance =       0.330866781103


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690474219568e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e-01, overlap shift 9.3132e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904742195678       residual = 4.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904744063899       residual = 4.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904744033381       residual = 5.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904744468309       residual = 3.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904744641275       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904744206527       residual = 3.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904744368046       residual = 8.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904744426749       residual = 2.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.904744417099       residual = 5.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e-01 is 3.959652e-04

solving harmonic davidson linear method for identity shift 3.7253e+00, overlap shift 3.7253e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904742195678       residual = 4.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904742734980       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904742718026       residual = 5.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904742817272       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904742869808       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904742759728       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904742798061       residual = 4.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904742795483       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.904742795861       residual = 2.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+00 is 1.020026e-04

solving harmonic davidson linear method for identity shift 1.4901e+01, overlap shift 1.4901e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904742195678       residual = 4.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904742335927       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904742331586       residual = 5.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904742356173       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904742369317       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904742341736       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904742351612       residual = 3.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904742349832       residual = 8.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+01 is 2.559565e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.104242 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6533e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.061247e-01 1 1  ON 0
 uu_1                 1.398897e-01 1 1  ON 1
 uu_2                 3.911676e-02 1 1  ON 2
 uu_3                -2.186070e-02 1 1  ON 3
 uu_4                -6.517262e-02 1 1  ON 4
 uu_5                -9.728467e-02 1 1  ON 5
 uu_6                -1.224315e-01 1 1  ON 6
 uu_7                -1.334622e-01 1 1  ON 7
 uu_8                -1.232659e-01 1 1  ON 8
 uu_9                -9.226671e-02 1 1  ON 9
 ud_0                 4.370385e-01 1 1  ON 10
 ud_1                 1.735155e-01 1 1  ON 11
 ud_2                 5.790400e-02 1 1  ON 12
 ud_3                -9.891858e-03 1 1  ON 13
 ud_4                -6.589078e-02 1 1  ON 14
 ud_5                -1.060444e-01 1 1  ON 15
 ud_6                -1.322828e-01 1 1  ON 16
 ud_7                -1.474998e-01 1 1  ON 17
 ud_8                -1.477543e-01 1 1  ON 18
 ud_9                -1.346389e-01 1 1  ON 19
 eO_0                -7.442300e-01 1 1  ON 20
 eO_1                -4.288186e-01 1 1  ON 21
 eO_2                -1.742613e-02 1 1  ON 22
 eO_3                 2.932790e-01 1 1  ON 23
 eO_4                 5.093735e-01 1 1  ON 24
 eO_5                 4.648999e-01 1 1  ON 25
 eO_6                 2.375400e-01 1 1  ON 26
 eO_7                -5.389916e-02 1 1  ON 27
 eO_8                -2.009039e-01 1 1  ON 28
 eO_9                -6.214567e-02 1 1  ON 29
eH1_0                -2.290200e-01 1 1  ON 30
eH1_1                -1.325945e-01 1 1  ON 31
eH1_2                -8.825712e-02 1 1  ON 32
eH1_3                -3.562172e-02 1 1  ON 33
eH1_4                 1.162196e-02 1 1  ON 34
eH1_5                 4.486910e-02 1 1  ON 35
eH1_6                 9.806252e-02 1 1  ON 36
eH1_7                 1.425408e-01 1 1  ON 37
eH1_8                 1.530183e-01 1 1  ON 38
eH1_9                 3.937964e-02 1 1  ON 39
eH2_0                -2.272293e-01 1 1  ON 40
eH2_1                -1.311476e-01 1 1  ON 41
eH2_2                -8.686855e-02 1 1  ON 42
eH2_3                -3.444004e-02 1 1  ON 43
eH2_4                 1.357071e-02 1 1  ON 44
eH2_5                 4.768163e-02 1 1  ON 45
eH2_6                 1.021830e-01 1 1  ON 46
eH2_7                 1.499774e-01 1 1  ON 47
eH2_8                 1.616581e-01 1 1  ON 48
eH2_9                 2.228923e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.9323
    reference variance = 0.16489
====================================================
  Execution time = 2.0586e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3996e-01
  Total weights = 2.0000e+06
  Execution time = 1.9270e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339752112760
                                         uncertainty =       0.005655462389

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339752112760
                                         uncertainty =       0.005655462389

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412265462
  error estimate for blocks of size 2^( 2) =       0.000424929418
  error estimate for blocks of size 2^( 3) =       0.000437800493
  error estimate for blocks of size 2^( 4) =       0.000450195984
  error estimate for blocks of size 2^( 5) =       0.000461376991
  error estimate for blocks of size 2^( 6) =       0.000468784966
  error estimate for blocks of size 2^( 7) =       0.000472855209

      target function =                  N/A
              le_mean =     -16.905083719071
             les_mean =     286.121781001330
             stat err =       0.000463303287
             autocorr =       1.262922957074
              std dev =       0.583031407809
             le_variance =       0.339925622492

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339874882285
                                         uncertainty =       0.005658189824

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339874882285
                                         uncertainty =       0.005658189824

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412340071
  error estimate for blocks of size 2^( 2) =       0.000424998274
  error estimate for blocks of size 2^( 3) =       0.000437863114
  error estimate for blocks of size 2^( 4) =       0.000450252262
  error estimate for blocks of size 2^( 5) =       0.000461429752
  error estimate for blocks of size 2^( 6) =       0.000468833512
  error estimate for blocks of size 2^( 7) =       0.000472899857

      target function =                  N/A
              le_mean =     -16.905081720627
             les_mean =     286.121836479522
             stat err =       0.000463353846
             autocorr =       1.262741521083
              std dev =       0.583136920862
             le_variance =       0.340048668473

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339817444477
                                         uncertainty =       0.005656914612

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339817444477
                                         uncertainty =       0.005656914612

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412305181
  error estimate for blocks of size 2^( 2) =       0.000424965775
  error estimate for blocks of size 2^( 3) =       0.000437833481
  error estimate for blocks of size 2^( 4) =       0.000450225556
  error estimate for blocks of size 2^( 5) =       0.000461404767
  error estimate for blocks of size 2^( 6) =       0.000468810251
  error estimate for blocks of size 2^( 7) =       0.000472878274

      target function =                  N/A
              le_mean =     -16.905082419728
             les_mean =     286.121802573021
             stat err =       0.000463329712
             autocorr =       1.262823680306
              std dev =       0.583087579373
             le_variance =       0.339991125219

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339760092568
                                         uncertainty =       0.005655638369

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339760092568
                                         uncertainty =       0.005655638369

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412270315
  error estimate for blocks of size 2^( 2) =       0.000424933838
  error estimate for blocks of size 2^( 3) =       0.000437804497
  error estimate for blocks of size 2^( 4) =       0.000450199555
  error estimate for blocks of size 2^( 5) =       0.000461380338
  error estimate for blocks of size 2^( 6) =       0.000468787972
  error estimate for blocks of size 2^( 7) =       0.000472857916

      target function =                  N/A
              le_mean =     -16.905083541255
             les_mean =     286.121782991798
             stat err =       0.000463306445
             autocorr =       1.262910441171
              std dev =       0.583038270563
             le_variance =       0.339933624941


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905083719071        initial  <--
     9.3132e-01     9.3132e+00             3.9597e-04       -16.905081720627
     3.7253e+00     3.7253e+01             1.0200e-04       -16.905082419728
     1.4901e+01     1.4901e+02             2.5596e-05       -16.905083541255

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.3014
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.061216e-01 1 1  ON 0
 uu_1                 1.398768e-01 1 1  ON 1
 uu_2                 3.909297e-02 1 1  ON 2
 uu_3                -2.184333e-02 1 1  ON 3
 uu_4                -6.517435e-02 1 1  ON 4
 uu_5                -9.729284e-02 1 1  ON 5
 uu_6                -1.224518e-01 1 1  ON 6
 uu_7                -1.334468e-01 1 1  ON 7
 uu_8                -1.232042e-01 1 1  ON 8
 uu_9                -9.222928e-02 1 1  ON 9
 ud_0                 4.369653e-01 1 1  ON 10
 ud_1                 1.734575e-01 1 1  ON 11
 ud_2                 5.788708e-02 1 1  ON 12
 ud_3                -9.909058e-03 1 1  ON 13
 ud_4                -6.589600e-02 1 1  ON 14
 ud_5                -1.060241e-01 1 1  ON 15
 ud_6                -1.322885e-01 1 1  ON 16
 ud_7                -1.474679e-01 1 1  ON 17
 ud_8                -1.476951e-01 1 1  ON 18
 ud_9                -1.345962e-01 1 1  ON 19
 eO_0                -7.441280e-01 1 1  ON 20
 eO_1                -4.287371e-01 1 1  ON 21
 eO_2                -1.742737e-02 1 1  ON 22
 eO_3                 2.932300e-01 1 1  ON 23
 eO_4                 5.092842e-01 1 1  ON 24
 eO_5                 4.648163e-01 1 1  ON 25
 eO_6                 2.374804e-01 1 1  ON 26
 eO_7                -5.390655e-02 1 1  ON 27
 eO_8                -2.008476e-01 1 1  ON 28
 eO_9                -6.210148e-02 1 1  ON 29
eH1_0                -2.289670e-01 1 1  ON 30
eH1_1                -1.325580e-01 1 1  ON 31
eH1_2                -8.824129e-02 1 1  ON 32
eH1_3                -3.559514e-02 1 1  ON 33
eH1_4                 1.162361e-02 1 1  ON 34
eH1_5                 4.486454e-02 1 1  ON 35
eH1_6                 9.803113e-02 1 1  ON 36
eH1_7                 1.425089e-01 1 1  ON 37
eH1_8                 1.529788e-01 1 1  ON 38
eH1_9                 3.934889e-02 1 1  ON 39
eH2_0                -2.271419e-01 1 1  ON 40
eH2_1                -1.311211e-01 1 1  ON 41
eH2_2                -8.684382e-02 1 1  ON 42
eH2_3                -3.445631e-02 1 1  ON 43
eH2_4                 1.361405e-02 1 1  ON 44
eH2_5                 4.766001e-02 1 1  ON 45
eH2_6                 1.021705e-01 1 1  ON 46
eH2_7                 1.499704e-01 1 1  ON 47
eH2_8                 1.616060e-01 1 1  ON 48
eH2_9                 2.222024e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6855e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.886
    reference variance = 0.272386
====================================================
  Execution time = 2.3302e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.3330e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6567e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333414579542
                                         uncertainty =       0.003709479570

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333414579542
                                         uncertainty =       0.003709479570

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408230393
  error estimate for blocks of size 2^( 2) =       0.000421276753
  error estimate for blocks of size 2^( 3) =       0.000434278544
  error estimate for blocks of size 2^( 4) =       0.000446763589
  error estimate for blocks of size 2^( 5) =       0.000458001847
  error estimate for blocks of size 2^( 6) =       0.000466835525
  error estimate for blocks of size 2^( 7) =       0.000473538333

      target function =                  N/A
              le_mean =     -16.904294930988
             les_mean =     286.088491054229
             stat err =       0.000461284823
             autocorr =       1.276814078783
              std dev =       0.577324957942
             le_variance =       0.333304107062


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690429493099e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+00, overlap shift 9.3132e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904294930988       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904294950308       residual = 4.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904294929693       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904294907966       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904294883121       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904294897640       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904294921964       residual = 2.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904294937716       residual = 9.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+00 is 3.585166e-05

solving harmonic davidson linear method for identity shift 3.7253e+01, overlap shift 3.7253e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904294930988       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904294935901       residual = 4.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904294930680       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904294925359       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904294919223       residual = 9.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904294922886       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904294928562       residual = 2.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904294932533       residual = 8.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+01 is 9.087253e-06

solving harmonic davidson linear method for identity shift 1.4901e+02, overlap shift 1.4901e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904294930988       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904294932221       residual = 4.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904294930912       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904294929589       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904294928060       residual = 9.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904294928979       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904294930372       residual = 2.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904294931366       residual = 7.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+02 is 2.279797e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.106935 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8965e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.061247e-01 1 1  ON 0
 uu_1                 1.398780e-01 1 1  ON 1
 uu_2                 3.909562e-02 1 1  ON 2
 uu_3                -2.184608e-02 1 1  ON 3
 uu_4                -6.517530e-02 1 1  ON 4
 uu_5                -9.729598e-02 1 1  ON 5
 uu_6                -1.224521e-01 1 1  ON 6
 uu_7                -1.334476e-01 1 1  ON 7
 uu_8                -1.232085e-01 1 1  ON 8
 uu_9                -9.223030e-02 1 1  ON 9
 ud_0                 4.369744e-01 1 1  ON 10
 ud_1                 1.734617e-01 1 1  ON 11
 ud_2                 5.788554e-02 1 1  ON 12
 ud_3                -9.911583e-03 1 1  ON 13
 ud_4                -6.589728e-02 1 1  ON 14
 ud_5                -1.060247e-01 1 1  ON 15
 ud_6                -1.322911e-01 1 1  ON 16
 ud_7                -1.474736e-01 1 1  ON 17
 ud_8                -1.476964e-01 1 1  ON 18
 ud_9                -1.345951e-01 1 1  ON 19
 eO_0                -7.441353e-01 1 1  ON 20
 eO_1                -4.287462e-01 1 1  ON 21
 eO_2                -1.742779e-02 1 1  ON 22
 eO_3                 2.932362e-01 1 1  ON 23
 eO_4                 5.092902e-01 1 1  ON 24
 eO_5                 4.648230e-01 1 1  ON 25
 eO_6                 2.374836e-01 1 1  ON 26
 eO_7                -5.390544e-02 1 1  ON 27
 eO_8                -2.008510e-01 1 1  ON 28
 eO_9                -6.210421e-02 1 1  ON 29
eH1_0                -2.289707e-01 1 1  ON 30
eH1_1                -1.325595e-01 1 1  ON 31
eH1_2                -8.824488e-02 1 1  ON 32
eH1_3                -3.559356e-02 1 1  ON 33
eH1_4                 1.162315e-02 1 1  ON 34
eH1_5                 4.486307e-02 1 1  ON 35
eH1_6                 9.803121e-02 1 1  ON 36
eH1_7                 1.425102e-01 1 1  ON 37
eH1_8                 1.529828e-01 1 1  ON 38
eH1_9                 3.935264e-02 1 1  ON 39
eH2_0                -2.271451e-01 1 1  ON 40
eH2_1                -1.311254e-01 1 1  ON 41
eH2_2                -8.684647e-02 1 1  ON 42
eH2_3                -3.445515e-02 1 1  ON 43
eH2_4                 1.361264e-02 1 1  ON 44
eH2_5                 4.765749e-02 1 1  ON 45
eH2_6                 1.021686e-01 1 1  ON 46
eH2_7                 1.499713e-01 1 1  ON 47
eH2_8                 1.616120e-01 1 1  ON 48
eH2_9                 2.222714e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.8907
    reference variance = 1.20452
====================================================
  Execution time = 2.0302e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4044e-01
  Total weights = 2.0000e+06
  Execution time = 1.9195e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340389082867
                                         uncertainty =       0.006109077378

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340389082867
                                         uncertainty =       0.006109077378

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412570772
  error estimate for blocks of size 2^( 2) =       0.000425731087
  error estimate for blocks of size 2^( 3) =       0.000439101321
  error estimate for blocks of size 2^( 4) =       0.000452276415
  error estimate for blocks of size 2^( 5) =       0.000463777201
  error estimate for blocks of size 2^( 6) =       0.000471260356
  error estimate for blocks of size 2^( 7) =       0.000474399224

      target function =                  N/A
              le_mean =     -16.905340241224
             les_mean =     286.130957785809
             stat err =       0.000465428299
             autocorr =       1.272649042745
              std dev =       0.583463181773
             le_variance =       0.340429284484

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340420485728
                                         uncertainty =       0.006109396779

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340420485728
                                         uncertainty =       0.006109396779

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412589808
  error estimate for blocks of size 2^( 2) =       0.000425748923
  error estimate for blocks of size 2^( 3) =       0.000439117849
  error estimate for blocks of size 2^( 4) =       0.000452291714
  error estimate for blocks of size 2^( 5) =       0.000463791914
  error estimate for blocks of size 2^( 6) =       0.000471274720
  error estimate for blocks of size 2^( 7) =       0.000474413641

      target function =                  N/A
              le_mean =     -16.905340438761
             les_mean =     286.130995879223
             stat err =       0.000465442997
             autocorr =       1.272611989885
              std dev =       0.583490101938
             le_variance =       0.340460699060

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340405056114
                                         uncertainty =       0.006109235717

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340405056114
                                         uncertainty =       0.006109235717

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412580455
  error estimate for blocks of size 2^( 2) =       0.000425740157
  error estimate for blocks of size 2^( 3) =       0.000439109726
  error estimate for blocks of size 2^( 4) =       0.000452284193
  error estimate for blocks of size 2^( 5) =       0.000463784683
  error estimate for blocks of size 2^( 6) =       0.000471267663
  error estimate for blocks of size 2^( 7) =       0.000474406567

      target function =                  N/A
              le_mean =     -16.905340342500
             les_mean =     286.130977189372
             stat err =       0.000465435777
             autocorr =       1.272630200971
              std dev =       0.583476875147
             le_variance =       0.340445263832

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340391087632
                                         uncertainty =       0.006109097115

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340391087632
                                         uncertainty =       0.006109097115

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412571988
  error estimate for blocks of size 2^( 2) =       0.000425732226
  error estimate for blocks of size 2^( 3) =       0.000439102375
  error estimate for blocks of size 2^( 4) =       0.000452277391
  error estimate for blocks of size 2^( 5) =       0.000463778140
  error estimate for blocks of size 2^( 6) =       0.000471261273
  error estimate for blocks of size 2^( 7) =       0.000474400146

      target function =                  N/A
              le_mean =     -16.905340253903
             les_mean =     286.130960220037
             stat err =       0.000465429237
             autocorr =       1.272646677444
              std dev =       0.583464900418
             le_variance =       0.340431290020


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905340241224        initial
     9.3132e+00     9.3132e+01             3.5852e-05       -16.905340438761  <--
     3.7253e+01     3.7253e+02             9.0873e-06       -16.905340342500
     1.4901e+02     1.4901e+03             2.2798e-06       -16.905340253903

*****************************************************************************
Applying the update for shift_i =   9.3132e+00     and shift_s =   9.3132e+01
*****************************************************************************

  Execution time = 2.9979e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.061341e-01 1 1  ON 0
 uu_1                 1.398816e-01 1 1  ON 1
 uu_2                 3.910327e-02 1 1  ON 2
 uu_3                -2.185404e-02 1 1  ON 3
 uu_4                -6.517835e-02 1 1  ON 4
 uu_5                -9.730514e-02 1 1  ON 5
 uu_6                -1.224530e-01 1 1  ON 6
 uu_7                -1.334499e-01 1 1  ON 7
 uu_8                -1.232213e-01 1 1  ON 8
 uu_9                -9.223335e-02 1 1  ON 9
 ud_0                 4.370010e-01 1 1  ON 10
 ud_1                 1.734740e-01 1 1  ON 11
 ud_2                 5.788141e-02 1 1  ON 12
 ud_3                -9.919040e-03 1 1  ON 13
 ud_4                -6.590104e-02 1 1  ON 14
 ud_5                -1.060267e-01 1 1  ON 15
 ud_6                -1.322987e-01 1 1  ON 16
 ud_7                -1.474904e-01 1 1  ON 17
 ud_8                -1.477004e-01 1 1  ON 18
 ud_9                -1.345919e-01 1 1  ON 19
 eO_0                -7.441575e-01 1 1  ON 20
 eO_1                -4.287730e-01 1 1  ON 21
 eO_2                -1.742927e-02 1 1  ON 22
 eO_3                 2.932547e-01 1 1  ON 23
 eO_4                 5.093086e-01 1 1  ON 24
 eO_5                 4.648432e-01 1 1  ON 25
 eO_6                 2.374932e-01 1 1  ON 26
 eO_7                -5.390209e-02 1 1  ON 27
 eO_8                -2.008613e-01 1 1  ON 28
 eO_9                -6.211241e-02 1 1  ON 29
eH1_0                -2.289817e-01 1 1  ON 30
eH1_1                -1.325641e-01 1 1  ON 31
eH1_2                -8.825544e-02 1 1  ON 32
eH1_3                -3.558902e-02 1 1  ON 33
eH1_4                 1.162177e-02 1 1  ON 34
eH1_5                 4.485869e-02 1 1  ON 35
eH1_6                 9.803148e-02 1 1  ON 36
eH1_7                 1.425143e-01 1 1  ON 37
eH1_8                 1.529949e-01 1 1  ON 38
eH1_9                 3.936389e-02 1 1  ON 39
eH2_0                -2.271548e-01 1 1  ON 40
eH2_1                -1.311384e-01 1 1  ON 41
eH2_2                -8.685436e-02 1 1  ON 42
eH2_3                -3.445181e-02 1 1  ON 43
eH2_4                 1.360840e-02 1 1  ON 44
eH2_5                 4.764997e-02 1 1  ON 45
eH2_6                 1.021628e-01 1 1  ON 46
eH2_7                 1.499743e-01 1 1  ON 47
eH2_8                 1.616299e-01 1 1  ON 48
eH2_9                 2.224781e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8949e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.93
    reference variance = 0.231651
====================================================
  Execution time = 2.1176e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3227e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4678e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332078120319
                                         uncertainty =       0.003540915969

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332078120319
                                         uncertainty =       0.003540915969

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407595814
  error estimate for blocks of size 2^( 2) =       0.000420432322
  error estimate for blocks of size 2^( 3) =       0.000433250194
  error estimate for blocks of size 2^( 4) =       0.000445438006
  error estimate for blocks of size 2^( 5) =       0.000454853656
  error estimate for blocks of size 2^( 6) =       0.000462793035
  error estimate for blocks of size 2^( 7) =       0.000468275101

      target function =                  N/A
              le_mean =     -16.905611622057
             les_mean =     286.131972845356
             stat err =       0.000457839949
             autocorr =       1.261734384853
              std dev =       0.576427528531
             le_variance =       0.332268695648


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690561162206e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+00, overlap shift 2.3283e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905611622057       residual = 7.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905612166213       residual = 4.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905612309621       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905611938033       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905612260821       residual = 8.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905612239119       residual = 2.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905612559808       residual = 3.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905612515319       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905612523233       residual = 1.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+00 is 1.312506e-04

solving harmonic davidson linear method for identity shift 9.3132e+00, overlap shift 9.3132e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905611622057       residual = 7.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905611761837       residual = 4.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905611800515       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905611706759       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905611792511       residual = 7.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905611776625       residual = 2.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905611855152       residual = 2.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905611848177       residual = 6.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+00 is 3.229062e-05

solving harmonic davidson linear method for identity shift 3.7253e+01, overlap shift 3.7253e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905611622057       residual = 7.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905611657244       residual = 4.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905611667124       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905611643617       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905611665426       residual = 7.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905611660740       residual = 2.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905611680140       residual = 2.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905611678685       residual = 5.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+01 is 8.088910e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.109717 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6652e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.061289e-01 1 1  ON 0
 uu_1                 1.398894e-01 1 1  ON 1
 uu_2                 3.911633e-02 1 1  ON 2
 uu_3                -2.185050e-02 1 1  ON 3
 uu_4                -6.517666e-02 1 1  ON 4
 uu_5                -9.729751e-02 1 1  ON 5
 uu_6                -1.224614e-01 1 1  ON 6
 uu_7                -1.334552e-01 1 1  ON 7
 uu_8                -1.232442e-01 1 1  ON 8
 uu_9                -9.225079e-02 1 1  ON 9
 ud_0                 4.370324e-01 1 1  ON 10
 ud_1                 1.734971e-01 1 1  ON 11
 ud_2                 5.788392e-02 1 1  ON 12
 ud_3                -9.916168e-03 1 1  ON 13
 ud_4                -6.590400e-02 1 1  ON 14
 ud_5                -1.060344e-01 1 1  ON 15
 ud_6                -1.322983e-01 1 1  ON 16
 ud_7                -1.475028e-01 1 1  ON 17
 ud_8                -1.477193e-01 1 1  ON 18
 ud_9                -1.346078e-01 1 1  ON 19
 eO_0                -7.441881e-01 1 1  ON 20
 eO_1                -4.287980e-01 1 1  ON 21
 eO_2                -1.743277e-02 1 1  ON 22
 eO_3                 2.932774e-01 1 1  ON 23
 eO_4                 5.093299e-01 1 1  ON 24
 eO_5                 4.648755e-01 1 1  ON 25
 eO_6                 2.375120e-01 1 1  ON 26
 eO_7                -5.389800e-02 1 1  ON 27
 eO_8                -2.008847e-01 1 1  ON 28
 eO_9                -6.212723e-02 1 1  ON 29
eH1_0                -2.289969e-01 1 1  ON 30
eH1_1                -1.325711e-01 1 1  ON 31
eH1_2                -8.826477e-02 1 1  ON 32
eH1_3                -3.559432e-02 1 1  ON 33
eH1_4                 1.162806e-02 1 1  ON 34
eH1_5                 4.486241e-02 1 1  ON 35
eH1_6                 9.802655e-02 1 1  ON 36
eH1_7                 1.425191e-01 1 1  ON 37
eH1_8                 1.530160e-01 1 1  ON 38
eH1_9                 3.937477e-02 1 1  ON 39
eH2_0                -2.271783e-01 1 1  ON 40
eH2_1                -1.311499e-01 1 1  ON 41
eH2_2                -8.686437e-02 1 1  ON 42
eH2_3                -3.444949e-02 1 1  ON 43
eH2_4                 1.360751e-02 1 1  ON 44
eH2_5                 4.765718e-02 1 1  ON 45
eH2_6                 1.021602e-01 1 1  ON 46
eH2_7                 1.499696e-01 1 1  ON 47
eH2_8                 1.616462e-01 1 1  ON 48
eH2_9                 2.227148e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.9575
    reference variance = 0.339942
====================================================
  Execution time = 2.0533e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4616e-01
  Total weights = 2.0000e+06
  Execution time = 1.9233e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346135982773
                                         uncertainty =       0.013796260823

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346135982773
                                         uncertainty =       0.013796260823

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416019453
  error estimate for blocks of size 2^( 2) =       0.000428401011
  error estimate for blocks of size 2^( 3) =       0.000441039476
  error estimate for blocks of size 2^( 4) =       0.000453408839
  error estimate for blocks of size 2^( 5) =       0.000463829236
  error estimate for blocks of size 2^( 6) =       0.000472154248
  error estimate for blocks of size 2^( 7) =       0.000475845398

      target function =                  N/A
              le_mean =     -16.905364065737
             les_mean =     286.137478392004
             stat err =       0.000466309430
             autocorr =       1.256380305553
              std dev =       0.588340352150
             le_variance =       0.346144369968

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346201827907
                                         uncertainty =       0.013804997469

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346201827907
                                         uncertainty =       0.013804997469

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416059109
  error estimate for blocks of size 2^( 2) =       0.000428438226
  error estimate for blocks of size 2^( 3) =       0.000441073748
  error estimate for blocks of size 2^( 4) =       0.000453440239
  error estimate for blocks of size 2^( 5) =       0.000463858206
  error estimate for blocks of size 2^( 6) =       0.000472183145
  error estimate for blocks of size 2^( 7) =       0.000475872327

      target function =                  N/A
              le_mean =     -16.905364134836
             les_mean =     286.137546722108
             stat err =       0.000466338479
             autocorr =       1.256297326927
              std dev =       0.588396434237
             le_variance =       0.346210363822

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346170227364
                                         uncertainty =       0.013801003792

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346170227364
                                         uncertainty =       0.013801003792

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416040080
  error estimate for blocks of size 2^( 2) =       0.000428420346
  error estimate for blocks of size 2^( 3) =       0.000441057301
  error estimate for blocks of size 2^( 4) =       0.000453425182
  error estimate for blocks of size 2^( 5) =       0.000463844345
  error estimate for blocks of size 2^( 6) =       0.000472169427
  error estimate for blocks of size 2^( 7) =       0.000475859484

      target function =                  N/A
              le_mean =     -16.905364092689
             les_mean =     286.137513629967
             stat err =       0.000466324609
             autocorr =       1.256337512826
              std dev =       0.588369523918
             le_variance =       0.346178696675

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346140305658
                                         uncertainty =       0.013796864707

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346140305658
                                         uncertainty =       0.013796864707

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416022057
  error estimate for blocks of size 2^( 2) =       0.000428403451
  error estimate for blocks of size 2^( 3) =       0.000441041724
  error estimate for blocks of size 2^( 4) =       0.000453410900
  error estimate for blocks of size 2^( 5) =       0.000463831141
  error estimate for blocks of size 2^( 6) =       0.000472156165
  error estimate for blocks of size 2^( 7) =       0.000475847176

      target function =                  N/A
              le_mean =     -16.905364068153
             les_mean =     286.137482807006
             stat err =       0.000466311346
             autocorr =       1.256374899966
              std dev =       0.588344034800
             le_variance =       0.346148703285


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905364065737        initial
     2.3283e+00     2.3283e+01             1.3125e-04       -16.905364134836  <--
     9.3132e+00     9.3132e+01             3.2291e-05       -16.905364092689
     3.7253e+01     3.7253e+02             8.0889e-06       -16.905364068153

*****************************************************************************
Applying the update for shift_i =   2.3283e+00     and shift_s =   2.3283e+01
*****************************************************************************

  Execution time = 3.0227e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.061185e-01 1 1  ON 0
 uu_1                 1.399121e-01 1 1  ON 1
 uu_2                 3.914869e-02 1 1  ON 2
 uu_3                -2.183792e-02 1 1  ON 3
 uu_4                -6.516991e-02 1 1  ON 4
 uu_5                -9.727896e-02 1 1  ON 5
 uu_6                -1.224882e-01 1 1  ON 6
 uu_7                -1.334711e-01 1 1  ON 7
 uu_8                -1.233109e-01 1 1  ON 8
 uu_9                -9.230263e-02 1 1  ON 9
 ud_0                 4.371214e-01 1 1  ON 10
 ud_1                 1.735644e-01 1 1  ON 11
 ud_2                 5.789526e-02 1 1  ON 12
 ud_3                -9.906962e-03 1 1  ON 13
 ud_4                -6.591530e-02 1 1  ON 14
 ud_5                -1.060552e-01 1 1  ON 15
 ud_6                -1.323007e-01 1 1  ON 16
 ud_7                -1.475380e-01 1 1  ON 17
 ud_8                -1.477725e-01 1 1  ON 18
 ud_9                -1.346549e-01 1 1  ON 19
 eO_0                -7.442796e-01 1 1  ON 20
 eO_1                -4.288712e-01 1 1  ON 21
 eO_2                -1.744495e-02 1 1  ON 22
 eO_3                 2.933398e-01 1 1  ON 23
 eO_4                 5.093956e-01 1 1  ON 24
 eO_5                 4.649744e-01 1 1  ON 25
 eO_6                 2.375694e-01 1 1  ON 26
 eO_7                -5.388386e-02 1 1  ON 27
 eO_8                -2.009554e-01 1 1  ON 28
 eO_9                -6.217261e-02 1 1  ON 29
eH1_0                -2.290419e-01 1 1  ON 30
eH1_1                -1.325927e-01 1 1  ON 31
eH1_2                -8.829408e-02 1 1  ON 32
eH1_3                -3.560900e-02 1 1  ON 33
eH1_4                 1.164268e-02 1 1  ON 34
eH1_5                 4.487290e-02 1 1  ON 35
eH1_6                 9.801279e-02 1 1  ON 36
eH1_7                 1.425338e-01 1 1  ON 37
eH1_8                 1.530811e-01 1 1  ON 38
eH1_9                 3.940871e-02 1 1  ON 39
eH2_0                -2.272469e-01 1 1  ON 40
eH2_1                -1.311825e-01 1 1  ON 41
eH2_2                -8.689438e-02 1 1  ON 42
eH2_3                -3.444590e-02 1 1  ON 43
eH2_4                 1.360236e-02 1 1  ON 44
eH2_5                 4.767545e-02 1 1  ON 45
eH2_6                 1.021524e-01 1 1  ON 46
eH2_7                 1.499561e-01 1 1  ON 47
eH2_8                 1.616968e-01 1 1  ON 48
eH2_9                 2.234478e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6886e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6911e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.8769
    reference variance = 0.272724
====================================================
  Execution time = 2.0849e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4472e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4841e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344771910596
                                         uncertainty =       0.007409363086

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344771910596
                                         uncertainty =       0.007409363086

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415162666
  error estimate for blocks of size 2^( 2) =       0.000427395183
  error estimate for blocks of size 2^( 3) =       0.000439519397
  error estimate for blocks of size 2^( 4) =       0.000451405632
  error estimate for blocks of size 2^( 5) =       0.000460936834
  error estimate for blocks of size 2^( 6) =       0.000468766113
  error estimate for blocks of size 2^( 7) =       0.000472733430

      target function =                  N/A
              le_mean =     -16.906096046394
             les_mean =     286.160803435742
             stat err =       0.000463460502
             autocorr =       1.246203226686
              std dev =       0.587128672623
             le_variance =       0.344720078216


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690609604639e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e-01, overlap shift 5.8208e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906096046394       residual = 5.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906097479586       residual = 5.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906099104346       residual = 4.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906100327250       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906100609774       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906100305364       residual = 3.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906100274783       residual = 7.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906100363556       residual = 2.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906100372003       residual = 6.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e-01 is 6.435980e-04

solving harmonic davidson linear method for identity shift 2.3283e+00, overlap shift 2.3283e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906096046394       residual = 5.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906096469576       residual = 5.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906097029633       residual = 4.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906097424265       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906097557209       residual = 8.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906097493154       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906097436073       residual = 2.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906097436549       residual = 9.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+00 is 1.790925e-04

solving harmonic davidson linear method for identity shift 9.3132e+00, overlap shift 9.3132e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906096046394       residual = 5.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906096157206       residual = 5.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906096312245       residual = 4.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906096418669       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906096459535       residual = 7.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906096447371       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906096430090       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906096428435       residual = 6.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+00 is 4.631434e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.112556 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6340e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.060792e-01 1 1  ON 0
 uu_1                 1.399815e-01 1 1  ON 1
 uu_2                 3.919347e-02 1 1  ON 2
 uu_3                -2.184491e-02 1 1  ON 3
 uu_4                -6.513234e-02 1 1  ON 4
 uu_5                -9.723713e-02 1 1  ON 5
 uu_6                -1.225287e-01 1 1  ON 6
 uu_7                -1.335045e-01 1 1  ON 7
 uu_8                -1.233819e-01 1 1  ON 8
 uu_9                -9.239325e-02 1 1  ON 9
 ud_0                 4.371591e-01 1 1  ON 10
 ud_1                 1.736334e-01 1 1  ON 11
 ud_2                 5.792126e-02 1 1  ON 12
 ud_3                -9.900162e-03 1 1  ON 13
 ud_4                -6.593820e-02 1 1  ON 14
 ud_5                -1.060995e-01 1 1  ON 15
 ud_6                -1.323083e-01 1 1  ON 16
 ud_7                -1.474884e-01 1 1  ON 17
 ud_8                -1.478283e-01 1 1  ON 18
 ud_9                -1.347102e-01 1 1  ON 19
 eO_0                -7.444587e-01 1 1  ON 20
 eO_1                -4.289530e-01 1 1  ON 21
 eO_2                -1.743148e-02 1 1  ON 22
 eO_3                 2.934131e-01 1 1  ON 23
 eO_4                 5.095022e-01 1 1  ON 24
 eO_5                 4.651184e-01 1 1  ON 25
 eO_6                 2.376288e-01 1 1  ON 26
 eO_7                -5.386087e-02 1 1  ON 27
 eO_8                -2.010472e-01 1 1  ON 28
 eO_9                -6.223334e-02 1 1  ON 29
eH1_0                -2.291508e-01 1 1  ON 30
eH1_1                -1.326338e-01 1 1  ON 31
eH1_2                -8.829728e-02 1 1  ON 32
eH1_3                -3.564009e-02 1 1  ON 33
eH1_4                 1.161978e-02 1 1  ON 34
eH1_5                 4.488878e-02 1 1  ON 35
eH1_6                 9.802619e-02 1 1  ON 36
eH1_7                 1.425687e-01 1 1  ON 37
eH1_8                 1.531640e-01 1 1  ON 38
eH1_9                 3.947235e-02 1 1  ON 39
eH2_0                -2.273182e-01 1 1  ON 40
eH2_1                -1.312696e-01 1 1  ON 41
eH2_2                -8.689927e-02 1 1  ON 42
eH2_3                -3.443035e-02 1 1  ON 43
eH2_4                 1.358241e-02 1 1  ON 44
eH2_5                 4.768908e-02 1 1  ON 45
eH2_6                 1.021734e-01 1 1  ON 46
eH2_7                 1.499591e-01 1 1  ON 47
eH2_8                 1.617543e-01 1 1  ON 48
eH2_9                 2.241995e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.9145
    reference variance = 0.268718
====================================================
  Execution time = 2.0344e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5180e-01
  Total weights = 2.0000e+06
  Execution time = 1.9426e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351766407285
                                         uncertainty =       0.009345905346

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351766407285
                                         uncertainty =       0.009345905346

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419417021
  error estimate for blocks of size 2^( 2) =       0.000431776536
  error estimate for blocks of size 2^( 3) =       0.000444570380
  error estimate for blocks of size 2^( 4) =       0.000456971688
  error estimate for blocks of size 2^( 5) =       0.000466118409
  error estimate for blocks of size 2^( 6) =       0.000472444725
  error estimate for blocks of size 2^( 7) =       0.000480229709

      target function =                  N/A
              le_mean =     -16.905849588056
             les_mean =     286.159571393838
             stat err =       0.000468941133
             autocorr =       1.250099416904
              std dev =       0.593145240041
             le_variance =       0.351821275783

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351767991088
                                         uncertainty =       0.009345319688

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351767991088
                                         uncertainty =       0.009345319688

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419417943
  error estimate for blocks of size 2^( 2) =       0.000431774946
  error estimate for blocks of size 2^( 3) =       0.000444565683
  error estimate for blocks of size 2^( 4) =       0.000456961664
  error estimate for blocks of size 2^( 5) =       0.000466106280
  error estimate for blocks of size 2^( 6) =       0.000472429736
  error estimate for blocks of size 2^( 7) =       0.000480215364

      target function =                  N/A
              le_mean =     -16.905850141588
             les_mean =     286.159591654921
             stat err =       0.000468928261
             autocorr =       1.250025299896
              std dev =       0.593146542603
             le_variance =       0.351822821002

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351732802786
                                         uncertainty =       0.009343779470

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351732802786
                                         uncertainty =       0.009343779470

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419396983
  error estimate for blocks of size 2^( 2) =       0.000431755778
  error estimate for blocks of size 2^( 3) =       0.000444548773
  error estimate for blocks of size 2^( 4) =       0.000456947725
  error estimate for blocks of size 2^( 5) =       0.000466094449
  error estimate for blocks of size 2^( 6) =       0.000472419429
  error estimate for blocks of size 2^( 7) =       0.000480205710

      target function =                  N/A
              le_mean =     -16.905849746776
             les_mean =     286.159543143203
             stat err =       0.000468916828
             autocorr =       1.250089287314
              std dev =       0.593116901246
             le_variance =       0.351787658544

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351759917598
                                         uncertainty =       0.009345511673

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351759917598
                                         uncertainty =       0.009345511673

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419413152
  error estimate for blocks of size 2^( 2) =       0.000431772619
  error estimate for blocks of size 2^( 3) =       0.000444566401
  error estimate for blocks of size 2^( 4) =       0.000456967450
  error estimate for blocks of size 2^( 5) =       0.000466114238
  error estimate for blocks of size 2^( 6) =       0.000472440414
  error estimate for blocks of size 2^( 7) =       0.000480225643

      target function =                  N/A
              le_mean =     -16.905849594636
             les_mean =     286.159565125439
             stat err =       0.000468936936
             autocorr =       1.250100106996
              std dev =       0.593139768419
             le_variance =       0.351814784881


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905849588056        initial
     5.8208e-01     5.8208e+00             6.4360e-04       -16.905850141588  <--
     2.3283e+00     2.3283e+01             1.7909e-04       -16.905849746776
     9.3132e+00     9.3132e+01             4.6314e-05       -16.905849594636

*****************************************************************************
Applying the update for shift_i =   5.8208e-01     and shift_s =   5.8208e+00
*****************************************************************************

  Execution time = 3.0088e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.060571e-01 1 1  ON 0
 uu_1                 1.401429e-01 1 1  ON 1
 uu_2                 3.930288e-02 1 1  ON 2
 uu_3                -2.182649e-02 1 1  ON 3
 uu_4                -6.505771e-02 1 1  ON 4
 uu_5                -9.716105e-02 1 1  ON 5
 uu_6                -1.226360e-01 1 1  ON 6
 uu_7                -1.336040e-01 1 1  ON 7
 uu_8                -1.235897e-01 1 1  ON 8
 uu_9                -9.266371e-02 1 1  ON 9
 ud_0                 4.373117e-01 1 1  ON 10
 ud_1                 1.738123e-01 1 1  ON 11
 ud_2                 5.799934e-02 1 1  ON 12
 ud_3                -9.885732e-03 1 1  ON 13
 ud_4                -6.600766e-02 1 1  ON 14
 ud_5                -1.061996e-01 1 1  ON 15
 ud_6                -1.323565e-01 1 1  ON 16
 ud_7                -1.473753e-01 1 1  ON 17
 ud_8                -1.479779e-01 1 1  ON 18
 ud_9                -1.348696e-01 1 1  ON 19
 eO_0                -7.449232e-01 1 1  ON 20
 eO_1                -4.292040e-01 1 1  ON 21
 eO_2                -1.742938e-02 1 1  ON 22
 eO_3                 2.936022e-01 1 1  ON 23
 eO_4                 5.098214e-01 1 1  ON 24
 eO_5                 4.655502e-01 1 1  ON 25
 eO_6                 2.378086e-01 1 1  ON 26
 eO_7                -5.378992e-02 1 1  ON 27
 eO_8                -2.013217e-01 1 1  ON 28
 eO_9                -6.241713e-02 1 1  ON 29
eH1_0                -2.294492e-01 1 1  ON 30
eH1_1                -1.327583e-01 1 1  ON 31
eH1_2                -8.833755e-02 1 1  ON 32
eH1_3                -3.571733e-02 1 1  ON 33
eH1_4                 1.154408e-02 1 1  ON 34
eH1_5                 4.492289e-02 1 1  ON 35
eH1_6                 9.806686e-02 1 1  ON 36
eH1_7                 1.426745e-01 1 1  ON 37
eH1_8                 1.534151e-01 1 1  ON 38
eH1_9                 3.966682e-02 1 1  ON 39
eH2_0                -2.275258e-01 1 1  ON 40
eH2_1                -1.314761e-01 1 1  ON 41
eH2_2                -8.693584e-02 1 1  ON 42
eH2_3                -3.441530e-02 1 1  ON 43
eH2_4                 1.352797e-02 1 1  ON 44
eH2_5                 4.771316e-02 1 1  ON 45
eH2_6                 1.022325e-01 1 1  ON 46
eH2_7                 1.499697e-01 1 1  ON 47
eH2_8                 1.619291e-01 1 1  ON 48
eH2_9                 2.264891e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6434e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.9981
    reference variance = 0.359099
====================================================
  Execution time = 2.0887e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4374e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5069e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343826488930
                                         uncertainty =       0.009477110979

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343826488930
                                         uncertainty =       0.009477110979

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414574359
  error estimate for blocks of size 2^( 2) =       0.000427198934
  error estimate for blocks of size 2^( 3) =       0.000440132981
  error estimate for blocks of size 2^( 4) =       0.000452120916
  error estimate for blocks of size 2^( 5) =       0.000461409449
  error estimate for blocks of size 2^( 6) =       0.000468343086
  error estimate for blocks of size 2^( 7) =       0.000473389994

      target function =                  N/A
              le_mean =     -16.905895647889
             les_mean =     286.153051283693
             stat err =       0.000463815861
             autocorr =       1.251659836013
              std dev =       0.586296681084
             le_variance =       0.343743798250


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690589564789e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e-01, overlap shift 1.4552e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905895647889       residual = 8.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905896157566       residual = 6.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905898354252       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905903103638       residual = 4.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905904433043       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905903386247       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905902947421       residual = 4.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905902308956       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905902932503       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905903490460       residual = 5.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905903638976       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905903388334       residual = 5.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e-01 is 1.540819e-03

solving harmonic davidson linear method for identity shift 5.8208e-01, overlap shift 5.8208e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905895647889       residual = 8.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905895853181       residual = 5.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905896968869       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905898582342       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905899345166       residual = 9.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905899125909       residual = 3.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905898602840       residual = 6.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905898646957       residual = 2.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905898647460       residual = 5.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e-01 is 4.963587e-04

solving harmonic davidson linear method for identity shift 2.3283e+00, overlap shift 2.3283e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905895647889       residual = 8.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905895708468       residual = 5.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905896098495       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905896535157       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905896783467       residual = 8.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905896780332       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905896650503       residual = 2.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905896618690       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905896635281       residual = 1.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+00 is 1.483145e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.116307 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6402e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.063344e-01 1 1  ON 0
 uu_1                 1.402969e-01 1 1  ON 1
 uu_2                 3.928042e-02 1 1  ON 2
 uu_3                -2.180354e-02 1 1  ON 3
 uu_4                -6.501541e-02 1 1  ON 4
 uu_5                -9.719896e-02 1 1  ON 5
 uu_6                -1.225847e-01 1 1  ON 6
 uu_7                -1.337397e-01 1 1  ON 7
 uu_8                -1.239416e-01 1 1  ON 8
 uu_9                -9.291087e-02 1 1  ON 9
 ud_0                 4.377386e-01 1 1  ON 10
 ud_1                 1.740407e-01 1 1  ON 11
 ud_2                 5.816756e-02 1 1  ON 12
 ud_3                -9.931040e-03 1 1  ON 13
 ud_4                -6.602994e-02 1 1  ON 14
 ud_5                -1.062942e-01 1 1  ON 15
 ud_6                -1.324021e-01 1 1  ON 16
 ud_7                -1.474412e-01 1 1  ON 17
 ud_8                -1.482742e-01 1 1  ON 18
 ud_9                -1.350990e-01 1 1  ON 19
 eO_0                -7.453000e-01 1 1  ON 20
 eO_1                -4.297003e-01 1 1  ON 21
 eO_2                -1.734270e-02 1 1  ON 22
 eO_3                 2.938782e-01 1 1  ON 23
 eO_4                 5.102280e-01 1 1  ON 24
 eO_5                 4.659102e-01 1 1  ON 25
 eO_6                 2.380786e-01 1 1  ON 26
 eO_7                -5.373707e-02 1 1  ON 27
 eO_8                -2.016294e-01 1 1  ON 28
 eO_9                -6.265359e-02 1 1  ON 29
eH1_0                -2.296854e-01 1 1  ON 30
eH1_1                -1.327520e-01 1 1  ON 31
eH1_2                -8.838857e-02 1 1  ON 32
eH1_3                -3.571085e-02 1 1  ON 33
eH1_4                 1.146397e-02 1 1  ON 34
eH1_5                 4.463449e-02 1 1  ON 35
eH1_6                 9.795650e-02 1 1  ON 36
eH1_7                 1.429553e-01 1 1  ON 37
eH1_8                 1.536833e-01 1 1  ON 38
eH1_9                 3.990790e-02 1 1  ON 39
eH2_0                -2.278801e-01 1 1  ON 40
eH2_1                -1.315186e-01 1 1  ON 41
eH2_2                -8.706490e-02 1 1  ON 42
eH2_3                -3.441646e-02 1 1  ON 43
eH2_4                 1.339558e-02 1 1  ON 44
eH2_5                 4.762024e-02 1 1  ON 45
eH2_6                 1.023045e-01 1 1  ON 46
eH2_7                 1.500456e-01 1 1  ON 47
eH2_8                 1.621838e-01 1 1  ON 48
eH2_9                 2.295860e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.955
    reference variance = 0.257447
====================================================
  Execution time = 2.0501e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4939e-01
  Total weights = 2.0000e+06
  Execution time = 1.9207e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349202829265
                                         uncertainty =       0.010403010522

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349202829265
                                         uncertainty =       0.010403010522

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417777653
  error estimate for blocks of size 2^( 2) =       0.000430676737
  error estimate for blocks of size 2^( 3) =       0.000443552211
  error estimate for blocks of size 2^( 4) =       0.000456183944
  error estimate for blocks of size 2^( 5) =       0.000467622439
  error estimate for blocks of size 2^( 6) =       0.000474753593
  error estimate for blocks of size 2^( 7) =       0.000477044920

      target function =                  N/A
              le_mean =     -16.905742882914
             les_mean =     286.153218583222
             stat err =       0.000468901224
             autocorr =       1.259715060110
              std dev =       0.590826822805
             le_variance =       0.349076334546

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349950117444
                                         uncertainty =       0.010428866767

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349950117444
                                         uncertainty =       0.010428866767

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418224367
  error estimate for blocks of size 2^( 2) =       0.000431102385
  error estimate for blocks of size 2^( 3) =       0.000443944276
  error estimate for blocks of size 2^( 4) =       0.000456551834
  error estimate for blocks of size 2^( 5) =       0.000467969231
  error estimate for blocks of size 2^( 6) =       0.000475092838
  error estimate for blocks of size 2^( 7) =       0.000477394545

      target function =                  N/A
              le_mean =     -16.905741899628
             les_mean =     286.153932244143
             stat err =       0.000469252112
             autocorr =       1.258907459949
              std dev =       0.591458571851
             le_variance =       0.349823242216

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349826834212
                                         uncertainty =       0.010422723967

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349826834212
                                         uncertainty =       0.010422723967

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418150661
  error estimate for blocks of size 2^( 2) =       0.000431032950
  error estimate for blocks of size 2^( 3) =       0.000443883084
  error estimate for blocks of size 2^( 4) =       0.000456498896
  error estimate for blocks of size 2^( 5) =       0.000467922098
  error estimate for blocks of size 2^( 6) =       0.000475048137
  error estimate for blocks of size 2^( 7) =       0.000477352017

      target function =                  N/A
              le_mean =     -16.905742326434
             les_mean =     286.153823383922
             stat err =       0.000469205287
             autocorr =       1.259099983750
              std dev =       0.591354336249
             le_variance =       0.349699951000

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349304543120
                                         uncertainty =       0.010406188093

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349304543120
                                         uncertainty =       0.010406188093

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417838473
  error estimate for blocks of size 2^( 2) =       0.000430734837
  error estimate for blocks of size 2^( 3) =       0.000443606322
  error estimate for blocks of size 2^( 4) =       0.000456235778
  error estimate for blocks of size 2^( 5) =       0.000467671872
  error estimate for blocks of size 2^( 6) =       0.000474802312
  error estimate for blocks of size 2^( 7) =       0.000477095768

      target function =                  N/A
              le_mean =     -16.905742682326
             les_mean =     286.153313444712
             stat err =       0.000468951433
             autocorr =       1.259618073539
              std dev =       0.590912834747
             le_variance =       0.349177978269


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905742882914        initial  <--
     1.4552e-01     1.4552e+00             1.5408e-03       -16.905741899628
     5.8208e-01     5.8208e+00             4.9636e-04       -16.905742326434
     2.3283e+00     2.3283e+01             1.4831e-04       -16.905742682326

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.2030
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.060571e-01 1 1  ON 0
 uu_1                 1.401429e-01 1 1  ON 1
 uu_2                 3.930288e-02 1 1  ON 2
 uu_3                -2.182649e-02 1 1  ON 3
 uu_4                -6.505771e-02 1 1  ON 4
 uu_5                -9.716105e-02 1 1  ON 5
 uu_6                -1.226360e-01 1 1  ON 6
 uu_7                -1.336040e-01 1 1  ON 7
 uu_8                -1.235897e-01 1 1  ON 8
 uu_9                -9.266371e-02 1 1  ON 9
 ud_0                 4.373117e-01 1 1  ON 10
 ud_1                 1.738123e-01 1 1  ON 11
 ud_2                 5.799934e-02 1 1  ON 12
 ud_3                -9.885732e-03 1 1  ON 13
 ud_4                -6.600766e-02 1 1  ON 14
 ud_5                -1.061996e-01 1 1  ON 15
 ud_6                -1.323565e-01 1 1  ON 16
 ud_7                -1.473753e-01 1 1  ON 17
 ud_8                -1.479779e-01 1 1  ON 18
 ud_9                -1.348696e-01 1 1  ON 19
 eO_0                -7.449232e-01 1 1  ON 20
 eO_1                -4.292040e-01 1 1  ON 21
 eO_2                -1.742938e-02 1 1  ON 22
 eO_3                 2.936022e-01 1 1  ON 23
 eO_4                 5.098214e-01 1 1  ON 24
 eO_5                 4.655502e-01 1 1  ON 25
 eO_6                 2.378086e-01 1 1  ON 26
 eO_7                -5.378992e-02 1 1  ON 27
 eO_8                -2.013217e-01 1 1  ON 28
 eO_9                -6.241713e-02 1 1  ON 29
eH1_0                -2.294492e-01 1 1  ON 30
eH1_1                -1.327583e-01 1 1  ON 31
eH1_2                -8.833755e-02 1 1  ON 32
eH1_3                -3.571733e-02 1 1  ON 33
eH1_4                 1.154408e-02 1 1  ON 34
eH1_5                 4.492289e-02 1 1  ON 35
eH1_6                 9.806686e-02 1 1  ON 36
eH1_7                 1.426745e-01 1 1  ON 37
eH1_8                 1.534151e-01 1 1  ON 38
eH1_9                 3.966682e-02 1 1  ON 39
eH2_0                -2.275258e-01 1 1  ON 40
eH2_1                -1.314761e-01 1 1  ON 41
eH2_2                -8.693584e-02 1 1  ON 42
eH2_3                -3.441530e-02 1 1  ON 43
eH2_4                 1.352797e-02 1 1  ON 44
eH2_5                 4.771316e-02 1 1  ON 45
eH2_6                 1.022325e-01 1 1  ON 46
eH2_7                 1.499697e-01 1 1  ON 47
eH2_8                 1.619291e-01 1 1  ON 48
eH2_9                 2.264891e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6610e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6912e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.9542
    reference variance = 0.379607
====================================================
  Execution time = 2.0922e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3615e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5382e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336120833255
                                         uncertainty =       0.003166170894

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336120833255
                                         uncertainty =       0.003166170894

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409970124
  error estimate for blocks of size 2^( 2) =       0.000422943959
  error estimate for blocks of size 2^( 3) =       0.000436076624
  error estimate for blocks of size 2^( 4) =       0.000447895564
  error estimate for blocks of size 2^( 5) =       0.000458298476
  error estimate for blocks of size 2^( 6) =       0.000465466543
  error estimate for blocks of size 2^( 7) =       0.000474247088

      target function =                  N/A
              le_mean =     -16.905932370841
             les_mean =     286.146700164358
             stat err =       0.000461476918
             autocorr =       1.267055236942
              std dev =       0.579785309393
             le_variance =       0.336151004988


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690593237084e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+00, overlap shift 1.4552e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905932370841       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905932617272       residual = 3.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905932183886       residual = 5.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905932444513       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905932719099       residual = 9.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905933028409       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905932887106       residual = 5.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905932909545       residual = 1.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905932936056       residual = 3.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+00 is 1.932691e-04

solving harmonic davidson linear method for identity shift 5.8208e+00, overlap shift 5.8208e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905932370841       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905932435910       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905932309563       residual = 5.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905932372710       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905932472361       residual = 6.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905932528074       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905932493654       residual = 3.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905932503529       residual = 6.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+00 is 5.099146e-05

solving harmonic davidson linear method for identity shift 2.3283e+01, overlap shift 2.3283e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905932370841       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905932387340       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905932354451       residual = 5.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905932370013       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905932397289       residual = 5.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905932409327       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905932400964       residual = 3.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905932403733       residual = 5.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+01 is 1.299107e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.119170 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6467e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.060750e-01 1 1  ON 0
 uu_1                 1.401548e-01 1 1  ON 1
 uu_2                 3.930231e-02 1 1  ON 2
 uu_3                -2.181161e-02 1 1  ON 3
 uu_4                -6.506746e-02 1 1  ON 4
 uu_5                -9.717718e-02 1 1  ON 5
 uu_6                -1.226213e-01 1 1  ON 6
 uu_7                -1.336250e-01 1 1  ON 7
 uu_8                -1.236320e-01 1 1  ON 8
 uu_9                -9.267350e-02 1 1  ON 9
 ud_0                 4.373313e-01 1 1  ON 10
 ud_1                 1.738416e-01 1 1  ON 11
 ud_2                 5.802029e-02 1 1  ON 12
 ud_3                -9.884112e-03 1 1  ON 13
 ud_4                -6.602204e-02 1 1  ON 14
 ud_5                -1.062196e-01 1 1  ON 15
 ud_6                -1.323720e-01 1 1  ON 16
 ud_7                -1.473977e-01 1 1  ON 17
 ud_8                -1.479904e-01 1 1  ON 18
 ud_9                -1.348721e-01 1 1  ON 19
 eO_0                -7.449707e-01 1 1  ON 20
 eO_1                -4.292541e-01 1 1  ON 21
 eO_2                -1.742177e-02 1 1  ON 22
 eO_3                 2.936284e-01 1 1  ON 23
 eO_4                 5.098668e-01 1 1  ON 24
 eO_5                 4.655916e-01 1 1  ON 25
 eO_6                 2.378430e-01 1 1  ON 26
 eO_7                -5.379235e-02 1 1  ON 27
 eO_8                -2.013571e-01 1 1  ON 28
 eO_9                -6.243533e-02 1 1  ON 29
eH1_0                -2.294815e-01 1 1  ON 30
eH1_1                -1.327786e-01 1 1  ON 31
eH1_2                -8.834321e-02 1 1  ON 32
eH1_3                -3.573913e-02 1 1  ON 33
eH1_4                 1.153098e-02 1 1  ON 34
eH1_5                 4.492739e-02 1 1  ON 35
eH1_6                 9.807910e-02 1 1  ON 36
eH1_7                 1.426952e-01 1 1  ON 37
eH1_8                 1.534460e-01 1 1  ON 38
eH1_9                 3.969129e-02 1 1  ON 39
eH2_0                -2.275490e-01 1 1  ON 40
eH2_1                -1.315271e-01 1 1  ON 41
eH2_2                -8.694572e-02 1 1  ON 42
eH2_3                -3.441313e-02 1 1  ON 43
eH2_4                 1.350557e-02 1 1  ON 44
eH2_5                 4.773030e-02 1 1  ON 45
eH2_6                 1.022441e-01 1 1  ON 46
eH2_7                 1.499747e-01 1 1  ON 47
eH2_8                 1.619621e-01 1 1  ON 48
eH2_9                 2.268362e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.9086
    reference variance = 0.387738
====================================================
  Execution time = 2.0656e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3083e-01
  Total weights = 2.0000e+06
  Execution time = 1.9153e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330909115541
                                         uncertainty =       0.002885850750

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330909115541
                                         uncertainty =       0.002885850750

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406712834
  error estimate for blocks of size 2^( 2) =       0.000419660073
  error estimate for blocks of size 2^( 3) =       0.000432551704
  error estimate for blocks of size 2^( 4) =       0.000445161954
  error estimate for blocks of size 2^( 5) =       0.000455224294
  error estimate for blocks of size 2^( 6) =       0.000462476320
  error estimate for blocks of size 2^( 7) =       0.000467839273

      target function =                  N/A
              le_mean =     -16.905467180233
             les_mean =     286.125651075233
             stat err =       0.000457675460
             autocorr =       1.266308434844
              std dev =       0.575178805851
             le_variance =       0.330830658700

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330920770408
                                         uncertainty =       0.002886039722

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330920770408
                                         uncertainty =       0.002886039722

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406719982
  error estimate for blocks of size 2^( 2) =       0.000419667163
  error estimate for blocks of size 2^( 3) =       0.000432556743
  error estimate for blocks of size 2^( 4) =       0.000445165527
  error estimate for blocks of size 2^( 5) =       0.000455226672
  error estimate for blocks of size 2^( 6) =       0.000462480329
  error estimate for blocks of size 2^( 7) =       0.000467845897

      target function =                  N/A
              le_mean =     -16.905467446295
             les_mean =     286.125671700376
             stat err =       0.000457679606
             autocorr =       1.266286864237
              std dev =       0.575188915117
             le_variance =       0.330842288074

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330909784845
                                         uncertainty =       0.002885910271

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330909784845
                                         uncertainty =       0.002885910271

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406713237
  error estimate for blocks of size 2^( 2) =       0.000419660658
  error estimate for blocks of size 2^( 3) =       0.000432551291
  error estimate for blocks of size 2^( 4) =       0.000445160902
  error estimate for blocks of size 2^( 5) =       0.000455222842
  error estimate for blocks of size 2^( 6) =       0.000462475892
  error estimate for blocks of size 2^( 7) =       0.000467840474

      target function =                  N/A
              le_mean =     -16.905467290838
             les_mean =     286.125655471000
             stat err =       0.000457675028
             autocorr =       1.266303529489
              std dev =       0.575179376202
             le_variance =       0.330831314808

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330909009520
                                         uncertainty =       0.002885856583

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330909009520
                                         uncertainty =       0.002885856583

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406712768
  error estimate for blocks of size 2^( 2) =       0.000419660035
  error estimate for blocks of size 2^( 3) =       0.000432551542
  error estimate for blocks of size 2^( 4) =       0.000445161716
  error estimate for blocks of size 2^( 5) =       0.000455224012
  error estimate for blocks of size 2^( 6) =       0.000462476174
  error estimate for blocks of size 2^( 7) =       0.000467839343

      target function =                  N/A
              le_mean =     -16.905467191447
             les_mean =     286.125651346786
             stat err =       0.000457675311
             autocorr =       1.266308023151
              std dev =       0.575178712310
             le_variance =       0.330830551094


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905467180233        initial
     1.4552e+00     1.4552e+01             1.9327e-04       -16.905467446295  <--
     5.8208e+00     5.8208e+01             5.0991e-05       -16.905467290838
     2.3283e+01     2.3283e+02             1.2991e-05       -16.905467191447

*****************************************************************************
Applying the update for shift_i =   1.4552e+00     and shift_s =   1.4552e+01
*****************************************************************************

  Execution time = 3.0355e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.061254e-01 1 1  ON 0
 uu_1                 1.401878e-01 1 1  ON 1
 uu_2                 3.931329e-02 1 1  ON 2
 uu_3                -2.177255e-02 1 1  ON 3
 uu_4                -6.509317e-02 1 1  ON 4
 uu_5                -9.722243e-02 1 1  ON 5
 uu_6                -1.225927e-01 1 1  ON 6
 uu_7                -1.336855e-01 1 1  ON 7
 uu_8                -1.237558e-01 1 1  ON 8
 uu_9                -9.270347e-02 1 1  ON 9
 ud_0                 4.373968e-01 1 1  ON 10
 ud_1                 1.739202e-01 1 1  ON 11
 ud_2                 5.807377e-02 1 1  ON 12
 ud_3                -9.878415e-03 1 1  ON 13
 ud_4                -6.606238e-02 1 1  ON 14
 ud_5                -1.062732e-01 1 1  ON 15
 ud_6                -1.324186e-01 1 1  ON 16
 ud_7                -1.474633e-01 1 1  ON 17
 ud_8                -1.480275e-01 1 1  ON 18
 ud_9                -1.348801e-01 1 1  ON 19
 eO_0                -7.451165e-01 1 1  ON 20
 eO_1                -4.293912e-01 1 1  ON 21
 eO_2                -1.740976e-02 1 1  ON 22
 eO_3                 2.937060e-01 1 1  ON 23
 eO_4                 5.100002e-01 1 1  ON 24
 eO_5                 4.657189e-01 1 1  ON 25
 eO_6                 2.379489e-01 1 1  ON 26
 eO_7                -5.379796e-02 1 1  ON 27
 eO_8                -2.014649e-01 1 1  ON 28
 eO_9                -6.249128e-02 1 1  ON 29
eH1_0                -2.295775e-01 1 1  ON 30
eH1_1                -1.328393e-01 1 1  ON 31
eH1_2                -8.836640e-02 1 1  ON 32
eH1_3                -3.579934e-02 1 1  ON 33
eH1_4                 1.148872e-02 1 1  ON 34
eH1_5                 4.493840e-02 1 1  ON 35
eH1_6                 9.811544e-02 1 1  ON 36
eH1_7                 1.427584e-01 1 1  ON 37
eH1_8                 1.535411e-01 1 1  ON 38
eH1_9                 3.976677e-02 1 1  ON 39
eH2_0                -2.276245e-01 1 1  ON 40
eH2_1                -1.316651e-01 1 1  ON 41
eH2_2                -8.697788e-02 1 1  ON 42
eH2_3                -3.441153e-02 1 1  ON 43
eH2_4                 1.344335e-02 1 1  ON 44
eH2_5                 4.777091e-02 1 1  ON 45
eH2_6                 1.022765e-01 1 1  ON 46
eH2_7                 1.499909e-01 1 1  ON 47
eH2_8                 1.620637e-01 1 1  ON 48
eH2_9                 2.279040e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6827e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6913e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.9264
    reference variance = 0.168676
====================================================
  Execution time = 2.0658e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.6761e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0071e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.367633508580
                                         uncertainty =       0.029029624830

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.367633508580
                                         uncertainty =       0.029029624830

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000428724915
  error estimate for blocks of size 2^( 2) =       0.000441563782
  error estimate for blocks of size 2^( 3) =       0.000454145414
  error estimate for blocks of size 2^( 4) =       0.000466338141
  error estimate for blocks of size 2^( 5) =       0.000478664857
  error estimate for blocks of size 2^( 6) =       0.000487645615
  error estimate for blocks of size 2^( 7) =       0.000492746006

      target function =                  N/A
              le_mean =     -16.905023882126
             les_mean =     286.147442377003
             stat err =       0.000481348655
             autocorr =       1.260555810228
              std dev =       0.606308589380
             le_variance =       0.367610105556


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690502388213e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e-01, overlap shift 3.6380e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905023882126       residual = 5.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905023106071       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905023986706       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905023852131       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905022513557       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905023189946       residual = 2.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905023910401       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905024275436       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905024290947       residual = 8.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e-01 is 7.846879e-04

solving harmonic davidson linear method for identity shift 1.4552e+00, overlap shift 1.4552e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905023882126       residual = 5.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905023628505       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905023955595       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905023991356       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905023630654       residual = 8.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905023675726       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905023731706       residual = 3.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905023816636       residual = 7.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+00 is 2.001085e-04

solving harmonic davidson linear method for identity shift 5.8208e+00, overlap shift 5.8208e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905023882126       residual = 5.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905023813445       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905023907540       residual = 3.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905023922420       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905023834368       residual = 7.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905023838020       residual = 7.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905023834179       residual = 2.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905023848878       residual = 4.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+00 is 5.048652e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.122014 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6672e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.062018e-01 1 1  ON 0
 uu_1                 1.401510e-01 1 1  ON 1
 uu_2                 3.930428e-02 1 1  ON 2
 uu_3                -2.173896e-02 1 1  ON 3
 uu_4                -6.511904e-02 1 1  ON 4
 uu_5                -9.730944e-02 1 1  ON 5
 uu_6                -1.225722e-01 1 1  ON 6
 uu_7                -1.337351e-01 1 1  ON 7
 uu_8                -1.238224e-01 1 1  ON 8
 uu_9                -9.272499e-02 1 1  ON 9
 ud_0                 4.375337e-01 1 1  ON 10
 ud_1                 1.739658e-01 1 1  ON 11
 ud_2                 5.810929e-02 1 1  ON 12
 ud_3                -9.850202e-03 1 1  ON 13
 ud_4                -6.608794e-02 1 1  ON 14
 ud_5                -1.063363e-01 1 1  ON 15
 ud_6                -1.325276e-01 1 1  ON 16
 ud_7                -1.474728e-01 1 1  ON 17
 ud_8                -1.480541e-01 1 1  ON 18
 ud_9                -1.348968e-01 1 1  ON 19
 eO_0                -7.452531e-01 1 1  ON 20
 eO_1                -4.295541e-01 1 1  ON 21
 eO_2                -1.751485e-02 1 1  ON 22
 eO_3                 2.937389e-01 1 1  ON 23
 eO_4                 5.101921e-01 1 1  ON 24
 eO_5                 4.659190e-01 1 1  ON 25
 eO_6                 2.380593e-01 1 1  ON 26
 eO_7                -5.376215e-02 1 1  ON 27
 eO_8                -2.015370e-01 1 1  ON 28
 eO_9                -6.257313e-02 1 1  ON 29
eH1_0                -2.296597e-01 1 1  ON 30
eH1_1                -1.329277e-01 1 1  ON 31
eH1_2                -8.841546e-02 1 1  ON 32
eH1_3                -3.583352e-02 1 1  ON 33
eH1_4                 1.143369e-02 1 1  ON 34
eH1_5                 4.485510e-02 1 1  ON 35
eH1_6                 9.807369e-02 1 1  ON 36
eH1_7                 1.428751e-01 1 1  ON 37
eH1_8                 1.537198e-01 1 1  ON 38
eH1_9                 3.990452e-02 1 1  ON 39
eH2_0                -2.277571e-01 1 1  ON 40
eH2_1                -1.316488e-01 1 1  ON 41
eH2_2                -8.705107e-02 1 1  ON 42
eH2_3                -3.442656e-02 1 1  ON 43
eH2_4                 1.337396e-02 1 1  ON 44
eH2_5                 4.774920e-02 1 1  ON 45
eH2_6                 1.022903e-01 1 1  ON 46
eH2_7                 1.500626e-01 1 1  ON 47
eH2_8                 1.621628e-01 1 1  ON 48
eH2_9                 2.290850e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.9075
    reference variance = 0.284387
====================================================
  Execution time = 2.0332e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.7134e-01
  Total weights = 2.0000e+06
  Execution time = 1.9162e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.371370740694
                                         uncertainty =       0.024831153025

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.371370740694
                                         uncertainty =       0.024831153025

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000430827106
  error estimate for blocks of size 2^( 2) =       0.000442717931
  error estimate for blocks of size 2^( 3) =       0.000454671783
  error estimate for blocks of size 2^( 4) =       0.000466383369
  error estimate for blocks of size 2^( 5) =       0.000476260898
  error estimate for blocks of size 2^( 6) =       0.000483717072
  error estimate for blocks of size 2^( 7) =       0.000487306942

      target function =                  N/A
              le_mean =     -16.904937807463
             les_mean =     286.148146079019
             stat err =       0.000478417070
             autocorr =       1.233125546789
              std dev =       0.609281536260
             le_variance =       0.371223990428

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.371642913114
                                         uncertainty =       0.024856616437

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.371642913114
                                         uncertainty =       0.024856616437

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000430984973
  error estimate for blocks of size 2^( 2) =       0.000442871890
  error estimate for blocks of size 2^( 3) =       0.000454821581
  error estimate for blocks of size 2^( 4) =       0.000466526087
  error estimate for blocks of size 2^( 5) =       0.000476396458
  error estimate for blocks of size 2^( 6) =       0.000483848129
  error estimate for blocks of size 2^( 7) =       0.000487431319

      target function =                  N/A
              le_mean =     -16.904937129438
             les_mean =     286.148395257840
             stat err =       0.000478550498
             autocorr =       1.232909759003
              std dev =       0.609504793528
             le_variance =       0.371496093333

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.371597920244
                                         uncertainty =       0.024854161283

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.371597920244
                                         uncertainty =       0.024854161283

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000430958886
  error estimate for blocks of size 2^( 2) =       0.000442845697
  error estimate for blocks of size 2^( 3) =       0.000454796049
  error estimate for blocks of size 2^( 4) =       0.000466502410
  error estimate for blocks of size 2^( 5) =       0.000476375359
  error estimate for blocks of size 2^( 6) =       0.000483828828
  error estimate for blocks of size 2^( 7) =       0.000487414315

      target function =                  N/A
              le_mean =     -16.904937366153
             les_mean =     286.148358291289
             stat err =       0.000478530228
             autocorr =       1.232954564068
              std dev =       0.609467901903
             le_variance =       0.371451123451

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.371404481207
                                         uncertainty =       0.024834658614

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.371404481207
                                         uncertainty =       0.024834658614

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000430846681
  error estimate for blocks of size 2^( 2) =       0.000442736866
  error estimate for blocks of size 2^( 3) =       0.000454690188
  error estimate for blocks of size 2^( 4) =       0.000466401018
  error estimate for blocks of size 2^( 5) =       0.000476277909
  error estimate for blocks of size 2^( 6) =       0.000483733728
  error estimate for blocks of size 2^( 7) =       0.000487322978

      target function =                  N/A
              le_mean =     -16.904937725347
             les_mean =     286.148177037215
             stat err =       0.000478433908
             autocorr =       1.233100291402
              std dev =       0.609309219520
             le_variance =       0.371257724991


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904937807463        initial  <--
     3.6380e-01     3.6380e+00             7.8469e-04       -16.904937129438
     1.4552e+00     1.4552e+01             2.0011e-04       -16.904937366153
     5.8208e+00     5.8208e+01             5.0487e-05       -16.904937725347

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0170
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.061254e-01 1 1  ON 0
 uu_1                 1.401878e-01 1 1  ON 1
 uu_2                 3.931329e-02 1 1  ON 2
 uu_3                -2.177255e-02 1 1  ON 3
 uu_4                -6.509317e-02 1 1  ON 4
 uu_5                -9.722243e-02 1 1  ON 5
 uu_6                -1.225927e-01 1 1  ON 6
 uu_7                -1.336855e-01 1 1  ON 7
 uu_8                -1.237558e-01 1 1  ON 8
 uu_9                -9.270347e-02 1 1  ON 9
 ud_0                 4.373968e-01 1 1  ON 10
 ud_1                 1.739202e-01 1 1  ON 11
 ud_2                 5.807377e-02 1 1  ON 12
 ud_3                -9.878415e-03 1 1  ON 13
 ud_4                -6.606238e-02 1 1  ON 14
 ud_5                -1.062732e-01 1 1  ON 15
 ud_6                -1.324186e-01 1 1  ON 16
 ud_7                -1.474633e-01 1 1  ON 17
 ud_8                -1.480275e-01 1 1  ON 18
 ud_9                -1.348801e-01 1 1  ON 19
 eO_0                -7.451165e-01 1 1  ON 20
 eO_1                -4.293912e-01 1 1  ON 21
 eO_2                -1.740976e-02 1 1  ON 22
 eO_3                 2.937060e-01 1 1  ON 23
 eO_4                 5.100002e-01 1 1  ON 24
 eO_5                 4.657189e-01 1 1  ON 25
 eO_6                 2.379489e-01 1 1  ON 26
 eO_7                -5.379796e-02 1 1  ON 27
 eO_8                -2.014649e-01 1 1  ON 28
 eO_9                -6.249128e-02 1 1  ON 29
eH1_0                -2.295775e-01 1 1  ON 30
eH1_1                -1.328393e-01 1 1  ON 31
eH1_2                -8.836640e-02 1 1  ON 32
eH1_3                -3.579934e-02 1 1  ON 33
eH1_4                 1.148872e-02 1 1  ON 34
eH1_5                 4.493840e-02 1 1  ON 35
eH1_6                 9.811544e-02 1 1  ON 36
eH1_7                 1.427584e-01 1 1  ON 37
eH1_8                 1.535411e-01 1 1  ON 38
eH1_9                 3.976677e-02 1 1  ON 39
eH2_0                -2.276245e-01 1 1  ON 40
eH2_1                -1.316651e-01 1 1  ON 41
eH2_2                -8.697788e-02 1 1  ON 42
eH2_3                -3.441153e-02 1 1  ON 43
eH2_4                 1.344335e-02 1 1  ON 44
eH2_5                 4.777091e-02 1 1  ON 45
eH2_6                 1.022765e-01 1 1  ON 46
eH2_7                 1.499909e-01 1 1  ON 47
eH2_8                 1.620637e-01 1 1  ON 48
eH2_9                 2.279040e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6723e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6913e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.8789
    reference variance = 0.207251
====================================================
  Execution time = 2.0753e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3565e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5079e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335716768469
                                         uncertainty =       0.003037345049

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335716768469
                                         uncertainty =       0.003037345049

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409664134
  error estimate for blocks of size 2^( 2) =       0.000422510497
  error estimate for blocks of size 2^( 3) =       0.000436202074
  error estimate for blocks of size 2^( 4) =       0.000448479192
  error estimate for blocks of size 2^( 5) =       0.000459716474
  error estimate for blocks of size 2^( 6) =       0.000466705505
  error estimate for blocks of size 2^( 7) =       0.000471459605

      target function =                  N/A
              le_mean =     -16.905216713466
             les_mean =     286.122001366455
             stat err =       0.000461590194
             autocorr =       1.269571785543
              std dev =       0.579352574029
             le_variance =       0.335649405034


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690521671347e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+00, overlap shift 3.6380e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905216713466       residual = 7.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905216881044       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905216858404       residual = 4.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905216977969       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905216864374       residual = 4.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905216879288       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905216847366       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905216880859       residual = 6.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+00 is 9.108057e-05

solving harmonic davidson linear method for identity shift 1.4552e+01, overlap shift 1.4552e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905216713466       residual = 7.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905216756318       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905216749488       residual = 4.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905216780754       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905216754520       residual = 4.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905216757953       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905216748350       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905216754948       residual = 5.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+01 is 2.303275e-05

solving harmonic davidson linear method for identity shift 5.8208e+01, overlap shift 5.8208e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905216713466       residual = 7.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905216724240       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905216722456       residual = 4.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905216730363       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905216723969       residual = 4.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905216724809       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905216722305       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905216723839       residual = 4.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+01 is 5.776110e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.124677 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6267e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.061267e-01 1 1  ON 0
 uu_1                 1.401891e-01 1 1  ON 1
 uu_2                 3.932345e-02 1 1  ON 2
 uu_3                -2.176627e-02 1 1  ON 3
 uu_4                -6.509353e-02 1 1  ON 4
 uu_5                -9.722949e-02 1 1  ON 5
 uu_6                -1.225839e-01 1 1  ON 6
 uu_7                -1.336996e-01 1 1  ON 7
 uu_8                -1.237704e-01 1 1  ON 8
 uu_9                -9.271048e-02 1 1  ON 9
 ud_0                 4.374124e-01 1 1  ON 10
 ud_1                 1.739252e-01 1 1  ON 11
 ud_2                 5.807655e-02 1 1  ON 12
 ud_3                -9.877140e-03 1 1  ON 13
 ud_4                -6.606784e-02 1 1  ON 14
 ud_5                -1.062776e-01 1 1  ON 15
 ud_6                -1.324207e-01 1 1  ON 16
 ud_7                -1.474597e-01 1 1  ON 17
 ud_8                -1.480312e-01 1 1  ON 18
 ud_9                -1.348904e-01 1 1  ON 19
 eO_0                -7.451283e-01 1 1  ON 20
 eO_1                -4.294075e-01 1 1  ON 21
 eO_2                -1.741647e-02 1 1  ON 22
 eO_3                 2.937150e-01 1 1  ON 23
 eO_4                 5.100233e-01 1 1  ON 24
 eO_5                 4.657324e-01 1 1  ON 25
 eO_6                 2.379551e-01 1 1  ON 26
 eO_7                -5.379322e-02 1 1  ON 27
 eO_8                -2.014747e-01 1 1  ON 28
 eO_9                -6.250160e-02 1 1  ON 29
eH1_0                -2.295885e-01 1 1  ON 30
eH1_1                -1.328418e-01 1 1  ON 31
eH1_2                -8.837062e-02 1 1  ON 32
eH1_3                -3.579794e-02 1 1  ON 33
eH1_4                 1.148583e-02 1 1  ON 34
eH1_5                 4.492805e-02 1 1  ON 35
eH1_6                 9.812042e-02 1 1  ON 36
eH1_7                 1.427632e-01 1 1  ON 37
eH1_8                 1.535494e-01 1 1  ON 38
eH1_9                 3.977748e-02 1 1  ON 39
eH2_0                -2.276433e-01 1 1  ON 40
eH2_1                -1.316689e-01 1 1  ON 41
eH2_2                -8.698026e-02 1 1  ON 42
eH2_3                -3.441184e-02 1 1  ON 43
eH2_4                 1.343660e-02 1 1  ON 44
eH2_5                 4.777318e-02 1 1  ON 45
eH2_6                 1.022762e-01 1 1  ON 46
eH2_7                 1.499908e-01 1 1  ON 47
eH2_8                 1.620790e-01 1 1  ON 48
eH2_9                 2.280616e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.8724
    reference variance = 0.434808
====================================================
  Execution time = 2.0302e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3867e-01
  Total weights = 2.0000e+06
  Execution time = 1.9237e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338724495279
                                         uncertainty =       0.004223796418

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338724495279
                                         uncertainty =       0.004223796418

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411499095
  error estimate for blocks of size 2^( 2) =       0.000424011224
  error estimate for blocks of size 2^( 3) =       0.000437256132
  error estimate for blocks of size 2^( 4) =       0.000448987023
  error estimate for blocks of size 2^( 5) =       0.000460144514
  error estimate for blocks of size 2^( 6) =       0.000466724093
  error estimate for blocks of size 2^( 7) =       0.000470595597

      target function =                  N/A
              le_mean =     -16.905320304133
             les_mean =     286.128517425811
             stat err =       0.000461612807
             autocorr =       1.258397742796
              std dev =       0.581947600569
             le_variance =       0.338663009808

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338747643520
                                         uncertainty =       0.004223908533

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338747643520
                                         uncertainty =       0.004223908533

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411513157
  error estimate for blocks of size 2^( 2) =       0.000424024560
  error estimate for blocks of size 2^( 3) =       0.000437268458
  error estimate for blocks of size 2^( 4) =       0.000448998877
  error estimate for blocks of size 2^( 5) =       0.000460156222
  error estimate for blocks of size 2^( 6) =       0.000466735734
  error estimate for blocks of size 2^( 7) =       0.000470607257

      target function =                  N/A
              le_mean =     -16.905319831071
             les_mean =     286.128524578122
             stat err =       0.000461624522
             autocorr =       1.258375611164
              std dev =       0.581967487634
             le_variance =       0.338686156663

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338736782549
                                         uncertainty =       0.004223864642

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338736782549
                                         uncertainty =       0.004223864642

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411506559
  error estimate for blocks of size 2^( 2) =       0.000424018305
  error estimate for blocks of size 2^( 3) =       0.000437262687
  error estimate for blocks of size 2^( 4) =       0.000448993345
  error estimate for blocks of size 2^( 5) =       0.000460150771
  error estimate for blocks of size 2^( 6) =       0.000466730331
  error estimate for blocks of size 2^( 7) =       0.000470601840

      target function =                  N/A
              le_mean =     -16.905320048673
             les_mean =     286.128521075122
             stat err =       0.000461619072
             autocorr =       1.258386245793
              std dev =       0.581958156905
             le_variance =       0.338675296389

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338726053106
                                         uncertainty =       0.004223805344

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338726053106
                                         uncertainty =       0.004223805344

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411500041
  error estimate for blocks of size 2^( 2) =       0.000424012122
  error estimate for blocks of size 2^( 3) =       0.000437256964
  error estimate for blocks of size 2^( 4) =       0.000448987825
  error estimate for blocks of size 2^( 5) =       0.000460145309
  error estimate for blocks of size 2^( 6) =       0.000466724886
  error estimate for blocks of size 2^( 7) =       0.000470596390

      target function =                  N/A
              le_mean =     -16.905320271360
             les_mean =     286.128517875479
             stat err =       0.000461613602
             autocorr =       1.258396291936
              std dev =       0.581948938953
             le_variance =       0.338664567548


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905320304133        initial  <--
     3.6380e+00     3.6380e+01             9.1081e-05       -16.905319831071
     1.4552e+01     1.4552e+02             2.3033e-05       -16.905320048673
     5.8208e+01     5.8208e+02             5.7761e-06       -16.905320271360

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0192
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.061254e-01 1 1  ON 0
 uu_1                 1.401878e-01 1 1  ON 1
 uu_2                 3.931329e-02 1 1  ON 2
 uu_3                -2.177255e-02 1 1  ON 3
 uu_4                -6.509317e-02 1 1  ON 4
 uu_5                -9.722243e-02 1 1  ON 5
 uu_6                -1.225927e-01 1 1  ON 6
 uu_7                -1.336855e-01 1 1  ON 7
 uu_8                -1.237558e-01 1 1  ON 8
 uu_9                -9.270347e-02 1 1  ON 9
 ud_0                 4.373968e-01 1 1  ON 10
 ud_1                 1.739202e-01 1 1  ON 11
 ud_2                 5.807377e-02 1 1  ON 12
 ud_3                -9.878415e-03 1 1  ON 13
 ud_4                -6.606238e-02 1 1  ON 14
 ud_5                -1.062732e-01 1 1  ON 15
 ud_6                -1.324186e-01 1 1  ON 16
 ud_7                -1.474633e-01 1 1  ON 17
 ud_8                -1.480275e-01 1 1  ON 18
 ud_9                -1.348801e-01 1 1  ON 19
 eO_0                -7.451165e-01 1 1  ON 20
 eO_1                -4.293912e-01 1 1  ON 21
 eO_2                -1.740976e-02 1 1  ON 22
 eO_3                 2.937060e-01 1 1  ON 23
 eO_4                 5.100002e-01 1 1  ON 24
 eO_5                 4.657189e-01 1 1  ON 25
 eO_6                 2.379489e-01 1 1  ON 26
 eO_7                -5.379796e-02 1 1  ON 27
 eO_8                -2.014649e-01 1 1  ON 28
 eO_9                -6.249128e-02 1 1  ON 29
eH1_0                -2.295775e-01 1 1  ON 30
eH1_1                -1.328393e-01 1 1  ON 31
eH1_2                -8.836640e-02 1 1  ON 32
eH1_3                -3.579934e-02 1 1  ON 33
eH1_4                 1.148872e-02 1 1  ON 34
eH1_5                 4.493840e-02 1 1  ON 35
eH1_6                 9.811544e-02 1 1  ON 36
eH1_7                 1.427584e-01 1 1  ON 37
eH1_8                 1.535411e-01 1 1  ON 38
eH1_9                 3.976677e-02 1 1  ON 39
eH2_0                -2.276245e-01 1 1  ON 40
eH2_1                -1.316651e-01 1 1  ON 41
eH2_2                -8.697788e-02 1 1  ON 42
eH2_3                -3.441153e-02 1 1  ON 43
eH2_4                 1.344335e-02 1 1  ON 44
eH2_5                 4.777091e-02 1 1  ON 45
eH2_6                 1.022765e-01 1 1  ON 46
eH2_7                 1.499909e-01 1 1  ON 47
eH2_8                 1.620637e-01 1 1  ON 48
eH2_9                 2.279040e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6292e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6912e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.8827
    reference variance = 0.230333
====================================================
  Execution time = 2.0718e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4348e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5058e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343528468987
                                         uncertainty =       0.009187171647

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343528468987
                                         uncertainty =       0.009187171647

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414414655
  error estimate for blocks of size 2^( 2) =       0.000427103081
  error estimate for blocks of size 2^( 3) =       0.000440438722
  error estimate for blocks of size 2^( 4) =       0.000452437825
  error estimate for blocks of size 2^( 5) =       0.000462757595
  error estimate for blocks of size 2^( 6) =       0.000470519637
  error estimate for blocks of size 2^( 7) =       0.000475002244

      target function =                  N/A
              le_mean =     -16.905568543372
             les_mean =     286.141726615113
             stat err =       0.000465179325
             autocorr =       1.260000157244
              std dev =       0.586070825237
             le_variance =       0.343479012194


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690556854337e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+01, overlap shift 3.6380e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905568543372       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905568552987       residual = 4.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905568579377       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905568572504       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905568572550       residual = 5.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905568587201       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905568575404       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905568577649       residual = 4.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+01 is 9.047133e-06

solving harmonic davidson linear method for identity shift 1.4552e+02, overlap shift 1.4552e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905568543372       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905568545789       residual = 4.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905568552445       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905568550745       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905568550804       residual = 5.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905568554452       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905568551456       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905568552007       residual = 4.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+02 is 2.266428e-06

solving harmonic davidson linear method for identity shift 5.8208e+02, overlap shift 5.8208e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905568543372       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905568543977       residual = 4.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905568545645       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905568545221       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905568545239       residual = 5.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905568546150       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905568545398       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905568545536       residual = 4.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+02 is 5.669000e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.127376 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6230e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.061264e-01 1 1  ON 0
 uu_1                 1.401886e-01 1 1  ON 1
 uu_2                 3.931328e-02 1 1  ON 2
 uu_3                -2.177240e-02 1 1  ON 3
 uu_4                -6.509298e-02 1 1  ON 4
 uu_5                -9.722305e-02 1 1  ON 5
 uu_6                -1.225924e-01 1 1  ON 6
 uu_7                -1.336862e-01 1 1  ON 7
 uu_8                -1.237572e-01 1 1  ON 8
 uu_9                -9.270456e-02 1 1  ON 9
 ud_0                 4.373984e-01 1 1  ON 10
 ud_1                 1.739209e-01 1 1  ON 11
 ud_2                 5.807386e-02 1 1  ON 12
 ud_3                -9.878100e-03 1 1  ON 13
 ud_4                -6.606276e-02 1 1  ON 14
 ud_5                -1.062731e-01 1 1  ON 15
 ud_6                -1.324183e-01 1 1  ON 16
 ud_7                -1.474639e-01 1 1  ON 17
 ud_8                -1.480284e-01 1 1  ON 18
 ud_9                -1.348808e-01 1 1  ON 19
 eO_0                -7.451188e-01 1 1  ON 20
 eO_1                -4.293919e-01 1 1  ON 21
 eO_2                -1.741033e-02 1 1  ON 22
 eO_3                 2.937070e-01 1 1  ON 23
 eO_4                 5.100016e-01 1 1  ON 24
 eO_5                 4.657209e-01 1 1  ON 25
 eO_6                 2.379507e-01 1 1  ON 26
 eO_7                -5.379782e-02 1 1  ON 27
 eO_8                -2.014664e-01 1 1  ON 28
 eO_9                -6.249223e-02 1 1  ON 29
eH1_0                -2.295785e-01 1 1  ON 30
eH1_1                -1.328391e-01 1 1  ON 31
eH1_2                -8.836736e-02 1 1  ON 32
eH1_3                -3.579976e-02 1 1  ON 33
eH1_4                 1.148808e-02 1 1  ON 34
eH1_5                 4.493805e-02 1 1  ON 35
eH1_6                 9.811532e-02 1 1  ON 36
eH1_7                 1.427590e-01 1 1  ON 37
eH1_8                 1.535426e-01 1 1  ON 38
eH1_9                 3.976796e-02 1 1  ON 39
eH2_0                -2.276261e-01 1 1  ON 40
eH2_1                -1.316656e-01 1 1  ON 41
eH2_2                -8.697869e-02 1 1  ON 42
eH2_3                -3.441190e-02 1 1  ON 43
eH2_4                 1.344354e-02 1 1  ON 44
eH2_5                 4.777046e-02 1 1  ON 45
eH2_6                 1.022768e-01 1 1  ON 46
eH2_7                 1.499915e-01 1 1  ON 47
eH2_8                 1.620648e-01 1 1  ON 48
eH2_9                 2.279183e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.9111
    reference variance = 0.222781
====================================================
  Execution time = 2.0547e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4599e-01
  Total weights = 2.0000e+06
  Execution time = 1.9293e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345512804022
                                         uncertainty =       0.004577994787

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345512804022
                                         uncertainty =       0.004577994787

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415924195
  error estimate for blocks of size 2^( 2) =       0.000428375246
  error estimate for blocks of size 2^( 3) =       0.000441220787
  error estimate for blocks of size 2^( 4) =       0.000452941229
  error estimate for blocks of size 2^( 5) =       0.000463680168
  error estimate for blocks of size 2^( 6) =       0.000469355530
  error estimate for blocks of size 2^( 7) =       0.000473218517

      target function =                  N/A
              le_mean =     -16.906450121223
             les_mean =     286.174041400104
             stat err =       0.000464798861
             autocorr =       1.248825449734
              std dev =       0.588205637257
             le_variance =       0.345985871701

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345519382093
                                         uncertainty =       0.004578091371

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345519382093
                                         uncertainty =       0.004578091371

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415928157
  error estimate for blocks of size 2^( 2) =       0.000428379002
  error estimate for blocks of size 2^( 3) =       0.000441224303
  error estimate for blocks of size 2^( 4) =       0.000452944514
  error estimate for blocks of size 2^( 5) =       0.000463683313
  error estimate for blocks of size 2^( 6) =       0.000469358631
  error estimate for blocks of size 2^( 7) =       0.000473221688

      target function =                  N/A
              le_mean =     -16.906450118682
             les_mean =     286.174047905857
             stat err =       0.000464802036
             autocorr =       1.248818722299
              std dev =       0.588211240424
             le_variance =       0.345992463361

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345516114145
                                         uncertainty =       0.004578043445

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345516114145
                                         uncertainty =       0.004578043445

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415926189
  error estimate for blocks of size 2^( 2) =       0.000428377136
  error estimate for blocks of size 2^( 3) =       0.000441222556
  error estimate for blocks of size 2^( 4) =       0.000452942882
  error estimate for blocks of size 2^( 5) =       0.000463681751
  error estimate for blocks of size 2^( 6) =       0.000469357091
  error estimate for blocks of size 2^( 7) =       0.000473220113

      target function =                  N/A
              le_mean =     -16.906450119946
             les_mean =     286.174044673917
             stat err =       0.000464800459
             autocorr =       1.248822066993
              std dev =       0.588208456819
             le_variance =       0.345989188673

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345513218440
                                         uncertainty =       0.004578000881

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345513218440
                                         uncertainty =       0.004578000881

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415924444
  error estimate for blocks of size 2^( 2) =       0.000428375483
  error estimate for blocks of size 2^( 3) =       0.000441221009
  error estimate for blocks of size 2^( 4) =       0.000452941436
  error estimate for blocks of size 2^( 5) =       0.000463680366
  error estimate for blocks of size 2^( 6) =       0.000469355725
  error estimate for blocks of size 2^( 7) =       0.000473218717

      target function =                  N/A
              le_mean =     -16.906450121061
             les_mean =     286.174041809923
             stat err =       0.000464799061
             autocorr =       1.248825026288
              std dev =       0.588205990259
             le_variance =       0.345986286977


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906450121223        initial  <--
     3.6380e+01     3.6380e+02             9.0471e-06       -16.906450118682
     1.4552e+02     1.4552e+03             2.2664e-06       -16.906450119946
     5.8208e+02     5.8208e+03             5.6690e-07       -16.906450121061

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.2955
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.061254e-01 1 1  ON 0
 uu_1                 1.401878e-01 1 1  ON 1
 uu_2                 3.931329e-02 1 1  ON 2
 uu_3                -2.177255e-02 1 1  ON 3
 uu_4                -6.509317e-02 1 1  ON 4
 uu_5                -9.722243e-02 1 1  ON 5
 uu_6                -1.225927e-01 1 1  ON 6
 uu_7                -1.336855e-01 1 1  ON 7
 uu_8                -1.237558e-01 1 1  ON 8
 uu_9                -9.270347e-02 1 1  ON 9
 ud_0                 4.373968e-01 1 1  ON 10
 ud_1                 1.739202e-01 1 1  ON 11
 ud_2                 5.807377e-02 1 1  ON 12
 ud_3                -9.878415e-03 1 1  ON 13
 ud_4                -6.606238e-02 1 1  ON 14
 ud_5                -1.062732e-01 1 1  ON 15
 ud_6                -1.324186e-01 1 1  ON 16
 ud_7                -1.474633e-01 1 1  ON 17
 ud_8                -1.480275e-01 1 1  ON 18
 ud_9                -1.348801e-01 1 1  ON 19
 eO_0                -7.451165e-01 1 1  ON 20
 eO_1                -4.293912e-01 1 1  ON 21
 eO_2                -1.740976e-02 1 1  ON 22
 eO_3                 2.937060e-01 1 1  ON 23
 eO_4                 5.100002e-01 1 1  ON 24
 eO_5                 4.657189e-01 1 1  ON 25
 eO_6                 2.379489e-01 1 1  ON 26
 eO_7                -5.379796e-02 1 1  ON 27
 eO_8                -2.014649e-01 1 1  ON 28
 eO_9                -6.249128e-02 1 1  ON 29
eH1_0                -2.295775e-01 1 1  ON 30
eH1_1                -1.328393e-01 1 1  ON 31
eH1_2                -8.836640e-02 1 1  ON 32
eH1_3                -3.579934e-02 1 1  ON 33
eH1_4                 1.148872e-02 1 1  ON 34
eH1_5                 4.493840e-02 1 1  ON 35
eH1_6                 9.811544e-02 1 1  ON 36
eH1_7                 1.427584e-01 1 1  ON 37
eH1_8                 1.535411e-01 1 1  ON 38
eH1_9                 3.976677e-02 1 1  ON 39
eH2_0                -2.276245e-01 1 1  ON 40
eH2_1                -1.316651e-01 1 1  ON 41
eH2_2                -8.697788e-02 1 1  ON 42
eH2_3                -3.441153e-02 1 1  ON 43
eH2_4                 1.344335e-02 1 1  ON 44
eH2_5                 4.777091e-02 1 1  ON 45
eH2_6                 1.022765e-01 1 1  ON 46
eH2_7                 1.499909e-01 1 1  ON 47
eH2_8                 1.620637e-01 1 1  ON 48
eH2_9                 2.279040e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6531e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6912e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.0476
    reference variance = 0.456084
====================================================
  Execution time = 2.0660e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3233e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4789e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332336965396
                                         uncertainty =       0.002777415562

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332336965396
                                         uncertainty =       0.002777415562

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407631453
  error estimate for blocks of size 2^( 2) =       0.000420813790
  error estimate for blocks of size 2^( 3) =       0.000433762669
  error estimate for blocks of size 2^( 4) =       0.000446194743
  error estimate for blocks of size 2^( 5) =       0.000457898383
  error estimate for blocks of size 2^( 6) =       0.000466794193
  error estimate for blocks of size 2^( 7) =       0.000472612882

      target function =                  N/A
              le_mean =     -16.905782737586
             les_mean =     286.137816607932
             stat err =       0.000460875050
             autocorr =       1.278294797292
              std dev =       0.576477929877
             le_variance =       0.332326803635


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690578273759e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+02, overlap shift 3.6380e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905782737586       residual = 8.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905782739568       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905782739981       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905782744411       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905782743040       residual = 4.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905782743245       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905782743555       residual = 7.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+02 is 8.628950e-07

solving harmonic davidson linear method for identity shift 1.4552e+03, overlap shift 1.4552e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905782737586       residual = 8.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905782738082       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905782738185       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905782739293       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905782738951       residual = 4.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905782739002       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905782739079       residual = 7.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+03 is 2.157438e-07

solving harmonic davidson linear method for identity shift 5.8208e+03, overlap shift 5.8208e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905782737586       residual = 8.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905782737710       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905782737736       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905782738012       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905782737927       residual = 4.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905782737939       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905782737963       residual = 7.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+03 is 5.393719e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.129657 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6145e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.061255e-01 1 1  ON 0
 uu_1                 1.401879e-01 1 1  ON 1
 uu_2                 3.931332e-02 1 1  ON 2
 uu_3                -2.177254e-02 1 1  ON 3
 uu_4                -6.509320e-02 1 1  ON 4
 uu_5                -9.722259e-02 1 1  ON 5
 uu_6                -1.225927e-01 1 1  ON 6
 uu_7                -1.336856e-01 1 1  ON 7
 uu_8                -1.237559e-01 1 1  ON 8
 uu_9                -9.270346e-02 1 1  ON 9
 ud_0                 4.373969e-01 1 1  ON 10
 ud_1                 1.739202e-01 1 1  ON 11
 ud_2                 5.807377e-02 1 1  ON 12
 ud_3                -9.878406e-03 1 1  ON 13
 ud_4                -6.606242e-02 1 1  ON 14
 ud_5                -1.062732e-01 1 1  ON 15
 ud_6                -1.324186e-01 1 1  ON 16
 ud_7                -1.474634e-01 1 1  ON 17
 ud_8                -1.480274e-01 1 1  ON 18
 ud_9                -1.348801e-01 1 1  ON 19
 eO_0                -7.451166e-01 1 1  ON 20
 eO_1                -4.293913e-01 1 1  ON 21
 eO_2                -1.740983e-02 1 1  ON 22
 eO_3                 2.937061e-01 1 1  ON 23
 eO_4                 5.100004e-01 1 1  ON 24
 eO_5                 4.657191e-01 1 1  ON 25
 eO_6                 2.379490e-01 1 1  ON 26
 eO_7                -5.379793e-02 1 1  ON 27
 eO_8                -2.014650e-01 1 1  ON 28
 eO_9                -6.249134e-02 1 1  ON 29
eH1_0                -2.295776e-01 1 1  ON 30
eH1_1                -1.328394e-01 1 1  ON 31
eH1_2                -8.836644e-02 1 1  ON 32
eH1_3                -3.579938e-02 1 1  ON 33
eH1_4                 1.148868e-02 1 1  ON 34
eH1_5                 4.493828e-02 1 1  ON 35
eH1_6                 9.811548e-02 1 1  ON 36
eH1_7                 1.427585e-01 1 1  ON 37
eH1_8                 1.535413e-01 1 1  ON 38
eH1_9                 3.976688e-02 1 1  ON 39
eH2_0                -2.276247e-01 1 1  ON 40
eH2_1                -1.316652e-01 1 1  ON 41
eH2_2                -8.697790e-02 1 1  ON 42
eH2_3                -3.441145e-02 1 1  ON 43
eH2_4                 1.344328e-02 1 1  ON 44
eH2_5                 4.777093e-02 1 1  ON 45
eH2_6                 1.022765e-01 1 1  ON 46
eH2_7                 1.499909e-01 1 1  ON 47
eH2_8                 1.620638e-01 1 1  ON 48
eH2_9                 2.279056e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.9268
    reference variance = 0.225479
====================================================
  Execution time = 2.0637e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3540e-01
  Total weights = 2.0000e+06
  Execution time = 1.9362e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335446912562
                                         uncertainty =       0.003691242848

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335446912562
                                         uncertainty =       0.003691242848

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409512460
  error estimate for blocks of size 2^( 2) =       0.000422290229
  error estimate for blocks of size 2^( 3) =       0.000435309631
  error estimate for blocks of size 2^( 4) =       0.000446843795
  error estimate for blocks of size 2^( 5) =       0.000457775922
  error estimate for blocks of size 2^( 6) =       0.000465323854
  error estimate for blocks of size 2^( 7) =       0.000467418949

      target function =                  N/A
              le_mean =     -16.905397250780
             les_mean =     286.127856948083
             stat err =       0.000459340630
             autocorr =       1.258158870094
              std dev =       0.579138074303
             le_variance =       0.335400909108

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335447463019
                                         uncertainty =       0.003691247845

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335447463019
                                         uncertainty =       0.003691247845

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409512796
  error estimate for blocks of size 2^( 2) =       0.000422290548
  error estimate for blocks of size 2^( 3) =       0.000435309936
  error estimate for blocks of size 2^( 4) =       0.000446844091
  error estimate for blocks of size 2^( 5) =       0.000457776212
  error estimate for blocks of size 2^( 6) =       0.000465324143
  error estimate for blocks of size 2^( 7) =       0.000467419222

      target function =                  N/A
              le_mean =     -16.905397248877
             les_mean =     286.127857434418
             stat err =       0.000459340917
             autocorr =       1.258158376894
              std dev =       0.579138549721
             le_variance =       0.335401459773

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335447188014
                                         uncertainty =       0.003691245349

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335447188014
                                         uncertainty =       0.003691245349

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409512628
  error estimate for blocks of size 2^( 2) =       0.000422290388
  error estimate for blocks of size 2^( 3) =       0.000435309783
  error estimate for blocks of size 2^( 4) =       0.000446843943
  error estimate for blocks of size 2^( 5) =       0.000457776068
  error estimate for blocks of size 2^( 6) =       0.000465323998
  error estimate for blocks of size 2^( 7) =       0.000467419086

      target function =                  N/A
              le_mean =     -16.905397249827
             les_mean =     286.127857191427
             stat err =       0.000459340774
             autocorr =       1.258158623309
              std dev =       0.579138312205
             le_variance =       0.335401184664

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335446947000
                                         uncertainty =       0.003691243161

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335446947000
                                         uncertainty =       0.003691243161

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409512481
  error estimate for blocks of size 2^( 2) =       0.000422290249
  error estimate for blocks of size 2^( 3) =       0.000435309650
  error estimate for blocks of size 2^( 4) =       0.000446843813
  error estimate for blocks of size 2^( 5) =       0.000457775941
  error estimate for blocks of size 2^( 6) =       0.000465323872
  error estimate for blocks of size 2^( 7) =       0.000467418966

      target function =                  N/A
              le_mean =     -16.905397250661
             les_mean =     286.127856978506
             stat err =       0.000459340648
             autocorr =       1.258158839242
              std dev =       0.579138104047
             le_variance =       0.335400943559


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905397250780        initial  <--
     3.6380e+02     3.6380e+03             8.6290e-07       -16.905397248877
     1.4552e+03     1.4552e+04             2.1574e-07       -16.905397249827
     5.8208e+03     5.8208e+04             5.3937e-08       -16.905397250661

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.3784
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.061254e-01 1 1  ON 0
 uu_1                 1.401878e-01 1 1  ON 1
 uu_2                 3.931329e-02 1 1  ON 2
 uu_3                -2.177255e-02 1 1  ON 3
 uu_4                -6.509317e-02 1 1  ON 4
 uu_5                -9.722243e-02 1 1  ON 5
 uu_6                -1.225927e-01 1 1  ON 6
 uu_7                -1.336855e-01 1 1  ON 7
 uu_8                -1.237558e-01 1 1  ON 8
 uu_9                -9.270347e-02 1 1  ON 9
 ud_0                 4.373968e-01 1 1  ON 10
 ud_1                 1.739202e-01 1 1  ON 11
 ud_2                 5.807377e-02 1 1  ON 12
 ud_3                -9.878415e-03 1 1  ON 13
 ud_4                -6.606238e-02 1 1  ON 14
 ud_5                -1.062732e-01 1 1  ON 15
 ud_6                -1.324186e-01 1 1  ON 16
 ud_7                -1.474633e-01 1 1  ON 17
 ud_8                -1.480275e-01 1 1  ON 18
 ud_9                -1.348801e-01 1 1  ON 19
 eO_0                -7.451165e-01 1 1  ON 20
 eO_1                -4.293912e-01 1 1  ON 21
 eO_2                -1.740976e-02 1 1  ON 22
 eO_3                 2.937060e-01 1 1  ON 23
 eO_4                 5.100002e-01 1 1  ON 24
 eO_5                 4.657189e-01 1 1  ON 25
 eO_6                 2.379489e-01 1 1  ON 26
 eO_7                -5.379796e-02 1 1  ON 27
 eO_8                -2.014649e-01 1 1  ON 28
 eO_9                -6.249128e-02 1 1  ON 29
eH1_0                -2.295775e-01 1 1  ON 30
eH1_1                -1.328393e-01 1 1  ON 31
eH1_2                -8.836640e-02 1 1  ON 32
eH1_3                -3.579934e-02 1 1  ON 33
eH1_4                 1.148872e-02 1 1  ON 34
eH1_5                 4.493840e-02 1 1  ON 35
eH1_6                 9.811544e-02 1 1  ON 36
eH1_7                 1.427584e-01 1 1  ON 37
eH1_8                 1.535411e-01 1 1  ON 38
eH1_9                 3.976677e-02 1 1  ON 39
eH2_0                -2.276245e-01 1 1  ON 40
eH2_1                -1.316651e-01 1 1  ON 41
eH2_2                -8.697788e-02 1 1  ON 42
eH2_3                -3.441153e-02 1 1  ON 43
eH2_4                 1.344335e-02 1 1  ON 44
eH2_5                 4.777091e-02 1 1  ON 45
eH2_6                 1.022765e-01 1 1  ON 46
eH2_7                 1.499909e-01 1 1  ON 47
eH2_8                 1.620637e-01 1 1  ON 48
eH2_9                 2.279040e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6529e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6914e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.8253
    reference variance = 0.578206
====================================================
  Execution time = 2.0938e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3347e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5281e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333439040345
                                         uncertainty =       0.002945648667

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333439040345
                                         uncertainty =       0.002945648667

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408330272
  error estimate for blocks of size 2^( 2) =       0.000421585190
  error estimate for blocks of size 2^( 3) =       0.000434825373
  error estimate for blocks of size 2^( 4) =       0.000448604041
  error estimate for blocks of size 2^( 5) =       0.000460827514
  error estimate for blocks of size 2^( 6) =       0.000470603883
  error estimate for blocks of size 2^( 7) =       0.000475133732

      target function =                  N/A
              le_mean =     -16.904927085556
             les_mean =     286.110026822719
             stat err =       0.000463792293
             autocorr =       1.290101555604
              std dev =       0.577466208093
             le_variance =       0.333467221489


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690492708556e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+03, overlap shift 3.6380e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904927085556       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904927085943       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904927085819       residual = 5.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904927085817       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904927085872       residual = 6.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904927085845       residual = 8.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904927085855       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904927085879       residual = 4.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+03 is 1.050034e-07

solving harmonic davidson linear method for identity shift 1.4552e+04, overlap shift 1.4552e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904927085556       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904927085653       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904927085622       residual = 5.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904927085621       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904927085633       residual = 6.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904927085635       residual = 8.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904927085631       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904927085630       residual = 4.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+04 is 2.625092e-08

solving harmonic davidson linear method for identity shift 5.8208e+04, overlap shift 5.8208e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904927085556       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904927085580       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904927085572       residual = 5.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904927085572       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904927085603       residual = 6.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904927085574       residual = 8.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904927085585       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904927085600       residual = 4.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+04 is 6.562734e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.132361 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6473e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.061254e-01 1 1  ON 0
 uu_1                 1.401878e-01 1 1  ON 1
 uu_2                 3.931329e-02 1 1  ON 2
 uu_3                -2.177256e-02 1 1  ON 3
 uu_4                -6.509317e-02 1 1  ON 4
 uu_5                -9.722243e-02 1 1  ON 5
 uu_6                -1.225927e-01 1 1  ON 6
 uu_7                -1.336855e-01 1 1  ON 7
 uu_8                -1.237558e-01 1 1  ON 8
 uu_9                -9.270346e-02 1 1  ON 9
 ud_0                 4.373968e-01 1 1  ON 10
 ud_1                 1.739202e-01 1 1  ON 11
 ud_2                 5.807377e-02 1 1  ON 12
 ud_3                -9.878417e-03 1 1  ON 13
 ud_4                -6.606238e-02 1 1  ON 14
 ud_5                -1.062732e-01 1 1  ON 15
 ud_6                -1.324186e-01 1 1  ON 16
 ud_7                -1.474633e-01 1 1  ON 17
 ud_8                -1.480275e-01 1 1  ON 18
 ud_9                -1.348801e-01 1 1  ON 19
 eO_0                -7.451165e-01 1 1  ON 20
 eO_1                -4.293912e-01 1 1  ON 21
 eO_2                -1.740976e-02 1 1  ON 22
 eO_3                 2.937060e-01 1 1  ON 23
 eO_4                 5.100003e-01 1 1  ON 24
 eO_5                 4.657189e-01 1 1  ON 25
 eO_6                 2.379489e-01 1 1  ON 26
 eO_7                -5.379796e-02 1 1  ON 27
 eO_8                -2.014650e-01 1 1  ON 28
 eO_9                -6.249129e-02 1 1  ON 29
eH1_0                -2.295775e-01 1 1  ON 30
eH1_1                -1.328393e-01 1 1  ON 31
eH1_2                -8.836642e-02 1 1  ON 32
eH1_3                -3.579935e-02 1 1  ON 33
eH1_4                 1.148872e-02 1 1  ON 34
eH1_5                 4.493839e-02 1 1  ON 35
eH1_6                 9.811544e-02 1 1  ON 36
eH1_7                 1.427584e-01 1 1  ON 37
eH1_8                 1.535412e-01 1 1  ON 38
eH1_9                 3.976679e-02 1 1  ON 39
eH2_0                -2.276245e-01 1 1  ON 40
eH2_1                -1.316651e-01 1 1  ON 41
eH2_2                -8.697789e-02 1 1  ON 42
eH2_3                -3.441154e-02 1 1  ON 43
eH2_4                 1.344334e-02 1 1  ON 44
eH2_5                 4.777091e-02 1 1  ON 45
eH2_6                 1.022765e-01 1 1  ON 46
eH2_7                 1.499909e-01 1 1  ON 47
eH2_8                 1.620637e-01 1 1  ON 48
eH2_9                 2.279042e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.8983
    reference variance = 0.287838
====================================================
  Execution time = 2.0734e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3929e-01
  Total weights = 2.0000e+06
  Execution time = 1.9515e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339324247246
                                         uncertainty =       0.003537545876

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339324247246
                                         uncertainty =       0.003537545876

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411876940
  error estimate for blocks of size 2^( 2) =       0.000424636192
  error estimate for blocks of size 2^( 3) =       0.000438079679
  error estimate for blocks of size 2^( 4) =       0.000451057398
  error estimate for blocks of size 2^( 5) =       0.000462390628
  error estimate for blocks of size 2^( 6) =       0.000471428798
  error estimate for blocks of size 2^( 7) =       0.000474866882

      target function =                  N/A
              le_mean =     -16.904619636761
             les_mean =     286.105450120649
             stat err =       0.000464935927
             autocorr =       1.274240071835
              std dev =       0.582481954000
             le_variance =       0.339285226736

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339324315088
                                         uncertainty =       0.003537546335

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339324315088
                                         uncertainty =       0.003537546335

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411876981
  error estimate for blocks of size 2^( 2) =       0.000424636231
  error estimate for blocks of size 2^( 3) =       0.000438079715
  error estimate for blocks of size 2^( 4) =       0.000451057433
  error estimate for blocks of size 2^( 5) =       0.000462390661
  error estimate for blocks of size 2^( 6) =       0.000471428829
  error estimate for blocks of size 2^( 7) =       0.000474866913

      target function =                  N/A
              le_mean =     -16.904619636959
             les_mean =     286.105450195184
             stat err =       0.000464935959
             autocorr =       1.274239993576
              std dev =       0.582482012237
             le_variance =       0.339285294580

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339324281169
                                         uncertainty =       0.003537546105

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339324281169
                                         uncertainty =       0.003537546105

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411876960
  error estimate for blocks of size 2^( 2) =       0.000424636211
  error estimate for blocks of size 2^( 3) =       0.000438079697
  error estimate for blocks of size 2^( 4) =       0.000451057415
  error estimate for blocks of size 2^( 5) =       0.000462390645
  error estimate for blocks of size 2^( 6) =       0.000471428813
  error estimate for blocks of size 2^( 7) =       0.000474866898

      target function =                  N/A
              le_mean =     -16.904619636860
             les_mean =     286.105450157920
             stat err =       0.000464935943
             autocorr =       1.274240032691
              std dev =       0.582481983121
             le_variance =       0.339285260660

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339324251486
                                         uncertainty =       0.003537545905

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339324251486
                                         uncertainty =       0.003537545905

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411876942
  error estimate for blocks of size 2^( 2) =       0.000424636194
  error estimate for blocks of size 2^( 3) =       0.000438079681
  error estimate for blocks of size 2^( 4) =       0.000451057400
  error estimate for blocks of size 2^( 5) =       0.000462390630
  error estimate for blocks of size 2^( 6) =       0.000471428800
  error estimate for blocks of size 2^( 7) =       0.000474866884

      target function =                  N/A
              le_mean =     -16.904619636773
             les_mean =     286.105450125308
             stat err =       0.000464935929
             autocorr =       1.274240066937
              std dev =       0.582481957640
             le_variance =       0.339285230977


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904619636761        initial
     3.6380e+03     3.6380e+04             1.0500e-07       -16.904619636959  <--
     1.4552e+04     1.4552e+05             2.6251e-08       -16.904619636860
     5.8208e+04     5.8208e+05             6.5627e-09       -16.904619636773

*****************************************************************************
Applying the update for shift_i =   3.6380e+03     and shift_s =   3.6380e+04
*****************************************************************************

  Execution time = 3.0491e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.061255e-01 1 1  ON 0
 uu_1                 1.401879e-01 1 1  ON 1
 uu_2                 3.931331e-02 1 1  ON 2
 uu_3                -2.177256e-02 1 1  ON 3
 uu_4                -6.509320e-02 1 1  ON 4
 uu_5                -9.722246e-02 1 1  ON 5
 uu_6                -1.225927e-01 1 1  ON 6
 uu_7                -1.336856e-01 1 1  ON 7
 uu_8                -1.237558e-01 1 1  ON 8
 uu_9                -9.270345e-02 1 1  ON 9
 ud_0                 4.373968e-01 1 1  ON 10
 ud_1                 1.739202e-01 1 1  ON 11
 ud_2                 5.807378e-02 1 1  ON 12
 ud_3                -9.878422e-03 1 1  ON 13
 ud_4                -6.606241e-02 1 1  ON 14
 ud_5                -1.062732e-01 1 1  ON 15
 ud_6                -1.324187e-01 1 1  ON 16
 ud_7                -1.474634e-01 1 1  ON 17
 ud_8                -1.480275e-01 1 1  ON 18
 ud_9                -1.348801e-01 1 1  ON 19
 eO_0                -7.451165e-01 1 1  ON 20
 eO_1                -4.293913e-01 1 1  ON 21
 eO_2                -1.740977e-02 1 1  ON 22
 eO_3                 2.937060e-01 1 1  ON 23
 eO_4                 5.100003e-01 1 1  ON 24
 eO_5                 4.657190e-01 1 1  ON 25
 eO_6                 2.379490e-01 1 1  ON 26
 eO_7                -5.379794e-02 1 1  ON 27
 eO_8                -2.014650e-01 1 1  ON 28
 eO_9                -6.249131e-02 1 1  ON 29
eH1_0                -2.295775e-01 1 1  ON 30
eH1_1                -1.328393e-01 1 1  ON 31
eH1_2                -8.836647e-02 1 1  ON 32
eH1_3                -3.579938e-02 1 1  ON 33
eH1_4                 1.148873e-02 1 1  ON 34
eH1_5                 4.493838e-02 1 1  ON 35
eH1_6                 9.811544e-02 1 1  ON 36
eH1_7                 1.427584e-01 1 1  ON 37
eH1_8                 1.535412e-01 1 1  ON 38
eH1_9                 3.976682e-02 1 1  ON 39
eH2_0                -2.276246e-01 1 1  ON 40
eH2_1                -1.316651e-01 1 1  ON 41
eH2_2                -8.697790e-02 1 1  ON 42
eH2_3                -3.441155e-02 1 1  ON 43
eH2_4                 1.344332e-02 1 1  ON 44
eH2_5                 4.777090e-02 1 1  ON 45
eH2_6                 1.022765e-01 1 1  ON 46
eH2_7                 1.499909e-01 1 1  ON 47
eH2_8                 1.620638e-01 1 1  ON 48
eH2_9                 2.279047e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6969e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6912e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.944
    reference variance = 0.373618
====================================================
  Execution time = 2.1063e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3614e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6157e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336116209451
                                         uncertainty =       0.003646043834

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336116209451
                                         uncertainty =       0.003646043834

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409963571
  error estimate for blocks of size 2^( 2) =       0.000422688361
  error estimate for blocks of size 2^( 3) =       0.000435466091
  error estimate for blocks of size 2^( 4) =       0.000448012044
  error estimate for blocks of size 2^( 5) =       0.000458886762
  error estimate for blocks of size 2^( 6) =       0.000467719264
  error estimate for blocks of size 2^( 7) =       0.000472799578

      target function =                  N/A
              le_mean =     -16.905566957755
             les_mean =     286.134334253671
             stat err =       0.000461854412
             autocorr =       1.269169593464
              std dev =       0.579776041772
             le_variance =       0.336140258613


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690556695775e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+02, overlap shift 9.0949e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905566957755       residual = 8.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905566958217       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905566959266       residual = 7.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905566958872       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905566959056       residual = 5.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905566959004       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905566959433       residual = 2.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905566959380       residual = 5.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+02 is 3.281164e-07

solving harmonic davidson linear method for identity shift 3.6380e+03, overlap shift 3.6380e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905566957755       residual = 8.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905566957870       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905566958133       residual = 7.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905566958036       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905566958080       residual = 5.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905566958065       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905566958177       residual = 2.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905566958160       residual = 5.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+03 is 8.203162e-08

solving harmonic davidson linear method for identity shift 1.4552e+04, overlap shift 1.4552e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905566957755       residual = 8.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905566957784       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905566957849       residual = 7.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905566957824       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905566957836       residual = 5.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905566957842       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905566957872       residual = 2.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905566957862       residual = 5.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+04 is 2.050806e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.135026 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6685e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.061255e-01 1 1  ON 0
 uu_1                 1.401879e-01 1 1  ON 1
 uu_2                 3.931332e-02 1 1  ON 2
 uu_3                -2.177255e-02 1 1  ON 3
 uu_4                -6.509320e-02 1 1  ON 4
 uu_5                -9.722247e-02 1 1  ON 5
 uu_6                -1.225927e-01 1 1  ON 6
 uu_7                -1.336856e-01 1 1  ON 7
 uu_8                -1.237559e-01 1 1  ON 8
 uu_9                -9.270347e-02 1 1  ON 9
 ud_0                 4.373969e-01 1 1  ON 10
 ud_1                 1.739203e-01 1 1  ON 11
 ud_2                 5.807382e-02 1 1  ON 12
 ud_3                -9.878418e-03 1 1  ON 13
 ud_4                -6.606240e-02 1 1  ON 14
 ud_5                -1.062732e-01 1 1  ON 15
 ud_6                -1.324187e-01 1 1  ON 16
 ud_7                -1.474634e-01 1 1  ON 17
 ud_8                -1.480275e-01 1 1  ON 18
 ud_9                -1.348801e-01 1 1  ON 19
 eO_0                -7.451166e-01 1 1  ON 20
 eO_1                -4.293913e-01 1 1  ON 21
 eO_2                -1.740976e-02 1 1  ON 22
 eO_3                 2.937060e-01 1 1  ON 23
 eO_4                 5.100004e-01 1 1  ON 24
 eO_5                 4.657191e-01 1 1  ON 25
 eO_6                 2.379490e-01 1 1  ON 26
 eO_7                -5.379794e-02 1 1  ON 27
 eO_8                -2.014650e-01 1 1  ON 28
 eO_9                -6.249135e-02 1 1  ON 29
eH1_0                -2.295775e-01 1 1  ON 30
eH1_1                -1.328393e-01 1 1  ON 31
eH1_2                -8.836651e-02 1 1  ON 32
eH1_3                -3.579941e-02 1 1  ON 33
eH1_4                 1.148871e-02 1 1  ON 34
eH1_5                 4.493836e-02 1 1  ON 35
eH1_6                 9.811544e-02 1 1  ON 36
eH1_7                 1.427584e-01 1 1  ON 37
eH1_8                 1.535413e-01 1 1  ON 38
eH1_9                 3.976687e-02 1 1  ON 39
eH2_0                -2.276246e-01 1 1  ON 40
eH2_1                -1.316652e-01 1 1  ON 41
eH2_2                -8.697788e-02 1 1  ON 42
eH2_3                -3.441155e-02 1 1  ON 43
eH2_4                 1.344332e-02 1 1  ON 44
eH2_5                 4.777094e-02 1 1  ON 45
eH2_6                 1.022765e-01 1 1  ON 46
eH2_7                 1.499909e-01 1 1  ON 47
eH2_8                 1.620638e-01 1 1  ON 48
eH2_9                 2.279051e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.9064
    reference variance = 0.138083
====================================================
  Execution time = 2.2928e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.7185e-01
  Total weights = 2.0000e+06
  Execution time = 1.9511e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.371986552348
                                         uncertainty =       0.023144367191

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.371986552348
                                         uncertainty =       0.023144367191

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000431188808
  error estimate for blocks of size 2^( 2) =       0.000443483671
  error estimate for blocks of size 2^( 3) =       0.000455980958
  error estimate for blocks of size 2^( 4) =       0.000468894824
  error estimate for blocks of size 2^( 5) =       0.000480481587
  error estimate for blocks of size 2^( 6) =       0.000487871742
  error estimate for blocks of size 2^( 7) =       0.000492299370

      target function =                  N/A
              le_mean =     -16.905104169484
             les_mean =     286.154394371957
             stat err =       0.000482386881
             autocorr =       1.251572510861
              std dev =       0.609793060614
             le_variance =       0.371847576773

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.371986639266
                                         uncertainty =       0.023144373604

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.371986639266
                                         uncertainty =       0.023144373604

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000431188859
  error estimate for blocks of size 2^( 2) =       0.000443483718
  error estimate for blocks of size 2^( 3) =       0.000455981002
  error estimate for blocks of size 2^( 4) =       0.000468894863
  error estimate for blocks of size 2^( 5) =       0.000480481621
  error estimate for blocks of size 2^( 6) =       0.000487871776
  error estimate for blocks of size 2^( 7) =       0.000492299412

      target function =                  N/A
              le_mean =     -16.905104168534
             les_mean =     286.154394426758
             stat err =       0.000482386918
             autocorr =       1.251572412717
              std dev =       0.609793131889
             le_variance =       0.371847663699

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.371986595806
                                         uncertainty =       0.023144370398

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.371986595806
                                         uncertainty =       0.023144370398

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000431188833
  error estimate for blocks of size 2^( 2) =       0.000443483695
  error estimate for blocks of size 2^( 3) =       0.000455980980
  error estimate for blocks of size 2^( 4) =       0.000468894843
  error estimate for blocks of size 2^( 5) =       0.000480481604
  error estimate for blocks of size 2^( 6) =       0.000487871759
  error estimate for blocks of size 2^( 7) =       0.000492299391

      target function =                  N/A
              le_mean =     -16.905104169009
             les_mean =     286.154394399351
             stat err =       0.000482386899
             autocorr =       1.251572461799
              std dev =       0.609793096250
             le_variance =       0.371847620234

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.371986557781
                                         uncertainty =       0.023144367592

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.371986557781
                                         uncertainty =       0.023144367592

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000431188811
  error estimate for blocks of size 2^( 2) =       0.000443483674
  error estimate for blocks of size 2^( 3) =       0.000455980961
  error estimate for blocks of size 2^( 4) =       0.000468894826
  error estimate for blocks of size 2^( 5) =       0.000480481589
  error estimate for blocks of size 2^( 6) =       0.000487871745
  error estimate for blocks of size 2^( 7) =       0.000492299373

      target function =                  N/A
              le_mean =     -16.905104169425
             les_mean =     286.154394375381
             stat err =       0.000482386883
             autocorr =       1.251572504739
              std dev =       0.609793065068
             le_variance =       0.371847582205


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905104169484        initial  <--
     9.0949e+02     9.0949e+03             3.2812e-07       -16.905104168534
     3.6380e+03     3.6380e+04             8.2032e-08       -16.905104169009
     1.4552e+04     1.4552e+05             2.0508e-08       -16.905104169425

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 32.6877
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.061255e-01 1 1  ON 0
 uu_1                 1.401879e-01 1 1  ON 1
 uu_2                 3.931331e-02 1 1  ON 2
 uu_3                -2.177256e-02 1 1  ON 3
 uu_4                -6.509320e-02 1 1  ON 4
 uu_5                -9.722246e-02 1 1  ON 5
 uu_6                -1.225927e-01 1 1  ON 6
 uu_7                -1.336856e-01 1 1  ON 7
 uu_8                -1.237558e-01 1 1  ON 8
 uu_9                -9.270345e-02 1 1  ON 9
 ud_0                 4.373968e-01 1 1  ON 10
 ud_1                 1.739202e-01 1 1  ON 11
 ud_2                 5.807378e-02 1 1  ON 12
 ud_3                -9.878422e-03 1 1  ON 13
 ud_4                -6.606241e-02 1 1  ON 14
 ud_5                -1.062732e-01 1 1  ON 15
 ud_6                -1.324187e-01 1 1  ON 16
 ud_7                -1.474634e-01 1 1  ON 17
 ud_8                -1.480275e-01 1 1  ON 18
 ud_9                -1.348801e-01 1 1  ON 19
 eO_0                -7.451165e-01 1 1  ON 20
 eO_1                -4.293913e-01 1 1  ON 21
 eO_2                -1.740977e-02 1 1  ON 22
 eO_3                 2.937060e-01 1 1  ON 23
 eO_4                 5.100003e-01 1 1  ON 24
 eO_5                 4.657190e-01 1 1  ON 25
 eO_6                 2.379490e-01 1 1  ON 26
 eO_7                -5.379794e-02 1 1  ON 27
 eO_8                -2.014650e-01 1 1  ON 28
 eO_9                -6.249131e-02 1 1  ON 29
eH1_0                -2.295775e-01 1 1  ON 30
eH1_1                -1.328393e-01 1 1  ON 31
eH1_2                -8.836647e-02 1 1  ON 32
eH1_3                -3.579938e-02 1 1  ON 33
eH1_4                 1.148873e-02 1 1  ON 34
eH1_5                 4.493838e-02 1 1  ON 35
eH1_6                 9.811544e-02 1 1  ON 36
eH1_7                 1.427584e-01 1 1  ON 37
eH1_8                 1.535412e-01 1 1  ON 38
eH1_9                 3.976682e-02 1 1  ON 39
eH2_0                -2.276246e-01 1 1  ON 40
eH2_1                -1.316651e-01 1 1  ON 41
eH2_2                -8.697790e-02 1 1  ON 42
eH2_3                -3.441155e-02 1 1  ON 43
eH2_4                 1.344332e-02 1 1  ON 44
eH2_5                 4.777090e-02 1 1  ON 45
eH2_6                 1.022765e-01 1 1  ON 46
eH2_7                 1.499909e-01 1 1  ON 47
eH2_8                 1.620638e-01 1 1  ON 48
eH2_9                 2.279047e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9385e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6913e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.8981
    reference variance = 0.213277
====================================================
  Execution time = 2.0937e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4090e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5747e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340980861425
                                         uncertainty =       0.004012589365

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340980861425
                                         uncertainty =       0.004012589365

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412858360
  error estimate for blocks of size 2^( 2) =       0.000425682891
  error estimate for blocks of size 2^( 3) =       0.000438179065
  error estimate for blocks of size 2^( 4) =       0.000450544277
  error estimate for blocks of size 2^( 5) =       0.000460945673
  error estimate for blocks of size 2^( 6) =       0.000467860530
  error estimate for blocks of size 2^( 7) =       0.000471677132

      target function =                  N/A
              le_mean =     -16.906074110854
             les_mean =     286.156245721771
             stat err =       0.000462756903
             autocorr =       1.256329756475
              std dev =       0.583869891795
             le_variance =       0.340904050544


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690607411085e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+03, overlap shift 9.0949e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906074110854       residual = 3.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906074110915       residual = 3.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906074110929       residual = 4.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906074110975       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906074110995       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906074111018       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906074111028       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906074111021       residual = 4.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+03 is 3.128803e-08

solving harmonic davidson linear method for identity shift 3.6380e+04, overlap shift 3.6380e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906074110854       residual = 3.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906074110869       residual = 3.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906074110872       residual = 4.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906074110892       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906074110899       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906074110885       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906074110893       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906074110899       residual = 4.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+04 is 7.822013e-09

solving harmonic davidson linear method for identity shift 1.4552e+05, overlap shift 1.4552e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906074110854       residual = 3.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906074110858       residual = 3.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906074110858       residual = 4.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906074110861       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906074110875       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906074110869       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906074110827       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906074110880       residual = 4.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+05 is 1.955504e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.137693 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6519e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.061255e-01 1 1  ON 0
 uu_1                 1.401879e-01 1 1  ON 1
 uu_2                 3.931331e-02 1 1  ON 2
 uu_3                -2.177256e-02 1 1  ON 3
 uu_4                -6.509320e-02 1 1  ON 4
 uu_5                -9.722246e-02 1 1  ON 5
 uu_6                -1.225927e-01 1 1  ON 6
 uu_7                -1.336856e-01 1 1  ON 7
 uu_8                -1.237559e-01 1 1  ON 8
 uu_9                -9.270346e-02 1 1  ON 9
 ud_0                 4.373969e-01 1 1  ON 10
 ud_1                 1.739202e-01 1 1  ON 11
 ud_2                 5.807379e-02 1 1  ON 12
 ud_3                -9.878421e-03 1 1  ON 13
 ud_4                -6.606241e-02 1 1  ON 14
 ud_5                -1.062732e-01 1 1  ON 15
 ud_6                -1.324187e-01 1 1  ON 16
 ud_7                -1.474634e-01 1 1  ON 17
 ud_8                -1.480275e-01 1 1  ON 18
 ud_9                -1.348801e-01 1 1  ON 19
 eO_0                -7.451165e-01 1 1  ON 20
 eO_1                -4.293913e-01 1 1  ON 21
 eO_2                -1.740977e-02 1 1  ON 22
 eO_3                 2.937060e-01 1 1  ON 23
 eO_4                 5.100003e-01 1 1  ON 24
 eO_5                 4.657190e-01 1 1  ON 25
 eO_6                 2.379490e-01 1 1  ON 26
 eO_7                -5.379794e-02 1 1  ON 27
 eO_8                -2.014650e-01 1 1  ON 28
 eO_9                -6.249131e-02 1 1  ON 29
eH1_0                -2.295775e-01 1 1  ON 30
eH1_1                -1.328393e-01 1 1  ON 31
eH1_2                -8.836648e-02 1 1  ON 32
eH1_3                -3.579939e-02 1 1  ON 33
eH1_4                 1.148873e-02 1 1  ON 34
eH1_5                 4.493838e-02 1 1  ON 35
eH1_6                 9.811544e-02 1 1  ON 36
eH1_7                 1.427584e-01 1 1  ON 37
eH1_8                 1.535412e-01 1 1  ON 38
eH1_9                 3.976683e-02 1 1  ON 39
eH2_0                -2.276246e-01 1 1  ON 40
eH2_1                -1.316651e-01 1 1  ON 41
eH2_2                -8.697790e-02 1 1  ON 42
eH2_3                -3.441155e-02 1 1  ON 43
eH2_4                 1.344332e-02 1 1  ON 44
eH2_5                 4.777090e-02 1 1  ON 45
eH2_6                 1.022765e-01 1 1  ON 46
eH2_7                 1.499909e-01 1 1  ON 47
eH2_8                 1.620638e-01 1 1  ON 48
eH2_9                 2.279048e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.8973
    reference variance = 0.142499
====================================================
  Execution time = 2.0613e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3679e-01
  Total weights = 2.0000e+06
  Execution time = 1.9497e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336840876170
                                         uncertainty =       0.003480978672

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336840876170
                                         uncertainty =       0.003480978672

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410361229
  error estimate for blocks of size 2^( 2) =       0.000423023558
  error estimate for blocks of size 2^( 3) =       0.000436139636
  error estimate for blocks of size 2^( 4) =       0.000448156406
  error estimate for blocks of size 2^( 5) =       0.000458928203
  error estimate for blocks of size 2^( 6) =       0.000467677014
  error estimate for blocks of size 2^( 7) =       0.000475382204

      target function =                  N/A
              le_mean =     -16.905339470424
             les_mean =     286.127295118682
             stat err =       0.000462535957
             autocorr =       1.270452274533
              std dev =       0.580338415742
             le_variance =       0.336792676786

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336840880906
                                         uncertainty =       0.003480978733

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336840880906
                                         uncertainty =       0.003480978733

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410361232
  error estimate for blocks of size 2^( 2) =       0.000423023561
  error estimate for blocks of size 2^( 3) =       0.000436139639
  error estimate for blocks of size 2^( 4) =       0.000448156408
  error estimate for blocks of size 2^( 5) =       0.000458928205
  error estimate for blocks of size 2^( 6) =       0.000467677015
  error estimate for blocks of size 2^( 7) =       0.000475382205

      target function =                  N/A
              le_mean =     -16.905339470434
             les_mean =     286.127295123737
             stat err =       0.000462535958
             autocorr =       1.270452265924
              std dev =       0.580338419817
             le_variance =       0.336792681516

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336840878538
                                         uncertainty =       0.003480978702

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336840878538
                                         uncertainty =       0.003480978702

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410361231
  error estimate for blocks of size 2^( 2) =       0.000423023560
  error estimate for blocks of size 2^( 3) =       0.000436139637
  error estimate for blocks of size 2^( 4) =       0.000448156407
  error estimate for blocks of size 2^( 5) =       0.000458928204
  error estimate for blocks of size 2^( 6) =       0.000467677015
  error estimate for blocks of size 2^( 7) =       0.000475382204

      target function =                  N/A
              le_mean =     -16.905339470429
             les_mean =     286.127295121209
             stat err =       0.000462535957
             autocorr =       1.270452270231
              std dev =       0.580338417780
             le_variance =       0.336792679151

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336840876466
                                         uncertainty =       0.003480978675

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336840876466
                                         uncertainty =       0.003480978675

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410361229
  error estimate for blocks of size 2^( 2) =       0.000423023559
  error estimate for blocks of size 2^( 3) =       0.000436139636
  error estimate for blocks of size 2^( 4) =       0.000448156406
  error estimate for blocks of size 2^( 5) =       0.000458928203
  error estimate for blocks of size 2^( 6) =       0.000467677014
  error estimate for blocks of size 2^( 7) =       0.000475382204

      target function =                  N/A
              le_mean =     -16.905339470425
             les_mean =     286.127295118998
             stat err =       0.000462535957
             autocorr =       1.270452274003
              std dev =       0.580338415997
             le_variance =       0.336792677082


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905339470424        initial
     9.0949e+03     9.0949e+04             3.1288e-08       -16.905339470434  <--
     3.6380e+04     3.6380e+05             7.8220e-09       -16.905339470429
     1.4552e+05     1.4552e+06             1.9555e-09       -16.905339470425

*****************************************************************************
Applying the update for shift_i =   9.0949e+03     and shift_s =   9.0949e+04
*****************************************************************************

  Execution time = 3.0407e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.061255e-01 1 1  ON 0
 uu_1                 1.401879e-01 1 1  ON 1
 uu_2                 3.931332e-02 1 1  ON 2
 uu_3                -2.177256e-02 1 1  ON 3
 uu_4                -6.509320e-02 1 1  ON 4
 uu_5                -9.722247e-02 1 1  ON 5
 uu_6                -1.225927e-01 1 1  ON 6
 uu_7                -1.336856e-01 1 1  ON 7
 uu_8                -1.237559e-01 1 1  ON 8
 uu_9                -9.270346e-02 1 1  ON 9
 ud_0                 4.373969e-01 1 1  ON 10
 ud_1                 1.739203e-01 1 1  ON 11
 ud_2                 5.807380e-02 1 1  ON 12
 ud_3                -9.878415e-03 1 1  ON 13
 ud_4                -6.606241e-02 1 1  ON 14
 ud_5                -1.062732e-01 1 1  ON 15
 ud_6                -1.324187e-01 1 1  ON 16
 ud_7                -1.474634e-01 1 1  ON 17
 ud_8                -1.480275e-01 1 1  ON 18
 ud_9                -1.348801e-01 1 1  ON 19
 eO_0                -7.451165e-01 1 1  ON 20
 eO_1                -4.293913e-01 1 1  ON 21
 eO_2                -1.740978e-02 1 1  ON 22
 eO_3                 2.937060e-01 1 1  ON 23
 eO_4                 5.100003e-01 1 1  ON 24
 eO_5                 4.657190e-01 1 1  ON 25
 eO_6                 2.379490e-01 1 1  ON 26
 eO_7                -5.379794e-02 1 1  ON 27
 eO_8                -2.014650e-01 1 1  ON 28
 eO_9                -6.249132e-02 1 1  ON 29
eH1_0                -2.295775e-01 1 1  ON 30
eH1_1                -1.328393e-01 1 1  ON 31
eH1_2                -8.836649e-02 1 1  ON 32
eH1_3                -3.579940e-02 1 1  ON 33
eH1_4                 1.148872e-02 1 1  ON 34
eH1_5                 4.493838e-02 1 1  ON 35
eH1_6                 9.811544e-02 1 1  ON 36
eH1_7                 1.427584e-01 1 1  ON 37
eH1_8                 1.535412e-01 1 1  ON 38
eH1_9                 3.976684e-02 1 1  ON 39
eH2_0                -2.276246e-01 1 1  ON 40
eH2_1                -1.316651e-01 1 1  ON 41
eH2_2                -8.697791e-02 1 1  ON 42
eH2_3                -3.441156e-02 1 1  ON 43
eH2_4                 1.344332e-02 1 1  ON 44
eH2_5                 4.777091e-02 1 1  ON 45
eH2_6                 1.022764e-01 1 1  ON 46
eH2_7                 1.499909e-01 1 1  ON 47
eH2_8                 1.620638e-01 1 1  ON 48
eH2_9                 2.279049e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6945e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6912e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.9601
    reference variance = 0.220772
====================================================
  Execution time = 2.0838e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4277e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6071e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342851622599
                                         uncertainty =       0.007012666720

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342851622599
                                         uncertainty =       0.007012666720

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413988546
  error estimate for blocks of size 2^( 2) =       0.000426181158
  error estimate for blocks of size 2^( 3) =       0.000439138938
  error estimate for blocks of size 2^( 4) =       0.000451201616
  error estimate for blocks of size 2^( 5) =       0.000463182983
  error estimate for blocks of size 2^( 6) =       0.000472806797
  error estimate for blocks of size 2^( 7) =       0.000476270115

      target function =                  N/A
              le_mean =     -16.905891147859
             les_mean =     286.151928364259
             stat err =       0.000465865378
             autocorr =       1.266322200314
              std dev =       0.585468216365
             le_variance =       0.342773032374


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690589114786e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+03, overlap shift 2.2737e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905891147859       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905891147920       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905891147827       residual = 4.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905891147612       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905891147759       residual = 3.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905891147805       residual = 5.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905891147940       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905891147910       residual = 2.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.2737e+03 is 1.201432e-07

solving harmonic davidson linear method for identity shift 9.0949e+03, overlap shift 9.0949e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905891147859       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905891147875       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905891147851       residual = 4.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905891147798       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905891147833       residual = 3.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905891147844       residual = 5.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905891147879       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905891147868       residual = 2.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+03 is 3.003615e-08

solving harmonic davidson linear method for identity shift 3.6380e+04, overlap shift 3.6380e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905891147859       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905891147863       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905891147857       residual = 4.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905891147850       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905891147854       residual = 3.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905891147858       residual = 5.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905891147855       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905891148130       residual = 2.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+04 is 7.509061e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.140415 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6452e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.061255e-01 1 1  ON 0
 uu_1                 1.401879e-01 1 1  ON 1
 uu_2                 3.931333e-02 1 1  ON 2
 uu_3                -2.177256e-02 1 1  ON 3
 uu_4                -6.509319e-02 1 1  ON 4
 uu_5                -9.722247e-02 1 1  ON 5
 uu_6                -1.225927e-01 1 1  ON 6
 uu_7                -1.336856e-01 1 1  ON 7
 uu_8                -1.237559e-01 1 1  ON 8
 uu_9                -9.270347e-02 1 1  ON 9
 ud_0                 4.373969e-01 1 1  ON 10
 ud_1                 1.739203e-01 1 1  ON 11
 ud_2                 5.807381e-02 1 1  ON 12
 ud_3                -9.878416e-03 1 1  ON 13
 ud_4                -6.606241e-02 1 1  ON 14
 ud_5                -1.062732e-01 1 1  ON 15
 ud_6                -1.324187e-01 1 1  ON 16
 ud_7                -1.474634e-01 1 1  ON 17
 ud_8                -1.480275e-01 1 1  ON 18
 ud_9                -1.348801e-01 1 1  ON 19
 eO_0                -7.451166e-01 1 1  ON 20
 eO_1                -4.293913e-01 1 1  ON 21
 eO_2                -1.740979e-02 1 1  ON 22
 eO_3                 2.937060e-01 1 1  ON 23
 eO_4                 5.100004e-01 1 1  ON 24
 eO_5                 4.657191e-01 1 1  ON 25
 eO_6                 2.379490e-01 1 1  ON 26
 eO_7                -5.379794e-02 1 1  ON 27
 eO_8                -2.014650e-01 1 1  ON 28
 eO_9                -6.249133e-02 1 1  ON 29
eH1_0                -2.295775e-01 1 1  ON 30
eH1_1                -1.328393e-01 1 1  ON 31
eH1_2                -8.836650e-02 1 1  ON 32
eH1_3                -3.579941e-02 1 1  ON 33
eH1_4                 1.148872e-02 1 1  ON 34
eH1_5                 4.493839e-02 1 1  ON 35
eH1_6                 9.811544e-02 1 1  ON 36
eH1_7                 1.427584e-01 1 1  ON 37
eH1_8                 1.535412e-01 1 1  ON 38
eH1_9                 3.976686e-02 1 1  ON 39
eH2_0                -2.276246e-01 1 1  ON 40
eH2_1                -1.316651e-01 1 1  ON 41
eH2_2                -8.697792e-02 1 1  ON 42
eH2_3                -3.441156e-02 1 1  ON 43
eH2_4                 1.344332e-02 1 1  ON 44
eH2_5                 4.777090e-02 1 1  ON 45
eH2_6                 1.022765e-01 1 1  ON 46
eH2_7                 1.499909e-01 1 1  ON 47
eH2_8                 1.620638e-01 1 1  ON 48
eH2_9                 2.279051e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.8374
    reference variance = 0.535387
====================================================
  Execution time = 2.0697e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3133e-01
  Total weights = 2.0000e+06
  Execution time = 1.9452e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331281118313
                                         uncertainty =       0.002644111270

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331281118313
                                         uncertainty =       0.002644111270

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407022728
  error estimate for blocks of size 2^( 2) =       0.000420544537
  error estimate for blocks of size 2^( 3) =       0.000434022067
  error estimate for blocks of size 2^( 4) =       0.000445927083
  error estimate for blocks of size 2^( 5) =       0.000457251347
  error estimate for blocks of size 2^( 6) =       0.000465511017
  error estimate for blocks of size 2^( 7) =       0.000469138090

      target function =                  N/A
              le_mean =     -16.904989077522
             les_mean =     286.109990547536
             stat err =       0.000459456884
             autocorr =       1.274242848443
              std dev =       0.575617061996
             le_variance =       0.331335002060

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331281103519
                                         uncertainty =       0.002644111198

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331281103519
                                         uncertainty =       0.002644111198

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407022719
  error estimate for blocks of size 2^( 2) =       0.000420544529
  error estimate for blocks of size 2^( 3) =       0.000434022058
  error estimate for blocks of size 2^( 4) =       0.000445927074
  error estimate for blocks of size 2^( 5) =       0.000457251337
  error estimate for blocks of size 2^( 6) =       0.000465511008
  error estimate for blocks of size 2^( 7) =       0.000469138081

      target function =                  N/A
              le_mean =     -16.904989077922
             les_mean =     286.109990546251
             stat err =       0.000459456875
             autocorr =       1.274242854073
              std dev =       0.575617049145
             le_variance =       0.331334987266

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331281110914
                                         uncertainty =       0.002644111234

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331281110914
                                         uncertainty =       0.002644111234

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407022723
  error estimate for blocks of size 2^( 2) =       0.000420544533
  error estimate for blocks of size 2^( 3) =       0.000434022063
  error estimate for blocks of size 2^( 4) =       0.000445927078
  error estimate for blocks of size 2^( 5) =       0.000457251342
  error estimate for blocks of size 2^( 6) =       0.000465511012
  error estimate for blocks of size 2^( 7) =       0.000469138086

      target function =                  N/A
              le_mean =     -16.904989077722
             les_mean =     286.109990546892
             stat err =       0.000459456880
             autocorr =       1.274242851262
              std dev =       0.575617055568
             le_variance =       0.331334994661

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331281117388
                                         uncertainty =       0.002644111266

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331281117388
                                         uncertainty =       0.002644111266

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407022727
  error estimate for blocks of size 2^( 2) =       0.000420544537
  error estimate for blocks of size 2^( 3) =       0.000434022066
  error estimate for blocks of size 2^( 4) =       0.000445927082
  error estimate for blocks of size 2^( 5) =       0.000457251346
  error estimate for blocks of size 2^( 6) =       0.000465511016
  error estimate for blocks of size 2^( 7) =       0.000469138090

      target function =                  N/A
              le_mean =     -16.904989077547
             les_mean =     286.109990547455
             stat err =       0.000459456884
             autocorr =       1.274242848798
              std dev =       0.575617061192
             le_variance =       0.331335001135


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904989077522        initial
     2.2737e+03     2.2737e+04             1.2014e-07       -16.904989077922  <--
     9.0949e+03     9.0949e+04             3.0036e-08       -16.904989077722
     3.6380e+04     3.6380e+05             7.5091e-09       -16.904989077547

*****************************************************************************
Applying the update for shift_i =   2.2737e+03     and shift_s =   2.2737e+04
*****************************************************************************

  Execution time = 3.0429e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.061255e-01 1 1  ON 0
 uu_1                 1.401879e-01 1 1  ON 1
 uu_2                 3.931336e-02 1 1  ON 2
 uu_3                -2.177256e-02 1 1  ON 3
 uu_4                -6.509318e-02 1 1  ON 4
 uu_5                -9.722250e-02 1 1  ON 5
 uu_6                -1.225928e-01 1 1  ON 6
 uu_7                -1.336857e-01 1 1  ON 7
 uu_8                -1.237559e-01 1 1  ON 8
 uu_9                -9.270349e-02 1 1  ON 9
 ud_0                 4.373969e-01 1 1  ON 10
 ud_1                 1.739203e-01 1 1  ON 11
 ud_2                 5.807385e-02 1 1  ON 12
 ud_3                -9.878417e-03 1 1  ON 13
 ud_4                -6.606243e-02 1 1  ON 14
 ud_5                -1.062732e-01 1 1  ON 15
 ud_6                -1.324187e-01 1 1  ON 16
 ud_7                -1.474633e-01 1 1  ON 17
 ud_8                -1.480275e-01 1 1  ON 18
 ud_9                -1.348801e-01 1 1  ON 19
 eO_0                -7.451167e-01 1 1  ON 20
 eO_1                -4.293914e-01 1 1  ON 21
 eO_2                -1.740982e-02 1 1  ON 22
 eO_3                 2.937061e-01 1 1  ON 23
 eO_4                 5.100005e-01 1 1  ON 24
 eO_5                 4.657192e-01 1 1  ON 25
 eO_6                 2.379491e-01 1 1  ON 26
 eO_7                -5.379792e-02 1 1  ON 27
 eO_8                -2.014651e-01 1 1  ON 28
 eO_9                -6.249137e-02 1 1  ON 29
eH1_0                -2.295776e-01 1 1  ON 30
eH1_1                -1.328394e-01 1 1  ON 31
eH1_2                -8.836656e-02 1 1  ON 32
eH1_3                -3.579943e-02 1 1  ON 33
eH1_4                 1.148869e-02 1 1  ON 34
eH1_5                 4.493843e-02 1 1  ON 35
eH1_6                 9.811544e-02 1 1  ON 36
eH1_7                 1.427584e-01 1 1  ON 37
eH1_8                 1.535413e-01 1 1  ON 38
eH1_9                 3.976692e-02 1 1  ON 39
eH2_0                -2.276247e-01 1 1  ON 40
eH2_1                -1.316652e-01 1 1  ON 41
eH2_2                -8.697796e-02 1 1  ON 42
eH2_3                -3.441158e-02 1 1  ON 43
eH2_4                 1.344332e-02 1 1  ON 44
eH2_5                 4.777088e-02 1 1  ON 45
eH2_6                 1.022765e-01 1 1  ON 46
eH2_7                 1.499910e-01 1 1  ON 47
eH2_8                 1.620639e-01 1 1  ON 48
eH2_9                 2.279057e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6887e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6912e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.8623
    reference variance = 0.289011
====================================================
  Execution time = 2.0831e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3619e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5842e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336234378747
                                         uncertainty =       0.002612884962

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336234378747
                                         uncertainty =       0.002612884962

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409996965
  error estimate for blocks of size 2^( 2) =       0.000422965860
  error estimate for blocks of size 2^( 3) =       0.000436840002
  error estimate for blocks of size 2^( 4) =       0.000449925062
  error estimate for blocks of size 2^( 5) =       0.000461428588
  error estimate for blocks of size 2^( 6) =       0.000470999699
  error estimate for blocks of size 2^( 7) =       0.000478718364

      target function =                  N/A
              le_mean =     -16.905274244977
             les_mean =     286.124492152956
             stat err =       0.000465267928
             autocorr =       1.287789705146
              std dev =       0.579823268920
             le_variance =       0.336195023181


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690527424498e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.6843e+02, overlap shift 5.6843e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905274244977       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905274245534       residual = 4.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905274247244       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905274246755       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905274247161       residual = 5.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905274247376       residual = 7.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905274247680       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905274247801       residual = 4.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.6843e+02 is 5.264195e-07

solving harmonic davidson linear method for identity shift 2.2737e+03, overlap shift 2.2737e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905274244977       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905274245116       residual = 4.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905274245544       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905274245421       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905274245525       residual = 5.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905274245577       residual = 7.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905274245652       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905274245684       residual = 4.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.2737e+03 is 1.316069e-07

solving harmonic davidson linear method for identity shift 9.0949e+03, overlap shift 9.0949e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905274244977       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905274245012       residual = 4.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905274245118       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905274245085       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905274245105       residual = 5.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905274245134       residual = 7.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905274245158       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905274245215       residual = 4.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+03 is 3.290185e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.143108 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6421e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.061255e-01 1 1  ON 0
 uu_1                 1.401879e-01 1 1  ON 1
 uu_2                 3.931335e-02 1 1  ON 2
 uu_3                -2.177256e-02 1 1  ON 3
 uu_4                -6.509319e-02 1 1  ON 4
 uu_5                -9.722255e-02 1 1  ON 5
 uu_6                -1.225928e-01 1 1  ON 6
 uu_7                -1.336857e-01 1 1  ON 7
 uu_8                -1.237560e-01 1 1  ON 8
 uu_9                -9.270347e-02 1 1  ON 9
 ud_0                 4.373970e-01 1 1  ON 10
 ud_1                 1.739203e-01 1 1  ON 11
 ud_2                 5.807387e-02 1 1  ON 12
 ud_3                -9.878465e-03 1 1  ON 13
 ud_4                -6.606243e-02 1 1  ON 14
 ud_5                -1.062733e-01 1 1  ON 15
 ud_6                -1.324187e-01 1 1  ON 16
 ud_7                -1.474634e-01 1 1  ON 17
 ud_8                -1.480275e-01 1 1  ON 18
 ud_9                -1.348801e-01 1 1  ON 19
 eO_0                -7.451167e-01 1 1  ON 20
 eO_1                -4.293915e-01 1 1  ON 21
 eO_2                -1.740984e-02 1 1  ON 22
 eO_3                 2.937061e-01 1 1  ON 23
 eO_4                 5.100006e-01 1 1  ON 24
 eO_5                 4.657193e-01 1 1  ON 25
 eO_6                 2.379491e-01 1 1  ON 26
 eO_7                -5.379789e-02 1 1  ON 27
 eO_8                -2.014651e-01 1 1  ON 28
 eO_9                -6.249140e-02 1 1  ON 29
eH1_0                -2.295776e-01 1 1  ON 30
eH1_1                -1.328394e-01 1 1  ON 31
eH1_2                -8.836661e-02 1 1  ON 32
eH1_3                -3.579951e-02 1 1  ON 33
eH1_4                 1.148865e-02 1 1  ON 34
eH1_5                 4.493835e-02 1 1  ON 35
eH1_6                 9.811546e-02 1 1  ON 36
eH1_7                 1.427585e-01 1 1  ON 37
eH1_8                 1.535414e-01 1 1  ON 38
eH1_9                 3.976700e-02 1 1  ON 39
eH2_0                -2.276248e-01 1 1  ON 40
eH2_1                -1.316652e-01 1 1  ON 41
eH2_2                -8.697801e-02 1 1  ON 42
eH2_3                -3.441160e-02 1 1  ON 43
eH2_4                 1.344328e-02 1 1  ON 44
eH2_5                 4.777087e-02 1 1  ON 45
eH2_6                 1.022765e-01 1 1  ON 46
eH2_7                 1.499909e-01 1 1  ON 47
eH2_8                 1.620640e-01 1 1  ON 48
eH2_9                 2.279070e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.8492
    reference variance = 0.18071
====================================================
  Execution time = 2.0474e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3876e-01
  Total weights = 2.0000e+06
  Execution time = 1.9505e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338761867136
                                         uncertainty =       0.003691912450

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338761867136
                                         uncertainty =       0.003691912450

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411555632
  error estimate for blocks of size 2^( 2) =       0.000424427326
  error estimate for blocks of size 2^( 3) =       0.000437738387
  error estimate for blocks of size 2^( 4) =       0.000450013760
  error estimate for blocks of size 2^( 5) =       0.000461406043
  error estimate for blocks of size 2^( 6) =       0.000469038754
  error estimate for blocks of size 2^( 7) =       0.000474278175

      target function =                  N/A
              le_mean =     -16.905023410452
             les_mean =     286.118572415688
             stat err =       0.000463684183
             autocorr =       1.269367761339
              std dev =       0.582027557027
             le_variance =       0.338756077139

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338762257808
                                         uncertainty =       0.003691915754

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338762257808
                                         uncertainty =       0.003691915754

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411555870
  error estimate for blocks of size 2^( 2) =       0.000424427555
  error estimate for blocks of size 2^( 3) =       0.000437738610
  error estimate for blocks of size 2^( 4) =       0.000450013974
  error estimate for blocks of size 2^( 5) =       0.000461406253
  error estimate for blocks of size 2^( 6) =       0.000469038957
  error estimate for blocks of size 2^( 7) =       0.000474278373

      target function =                  N/A
              le_mean =     -16.905023409435
             les_mean =     286.118572771990
             stat err =       0.000463684389
             autocorr =       1.269367426037
              std dev =       0.582027892640
             le_variance =       0.338756467811

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338762062553
                                         uncertainty =       0.003691914103

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338762062553
                                         uncertainty =       0.003691914103

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411555751
  error estimate for blocks of size 2^( 2) =       0.000424427441
  error estimate for blocks of size 2^( 3) =       0.000437738499
  error estimate for blocks of size 2^( 4) =       0.000450013867
  error estimate for blocks of size 2^( 5) =       0.000461406148
  error estimate for blocks of size 2^( 6) =       0.000469038856
  error estimate for blocks of size 2^( 7) =       0.000474278274

      target function =                  N/A
              le_mean =     -16.905023409944
             les_mean =     286.118572593923
             stat err =       0.000463684286
             autocorr =       1.269367593630
              std dev =       0.582027724903
             le_variance =       0.338756272556

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338761891566
                                         uncertainty =       0.003691912657

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338761891566
                                         uncertainty =       0.003691912657

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411555647
  error estimate for blocks of size 2^( 2) =       0.000424427341
  error estimate for blocks of size 2^( 3) =       0.000437738401
  error estimate for blocks of size 2^( 4) =       0.000450013773
  error estimate for blocks of size 2^( 5) =       0.000461406056
  error estimate for blocks of size 2^( 6) =       0.000469038767
  error estimate for blocks of size 2^( 7) =       0.000474278187

      target function =                  N/A
              le_mean =     -16.905023410388
             les_mean =     286.118572437969
             stat err =       0.000463684196
             autocorr =       1.269367740371
              std dev =       0.582027578014
             le_variance =       0.338756101569


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905023410452        initial  <--
     5.6843e+02     5.6843e+03             5.2642e-07       -16.905023409435
     2.2737e+03     2.2737e+04             1.3161e-07       -16.905023409944
     9.0949e+03     9.0949e+04             3.2902e-08       -16.905023410388

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.2247
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.061255e-01 1 1  ON 0
 uu_1                 1.401879e-01 1 1  ON 1
 uu_2                 3.931336e-02 1 1  ON 2
 uu_3                -2.177256e-02 1 1  ON 3
 uu_4                -6.509318e-02 1 1  ON 4
 uu_5                -9.722250e-02 1 1  ON 5
 uu_6                -1.225928e-01 1 1  ON 6
 uu_7                -1.336857e-01 1 1  ON 7
 uu_8                -1.237559e-01 1 1  ON 8
 uu_9                -9.270349e-02 1 1  ON 9
 ud_0                 4.373969e-01 1 1  ON 10
 ud_1                 1.739203e-01 1 1  ON 11
 ud_2                 5.807385e-02 1 1  ON 12
 ud_3                -9.878417e-03 1 1  ON 13
 ud_4                -6.606243e-02 1 1  ON 14
 ud_5                -1.062732e-01 1 1  ON 15
 ud_6                -1.324187e-01 1 1  ON 16
 ud_7                -1.474633e-01 1 1  ON 17
 ud_8                -1.480275e-01 1 1  ON 18
 ud_9                -1.348801e-01 1 1  ON 19
 eO_0                -7.451167e-01 1 1  ON 20
 eO_1                -4.293914e-01 1 1  ON 21
 eO_2                -1.740982e-02 1 1  ON 22
 eO_3                 2.937061e-01 1 1  ON 23
 eO_4                 5.100005e-01 1 1  ON 24
 eO_5                 4.657192e-01 1 1  ON 25
 eO_6                 2.379491e-01 1 1  ON 26
 eO_7                -5.379792e-02 1 1  ON 27
 eO_8                -2.014651e-01 1 1  ON 28
 eO_9                -6.249137e-02 1 1  ON 29
eH1_0                -2.295776e-01 1 1  ON 30
eH1_1                -1.328394e-01 1 1  ON 31
eH1_2                -8.836656e-02 1 1  ON 32
eH1_3                -3.579943e-02 1 1  ON 33
eH1_4                 1.148869e-02 1 1  ON 34
eH1_5                 4.493843e-02 1 1  ON 35
eH1_6                 9.811544e-02 1 1  ON 36
eH1_7                 1.427584e-01 1 1  ON 37
eH1_8                 1.535413e-01 1 1  ON 38
eH1_9                 3.976692e-02 1 1  ON 39
eH2_0                -2.276247e-01 1 1  ON 40
eH2_1                -1.316652e-01 1 1  ON 41
eH2_2                -8.697796e-02 1 1  ON 42
eH2_3                -3.441158e-02 1 1  ON 43
eH2_4                 1.344332e-02 1 1  ON 44
eH2_5                 4.777088e-02 1 1  ON 45
eH2_6                 1.022765e-01 1 1  ON 46
eH2_7                 1.499910e-01 1 1  ON 47
eH2_8                 1.620639e-01 1 1  ON 48
eH2_9                 2.279057e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6651e+01 secs
  Total Execution time = 2.2802e+03 secs

=========================================================
  A new xml input file : H2O.s039.cont.xml
