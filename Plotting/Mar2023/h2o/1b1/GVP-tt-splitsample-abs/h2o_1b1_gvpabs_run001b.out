--------------------------------------------------------------------------
WARNING: No preset parameters were found for the device that Open MPI
detected:

  Local host:            n0243.savio3
  Device name:           mlx5_0
  Device vendor ID:      0x02c9
  Device vendor part ID: 4123

Default device parameters will be used, which may result in lower
performance.  You can edit any of the files specified by the
btl_openib_device_param_files MCA parameter to set values for your
device.

NOTE: You can turn off this warning by setting the MCA parameter
      btl_openib_warn_no_device_params_found to 0.
--------------------------------------------------------------------------
Rank =    0  Free Memory = 89647 MB
Rank =    1  Free Memory = 89643 MB
Rank =    2  Free Memory = 89643 MB
Rank =    3  Free Memory = 89643 MB
Rank =    4  Free Memory = 89643 MB
Rank =    5  Free Memory = 89643 MB
Rank =    6  Free Memory = 89643 MB
Rank =    7  Free Memory = 89643 MB
Rank =    8  Free Memory = 89643 MB
Rank =    9  Free Memory = 89643 MB
Rank =   10  Free Memory = 89643 MB
Rank =   11  Free Memory = 89643 MB
Rank =   12  Free Memory = 89643 MB
Rank =   13  Free Memory = 89643 MB
Rank =   14  Free Memory = 89643 MB
Rank =   15  Free Memory = 89637 MB
Rank =   16  Free Memory = 89636 MB
Rank =   17  Free Memory = 89634 MB
Rank =   18  Free Memory = 89634 MB
Rank =   19  Free Memory = 89634 MB
Rank =   20  Free Memory = 89634 MB
Rank =   21  Free Memory = 89634 MB
Rank =   22  Free Memory = 89634 MB
Rank =   23  Free Memory = 89634 MB
Rank =   24  Free Memory = 89634 MB
Rank =   25  Free Memory = 89634 MB
Rank =   26  Free Memory = 89634 MB
Rank =   27  Free Memory = 89634 MB
Rank =   28  Free Memory = 89634 MB
Rank =   29  Free Memory = 89634 MB
Rank =   30  Free Memory = 89634 MB
Rank =   31  Free Memory = 89634 MB
Rank =   32  Free Memory = 88500 MB
Rank =   33  Free Memory = 88500 MB
Rank =   34  Free Memory = 88500 MB
Rank =   35  Free Memory = 88500 MB
Rank =   36  Free Memory = 88500 MB
Rank =   37  Free Memory = 88500 MB
Rank =   38  Free Memory = 88500 MB
Rank =   39  Free Memory = 88500 MB
Rank =   40  Free Memory = 88500 MB
Rank =   41  Free Memory = 88500 MB
Rank =   42  Free Memory = 88500 MB
Rank =   43  Free Memory = 88500 MB
Rank =   44  Free Memory = 88500 MB
Rank =   45  Free Memory = 88500 MB
Rank =   46  Free Memory = 88500 MB
Rank =   47  Free Memory = 88500 MB
Rank =   48  Free Memory = 88500 MB
Rank =   49  Free Memory = 88500 MB
Rank =   50  Free Memory = 88500 MB
Rank =   51  Free Memory = 88500 MB
Rank =   52  Free Memory = 88500 MB
Rank =   53  Free Memory = 88500 MB
Rank =   54  Free Memory = 88500 MB
Rank =   55  Free Memory = 88500 MB
Rank =   56  Free Memory = 88500 MB
Rank =   57  Free Memory = 88500 MB
Rank =   58  Free Memory = 88500 MB
Rank =   59  Free Memory = 88500 MB
Rank =   60  Free Memory = 88500 MB
Rank =   61  Free Memory = 88500 MB
Rank =   62  Free Memory = 88500 MB
Rank =   63  Free Memory = 88500 MB
Rank =   64  Free Memory = 87791 MB
Rank =   65  Free Memory = 87791 MB
Rank =   66  Free Memory = 87791 MB
Rank =   67  Free Memory = 87791 MB
Rank =   68  Free Memory = 87791 MB
Rank =   69  Free Memory = 87791 MB
Rank =   70  Free Memory = 87791 MB
Rank =   71  Free Memory = 87791 MB
Rank =   72  Free Memory = 87791 MB
Rank =   73  Free Memory = 87791 MB
Rank =   74  Free Memory = 87791 MB
Rank =   75  Free Memory = 87791 MB
Rank =   76  Free Memory = 87791 MB
Rank =   77  Free Memory = 87791 MB
Rank =   78  Free Memory = 87791 MB
Rank =   79  Free Memory = 87791 MB
Rank =   80  Free Memory = 87791 MB
Rank =   81  Free Memory = 87791 MB
Rank =   82  Free Memory = 87791 MB
Rank =   83  Free Memory = 87791 MB
Rank =   84  Free Memory = 87791 MB
Rank =   85  Free Memory = 87791 MB
Rank =   86  Free Memory = 87791 MB
Rank =   87  Free Memory = 87791 MB
Rank =   88  Free Memory = 87791 MB
Rank =   89  Free Memory = 87791 MB
Rank =   90  Free Memory = 87791 MB
Rank =   91  Free Memory = 87791 MB
Rank =   92  Free Memory = 87791 MB
Rank =   93  Free Memory = 87790 MB
Rank =   94  Free Memory = 87790 MB
Rank =   95  Free Memory = 87790 MB
Rank =   96  Free Memory = 87790 MB
Rank =   97  Free Memory = 87789 MB
Rank =   98  Free Memory = 87789 MB
Rank =   99  Free Memory = 87789 MB
Rank =  100  Free Memory = 87789 MB
Rank =  101  Free Memory = 87789 MB
Rank =  102  Free Memory = 87789 MB
Rank =  103  Free Memory = 87789 MB
Rank =  104  Free Memory = 81120 MB
Rank =  105  Free Memory = 81120 MB
Rank =  106  Free Memory = 81120 MB
Rank =  107  Free Memory = 81120 MB
Rank =  108  Free Memory = 81120 MB
Rank =  109  Free Memory = 81120 MB
Rank =  110  Free Memory = 81120 MB
Rank =  111  Free Memory = 81120 MB
Rank =  112  Free Memory = 81120 MB
Rank =  113  Free Memory = 81120 MB
Rank =  114  Free Memory = 81120 MB
Rank =  115  Free Memory = 81120 MB
Rank =  116  Free Memory = 81120 MB
Rank =  117  Free Memory = 81120 MB
Rank =  118  Free Memory = 81120 MB
Rank =  119  Free Memory = 81120 MB
Rank =  120  Free Memory = 81120 MB
Rank =  121  Free Memory = 81120 MB
Rank =  122  Free Memory = 81120 MB
Rank =  123  Free Memory = 81120 MB
Rank =  124  Free Memory = 81120 MB
Rank =  125  Free Memory = 81120 MB
Rank =  126  Free Memory = 81120 MB
  Input file(s): opt_h2o_1b1_gvpabs_run001b.xml 
Rank =  127  Free Memory = 81120 MB

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 39b7557df04c29964085ccccce933740e3918067-dirty
  Last git commit date: Wed Mar 22 11:37:25 2023 -0700
  Last git commit subject: deleting more debugging statements
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_1b1_gvpabs_run001b.xml

  Project = H2O
  date    = 2023-03-24 01:58:09 PDT
  host    = n0010.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 545

  Range of prime numbers to use as seeds over processors and threads = 3943-5039


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 3.027108e-01    1         1  ON     0
     uu_1                 1.395499e-01    1         1  ON     1
     uu_2                 4.158458e-02    1         1  ON     2
     uu_3                -1.946409e-02    1         1  ON     3
     uu_4                -6.333239e-02    1         1  ON     4
     uu_5                -9.587524e-02    1         1  ON     5
     uu_6                -1.205706e-01    1         1  ON     6
     uu_7                -1.310580e-01    1         1  ON     7
     uu_8                -1.203232e-01    1         1  ON     8
     uu_9                -9.277332e-02    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 4.114416e-01    1         1  ON     0
     ud_1                 1.583401e-01    1         1  ON     1
     ud_2                 6.092685e-02    1         1  ON     2
     ud_3                 2.699750e-03    1         1  ON     3
     ud_4                -5.713986e-02    1         1  ON     4
     ud_5                -1.014997e-01    1         1  ON     5
     ud_6                -1.286687e-01    1         1  ON     6
     ud_7                -1.435029e-01    1         1  ON     7
     ud_8                -1.424319e-01    1         1  ON     8
     ud_9                -1.344547e-01    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.043100e-01    1         1  ON     0
     eO_1                -4.137154e-01    1         1  ON     1
     eO_2                -3.185752e-02    1         1  ON     2
     eO_3                 2.692030e-01    1         1  ON     3
     eO_4                 4.916456e-01    1         1  ON     4
     eO_5                 4.596091e-01    1         1  ON     5
     eO_6                 2.360353e-01    1         1  ON     6
     eO_7                -5.591968e-02    1         1  ON     7
     eO_8                -1.959242e-01    1         1  ON     8
     eO_9                -5.768884e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.099404e-01    1         1  ON     0
     eH1_1                -1.274877e-01    1         1  ON     1
     eH1_2                -8.838243e-02    1         1  ON     2
     eH1_3                -3.738645e-02    1         1  ON     3
     eH1_4                 1.159942e-02    1         1  ON     4
     eH1_5                 4.473069e-02    1         1  ON     5
     eH1_6                 9.476145e-02    1         1  ON     6
     eH1_7                 1.381756e-01    1         1  ON     7
     eH1_8                 1.456924e-01    1         1  ON     8
     eH1_9                 3.283823e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.088198e-01    1         1  ON     0
     eH2_1                -1.265485e-01    1         1  ON     1
     eH2_2                -8.741031e-02    1         1  ON     2
     eH2_3                -3.640778e-02    1         1  ON     3
     eH2_4                 1.289653e-02    1         1  ON     4
     eH2_5                 4.794967e-02    1         1  ON     5
     eH2_6                 1.006131e-01    1         1  ON     6
     eH2_7                 1.496008e-01    1         1  ON     7
     eH2_8                 1.537439e-01    1         1  ON     8
     eH2_9                 1.292423e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 75 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 1.717754e+00
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 30 unique up determinants.
Found 30 unique down determinants.
Number of terms in pairs array: 20
Number of terms in pairs array: 20
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 2.2439e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u  6.1002844054e-01  1.3250453608e-01 -4.2267217978e-01
    u -4.3494847795e-01 -2.3203549626e-01  1.0876787134e-01
    u -1.5984350305e-01  8.1842956548e-01  5.1837161342e-02
    u  1.1948334779e+00  1.4453040952e+00  1.6346730752e+00
    d -9.5054657961e-01  2.3768909128e-01 -6.0876959125e-01
    d -2.0429807517e-01  1.5546410594e+00 -1.0292769217e-01
    d  4.7451519973e-01  3.4811618685e-02  3.5425821429e-01
    d -8.6403568621e-02 -1.8286319639e+00  9.9844026831e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
[n0010.savio3:200112] 63 more processes have sent help message help-mpi-btl-openib.txt / no device params found
[n0010.savio3:200112] Set MCA parameter "orte_base_help_aggregate" to 0 to see all help / error messages
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.9106
    reference variance = 0.336526
====================================================
  Execution time = 2.0781e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2445e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5880e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324487231645
                                         uncertainty =       0.002908107639

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324487231645
                                         uncertainty =       0.002908107639

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402771337
  error estimate for blocks of size 2^( 2) =       0.000417002530
  error estimate for blocks of size 2^( 3) =       0.000431373169
  error estimate for blocks of size 2^( 4) =       0.000445031995
  error estimate for blocks of size 2^( 5) =       0.000457636294
  error estimate for blocks of size 2^( 6) =       0.000465878502
  error estimate for blocks of size 2^( 7) =       0.000471197319

      target function =                  N/A
              le_mean =     -16.904454962487
             les_mean =     286.085046916222
             stat err =       0.000459936027
             autocorr =       1.304000464540
              std dev =       0.569604687217
             le_variance =       0.324449499699


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.690445496249e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904454962487       residual = 2.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904681082285       residual = 1.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904805851176       residual = 2.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904855817245       residual = 2.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904952318428       residual = 5.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904981913289       residual = 2.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904977829359       residual = 5.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904980104297       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.904981834105       residual = 8.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.904982953668       residual = 5.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.904982561320       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.904982125090       residual = 3.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.904982073356       residual = 6.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.205799e-02

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904454962487       residual = 2.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904547511252       residual = 1.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904605958488       residual = 3.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904622376308       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904660352336       residual = 3.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904666241963       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904667412315       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904666216662       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.904667253719       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.904667205478       residual = 5.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.904667175623       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.904667077052       residual = 1.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 4.146520e-03

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904454962487       residual = 2.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904482483243       residual = 1.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904501422912       residual = 3.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904506236168       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904516327125       residual = 5.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904518134529       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904518511722       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904518398677       residual = 5.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.904518600412       residual = 3.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.904518621147       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.904518573807       residual = 4.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 1.163563e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.205199 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9616e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  3.025921e-01                 1 1 ON  0
uu_1  1.392514e-01                 1 1 ON  1
uu_2  4.119833e-02                 1 1 ON  2
uu_3  -1.927945e-02                1 1 ON  3
uu_4  -6.296634e-02                1 1 ON  4
uu_5  -9.584451e-02                1 1 ON  5
uu_6  -1.206135e-01                1 1 ON  6
uu_7  -1.311155e-01                1 1 ON  7
uu_8  -1.204021e-01                1 1 ON  8
uu_9  -9.270718e-02                1 1 ON  9
ud_0  4.147570e-01                 1 1 ON  10
ud_1  1.607749e-01                 1 1 ON  11
ud_2  5.906610e-02                 1 1 ON  12
ud_3  5.244886e-04                 1 1 ON  13
ud_4  -5.755109e-02                1 1 ON  14
ud_5  -1.017149e-01                1 1 ON  15
ud_6  -1.290217e-01                1 1 ON  16
ud_7  -1.439158e-01                1 1 ON  17
ud_8  -1.427002e-01                1 1 ON  18
ud_9  -1.345418e-01                1 1 ON  19
eO_0  -7.084565e-01                1 1 ON  20
eO_1  -4.142196e-01                1 1 ON  21
eO_2  -2.885795e-02                1 1 ON  22
eO_3  2.713533e-01                 1 1 ON  23
eO_4  4.920101e-01                 1 1 ON  24
eO_5  4.591061e-01                 1 1 ON  25
eO_6  2.359143e-01                 1 1 ON  26
eO_7  -5.587555e-02                1 1 ON  27
eO_8  -1.960682e-01                1 1 ON  28
eO_9  -5.780720e-02                1 1 ON  29
eH1_0 -2.112837e-01                1 1 ON  30
eH1_1 -1.275210e-01                1 1 ON  31
eH1_2 -8.817231e-02                1 1 ON  32
eH1_3 -3.696068e-02                1 1 ON  33
eH1_4 1.194056e-02                 1 1 ON  34
eH1_5 4.481787e-02                 1 1 ON  35
eH1_6 9.466937e-02                 1 1 ON  36
eH1_7 1.382177e-01                 1 1 ON  37
eH1_8 1.458578e-01                 1 1 ON  38
eH1_9 3.301213e-02                 1 1 ON  39
eH2_0 -2.100815e-01                1 1 ON  40
eH2_1 -1.266097e-01                1 1 ON  41
eH2_2 -8.716567e-02                1 1 ON  42
eH2_3 -3.599785e-02                1 1 ON  43
eH2_4 1.322755e-02                 1 1 ON  44
eH2_5 4.800504e-02                 1 1 ON  45
eH2_6 1.005715e-01                 1 1 ON  46
eH2_7 1.495356e-01                 1 1 ON  47
eH2_8 1.539292e-01                 1 1 ON  48
eH2_9 1.314944e-02                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.8855
    reference variance = 0.169679
====================================================
  Execution time = 2.0984e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2241e-01
  Total weights = 2.0000e+06
  Execution time = 1.8729e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321570907632
                                         uncertainty =       0.003224845271

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321570907632
                                         uncertainty =       0.003224845271

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400958216
  error estimate for blocks of size 2^( 2) =       0.000415248007
  error estimate for blocks of size 2^( 3) =       0.000429939861
  error estimate for blocks of size 2^( 4) =       0.000443507240
  error estimate for blocks of size 2^( 5) =       0.000456583989
  error estimate for blocks of size 2^( 6) =       0.000467313716
  error estimate for blocks of size 2^( 7) =       0.000474341816

      target function =                  N/A
              le_mean =     -16.904465296515
             les_mean =     286.082481781579
             stat err =       0.000460436690
             autocorr =       1.318686661486
              std dev =       0.567040546419
             le_variance =       0.321534981283

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325154596196
                                         uncertainty =       0.003317196519

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325154596196
                                         uncertainty =       0.003317196519

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403185693
  error estimate for blocks of size 2^( 2) =       0.000416763458
  error estimate for blocks of size 2^( 3) =       0.000430875117
  error estimate for blocks of size 2^( 4) =       0.000444074454
  error estimate for blocks of size 2^( 5) =       0.000456952698
  error estimate for blocks of size 2^( 6) =       0.000467756156
  error estimate for blocks of size 2^( 7) =       0.000474688040

      target function =                  N/A
              le_mean =     -16.904504866732
             les_mean =     286.087402032883
             stat err =       0.000460867837
             autocorr =       1.306599764867
              std dev =       0.570190675187
             le_variance =       0.325117406070

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323936471049
                                         uncertainty =       0.003299918093

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323936471049
                                         uncertainty =       0.003299918093

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402430016
  error estimate for blocks of size 2^( 2) =       0.000416142619
  error estimate for blocks of size 2^( 3) =       0.000430375726
  error estimate for blocks of size 2^( 4) =       0.000443652706
  error estimate for blocks of size 2^( 5) =       0.000456566475
  error estimate for blocks of size 2^( 6) =       0.000467376490
  error estimate for blocks of size 2^( 7) =       0.000474327855

      target function =                  N/A
              le_mean =     -16.904451945784
             les_mean =     286.084395261738
             stat err =       0.000460480882
             autocorr =       1.309309968451
              std dev =       0.569121987235
             le_variance =       0.323899836354

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321718929716
                                         uncertainty =       0.003236047841

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321718929716
                                         uncertainty =       0.003236047841

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401050447
  error estimate for blocks of size 2^( 2) =       0.000415245053
  error estimate for blocks of size 2^( 3) =       0.000429863802
  error estimate for blocks of size 2^( 4) =       0.000443386263
  error estimate for blocks of size 2^( 5) =       0.000456437930
  error estimate for blocks of size 2^( 6) =       0.000467183269
  error estimate for blocks of size 2^( 7) =       0.000474200051

      target function =                  N/A
              le_mean =     -16.904437494126
             les_mean =     286.081689754530
             stat err =       0.000460301879
             autocorr =       1.317308470671
              std dev =       0.567170981766
             le_variance =       0.321682922558


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904465296515        initial
     2.5000e-01     2.5000e+00             1.2058e-02       -16.904504866732  <--
     1.0000e+00     1.0000e+01             4.1465e-03       -16.904451945784
     4.0000e+00     4.0000e+01             1.1636e-03       -16.904437494126

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 3.0440e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 3.026216e-01 1 1  ON 0
 uu_1                 1.388280e-01 1 1  ON 1
 uu_2                 4.049589e-02 1 1  ON 2
 uu_3                -1.941234e-02 1 1  ON 3
 uu_4                -6.262707e-02 1 1  ON 4
 uu_5                -9.563821e-02 1 1  ON 5
 uu_6                -1.206443e-01 1 1  ON 6
 uu_7                -1.312901e-01 1 1  ON 7
 uu_8                -1.206622e-01 1 1  ON 8
 uu_9                -9.253747e-02 1 1  ON 9
 ud_0                 4.207550e-01 1 1  ON 10
 ud_1                 1.641758e-01 1 1  ON 11
 ud_2                 5.732250e-02 1 1  ON 12
 ud_3                -3.188741e-03 1 1  ON 13
 ud_4                -5.918785e-02 1 1  ON 14
 ud_5                -1.022368e-01 1 1  ON 15
 ud_6                -1.294732e-01 1 1  ON 16
 ud_7                -1.446300e-01 1 1  ON 17
 ud_8                -1.432717e-01 1 1  ON 18
 ud_9                -1.347183e-01 1 1  ON 19
 eO_0                -7.163680e-01 1 1  ON 20
 eO_1                -4.159053e-01 1 1  ON 21
 eO_2                -2.420683e-02 1 1  ON 22
 eO_3                 2.760668e-01 1 1  ON 23
 eO_4                 4.938240e-01 1 1  ON 24
 eO_5                 4.584338e-01 1 1  ON 25
 eO_6                 2.356334e-01 1 1  ON 26
 eO_7                -5.572440e-02 1 1  ON 27
 eO_8                -1.964506e-01 1 1  ON 28
 eO_9                -5.814279e-02 1 1  ON 29
eH1_0                -2.144256e-01 1 1  ON 30
eH1_1                -1.278561e-01 1 1  ON 31
eH1_2                -8.757134e-02 1 1  ON 32
eH1_3                -3.620577e-02 1 1  ON 33
eH1_4                 1.255338e-02 1 1  ON 34
eH1_5                 4.514423e-02 1 1  ON 35
eH1_6                 9.461149e-02 1 1  ON 36
eH1_7                 1.383814e-01 1 1  ON 37
eH1_8                 1.463430e-01 1 1  ON 38
eH1_9                 3.353048e-02 1 1  ON 39
eH2_0                -2.130292e-01 1 1  ON 40
eH2_1                -1.269661e-01 1 1  ON 41
eH2_2                -8.650635e-02 1 1  ON 42
eH2_3                -3.525640e-02 1 1  ON 43
eH2_4                 1.381140e-02 1 1  ON 44
eH2_5                 4.824448e-02 1 1  ON 45
eH2_6                 1.006332e-01 1 1  ON 46
eH2_7                 1.494026e-01 1 1  ON 47
eH2_8                 1.544733e-01 1 1  ON 48
eH2_9                 1.381519e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.0073e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.8066
    reference variance = 0.366956
====================================================
  Execution time = 2.2844e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2968e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6492e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329729992149
                                         uncertainty =       0.004416137782

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329729992149
                                         uncertainty =       0.004416137782

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406006352
  error estimate for blocks of size 2^( 2) =       0.000419203731
  error estimate for blocks of size 2^( 3) =       0.000433016927
  error estimate for blocks of size 2^( 4) =       0.000445145496
  error estimate for blocks of size 2^( 5) =       0.000455696974
  error estimate for blocks of size 2^( 6) =       0.000461926652
  error estimate for blocks of size 2^( 7) =       0.000465181634

      target function =                  N/A
              le_mean =     -16.904391676671
             les_mean =     286.088140109591
             stat err =       0.000456987689
             autocorr =       1.266902941301
              std dev =       0.574179689757
             le_variance =       0.329682316129


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690439167667e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904391676671       residual = 5.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904488295313       residual = 2.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904584311570       residual = 8.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904635801657       residual = 5.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904659535057       residual = 4.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904678223555       residual = 2.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904700957138       residual = 9.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904716523637       residual = 5.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.904714711150       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.904718245913       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.904719224195       residual = 8.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.904717960903       residual = 3.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.904720564739       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.904719308188       residual = 7.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.904720322034       residual = 2.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.904720531710       residual = 2.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.904720397130       residual = 8.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 1.672545e-02

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904391676671       residual = 5.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904449921633       residual = 2.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904513196291       residual = 7.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904531272267       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904547344154       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904556891482       residual = 8.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904563959677       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904565935174       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.904566856174       residual = 4.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.904566545159       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.904567000060       residual = 6.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.904566352240       residual = 2.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.904566695473       residual = 4.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 7.282661e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904391676671       residual = 5.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904414176457       residual = 2.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904441367679       residual = 7.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904446243870       residual = 8.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904453232581       residual = 9.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904455715684       residual = 4.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904455974934       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904456635548       residual = 5.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.904456627399       residual = 5.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.904456679519       residual = 2.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.904456811462       residual = 5.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 2.365226e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.211879 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8508e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.034044e-01 1 1  ON 0
 uu_1                 1.389852e-01 1 1  ON 1
 uu_2                 4.007026e-02 1 1  ON 2
 uu_3                -1.982789e-02 1 1  ON 3
 uu_4                -6.244287e-02 1 1  ON 4
 uu_5                -9.534646e-02 1 1  ON 5
 uu_6                -1.206149e-01 1 1  ON 6
 uu_7                -1.315769e-01 1 1  ON 7
 uu_8                -1.212919e-01 1 1  ON 8
 uu_9                -9.300571e-02 1 1  ON 9
 ud_0                 4.269463e-01 1 1  ON 10
 ud_1                 1.673999e-01 1 1  ON 11
 ud_2                 5.663177e-02 1 1  ON 12
 ud_3                -6.190991e-03 1 1  ON 13
 ud_4                -6.098724e-02 1 1  ON 14
 ud_5                -1.027202e-01 1 1  ON 15
 ud_6                -1.300443e-01 1 1  ON 16
 ud_7                -1.455862e-01 1 1  ON 17
 ud_8                -1.445727e-01 1 1  ON 18
 ud_9                -1.353363e-01 1 1  ON 19
 eO_0                -7.236507e-01 1 1  ON 20
 eO_1                -4.183003e-01 1 1  ON 21
 eO_2                -2.001367e-02 1 1  ON 22
 eO_3                 2.807427e-01 1 1  ON 23
 eO_4                 4.962761e-01 1 1  ON 24
 eO_5                 4.584636e-01 1 1  ON 25
 eO_6                 2.354641e-01 1 1  ON 26
 eO_7                -5.566552e-02 1 1  ON 27
 eO_8                -1.973022e-01 1 1  ON 28
 eO_9                -5.875045e-02 1 1  ON 29
eH1_0                -2.177337e-01 1 1  ON 30
eH1_1                -1.285369e-01 1 1  ON 31
eH1_2                -8.695488e-02 1 1  ON 32
eH1_3                -3.538341e-02 1 1  ON 33
eH1_4                 1.325130e-02 1 1  ON 34
eH1_5                 4.543189e-02 1 1  ON 35
eH1_6                 9.497100e-02 1 1  ON 36
eH1_7                 1.385438e-01 1 1  ON 37
eH1_8                 1.468083e-01 1 1  ON 38
eH1_9                 3.417233e-02 1 1  ON 39
eH2_0                -2.160454e-01 1 1  ON 40
eH2_1                -1.274462e-01 1 1  ON 41
eH2_2                -8.611492e-02 1 1  ON 42
eH2_3                -3.441859e-02 1 1  ON 43
eH2_4                 1.436570e-02 1 1  ON 44
eH2_5                 4.875116e-02 1 1  ON 45
eH2_6                 1.008096e-01 1 1  ON 46
eH2_7                 1.491730e-01 1 1  ON 47
eH2_8                 1.550482e-01 1 1  ON 48
eH2_9                 1.452987e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.9368
    reference variance = 0.316767
====================================================
  Execution time = 1.9892e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3295e-01
  Total weights = 2.0000e+06
  Execution time = 1.8773e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329175085442
                                         uncertainty =       0.003832477474

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329175085442
                                         uncertainty =       0.003832477474

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405664311
  error estimate for blocks of size 2^( 2) =       0.000419372721
  error estimate for blocks of size 2^( 3) =       0.000433773911
  error estimate for blocks of size 2^( 4) =       0.000447365788
  error estimate for blocks of size 2^( 5) =       0.000459206279
  error estimate for blocks of size 2^( 6) =       0.000468296659
  error estimate for blocks of size 2^( 7) =       0.000476336781

      target function =                  N/A
              le_mean =     -16.905361240679
             les_mean =     286.120365579214
             stat err =       0.000462801377
             autocorr =       1.301534491106
              std dev =       0.573695969937
             le_variance =       0.329127065922

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336624556992
                                         uncertainty =       0.004067851113

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336624556992
                                         uncertainty =       0.004067851113

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410227801
  error estimate for blocks of size 2^( 2) =       0.000423464511
  error estimate for blocks of size 2^( 3) =       0.000437451115
  error estimate for blocks of size 2^( 4) =       0.000450716949
  error estimate for blocks of size 2^( 5) =       0.000462227736
  error estimate for blocks of size 2^( 6) =       0.000471337057
  error estimate for blocks of size 2^( 7) =       0.000479399198

      target function =                  N/A
              le_mean =     -16.905299018540
             les_mean =     286.125708436178
             stat err =       0.000465920235
             autocorr =       1.289950264393
              std dev =       0.580149720510
             le_variance =       0.336573698207

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337581215784
                                         uncertainty =       0.004093722909

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337581215784
                                         uncertainty =       0.004093722909

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410809854
  error estimate for blocks of size 2^( 2) =       0.000424005767
  error estimate for blocks of size 2^( 3) =       0.000437971364
  error estimate for blocks of size 2^( 4) =       0.000451214898
  error estimate for blocks of size 2^( 5) =       0.000462706036
  error estimate for blocks of size 2^( 6) =       0.000471819426
  error estimate for blocks of size 2^( 7) =       0.000479891666

      target function =                  N/A
              le_mean =     -16.905320446296
             les_mean =     286.127388695254
             stat err =       0.000466408007
             autocorr =       1.288992202193
              std dev =       0.580972866884
             le_variance =       0.337529472056

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330563910822
                                         uncertainty =       0.003881516150

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330563910822
                                         uncertainty =       0.003881516150

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406518824
  error estimate for blocks of size 2^( 2) =       0.000420110107
  error estimate for blocks of size 2^( 3) =       0.000434416628
  error estimate for blocks of size 2^( 4) =       0.000447933946
  error estimate for blocks of size 2^( 5) =       0.000459706259
  error estimate for blocks of size 2^( 6) =       0.000468798890
  error estimate for blocks of size 2^( 7) =       0.000476848367

      target function =                  N/A
              le_mean =     -16.905312423642
             les_mean =     286.120103084426
             stat err =       0.000463321865
             autocorr =       1.298985403629
              std dev =       0.574904434433
             le_variance =       0.330515108731


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905361240679        initial  <--
     6.2500e-02     6.2500e-01             1.6725e-02       -16.905299018540
     2.5000e-01     2.5000e+00             7.2827e-03       -16.905320446296
     1.0000e+00     1.0000e+01             2.3652e-03       -16.905312423642

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4345
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.026216e-01 1 1  ON 0
 uu_1                 1.388280e-01 1 1  ON 1
 uu_2                 4.049589e-02 1 1  ON 2
 uu_3                -1.941234e-02 1 1  ON 3
 uu_4                -6.262707e-02 1 1  ON 4
 uu_5                -9.563821e-02 1 1  ON 5
 uu_6                -1.206443e-01 1 1  ON 6
 uu_7                -1.312901e-01 1 1  ON 7
 uu_8                -1.206622e-01 1 1  ON 8
 uu_9                -9.253747e-02 1 1  ON 9
 ud_0                 4.207550e-01 1 1  ON 10
 ud_1                 1.641758e-01 1 1  ON 11
 ud_2                 5.732250e-02 1 1  ON 12
 ud_3                -3.188741e-03 1 1  ON 13
 ud_4                -5.918785e-02 1 1  ON 14
 ud_5                -1.022368e-01 1 1  ON 15
 ud_6                -1.294732e-01 1 1  ON 16
 ud_7                -1.446300e-01 1 1  ON 17
 ud_8                -1.432717e-01 1 1  ON 18
 ud_9                -1.347183e-01 1 1  ON 19
 eO_0                -7.163680e-01 1 1  ON 20
 eO_1                -4.159053e-01 1 1  ON 21
 eO_2                -2.420683e-02 1 1  ON 22
 eO_3                 2.760668e-01 1 1  ON 23
 eO_4                 4.938240e-01 1 1  ON 24
 eO_5                 4.584338e-01 1 1  ON 25
 eO_6                 2.356334e-01 1 1  ON 26
 eO_7                -5.572440e-02 1 1  ON 27
 eO_8                -1.964506e-01 1 1  ON 28
 eO_9                -5.814279e-02 1 1  ON 29
eH1_0                -2.144256e-01 1 1  ON 30
eH1_1                -1.278561e-01 1 1  ON 31
eH1_2                -8.757134e-02 1 1  ON 32
eH1_3                -3.620577e-02 1 1  ON 33
eH1_4                 1.255338e-02 1 1  ON 34
eH1_5                 4.514423e-02 1 1  ON 35
eH1_6                 9.461149e-02 1 1  ON 36
eH1_7                 1.383814e-01 1 1  ON 37
eH1_8                 1.463430e-01 1 1  ON 38
eH1_9                 3.353048e-02 1 1  ON 39
eH2_0                -2.130292e-01 1 1  ON 40
eH2_1                -1.269661e-01 1 1  ON 41
eH2_2                -8.650635e-02 1 1  ON 42
eH2_3                -3.525640e-02 1 1  ON 43
eH2_4                 1.381140e-02 1 1  ON 44
eH2_5                 4.824448e-02 1 1  ON 45
eH2_6                 1.006332e-01 1 1  ON 46
eH2_7                 1.494026e-01 1 1  ON 47
eH2_8                 1.544733e-01 1 1  ON 48
eH2_9                 1.381519e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7948e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6885e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.9634
    reference variance = 0.369068
====================================================
  Execution time = 2.0462e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2653e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5126e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326454487579
                                         uncertainty =       0.003378681009

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326454487579
                                         uncertainty =       0.003378681009

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404063695
  error estimate for blocks of size 2^( 2) =       0.000417317522
  error estimate for blocks of size 2^( 3) =       0.000431382880
  error estimate for blocks of size 2^( 4) =       0.000443406941
  error estimate for blocks of size 2^( 5) =       0.000454428117
  error estimate for blocks of size 2^( 6) =       0.000463544230
  error estimate for blocks of size 2^( 7) =       0.000467863375

      target function =                  N/A
              le_mean =     -16.905453339795
             les_mean =     286.120887399948
             stat err =       0.000457310666
             autocorr =       1.280922926208
              std dev =       0.571432357516
             le_variance =       0.326534939216


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690545333980e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905453339795       residual = 4.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905479882603       residual = 2.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905502530337       residual = 7.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905510073904       residual = 9.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905529970600       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905535146441       residual = 6.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905533336584       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905532374966       residual = 8.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905533461924       residual = 8.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905533355031       residual = 5.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905533633860       residual = 9.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 3.622534e-03

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905453339795       residual = 4.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905461711243       residual = 3.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905469554879       residual = 7.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905471565340       residual = 7.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905478000293       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905479081744       residual = 4.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905478553514       residual = 6.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905478370723       residual = 2.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905478477593       residual = 2.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905478465544       residual = 1.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905478529280       residual = 1.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 1.037303e-03

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905453339795       residual = 4.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905455579093       residual = 3.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905457751196       residual = 7.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905458275075       residual = 6.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905459994667       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905460297415       residual = 3.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905460115143       residual = 5.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905460091003       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905460095796       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905460101497       residual = 4.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 2.694495e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.215976 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5987e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.026602e-01 1 1  ON 0
 uu_1                 1.388402e-01 1 1  ON 1
 uu_2                 4.040129e-02 1 1  ON 2
 uu_3                -1.941259e-02 1 1  ON 3
 uu_4                -6.253765e-02 1 1  ON 4
 uu_5                -9.560968e-02 1 1  ON 5
 uu_6                -1.207011e-01 1 1  ON 6
 uu_7                -1.313446e-01 1 1  ON 7
 uu_8                -1.207273e-01 1 1  ON 8
 uu_9                -9.253979e-02 1 1  ON 9
 ud_0                 4.216981e-01 1 1  ON 10
 ud_1                 1.646480e-01 1 1  ON 11
 ud_2                 5.702736e-02 1 1  ON 12
 ud_3                -3.751856e-03 1 1  ON 13
 ud_4                -5.936929e-02 1 1  ON 14
 ud_5                -1.022887e-01 1 1  ON 15
 ud_6                -1.295923e-01 1 1  ON 16
 ud_7                -1.447664e-01 1 1  ON 17
 ud_8                -1.433603e-01 1 1  ON 18
 ud_9                -1.347113e-01 1 1  ON 19
 eO_0                -7.174053e-01 1 1  ON 20
 eO_1                -4.162022e-01 1 1  ON 21
 eO_2                -2.348383e-02 1 1  ON 22
 eO_3                 2.767234e-01 1 1  ON 23
 eO_4                 4.940315e-01 1 1  ON 24
 eO_5                 4.583437e-01 1 1  ON 25
 eO_6                 2.355689e-01 1 1  ON 26
 eO_7                -5.571138e-02 1 1  ON 27
 eO_8                -1.965073e-01 1 1  ON 28
 eO_9                -5.819133e-02 1 1  ON 29
eH1_0                -2.148361e-01 1 1  ON 30
eH1_1                -1.278975e-01 1 1  ON 31
eH1_2                -8.746244e-02 1 1  ON 32
eH1_3                -3.608154e-02 1 1  ON 33
eH1_4                 1.256515e-02 1 1  ON 34
eH1_5                 4.514567e-02 1 1  ON 35
eH1_6                 9.462949e-02 1 1  ON 36
eH1_7                 1.384260e-01 1 1  ON 37
eH1_8                 1.464270e-01 1 1  ON 38
eH1_9                 3.358491e-02 1 1  ON 39
eH2_0                -2.134376e-01 1 1  ON 40
eH2_1                -1.269760e-01 1 1  ON 41
eH2_2                -8.642702e-02 1 1  ON 42
eH2_3                -3.509557e-02 1 1  ON 43
eH2_4                 1.391763e-02 1 1  ON 44
eH2_5                 4.824495e-02 1 1  ON 45
eH2_6                 1.005930e-01 1 1  ON 46
eH2_7                 1.493687e-01 1 1  ON 47
eH2_8                 1.545338e-01 1 1  ON 48
eH2_9                 1.390184e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.9159
    reference variance = 0.382656
====================================================
  Execution time = 2.0136e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3186e-01
  Total weights = 2.0000e+06
  Execution time = 1.8822e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331355580590
                                         uncertainty =       0.003582908817

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331355580590
                                         uncertainty =       0.003582908817

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406990685
  error estimate for blocks of size 2^( 2) =       0.000420249142
  error estimate for blocks of size 2^( 3) =       0.000433385527
  error estimate for blocks of size 2^( 4) =       0.000446081998
  error estimate for blocks of size 2^( 5) =       0.000457481747
  error estimate for blocks of size 2^( 6) =       0.000466911079
  error estimate for blocks of size 2^( 7) =       0.000472233729

      target function =                  N/A
              le_mean =     -16.905310404317
             les_mean =     286.120802535832
             stat err =       0.000460677138
             autocorr =       1.281221984701
              std dev =       0.575571746333
             le_variance =       0.331282835176

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333270401516
                                         uncertainty =       0.003601197562

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333270401516
                                         uncertainty =       0.003601197562

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408164631
  error estimate for blocks of size 2^( 2) =       0.000421264027
  error estimate for blocks of size 2^( 3) =       0.000434251142
  error estimate for blocks of size 2^( 4) =       0.000446871663
  error estimate for blocks of size 2^( 5) =       0.000458223131
  error estimate for blocks of size 2^( 6) =       0.000467609251
  error estimate for blocks of size 2^( 7) =       0.000472897735

      target function =                  N/A
              le_mean =     -16.905320778654
             les_mean =     286.123067194164
             stat err =       0.000461400445
             autocorr =       1.277865900123
              std dev =       0.577231956459
             le_variance =       0.333196731558

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332539391215
                                         uncertainty =       0.003593522853

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332539391215
                                         uncertainty =       0.003593522853

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407716863
  error estimate for blocks of size 2^( 2) =       0.000420872696
  error estimate for blocks of size 2^( 3) =       0.000433913647
  error estimate for blocks of size 2^( 4) =       0.000446562741
  error estimate for blocks of size 2^( 5) =       0.000457931408
  error estimate for blocks of size 2^( 6) =       0.000467332618
  error estimate for blocks of size 2^( 7) =       0.000472632771

      target function =                  N/A
              le_mean =     -16.905312773127
             les_mean =     286.122065871424
             stat err =       0.000461114884
             autocorr =       1.279089501078
              std dev =       0.576598716963
             le_variance =       0.332466080404

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331508500751
                                         uncertainty =       0.003584278223

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331508500751
                                         uncertainty =       0.003584278223

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407084562
  error estimate for blocks of size 2^( 2) =       0.000420328787
  error estimate for blocks of size 2^( 3) =       0.000433452053
  error estimate for blocks of size 2^( 4) =       0.000446142079
  error estimate for blocks of size 2^( 5) =       0.000457537614
  error estimate for blocks of size 2^( 6) =       0.000466963111
  error estimate for blocks of size 2^( 7) =       0.000472282680

      target function =                  N/A
              le_mean =     -16.905309740870
             les_mean =     286.120932949674
             stat err =       0.000460731371
             autocorr =       1.280932674036
              std dev =       0.575704508089
             le_variance =       0.331435680634


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905310404317        initial
     6.2500e-01     6.2500e+00             3.6225e-03       -16.905320778654  <--
     2.5000e+00     2.5000e+01             1.0373e-03       -16.905312773127
     1.0000e+01     1.0000e+02             2.6945e-04       -16.905309740870

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 2.9645e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.028199e-01 1 1  ON 0
 uu_1                 1.388672e-01 1 1  ON 1
 uu_2                 4.020704e-02 1 1  ON 2
 uu_3                -1.948285e-02 1 1  ON 3
 uu_4                -6.238508e-02 1 1  ON 4
 uu_5                -9.552270e-02 1 1  ON 5
 uu_6                -1.208206e-01 1 1  ON 6
 uu_7                -1.314934e-01 1 1  ON 7
 uu_8                -1.209169e-01 1 1  ON 8
 uu_9                -9.254873e-02 1 1  ON 9
 ud_0                 4.238535e-01 1 1  ON 10
 ud_1                 1.656767e-01 1 1  ON 11
 ud_2                 5.656157e-02 1 1  ON 12
 ud_3                -5.011523e-03 1 1  ON 13
 ud_4                -5.995467e-02 1 1  ON 14
 ud_5                -1.024325e-01 1 1  ON 15
 ud_6                -1.298326e-01 1 1  ON 16
 ud_7                -1.450965e-01 1 1  ON 17
 ud_8                -1.435930e-01 1 1  ON 18
 ud_9                -1.346822e-01 1 1  ON 19
 eO_0                -7.199905e-01 1 1  ON 20
 eO_1                -4.170142e-01 1 1  ON 21
 eO_2                -2.190734e-02 1 1  ON 22
 eO_3                 2.784615e-01 1 1  ON 23
 eO_4                 4.947417e-01 1 1  ON 24
 eO_5                 4.581738e-01 1 1  ON 25
 eO_6                 2.353886e-01 1 1  ON 26
 eO_7                -5.567199e-02 1 1  ON 27
 eO_8                -1.966674e-01 1 1  ON 28
 eO_9                -5.833081e-02 1 1  ON 29
eH1_0                -2.159471e-01 1 1  ON 30
eH1_1                -1.280254e-01 1 1  ON 31
eH1_2                -8.718831e-02 1 1  ON 32
eH1_3                -3.577900e-02 1 1  ON 33
eH1_4                 1.257774e-02 1 1  ON 34
eH1_5                 4.515918e-02 1 1  ON 35
eH1_6                 9.470389e-02 1 1  ON 36
eH1_7                 1.385654e-01 1 1  ON 37
eH1_8                 1.466748e-01 1 1  ON 38
eH1_9                 3.374499e-02 1 1  ON 39
eH2_0                -2.145359e-01 1 1  ON 40
eH2_1                -1.270324e-01 1 1  ON 41
eH2_2                -8.619138e-02 1 1  ON 42
eH2_3                -3.470139e-02 1 1  ON 43
eH2_4                 1.417615e-02 1 1  ON 44
eH2_5                 4.827504e-02 1 1  ON 45
eH2_6                 1.005012e-01 1 1  ON 46
eH2_7                 1.492735e-01 1 1  ON 47
eH2_8                 1.547080e-01 1 1  ON 48
eH2_9                 1.415472e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5638e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.9409
    reference variance = 0.188671
====================================================
  Execution time = 2.0584e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.6731e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6148e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.367416815294
                                         uncertainty =       0.033716419491

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.367416815294
                                         uncertainty =       0.033716419491

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000428552214
  error estimate for blocks of size 2^( 2) =       0.000441048246
  error estimate for blocks of size 2^( 3) =       0.000454126267
  error estimate for blocks of size 2^( 4) =       0.000466130555
  error estimate for blocks of size 2^( 5) =       0.000477472420
  error estimate for blocks of size 2^( 6) =       0.000486472442
  error estimate for blocks of size 2^( 7) =       0.000492346971

      target function =                  N/A
              le_mean =     -16.905649258225
             les_mean =     286.168290659178
             stat err =       0.000480605597
             autocorr =       1.257680020781
              std dev =       0.606064353612
             le_variance =       0.367314000719


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690564925822e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905649258225       residual = 2.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905677316791       residual = 1.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905714860083       residual = 5.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905745400452       residual = 5.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905754764984       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905767078517       residual = 8.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905765837375       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905770449195       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905770482020       residual = 6.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905768469129       residual = 3.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905768275646       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905768725773       residual = 4.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905769828341       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905769661613       residual = 5.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 9.212466e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905649258225       residual = 2.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905661761058       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905679575967       residual = 4.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905687729665       residual = 6.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905696184696       residual = 9.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905698414812       residual = 4.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905697746817       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905697275335       residual = 6.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905698064955       residual = 7.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905698071078       residual = 3.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905697996299       residual = 8.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 3.247321e-03

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905649258225       residual = 2.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905653143970       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905658963852       residual = 5.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905660929864       residual = 5.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905664175631       residual = 5.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905664343684       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905664078536       residual = 5.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905663941194       residual = 2.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905664024074       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905664056578       residual = 7.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 9.322808e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.220782 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6211e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.030626e-01 1 1  ON 0
 uu_1                 1.387421e-01 1 1  ON 1
 uu_2                 3.997197e-02 1 1  ON 2
 uu_3                -1.965940e-02 1 1  ON 3
 uu_4                -6.219009e-02 1 1  ON 4
 uu_5                -9.536048e-02 1 1  ON 5
 uu_6                -1.208038e-01 1 1  ON 6
 uu_7                -1.317030e-01 1 1  ON 7
 uu_8                -1.211510e-01 1 1  ON 8
 uu_9                -9.263233e-02 1 1  ON 9
 ud_0                 4.263349e-01 1 1  ON 10
 ud_1                 1.669803e-01 1 1  ON 11
 ud_2                 5.610501e-02 1 1  ON 12
 ud_3                -6.400378e-03 1 1  ON 13
 ud_4                -6.078286e-02 1 1  ON 14
 ud_5                -1.027709e-01 1 1  ON 15
 ud_6                -1.299956e-01 1 1  ON 16
 ud_7                -1.454236e-01 1 1  ON 17
 ud_8                -1.440273e-01 1 1  ON 18
 ud_9                -1.346831e-01 1 1  ON 19
 eO_0                -7.232379e-01 1 1  ON 20
 eO_1                -4.178701e-01 1 1  ON 21
 eO_2                -2.018374e-02 1 1  ON 22
 eO_3                 2.804331e-01 1 1  ON 23
 eO_4                 4.956680e-01 1 1  ON 24
 eO_5                 4.581207e-01 1 1  ON 25
 eO_6                 2.352868e-01 1 1  ON 26
 eO_7                -5.557516e-02 1 1  ON 27
 eO_8                -1.969240e-01 1 1  ON 28
 eO_9                -5.852193e-02 1 1  ON 29
eH1_0                -2.173693e-01 1 1  ON 30
eH1_1                -1.281746e-01 1 1  ON 31
eH1_2                -8.697954e-02 1 1  ON 32
eH1_3                -3.549597e-02 1 1  ON 33
eH1_4                 1.278420e-02 1 1  ON 34
eH1_5                 4.517584e-02 1 1  ON 35
eH1_6                 9.481075e-02 1 1  ON 36
eH1_7                 1.386581e-01 1 1  ON 37
eH1_8                 1.470542e-01 1 1  ON 38
eH1_9                 3.401908e-02 1 1  ON 39
eH2_0                -2.159314e-01 1 1  ON 40
eH2_1                -1.271889e-01 1 1  ON 41
eH2_2                -8.590217e-02 1 1  ON 42
eH2_3                -3.427283e-02 1 1  ON 43
eH2_4                 1.448051e-02 1 1  ON 44
eH2_5                 4.845493e-02 1 1  ON 45
eH2_6                 1.005170e-01 1 1  ON 46
eH2_7                 1.490064e-01 1 1  ON 47
eH2_8                 1.548479e-01 1 1  ON 48
eH2_9                 1.453724e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.949
    reference variance = 0.156772
====================================================
  Execution time = 2.0475e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3063e-01
  Total weights = 2.0000e+06
  Execution time = 1.8665e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328676536008
                                         uncertainty =       0.004100021743

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328676536008
                                         uncertainty =       0.004100021743

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405584860
  error estimate for blocks of size 2^( 2) =       0.000418734252
  error estimate for blocks of size 2^( 3) =       0.000432294542
  error estimate for blocks of size 2^( 4) =       0.000443714572
  error estimate for blocks of size 2^( 5) =       0.000454241765
  error estimate for blocks of size 2^( 6) =       0.000462836287
  error estimate for blocks of size 2^( 7) =       0.000466389721

      target function =                  N/A
              le_mean =     -16.905208130713
             les_mean =     286.115059935304
             stat err =       0.000456795586
             autocorr =       1.268470373261
              std dev =       0.573583609506
             le_variance =       0.328998157094

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332720350009
                                         uncertainty =       0.004200720409

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332720350009
                                         uncertainty =       0.004200720409

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408062842
  error estimate for blocks of size 2^( 2) =       0.000420962370
  error estimate for blocks of size 2^( 3) =       0.000434287183
  error estimate for blocks of size 2^( 4) =       0.000445515213
  error estimate for blocks of size 2^( 5) =       0.000455898208
  error estimate for blocks of size 2^( 6) =       0.000464425829
  error estimate for blocks of size 2^( 7) =       0.000467928551

      target function =                  N/A
              le_mean =     -16.905188625155
             les_mean =     286.118432851941
             stat err =       0.000458441950
             autocorr =       1.262160553290
              std dev =       0.577088005745
             le_variance =       0.333030566375

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332095636671
                                         uncertainty =       0.004197214355

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332095636671
                                         uncertainty =       0.004197214355

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407681531
  error estimate for blocks of size 2^( 2) =       0.000420613853
  error estimate for blocks of size 2^( 3) =       0.000433978912
  error estimate for blocks of size 2^( 4) =       0.000445239719
  error estimate for blocks of size 2^( 5) =       0.000455644005
  error estimate for blocks of size 2^( 6) =       0.000464186101
  error estimate for blocks of size 2^( 7) =       0.000467704609

      target function =                  N/A
              le_mean =     -16.905182364712
             les_mean =     286.117599079971
             stat err =       0.000458193608
             autocorr =       1.263153058981
              std dev =       0.576548750774
             le_variance =       0.332408462019

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329171175367
                                         uncertainty =       0.004115961913

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329171175367
                                         uncertainty =       0.004115961913

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405888854
  error estimate for blocks of size 2^( 2) =       0.000419001302
  error estimate for blocks of size 2^( 3) =       0.000432529562
  error estimate for blocks of size 2^( 4) =       0.000443923925
  error estimate for blocks of size 2^( 5) =       0.000454431099
  error estimate for blocks of size 2^( 6) =       0.000463017638
  error estimate for blocks of size 2^( 7) =       0.000466566671

      target function =                  N/A
              le_mean =     -16.905197564426
             les_mean =     286.115196050396
             stat err =       0.000456984833
             autocorr =       1.267620701849
              std dev =       0.574013521516
             le_variance =       0.329491522883


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905208130713        initial  <--
     1.5625e-01     1.5625e+00             9.2125e-03       -16.905188625155
     6.2500e-01     6.2500e+00             3.2473e-03       -16.905182364712
     2.5000e+00     2.5000e+01             9.3228e-04       -16.905197564426

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8903
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.028199e-01 1 1  ON 0
 uu_1                 1.388672e-01 1 1  ON 1
 uu_2                 4.020704e-02 1 1  ON 2
 uu_3                -1.948285e-02 1 1  ON 3
 uu_4                -6.238508e-02 1 1  ON 4
 uu_5                -9.552270e-02 1 1  ON 5
 uu_6                -1.208206e-01 1 1  ON 6
 uu_7                -1.314934e-01 1 1  ON 7
 uu_8                -1.209169e-01 1 1  ON 8
 uu_9                -9.254873e-02 1 1  ON 9
 ud_0                 4.238535e-01 1 1  ON 10
 ud_1                 1.656767e-01 1 1  ON 11
 ud_2                 5.656157e-02 1 1  ON 12
 ud_3                -5.011523e-03 1 1  ON 13
 ud_4                -5.995467e-02 1 1  ON 14
 ud_5                -1.024325e-01 1 1  ON 15
 ud_6                -1.298326e-01 1 1  ON 16
 ud_7                -1.450965e-01 1 1  ON 17
 ud_8                -1.435930e-01 1 1  ON 18
 ud_9                -1.346822e-01 1 1  ON 19
 eO_0                -7.199905e-01 1 1  ON 20
 eO_1                -4.170142e-01 1 1  ON 21
 eO_2                -2.190734e-02 1 1  ON 22
 eO_3                 2.784615e-01 1 1  ON 23
 eO_4                 4.947417e-01 1 1  ON 24
 eO_5                 4.581738e-01 1 1  ON 25
 eO_6                 2.353886e-01 1 1  ON 26
 eO_7                -5.567199e-02 1 1  ON 27
 eO_8                -1.966674e-01 1 1  ON 28
 eO_9                -5.833081e-02 1 1  ON 29
eH1_0                -2.159471e-01 1 1  ON 30
eH1_1                -1.280254e-01 1 1  ON 31
eH1_2                -8.718831e-02 1 1  ON 32
eH1_3                -3.577900e-02 1 1  ON 33
eH1_4                 1.257774e-02 1 1  ON 34
eH1_5                 4.515918e-02 1 1  ON 35
eH1_6                 9.470389e-02 1 1  ON 36
eH1_7                 1.385654e-01 1 1  ON 37
eH1_8                 1.466748e-01 1 1  ON 38
eH1_9                 3.374499e-02 1 1  ON 39
eH2_0                -2.145359e-01 1 1  ON 40
eH2_1                -1.270324e-01 1 1  ON 41
eH2_2                -8.619138e-02 1 1  ON 42
eH2_3                -3.470139e-02 1 1  ON 43
eH2_4                 1.417615e-02 1 1  ON 44
eH2_5                 4.827504e-02 1 1  ON 45
eH2_6                 1.005012e-01 1 1  ON 46
eH2_7                 1.492735e-01 1 1  ON 47
eH2_8                 1.547080e-01 1 1  ON 48
eH2_9                 1.415472e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6107e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6914e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.8902
    reference variance = 0.274869
====================================================
  Execution time = 2.0357e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3414e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7205e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334181693858
                                         uncertainty =       0.004344618284

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334181693858
                                         uncertainty =       0.004344618284

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408739557
  error estimate for blocks of size 2^( 2) =       0.000421884066
  error estimate for blocks of size 2^( 3) =       0.000435314338
  error estimate for blocks of size 2^( 4) =       0.000447356005
  error estimate for blocks of size 2^( 5) =       0.000458817779
  error estimate for blocks of size 2^( 6) =       0.000467894978
  error estimate for blocks of size 2^( 7) =       0.000475200270

      target function =                  N/A
              le_mean =     -16.905746315383
             les_mean =     286.138394364366
             stat err =       0.000462317258
             autocorr =       1.279342629570
              std dev =       0.578045025378
             le_variance =       0.334136051364


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690574631538e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905746315383       residual = 2.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905755424672       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905765994842       residual = 3.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905768798062       residual = 6.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905772307724       residual = 6.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905771959181       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905772212925       residual = 5.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905772111608       residual = 2.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905772111793       residual = 2.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905772148582       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905772162606       residual = 2.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 1.350675e-03

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905746315383       residual = 2.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905748813914       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905751863137       residual = 3.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905752471766       residual = 6.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905753541075       residual = 4.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905753414162       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905753462738       residual = 4.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905753425793       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905753407077       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905753417384       residual = 3.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 3.578855e-04

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905746315383       residual = 2.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905746955561       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905747748381       residual = 3.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905747895779       residual = 6.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905748175462       residual = 4.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905748141125       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905748152252       residual = 3.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905748142106       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905748136082       residual = 9.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+01 is 9.083366e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.224465 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6092e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.028122e-01 1 1  ON 0
 uu_1                 1.388678e-01 1 1  ON 1
 uu_2                 4.018814e-02 1 1  ON 2
 uu_3                -1.947675e-02 1 1  ON 3
 uu_4                -6.236826e-02 1 1  ON 4
 uu_5                -9.550094e-02 1 1  ON 5
 uu_6                -1.208219e-01 1 1  ON 6
 uu_7                -1.315126e-01 1 1  ON 7
 uu_8                -1.209406e-01 1 1  ON 8
 uu_9                -9.255875e-02 1 1  ON 9
 ud_0                 4.241538e-01 1 1  ON 10
 ud_1                 1.658321e-01 1 1  ON 11
 ud_2                 5.648794e-02 1 1  ON 12
 ud_3                -5.169612e-03 1 1  ON 13
 ud_4                -6.005207e-02 1 1  ON 14
 ud_5                -1.024499e-01 1 1  ON 15
 ud_6                -1.298496e-01 1 1  ON 16
 ud_7                -1.451241e-01 1 1  ON 17
 ud_8                -1.436448e-01 1 1  ON 18
 ud_9                -1.346956e-01 1 1  ON 19
 eO_0                -7.203484e-01 1 1  ON 20
 eO_1                -4.171118e-01 1 1  ON 21
 eO_2                -2.169825e-02 1 1  ON 22
 eO_3                 2.786944e-01 1 1  ON 23
 eO_4                 4.948231e-01 1 1  ON 24
 eO_5                 4.581529e-01 1 1  ON 25
 eO_6                 2.353875e-01 1 1  ON 26
 eO_7                -5.565998e-02 1 1  ON 27
 eO_8                -1.967011e-01 1 1  ON 28
 eO_9                -5.835337e-02 1 1  ON 29
eH1_0                -2.160879e-01 1 1  ON 30
eH1_1                -1.280484e-01 1 1  ON 31
eH1_2                -8.715624e-02 1 1  ON 32
eH1_3                -3.574591e-02 1 1  ON 33
eH1_4                 1.260726e-02 1 1  ON 34
eH1_5                 4.517587e-02 1 1  ON 35
eH1_6                 9.470336e-02 1 1  ON 36
eH1_7                 1.385612e-01 1 1  ON 37
eH1_8                 1.467020e-01 1 1  ON 38
eH1_9                 3.377184e-02 1 1  ON 39
eH2_0                -2.146874e-01 1 1  ON 40
eH2_1                -1.270519e-01 1 1  ON 41
eH2_2                -8.614584e-02 1 1  ON 42
eH2_3                -3.465978e-02 1 1  ON 43
eH2_4                 1.419982e-02 1 1  ON 44
eH2_5                 4.827767e-02 1 1  ON 45
eH2_6                 1.004967e-01 1 1  ON 46
eH2_7                 1.492756e-01 1 1  ON 47
eH2_8                 1.547340e-01 1 1  ON 48
eH2_9                 1.418734e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.8585
    reference variance = 0.366259
====================================================
  Execution time = 2.0080e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3224e-01
  Total weights = 2.0000e+06
  Execution time = 1.8743e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332080594523
                                         uncertainty =       0.004933907363

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332080594523
                                         uncertainty =       0.004933907363

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407467815
  error estimate for blocks of size 2^( 2) =       0.000420605118
  error estimate for blocks of size 2^( 3) =       0.000433598171
  error estimate for blocks of size 2^( 4) =       0.000445819704
  error estimate for blocks of size 2^( 5) =       0.000456571038
  error estimate for blocks of size 2^( 6) =       0.000462741606
  error estimate for blocks of size 2^( 7) =       0.000464569496

      target function =                  N/A
              le_mean =     -16.905174417046
             les_mean =     286.116981944674
             stat err =       0.000457425461
             autocorr =       1.260242288114
              std dev =       0.576246509725
             le_variance =       0.332060039971

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332735791363
                                         uncertainty =       0.004941634447

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332735791363
                                         uncertainty =       0.004941634447

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407869651
  error estimate for blocks of size 2^( 2) =       0.000420955001
  error estimate for blocks of size 2^( 3) =       0.000433904301
  error estimate for blocks of size 2^( 4) =       0.000446098216
  error estimate for blocks of size 2^( 5) =       0.000456839412
  error estimate for blocks of size 2^( 6) =       0.000463003705
  error estimate for blocks of size 2^( 7) =       0.000464827881

      target function =                  N/A
              le_mean =     -16.905177801420
             les_mean =     286.117751635275
             stat err =       0.000457692304
             autocorr =       1.259228188624
              std dev =       0.576814791784
             le_variance =       0.332715304021

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332442120689
                                         uncertainty =       0.004938081927

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332442120689
                                         uncertainty =       0.004938081927

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407689591
  error estimate for blocks of size 2^( 2) =       0.000420797791
  error estimate for blocks of size 2^( 3) =       0.000433766450
  error estimate for blocks of size 2^( 4) =       0.000445972390
  error estimate for blocks of size 2^( 5) =       0.000456718518
  error estimate for blocks of size 2^( 6) =       0.000462886247
  error estimate for blocks of size 2^( 7) =       0.000464712310

      target function =                  N/A
              le_mean =     -16.905175826001
             les_mean =     286.117391146374
             stat err =       0.000457572366
             autocorr =       1.259680281822
              std dev =       0.576560148277
             le_variance =       0.332421604581

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332127123218
                                         uncertainty =       0.004934443764

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332127123218
                                         uncertainty =       0.004934443764

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407496364
  error estimate for blocks of size 2^( 2) =       0.000420629863
  error estimate for blocks of size 2^( 3) =       0.000433619740
  error estimate for blocks of size 2^( 4) =       0.000445839232
  error estimate for blocks of size 2^( 5) =       0.000456589912
  error estimate for blocks of size 2^( 6) =       0.000462760157
  error estimate for blocks of size 2^( 7) =       0.000464587829

      target function =                  N/A
              le_mean =     -16.905174522431
             les_mean =     286.117032041410
             stat err =       0.000457444283
             autocorr =       1.260169404795
              std dev =       0.576286884808
             le_variance =       0.332106573602


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905174417046        initial
     1.5625e+00     1.5625e+01             1.3507e-03       -16.905177801420  <--
     6.2500e+00     6.2500e+01             3.5789e-04       -16.905175826001
     2.5000e+01     2.5000e+02             9.0834e-05       -16.905174522431

*****************************************************************************
Applying the update for shift_i =   1.5625e+00     and shift_s =   1.5625e+01
*****************************************************************************

  Execution time = 2.9530e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.028074e-01 1 1  ON 0
 uu_1                 1.388717e-01 1 1  ON 1
 uu_2                 4.013984e-02 1 1  ON 2
 uu_3                -1.947475e-02 1 1  ON 3
 uu_4                -6.233236e-02 1 1  ON 4
 uu_5                -9.544268e-02 1 1  ON 5
 uu_6                -1.208234e-01 1 1  ON 6
 uu_7                -1.315661e-01 1 1  ON 7
 uu_8                -1.210103e-01 1 1  ON 8
 uu_9                -9.258863e-02 1 1  ON 9
 ud_0                 4.249570e-01 1 1  ON 10
 ud_1                 1.662403e-01 1 1  ON 11
 ud_2                 5.632971e-02 1 1  ON 12
 ud_3                -5.592084e-03 1 1  ON 13
 ud_4                -6.033140e-02 1 1  ON 14
 ud_5                -1.025074e-01 1 1  ON 15
 ud_6                -1.298902e-01 1 1  ON 16
 ud_7                -1.451948e-01 1 1  ON 17
 ud_8                -1.437917e-01 1 1  ON 18
 ud_9                -1.347337e-01 1 1  ON 19
 eO_0                -7.213412e-01 1 1  ON 20
 eO_1                -4.174043e-01 1 1  ON 21
 eO_2                -2.114923e-02 1 1  ON 22
 eO_3                 2.793536e-01 1 1  ON 23
 eO_4                 4.950788e-01 1 1  ON 24
 eO_5                 4.581089e-01 1 1  ON 25
 eO_6                 2.353881e-01 1 1  ON 26
 eO_7                -5.562226e-02 1 1  ON 27
 eO_8                -1.968011e-01 1 1  ON 28
 eO_9                -5.842112e-02 1 1  ON 29
eH1_0                -2.164931e-01 1 1  ON 30
eH1_1                -1.281199e-01 1 1  ON 31
eH1_2                -8.706482e-02 1 1  ON 32
eH1_3                -3.565598e-02 1 1  ON 33
eH1_4                 1.268682e-02 1 1  ON 34
eH1_5                 4.522596e-02 1 1  ON 35
eH1_6                 9.470636e-02 1 1  ON 36
eH1_7                 1.385508e-01 1 1  ON 37
eH1_8                 1.467844e-01 1 1  ON 38
eH1_9                 3.385313e-02 1 1  ON 39
eH2_0                -2.151223e-01 1 1  ON 40
eH2_1                -1.271110e-01 1 1  ON 41
eH2_2                -8.601775e-02 1 1  ON 42
eH2_3                -3.454505e-02 1 1  ON 43
eH2_4                 1.426322e-02 1 1  ON 44
eH2_5                 4.828552e-02 1 1  ON 45
eH2_6                 1.004869e-01 1 1  ON 46
eH2_7                 1.492835e-01 1 1  ON 47
eH2_8                 1.548126e-01 1 1  ON 48
eH2_9                 1.428596e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5627e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.8908
    reference variance = 0.288257
====================================================
  Execution time = 2.0416e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2663e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7537e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326686432476
                                         uncertainty =       0.002732248135

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326686432476
                                         uncertainty =       0.002732248135

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404122204
  error estimate for blocks of size 2^( 2) =       0.000417692957
  error estimate for blocks of size 2^( 3) =       0.000430827072
  error estimate for blocks of size 2^( 4) =       0.000443421988
  error estimate for blocks of size 2^( 5) =       0.000453766012
  error estimate for blocks of size 2^( 6) =       0.000463587202
  error estimate for blocks of size 2^( 7) =       0.000468517467

      target function =                  N/A
              le_mean =     -16.904943277905
             les_mean =     286.103736577072
             stat err =       0.000457323167
             autocorr =       1.280622061498
              std dev =       0.571515101459
             le_variance =       0.326629511196


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690494327791e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904943277905       residual = 2.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904957498181       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904979742603       residual = 3.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904997334726       residual = 2.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905001165622       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905005996040       residual = 5.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905007385724       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905008545627       residual = 8.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905008894489       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905009354850       residual = 8.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905009028588       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905009006866       residual = 4.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 4.380557e-03

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904943277905       residual = 2.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904948043548       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904955875025       residual = 3.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904959815891       residual = 5.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904962023857       residual = 9.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904963305654       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904963711548       residual = 4.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904963675225       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.904963650845       residual = 2.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.904963772298       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.904963768860       residual = 1.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 1.317875e-03

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904943277905       residual = 2.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904944580178       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904946766338       residual = 3.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904947658168       residual = 5.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904948385074       residual = 8.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904948688864       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904948792642       residual = 3.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904948753380       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.904948732258       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.904948757074       residual = 4.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 3.494467e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.228703 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6182e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.029059e-01 1 1  ON 0
 uu_1                 1.388769e-01 1 1  ON 1
 uu_2                 4.002938e-02 1 1  ON 2
 uu_3                -1.953126e-02 1 1  ON 3
 uu_4                -6.229823e-02 1 1  ON 4
 uu_5                -9.537168e-02 1 1  ON 5
 uu_6                -1.207809e-01 1 1  ON 6
 uu_7                -1.316343e-01 1 1  ON 7
 uu_8                -1.211529e-01 1 1  ON 8
 uu_9                -9.265509e-02 1 1  ON 9
 ud_0                 4.259550e-01 1 1  ON 10
 ud_1                 1.667512e-01 1 1  ON 11
 ud_2                 5.620515e-02 1 1  ON 12
 ud_3                -6.157647e-03 1 1  ON 13
 ud_4                -6.070117e-02 1 1  ON 14
 ud_5                -1.026121e-01 1 1  ON 15
 ud_6                -1.299628e-01 1 1  ON 16
 ud_7                -1.452554e-01 1 1  ON 17
 ud_8                -1.439223e-01 1 1  ON 18
 ud_9                -1.348069e-01 1 1  ON 19
 eO_0                -7.226591e-01 1 1  ON 20
 eO_1                -4.177854e-01 1 1  ON 21
 eO_2                -2.045034e-02 1 1  ON 22
 eO_3                 2.802423e-01 1 1  ON 23
 eO_4                 4.954541e-01 1 1  ON 24
 eO_5                 4.580673e-01 1 1  ON 25
 eO_6                 2.353410e-01 1 1  ON 26
 eO_7                -5.556995e-02 1 1  ON 27
 eO_8                -1.969205e-01 1 1  ON 28
 eO_9                -5.851586e-02 1 1  ON 29
eH1_0                -2.170535e-01 1 1  ON 30
eH1_1                -1.281729e-01 1 1  ON 31
eH1_2                -8.700903e-02 1 1  ON 32
eH1_3                -3.545449e-02 1 1  ON 33
eH1_4                 1.268514e-02 1 1  ON 34
eH1_5                 4.524398e-02 1 1  ON 35
eH1_6                 9.472539e-02 1 1  ON 36
eH1_7                 1.386222e-01 1 1  ON 37
eH1_8                 1.469085e-01 1 1  ON 38
eH1_9                 3.396665e-02 1 1  ON 39
eH2_0                -2.157473e-01 1 1  ON 40
eH2_1                -1.272091e-01 1 1  ON 41
eH2_2                -8.592132e-02 1 1  ON 42
eH2_3                -3.437938e-02 1 1  ON 43
eH2_4                 1.441207e-02 1 1  ON 44
eH2_5                 4.836259e-02 1 1  ON 45
eH2_6                 1.004941e-01 1 1  ON 46
eH2_7                 1.492389e-01 1 1  ON 47
eH2_8                 1.549168e-01 1 1  ON 48
eH2_9                 1.444244e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.862
    reference variance = 0.262163
====================================================
  Execution time = 2.2404e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3443e-01
  Total weights = 2.0000e+06
  Execution time = 1.8829e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333772470571
                                         uncertainty =       0.003769882971

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333772470571
                                         uncertainty =       0.003769882971

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408528829
  error estimate for blocks of size 2^( 2) =       0.000421606707
  error estimate for blocks of size 2^( 3) =       0.000435060537
  error estimate for blocks of size 2^( 4) =       0.000447577980
  error estimate for blocks of size 2^( 5) =       0.000457265913
  error estimate for blocks of size 2^( 6) =       0.000466864173
  error estimate for blocks of size 2^( 7) =       0.000471491064

      target function =                  N/A
              le_mean =     -16.905173176741
             les_mean =     286.118671576268
             stat err =       0.000460799783
             autocorr =       1.272269493159
              std dev =       0.577747009995
             le_variance =       0.333791607558

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335744406259
                                         uncertainty =       0.003801397036

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335744406259
                                         uncertainty =       0.003801397036

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409734450
  error estimate for blocks of size 2^( 2) =       0.000422680403
  error estimate for blocks of size 2^( 3) =       0.000436019194
  error estimate for blocks of size 2^( 4) =       0.000448440857
  error estimate for blocks of size 2^( 5) =       0.000458078855
  error estimate for blocks of size 2^( 6) =       0.000467662070
  error estimate for blocks of size 2^( 7) =       0.000472228408

      target function =                  N/A
              le_mean =     -16.905174847044
             les_mean =     286.120701080084
             stat err =       0.000461602548
             autocorr =       1.269204003664
              std dev =       0.579452015987
             le_variance =       0.335764638832

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335061438812
                                         uncertainty =       0.003788246172

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335061438812
                                         uncertainty =       0.003788246172

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409317296
  error estimate for blocks of size 2^( 2) =       0.000422306606
  error estimate for blocks of size 2^( 3) =       0.000435683393
  error estimate for blocks of size 2^( 4) =       0.000448137587
  error estimate for blocks of size 2^( 5) =       0.000457792037
  error estimate for blocks of size 2^( 6) =       0.000467378206
  error estimate for blocks of size 2^( 7) =       0.000471967637

      target function =                  N/A
              le_mean =     -16.905170572010
             les_mean =     286.119873198784
             stat err =       0.000461318867
             autocorr =       1.270229633497
              std dev =       0.578862071288
             le_variance =       0.335081297576

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333945316778
                                         uncertainty =       0.003772291257

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333945316778
                                         uncertainty =       0.003772291257

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408634648
  error estimate for blocks of size 2^( 2) =       0.000421699963
  error estimate for blocks of size 2^( 3) =       0.000435142905
  error estimate for blocks of size 2^( 4) =       0.000447651541
  error estimate for blocks of size 2^( 5) =       0.000457334767
  error estimate for blocks of size 2^( 6) =       0.000466931242
  error estimate for blocks of size 2^( 7) =       0.000471553100

      target function =                  N/A
              le_mean =     -16.905171910248
             les_mean =     286.118801699810
             stat err =       0.000460867662
             autocorr =       1.271985312145
              std dev =       0.577896661816
             le_variance =       0.333964551738


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905173176741        initial
     3.9062e-01     3.9062e+00             4.3806e-03       -16.905174847044  <--
     1.5625e+00     1.5625e+01             1.3179e-03       -16.905170572010
     6.2500e+00     6.2500e+01             3.4945e-04       -16.905171910248

*****************************************************************************
Applying the update for shift_i =   3.9062e-01     and shift_s =   3.9062e+00
*****************************************************************************

  Execution time = 3.1892e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.032383e-01 1 1  ON 0
 uu_1                 1.389463e-01 1 1  ON 1
 uu_2                 3.982389e-02 1 1  ON 2
 uu_3                -1.973546e-02 1 1  ON 3
 uu_4                -6.233700e-02 1 1  ON 4
 uu_5                -9.523651e-02 1 1  ON 5
 uu_6                -1.206764e-01 1 1  ON 6
 uu_7                -1.317940e-01 1 1  ON 7
 uu_8                -1.215490e-01 1 1  ON 8
 uu_9                -9.285528e-02 1 1  ON 9
 ud_0                 4.280628e-01 1 1  ON 10
 ud_1                 1.678415e-01 1 1  ON 11
 ud_2                 5.612717e-02 1 1  ON 12
 ud_3                -7.258422e-03 1 1  ON 13
 ud_4                -6.162934e-02 1 1  ON 14
 ud_5                -1.029467e-01 1 1  ON 15
 ud_6                -1.300978e-01 1 1  ON 16
 ud_7                -1.453549e-01 1 1  ON 17
 ud_8                -1.442333e-01 1 1  ON 18
 ud_9                -1.350000e-01 1 1  ON 19
 eO_0                -7.257218e-01 1 1  ON 20
 eO_1                -4.188769e-01 1 1  ON 21
 eO_2                -1.907701e-02 1 1  ON 22
 eO_3                 2.823740e-01 1 1  ON 23
 eO_4                 4.966211e-01 1 1  ON 24
 eO_5                 4.581362e-01 1 1  ON 25
 eO_6                 2.352478e-01 1 1  ON 26
 eO_7                -5.540585e-02 1 1  ON 27
 eO_8                -1.972614e-01 1 1  ON 28
 eO_9                -5.879363e-02 1 1  ON 29
eH1_0                -2.184737e-01 1 1  ON 30
eH1_1                -1.283657e-01 1 1  ON 31
eH1_2                -8.687806e-02 1 1  ON 32
eH1_3                -3.503866e-02 1 1  ON 33
eH1_4                 1.265574e-02 1 1  ON 34
eH1_5                 4.527349e-02 1 1  ON 35
eH1_6                 9.481655e-02 1 1  ON 36
eH1_7                 1.388504e-01 1 1  ON 37
eH1_8                 1.472798e-01 1 1  ON 38
eH1_9                 3.430628e-02 1 1  ON 39
eH2_0                -2.173338e-01 1 1  ON 40
eH2_1                -1.274873e-01 1 1  ON 41
eH2_2                -8.572228e-02 1 1  ON 42
eH2_3                -3.399997e-02 1 1  ON 43
eH2_4                 1.472734e-02 1 1  ON 44
eH2_5                 4.857279e-02 1 1  ON 45
eH2_6                 1.005581e-01 1 1  ON 46
eH2_7                 1.491295e-01 1 1  ON 47
eH2_8                 1.552234e-01 1 1  ON 48
eH2_9                 1.490569e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8079e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.889
    reference variance = 0.278453
====================================================
  Execution time = 2.0286e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.2707e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6595e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327114814871
                                         uncertainty =       0.002761389200

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327114814871
                                         uncertainty =       0.002761389200

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404394414
  error estimate for blocks of size 2^( 2) =       0.000417292196
  error estimate for blocks of size 2^( 3) =       0.000430795479
  error estimate for blocks of size 2^( 4) =       0.000443237680
  error estimate for blocks of size 2^( 5) =       0.000453309038
  error estimate for blocks of size 2^( 6) =       0.000461320226
  error estimate for blocks of size 2^( 7) =       0.000466830640

      target function =                  N/A
              le_mean =     -16.905934096370
             les_mean =     286.137677192225
             stat err =       0.000456174396
             autocorr =       1.272481608541
              std dev =       0.571900065532
             le_variance =       0.327069684956


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690593409637e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905934096370       residual = 8.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905935437047       residual = 5.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905959583024       residual = 3.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905973124077       residual = 3.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905989907476       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906006445840       residual = 5.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906004134578       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906008616400       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906006261886       residual = 9.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906008679029       residual = 3.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906009694626       residual = 2.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906009794378       residual = 8.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906010507986       residual = 2.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906010445751       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906010403859       residual = 3.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-02 is 9.021705e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905934096370       residual = 8.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905934756272       residual = 5.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905946693158       residual = 2.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905951773434       residual = 3.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905960434347       residual = 5.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905963482346       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905963200928       residual = 7.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905961997193       residual = 4.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905963097373       residual = 6.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905963087972       residual = 2.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905963358029       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905963280665       residual = 2.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 3.366882e-03

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905934096370       residual = 8.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905934314078       residual = 5.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905938265277       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905939918672       residual = 3.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905942674728       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905943011881       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905942864173       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905942527273       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905942777107       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905942786238       residual = 3.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 9.985783e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.234113 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5959e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.037990e-01 1 1  ON 0
 uu_1                 1.392404e-01 1 1  ON 1
 uu_2                 3.983426e-02 1 1  ON 2
 uu_3                -1.987104e-02 1 1  ON 3
 uu_4                -6.243180e-02 1 1  ON 4
 uu_5                -9.532265e-02 1 1  ON 5
 uu_6                -1.206405e-01 1 1  ON 6
 uu_7                -1.320547e-01 1 1  ON 7
 uu_8                -1.221661e-01 1 1  ON 8
 uu_9                -9.317785e-02 1 1  ON 9
 ud_0                 4.302655e-01 1 1  ON 10
 ud_1                 1.689597e-01 1 1  ON 11
 ud_2                 5.618814e-02 1 1  ON 12
 ud_3                -8.208225e-03 1 1  ON 13
 ud_4                -6.249691e-02 1 1  ON 14
 ud_5                -1.031148e-01 1 1  ON 15
 ud_6                -1.301186e-01 1 1  ON 16
 ud_7                -1.456704e-01 1 1  ON 17
 ud_8                -1.447763e-01 1 1  ON 18
 ud_9                -1.352326e-01 1 1  ON 19
 eO_0                -7.290886e-01 1 1  ON 20
 eO_1                -4.201378e-01 1 1  ON 21
 eO_2                -1.770558e-02 1 1  ON 22
 eO_3                 2.847122e-01 1 1  ON 23
 eO_4                 4.983417e-01 1 1  ON 24
 eO_5                 4.584053e-01 1 1  ON 25
 eO_6                 2.351445e-01 1 1  ON 26
 eO_7                -5.539216e-02 1 1  ON 27
 eO_8                -1.977568e-01 1 1  ON 28
 eO_9                -5.920276e-02 1 1  ON 29
eH1_0                -2.201134e-01 1 1  ON 30
eH1_1                -1.287383e-01 1 1  ON 31
eH1_2                -8.677776e-02 1 1  ON 32
eH1_3                -3.471629e-02 1 1  ON 33
eH1_4                 1.288785e-02 1 1  ON 34
eH1_5                 4.543211e-02 1 1  ON 35
eH1_6                 9.512136e-02 1 1  ON 36
eH1_7                 1.390400e-01 1 1  ON 37
eH1_8                 1.475527e-01 1 1  ON 38
eH1_9                 3.470175e-02 1 1  ON 39
eH2_0                -2.190158e-01 1 1  ON 40
eH2_1                -1.278984e-01 1 1  ON 41
eH2_2                -8.544302e-02 1 1  ON 42
eH2_3                -3.365776e-02 1 1  ON 43
eH2_4                 1.472141e-02 1 1  ON 44
eH2_5                 4.883673e-02 1 1  ON 45
eH2_6                 1.007815e-01 1 1  ON 46
eH2_7                 1.490884e-01 1 1  ON 47
eH2_8                 1.557263e-01 1 1  ON 48
eH2_9                 1.542581e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.9434
    reference variance = 0.239673
====================================================
  Execution time = 2.2110e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3207e-01
  Total weights = 2.0000e+06
  Execution time = 1.8594e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330724784565
                                         uncertainty =       0.003076322524

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330724784565
                                         uncertainty =       0.003076322524

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406644005
  error estimate for blocks of size 2^( 2) =       0.000420053971
  error estimate for blocks of size 2^( 3) =       0.000433554984
  error estimate for blocks of size 2^( 4) =       0.000445107437
  error estimate for blocks of size 2^( 5) =       0.000456540196
  error estimate for blocks of size 2^( 6) =       0.000464084972
  error estimate for blocks of size 2^( 7) =       0.000469816848

      target function =                  N/A
              le_mean =     -16.905769989155
             les_mean =     286.135777454407
             stat err =       0.000458887363
             autocorr =       1.273454547522
              std dev =       0.575081466884
             le_variance =       0.330718693554

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333831079171
                                         uncertainty =       0.003099854198

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333831079171
                                         uncertainty =       0.003099854198

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408548681
  error estimate for blocks of size 2^( 2) =       0.000421800843
  error estimate for blocks of size 2^( 3) =       0.000435126899
  error estimate for blocks of size 2^( 4) =       0.000446544063
  error estimate for blocks of size 2^( 5) =       0.000457894004
  error estimate for blocks of size 2^( 6) =       0.000465323436
  error estimate for blocks of size 2^( 7) =       0.000471011453

      target function =                  N/A
              le_mean =     -16.905780519718
             les_mean =     286.139238863840
             stat err =       0.000460193239
             autocorr =       1.268799042356
              std dev =       0.577775085880
             le_variance =       0.333824049863

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333519051330
                                         uncertainty =       0.003097420180

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333519051330
                                         uncertainty =       0.003097420180

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408357936
  error estimate for blocks of size 2^( 2) =       0.000421622239
  error estimate for blocks of size 2^( 3) =       0.000434968550
  error estimate for blocks of size 2^( 4) =       0.000446406106
  error estimate for blocks of size 2^( 5) =       0.000457768039
  error estimate for blocks of size 2^( 6) =       0.000465204908
  error estimate for blocks of size 2^( 7) =       0.000470901080

      target function =                  N/A
              le_mean =     -16.905774260752
             les_mean =     286.138715596737
             stat err =       0.000460070033
             autocorr =       1.269304712220
              std dev =       0.577505331562
             le_variance =       0.333512407983

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331162592021
                                         uncertainty =       0.003079732979

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331162592021
                                         uncertainty =       0.003079732979

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406913033
  error estimate for blocks of size 2^( 2) =       0.000420297255
  error estimate for blocks of size 2^( 3) =       0.000433771846
  error estimate for blocks of size 2^( 4) =       0.000445305120
  error estimate for blocks of size 2^( 5) =       0.000456726128
  error estimate for blocks of size 2^( 6) =       0.000464253062
  error estimate for blocks of size 2^( 7) =       0.000469979343

      target function =                  N/A
              le_mean =     -16.905766688013
             les_mean =     286.136103576951
             stat err =       0.000459065913
             autocorr =       1.272761098074
              std dev =       0.575461930091
             le_variance =       0.331156432984


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905769989155        initial
     9.7656e-02     9.7656e-01             9.0217e-03       -16.905780519718  <--
     3.9062e-01     3.9062e+00             3.3669e-03       -16.905774260752
     1.5625e+00     1.5625e+01             9.9858e-04       -16.905766688013

*****************************************************************************
Applying the update for shift_i =   9.7656e-02     and shift_s =   9.7656e-01
*****************************************************************************

  Execution time = 3.1505e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.051501e-01 1 1  ON 0
 uu_1                 1.400772e-01 1 1  ON 1
 uu_2                 4.012655e-02 1 1  ON 2
 uu_3                -2.009881e-02 1 1  ON 3
 uu_4                -6.290177e-02 1 1  ON 4
 uu_5                -9.573763e-02 1 1  ON 5
 uu_6                -1.208180e-01 1 1  ON 6
 uu_7                -1.326173e-01 1 1  ON 7
 uu_8                -1.235918e-01 1 1  ON 8
 uu_9                -9.414296e-02 1 1  ON 9
 ud_0                 4.332950e-01 1 1  ON 10
 ud_1                 1.708859e-01 1 1  ON 11
 ud_2                 5.685913e-02 1 1  ON 12
 ud_3                -8.940988e-03 1 1  ON 13
 ud_4                -6.370376e-02 1 1  ON 14
 ud_5                -1.037291e-01 1 1  ON 15
 ud_6                -1.303207e-01 1 1  ON 16
 ud_7                -1.460302e-01 1 1  ON 17
 ud_8                -1.457764e-01 1 1  ON 18
 ud_9                -1.358576e-01 1 1  ON 19
 eO_0                -7.347435e-01 1 1  ON 20
 eO_1                -4.230052e-01 1 1  ON 21
 eO_2                -1.656084e-02 1 1  ON 22
 eO_3                 2.886585e-01 1 1  ON 23
 eO_4                 5.024229e-01 1 1  ON 24
 eO_5                 4.602524e-01 1 1  ON 25
 eO_6                 2.354002e-01 1 1  ON 26
 eO_7                -5.527961e-02 1 1  ON 27
 eO_8                -1.991674e-01 1 1  ON 28
 eO_9                -6.042209e-02 1 1  ON 29
eH1_0                -2.231352e-01 1 1  ON 30
eH1_1                -1.297514e-01 1 1  ON 31
eH1_2                -8.702397e-02 1 1  ON 32
eH1_3                -3.458087e-02 1 1  ON 33
eH1_4                 1.300169e-02 1 1  ON 34
eH1_5                 4.562865e-02 1 1  ON 35
eH1_6                 9.602408e-02 1 1  ON 36
eH1_7                 1.398051e-01 1 1  ON 37
eH1_8                 1.484191e-01 1 1  ON 38
eH1_9                 3.589329e-02 1 1  ON 39
eH2_0                -2.220730e-01 1 1  ON 40
eH2_1                -1.288899e-01 1 1  ON 41
eH2_2                -8.555242e-02 1 1  ON 42
eH2_3                -3.351427e-02 1 1  ON 43
eH2_4                 1.451849e-02 1 1  ON 44
eH2_5                 4.907479e-02 1 1  ON 45
eH2_6                 1.015019e-01 1 1  ON 46
eH2_7                 1.492620e-01 1 1  ON 47
eH2_8                 1.572356e-01 1 1  ON 48
eH2_9                 1.697302e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7469e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.8615
    reference variance = 0.374968
====================================================
  Execution time = 2.0835e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4300e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5513e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343016663571
                                         uncertainty =       0.010204928826

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343016663571
                                         uncertainty =       0.010204928826

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414125850
  error estimate for blocks of size 2^( 2) =       0.000426596127
  error estimate for blocks of size 2^( 3) =       0.000439466954
  error estimate for blocks of size 2^( 4) =       0.000450823658
  error estimate for blocks of size 2^( 5) =       0.000459656506
  error estimate for blocks of size 2^( 6) =       0.000466308860
  error estimate for blocks of size 2^( 7) =       0.000470508419

      target function =                  N/A
              le_mean =     -16.905768198630
             les_mean =     286.147998653851
             stat err =       0.000461824361
             autocorr =       1.243623713992
              std dev =       0.585662393832
             le_variance =       0.343000439549


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690576819863e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-02, overlap shift 2.4414e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905768198630       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905773436156       residual = 2.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905783365297       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905800171664       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905809385570       residual = 7.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905818490567       residual = 6.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905820806572       residual = 4.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905824099462       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905825775631       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905831516867       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905832931004       residual = 7.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905836387318       residual = 7.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905839818221       residual = 3.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905839441144       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.905839349154       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.905839937098       residual = 6.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.905838601450       residual = 3.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.905838804051       residual = 2.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.905839014546       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.905839159503       residual = 4.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         19 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-02 is 1.264378e-02

solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905768198630       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905771873634       residual = 2.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905778163853       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905787818446       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905793330572       residual = 4.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905797231866       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905796261698       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905796263178       residual = 7.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905796918151       residual = 4.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905797526041       residual = 3.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905798701988       residual = 7.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905798872521       residual = 4.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905799069740       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905799021205       residual = 5.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-02 is 5.571546e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905768198630       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905769874166       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905772758963       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905775719845       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905778040196       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905779301606       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905778398966       residual = 2.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905778234737       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905778303620       residual = 4.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905778489146       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905778610889       residual = 4.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 1.858120e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.242808 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6460e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.062087e-01 1 1  ON 0
 uu_1                 1.405773e-01 1 1  ON 1
 uu_2                 4.014120e-02 1 1  ON 2
 uu_3                -2.050357e-02 1 1  ON 3
 uu_4                -6.352249e-02 1 1  ON 4
 uu_5                -9.582288e-02 1 1  ON 5
 uu_6                -1.209885e-01 1 1  ON 6
 uu_7                -1.329117e-01 1 1  ON 7
 uu_8                -1.246911e-01 1 1  ON 8
 uu_9                -9.542327e-02 1 1  ON 9
 ud_0                 4.364225e-01 1 1  ON 10
 ud_1                 1.732566e-01 1 1  ON 11
 ud_2                 5.791882e-02 1 1  ON 12
 ud_3                -9.082089e-03 1 1  ON 13
 ud_4                -6.463010e-02 1 1  ON 14
 ud_5                -1.046112e-01 1 1  ON 15
 ud_6                -1.309922e-01 1 1  ON 16
 ud_7                -1.467877e-01 1 1  ON 17
 ud_8                -1.472615e-01 1 1  ON 18
 ud_9                -1.375926e-01 1 1  ON 19
 eO_0                -7.403150e-01 1 1  ON 20
 eO_1                -4.264665e-01 1 1  ON 21
 eO_2                -1.626781e-02 1 1  ON 22
 eO_3                 2.924500e-01 1 1  ON 23
 eO_4                 5.064501e-01 1 1  ON 24
 eO_5                 4.634627e-01 1 1  ON 25
 eO_6                 2.365883e-01 1 1  ON 26
 eO_7                -5.492143e-02 1 1  ON 27
 eO_8                -2.013984e-01 1 1  ON 28
 eO_9                -6.193488e-02 1 1  ON 29
eH1_0                -2.255980e-01 1 1  ON 30
eH1_1                -1.308035e-01 1 1  ON 31
eH1_2                -8.729946e-02 1 1  ON 32
eH1_3                -3.493605e-02 1 1  ON 33
eH1_4                 1.281454e-02 1 1  ON 34
eH1_5                 4.563560e-02 1 1  ON 35
eH1_6                 9.607516e-02 1 1  ON 36
eH1_7                 1.399029e-01 1 1  ON 37
eH1_8                 1.502743e-01 1 1  ON 38
eH1_9                 3.789176e-02 1 1  ON 39
eH2_0                -2.247327e-01 1 1  ON 40
eH2_1                -1.294518e-01 1 1  ON 41
eH2_2                -8.569831e-02 1 1  ON 42
eH2_3                -3.338407e-02 1 1  ON 43
eH2_4                 1.486544e-02 1 1  ON 44
eH2_5                 4.885671e-02 1 1  ON 45
eH2_6                 1.018712e-01 1 1  ON 46
eH2_7                 1.493574e-01 1 1  ON 47
eH2_8                 1.581416e-01 1 1  ON 48
eH2_9                 1.877480e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.9139
    reference variance = 0.262994
====================================================
  Execution time = 2.0174e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3751e-01
  Total weights = 2.0000e+06
  Execution time = 1.8750e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335783476268
                                         uncertainty =       0.002600515904

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335783476268
                                         uncertainty =       0.002600515904

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409759403
  error estimate for blocks of size 2^( 2) =       0.000422390414
  error estimate for blocks of size 2^( 3) =       0.000435648260
  error estimate for blocks of size 2^( 4) =       0.000447709358
  error estimate for blocks of size 2^( 5) =       0.000458224306
  error estimate for blocks of size 2^( 6) =       0.000465446691
  error estimate for blocks of size 2^( 7) =       0.000470473320

      target function =                  N/A
              le_mean =     -16.906305143393
             les_mean =     286.158958970327
             stat err =       0.000460463419
             autocorr =       1.262793712133
              std dev =       0.579487305035
             le_variance =       0.335805536697

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339067955123
                                         uncertainty =       0.002630893088

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339067955123
                                         uncertainty =       0.002630893088

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411758023
  error estimate for blocks of size 2^( 2) =       0.000424285560
  error estimate for blocks of size 2^( 3) =       0.000437392434
  error estimate for blocks of size 2^( 4) =       0.000449288865
  error estimate for blocks of size 2^( 5) =       0.000459674950
  error estimate for blocks of size 2^( 6) =       0.000466827401
  error estimate for blocks of size 2^( 7) =       0.000471793108

      target function =                  N/A
              le_mean =     -16.906323143751
             les_mean =     286.162851410504
             stat err =       0.000461896081
             autocorr =       1.258358579705
              std dev =       0.582313780640
             le_variance =       0.339089339123

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339284074869
                                         uncertainty =       0.002635932861

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339284074869
                                         uncertainty =       0.002635932861

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411889192
  error estimate for blocks of size 2^( 2) =       0.000424407172
  error estimate for blocks of size 2^( 3) =       0.000437514502
  error estimate for blocks of size 2^( 4) =       0.000449429045
  error estimate for blocks of size 2^( 5) =       0.000459835040
  error estimate for blocks of size 2^( 6) =       0.000466995842
  error estimate for blocks of size 2^( 7) =       0.000471969653

      target function =                  N/A
              le_mean =     -16.906328382387
             les_mean =     286.163244615785
             stat err =       0.000462057395
             autocorr =       1.258435785573
              std dev =       0.582499280968
             le_variance =       0.339305412328

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336468190654
                                         uncertainty =       0.002608112248

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336468190654
                                         uncertainty =       0.002608112248

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410176881
  error estimate for blocks of size 2^( 2) =       0.000422780710
  error estimate for blocks of size 2^( 3) =       0.000436006645
  error estimate for blocks of size 2^( 4) =       0.000448040381
  error estimate for blocks of size 2^( 5) =       0.000458535164
  error estimate for blocks of size 2^( 6) =       0.000465745337
  error estimate for blocks of size 2^( 7) =       0.000470762185

      target function =                  N/A
              le_mean =     -16.906304023781
             les_mean =     286.159605722999
             stat err =       0.000460770767
             autocorr =       1.261907379407
              std dev =       0.580077707505
             le_variance =       0.336490146745


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906305143393        initial
     2.4414e-02     2.4414e-01             1.2644e-02       -16.906323143751
     9.7656e-02     9.7656e-01             5.5715e-03       -16.906328382387  <--
     3.9062e-01     3.9062e+00             1.8581e-03       -16.906304023781

*****************************************************************************
Applying the update for shift_i =   9.7656e-02     and shift_s =   9.7656e-01
*****************************************************************************

  Execution time = 2.9642e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.062087e-01 1 1  ON 0
 uu_1                 1.405773e-01 1 1  ON 1
 uu_2                 4.014120e-02 1 1  ON 2
 uu_3                -2.050357e-02 1 1  ON 3
 uu_4                -6.352249e-02 1 1  ON 4
 uu_5                -9.582288e-02 1 1  ON 5
 uu_6                -1.209885e-01 1 1  ON 6
 uu_7                -1.329117e-01 1 1  ON 7
 uu_8                -1.246911e-01 1 1  ON 8
 uu_9                -9.542327e-02 1 1  ON 9
 ud_0                 4.364225e-01 1 1  ON 10
 ud_1                 1.732566e-01 1 1  ON 11
 ud_2                 5.791882e-02 1 1  ON 12
 ud_3                -9.082089e-03 1 1  ON 13
 ud_4                -6.463010e-02 1 1  ON 14
 ud_5                -1.046112e-01 1 1  ON 15
 ud_6                -1.309922e-01 1 1  ON 16
 ud_7                -1.467877e-01 1 1  ON 17
 ud_8                -1.472615e-01 1 1  ON 18
 ud_9                -1.375926e-01 1 1  ON 19
 eO_0                -7.403150e-01 1 1  ON 20
 eO_1                -4.264665e-01 1 1  ON 21
 eO_2                -1.626781e-02 1 1  ON 22
 eO_3                 2.924500e-01 1 1  ON 23
 eO_4                 5.064501e-01 1 1  ON 24
 eO_5                 4.634627e-01 1 1  ON 25
 eO_6                 2.365883e-01 1 1  ON 26
 eO_7                -5.492143e-02 1 1  ON 27
 eO_8                -2.013984e-01 1 1  ON 28
 eO_9                -6.193488e-02 1 1  ON 29
eH1_0                -2.255980e-01 1 1  ON 30
eH1_1                -1.308035e-01 1 1  ON 31
eH1_2                -8.729946e-02 1 1  ON 32
eH1_3                -3.493605e-02 1 1  ON 33
eH1_4                 1.281454e-02 1 1  ON 34
eH1_5                 4.563560e-02 1 1  ON 35
eH1_6                 9.607516e-02 1 1  ON 36
eH1_7                 1.399029e-01 1 1  ON 37
eH1_8                 1.502743e-01 1 1  ON 38
eH1_9                 3.789176e-02 1 1  ON 39
eH2_0                -2.247327e-01 1 1  ON 40
eH2_1                -1.294518e-01 1 1  ON 41
eH2_2                -8.569831e-02 1 1  ON 42
eH2_3                -3.338407e-02 1 1  ON 43
eH2_4                 1.486544e-02 1 1  ON 44
eH2_5                 4.885671e-02 1 1  ON 45
eH2_6                 1.018712e-01 1 1  ON 46
eH2_7                 1.493574e-01 1 1  ON 47
eH2_8                 1.581416e-01 1 1  ON 48
eH2_9                 1.877480e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6107e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.9405
    reference variance = 0.29277
====================================================
  Execution time = 2.0721e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4022e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6164e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340202301599
                                         uncertainty =       0.003939285826

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340202301599
                                         uncertainty =       0.003939285826

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412445346
  error estimate for blocks of size 2^( 2) =       0.000425567089
  error estimate for blocks of size 2^( 3) =       0.000438855092
  error estimate for blocks of size 2^( 4) =       0.000452356417
  error estimate for blocks of size 2^( 5) =       0.000464161073
  error estimate for blocks of size 2^( 6) =       0.000472654899
  error estimate for blocks of size 2^( 7) =       0.000480341630

      target function =                  N/A
              le_mean =     -16.905374240787
             les_mean =     286.131900377792
             stat err =       0.000467378505
             autocorr =       1.284117175743
              std dev =       0.583285802022
             le_variance =       0.340222326841


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690537424079e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-02, overlap shift 2.4414e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905374240787       residual = 4.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905377018276       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905381327492       residual = 8.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905382932980       residual = 7.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905385827726       residual = 7.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905395069898       residual = 4.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905399788659       residual = 4.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905398685333       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905402247990       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905405702918       residual = 5.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905409399841       residual = 4.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905408220409       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905408881605       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905410141109       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.905408410635       residual = 7.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.905409350901       residual = 2.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.905409605717       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.905409802902       residual = 8.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-02 is 1.014825e-02

solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905374240787       residual = 4.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905376255296       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905379339432       residual = 6.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905379695422       residual = 5.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905380891603       residual = 3.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905386054889       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905386798824       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905385501932       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905386889522       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905387517866       residual = 8.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905387483578       residual = 7.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905387705742       residual = 2.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905387432828       residual = 5.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-02 is 4.007061e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905374240787       residual = 4.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905375200623       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905376726616       residual = 4.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905376521845       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905376772517       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905378167318       residual = 2.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905378048886       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905377926397       residual = 2.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905377991657       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905378198098       residual = 6.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 1.326926e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.249772 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6353e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.067665e-01 1 1  ON 0
 uu_1                 1.409530e-01 1 1  ON 1
 uu_2                 4.011440e-02 1 1  ON 2
 uu_3                -2.081083e-02 1 1  ON 3
 uu_4                -6.421474e-02 1 1  ON 4
 uu_5                -9.633095e-02 1 1  ON 5
 uu_6                -1.220602e-01 1 1  ON 6
 uu_7                -1.334609e-01 1 1  ON 7
 uu_8                -1.248189e-01 1 1  ON 8
 uu_9                -9.538055e-02 1 1  ON 9
 ud_0                 4.377684e-01 1 1  ON 10
 ud_1                 1.742481e-01 1 1  ON 11
 ud_2                 5.818993e-02 1 1  ON 12
 ud_3                -9.370233e-03 1 1  ON 13
 ud_4                -6.551955e-02 1 1  ON 14
 ud_5                -1.059474e-01 1 1  ON 15
 ud_6                -1.319396e-01 1 1  ON 16
 ud_7                -1.469301e-01 1 1  ON 17
 ud_8                -1.471827e-01 1 1  ON 18
 ud_9                -1.370068e-01 1 1  ON 19
 eO_0                -7.443221e-01 1 1  ON 20
 eO_1                -4.289482e-01 1 1  ON 21
 eO_2                -1.672535e-02 1 1  ON 22
 eO_3                 2.939117e-01 1 1  ON 23
 eO_4                 5.102818e-01 1 1  ON 24
 eO_5                 4.661436e-01 1 1  ON 25
 eO_6                 2.372894e-01 1 1  ON 26
 eO_7                -5.417110e-02 1 1  ON 27
 eO_8                -2.022668e-01 1 1  ON 28
 eO_9                -6.328301e-02 1 1  ON 29
eH1_0                -2.276377e-01 1 1  ON 30
eH1_1                -1.323583e-01 1 1  ON 31
eH1_2                -8.853721e-02 1 1  ON 32
eH1_3                -3.565472e-02 1 1  ON 33
eH1_4                 1.211514e-02 1 1  ON 34
eH1_5                 4.557733e-02 1 1  ON 35
eH1_6                 9.716543e-02 1 1  ON 36
eH1_7                 1.419278e-01 1 1  ON 37
eH1_8                 1.520430e-01 1 1  ON 38
eH1_9                 3.954825e-02 1 1  ON 39
eH2_0                -2.263897e-01 1 1  ON 40
eH2_1                -1.304978e-01 1 1  ON 41
eH2_2                -8.669339e-02 1 1  ON 42
eH2_3                -3.388038e-02 1 1  ON 43
eH2_4                 1.409955e-02 1 1  ON 44
eH2_5                 4.824753e-02 1 1  ON 45
eH2_6                 1.029087e-01 1 1  ON 46
eH2_7                 1.498260e-01 1 1  ON 47
eH2_8                 1.594589e-01 1 1  ON 48
eH2_9                 2.131492e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.8641
    reference variance = 0.266945
====================================================
  Execution time = 2.0223e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3504e-01
  Total weights = 2.0000e+06
  Execution time = 1.8642e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333839445664
                                         uncertainty =       0.003876201557

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333839445664
                                         uncertainty =       0.003876201557

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408579814
  error estimate for blocks of size 2^( 2) =       0.000421396709
  error estimate for blocks of size 2^( 3) =       0.000434973464
  error estimate for blocks of size 2^( 4) =       0.000447405649
  error estimate for blocks of size 2^( 5) =       0.000459369361
  error estimate for blocks of size 2^( 6) =       0.000468350025
  error estimate for blocks of size 2^( 7) =       0.000472440251

      target function =                  N/A
              le_mean =     -16.904827995298
             les_mean =     286.107084312495
             stat err =       0.000461891321
             autocorr =       1.277985103961
              std dev =       0.577819114277
             le_variance =       0.333874928824

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336196357112
                                         uncertainty =       0.003905253339

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336196357112
                                         uncertainty =       0.003905253339

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410019608
  error estimate for blocks of size 2^( 2) =       0.000422786730
  error estimate for blocks of size 2^( 3) =       0.000436270144
  error estimate for blocks of size 2^( 4) =       0.000448575892
  error estimate for blocks of size 2^( 5) =       0.000460427756
  error estimate for blocks of size 2^( 6) =       0.000469320789
  error estimate for blocks of size 2^( 7) =       0.000473356238

      target function =                  N/A
              le_mean =     -16.904826001690
             les_mean =     286.109374136620
             stat err =       0.000462920169
             autocorr =       1.274685230460
              std dev =       0.579855289989
             le_variance =       0.336232157328

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336197262462
                                         uncertainty =       0.003903439500

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336197262462
                                         uncertainty =       0.003903439500

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410020073
  error estimate for blocks of size 2^( 2) =       0.000422777342
  error estimate for blocks of size 2^( 3) =       0.000436262327
  error estimate for blocks of size 2^( 4) =       0.000448577724
  error estimate for blocks of size 2^( 5) =       0.000460451442
  error estimate for blocks of size 2^( 6) =       0.000469358661
  error estimate for blocks of size 2^( 7) =       0.000473403809

      target function =                  N/A
              le_mean =     -16.904822964815
             les_mean =     286.109272224613
             stat err =       0.000462947909
             autocorr =       1.274835110958
              std dev =       0.579855948487
             le_variance =       0.336232920996

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334283778098
                                         uncertainty =       0.003880973020

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334283778098
                                         uncertainty =       0.003880973020

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408851625
  error estimate for blocks of size 2^( 2) =       0.000421654205
  error estimate for blocks of size 2^( 3) =       0.000435211852
  error estimate for blocks of size 2^( 4) =       0.000447621117
  error estimate for blocks of size 2^( 5) =       0.000459569415
  error estimate for blocks of size 2^( 6) =       0.000468537476
  error estimate for blocks of size 2^( 7) =       0.000472618627

      target function =                  N/A
              le_mean =     -16.904824132139
             les_mean =     286.107398074344
             stat err =       0.000462086659
             autocorr =       1.277366148774
              std dev =       0.578203513453
             le_variance =       0.334319302969


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904827995298        initial  <--
     2.4414e-02     2.4414e-01             1.0148e-02       -16.904826001690
     9.7656e-02     9.7656e-01             4.0071e-03       -16.904822964815
     3.9062e-01     3.9062e+00             1.3269e-03       -16.904824132139

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6213
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.062087e-01 1 1  ON 0
 uu_1                 1.405773e-01 1 1  ON 1
 uu_2                 4.014120e-02 1 1  ON 2
 uu_3                -2.050357e-02 1 1  ON 3
 uu_4                -6.352249e-02 1 1  ON 4
 uu_5                -9.582288e-02 1 1  ON 5
 uu_6                -1.209885e-01 1 1  ON 6
 uu_7                -1.329117e-01 1 1  ON 7
 uu_8                -1.246911e-01 1 1  ON 8
 uu_9                -9.542327e-02 1 1  ON 9
 ud_0                 4.364225e-01 1 1  ON 10
 ud_1                 1.732566e-01 1 1  ON 11
 ud_2                 5.791882e-02 1 1  ON 12
 ud_3                -9.082089e-03 1 1  ON 13
 ud_4                -6.463010e-02 1 1  ON 14
 ud_5                -1.046112e-01 1 1  ON 15
 ud_6                -1.309922e-01 1 1  ON 16
 ud_7                -1.467877e-01 1 1  ON 17
 ud_8                -1.472615e-01 1 1  ON 18
 ud_9                -1.375926e-01 1 1  ON 19
 eO_0                -7.403150e-01 1 1  ON 20
 eO_1                -4.264665e-01 1 1  ON 21
 eO_2                -1.626781e-02 1 1  ON 22
 eO_3                 2.924500e-01 1 1  ON 23
 eO_4                 5.064501e-01 1 1  ON 24
 eO_5                 4.634627e-01 1 1  ON 25
 eO_6                 2.365883e-01 1 1  ON 26
 eO_7                -5.492143e-02 1 1  ON 27
 eO_8                -2.013984e-01 1 1  ON 28
 eO_9                -6.193488e-02 1 1  ON 29
eH1_0                -2.255980e-01 1 1  ON 30
eH1_1                -1.308035e-01 1 1  ON 31
eH1_2                -8.729946e-02 1 1  ON 32
eH1_3                -3.493605e-02 1 1  ON 33
eH1_4                 1.281454e-02 1 1  ON 34
eH1_5                 4.563560e-02 1 1  ON 35
eH1_6                 9.607516e-02 1 1  ON 36
eH1_7                 1.399029e-01 1 1  ON 37
eH1_8                 1.502743e-01 1 1  ON 38
eH1_9                 3.789176e-02 1 1  ON 39
eH2_0                -2.247327e-01 1 1  ON 40
eH2_1                -1.294518e-01 1 1  ON 41
eH2_2                -8.569831e-02 1 1  ON 42
eH2_3                -3.338407e-02 1 1  ON 43
eH2_4                 1.486544e-02 1 1  ON 44
eH2_5                 4.885671e-02 1 1  ON 45
eH2_6                 1.018712e-01 1 1  ON 46
eH2_7                 1.493574e-01 1 1  ON 47
eH2_8                 1.581416e-01 1 1  ON 48
eH2_9                 1.877480e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5979e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.902
    reference variance = 0.298127
====================================================
  Execution time = 2.0663e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3708e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6785e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337131818368
                                         uncertainty =       0.004535401743

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337131818368
                                         uncertainty =       0.004535401743

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410538852
  error estimate for blocks of size 2^( 2) =       0.000423507952
  error estimate for blocks of size 2^( 3) =       0.000437390705
  error estimate for blocks of size 2^( 4) =       0.000449454789
  error estimate for blocks of size 2^( 5) =       0.000462211807
  error estimate for blocks of size 2^( 6) =       0.000470206959
  error estimate for blocks of size 2^( 7) =       0.000473318827

      target function =                  N/A
              le_mean =     -16.904970553779
             les_mean =     286.115113553134
             stat err =       0.000463798095
             autocorr =       1.276290084028
              std dev =       0.580589611982
             le_variance =       0.337084297542


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690497055378e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904970553779       residual = 5.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904970896269       residual = 6.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904971940758       residual = 6.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904974428496       residual = 5.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904977118117       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904977649407       residual = 6.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904977844233       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904977412640       residual = 7.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.904978096553       residual = 4.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.904977838191       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.904977712216       residual = 5.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-01 is 1.760226e-03

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904970553779       residual = 5.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904970694679       residual = 6.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904970984531       residual = 4.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904971593707       residual = 3.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904972537422       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904972567906       residual = 2.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904972579802       residual = 5.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904972541090       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.904972548997       residual = 4.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-01 is 4.895574e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904970553779       residual = 5.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904970595783       residual = 7.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904970669088       residual = 4.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904970804487       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904971052124       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904971083116       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904971064274       residual = 3.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904971073445       residual = 8.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 1.227483e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.253211 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6353e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.064019e-01 1 1  ON 0
 uu_1                 1.406160e-01 1 1  ON 1
 uu_2                 4.007928e-02 1 1  ON 2
 uu_3                -2.056123e-02 1 1  ON 3
 uu_4                -6.363111e-02 1 1  ON 4
 uu_5                -9.594108e-02 1 1  ON 5
 uu_6                -1.211110e-01 1 1  ON 6
 uu_7                -1.330549e-01 1 1  ON 7
 uu_8                -1.247289e-01 1 1  ON 8
 uu_9                -9.536920e-02 1 1  ON 9
 ud_0                 4.366722e-01 1 1  ON 10
 ud_1                 1.733889e-01 1 1  ON 11
 ud_2                 5.795468e-02 1 1  ON 12
 ud_3                -9.197485e-03 1 1  ON 13
 ud_4                -6.472435e-02 1 1  ON 14
 ud_5                -1.047555e-01 1 1  ON 15
 ud_6                -1.310916e-01 1 1  ON 16
 ud_7                -1.467961e-01 1 1  ON 17
 ud_8                -1.473277e-01 1 1  ON 18
 ud_9                -1.375333e-01 1 1  ON 19
 eO_0                -7.408046e-01 1 1  ON 20
 eO_1                -4.268203e-01 1 1  ON 21
 eO_2                -1.626709e-02 1 1  ON 22
 eO_3                 2.927217e-01 1 1  ON 23
 eO_4                 5.068315e-01 1 1  ON 24
 eO_5                 4.637518e-01 1 1  ON 25
 eO_6                 2.366809e-01 1 1  ON 26
 eO_7                -5.488522e-02 1 1  ON 27
 eO_8                -2.015238e-01 1 1  ON 28
 eO_9                -6.202470e-02 1 1  ON 29
eH1_0                -2.259366e-01 1 1  ON 30
eH1_1                -1.309922e-01 1 1  ON 31
eH1_2                -8.729273e-02 1 1  ON 32
eH1_3                -3.494143e-02 1 1  ON 33
eH1_4                 1.281249e-02 1 1  ON 34
eH1_5                 4.568044e-02 1 1  ON 35
eH1_6                 9.612232e-02 1 1  ON 36
eH1_7                 1.399632e-01 1 1  ON 37
eH1_8                 1.504308e-01 1 1  ON 38
eH1_9                 3.809203e-02 1 1  ON 39
eH2_0                -2.250217e-01 1 1  ON 40
eH2_1                -1.296048e-01 1 1  ON 41
eH2_2                -8.585126e-02 1 1  ON 42
eH2_3                -3.340943e-02 1 1  ON 43
eH2_4                 1.479053e-02 1 1  ON 44
eH2_5                 4.892565e-02 1 1  ON 45
eH2_6                 1.019913e-01 1 1  ON 46
eH2_7                 1.494363e-01 1 1  ON 47
eH2_8                 1.583024e-01 1 1  ON 48
eH2_9                 1.902036e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.8739
    reference variance = 0.230768
====================================================
  Execution time = 2.0008e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3342e-01
  Total weights = 2.0000e+06
  Execution time = 1.8686e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333206067018
                                         uncertainty =       0.002960709140

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333206067018
                                         uncertainty =       0.002960709140

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408165283
  error estimate for blocks of size 2^( 2) =       0.000420697232
  error estimate for blocks of size 2^( 3) =       0.000434333048
  error estimate for blocks of size 2^( 4) =       0.000446316151
  error estimate for blocks of size 2^( 5) =       0.000456990346
  error estimate for blocks of size 2^( 6) =       0.000465668099
  error estimate for blocks of size 2^( 7) =       0.000471162222

      target function =                  N/A
              le_mean =     -16.905908132531
             les_mean =     286.142927415763
             stat err =       0.000460034205
             autocorr =       1.270305334864
              std dev =       0.577232879175
             le_variance =       0.333197796801

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333840187662
                                         uncertainty =       0.002965028018

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333840187662
                                         uncertainty =       0.002965028018

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408553430
  error estimate for blocks of size 2^( 2) =       0.000421068668
  error estimate for blocks of size 2^( 3) =       0.000434686326
  error estimate for blocks of size 2^( 4) =       0.000446645904
  error estimate for blocks of size 2^( 5) =       0.000457299818
  error estimate for blocks of size 2^( 6) =       0.000465960265
  error estimate for blocks of size 2^( 7) =       0.000471449120

      target function =                  N/A
              le_mean =     -16.905907195428
             les_mean =     286.143529744168
             stat err =       0.000460338777
             autocorr =       1.269572177755
              std dev =       0.577781801932
             le_variance =       0.333831810643

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333651552181
                                         uncertainty =       0.002964006196

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333651552181
                                         uncertainty =       0.002964006196

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408438007
  error estimate for blocks of size 2^( 2) =       0.000420957802
  error estimate for blocks of size 2^( 3) =       0.000434581374
  error estimate for blocks of size 2^( 4) =       0.000446549349
  error estimate for blocks of size 2^( 5) =       0.000457209698
  error estimate for blocks of size 2^( 6) =       0.000465876417
  error estimate for blocks of size 2^( 7) =       0.000471365351

      target function =                  N/A
              le_mean =     -16.905907434871
             les_mean =     286.143349240515
             stat err =       0.000460250204
             autocorr =       1.269801050537
              std dev =       0.577618568698
             le_variance =       0.333643210904

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333271281717
                                         uncertainty =       0.002961204509

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333271281717
                                         uncertainty =       0.002961204509

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408205219
  error estimate for blocks of size 2^( 2) =       0.000420735362
  error estimate for blocks of size 2^( 3) =       0.000434369439
  error estimate for blocks of size 2^( 4) =       0.000446350409
  error estimate for blocks of size 2^( 5) =       0.000457022600
  error estimate for blocks of size 2^( 6) =       0.000465698692
  error estimate for blocks of size 2^( 7) =       0.000471191834

      target function =                  N/A
              le_mean =     -16.905907945128
             les_mean =     286.142986284026
             stat err =       0.000460065884
             autocorr =       1.270231717325
              std dev =       0.577289356842
             le_variance =       0.333263001523


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905908132531        initial  <--
     2.4414e-01     2.4414e+00             1.7602e-03       -16.905907195428
     9.7656e-01     9.7656e+00             4.8956e-04       -16.905907434871
     3.9062e+00     3.9062e+01             1.2275e-04       -16.905907945128

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.3944
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.062087e-01 1 1  ON 0
 uu_1                 1.405773e-01 1 1  ON 1
 uu_2                 4.014120e-02 1 1  ON 2
 uu_3                -2.050357e-02 1 1  ON 3
 uu_4                -6.352249e-02 1 1  ON 4
 uu_5                -9.582288e-02 1 1  ON 5
 uu_6                -1.209885e-01 1 1  ON 6
 uu_7                -1.329117e-01 1 1  ON 7
 uu_8                -1.246911e-01 1 1  ON 8
 uu_9                -9.542327e-02 1 1  ON 9
 ud_0                 4.364225e-01 1 1  ON 10
 ud_1                 1.732566e-01 1 1  ON 11
 ud_2                 5.791882e-02 1 1  ON 12
 ud_3                -9.082089e-03 1 1  ON 13
 ud_4                -6.463010e-02 1 1  ON 14
 ud_5                -1.046112e-01 1 1  ON 15
 ud_6                -1.309922e-01 1 1  ON 16
 ud_7                -1.467877e-01 1 1  ON 17
 ud_8                -1.472615e-01 1 1  ON 18
 ud_9                -1.375926e-01 1 1  ON 19
 eO_0                -7.403150e-01 1 1  ON 20
 eO_1                -4.264665e-01 1 1  ON 21
 eO_2                -1.626781e-02 1 1  ON 22
 eO_3                 2.924500e-01 1 1  ON 23
 eO_4                 5.064501e-01 1 1  ON 24
 eO_5                 4.634627e-01 1 1  ON 25
 eO_6                 2.365883e-01 1 1  ON 26
 eO_7                -5.492143e-02 1 1  ON 27
 eO_8                -2.013984e-01 1 1  ON 28
 eO_9                -6.193488e-02 1 1  ON 29
eH1_0                -2.255980e-01 1 1  ON 30
eH1_1                -1.308035e-01 1 1  ON 31
eH1_2                -8.729946e-02 1 1  ON 32
eH1_3                -3.493605e-02 1 1  ON 33
eH1_4                 1.281454e-02 1 1  ON 34
eH1_5                 4.563560e-02 1 1  ON 35
eH1_6                 9.607516e-02 1 1  ON 36
eH1_7                 1.399029e-01 1 1  ON 37
eH1_8                 1.502743e-01 1 1  ON 38
eH1_9                 3.789176e-02 1 1  ON 39
eH2_0                -2.247327e-01 1 1  ON 40
eH2_1                -1.294518e-01 1 1  ON 41
eH2_2                -8.569831e-02 1 1  ON 42
eH2_3                -3.338407e-02 1 1  ON 43
eH2_4                 1.486544e-02 1 1  ON 44
eH2_5                 4.885671e-02 1 1  ON 45
eH2_6                 1.018712e-01 1 1  ON 46
eH2_7                 1.493574e-01 1 1  ON 47
eH2_8                 1.581416e-01 1 1  ON 48
eH2_9                 1.877480e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5753e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.9398
    reference variance = 0.262593
====================================================
  Execution time = 2.1002e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3922e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6231e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339210843186
                                         uncertainty =       0.003571821145

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339210843186
                                         uncertainty =       0.003571821145

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411839185
  error estimate for blocks of size 2^( 2) =       0.000425331498
  error estimate for blocks of size 2^( 3) =       0.000438706581
  error estimate for blocks of size 2^( 4) =       0.000451600675
  error estimate for blocks of size 2^( 5) =       0.000462451370
  error estimate for blocks of size 2^( 6) =       0.000470173770
  error estimate for blocks of size 2^( 7) =       0.000477479026

      target function =                  N/A
              le_mean =     -16.905801733592
             les_mean =     286.145355113943
             stat err =       0.000465426210
             autocorr =       1.277163042201
              std dev =       0.582428560442
             le_variance =       0.339223028019


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690580173359e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905801733592       residual = 6.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905802184232       residual = 6.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905803243539       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905803241390       residual = 4.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905803405030       residual = 7.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905803416558       residual = 3.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905803471797       residual = 5.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905803461238       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905803451041       residual = 3.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+00 is 2.426054e-04

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905801733592       residual = 6.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905801853085       residual = 7.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905802131515       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905802148152       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905802178163       residual = 7.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905802172442       residual = 3.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905802189567       residual = 4.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905802186941       residual = 6.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+00 is 6.300904e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905801733592       residual = 6.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905801763925       residual = 7.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905801834445       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905801840581       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905801846915       residual = 8.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905801844616       residual = 3.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905801849124       residual = 3.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905801848464       residual = 5.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+01 is 1.587952e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.256026 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6636e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.062095e-01 1 1  ON 0
 uu_1                 1.405836e-01 1 1  ON 1
 uu_2                 4.014811e-02 1 1  ON 2
 uu_3                -2.050034e-02 1 1  ON 3
 uu_4                -6.352062e-02 1 1  ON 4
 uu_5                -9.583225e-02 1 1  ON 5
 uu_6                -1.210035e-01 1 1  ON 6
 uu_7                -1.329316e-01 1 1  ON 7
 uu_8                -1.246947e-01 1 1  ON 8
 uu_9                -9.542031e-02 1 1  ON 9
 ud_0                 4.364298e-01 1 1  ON 10
 ud_1                 1.732621e-01 1 1  ON 11
 ud_2                 5.792725e-02 1 1  ON 12
 ud_3                -9.098274e-03 1 1  ON 13
 ud_4                -6.462910e-02 1 1  ON 14
 ud_5                -1.046301e-01 1 1  ON 15
 ud_6                -1.309951e-01 1 1  ON 16
 ud_7                -1.467745e-01 1 1  ON 17
 ud_8                -1.472489e-01 1 1  ON 18
 ud_9                -1.375898e-01 1 1  ON 19
 eO_0                -7.403780e-01 1 1  ON 20
 eO_1                -4.264916e-01 1 1  ON 21
 eO_2                -1.626833e-02 1 1  ON 22
 eO_3                 2.924742e-01 1 1  ON 23
 eO_4                 5.064932e-01 1 1  ON 24
 eO_5                 4.634951e-01 1 1  ON 25
 eO_6                 2.365995e-01 1 1  ON 26
 eO_7                -5.491385e-02 1 1  ON 27
 eO_8                -2.014126e-01 1 1  ON 28
 eO_9                -6.194854e-02 1 1  ON 29
eH1_0                -2.256337e-01 1 1  ON 30
eH1_1                -1.308125e-01 1 1  ON 31
eH1_2                -8.730469e-02 1 1  ON 32
eH1_3                -3.493820e-02 1 1  ON 33
eH1_4                 1.280499e-02 1 1  ON 34
eH1_5                 4.563138e-02 1 1  ON 35
eH1_6                 9.608462e-02 1 1  ON 36
eH1_7                 1.399192e-01 1 1  ON 37
eH1_8                 1.502945e-01 1 1  ON 38
eH1_9                 3.791186e-02 1 1  ON 39
eH2_0                -2.247584e-01 1 1  ON 40
eH2_1                -1.294577e-01 1 1  ON 41
eH2_2                -8.569653e-02 1 1  ON 42
eH2_3                -3.338542e-02 1 1  ON 43
eH2_4                 1.483511e-02 1 1  ON 44
eH2_5                 4.885660e-02 1 1  ON 45
eH2_6                 1.018850e-01 1 1  ON 46
eH2_7                 1.493655e-01 1 1  ON 47
eH2_8                 1.581602e-01 1 1  ON 48
eH2_9                 1.879605e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.9064
    reference variance = 0.204542
====================================================
  Execution time = 2.0370e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3825e-01
  Total weights = 2.0000e+06
  Execution time = 1.8638e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338288798687
                                         uncertainty =       0.005055294581

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338288798687
                                         uncertainty =       0.005055294581

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411250459
  error estimate for blocks of size 2^( 2) =       0.000424636102
  error estimate for blocks of size 2^( 3) =       0.000438463225
  error estimate for blocks of size 2^( 4) =       0.000451052210
  error estimate for blocks of size 2^( 5) =       0.000462725688
  error estimate for blocks of size 2^( 6) =       0.000471796498
  error estimate for blocks of size 2^( 7) =       0.000480966636

      target function =                  N/A
              le_mean =     -16.905117819741
             les_mean =     286.121262209844
             stat err =       0.000466635258
             autocorr =       1.287485390763
              std dev =       0.581595976289
             le_variance =       0.338253879635

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338289561894
                                         uncertainty =       0.005055902777

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338289561894
                                         uncertainty =       0.005055902777

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411250926
  error estimate for blocks of size 2^( 2) =       0.000424637242
  error estimate for blocks of size 2^( 3) =       0.000438464523
  error estimate for blocks of size 2^( 4) =       0.000451052451
  error estimate for blocks of size 2^( 5) =       0.000462724990
  error estimate for blocks of size 2^( 6) =       0.000471793946
  error estimate for blocks of size 2^( 7) =       0.000480964766

      target function =                  N/A
              le_mean =     -16.905117852653
             les_mean =     286.121264091067
             stat err =       0.000466634038
             autocorr =       1.287475734149
              std dev =       0.581596636946
             le_variance =       0.338254648107

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338287048704
                                         uncertainty =       0.005055622260

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338287048704
                                         uncertainty =       0.005055622260

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411249396
  error estimate for blocks of size 2^( 2) =       0.000424635457
  error estimate for blocks of size 2^( 3) =       0.000438462739
  error estimate for blocks of size 2^( 4) =       0.000451051246
  error estimate for blocks of size 2^( 5) =       0.000462724306
  error estimate for blocks of size 2^( 6) =       0.000471794124
  error estimate for blocks of size 2^( 7) =       0.000480964645

      target function =                  N/A
              le_mean =     -16.905117807709
             les_mean =     286.121260055302
             stat err =       0.000466633580
             autocorr =       1.287482784499
              std dev =       0.581594473771
             le_variance =       0.338252131921

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338288472474
                                         uncertainty =       0.005055335377

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338288472474
                                         uncertainty =       0.005055335377

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411250261
  error estimate for blocks of size 2^( 2) =       0.000424635959
  error estimate for blocks of size 2^( 3) =       0.000438463106
  error estimate for blocks of size 2^( 4) =       0.000451052032
  error estimate for blocks of size 2^( 5) =       0.000462725461
  error estimate for blocks of size 2^( 6) =       0.000471796148
  error estimate for blocks of size 2^( 7) =       0.000480966340

      target function =                  N/A
              le_mean =     -16.905117815939
             les_mean =     286.121261755364
             stat err =       0.000466634995
             autocorr =       1.287485180893
              std dev =       0.581595696093
             le_variance =       0.338253553714


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905117819741        initial
     2.4414e+00     2.4414e+01             2.4261e-04       -16.905117852653  <--
     9.7656e+00     9.7656e+01             6.3009e-05       -16.905117807709
     3.9062e+01     3.9062e+02             1.5880e-05       -16.905117815939

*****************************************************************************
Applying the update for shift_i =   2.4414e+00     and shift_s =   2.4414e+01
*****************************************************************************

  Execution time = 2.9914e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.062162e-01 1 1  ON 0
 uu_1                 1.406014e-01 1 1  ON 1
 uu_2                 4.017030e-02 1 1  ON 2
 uu_3                -2.049165e-02 1 1  ON 3
 uu_4                -6.351969e-02 1 1  ON 4
 uu_5                -9.586195e-02 1 1  ON 5
 uu_6                -1.210469e-01 1 1  ON 6
 uu_7                -1.329891e-01 1 1  ON 7
 uu_8                -1.247069e-01 1 1  ON 8
 uu_9                -9.541248e-02 1 1  ON 9
 ud_0                 4.364543e-01 1 1  ON 10
 ud_1                 1.732813e-01 1 1  ON 11
 ud_2                 5.794745e-02 1 1  ON 12
 ud_3                -9.138921e-03 1 1  ON 13
 ud_4                -6.463050e-02 1 1  ON 14
 ud_5                -1.046817e-01 1 1  ON 15
 ud_6                -1.310071e-01 1 1  ON 16
 ud_7                -1.467381e-01 1 1  ON 17
 ud_8                -1.472119e-01 1 1  ON 18
 ud_9                -1.375817e-01 1 1  ON 19
 eO_0                -7.405576e-01 1 1  ON 20
 eO_1                -4.265726e-01 1 1  ON 21
 eO_2                -1.627336e-02 1 1  ON 22
 eO_3                 2.925447e-01 1 1  ON 23
 eO_4                 5.066224e-01 1 1  ON 24
 eO_5                 4.635940e-01 1 1  ON 25
 eO_6                 2.366352e-01 1 1  ON 26
 eO_7                -5.489054e-02 1 1  ON 27
 eO_8                -2.014565e-01 1 1  ON 28
 eO_9                -6.199061e-02 1 1  ON 29
eH1_0                -2.257376e-01 1 1  ON 30
eH1_1                -1.308406e-01 1 1  ON 31
eH1_2                -8.732278e-02 1 1  ON 32
eH1_3                -3.494795e-02 1 1  ON 33
eH1_4                 1.277785e-02 1 1  ON 34
eH1_5                 4.561940e-02 1 1  ON 35
eH1_6                 9.611205e-02 1 1  ON 36
eH1_7                 1.399681e-01 1 1  ON 37
eH1_8                 1.503561e-01 1 1  ON 38
eH1_9                 3.797346e-02 1 1  ON 39
eH2_0                -2.248352e-01 1 1  ON 40
eH2_1                -1.294776e-01 1 1  ON 41
eH2_2                -8.569163e-02 1 1  ON 42
eH2_3                -3.339111e-02 1 1  ON 43
eH2_4                 1.475034e-02 1 1  ON 44
eH2_5                 4.885314e-02 1 1  ON 45
eH2_6                 1.019242e-01 1 1  ON 46
eH2_7                 1.493905e-01 1 1  ON 47
eH2_8                 1.582173e-01 1 1  ON 48
eH2_9                 1.886123e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6556e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.0808
    reference variance = 2.88551
====================================================
  Execution time = 2.2602e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4078e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5709e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340594022118
                                         uncertainty =       0.004989025604

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340594022118
                                         uncertainty =       0.004989025604

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412783966
  error estimate for blocks of size 2^( 2) =       0.000425865318
  error estimate for blocks of size 2^( 3) =       0.000439640608
  error estimate for blocks of size 2^( 4) =       0.000452636612
  error estimate for blocks of size 2^( 5) =       0.000463948519
  error estimate for blocks of size 2^( 6) =       0.000473744685
  error estimate for blocks of size 2^( 7) =       0.000476754103

      target function =                  N/A
              le_mean =     -16.905608324032
             les_mean =     286.140373841020
             stat err =       0.000466770980
             autocorr =       1.278680537221
              std dev =       0.583764683609
             le_variance =       0.340781205830


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690560832403e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905608324032       residual = 5.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905608620409       residual = 4.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905609597753       residual = 3.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905609997472       residual = 4.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905611536291       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905612203277       residual = 4.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905612092767       residual = 5.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905612352841       residual = 2.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905612206807       residual = 8.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-01 is 8.730428e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905608324032       residual = 5.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905608407900       residual = 4.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905608751816       residual = 4.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905608749970       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905609246194       residual = 8.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905609408816       residual = 3.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905609381781       residual = 2.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905609428744       residual = 9.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+00 is 2.431432e-04

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905608324032       residual = 5.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905608345714       residual = 4.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905608440490       residual = 4.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905608435561       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905608564851       residual = 7.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905608604185       residual = 2.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905608597574       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905608608433       residual = 6.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+00 is 6.296278e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.258857 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8184e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.062534e-01 1 1  ON 0
 uu_1                 1.406357e-01 1 1  ON 1
 uu_2                 4.016428e-02 1 1  ON 2
 uu_3                -2.051610e-02 1 1  ON 3
 uu_4                -6.353463e-02 1 1  ON 4
 uu_5                -9.590658e-02 1 1  ON 5
 uu_6                -1.211209e-01 1 1  ON 6
 uu_7                -1.329842e-01 1 1  ON 7
 uu_8                -1.247043e-01 1 1  ON 8
 uu_9                -9.542567e-02 1 1  ON 9
 ud_0                 4.364675e-01 1 1  ON 10
 ud_1                 1.733295e-01 1 1  ON 11
 ud_2                 5.795726e-02 1 1  ON 12
 ud_3                -9.189605e-03 1 1  ON 13
 ud_4                -6.465148e-02 1 1  ON 14
 ud_5                -1.047240e-01 1 1  ON 15
 ud_6                -1.310126e-01 1 1  ON 16
 ud_7                -1.467188e-01 1 1  ON 17
 ud_8                -1.471919e-01 1 1  ON 18
 ud_9                -1.375677e-01 1 1  ON 19
 eO_0                -7.408008e-01 1 1  ON 20
 eO_1                -4.266620e-01 1 1  ON 21
 eO_2                -1.629168e-02 1 1  ON 22
 eO_3                 2.926292e-01 1 1  ON 23
 eO_4                 5.068017e-01 1 1  ON 24
 eO_5                 4.637086e-01 1 1  ON 25
 eO_6                 2.366686e-01 1 1  ON 26
 eO_7                -5.484590e-02 1 1  ON 27
 eO_8                -2.015027e-01 1 1  ON 28
 eO_9                -6.204075e-02 1 1  ON 29
eH1_0                -2.258582e-01 1 1  ON 30
eH1_1                -1.308999e-01 1 1  ON 31
eH1_2                -8.736079e-02 1 1  ON 32
eH1_3                -3.493306e-02 1 1  ON 33
eH1_4                 1.276028e-02 1 1  ON 34
eH1_5                 4.560497e-02 1 1  ON 35
eH1_6                 9.612772e-02 1 1  ON 36
eH1_7                 1.400188e-01 1 1  ON 37
eH1_8                 1.504433e-01 1 1  ON 38
eH1_9                 3.804674e-02 1 1  ON 39
eH2_0                -2.249068e-01 1 1  ON 40
eH2_1                -1.295550e-01 1 1  ON 41
eH2_2                -8.574683e-02 1 1  ON 42
eH2_3                -3.337968e-02 1 1  ON 43
eH2_4                 1.473036e-02 1 1  ON 44
eH2_5                 4.889556e-02 1 1  ON 45
eH2_6                 1.019823e-01 1 1  ON 46
eH2_7                 1.493801e-01 1 1  ON 47
eH2_8                 1.582583e-01 1 1  ON 48
eH2_9                 1.893859e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.9017
    reference variance = 0.31198
====================================================
  Execution time = 2.0152e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3717e-01
  Total weights = 2.0000e+06
  Execution time = 2.0578e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337169835798
                                         uncertainty =       0.003981105931

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337169835798
                                         uncertainty =       0.003981105931

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410577553
  error estimate for blocks of size 2^( 2) =       0.000423267658
  error estimate for blocks of size 2^( 3) =       0.000436721562
  error estimate for blocks of size 2^( 4) =       0.000449369465
  error estimate for blocks of size 2^( 5) =       0.000460120889
  error estimate for blocks of size 2^( 6) =       0.000467580309
  error estimate for blocks of size 2^( 7) =       0.000472718030

      target function =                  N/A
              le_mean =     -16.904959695354
             les_mean =     286.114809986231
             stat err =       0.000462447173
             autocorr =       1.268626722759
              std dev =       0.580644343178
             le_variance =       0.337147853265

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337312789563
                                         uncertainty =       0.003983270804

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337312789563
                                         uncertainty =       0.003983270804

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410664541
  error estimate for blocks of size 2^( 2) =       0.000423351183
  error estimate for blocks of size 2^( 3) =       0.000436798960
  error estimate for blocks of size 2^( 4) =       0.000449440295
  error estimate for blocks of size 2^( 5) =       0.000460185882
  error estimate for blocks of size 2^( 6) =       0.000467641920
  error estimate for blocks of size 2^( 7) =       0.000472776778

      target function =                  N/A
              le_mean =     -16.904960912404
             les_mean =     286.114994012402
             stat err =       0.000462511219
             autocorr =       1.268440592770
              std dev =       0.580767364035
             le_variance =       0.337290731128

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337218031299
                                         uncertainty =       0.003981981209

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337218031299
                                         uncertainty =       0.003981981209

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410606873
  error estimate for blocks of size 2^( 2) =       0.000423296046
  error estimate for blocks of size 2^( 3) =       0.000436747192
  error estimate for blocks of size 2^( 4) =       0.000449392019
  error estimate for blocks of size 2^( 5) =       0.000460140866
  error estimate for blocks of size 2^( 6) =       0.000467599064
  error estimate for blocks of size 2^( 7) =       0.000472735374

      target function =                  N/A
              le_mean =     -16.904960159367
             les_mean =     286.114873829230
             stat err =       0.000462466831
             autocorr =       1.268553388643
              std dev =       0.580685808378
             le_variance =       0.337196008051

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337174562600
                                         uncertainty =       0.003981204224

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337174562600
                                         uncertainty =       0.003981204224

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410580427
  error estimate for blocks of size 2^( 2) =       0.000423270451
  error estimate for blocks of size 2^( 3) =       0.000436724024
  error estimate for blocks of size 2^( 4) =       0.000449371549
  error estimate for blocks of size 2^( 5) =       0.000460122676
  error estimate for blocks of size 2^( 6) =       0.000467581974
  error estimate for blocks of size 2^( 7) =       0.000472719541

      target function =                  N/A
              le_mean =     -16.904959734842
             les_mean =     286.114816042709
             stat err =       0.000462448935
             autocorr =       1.268618623043
              std dev =       0.580648408800
             le_variance =       0.337152574641


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904959695354        initial
     6.1035e-01     6.1035e+00             8.7304e-04       -16.904960912404  <--
     2.4414e+00     2.4414e+01             2.4314e-04       -16.904960159367
     9.7656e+00     9.7656e+01             6.2963e-05       -16.904959734842

*****************************************************************************
Applying the update for shift_i =   6.1035e-01     and shift_s =   6.1035e+00
*****************************************************************************

  Execution time = 3.1594e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.063779e-01 1 1  ON 0
 uu_1                 1.407182e-01 1 1  ON 1
 uu_2                 4.016746e-02 1 1  ON 2
 uu_3                -2.057458e-02 1 1  ON 3
 uu_4                -6.360727e-02 1 1  ON 4
 uu_5                -9.603662e-02 1 1  ON 5
 uu_6                -1.213092e-01 1 1  ON 6
 uu_7                -1.329945e-01 1 1  ON 7
 uu_8                -1.247100e-01 1 1  ON 8
 uu_9                -9.546695e-02 1 1  ON 9
 ud_0                 4.365600e-01 1 1  ON 10
 ud_1                 1.734473e-01 1 1  ON 11
 ud_2                 5.796729e-02 1 1  ON 12
 ud_3                -9.297916e-03 1 1  ON 13
 ud_4                -6.473793e-02 1 1  ON 14
 ud_5                -1.048447e-01 1 1  ON 15
 ud_6                -1.310387e-01 1 1  ON 16
 ud_7                -1.466768e-01 1 1  ON 17
 ud_8                -1.471388e-01 1 1  ON 18
 ud_9                -1.375263e-01 1 1  ON 19
 eO_0                -7.414307e-01 1 1  ON 20
 eO_1                -4.269704e-01 1 1  ON 21
 eO_2                -1.636764e-02 1 1  ON 22
 eO_3                 2.928467e-01 1 1  ON 23
 eO_4                 5.073164e-01 1 1  ON 24
 eO_5                 4.640682e-01 1 1  ON 25
 eO_6                 2.367803e-01 1 1  ON 26
 eO_7                -5.471539e-02 1 1  ON 27
 eO_8                -2.016434e-01 1 1  ON 28
 eO_9                -6.219243e-02 1 1  ON 29
eH1_0                -2.261902e-01 1 1  ON 30
eH1_1                -1.310672e-01 1 1  ON 31
eH1_2                -8.747364e-02 1 1  ON 32
eH1_3                -3.492542e-02 1 1  ON 33
eH1_4                 1.271096e-02 1 1  ON 34
eH1_5                 4.555435e-02 1 1  ON 35
eH1_6                 9.617310e-02 1 1  ON 36
eH1_7                 1.401704e-01 1 1  ON 37
eH1_8                 1.507044e-01 1 1  ON 38
eH1_9                 3.826824e-02 1 1  ON 39
eH2_0                -2.251177e-01 1 1  ON 40
eH2_1                -1.297592e-01 1 1  ON 41
eH2_2                -8.589762e-02 1 1  ON 42
eH2_3                -3.337411e-02 1 1  ON 43
eH2_4                 1.468457e-02 1 1  ON 44
eH2_5                 4.898859e-02 1 1  ON 45
eH2_6                 1.021486e-01 1 1  ON 46
eH2_7                 1.493560e-01 1 1  ON 47
eH2_8                 1.583827e-01 1 1  ON 48
eH2_9                 1.917227e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9784e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.8585
    reference variance = 0.473138
====================================================
  Execution time = 2.0735e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3829e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6454e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338314973819
                                         uncertainty =       0.003645065133

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338314973819
                                         uncertainty =       0.003645065133

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411273232
  error estimate for blocks of size 2^( 2) =       0.000424077460
  error estimate for blocks of size 2^( 3) =       0.000437853084
  error estimate for blocks of size 2^( 4) =       0.000450581598
  error estimate for blocks of size 2^( 5) =       0.000460293895
  error estimate for blocks of size 2^( 6) =       0.000468713345
  error estimate for blocks of size 2^( 7) =       0.000473907983

      target function =                  N/A
              le_mean =     -16.905617474969
             les_mean =     286.138193384279
             stat err =       0.000463374205
             autocorr =       1.269412642207
              std dev =       0.581628183174
             le_variance =       0.338291343462


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690561747497e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905617474969       residual = 4.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905619471584       residual = 6.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905621970981       residual = 5.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905625073451       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905624779461       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905622676589       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905625369591       residual = 4.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905625691836       residual = 2.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905625008861       residual = 6.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905625354608       residual = 6.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905625279247       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905625322738       residual = 6.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e-01 is 2.721614e-03

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905617474969       residual = 4.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905618213373       residual = 5.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905619318276       residual = 4.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905620568220       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905620088587       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905619549992       residual = 3.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905620051552       residual = 9.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905619932937       residual = 2.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905619938404       residual = 7.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-01 is 8.418478e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905617474969       residual = 4.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905617684702       residual = 5.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905618038721       residual = 4.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905618325616       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905618244470       residual = 8.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905618125118       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905618191155       residual = 4.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905618137777       residual = 9.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+00 is 2.297169e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.262482 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6392e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.065182e-01 1 1  ON 0
 uu_1                 1.406801e-01 1 1  ON 1
 uu_2                 4.012190e-02 1 1  ON 2
 uu_3                -2.066796e-02 1 1  ON 3
 uu_4                -6.371088e-02 1 1  ON 4
 uu_5                -9.610319e-02 1 1  ON 5
 uu_6                -1.212732e-01 1 1  ON 6
 uu_7                -1.331417e-01 1 1  ON 7
 uu_8                -1.247670e-01 1 1  ON 8
 uu_9                -9.549409e-02 1 1  ON 9
 ud_0                 4.368275e-01 1 1  ON 10
 ud_1                 1.736472e-01 1 1  ON 11
 ud_2                 5.801099e-02 1 1  ON 12
 ud_3                -9.338299e-03 1 1  ON 13
 ud_4                -6.487979e-02 1 1  ON 14
 ud_5                -1.049754e-01 1 1  ON 15
 ud_6                -1.313428e-01 1 1  ON 16
 ud_7                -1.468071e-01 1 1  ON 17
 ud_8                -1.471192e-01 1 1  ON 18
 ud_9                -1.373943e-01 1 1  ON 19
 eO_0                -7.422725e-01 1 1  ON 20
 eO_1                -4.273403e-01 1 1  ON 21
 eO_2                -1.643901e-02 1 1  ON 22
 eO_3                 2.932271e-01 1 1  ON 23
 eO_4                 5.079556e-01 1 1  ON 24
 eO_5                 4.644686e-01 1 1  ON 25
 eO_6                 2.368897e-01 1 1  ON 26
 eO_7                -5.455866e-02 1 1  ON 27
 eO_8                -2.018528e-01 1 1  ON 28
 eO_9                -6.237471e-02 1 1  ON 29
eH1_0                -2.265501e-01 1 1  ON 30
eH1_1                -1.310790e-01 1 1  ON 31
eH1_2                -8.737961e-02 1 1  ON 32
eH1_3                -3.497092e-02 1 1  ON 33
eH1_4                 1.260264e-02 1 1  ON 34
eH1_5                 4.541775e-02 1 1  ON 35
eH1_6                 9.612389e-02 1 1  ON 36
eH1_7                 1.402683e-01 1 1  ON 37
eH1_8                 1.509190e-01 1 1  ON 38
eH1_9                 3.853378e-02 1 1  ON 39
eH2_0                -2.256629e-01 1 1  ON 40
eH2_1                -1.299722e-01 1 1  ON 41
eH2_2                -8.599313e-02 1 1  ON 42
eH2_3                -3.349171e-02 1 1  ON 43
eH2_4                 1.472301e-02 1 1  ON 44
eH2_5                 4.897439e-02 1 1  ON 45
eH2_6                 1.021649e-01 1 1  ON 46
eH2_7                 1.494236e-01 1 1  ON 47
eH2_8                 1.587534e-01 1 1  ON 48
eH2_9                 1.963016e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.9205
    reference variance = 0.334981
====================================================
  Execution time = 2.0247e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.3093e-01
  Total weights = 2.0000e+06
  Execution time = 1.8614e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330779466988
                                         uncertainty =       0.003499339416

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330779466988
                                         uncertainty =       0.003499339416

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406661437
  error estimate for blocks of size 2^( 2) =       0.000419858973
  error estimate for blocks of size 2^( 3) =       0.000433513626
  error estimate for blocks of size 2^( 4) =       0.000445866194
  error estimate for blocks of size 2^( 5) =       0.000455954866
  error estimate for blocks of size 2^( 6) =       0.000463688176
  error estimate for blocks of size 2^( 7) =       0.000470594023

      target function =                  N/A
              le_mean =     -16.904233037652
             les_mean =     286.083841475181
             stat err =       0.000459025815
             autocorr =       1.274113852417
              std dev =       0.575106120031
             le_variance =       0.330747049297

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331326097995
                                         uncertainty =       0.003508801887

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331326097995
                                         uncertainty =       0.003508801887

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406997401
  error estimate for blocks of size 2^( 2) =       0.000420188046
  error estimate for blocks of size 2^( 3) =       0.000433826803
  error estimate for blocks of size 2^( 4) =       0.000446162280
  error estimate for blocks of size 2^( 5) =       0.000456224328
  error estimate for blocks of size 2^( 6) =       0.000463936211
  error estimate for blocks of size 2^( 7) =       0.000470838853

      target function =                  N/A
              le_mean =     -16.904236072485
             les_mean =     286.084490796890
             stat err =       0.000459290418
             autocorr =       1.273478153735
              std dev =       0.575581243827
             le_variance =       0.331293768245

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331154047280
                                         uncertainty =       0.003506417386

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331154047280
                                         uncertainty =       0.003506417386

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406891701
  error estimate for blocks of size 2^( 2) =       0.000420083413
  error estimate for blocks of size 2^( 3) =       0.000433728225
  error estimate for blocks of size 2^( 4) =       0.000446071657
  error estimate for blocks of size 2^( 5) =       0.000456143898
  error estimate for blocks of size 2^( 6) =       0.000463863019
  error estimate for blocks of size 2^( 7) =       0.000470769357

      target function =                  N/A
              le_mean =     -16.904234863429
             les_mean =     286.084277865006
             stat err =       0.000459211983
             autocorr =       1.273704725776
              std dev =       0.575431761906
             le_variance =       0.331121712610

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330830259031
                                         uncertainty =       0.003500327424

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330830259031
                                         uncertainty =       0.003500327424

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406692673
  error estimate for blocks of size 2^( 2) =       0.000419889349
  error estimate for blocks of size 2^( 3) =       0.000433542661
  error estimate for blocks of size 2^( 4) =       0.000445894124
  error estimate for blocks of size 2^( 5) =       0.000455980541
  error estimate for blocks of size 2^( 6) =       0.000463711855
  error estimate for blocks of size 2^( 7) =       0.000470617884

      target function =                  N/A
              le_mean =     -16.904233234168
             les_mean =     286.083898929574
             stat err =       0.000459051101
             autocorr =       1.274058504363
              std dev =       0.575150293256
             le_variance =       0.330797859833


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904233037652        initial
     1.5259e-01     1.5259e+00             2.7216e-03       -16.904236072485  <--
     6.1035e-01     6.1035e+00             8.4185e-04       -16.904234863429
     2.4414e+00     2.4414e+01             2.2972e-04       -16.904233234168

*****************************************************************************
Applying the update for shift_i =   1.5259e-01     and shift_s =   1.5259e+00
*****************************************************************************

  Execution time = 2.9664e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.068135e-01 1 1  ON 0
 uu_1                 1.407304e-01 1 1  ON 1
 uu_2                 4.008294e-02 1 1  ON 2
 uu_3                -2.084172e-02 1 1  ON 3
 uu_4                -6.399382e-02 1 1  ON 4
 uu_5                -9.633123e-02 1 1  ON 5
 uu_6                -1.213971e-01 1 1  ON 6
 uu_7                -1.334903e-01 1 1  ON 7
 uu_8                -1.249987e-01 1 1  ON 8
 uu_9                -9.562671e-02 1 1  ON 9
 ud_0                 4.373840e-01 1 1  ON 10
 ud_1                 1.740834e-01 1 1  ON 11
 ud_2                 5.822015e-02 1 1  ON 12
 ud_3                -9.377784e-03 1 1  ON 13
 ud_4                -6.517472e-02 1 1  ON 14
 ud_5                -1.053878e-01 1 1  ON 15
 ud_6                -1.318923e-01 1 1  ON 16
 ud_7                -1.471870e-01 1 1  ON 17
 ud_8                -1.472261e-01 1 1  ON 18
 ud_9                -1.370673e-01 1 1  ON 19
 eO_0                -7.441523e-01 1 1  ON 20
 eO_1                -4.284893e-01 1 1  ON 21
 eO_2                -1.681286e-02 1 1  ON 22
 eO_3                 2.939792e-01 1 1  ON 23
 eO_4                 5.096607e-01 1 1  ON 24
 eO_5                 4.657836e-01 1 1  ON 25
 eO_6                 2.373420e-01 1 1  ON 26
 eO_7                -5.412230e-02 1 1  ON 27
 eO_8                -2.025153e-01 1 1  ON 28
 eO_9                -6.293538e-02 1 1  ON 29
eH1_0                -2.272630e-01 1 1  ON 30
eH1_1                -1.312169e-01 1 1  ON 31
eH1_2                -8.742351e-02 1 1  ON 32
eH1_3                -3.508907e-02 1 1  ON 33
eH1_4                 1.226990e-02 1 1  ON 34
eH1_5                 4.502903e-02 1 1  ON 35
eH1_6                 9.598558e-02 1 1  ON 36
eH1_7                 1.405718e-01 1 1  ON 37
eH1_8                 1.515633e-01 1 1  ON 38
eH1_9                 3.933903e-02 1 1  ON 39
eH2_0                -2.268927e-01 1 1  ON 40
eH2_1                -1.306175e-01 1 1  ON 41
eH2_2                -8.638300e-02 1 1  ON 42
eH2_3                -3.385227e-02 1 1  ON 43
eH2_4                 1.460170e-02 1 1  ON 44
eH2_5                 4.886703e-02 1 1  ON 45
eH2_6                 1.022031e-01 1 1  ON 46
eH2_7                 1.496487e-01 1 1  ON 47
eH2_8                 1.598551e-01 1 1  ON 48
eH2_9                 2.101392e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6061e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.8698
    reference variance = 0.277839
====================================================
  Execution time = 2.0744e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3649e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4868e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336488405666
                                         uncertainty =       0.004379666127

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336488405666
                                         uncertainty =       0.004379666127

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410174202
  error estimate for blocks of size 2^( 2) =       0.000423005784
  error estimate for blocks of size 2^( 3) =       0.000436187266
  error estimate for blocks of size 2^( 4) =       0.000448736686
  error estimate for blocks of size 2^( 5) =       0.000459070846
  error estimate for blocks of size 2^( 6) =       0.000466893895
  error estimate for blocks of size 2^( 7) =       0.000470790917

      target function =                  N/A
              le_mean =     -16.905339624448
             les_mean =     286.126993402385
             stat err =       0.000461373086
             autocorr =       1.265225185651
              std dev =       0.580073920038
             le_variance =       0.336485752708


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690533962445e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-02, overlap shift 3.8147e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905339624448       residual = 5.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905341532887       residual = 4.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905341391396       residual = 3.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905344467521       residual = 5.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905343064817       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905352974904       residual = 4.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905358473022       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905359663401       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905359453263       residual = 7.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905360274227       residual = 3.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905359990024       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905360433611       residual = 8.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905359938722       residual = 5.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905359219495       residual = 2.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.905359342235       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.905359233472       residual = 5.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-02 is 6.637128e-03

solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905339624448       residual = 5.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905340743063       residual = 3.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905340893295       residual = 3.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905343530017       residual = 4.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905342626586       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905344933758       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905346675243       residual = 2.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905346696643       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905346570844       residual = 5.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905346304885       residual = 2.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905346450824       residual = 8.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e-01 is 1.748195e-03

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905339624448       residual = 5.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905340045703       residual = 3.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905340260099       residual = 3.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905341466304       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905340885556       residual = 7.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905340962228       residual = 3.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905341417287       residual = 8.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905341511813       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905341523051       residual = 3.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-01 is 4.579795e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.267951 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6245e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.074544e-01 1 1  ON 0
 uu_1                 1.411144e-01 1 1  ON 1
 uu_2                 4.029284e-02 1 1  ON 2
 uu_3                -2.073731e-02 1 1  ON 3
 uu_4                -6.412614e-02 1 1  ON 4
 uu_5                -9.680365e-02 1 1  ON 5
 uu_6                -1.218006e-01 1 1  ON 6
 uu_7                -1.344189e-01 1 1  ON 7
 uu_8                -1.258303e-01 1 1  ON 8
 uu_9                -9.597748e-02 1 1  ON 9
 ud_0                 4.381619e-01 1 1  ON 10
 ud_1                 1.744753e-01 1 1  ON 11
 ud_2                 5.856351e-02 1 1  ON 12
 ud_3                -9.449721e-03 1 1  ON 13
 ud_4                -6.566893e-02 1 1  ON 14
 ud_5                -1.060510e-01 1 1  ON 15
 ud_6                -1.321811e-01 1 1  ON 16
 ud_7                -1.472940e-01 1 1  ON 17
 ud_8                -1.474494e-01 1 1  ON 18
 ud_9                -1.367468e-01 1 1  ON 19
 eO_0                -7.457974e-01 1 1  ON 20
 eO_1                -4.300083e-01 1 1  ON 21
 eO_2                -1.731879e-02 1 1  ON 22
 eO_3                 2.947206e-01 1 1  ON 23
 eO_4                 5.112400e-01 1 1  ON 24
 eO_5                 4.675318e-01 1 1  ON 25
 eO_6                 2.385269e-01 1 1  ON 26
 eO_7                -5.382930e-02 1 1  ON 27
 eO_8                -2.034482e-01 1 1  ON 28
 eO_9                -6.376004e-02 1 1  ON 29
eH1_0                -2.283636e-01 1 1  ON 30
eH1_1                -1.323508e-01 1 1  ON 31
eH1_2                -8.799202e-02 1 1  ON 32
eH1_3                -3.558842e-02 1 1  ON 33
eH1_4                 1.196313e-02 1 1  ON 34
eH1_5                 4.516837e-02 1 1  ON 35
eH1_6                 9.638688e-02 1 1  ON 36
eH1_7                 1.410435e-01 1 1  ON 37
eH1_8                 1.527313e-01 1 1  ON 38
eH1_9                 4.055682e-02 1 1  ON 39
eH2_0                -2.275653e-01 1 1  ON 40
eH2_1                -1.312434e-01 1 1  ON 41
eH2_2                -8.682456e-02 1 1  ON 42
eH2_3                -3.409263e-02 1 1  ON 43
eH2_4                 1.406588e-02 1 1  ON 44
eH2_5                 4.834389e-02 1 1  ON 45
eH2_6                 1.022038e-01 1 1  ON 46
eH2_7                 1.497392e-01 1 1  ON 47
eH2_8                 1.611537e-01 1 1  ON 48
eH2_9                 2.263661e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.8315
    reference variance = 0.295613
====================================================
  Execution time = 2.0314e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3961e-01
  Total weights = 2.0000e+06
  Execution time = 1.8630e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339129914944
                                         uncertainty =       0.004218911599

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339129914944
                                         uncertainty =       0.004218911599

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411741509
  error estimate for blocks of size 2^( 2) =       0.000425840911
  error estimate for blocks of size 2^( 3) =       0.000441884278
  error estimate for blocks of size 2^( 4) =       0.000459083310
  error estimate for blocks of size 2^( 5) =       0.000480569526
  error estimate for blocks of size 2^( 6) =       0.000505409976
  error estimate for blocks of size 2^( 7) =       0.000539893486

      target function =                  N/A
              le_mean =     -16.906730675252
             les_mean =     286.176604097230
             stat err =       0.000496239075
             autocorr =       1.452555087736
              std dev =       0.582290426881
             le_variance =       0.339062141237

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340357748263
                                         uncertainty =       0.004236794434

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340357748263
                                         uncertainty =       0.004236794434

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412486090
  error estimate for blocks of size 2^( 2) =       0.000426562804
  error estimate for blocks of size 2^( 3) =       0.000442548323
  error estimate for blocks of size 2^( 4) =       0.000459686556
  error estimate for blocks of size 2^( 5) =       0.000481120001
  error estimate for blocks of size 2^( 6) =       0.000505919972
  error estimate for blocks of size 2^( 7) =       0.000540351784

      target function =                  N/A
              le_mean =     -16.906733495663
             les_mean =     286.177926872579
             stat err =       0.000496769579
             autocorr =       1.450411948277
              std dev =       0.583343423172
             le_variance =       0.340289549358

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340228543608
                                         uncertainty =       0.004232488828

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340228543608
                                         uncertainty =       0.004232488828

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412407794
  error estimate for blocks of size 2^( 2) =       0.000426484637
  error estimate for blocks of size 2^( 3) =       0.000442482469
  error estimate for blocks of size 2^( 4) =       0.000459635982
  error estimate for blocks of size 2^( 5) =       0.000481089072
  error estimate for blocks of size 2^( 6) =       0.000505898346
  error estimate for blocks of size 2^( 7) =       0.000540346869

      target function =                  N/A
              le_mean =     -16.906732329350
             les_mean =     286.177758262558
             stat err =       0.000496742567
             autocorr =       1.450804945438
              std dev =       0.583232694864
             le_variance =       0.340160376358

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339329110986
                                         uncertainty =       0.004221140128

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339329110986
                                         uncertainty =       0.004221140128

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411862391
  error estimate for blocks of size 2^( 2) =       0.000425957204
  error estimate for blocks of size 2^( 3) =       0.000441993050
  error estimate for blocks of size 2^( 4) =       0.000459184543
  error estimate for blocks of size 2^( 5) =       0.000480666315
  error estimate for blocks of size 2^( 6) =       0.000505501774
  error estimate for blocks of size 2^( 7) =       0.000539979245

      target function =                  N/A
              le_mean =     -16.906730174093
             les_mean =     286.176786268452
             stat err =       0.000496332969
             autocorr =       1.452251974640
              std dev =       0.582461379417
             le_variance =       0.339261258512


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906730675252        initial
     3.8147e-02     3.8147e-01             6.6371e-03       -16.906733495663  <--
     1.5259e-01     1.5259e+00             1.7482e-03       -16.906732329350
     6.1035e-01     6.1035e+00             4.5798e-04       -16.906730174093

*****************************************************************************
Applying the update for shift_i =   3.8147e-02     and shift_s =   3.8147e-01
*****************************************************************************

  Execution time = 2.9696e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.083875e-01 1 1  ON 0
 uu_1                 1.418364e-01 1 1  ON 1
 uu_2                 4.078538e-02 1 1  ON 2
 uu_3                -2.058344e-02 1 1  ON 3
 uu_4                -6.443721e-02 1 1  ON 4
 uu_5                -9.763331e-02 1 1  ON 5
 uu_6                -1.230263e-01 1 1  ON 6
 uu_7                -1.362435e-01 1 1  ON 7
 uu_8                -1.278634e-01 1 1  ON 8
 uu_9                -9.737605e-02 1 1  ON 9
 ud_0                 4.392867e-01 1 1  ON 10
 ud_1                 1.753847e-01 1 1  ON 11
 ud_2                 5.922350e-02 1 1  ON 12
 ud_3                -9.254660e-03 1 1  ON 13
 ud_4                -6.604668e-02 1 1  ON 14
 ud_5                -1.068463e-01 1 1  ON 15
 ud_6                -1.331286e-01 1 1  ON 16
 ud_7                -1.479677e-01 1 1  ON 17
 ud_8                -1.480540e-01 1 1  ON 18
 ud_9                -1.361841e-01 1 1  ON 19
 eO_0                -7.492154e-01 1 1  ON 20
 eO_1                -4.327866e-01 1 1  ON 21
 eO_2                -1.868634e-02 1 1  ON 22
 eO_3                 2.955844e-01 1 1  ON 23
 eO_4                 5.141624e-01 1 1  ON 24
 eO_5                 4.719008e-01 1 1  ON 25
 eO_6                 2.425576e-01 1 1  ON 26
 eO_7                -5.258508e-02 1 1  ON 27
 eO_8                -2.063032e-01 1 1  ON 28
 eO_9                -6.638417e-02 1 1  ON 29
eH1_0                -2.307996e-01 1 1  ON 30
eH1_1                -1.346558e-01 1 1  ON 31
eH1_2                -8.987098e-02 1 1  ON 32
eH1_3                -3.718196e-02 1 1  ON 33
eH1_4                 1.071550e-02 1 1  ON 34
eH1_5                 4.465788e-02 1 1  ON 35
eH1_6                 9.673185e-02 1 1  ON 36
eH1_7                 1.425052e-01 1 1  ON 37
eH1_8                 1.563970e-01 1 1  ON 38
eH1_9                 4.438877e-02 1 1  ON 39
eH2_0                -2.294026e-01 1 1  ON 40
eH2_1                -1.329014e-01 1 1  ON 41
eH2_2                -8.830252e-02 1 1  ON 42
eH2_3                -3.536017e-02 1 1  ON 43
eH2_4                 1.275615e-02 1 1  ON 44
eH2_5                 4.684895e-02 1 1  ON 45
eH2_6                 1.018024e-01 1 1  ON 46
eH2_7                 1.501833e-01 1 1  ON 47
eH2_8                 1.650448e-01 1 1  ON 48
eH2_9                 2.765105e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5946e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.8831
    reference variance = 0.181173
====================================================
  Execution time = 2.0475e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3348e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6200e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333547013609
                                         uncertainty =       0.003544718795

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333547013609
                                         uncertainty =       0.003544718795

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408340971
  error estimate for blocks of size 2^( 2) =       0.000420999240
  error estimate for blocks of size 2^( 3) =       0.000434485172
  error estimate for blocks of size 2^( 4) =       0.000447087856
  error estimate for blocks of size 2^( 5) =       0.000457438168
  error estimate for blocks of size 2^( 6) =       0.000465107149
  error estimate for blocks of size 2^( 7) =       0.000471972438

      target function =                  N/A
              le_mean =     -16.905172657313
             les_mean =     286.118347103791
             stat err =       0.000460401403
             autocorr =       1.271239450886
              std dev =       0.577481339079
             le_variance =       0.333484696985


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690517265731e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-03, overlap shift 9.5367e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905172657313       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905167046926       residual = 3.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905168796464       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905169591546       residual = 8.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905177645325       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905176353385       residual = 4.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905183638214       residual = 5.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905185068113       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905187066499       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905188139756       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905187850225       residual = 9.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905188964202       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905192149709       residual = 7.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905193508716       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.905194119684       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.905195998381       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.905196798063       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.905196485644       residual = 9.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.905198825707       residual = 6.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.905199078814       residual = 2.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.905199513771       residual = 2.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.905199846007       residual = 2.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.905199633543       residual = 5.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         22 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-03 is 2.483420e-02

solving harmonic davidson linear method for identity shift 3.8147e-02, overlap shift 3.8147e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905172657313       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905167671426       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905169263315       residual = 3.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905168861352       residual = 6.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905175550584       residual = 5.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905174715952       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905178039381       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905177384006       residual = 6.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905177711377       residual = 3.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905177510355       residual = 3.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905178152411       residual = 2.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905177443767       residual = 7.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905178235459       residual = 3.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905178614375       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.905178607217       residual = 7.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-02 is 5.825942e-03

solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905172657313       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905169207458       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905170096456       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905169507954       residual = 3.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905173781332       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905172825194       residual = 4.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905173299312       residual = 3.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905173036490       residual = 9.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905173057496       residual = 4.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905173056594       residual = 2.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905173213698       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905173054974       residual = 2.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e-01 is 1.466800e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.278672 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6116e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.086180e-01 1 1  ON 0
 uu_1                 1.423607e-01 1 1  ON 1
 uu_2                 4.094041e-02 1 1  ON 2
 uu_3                -2.085470e-02 1 1  ON 3
 uu_4                -6.515204e-02 1 1  ON 4
 uu_5                -9.870781e-02 1 1  ON 5
 uu_6                -1.241944e-01 1 1  ON 6
 uu_7                -1.365424e-01 1 1  ON 7
 uu_8                -1.285173e-01 1 1  ON 8
 uu_9                -1.000228e-01 1 1  ON 9
 ud_0                 4.411565e-01 1 1  ON 10
 ud_1                 1.770396e-01 1 1  ON 11
 ud_2                 6.057254e-02 1 1  ON 12
 ud_3                -8.167655e-03 1 1  ON 13
 ud_4                -6.521150e-02 1 1  ON 14
 ud_5                -1.068961e-01 1 1  ON 15
 ud_6                -1.337303e-01 1 1  ON 16
 ud_7                -1.488496e-01 1 1  ON 17
 ud_8                -1.496022e-01 1 1  ON 18
 ud_9                -1.393844e-01 1 1  ON 19
 eO_0                -7.531434e-01 1 1  ON 20
 eO_1                -4.362486e-01 1 1  ON 21
 eO_2                -2.018929e-02 1 1  ON 22
 eO_3                 2.960505e-01 1 1  ON 23
 eO_4                 5.181028e-01 1 1  ON 24
 eO_5                 4.767389e-01 1 1  ON 25
 eO_6                 2.478576e-01 1 1  ON 26
 eO_7                -4.957353e-02 1 1  ON 27
 eO_8                -2.101306e-01 1 1  ON 28
 eO_9                -7.060775e-02 1 1  ON 29
eH1_0                -2.330993e-01 1 1  ON 30
eH1_1                -1.365287e-01 1 1  ON 31
eH1_2                -9.226937e-02 1 1  ON 32
eH1_3                -3.947747e-02 1 1  ON 33
eH1_4                 8.139072e-03 1 1  ON 34
eH1_5                 4.270109e-02 1 1  ON 35
eH1_6                 9.760654e-02 1 1  ON 36
eH1_7                 1.469962e-01 1 1  ON 37
eH1_8                 1.607843e-01 1 1  ON 38
eH1_9                 4.855783e-02 1 1  ON 39
eH2_0                -2.318015e-01 1 1  ON 40
eH2_1                -1.351140e-01 1 1  ON 41
eH2_2                -9.021689e-02 1 1  ON 42
eH2_3                -3.699077e-02 1 1  ON 43
eH2_4                 1.086719e-02 1 1  ON 44
eH2_5                 4.457875e-02 1 1  ON 45
eH2_6                 1.021304e-01 1 1  ON 46
eH2_7                 1.521714e-01 1 1  ON 47
eH2_8                 1.690762e-01 1 1  ON 48
eH2_9                 3.347699e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.8688
    reference variance = 0.287735
====================================================
  Execution time = 2.0202e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4290e-01
  Total weights = 2.0000e+06
  Execution time = 1.8619e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342227315726
                                         uncertainty =       0.003982342198

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342227315726
                                         uncertainty =       0.003982342198

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413637001
  error estimate for blocks of size 2^( 2) =       0.000426397507
  error estimate for blocks of size 2^( 3) =       0.000438853807
  error estimate for blocks of size 2^( 4) =       0.000451995055
  error estimate for blocks of size 2^( 5) =       0.000463809643
  error estimate for blocks of size 2^( 6) =       0.000473542074
  error estimate for blocks of size 2^( 7) =       0.000480039853

      target function =                  N/A
              le_mean =     -16.904991578510
             les_mean =     286.120931235592
             stat err =       0.000467346656
             autocorr =       1.276554963079
              std dev =       0.584971056707
             le_variance =       0.342191137185

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343763246507
                                         uncertainty =       0.003992360432

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343763246507
                                         uncertainty =       0.003992360432

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414564160
  error estimate for blocks of size 2^( 2) =       0.000427297633
  error estimate for blocks of size 2^( 3) =       0.000439687487
  error estimate for blocks of size 2^( 4) =       0.000452727813
  error estimate for blocks of size 2^( 5) =       0.000464442292
  error estimate for blocks of size 2^( 6) =       0.000474080586
  error estimate for blocks of size 2^( 7) =       0.000480579008

      target function =                  N/A
              le_mean =     -16.904999844408
             les_mean =     286.122746452441
             stat err =       0.000467957425
             autocorr =       1.274175288494
              std dev =       0.586282257008
             le_variance =       0.343726884883

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343679208173
                                         uncertainty =       0.003999961146

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343679208173
                                         uncertainty =       0.003999961146

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414513223
  error estimate for blocks of size 2^( 2) =       0.000427246513
  error estimate for blocks of size 2^( 3) =       0.000439642247
  error estimate for blocks of size 2^( 4) =       0.000452702860
  error estimate for blocks of size 2^( 5) =       0.000464438497
  error estimate for blocks of size 2^( 6) =       0.000474094160
  error estimate for blocks of size 2^( 7) =       0.000480596387

      target function =                  N/A
              le_mean =     -16.904997090431
             les_mean =     286.122568879716
             stat err =       0.000467957976
             autocorr =       1.274491459631
              std dev =       0.586210221712
             le_variance =       0.343642424040

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342504556080
                                         uncertainty =       0.003988189041

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342504556080
                                         uncertainty =       0.003988189041

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413804422
  error estimate for blocks of size 2^( 2) =       0.000426557540
  error estimate for blocks of size 2^( 3) =       0.000439000288
  error estimate for blocks of size 2^( 4) =       0.000452126329
  error estimate for blocks of size 2^( 5) =       0.000463926002
  error estimate for blocks of size 2^( 6) =       0.000473643930
  error estimate for blocks of size 2^( 7) =       0.000480141995

      target function =                  N/A
              le_mean =     -16.904990501466
             les_mean =     286.121171883200
             stat err =       0.000467459564
             autocorr =       1.276138596829
              std dev =       0.585207826141
             le_variance =       0.342468199777


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904991578510        initial
     9.5367e-03     9.5367e-02             2.4834e-02       -16.904999844408  <--
     3.8147e-02     3.8147e-01             5.8259e-03       -16.904997090431
     1.5259e-01     1.5259e+00             1.4668e-03       -16.904990501466

*****************************************************************************
Applying the update for shift_i =   9.5367e-03     and shift_s =   9.5367e-02
*****************************************************************************

  Execution time = 2.9586e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.089921e-01 1 1  ON 0
 uu_1                 1.425297e-01 1 1  ON 1
 uu_2                 4.081725e-02 1 1  ON 2
 uu_3                -2.145261e-02 1 1  ON 3
 uu_4                -6.637667e-02 1 1  ON 4
 uu_5                -1.006957e-01 1 1  ON 5
 uu_6                -1.270126e-01 1 1  ON 6
 uu_7                -1.401752e-01 1 1  ON 7
 uu_8                -1.323168e-01 1 1  ON 8
 uu_9                -1.048075e-01 1 1  ON 9
 ud_0                 4.441931e-01 1 1  ON 10
 ud_1                 1.799469e-01 1 1  ON 11
 ud_2                 6.314682e-02 1 1  ON 12
 ud_3                -6.076468e-03 1 1  ON 13
 ud_4                -6.383762e-02 1 1  ON 14
 ud_5                -1.065466e-01 1 1  ON 15
 ud_6                -1.345263e-01 1 1  ON 16
 ud_7                -1.508347e-01 1 1  ON 17
 ud_8                -1.522161e-01 1 1  ON 18
 ud_9                -1.435386e-01 1 1  ON 19
 eO_0                -7.578301e-01 1 1  ON 20
 eO_1                -4.400667e-01 1 1  ON 21
 eO_2                -2.214466e-02 1 1  ON 22
 eO_3                 2.972462e-01 1 1  ON 23
 eO_4                 5.236439e-01 1 1  ON 24
 eO_5                 4.854362e-01 1 1  ON 25
 eO_6                 2.584069e-01 1 1  ON 26
 eO_7                -4.099804e-02 1 1  ON 27
 eO_8                -2.189522e-01 1 1  ON 28
 eO_9                -8.374871e-02 1 1  ON 29
eH1_0                -2.392033e-01 1 1  ON 30
eH1_1                -1.426187e-01 1 1  ON 31
eH1_2                -9.808563e-02 1 1  ON 32
eH1_3                -4.493248e-02 1 1  ON 33
eH1_4                 2.967642e-03 1 1  ON 34
eH1_5                 3.824064e-02 1 1  ON 35
eH1_6                 9.717160e-02 1 1  ON 36
eH1_7                 1.534134e-01 1 1  ON 37
eH1_8                 1.740301e-01 1 1  ON 38
eH1_9                 6.357529e-02 1 1  ON 39
eH2_0                -2.380549e-01 1 1  ON 40
eH2_1                -1.411875e-01 1 1  ON 41
eH2_2                -9.588658e-02 1 1  ON 42
eH2_3                -4.228615e-02 1 1  ON 43
eH2_4                 5.937620e-03 1 1  ON 44
eH2_5                 3.945406e-02 1 1  ON 45
eH2_6                 1.005673e-01 1 1  ON 46
eH2_7                 1.557014e-01 1 1  ON 47
eH2_8                 1.805247e-01 1 1  ON 48
eH2_9                 5.248525e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5707e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.8424
    reference variance = 0.217995
====================================================
  Execution time = 2.0509e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4632e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5624e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346368402209
                                         uncertainty =       0.011977024965

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346368402209
                                         uncertainty =       0.011977024965

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416124722
  error estimate for blocks of size 2^( 2) =       0.000428281733
  error estimate for blocks of size 2^( 3) =       0.000440693327
  error estimate for blocks of size 2^( 4) =       0.000452337636
  error estimate for blocks of size 2^( 5) =       0.000462797259
  error estimate for blocks of size 2^( 6) =       0.000469861038
  error estimate for blocks of size 2^( 7) =       0.000475404726

      target function =                  N/A
              le_mean =     -16.906302232983
             les_mean =     286.169374587976
             stat err =       0.000465100165
             autocorr =       1.249240200156
              std dev =       0.588489225186
             le_variance =       0.346319568160


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690630223298e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e-03, overlap shift 2.3842e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906302232983       residual = 5.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906298613792       residual = 5.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906296846676       residual = 4.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906297600419       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906301369651       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906300224368       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906303304036       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906303459113       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906305065889       residual = 4.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906316267627       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906327963517       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906339434318       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906351078758       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906362816384       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906359307354       residual = 7.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906367232473       residual = 7.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.906370002351       residual = 7.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.906365172064       residual = 6.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.906367205735       residual = 3.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.906364643900       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.906365526942       residual = 3.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.906365607552       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.906364423929       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.906365104595       residual = 9.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.906367846582       residual = 4.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.906366587678       residual = 3.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.906369550380       residual = 4.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.906369356386       residual = 2.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.906368462412       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.906369089129       residual = 3.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         29 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e-03 is 6.766278e-02

solving harmonic davidson linear method for identity shift 9.5367e-03, overlap shift 9.5367e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906302232983       residual = 5.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906298720925       residual = 5.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906297102518       residual = 4.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906297811073       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906301336247       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906300272963       residual = 9.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906303268097       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906303442965       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906305096542       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906312607783       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906318536740       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906322333733       residual = 6.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906323428868       residual = 4.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906325529230       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906323382223       residual = 7.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906324849001       residual = 5.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.906325301396       residual = 6.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.906323706659       residual = 3.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.906323608323       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.906322976868       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.906323069804       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.906323100395       residual = 7.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         21 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-03 is 1.882274e-02

solving harmonic davidson linear method for identity shift 3.8147e-02, overlap shift 3.8147e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906302232983       residual = 5.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906299092743       residual = 5.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906297880091       residual = 3.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906298436337       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906301278067       residual = 8.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906300345960       residual = 6.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906303047698       residual = 9.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906302940146       residual = 6.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906304114095       residual = 5.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906306944539       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906307446344       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906307623164       residual = 4.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906307089986       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906307325882       residual = 7.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-02 is 4.711564e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.298685 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6100e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.076580e-01 1 1  ON 0
 uu_1                 1.410520e-01 1 1  ON 1
 uu_2                 3.931005e-02 1 1  ON 2
 uu_3                -2.359204e-02 1 1  ON 3
 uu_4                -6.932987e-02 1 1  ON 4
 uu_5                -1.040278e-01 1 1  ON 5
 uu_6                -1.306595e-01 1 1  ON 6
 uu_7                -1.443234e-01 1 1  ON 7
 uu_8                -1.364270e-01 1 1  ON 8
 uu_9                -1.074294e-01 1 1  ON 9
 ud_0                 4.472374e-01 1 1  ON 10
 ud_1                 1.834314e-01 1 1  ON 11
 ud_2                 6.655336e-02 1 1  ON 12
 ud_3                -2.976080e-03 1 1  ON 13
 ud_4                -6.075376e-02 1 1  ON 14
 ud_5                -1.037280e-01 1 1  ON 15
 ud_6                -1.326851e-01 1 1  ON 16
 ud_7                -1.509086e-01 1 1  ON 17
 ud_8                -1.529465e-01 1 1  ON 18
 ud_9                -1.464258e-01 1 1  ON 19
 eO_0                -7.557900e-01 1 1  ON 20
 eO_1                -4.376484e-01 1 1  ON 21
 eO_2                -1.913974e-02 1 1  ON 22
 eO_3                 3.017484e-01 1 1  ON 23
 eO_4                 5.294718e-01 1 1  ON 24
 eO_5                 4.929178e-01 1 1  ON 25
 eO_6                 2.640227e-01 1 1  ON 26
 eO_7                -4.193627e-02 1 1  ON 27
 eO_8                -2.312466e-01 1 1  ON 28
 eO_9                -9.924881e-02 1 1  ON 29
eH1_0                -2.452375e-01 1 1  ON 30
eH1_1                -1.476326e-01 1 1  ON 31
eH1_2                -1.025708e-01 1 1  ON 32
eH1_3                -4.887074e-02 1 1  ON 33
eH1_4                 7.672870e-04 1 1  ON 34
eH1_5                 3.564303e-02 1 1  ON 35
eH1_6                 9.499519e-02 1 1  ON 36
eH1_7                 1.536531e-01 1 1  ON 37
eH1_8                 1.837850e-01 1 1  ON 38
eH1_9                 8.075542e-02 1 1  ON 39
eH2_0                -2.433942e-01 1 1  ON 40
eH2_1                -1.454472e-01 1 1  ON 41
eH2_2                -1.010194e-01 1 1  ON 42
eH2_3                -4.671368e-02 1 1  ON 43
eH2_4                 1.930391e-03 1 1  ON 44
eH2_5                 3.587543e-02 1 1  ON 45
eH2_6                 9.696351e-02 1 1  ON 46
eH2_7                 1.567377e-01 1 1  ON 47
eH2_8                 1.901040e-01 1 1  ON 48
eH2_9                 7.130798e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.9312
    reference variance = 0.198418
====================================================
  Execution time = 2.0283e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3822e-01
  Total weights = 2.0000e+06
  Execution time = 1.8625e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338274442280
                                         uncertainty =       0.003162521147

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338274442280
                                         uncertainty =       0.003162521147

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411327152
  error estimate for blocks of size 2^( 2) =       0.000424558488
  error estimate for blocks of size 2^( 3) =       0.000437808286
  error estimate for blocks of size 2^( 4) =       0.000450991485
  error estimate for blocks of size 2^( 5) =       0.000462115363
  error estimate for blocks of size 2^( 6) =       0.000470881622
  error estimate for blocks of size 2^( 7) =       0.000474873445

      target function =                  N/A
              le_mean =     -16.905542735989
             les_mean =     286.135755080690
             stat err =       0.000464715479
             autocorr =       1.276437396330
              std dev =       0.581704436564
             le_variance =       0.338380051518

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338130285064
                                         uncertainty =       0.003159581834

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338130285064
                                         uncertainty =       0.003159581834

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411239493
  error estimate for blocks of size 2^( 2) =       0.000424449962
  error estimate for blocks of size 2^( 3) =       0.000437653155
  error estimate for blocks of size 2^( 4) =       0.000450760979
  error estimate for blocks of size 2^( 5) =       0.000461838801
  error estimate for blocks of size 2^( 6) =       0.000470596455
  error estimate for blocks of size 2^( 7) =       0.000474537034

      target function =                  N/A
              le_mean =     -16.905530588565
             les_mean =     286.135200152637
             stat err =       0.000464433317
             autocorr =       1.275431400129
              std dev =       0.581580468081
             le_variance =       0.338235840854

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338005385473
                                         uncertainty =       0.003157154198

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338005385473
                                         uncertainty =       0.003157154198

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411163520
  error estimate for blocks of size 2^( 2) =       0.000424397417
  error estimate for blocks of size 2^( 3) =       0.000437613045
  error estimate for blocks of size 2^( 4) =       0.000450728975
  error estimate for blocks of size 2^( 5) =       0.000461808158
  error estimate for blocks of size 2^( 6) =       0.000470579979
  error estimate for blocks of size 2^( 7) =       0.000474519783

      target function =                  N/A
              le_mean =     -16.905535008372
             les_mean =     286.135224631273
             stat err =       0.000464409224
             autocorr =       1.275770401814
              std dev =       0.581473026915
             le_variance =       0.338110881030

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337896146218
                                         uncertainty =       0.003158302810

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337896146218
                                         uncertainty =       0.003158302810

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411097065
  error estimate for blocks of size 2^( 2) =       0.000424336586
  error estimate for blocks of size 2^( 3) =       0.000437583901
  error estimate for blocks of size 2^( 4) =       0.000450756797
  error estimate for blocks of size 2^( 5) =       0.000461875198
  error estimate for blocks of size 2^( 6) =       0.000470651483
  error estimate for blocks of size 2^( 7) =       0.000474634585

      target function =                  N/A
              le_mean =     -16.905533215187
             les_mean =     286.135054714922
             stat err =       0.000464479516
             autocorr =       1.276569249131
              std dev =       0.581379045135
             le_variance =       0.338001594123


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905542735989        initial  <--
     2.3842e-03     2.3842e-02             6.7663e-02       -16.905530588565
     9.5367e-03     9.5367e-02             1.8823e-02       -16.905535008372
     3.8147e-02     3.8147e-01             4.7116e-03       -16.905533215187

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6631
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.089921e-01 1 1  ON 0
 uu_1                 1.425297e-01 1 1  ON 1
 uu_2                 4.081725e-02 1 1  ON 2
 uu_3                -2.145261e-02 1 1  ON 3
 uu_4                -6.637667e-02 1 1  ON 4
 uu_5                -1.006957e-01 1 1  ON 5
 uu_6                -1.270126e-01 1 1  ON 6
 uu_7                -1.401752e-01 1 1  ON 7
 uu_8                -1.323168e-01 1 1  ON 8
 uu_9                -1.048075e-01 1 1  ON 9
 ud_0                 4.441931e-01 1 1  ON 10
 ud_1                 1.799469e-01 1 1  ON 11
 ud_2                 6.314682e-02 1 1  ON 12
 ud_3                -6.076468e-03 1 1  ON 13
 ud_4                -6.383762e-02 1 1  ON 14
 ud_5                -1.065466e-01 1 1  ON 15
 ud_6                -1.345263e-01 1 1  ON 16
 ud_7                -1.508347e-01 1 1  ON 17
 ud_8                -1.522161e-01 1 1  ON 18
 ud_9                -1.435386e-01 1 1  ON 19
 eO_0                -7.578301e-01 1 1  ON 20
 eO_1                -4.400667e-01 1 1  ON 21
 eO_2                -2.214466e-02 1 1  ON 22
 eO_3                 2.972462e-01 1 1  ON 23
 eO_4                 5.236439e-01 1 1  ON 24
 eO_5                 4.854362e-01 1 1  ON 25
 eO_6                 2.584069e-01 1 1  ON 26
 eO_7                -4.099804e-02 1 1  ON 27
 eO_8                -2.189522e-01 1 1  ON 28
 eO_9                -8.374871e-02 1 1  ON 29
eH1_0                -2.392033e-01 1 1  ON 30
eH1_1                -1.426187e-01 1 1  ON 31
eH1_2                -9.808563e-02 1 1  ON 32
eH1_3                -4.493248e-02 1 1  ON 33
eH1_4                 2.967642e-03 1 1  ON 34
eH1_5                 3.824064e-02 1 1  ON 35
eH1_6                 9.717160e-02 1 1  ON 36
eH1_7                 1.534134e-01 1 1  ON 37
eH1_8                 1.740301e-01 1 1  ON 38
eH1_9                 6.357529e-02 1 1  ON 39
eH2_0                -2.380549e-01 1 1  ON 40
eH2_1                -1.411875e-01 1 1  ON 41
eH2_2                -9.588658e-02 1 1  ON 42
eH2_3                -4.228615e-02 1 1  ON 43
eH2_4                 5.937620e-03 1 1  ON 44
eH2_5                 3.945406e-02 1 1  ON 45
eH2_6                 1.005673e-01 1 1  ON 46
eH2_7                 1.557014e-01 1 1  ON 47
eH2_8                 1.805247e-01 1 1  ON 48
eH2_9                 5.248525e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5768e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.8816
    reference variance = 0.30317
====================================================
  Execution time = 2.2432e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4215e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5372e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342054464151
                                         uncertainty =       0.006686663008

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342054464151
                                         uncertainty =       0.006686663008

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413610829
  error estimate for blocks of size 2^( 2) =       0.000426068166
  error estimate for blocks of size 2^( 3) =       0.000439285267
  error estimate for blocks of size 2^( 4) =       0.000452177370
  error estimate for blocks of size 2^( 5) =       0.000464097107
  error estimate for blocks of size 2^( 6) =       0.000473981404
  error estimate for blocks of size 2^( 7) =       0.000481164316

      target function =                  N/A
              le_mean =     -16.904731199492
             les_mean =     286.112084590988
             stat err =       0.000467855049
             autocorr =       1.279495730497
              std dev =       0.584934043282
             le_variance =       0.342147834990


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690473119949e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e-02, overlap shift 2.3842e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904731199492       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904731436929       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904731868818       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904733979365       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904731813118       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904731040722       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904735102431       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904741393770       residual = 6.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.904743795869       residual = 4.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.904745117952       residual = 5.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.904743596974       residual = 4.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.904742385762       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.904743332821       residual = 6.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.904744701517       residual = 2.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.904743846554       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.904743292442       residual = 9.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e-02 is 9.361918e-03

solving harmonic davidson linear method for identity shift 9.5367e-02, overlap shift 9.5367e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904731199492       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904731383542       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904731644958       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904732032827       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904732691731       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904731833303       residual = 3.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904733254580       residual = 3.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904734734227       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.904735411536       residual = 7.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.904735419194       residual = 3.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.904734831203       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.904734899018       residual = 4.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-02 is 2.394630e-03

solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904731199492       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904731296391       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904731383405       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904731068711       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904731680451       residual = 3.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904731728372       residual = 2.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904731727343       residual = 5.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904731903769       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.904732094779       residual = 5.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-01 is 5.907352e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.304384 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7983e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.091114e-01 1 1  ON 0
 uu_1                 1.427844e-01 1 1  ON 1
 uu_2                 4.101210e-02 1 1  ON 2
 uu_3                -2.145199e-02 1 1  ON 3
 uu_4                -6.662197e-02 1 1  ON 4
 uu_5                -1.012278e-01 1 1  ON 5
 uu_6                -1.275108e-01 1 1  ON 6
 uu_7                -1.410978e-01 1 1  ON 7
 uu_8                -1.332335e-01 1 1  ON 8
 uu_9                -1.044486e-01 1 1  ON 9
 ud_0                 4.445384e-01 1 1  ON 10
 ud_1                 1.801096e-01 1 1  ON 11
 ud_2                 6.323709e-02 1 1  ON 12
 ud_3                -6.361814e-03 1 1  ON 13
 ud_4                -6.415574e-02 1 1  ON 14
 ud_5                -1.067654e-01 1 1  ON 15
 ud_6                -1.341755e-01 1 1  ON 16
 ud_7                -1.512780e-01 1 1  ON 17
 ud_8                -1.523073e-01 1 1  ON 18
 ud_9                -1.430169e-01 1 1  ON 19
 eO_0                -7.584768e-01 1 1  ON 20
 eO_1                -4.407433e-01 1 1  ON 21
 eO_2                -2.225617e-02 1 1  ON 22
 eO_3                 2.977147e-01 1 1  ON 23
 eO_4                 5.252523e-01 1 1  ON 24
 eO_5                 4.864314e-01 1 1  ON 25
 eO_6                 2.594284e-01 1 1  ON 26
 eO_7                -4.115019e-02 1 1  ON 27
 eO_8                -2.202676e-01 1 1  ON 28
 eO_9                -8.484036e-02 1 1  ON 29
eH1_0                -2.405566e-01 1 1  ON 30
eH1_1                -1.435200e-01 1 1  ON 31
eH1_2                -9.894375e-02 1 1  ON 32
eH1_3                -4.571833e-02 1 1  ON 33
eH1_4                 2.757673e-03 1 1  ON 34
eH1_5                 3.832058e-02 1 1  ON 35
eH1_6                 9.731570e-02 1 1  ON 36
eH1_7                 1.535706e-01 1 1  ON 37
eH1_8                 1.755443e-01 1 1  ON 38
eH1_9                 6.545629e-02 1 1  ON 39
eH2_0                -2.390271e-01 1 1  ON 40
eH2_1                -1.414623e-01 1 1  ON 41
eH2_2                -9.632151e-02 1 1  ON 42
eH2_3                -4.260952e-02 1 1  ON 43
eH2_4                 5.757879e-03 1 1  ON 44
eH2_5                 3.951338e-02 1 1  ON 45
eH2_6                 9.932735e-02 1 1  ON 46
eH2_7                 1.551397e-01 1 1  ON 47
eH2_8                 1.816016e-01 1 1  ON 48
eH2_9                 5.487988e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.93
    reference variance = 0.176162
====================================================
  Execution time = 2.0089e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3945e-01
  Total weights = 2.0000e+06
  Execution time = 1.8674e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339174724316
                                         uncertainty =       0.003426423871

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339174724316
                                         uncertainty =       0.003426423871

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411832022
  error estimate for blocks of size 2^( 2) =       0.000424841229
  error estimate for blocks of size 2^( 3) =       0.000437938454
  error estimate for blocks of size 2^( 4) =       0.000450589438
  error estimate for blocks of size 2^( 5) =       0.000459629138
  error estimate for blocks of size 2^( 6) =       0.000468263731
  error estimate for blocks of size 2^( 7) =       0.000473125336

      target function =                  N/A
              le_mean =     -16.905460511352
             les_mean =     286.133806159406
             stat err =       0.000462901911
             autocorr =       1.263390839246
              std dev =       0.582418430466
             le_variance =       0.339211228146

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339725985921
                                         uncertainty =       0.003431183600

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339725985921
                                         uncertainty =       0.003431183600

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412166540
  error estimate for blocks of size 2^( 2) =       0.000425168645
  error estimate for blocks of size 2^( 3) =       0.000438240261
  error estimate for blocks of size 2^( 4) =       0.000450861621
  error estimate for blocks of size 2^( 5) =       0.000459874493
  error estimate for blocks of size 2^( 6) =       0.000468476553
  error estimate for blocks of size 2^( 7) =       0.000473317140

      target function =                  N/A
              le_mean =     -16.905462925494
             les_mean =     286.134439068344
             stat err =       0.000463132452
             autocorr =       1.262597607021
              std dev =       0.582891510461
             le_variance =       0.339762512968

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339663242284
                                         uncertainty =       0.003433547513

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339663242284
                                         uncertainty =       0.003433547513

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412128426
  error estimate for blocks of size 2^( 2) =       0.000425130527
  error estimate for blocks of size 2^( 3) =       0.000438203603
  error estimate for blocks of size 2^( 4) =       0.000450832559
  error estimate for blocks of size 2^( 5) =       0.000459853450
  error estimate for blocks of size 2^( 6) =       0.000468463710
  error estimate for blocks of size 2^( 7) =       0.000473316450

      target function =                  N/A
              le_mean =     -16.905463323538
             les_mean =     286.134389693179
             stat err =       0.000463116542
             autocorr =       1.262744386191
              std dev =       0.582837609927
             le_variance =       0.339699679546

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339237618809
                                         uncertainty =       0.003428040518

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339237618809
                                         uncertainty =       0.003428040518

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411870168
  error estimate for blocks of size 2^( 2) =       0.000424878600
  error estimate for blocks of size 2^( 3) =       0.000437971829
  error estimate for blocks of size 2^( 4) =       0.000450619918
  error estimate for blocks of size 2^( 5) =       0.000459657246
  error estimate for blocks of size 2^( 6) =       0.000468287866
  error estimate for blocks of size 2^( 7) =       0.000473149964

      target function =                  N/A
              le_mean =     -16.905460547117
             les_mean =     286.133870211238
             stat err =       0.000462928748
             autocorr =       1.263303297419
              std dev =       0.582472377659
             le_variance =       0.339274070735


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905460511352        initial
     2.3842e-02     2.3842e-01             9.3619e-03       -16.905462925494
     9.5367e-02     9.5367e-01             2.3946e-03       -16.905463323538  <--
     3.8147e-01     3.8147e+00             5.9074e-04       -16.905460547117

*****************************************************************************
Applying the update for shift_i =   9.5367e-02     and shift_s =   9.5367e-01
*****************************************************************************

  Execution time = 2.9505e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.091114e-01 1 1  ON 0
 uu_1                 1.427844e-01 1 1  ON 1
 uu_2                 4.101210e-02 1 1  ON 2
 uu_3                -2.145199e-02 1 1  ON 3
 uu_4                -6.662197e-02 1 1  ON 4
 uu_5                -1.012278e-01 1 1  ON 5
 uu_6                -1.275108e-01 1 1  ON 6
 uu_7                -1.410978e-01 1 1  ON 7
 uu_8                -1.332335e-01 1 1  ON 8
 uu_9                -1.044486e-01 1 1  ON 9
 ud_0                 4.445384e-01 1 1  ON 10
 ud_1                 1.801096e-01 1 1  ON 11
 ud_2                 6.323709e-02 1 1  ON 12
 ud_3                -6.361814e-03 1 1  ON 13
 ud_4                -6.415574e-02 1 1  ON 14
 ud_5                -1.067654e-01 1 1  ON 15
 ud_6                -1.341755e-01 1 1  ON 16
 ud_7                -1.512780e-01 1 1  ON 17
 ud_8                -1.523073e-01 1 1  ON 18
 ud_9                -1.430169e-01 1 1  ON 19
 eO_0                -7.584768e-01 1 1  ON 20
 eO_1                -4.407433e-01 1 1  ON 21
 eO_2                -2.225617e-02 1 1  ON 22
 eO_3                 2.977147e-01 1 1  ON 23
 eO_4                 5.252523e-01 1 1  ON 24
 eO_5                 4.864314e-01 1 1  ON 25
 eO_6                 2.594284e-01 1 1  ON 26
 eO_7                -4.115019e-02 1 1  ON 27
 eO_8                -2.202676e-01 1 1  ON 28
 eO_9                -8.484036e-02 1 1  ON 29
eH1_0                -2.405566e-01 1 1  ON 30
eH1_1                -1.435200e-01 1 1  ON 31
eH1_2                -9.894375e-02 1 1  ON 32
eH1_3                -4.571833e-02 1 1  ON 33
eH1_4                 2.757673e-03 1 1  ON 34
eH1_5                 3.832058e-02 1 1  ON 35
eH1_6                 9.731570e-02 1 1  ON 36
eH1_7                 1.535706e-01 1 1  ON 37
eH1_8                 1.755443e-01 1 1  ON 38
eH1_9                 6.545629e-02 1 1  ON 39
eH2_0                -2.390271e-01 1 1  ON 40
eH2_1                -1.414623e-01 1 1  ON 41
eH2_2                -9.632151e-02 1 1  ON 42
eH2_3                -4.260952e-02 1 1  ON 43
eH2_4                 5.757879e-03 1 1  ON 44
eH2_5                 3.951338e-02 1 1  ON 45
eH2_6                 9.932735e-02 1 1  ON 46
eH2_7                 1.551397e-01 1 1  ON 47
eH2_8                 1.816016e-01 1 1  ON 48
eH2_9                 5.487988e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7494e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.8887
    reference variance = 0.179529
====================================================
  Execution time = 2.2588e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4764e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5574e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347748968234
                                         uncertainty =       0.009032655153

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347748968234
                                         uncertainty =       0.009032655153

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416916636
  error estimate for blocks of size 2^( 2) =       0.000429566547
  error estimate for blocks of size 2^( 3) =       0.000442746592
  error estimate for blocks of size 2^( 4) =       0.000455095102
  error estimate for blocks of size 2^( 5) =       0.000465615923
  error estimate for blocks of size 2^( 6) =       0.000474379762
  error estimate for blocks of size 2^( 7) =       0.000480546920

      target function =                  N/A
              le_mean =     -16.905847797620
             les_mean =     286.155328545638
             stat err =       0.000468909427
             autocorr =       1.264967818995
              std dev =       0.589609161360
             le_variance =       0.347638963160


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690584779762e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e-02, overlap shift 2.3842e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905847797620       residual = 6.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905847462557       residual = 6.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905843553519       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905841976113       residual = 9.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905847908344       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905851568126       residual = 9.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905851091479       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905851821717       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905850541364       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905851116944       residual = 5.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905851604562       residual = 2.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905851672627       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905852860524       residual = 4.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905854004820       residual = 3.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.905854460912       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.905855034228       residual = 2.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.905854842408       residual = 6.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e-02 is 1.054318e-02

solving harmonic davidson linear method for identity shift 9.5367e-02, overlap shift 9.5367e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905847797620       residual = 6.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905847525657       residual = 6.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905844909877       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905843382820       residual = 7.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905846285958       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905848822022       residual = 4.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905847919907       residual = 3.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905848083925       residual = 2.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905847371600       residual = 6.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905847510018       residual = 4.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905847593586       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905847570815       residual = 4.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-02 is 2.621715e-03

solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905847797620       residual = 6.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905847642505       residual = 6.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905846601523       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905845630517       residual = 7.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905846122987       residual = 6.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905847162156       residual = 2.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905847120535       residual = 8.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905847154679       residual = 3.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905846924152       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905846960129       residual = 3.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-01 is 6.571011e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.310609 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8161e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.089390e-01 1 1  ON 0
 uu_1                 1.423904e-01 1 1  ON 1
 uu_2                 4.060918e-02 1 1  ON 2
 uu_3                -2.176775e-02 1 1  ON 3
 uu_4                -6.709613e-02 1 1  ON 4
 uu_5                -1.014811e-01 1 1  ON 5
 uu_6                -1.282964e-01 1 1  ON 6
 uu_7                -1.413254e-01 1 1  ON 7
 uu_8                -1.333875e-01 1 1  ON 8
 uu_9                -1.040254e-01 1 1  ON 9
 ud_0                 4.443306e-01 1 1  ON 10
 ud_1                 1.801945e-01 1 1  ON 11
 ud_2                 6.330449e-02 1 1  ON 12
 ud_3                -6.302935e-03 1 1  ON 13
 ud_4                -6.412379e-02 1 1  ON 14
 ud_5                -1.066011e-01 1 1  ON 15
 ud_6                -1.343320e-01 1 1  ON 16
 ud_7                -1.520654e-01 1 1  ON 17
 ud_8                -1.524988e-01 1 1  ON 18
 ud_9                -1.421937e-01 1 1  ON 19
 eO_0                -7.587574e-01 1 1  ON 20
 eO_1                -4.403820e-01 1 1  ON 21
 eO_2                -2.230916e-02 1 1  ON 22
 eO_3                 2.979783e-01 1 1  ON 23
 eO_4                 5.250078e-01 1 1  ON 24
 eO_5                 4.870711e-01 1 1  ON 25
 eO_6                 2.604091e-01 1 1  ON 26
 eO_7                -4.088801e-02 1 1  ON 27
 eO_8                -2.209439e-01 1 1  ON 28
 eO_9                -8.591345e-02 1 1  ON 29
eH1_0                -2.416454e-01 1 1  ON 30
eH1_1                -1.446134e-01 1 1  ON 31
eH1_2                -9.934432e-02 1 1  ON 32
eH1_3                -4.527449e-02 1 1  ON 33
eH1_4                 2.715943e-03 1 1  ON 34
eH1_5                 3.778264e-02 1 1  ON 35
eH1_6                 9.675200e-02 1 1  ON 36
eH1_7                 1.529519e-01 1 1  ON 37
eH1_8                 1.767601e-01 1 1  ON 38
eH1_9                 6.757638e-02 1 1  ON 39
eH2_0                -2.395732e-01 1 1  ON 40
eH2_1                -1.421307e-01 1 1  ON 41
eH2_2                -9.707712e-02 1 1  ON 42
eH2_3                -4.324388e-02 1 1  ON 43
eH2_4                 4.866031e-03 1 1  ON 44
eH2_5                 3.885191e-02 1 1  ON 45
eH2_6                 9.863667e-02 1 1  ON 46
eH2_7                 1.556360e-01 1 1  ON 47
eH2_8                 1.832183e-01 1 1  ON 48
eH2_9                 5.750159e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.8877
    reference variance = 0.214682
====================================================
  Execution time = 2.0113e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3919e-01
  Total weights = 2.0000e+06
  Execution time = 1.8640e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339361996947
                                         uncertainty =       0.004820909698

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339361996947
                                         uncertainty =       0.004820909698

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411935279
  error estimate for blocks of size 2^( 2) =       0.000424611898
  error estimate for blocks of size 2^( 3) =       0.000437842791
  error estimate for blocks of size 2^( 4) =       0.000450529988
  error estimate for blocks of size 2^( 5) =       0.000461329420
  error estimate for blocks of size 2^( 6) =       0.000471097416
  error estimate for blocks of size 2^( 7) =       0.000479127320

      target function =                  N/A
              le_mean =     -16.904861419796
             les_mean =     286.113720801554
             stat err =       0.000465521036
             autocorr =       1.277087476247
              std dev =       0.582564458878
             le_variance =       0.339381348748

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339257066869
                                         uncertainty =       0.004819525120

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339257066869
                                         uncertainty =       0.004819525120

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411871590
  error estimate for blocks of size 2^( 2) =       0.000424556168
  error estimate for blocks of size 2^( 3) =       0.000437783631
  error estimate for blocks of size 2^( 4) =       0.000450460447
  error estimate for blocks of size 2^( 5) =       0.000461234790
  error estimate for blocks of size 2^( 6) =       0.000471001629
  error estimate for blocks of size 2^( 7) =       0.000479061486

      target function =                  N/A
              le_mean =     -16.904858182228
             les_mean =     286.113506404431
             stat err =       0.000465439588
             autocorr =       1.277035491073
              std dev =       0.582474388126
             le_variance =       0.339276412823

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339003176151
                                         uncertainty =       0.004815936833

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339003176151
                                         uncertainty =       0.004815936833

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411717453
  error estimate for blocks of size 2^( 2) =       0.000424408964
  error estimate for blocks of size 2^( 3) =       0.000437642560
  error estimate for blocks of size 2^( 4) =       0.000450324365
  error estimate for blocks of size 2^( 5) =       0.000461103750
  error estimate for blocks of size 2^( 6) =       0.000470878928
  error estimate for blocks of size 2^( 7) =       0.000478958999

      target function =                  N/A
              le_mean =     -16.904859369460
             les_mean =     286.113292653721
             stat err =       0.000465316510
             autocorr =       1.277316052409
              std dev =       0.582256405740
             le_variance =       0.339022522025

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339252782201
                                         uncertainty =       0.004819420374

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339252782201
                                         uncertainty =       0.004819420374

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411868985
  error estimate for blocks of size 2^( 2) =       0.000424548626
  error estimate for blocks of size 2^( 3) =       0.000437779436
  error estimate for blocks of size 2^( 4) =       0.000450465287
  error estimate for blocks of size 2^( 5) =       0.000461260615
  error estimate for blocks of size 2^( 6) =       0.000471031620
  error estimate for blocks of size 2^( 7) =       0.000479076387

      target function =                  N/A
              le_mean =     -16.904859188826
             les_mean =     286.113536145861
             stat err =       0.000465458477
             autocorr =       1.277155297861
              std dev =       0.582470704380
             le_variance =       0.339272121461


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904861419796        initial  <--
     2.3842e-02     2.3842e-01             1.0543e-02       -16.904858182228
     9.5367e-02     9.5367e-01             2.6217e-03       -16.904859369460
     3.8147e-01     3.8147e+00             6.5710e-04       -16.904859188826

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5599
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.091114e-01 1 1  ON 0
 uu_1                 1.427844e-01 1 1  ON 1
 uu_2                 4.101210e-02 1 1  ON 2
 uu_3                -2.145199e-02 1 1  ON 3
 uu_4                -6.662197e-02 1 1  ON 4
 uu_5                -1.012278e-01 1 1  ON 5
 uu_6                -1.275108e-01 1 1  ON 6
 uu_7                -1.410978e-01 1 1  ON 7
 uu_8                -1.332335e-01 1 1  ON 8
 uu_9                -1.044486e-01 1 1  ON 9
 ud_0                 4.445384e-01 1 1  ON 10
 ud_1                 1.801096e-01 1 1  ON 11
 ud_2                 6.323709e-02 1 1  ON 12
 ud_3                -6.361814e-03 1 1  ON 13
 ud_4                -6.415574e-02 1 1  ON 14
 ud_5                -1.067654e-01 1 1  ON 15
 ud_6                -1.341755e-01 1 1  ON 16
 ud_7                -1.512780e-01 1 1  ON 17
 ud_8                -1.523073e-01 1 1  ON 18
 ud_9                -1.430169e-01 1 1  ON 19
 eO_0                -7.584768e-01 1 1  ON 20
 eO_1                -4.407433e-01 1 1  ON 21
 eO_2                -2.225617e-02 1 1  ON 22
 eO_3                 2.977147e-01 1 1  ON 23
 eO_4                 5.252523e-01 1 1  ON 24
 eO_5                 4.864314e-01 1 1  ON 25
 eO_6                 2.594284e-01 1 1  ON 26
 eO_7                -4.115019e-02 1 1  ON 27
 eO_8                -2.202676e-01 1 1  ON 28
 eO_9                -8.484036e-02 1 1  ON 29
eH1_0                -2.405566e-01 1 1  ON 30
eH1_1                -1.435200e-01 1 1  ON 31
eH1_2                -9.894375e-02 1 1  ON 32
eH1_3                -4.571833e-02 1 1  ON 33
eH1_4                 2.757673e-03 1 1  ON 34
eH1_5                 3.832058e-02 1 1  ON 35
eH1_6                 9.731570e-02 1 1  ON 36
eH1_7                 1.535706e-01 1 1  ON 37
eH1_8                 1.755443e-01 1 1  ON 38
eH1_9                 6.545629e-02 1 1  ON 39
eH2_0                -2.390271e-01 1 1  ON 40
eH2_1                -1.414623e-01 1 1  ON 41
eH2_2                -9.632151e-02 1 1  ON 42
eH2_3                -4.260952e-02 1 1  ON 43
eH2_4                 5.757879e-03 1 1  ON 44
eH2_5                 3.951338e-02 1 1  ON 45
eH2_6                 9.932735e-02 1 1  ON 46
eH2_7                 1.551397e-01 1 1  ON 47
eH2_8                 1.816016e-01 1 1  ON 48
eH2_9                 5.487988e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7726e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.9107
    reference variance = 0.219216
====================================================
  Execution time = 2.0518e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.3815e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5482e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338166245214
                                         uncertainty =       0.004267643736

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338166245214
                                         uncertainty =       0.004267643736

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411186150
  error estimate for blocks of size 2^( 2) =       0.000423878514
  error estimate for blocks of size 2^( 3) =       0.000437493952
  error estimate for blocks of size 2^( 4) =       0.000449795023
  error estimate for blocks of size 2^( 5) =       0.000461955643
  error estimate for blocks of size 2^( 6) =       0.000471159462
  error estimate for blocks of size 2^( 7) =       0.000477477660

      target function =                  N/A
              le_mean =     -16.904447154599
             les_mean =     286.098481533311
             stat err =       0.000465096947
             autocorr =       1.279410828293
              std dev =       0.581505029872
             le_variance =       0.338148099767


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690444715460e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e-01, overlap shift 2.3842e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904447154599       residual = 5.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904450122410       residual = 8.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904451516910       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904451068511       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904451498306       residual = 6.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904450604889       residual = 2.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904450968436       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904450946110       residual = 7.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.904450795874       residual = 3.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.904450883598       residual = 8.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e-01 is 8.740997e-04

solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904447154599       residual = 5.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904448284861       residual = 8.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904448840437       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904448731240       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904448804503       residual = 3.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904448564515       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904448762449       residual = 3.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904448732656       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.904448681453       residual = 1.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-01 is 2.385497e-04

solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904447154599       residual = 5.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904447479701       residual = 8.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904447643901       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904447620019       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904447633716       residual = 3.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904447575744       residual = 8.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904447637609       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904447624360       residual = 6.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+00 is 6.698100e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.313765 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6077e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.092300e-01 1 1  ON 0
 uu_1                 1.426835e-01 1 1  ON 1
 uu_2                 4.095533e-02 1 1  ON 2
 uu_3                -2.145333e-02 1 1  ON 3
 uu_4                -6.672941e-02 1 1  ON 4
 uu_5                -1.012353e-01 1 1  ON 5
 uu_6                -1.277494e-01 1 1  ON 6
 uu_7                -1.410231e-01 1 1  ON 7
 uu_8                -1.331243e-01 1 1  ON 8
 uu_9                -1.044291e-01 1 1  ON 9
 ud_0                 4.444305e-01 1 1  ON 10
 ud_1                 1.801091e-01 1 1  ON 11
 ud_2                 6.326319e-02 1 1  ON 12
 ud_3                -6.295383e-03 1 1  ON 13
 ud_4                -6.414636e-02 1 1  ON 14
 ud_5                -1.067335e-01 1 1  ON 15
 ud_6                -1.342619e-01 1 1  ON 16
 ud_7                -1.513639e-01 1 1  ON 17
 ud_8                -1.522620e-01 1 1  ON 18
 ud_9                -1.429256e-01 1 1  ON 19
 eO_0                -7.585135e-01 1 1  ON 20
 eO_1                -4.406031e-01 1 1  ON 21
 eO_2                -2.241557e-02 1 1  ON 22
 eO_3                 2.977259e-01 1 1  ON 23
 eO_4                 5.252420e-01 1 1  ON 24
 eO_5                 4.865351e-01 1 1  ON 25
 eO_6                 2.594877e-01 1 1  ON 26
 eO_7                -4.109705e-02 1 1  ON 27
 eO_8                -2.203227e-01 1 1  ON 28
 eO_9                -8.493190e-02 1 1  ON 29
eH1_0                -2.407905e-01 1 1  ON 30
eH1_1                -1.436536e-01 1 1  ON 31
eH1_2                -9.899840e-02 1 1  ON 32
eH1_3                -4.556431e-02 1 1  ON 33
eH1_4                 2.762449e-03 1 1  ON 34
eH1_5                 3.820414e-02 1 1  ON 35
eH1_6                 9.726368e-02 1 1  ON 36
eH1_7                 1.536138e-01 1 1  ON 37
eH1_8                 1.756685e-01 1 1  ON 38
eH1_9                 6.568036e-02 1 1  ON 39
eH2_0                -2.391265e-01 1 1  ON 40
eH2_1                -1.415552e-01 1 1  ON 41
eH2_2                -9.643793e-02 1 1  ON 42
eH2_3                -4.274656e-02 1 1  ON 43
eH2_4                 5.577075e-03 1 1  ON 44
eH2_5                 3.960553e-02 1 1  ON 45
eH2_6                 9.938953e-02 1 1  ON 46
eH2_7                 1.552577e-01 1 1  ON 47
eH2_8                 1.817038e-01 1 1  ON 48
eH2_9                 5.509925e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.962
    reference variance = 0.168189
====================================================
  Execution time = 2.0342e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.5919e-01
  Total weights = 2.0000e+06
  Execution time = 1.8618e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.359375810771
                                         uncertainty =       0.023296678703

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.359375810771
                                         uncertainty =       0.023296678703

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000423827631
  error estimate for blocks of size 2^( 2) =       0.000436461799
  error estimate for blocks of size 2^( 3) =       0.000449655342
  error estimate for blocks of size 2^( 4) =       0.000462066682
  error estimate for blocks of size 2^( 5) =       0.000472969593
  error estimate for blocks of size 2^( 6) =       0.000480269415
  error estimate for blocks of size 2^( 7) =       0.000484880097

      target function =                  N/A
              le_mean =     -16.904783658825
             les_mean =     286.130970094108
             stat err =       0.000475046447
             autocorr =       1.256300735167
              std dev =       0.599382784256
             le_variance =       0.359259722063

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.359256602740
                                         uncertainty =       0.023305836738

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.359256602740
                                         uncertainty =       0.023305836738

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000423757244
  error estimate for blocks of size 2^( 2) =       0.000436400306
  error estimate for blocks of size 2^( 3) =       0.000449602261
  error estimate for blocks of size 2^( 4) =       0.000462016919
  error estimate for blocks of size 2^( 5) =       0.000472916766
  error estimate for blocks of size 2^( 6) =       0.000480216066
  error estimate for blocks of size 2^( 7) =       0.000484831567

      target function =                  N/A
              le_mean =     -16.904786186065
             les_mean =     286.130936220689
             stat err =       0.000474995330
             autocorr =       1.256447677802
              std dev =       0.599283241609
             le_variance =       0.359140403674

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.359249253426
                                         uncertainty =       0.023301229376

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.359249253426
                                         uncertainty =       0.023301229376

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000423752907
  error estimate for blocks of size 2^( 2) =       0.000436395021
  error estimate for blocks of size 2^( 3) =       0.000449595405
  error estimate for blocks of size 2^( 4) =       0.000462009785
  error estimate for blocks of size 2^( 5) =       0.000472911328
  error estimate for blocks of size 2^( 6) =       0.000480212416
  error estimate for blocks of size 2^( 7) =       0.000484826959

      target function =                  N/A
              le_mean =     -16.904785452522
             les_mean =     286.130904069258
             stat err =       0.000474990122
             autocorr =       1.256445844368
              std dev =       0.599277108697
             le_variance =       0.359133053009

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.359352842912
                                         uncertainty =       0.023297046170

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.359352842912
                                         uncertainty =       0.023297046170

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000423814073
  error estimate for blocks of size 2^( 2) =       0.000436449502
  error estimate for blocks of size 2^( 3) =       0.000449644059
  error estimate for blocks of size 2^( 4) =       0.000462055844
  error estimate for blocks of size 2^( 5) =       0.000472958601
  error estimate for blocks of size 2^( 6) =       0.000480258758
  error estimate for blocks of size 2^( 7) =       0.000484869950

      target function =                  N/A
              le_mean =     -16.904783852046
             les_mean =     286.130953641146
             stat err =       0.000475035788
             autocorr =       1.256324742167
              std dev =       0.599363609489
             le_variance =       0.359236736380


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904783658825        initial
     2.3842e-01     2.3842e+00             8.7410e-04       -16.904786186065  <--
     9.5367e-01     9.5367e+00             2.3855e-04       -16.904785452522
     3.8147e+00     3.8147e+01             6.6981e-05       -16.904783852046

*****************************************************************************
Applying the update for shift_i =   2.3842e-01     and shift_s =   2.3842e+00
*****************************************************************************

  Execution time = 2.9775e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.093458e-01 1 1  ON 0
 uu_1                 1.425275e-01 1 1  ON 1
 uu_2                 4.086198e-02 1 1  ON 2
 uu_3                -2.150648e-02 1 1  ON 3
 uu_4                -6.690657e-02 1 1  ON 4
 uu_5                -1.013517e-01 1 1  ON 5
 uu_6                -1.282003e-01 1 1  ON 6
 uu_7                -1.409580e-01 1 1  ON 7
 uu_8                -1.328812e-01 1 1  ON 8
 uu_9                -1.043662e-01 1 1  ON 9
 ud_0                 4.443346e-01 1 1  ON 10
 ud_1                 1.801092e-01 1 1  ON 11
 ud_2                 6.330914e-02 1 1  ON 12
 ud_3                -6.202431e-03 1 1  ON 13
 ud_4                -6.409326e-02 1 1  ON 14
 ud_5                -1.067257e-01 1 1  ON 15
 ud_6                -1.344300e-01 1 1  ON 16
 ud_7                -1.516376e-01 1 1  ON 17
 ud_8                -1.522102e-01 1 1  ON 18
 ud_9                -1.426749e-01 1 1  ON 19
 eO_0                -7.585387e-01 1 1  ON 20
 eO_1                -4.404612e-01 1 1  ON 21
 eO_2                -2.263701e-02 1 1  ON 22
 eO_3                 2.977133e-01 1 1  ON 23
 eO_4                 5.252468e-01 1 1  ON 24
 eO_5                 4.868299e-01 1 1  ON 25
 eO_6                 2.596522e-01 1 1  ON 26
 eO_7                -4.097087e-02 1 1  ON 27
 eO_8                -2.204892e-01 1 1  ON 28
 eO_9                -8.519663e-02 1 1  ON 29
eH1_0                -2.413619e-01 1 1  ON 30
eH1_1                -1.439080e-01 1 1  ON 31
eH1_2                -9.912829e-02 1 1  ON 32
eH1_3                -4.536767e-02 1 1  ON 33
eH1_4                 2.806273e-03 1 1  ON 34
eH1_5                 3.790134e-02 1 1  ON 35
eH1_6                 9.707920e-02 1 1  ON 36
eH1_7                 1.537023e-01 1 1  ON 37
eH1_8                 1.760137e-01 1 1  ON 38
eH1_9                 6.633039e-02 1 1  ON 39
eH2_0                -2.394399e-01 1 1  ON 40
eH2_1                -1.418918e-01 1 1  ON 41
eH2_2                -9.678035e-02 1 1  ON 42
eH2_3                -4.309515e-02 1 1  ON 43
eH2_4                 5.128200e-03 1 1  ON 44
eH2_5                 3.978368e-02 1 1  ON 45
eH2_6                 9.959831e-02 1 1  ON 46
eH2_7                 1.556234e-01 1 1  ON 47
eH2_8                 1.820070e-01 1 1  ON 48
eH2_9                 5.573752e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5858e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.8649
    reference variance = 0.263837
====================================================
  Execution time = 2.0175e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3903e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5915e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339121015747
                                         uncertainty =       0.003753482007

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339121015747
                                         uncertainty =       0.003753482007

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411721757
  error estimate for blocks of size 2^( 2) =       0.000424491603
  error estimate for blocks of size 2^( 3) =       0.000437962516
  error estimate for blocks of size 2^( 4) =       0.000449670203
  error estimate for blocks of size 2^( 5) =       0.000461856299
  error estimate for blocks of size 2^( 6) =       0.000468863714
  error estimate for blocks of size 2^( 7) =       0.000472413805

      target function =                  N/A
              le_mean =     -16.905487710618
             les_mean =     286.134544174108
             stat err =       0.000463201005
             autocorr =       1.265701667490
              std dev =       0.582262492142
             le_variance =       0.339029609756


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690548771062e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-02, overlap shift 5.9605e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905487710618       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905490395396       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905491875527       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905495857500       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905493790296       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905495659516       residual = 6.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905493094422       residual = 3.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905492537721       residual = 3.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905493415244       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905494603533       residual = 7.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905494941632       residual = 8.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905494929598       residual = 2.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905495054061       residual = 1.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905495435620       residual = 2.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e-02 is 3.533346e-03

solving harmonic davidson linear method for identity shift 2.3842e-01, overlap shift 2.3842e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905487710618       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905489253024       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905490216071       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905492548555       residual = 9.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905491956687       residual = 3.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905491304692       residual = 2.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905491304207       residual = 9.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905490684485       residual = 4.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905490972302       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905491173972       residual = 6.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e-01 is 8.785106e-04

solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905487710618       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905488281457       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905488698019       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905489660054       residual = 6.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905489641371       residual = 2.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905489220725       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905489277894       residual = 2.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905489158728       residual = 6.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-01 is 2.193201e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.318087 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5779e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.093054e-01 1 1  ON 0
 uu_1                 1.426624e-01 1 1  ON 1
 uu_2                 4.091651e-02 1 1  ON 2
 uu_3                -2.146277e-02 1 1  ON 3
 uu_4                -6.692452e-02 1 1  ON 4
 uu_5                -1.013029e-01 1 1  ON 5
 uu_6                -1.280117e-01 1 1  ON 6
 uu_7                -1.413562e-01 1 1  ON 7
 uu_8                -1.330296e-01 1 1  ON 8
 uu_9                -1.047279e-01 1 1  ON 9
 ud_0                 4.443676e-01 1 1  ON 10
 ud_1                 1.803871e-01 1 1  ON 11
 ud_2                 6.341807e-02 1 1  ON 12
 ud_3                -5.992273e-03 1 1  ON 13
 ud_4                -6.401898e-02 1 1  ON 14
 ud_5                -1.065937e-01 1 1  ON 15
 ud_6                -1.342772e-01 1 1  ON 16
 ud_7                -1.515759e-01 1 1  ON 17
 ud_8                -1.520823e-01 1 1  ON 18
 ud_9                -1.430677e-01 1 1  ON 19
 eO_0                -7.585887e-01 1 1  ON 20
 eO_1                -4.404308e-01 1 1  ON 21
 eO_2                -2.245029e-02 1 1  ON 22
 eO_3                 2.978356e-01 1 1  ON 23
 eO_4                 5.249840e-01 1 1  ON 24
 eO_5                 4.874707e-01 1 1  ON 25
 eO_6                 2.599501e-01 1 1  ON 26
 eO_7                -4.088566e-02 1 1  ON 27
 eO_8                -2.207894e-01 1 1  ON 28
 eO_9                -8.583576e-02 1 1  ON 29
eH1_0                -2.416156e-01 1 1  ON 30
eH1_1                -1.441533e-01 1 1  ON 31
eH1_2                -9.940444e-02 1 1  ON 32
eH1_3                -4.550399e-02 1 1  ON 33
eH1_4                 2.691578e-03 1 1  ON 34
eH1_5                 3.748286e-02 1 1  ON 35
eH1_6                 9.716712e-02 1 1  ON 36
eH1_7                 1.539397e-01 1 1  ON 37
eH1_8                 1.765570e-01 1 1  ON 38
eH1_9                 6.696884e-02 1 1  ON 39
eH2_0                -2.397248e-01 1 1  ON 40
eH2_1                -1.421311e-01 1 1  ON 41
eH2_2                -9.680798e-02 1 1  ON 42
eH2_3                -4.328907e-02 1 1  ON 43
eH2_4                 5.066679e-03 1 1  ON 44
eH2_5                 4.023146e-02 1 1  ON 45
eH2_6                 9.901025e-02 1 1  ON 46
eH2_7                 1.551304e-01 1 1  ON 47
eH2_8                 1.824428e-01 1 1  ON 48
eH2_9                 5.661603e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.8085
    reference variance = 0.249571
====================================================
  Execution time = 2.0007e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4022e-01
  Total weights = 2.0000e+06
  Execution time = 1.8698e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340236017910
                                         uncertainty =       0.005827914473

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340236017910
                                         uncertainty =       0.005827914473

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412532381
  error estimate for blocks of size 2^( 2) =       0.000425291375
  error estimate for blocks of size 2^( 3) =       0.000438198059
  error estimate for blocks of size 2^( 4) =       0.000449658679
  error estimate for blocks of size 2^( 5) =       0.000460719439
  error estimate for blocks of size 2^( 6) =       0.000469396237
  error estimate for blocks of size 2^( 7) =       0.000471900205

      target function =                  N/A
              le_mean =     -16.905611226459
             les_mean =     286.140056699908
             stat err =       0.000462918640
             autocorr =       1.259195757298
              std dev =       0.583408887426
             le_variance =       0.340365929927

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340065303047
                                         uncertainty =       0.005824076424

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340065303047
                                         uncertainty =       0.005824076424

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412428866
  error estimate for blocks of size 2^( 2) =       0.000425184025
  error estimate for blocks of size 2^( 3) =       0.000438085544
  error estimate for blocks of size 2^( 4) =       0.000449541225
  error estimate for blocks of size 2^( 5) =       0.000460595120
  error estimate for blocks of size 2^( 6) =       0.000469279790
  error estimate for blocks of size 2^( 7) =       0.000471792647

      target function =                  N/A
              le_mean =     -16.905610420691
             les_mean =     286.139858665561
             stat err =       0.000462802196
             autocorr =       1.259194194397
              std dev =       0.583262496195
             le_variance =       0.340195139468

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339952993350
                                         uncertainty =       0.005822424990

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339952993350
                                         uncertainty =       0.005822424990

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412360826
  error estimate for blocks of size 2^( 2) =       0.000425120094
  error estimate for blocks of size 2^( 3) =       0.000438027058
  error estimate for blocks of size 2^( 4) =       0.000449488453
  error estimate for blocks of size 2^( 5) =       0.000460545171
  error estimate for blocks of size 2^( 6) =       0.000469233531
  error estimate for blocks of size 2^( 7) =       0.000471747402

      target function =                  N/A
              le_mean =     -16.905609521691
             les_mean =     286.139716032274
             stat err =       0.000462753639
             autocorr =       1.259345467041
              std dev =       0.583166273394
             le_variance =       0.340082902425

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340154080936
                                         uncertainty =       0.005826274567

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340154080936
                                         uncertainty =       0.005826274567

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412482723
  error estimate for blocks of size 2^( 2) =       0.000425242534
  error estimate for blocks of size 2^( 3) =       0.000438150110
  error estimate for blocks of size 2^( 4) =       0.000449611647
  error estimate for blocks of size 2^( 5) =       0.000460671989
  error estimate for blocks of size 2^( 6) =       0.000469351246
  error estimate for blocks of size 2^( 7) =       0.000471857512

      target function =                  N/A
              le_mean =     -16.905610773012
             les_mean =     286.139959431983
             stat err =       0.000462873099
             autocorr =       1.259251151475
              std dev =       0.583338661108
             le_variance =       0.340283993543


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905611226459        initial  <--
     5.9605e-02     5.9605e-01             3.5333e-03       -16.905610420691
     2.3842e-01     2.3842e+00             8.7851e-04       -16.905609521691
     9.5367e-01     9.5367e+00             2.1932e-04       -16.905610773012

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5174
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.093458e-01 1 1  ON 0
 uu_1                 1.425275e-01 1 1  ON 1
 uu_2                 4.086198e-02 1 1  ON 2
 uu_3                -2.150648e-02 1 1  ON 3
 uu_4                -6.690657e-02 1 1  ON 4
 uu_5                -1.013517e-01 1 1  ON 5
 uu_6                -1.282003e-01 1 1  ON 6
 uu_7                -1.409580e-01 1 1  ON 7
 uu_8                -1.328812e-01 1 1  ON 8
 uu_9                -1.043662e-01 1 1  ON 9
 ud_0                 4.443346e-01 1 1  ON 10
 ud_1                 1.801092e-01 1 1  ON 11
 ud_2                 6.330914e-02 1 1  ON 12
 ud_3                -6.202431e-03 1 1  ON 13
 ud_4                -6.409326e-02 1 1  ON 14
 ud_5                -1.067257e-01 1 1  ON 15
 ud_6                -1.344300e-01 1 1  ON 16
 ud_7                -1.516376e-01 1 1  ON 17
 ud_8                -1.522102e-01 1 1  ON 18
 ud_9                -1.426749e-01 1 1  ON 19
 eO_0                -7.585387e-01 1 1  ON 20
 eO_1                -4.404612e-01 1 1  ON 21
 eO_2                -2.263701e-02 1 1  ON 22
 eO_3                 2.977133e-01 1 1  ON 23
 eO_4                 5.252468e-01 1 1  ON 24
 eO_5                 4.868299e-01 1 1  ON 25
 eO_6                 2.596522e-01 1 1  ON 26
 eO_7                -4.097087e-02 1 1  ON 27
 eO_8                -2.204892e-01 1 1  ON 28
 eO_9                -8.519663e-02 1 1  ON 29
eH1_0                -2.413619e-01 1 1  ON 30
eH1_1                -1.439080e-01 1 1  ON 31
eH1_2                -9.912829e-02 1 1  ON 32
eH1_3                -4.536767e-02 1 1  ON 33
eH1_4                 2.806273e-03 1 1  ON 34
eH1_5                 3.790134e-02 1 1  ON 35
eH1_6                 9.707920e-02 1 1  ON 36
eH1_7                 1.537023e-01 1 1  ON 37
eH1_8                 1.760137e-01 1 1  ON 38
eH1_9                 6.633039e-02 1 1  ON 39
eH2_0                -2.394399e-01 1 1  ON 40
eH2_1                -1.418918e-01 1 1  ON 41
eH2_2                -9.678035e-02 1 1  ON 42
eH2_3                -4.309515e-02 1 1  ON 43
eH2_4                 5.128200e-03 1 1  ON 44
eH2_5                 3.978368e-02 1 1  ON 45
eH2_6                 9.959831e-02 1 1  ON 46
eH2_7                 1.556234e-01 1 1  ON 47
eH2_8                 1.820070e-01 1 1  ON 48
eH2_9                 5.573752e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5301e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.9241
    reference variance = 0.259847
====================================================
  Execution time = 2.0503e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4409e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6085e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344145567908
                                         uncertainty =       0.007126075550

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344145567908
                                         uncertainty =       0.007126075550

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414783302
  error estimate for blocks of size 2^( 2) =       0.000427249767
  error estimate for blocks of size 2^( 3) =       0.000439697966
  error estimate for blocks of size 2^( 4) =       0.000452037320
  error estimate for blocks of size 2^( 5) =       0.000462375612
  error estimate for blocks of size 2^( 6) =       0.000469586932
  error estimate for blocks of size 2^( 7) =       0.000477575460

      target function =                  N/A
              le_mean =     -16.905401227275
             les_mean =     286.136680858523
             stat err =       0.000465393831
             autocorr =       1.258921687213
              std dev =       0.586592171300
             le_variance =       0.344090375431


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690540122727e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-01, overlap shift 5.9605e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905401227275       residual = 3.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905401991550       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905402551596       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905403222082       residual = 5.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905403867068       residual = 3.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905403928925       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905403720405       residual = 3.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905403747376       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905403750502       residual = 3.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e-01 is 3.575822e-04

solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905401227275       residual = 3.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905401455402       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905401665805       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905401835109       residual = 3.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905401989351       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905401967695       residual = 4.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905401947935       residual = 1.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905401973201       residual = 4.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+00 is 1.065171e-04

solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905401227275       residual = 3.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905401287213       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905401347171       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905401389409       residual = 3.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905401422686       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905401412504       residual = 1.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905401421902       residual = 5.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+00 is 2.837777e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.320870 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6123e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.093291e-01 1 1  ON 0
 uu_1                 1.425229e-01 1 1  ON 1
 uu_2                 4.089347e-02 1 1  ON 2
 uu_3                -2.152666e-02 1 1  ON 3
 uu_4                -6.690400e-02 1 1  ON 4
 uu_5                -1.013448e-01 1 1  ON 5
 uu_6                -1.282272e-01 1 1  ON 6
 uu_7                -1.410043e-01 1 1  ON 7
 uu_8                -1.328827e-01 1 1  ON 8
 uu_9                -1.043674e-01 1 1  ON 9
 ud_0                 4.443411e-01 1 1  ON 10
 ud_1                 1.801089e-01 1 1  ON 11
 ud_2                 6.330043e-02 1 1  ON 12
 ud_3                -6.183882e-03 1 1  ON 13
 ud_4                -6.408529e-02 1 1  ON 14
 ud_5                -1.067251e-01 1 1  ON 15
 ud_6                -1.344241e-01 1 1  ON 16
 ud_7                -1.516455e-01 1 1  ON 17
 ud_8                -1.522015e-01 1 1  ON 18
 ud_9                -1.426681e-01 1 1  ON 19
 eO_0                -7.585269e-01 1 1  ON 20
 eO_1                -4.404680e-01 1 1  ON 21
 eO_2                -2.267695e-02 1 1  ON 22
 eO_3                 2.977071e-01 1 1  ON 23
 eO_4                 5.252789e-01 1 1  ON 24
 eO_5                 4.869125e-01 1 1  ON 25
 eO_6                 2.596721e-01 1 1  ON 26
 eO_7                -4.096378e-02 1 1  ON 27
 eO_8                -2.205231e-01 1 1  ON 28
 eO_9                -8.525080e-02 1 1  ON 29
eH1_0                -2.413633e-01 1 1  ON 30
eH1_1                -1.439505e-01 1 1  ON 31
eH1_2                -9.913720e-02 1 1  ON 32
eH1_3                -4.538368e-02 1 1  ON 33
eH1_4                 2.804266e-03 1 1  ON 34
eH1_5                 3.785504e-02 1 1  ON 35
eH1_6                 9.706123e-02 1 1  ON 36
eH1_7                 1.537273e-01 1 1  ON 37
eH1_8                 1.760637e-01 1 1  ON 38
eH1_9                 6.638999e-02 1 1  ON 39
eH2_0                -2.394151e-01 1 1  ON 40
eH2_1                -1.418888e-01 1 1  ON 41
eH2_2                -9.688687e-02 1 1  ON 42
eH2_3                -4.312710e-02 1 1  ON 43
eH2_4                 5.122121e-03 1 1  ON 44
eH2_5                 3.976284e-02 1 1  ON 45
eH2_6                 9.957580e-02 1 1  ON 46
eH2_7                 1.556234e-01 1 1  ON 47
eH2_8                 1.820628e-01 1 1  ON 48
eH2_9                 5.582654e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.9686
    reference variance = 0.413613
====================================================
  Execution time = 2.0278e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3173e-01
  Total weights = 2.0000e+06
  Execution time = 1.8699e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331432190304
                                         uncertainty =       0.002612963208

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331432190304
                                         uncertainty =       0.002612963208

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407256280
  error estimate for blocks of size 2^( 2) =       0.000420127129
  error estimate for blocks of size 2^( 3) =       0.000433393815
  error estimate for blocks of size 2^( 4) =       0.000446057090
  error estimate for blocks of size 2^( 5) =       0.000456645870
  error estimate for blocks of size 2^( 6) =       0.000465688591
  error estimate for blocks of size 2^( 7) =       0.000471810105

      target function =                  N/A
              le_mean =     -16.905247332380
             les_mean =     286.119102558669
             stat err =       0.000460050414
             autocorr =       1.276072269881
              std dev =       0.575947354884
             le_variance =       0.331715355598

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331458733297
                                         uncertainty =       0.002612971171

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331458733297
                                         uncertainty =       0.002612971171

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407272676
  error estimate for blocks of size 2^( 2) =       0.000420142102
  error estimate for blocks of size 2^( 3) =       0.000433406587
  error estimate for blocks of size 2^( 4) =       0.000446066036
  error estimate for blocks of size 2^( 5) =       0.000456651271
  error estimate for blocks of size 2^( 6) =       0.000465692538
  error estimate for blocks of size 2^( 7) =       0.000471814833

      target function =                  N/A
              le_mean =     -16.905246135387
             les_mean =     286.119088796652
             stat err =       0.000460056169
             autocorr =       1.276001458165
              std dev =       0.575970541355
             le_variance =       0.331742064509

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331453495622
                                         uncertainty =       0.002613013251

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331453495622
                                         uncertainty =       0.002613013251

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407269428
  error estimate for blocks of size 2^( 2) =       0.000420139077
  error estimate for blocks of size 2^( 3) =       0.000433404184
  error estimate for blocks of size 2^( 4) =       0.000446064898
  error estimate for blocks of size 2^( 5) =       0.000456651555
  error estimate for blocks of size 2^( 6) =       0.000465693497
  error estimate for blocks of size 2^( 7) =       0.000471815781

      target function =                  N/A
              le_mean =     -16.905246427103
             les_mean =     286.119093369913
             stat err =       0.000460056433
             autocorr =       1.276023264959
              std dev =       0.575965949265
             le_variance =       0.331736774713

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331435220653
                                         uncertainty =       0.002612970766

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331435220653
                                         uncertainty =       0.002612970766

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407258151
  error estimate for blocks of size 2^( 2) =       0.000420128817
  error estimate for blocks of size 2^( 3) =       0.000433395278
  error estimate for blocks of size 2^( 4) =       0.000446058194
  error estimate for blocks of size 2^( 5) =       0.000456646691
  error estimate for blocks of size 2^( 6) =       0.000465689315
  error estimate for blocks of size 2^( 7) =       0.000471810942

      target function =                  N/A
              le_mean =     -16.905247193441
             les_mean =     286.119100908192
             stat err =       0.000460051286
             autocorr =       1.276065383487
              std dev =       0.575950000171
             le_variance =       0.331718402697


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905247332380        initial  <--
     5.9605e-01     5.9605e+00             3.5758e-04       -16.905246135387
     2.3842e+00     2.3842e+01             1.0652e-04       -16.905246427103
     9.5367e+00     9.5367e+01             2.8378e-05       -16.905247193441

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7420
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.093458e-01 1 1  ON 0
 uu_1                 1.425275e-01 1 1  ON 1
 uu_2                 4.086198e-02 1 1  ON 2
 uu_3                -2.150648e-02 1 1  ON 3
 uu_4                -6.690657e-02 1 1  ON 4
 uu_5                -1.013517e-01 1 1  ON 5
 uu_6                -1.282003e-01 1 1  ON 6
 uu_7                -1.409580e-01 1 1  ON 7
 uu_8                -1.328812e-01 1 1  ON 8
 uu_9                -1.043662e-01 1 1  ON 9
 ud_0                 4.443346e-01 1 1  ON 10
 ud_1                 1.801092e-01 1 1  ON 11
 ud_2                 6.330914e-02 1 1  ON 12
 ud_3                -6.202431e-03 1 1  ON 13
 ud_4                -6.409326e-02 1 1  ON 14
 ud_5                -1.067257e-01 1 1  ON 15
 ud_6                -1.344300e-01 1 1  ON 16
 ud_7                -1.516376e-01 1 1  ON 17
 ud_8                -1.522102e-01 1 1  ON 18
 ud_9                -1.426749e-01 1 1  ON 19
 eO_0                -7.585387e-01 1 1  ON 20
 eO_1                -4.404612e-01 1 1  ON 21
 eO_2                -2.263701e-02 1 1  ON 22
 eO_3                 2.977133e-01 1 1  ON 23
 eO_4                 5.252468e-01 1 1  ON 24
 eO_5                 4.868299e-01 1 1  ON 25
 eO_6                 2.596522e-01 1 1  ON 26
 eO_7                -4.097087e-02 1 1  ON 27
 eO_8                -2.204892e-01 1 1  ON 28
 eO_9                -8.519663e-02 1 1  ON 29
eH1_0                -2.413619e-01 1 1  ON 30
eH1_1                -1.439080e-01 1 1  ON 31
eH1_2                -9.912829e-02 1 1  ON 32
eH1_3                -4.536767e-02 1 1  ON 33
eH1_4                 2.806273e-03 1 1  ON 34
eH1_5                 3.790134e-02 1 1  ON 35
eH1_6                 9.707920e-02 1 1  ON 36
eH1_7                 1.537023e-01 1 1  ON 37
eH1_8                 1.760137e-01 1 1  ON 38
eH1_9                 6.633039e-02 1 1  ON 39
eH2_0                -2.394399e-01 1 1  ON 40
eH2_1                -1.418918e-01 1 1  ON 41
eH2_2                -9.678035e-02 1 1  ON 42
eH2_3                -4.309515e-02 1 1  ON 43
eH2_4                 5.128200e-03 1 1  ON 44
eH2_5                 3.978368e-02 1 1  ON 45
eH2_6                 9.959831e-02 1 1  ON 46
eH2_7                 1.556234e-01 1 1  ON 47
eH2_8                 1.820070e-01 1 1  ON 48
eH2_9                 5.573752e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5870e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.9775
    reference variance = 0.455878
====================================================
  Execution time = 2.0407e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4173e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5004e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341827433290
                                         uncertainty =       0.005515413228

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341827433290
                                         uncertainty =       0.005515413228

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413359752
  error estimate for blocks of size 2^( 2) =       0.000425637397
  error estimate for blocks of size 2^( 3) =       0.000438256763
  error estimate for blocks of size 2^( 4) =       0.000450465797
  error estimate for blocks of size 2^( 5) =       0.000460023961
  error estimate for blocks of size 2^( 6) =       0.000468444597
  error estimate for blocks of size 2^( 7) =       0.000474201484

      target function =                  N/A
              le_mean =     -16.906620903256
             les_mean =     286.175562764805
             stat err =       0.000463283960
             autocorr =       1.256140307243
              std dev =       0.584578967515
             le_variance =       0.341732569261


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690662090326e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906620903256       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906621014209       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906620996523       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906621103413       residual = 3.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906621179175       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906621223316       residual = 4.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906621222394       residual = 9.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+00 is 2.956877e-05

solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906620903256       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906620931573       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906620927203       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906620954331       residual = 3.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906620974504       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906620984318       residual = 3.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906620985308       residual = 8.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+01 is 7.430903e-06

solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906620903256       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906620910372       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906620909285       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906620916090       residual = 3.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906620921188       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906620923408       residual = 5.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906620923915       residual = 7.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+01 is 1.861371e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.323200 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5918e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.093497e-01 1 1  ON 0
 uu_1                 1.425242e-01 1 1  ON 1
 uu_2                 4.086405e-02 1 1  ON 2
 uu_3                -2.150580e-02 1 1  ON 3
 uu_4                -6.690557e-02 1 1  ON 4
 uu_5                -1.013489e-01 1 1  ON 5
 uu_6                -1.282066e-01 1 1  ON 6
 uu_7                -1.409600e-01 1 1  ON 7
 uu_8                -1.328857e-01 1 1  ON 8
 uu_9                -1.043682e-01 1 1  ON 9
 ud_0                 4.443379e-01 1 1  ON 10
 ud_1                 1.801101e-01 1 1  ON 11
 ud_2                 6.331329e-02 1 1  ON 12
 ud_3                -6.198951e-03 1 1  ON 13
 ud_4                -6.409463e-02 1 1  ON 14
 ud_5                -1.067250e-01 1 1  ON 15
 ud_6                -1.344297e-01 1 1  ON 16
 ud_7                -1.516364e-01 1 1  ON 17
 ud_8                -1.522173e-01 1 1  ON 18
 ud_9                -1.426786e-01 1 1  ON 19
 eO_0                -7.585349e-01 1 1  ON 20
 eO_1                -4.404645e-01 1 1  ON 21
 eO_2                -2.263491e-02 1 1  ON 22
 eO_3                 2.977134e-01 1 1  ON 23
 eO_4                 5.252454e-01 1 1  ON 24
 eO_5                 4.868374e-01 1 1  ON 25
 eO_6                 2.596543e-01 1 1  ON 26
 eO_7                -4.097009e-02 1 1  ON 27
 eO_8                -2.204951e-01 1 1  ON 28
 eO_9                -8.520167e-02 1 1  ON 29
eH1_0                -2.413608e-01 1 1  ON 30
eH1_1                -1.439068e-01 1 1  ON 31
eH1_2                -9.912865e-02 1 1  ON 32
eH1_3                -4.536699e-02 1 1  ON 33
eH1_4                 2.804487e-03 1 1  ON 34
eH1_5                 3.789775e-02 1 1  ON 35
eH1_6                 9.707445e-02 1 1  ON 36
eH1_7                 1.536981e-01 1 1  ON 37
eH1_8                 1.760171e-01 1 1  ON 38
eH1_9                 6.633779e-02 1 1  ON 39
eH2_0                -2.394438e-01 1 1  ON 40
eH2_1                -1.418908e-01 1 1  ON 41
eH2_2                -9.678286e-02 1 1  ON 42
eH2_3                -4.309928e-02 1 1  ON 43
eH2_4                 5.129481e-03 1 1  ON 44
eH2_5                 3.977927e-02 1 1  ON 45
eH2_6                 9.959641e-02 1 1  ON 46
eH2_7                 1.556256e-01 1 1  ON 47
eH2_8                 1.820121e-01 1 1  ON 48
eH2_9                 5.574402e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.8616
    reference variance = 0.246798
====================================================
  Execution time = 2.1954e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3785e-01
  Total weights = 2.0000e+06
  Execution time = 1.8670e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337883736812
                                         uncertainty =       0.005079391086

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337883736812
                                         uncertainty =       0.005079391086

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411002618
  error estimate for blocks of size 2^( 2) =       0.000423626430
  error estimate for blocks of size 2^( 3) =       0.000436510637
  error estimate for blocks of size 2^( 4) =       0.000447980956
  error estimate for blocks of size 2^( 5) =       0.000457699259
  error estimate for blocks of size 2^( 6) =       0.000465646804
  error estimate for blocks of size 2^( 7) =       0.000472362369

      target function =                  N/A
              le_mean =     -16.905897394296
             les_mean =     286.147212841780
             stat err =       0.000460922347
             autocorr =       1.257668988422
              std dev =       0.581245476736
             le_variance =       0.337846304227

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337882119678
                                         uncertainty =       0.005079514751

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337882119678
                                         uncertainty =       0.005079514751

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411001631
  error estimate for blocks of size 2^( 2) =       0.000423625665
  error estimate for blocks of size 2^( 3) =       0.000436509917
  error estimate for blocks of size 2^( 4) =       0.000447980130
  error estimate for blocks of size 2^( 5) =       0.000457698730
  error estimate for blocks of size 2^( 6) =       0.000465646976
  error estimate for blocks of size 2^( 7) =       0.000472363386

      target function =                  N/A
              le_mean =     -16.905897327797
             les_mean =     286.147208970036
             stat err =       0.000460922305
             autocorr =       1.257674803935
              std dev =       0.581244080365
             le_variance =       0.337844680959

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337883079923
                                         uncertainty =       0.005079454668

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337883079923
                                         uncertainty =       0.005079454668

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411002217
  error estimate for blocks of size 2^( 2) =       0.000423626139
  error estimate for blocks of size 2^( 3) =       0.000436510369
  error estimate for blocks of size 2^( 4) =       0.000447980633
  error estimate for blocks of size 2^( 5) =       0.000457699083
  error estimate for blocks of size 2^( 6) =       0.000465646977
  error estimate for blocks of size 2^( 7) =       0.000472362978

      target function =                  N/A
              le_mean =     -16.905897358986
             les_mean =     286.147210987697
             stat err =       0.000460922418
             autocorr =       1.257671833283
              std dev =       0.581244908841
             le_variance =       0.337845644054

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337883651466
                                         uncertainty =       0.005079399458

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337883651466
                                         uncertainty =       0.005079399458

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411002566
  error estimate for blocks of size 2^( 2) =       0.000423626392
  error estimate for blocks of size 2^( 3) =       0.000436510601
  error estimate for blocks of size 2^( 4) =       0.000447980914
  error estimate for blocks of size 2^( 5) =       0.000457699235
  error estimate for blocks of size 2^( 6) =       0.000465646825
  error estimate for blocks of size 2^( 7) =       0.000472362445

      target function =                  N/A
              le_mean =     -16.905897389787
             les_mean =     286.147212603559
             stat err =       0.000460922355
             autocorr =       1.257669351199
              std dev =       0.581245402967
             le_variance =       0.337846218470


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905897394296        initial  <--
     5.9605e+00     5.9605e+01             2.9569e-05       -16.905897327797
     2.3842e+01     2.3842e+02             7.4309e-06       -16.905897358986
     9.5367e+01     9.5367e+02             1.8614e-06       -16.905897389787

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.3943
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.093458e-01 1 1  ON 0
 uu_1                 1.425275e-01 1 1  ON 1
 uu_2                 4.086198e-02 1 1  ON 2
 uu_3                -2.150648e-02 1 1  ON 3
 uu_4                -6.690657e-02 1 1  ON 4
 uu_5                -1.013517e-01 1 1  ON 5
 uu_6                -1.282003e-01 1 1  ON 6
 uu_7                -1.409580e-01 1 1  ON 7
 uu_8                -1.328812e-01 1 1  ON 8
 uu_9                -1.043662e-01 1 1  ON 9
 ud_0                 4.443346e-01 1 1  ON 10
 ud_1                 1.801092e-01 1 1  ON 11
 ud_2                 6.330914e-02 1 1  ON 12
 ud_3                -6.202431e-03 1 1  ON 13
 ud_4                -6.409326e-02 1 1  ON 14
 ud_5                -1.067257e-01 1 1  ON 15
 ud_6                -1.344300e-01 1 1  ON 16
 ud_7                -1.516376e-01 1 1  ON 17
 ud_8                -1.522102e-01 1 1  ON 18
 ud_9                -1.426749e-01 1 1  ON 19
 eO_0                -7.585387e-01 1 1  ON 20
 eO_1                -4.404612e-01 1 1  ON 21
 eO_2                -2.263701e-02 1 1  ON 22
 eO_3                 2.977133e-01 1 1  ON 23
 eO_4                 5.252468e-01 1 1  ON 24
 eO_5                 4.868299e-01 1 1  ON 25
 eO_6                 2.596522e-01 1 1  ON 26
 eO_7                -4.097087e-02 1 1  ON 27
 eO_8                -2.204892e-01 1 1  ON 28
 eO_9                -8.519663e-02 1 1  ON 29
eH1_0                -2.413619e-01 1 1  ON 30
eH1_1                -1.439080e-01 1 1  ON 31
eH1_2                -9.912829e-02 1 1  ON 32
eH1_3                -4.536767e-02 1 1  ON 33
eH1_4                 2.806273e-03 1 1  ON 34
eH1_5                 3.790134e-02 1 1  ON 35
eH1_6                 9.707920e-02 1 1  ON 36
eH1_7                 1.537023e-01 1 1  ON 37
eH1_8                 1.760137e-01 1 1  ON 38
eH1_9                 6.633039e-02 1 1  ON 39
eH2_0                -2.394399e-01 1 1  ON 40
eH2_1                -1.418918e-01 1 1  ON 41
eH2_2                -9.678035e-02 1 1  ON 42
eH2_3                -4.309515e-02 1 1  ON 43
eH2_4                 5.128200e-03 1 1  ON 44
eH2_5                 3.978368e-02 1 1  ON 45
eH2_6                 9.959831e-02 1 1  ON 46
eH2_7                 1.556234e-01 1 1  ON 47
eH2_8                 1.820070e-01 1 1  ON 48
eH2_9                 5.573752e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7318e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.8796
    reference variance = 0.355892
====================================================
  Execution time = 2.0539e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4611e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5279e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346075880788
                                         uncertainty =       0.006287920622

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346075880788
                                         uncertainty =       0.006287920622

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415999807
  error estimate for blocks of size 2^( 2) =       0.000428810012
  error estimate for blocks of size 2^( 3) =       0.000441150922
  error estimate for blocks of size 2^( 4) =       0.000452467211
  error estimate for blocks of size 2^( 5) =       0.000463056505
  error estimate for blocks of size 2^( 6) =       0.000469521700
  error estimate for blocks of size 2^( 7) =       0.000473011918

      target function =                  N/A
              le_mean =     -16.906002307765
             les_mean =     286.159025535266
             stat err =       0.000464514333
             autocorr =       1.246843603442
              std dev =       0.588312568420
             le_variance =       0.346111678161


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690600230777e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+01, overlap shift 5.9605e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906002307765       residual = 3.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906002313984       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906002324416       residual = 5.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906002322145       residual = 6.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906002315046       residual = 7.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906002314256       residual = 5.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906002315149       residual = 9.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+01 is 3.378753e-06

solving harmonic davidson linear method for identity shift 2.3842e+02, overlap shift 2.3842e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906002307765       residual = 3.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906002309324       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906002311936       residual = 5.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906002311443       residual = 6.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906002309696       residual = 6.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906002309395       residual = 5.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906002309618       residual = 9.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+02 is 8.453714e-07

solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906002307765       residual = 3.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906002308155       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906002308808       residual = 5.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906002308690       residual = 6.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906002308254       residual = 6.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906002308173       residual = 5.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906002308229       residual = 9.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+02 is 2.113858e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.325531 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6077e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.093452e-01 1 1  ON 0
 uu_1                 1.425281e-01 1 1  ON 1
 uu_2                 4.086227e-02 1 1  ON 2
 uu_3                -2.150625e-02 1 1  ON 3
 uu_4                -6.690670e-02 1 1  ON 4
 uu_5                -1.013513e-01 1 1  ON 5
 uu_6                -1.282005e-01 1 1  ON 6
 uu_7                -1.409583e-01 1 1  ON 7
 uu_8                -1.328818e-01 1 1  ON 8
 uu_9                -1.043667e-01 1 1  ON 9
 ud_0                 4.443345e-01 1 1  ON 10
 ud_1                 1.801094e-01 1 1  ON 11
 ud_2                 6.330925e-02 1 1  ON 12
 ud_3                -6.202290e-03 1 1  ON 13
 ud_4                -6.409325e-02 1 1  ON 14
 ud_5                -1.067253e-01 1 1  ON 15
 ud_6                -1.344303e-01 1 1  ON 16
 ud_7                -1.516373e-01 1 1  ON 17
 ud_8                -1.522103e-01 1 1  ON 18
 ud_9                -1.426751e-01 1 1  ON 19
 eO_0                -7.585391e-01 1 1  ON 20
 eO_1                -4.404612e-01 1 1  ON 21
 eO_2                -2.263639e-02 1 1  ON 22
 eO_3                 2.977134e-01 1 1  ON 23
 eO_4                 5.252468e-01 1 1  ON 24
 eO_5                 4.868306e-01 1 1  ON 25
 eO_6                 2.596522e-01 1 1  ON 26
 eO_7                -4.097063e-02 1 1  ON 27
 eO_8                -2.204897e-01 1 1  ON 28
 eO_9                -8.519722e-02 1 1  ON 29
eH1_0                -2.413619e-01 1 1  ON 30
eH1_1                -1.439085e-01 1 1  ON 31
eH1_2                -9.912844e-02 1 1  ON 32
eH1_3                -4.536794e-02 1 1  ON 33
eH1_4                 2.805742e-03 1 1  ON 34
eH1_5                 3.790138e-02 1 1  ON 35
eH1_6                 9.707922e-02 1 1  ON 36
eH1_7                 1.537024e-01 1 1  ON 37
eH1_8                 1.760143e-01 1 1  ON 38
eH1_9                 6.633110e-02 1 1  ON 39
eH2_0                -2.394404e-01 1 1  ON 40
eH2_1                -1.418917e-01 1 1  ON 41
eH2_2                -9.678082e-02 1 1  ON 42
eH2_3                -4.309527e-02 1 1  ON 43
eH2_4                 5.128448e-03 1 1  ON 44
eH2_5                 3.978384e-02 1 1  ON 45
eH2_6                 9.959807e-02 1 1  ON 46
eH2_7                 1.556230e-01 1 1  ON 47
eH2_8                 1.820073e-01 1 1  ON 48
eH2_9                 5.573836e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.9851
    reference variance = 0.549836
====================================================
  Execution time = 2.1990e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4158e-01
  Total weights = 2.0000e+06
  Execution time = 1.8956e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341505959970
                                         uncertainty =       0.005972620535

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341505959970
                                         uncertainty =       0.005972620535

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413269501
  error estimate for blocks of size 2^( 2) =       0.000426086678
  error estimate for blocks of size 2^( 3) =       0.000439465735
  error estimate for blocks of size 2^( 4) =       0.000452010185
  error estimate for blocks of size 2^( 5) =       0.000464008755
  error estimate for blocks of size 2^( 6) =       0.000473375331
  error estimate for blocks of size 2^( 7) =       0.000475745217

      target function =                  N/A
              le_mean =     -16.905493371533
             les_mean =     286.137289324367
             stat err =       0.000466284872
             autocorr =       1.273022091335
              std dev =       0.584451332628
             le_variance =       0.341583360211

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341504572799
                                         uncertainty =       0.005972619997

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341504572799
                                         uncertainty =       0.005972619997

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413268661
  error estimate for blocks of size 2^( 2) =       0.000426085852
  error estimate for blocks of size 2^( 3) =       0.000439464908
  error estimate for blocks of size 2^( 4) =       0.000452009367
  error estimate for blocks of size 2^( 5) =       0.000464007947
  error estimate for blocks of size 2^( 6) =       0.000473374574
  error estimate for blocks of size 2^( 7) =       0.000475744433

      target function =                  N/A
              le_mean =     -16.905493384991
             les_mean =     286.137288391584
             stat err =       0.000466284080
             autocorr =       1.273022940235
              std dev =       0.584450145343
             le_variance =       0.341581972392

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341505262660
                                         uncertainty =       0.005972620215

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341505262660
                                         uncertainty =       0.005972620215

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413269079
  error estimate for blocks of size 2^( 2) =       0.000426086263
  error estimate for blocks of size 2^( 3) =       0.000439465319
  error estimate for blocks of size 2^( 4) =       0.000452009774
  error estimate for blocks of size 2^( 5) =       0.000464008349
  error estimate for blocks of size 2^( 6) =       0.000473374951
  error estimate for blocks of size 2^( 7) =       0.000475744823

      target function =                  N/A
              le_mean =     -16.905493378270
             les_mean =     286.137288854504
             stat err =       0.000466284474
             autocorr =       1.273022518593
              std dev =       0.584450735799
             le_variance =       0.341582662576

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341505872683
                                         uncertainty =       0.005972620493

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341505872683
                                         uncertainty =       0.005972620493

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413269448
  error estimate for blocks of size 2^( 2) =       0.000426086626
  error estimate for blocks of size 2^( 3) =       0.000439465683
  error estimate for blocks of size 2^( 4) =       0.000452010133
  error estimate for blocks of size 2^( 5) =       0.000464008704
  error estimate for blocks of size 2^( 6) =       0.000473375284
  error estimate for blocks of size 2^( 7) =       0.000475745168

      target function =                  N/A
              le_mean =     -16.905493372375
             les_mean =     286.137289265495
             stat err =       0.000466284822
             autocorr =       1.273022144834
              std dev =       0.584451257919
             le_variance =       0.341583272883


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905493371533        initial
     5.9605e+01     5.9605e+02             3.3788e-06       -16.905493384991  <--
     2.3842e+02     2.3842e+03             8.4537e-07       -16.905493378270
     9.5367e+02     9.5367e+03             2.1139e-07       -16.905493372375

*****************************************************************************
Applying the update for shift_i =   5.9605e+01     and shift_s =   5.9605e+02
*****************************************************************************

  Execution time = 3.1474e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.093435e-01 1 1  ON 0
 uu_1                 1.425301e-01 1 1  ON 1
 uu_2                 4.086315e-02 1 1  ON 2
 uu_3                -2.150556e-02 1 1  ON 3
 uu_4                -6.690711e-02 1 1  ON 4
 uu_5                -1.013501e-01 1 1  ON 5
 uu_6                -1.282011e-01 1 1  ON 6
 uu_7                -1.409593e-01 1 1  ON 7
 uu_8                -1.328836e-01 1 1  ON 8
 uu_9                -1.043680e-01 1 1  ON 9
 ud_0                 4.443339e-01 1 1  ON 10
 ud_1                 1.801100e-01 1 1  ON 11
 ud_2                 6.330958e-02 1 1  ON 12
 ud_3                -6.201866e-03 1 1  ON 13
 ud_4                -6.409323e-02 1 1  ON 14
 ud_5                -1.067240e-01 1 1  ON 15
 ud_6                -1.344311e-01 1 1  ON 16
 ud_7                -1.516362e-01 1 1  ON 17
 ud_8                -1.522106e-01 1 1  ON 18
 ud_9                -1.426759e-01 1 1  ON 19
 eO_0                -7.585402e-01 1 1  ON 20
 eO_1                -4.404613e-01 1 1  ON 21
 eO_2                -2.263451e-02 1 1  ON 22
 eO_3                 2.977134e-01 1 1  ON 23
 eO_4                 5.252470e-01 1 1  ON 24
 eO_5                 4.868324e-01 1 1  ON 25
 eO_6                 2.596522e-01 1 1  ON 26
 eO_7                -4.096992e-02 1 1  ON 27
 eO_8                -2.204912e-01 1 1  ON 28
 eO_9                -8.519899e-02 1 1  ON 29
eH1_0                -2.413621e-01 1 1  ON 30
eH1_1                -1.439101e-01 1 1  ON 31
eH1_2                -9.912888e-02 1 1  ON 32
eH1_3                -4.536874e-02 1 1  ON 33
eH1_4                 2.804154e-03 1 1  ON 34
eH1_5                 3.790148e-02 1 1  ON 35
eH1_6                 9.707929e-02 1 1  ON 36
eH1_7                 1.537030e-01 1 1  ON 37
eH1_8                 1.760158e-01 1 1  ON 38
eH1_9                 6.633323e-02 1 1  ON 39
eH2_0                -2.394419e-01 1 1  ON 40
eH2_1                -1.418914e-01 1 1  ON 41
eH2_2                -9.678223e-02 1 1  ON 42
eH2_3                -4.309563e-02 1 1  ON 43
eH2_4                 5.129191e-03 1 1  ON 44
eH2_5                 3.978432e-02 1 1  ON 45
eH2_6                 9.959735e-02 1 1  ON 46
eH2_7                 1.556218e-01 1 1  ON 47
eH2_8                 1.820085e-01 1 1  ON 48
eH2_9                 5.574090e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7556e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.9203
    reference variance = 0.271738
====================================================
  Execution time = 2.0488e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 4.3767e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4988e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437781808726
                                         uncertainty =       0.100516234124

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437781808726
                                         uncertainty =       0.100516234124

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467796352
  error estimate for blocks of size 2^( 2) =       0.000479233663
  error estimate for blocks of size 2^( 3) =       0.000490571686
  error estimate for blocks of size 2^( 4) =       0.000501221684
  error estimate for blocks of size 2^( 5) =       0.000510374401
  error estimate for blocks of size 2^( 6) =       0.000518022120
  error estimate for blocks of size 2^( 7) =       0.000522160890

      target function =                  N/A
              le_mean =     -16.905487950399
             les_mean =     286.233189475379
             stat err =       0.000512944774
             autocorr =       1.202340725753
              std dev =       0.661563944863
             le_variance =       0.437666853143


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690548795040e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+01, overlap shift 1.4901e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905487950399       residual = 4.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905487975797       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905487985936       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905488000487       residual = 6.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905487954600       residual = 3.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905487934266       residual = 9.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905487951963       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905487963518       residual = 5.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+01 is 1.470157e-05

solving harmonic davidson linear method for identity shift 5.9605e+01, overlap shift 5.9605e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905487950399       residual = 4.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905487956802       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905487959499       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905487963320       residual = 6.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905487951920       residual = 3.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905487946523       residual = 8.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905487950791       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905487953579       residual = 5.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+01 is 3.675255e-06

solving harmonic davidson linear method for identity shift 2.3842e+02, overlap shift 2.3842e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905487950399       residual = 4.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905487952003       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905487952687       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905487953655       residual = 6.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905487950809       residual = 3.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905487949440       residual = 8.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905487950497       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905487951187       residual = 5.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+02 is 9.188097e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.328223 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5997e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.093438e-01 1 1  ON 0
 uu_1                 1.425292e-01 1 1  ON 1
 uu_2                 4.086405e-02 1 1  ON 2
 uu_3                -2.150739e-02 1 1  ON 3
 uu_4                -6.690679e-02 1 1  ON 4
 uu_5                -1.013493e-01 1 1  ON 5
 uu_6                -1.281999e-01 1 1  ON 6
 uu_7                -1.409618e-01 1 1  ON 7
 uu_8                -1.328854e-01 1 1  ON 8
 uu_9                -1.043688e-01 1 1  ON 9
 ud_0                 4.443315e-01 1 1  ON 10
 ud_1                 1.801133e-01 1 1  ON 11
 ud_2                 6.331008e-02 1 1  ON 12
 ud_3                -6.199652e-03 1 1  ON 13
 ud_4                -6.409360e-02 1 1  ON 14
 ud_5                -1.067244e-01 1 1  ON 15
 ud_6                -1.344309e-01 1 1  ON 16
 ud_7                -1.516370e-01 1 1  ON 17
 ud_8                -1.522105e-01 1 1  ON 18
 ud_9                -1.426766e-01 1 1  ON 19
 eO_0                -7.585422e-01 1 1  ON 20
 eO_1                -4.404608e-01 1 1  ON 21
 eO_2                -2.263365e-02 1 1  ON 22
 eO_3                 2.977148e-01 1 1  ON 23
 eO_4                 5.252464e-01 1 1  ON 24
 eO_5                 4.868354e-01 1 1  ON 25
 eO_6                 2.596543e-01 1 1  ON 26
 eO_7                -4.097029e-02 1 1  ON 27
 eO_8                -2.204934e-01 1 1  ON 28
 eO_9                -8.520126e-02 1 1  ON 29
eH1_0                -2.413630e-01 1 1  ON 30
eH1_1                -1.439135e-01 1 1  ON 31
eH1_2                -9.912868e-02 1 1  ON 32
eH1_3                -4.536971e-02 1 1  ON 33
eH1_4                 2.804512e-03 1 1  ON 34
eH1_5                 3.789950e-02 1 1  ON 35
eH1_6                 9.707831e-02 1 1  ON 36
eH1_7                 1.537035e-01 1 1  ON 37
eH1_8                 1.760193e-01 1 1  ON 38
eH1_9                 6.633691e-02 1 1  ON 39
eH2_0                -2.394427e-01 1 1  ON 40
eH2_1                -1.418924e-01 1 1  ON 41
eH2_2                -9.678428e-02 1 1  ON 42
eH2_3                -4.309455e-02 1 1  ON 43
eH2_4                 5.127419e-03 1 1  ON 44
eH2_5                 3.978520e-02 1 1  ON 45
eH2_6                 9.959697e-02 1 1  ON 46
eH2_7                 1.556220e-01 1 1  ON 47
eH2_8                 1.820094e-01 1 1  ON 48
eH2_9                 5.574370e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.9332
    reference variance = 0.245767
====================================================
  Execution time = 2.0138e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3819e-01
  Total weights = 2.0000e+06
  Execution time = 1.8934e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338154499729
                                         uncertainty =       0.004100709545

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338154499729
                                         uncertainty =       0.004100709545

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411210920
  error estimate for blocks of size 2^( 2) =       0.000424117387
  error estimate for blocks of size 2^( 3) =       0.000437172328
  error estimate for blocks of size 2^( 4) =       0.000449868191
  error estimate for blocks of size 2^( 5) =       0.000461879656
  error estimate for blocks of size 2^( 6) =       0.000472026943
  error estimate for blocks of size 2^( 7) =       0.000476480916

      target function =                  N/A
              le_mean =     -16.904945200344
             les_mean =     286.115360898283
             stat err =       0.000465063926
             autocorr =       1.279075058836
              std dev =       0.581540059443
             le_variance =       0.338188840737

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338141730573
                                         uncertainty =       0.004100519373

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338141730573
                                         uncertainty =       0.004100519373

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411203152
  error estimate for blocks of size 2^( 2) =       0.000424109855
  error estimate for blocks of size 2^( 3) =       0.000437164813
  error estimate for blocks of size 2^( 4) =       0.000449860788
  error estimate for blocks of size 2^( 5) =       0.000461872603
  error estimate for blocks of size 2^( 6) =       0.000472020050
  error estimate for blocks of size 2^( 7) =       0.000476474051

      target function =                  N/A
              le_mean =     -16.904945269656
             les_mean =     286.115350466021
             stat err =       0.000465056873
             autocorr =       1.279084578745
              std dev =       0.581529074989
             le_variance =       0.338176065058

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338147911394
                                         uncertainty =       0.004100610998

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338147911394
                                         uncertainty =       0.004100610998

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411206912
  error estimate for blocks of size 2^( 2) =       0.000424113501
  error estimate for blocks of size 2^( 3) =       0.000437168452
  error estimate for blocks of size 2^( 4) =       0.000449864374
  error estimate for blocks of size 2^( 5) =       0.000461876019
  error estimate for blocks of size 2^( 6) =       0.000472023389
  error estimate for blocks of size 2^( 7) =       0.000476477377

      target function =                  N/A
              le_mean =     -16.904945236442
             les_mean =     286.115355527070
             stat err =       0.000465060290
             autocorr =       1.279079984337
              std dev =       0.581534391975
             le_variance =       0.338182249050

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338153669412
                                         uncertainty =       0.004100697114

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338153669412
                                         uncertainty =       0.004100697114

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411210415
  error estimate for blocks of size 2^( 2) =       0.000424116898
  error estimate for blocks of size 2^( 3) =       0.000437171839
  error estimate for blocks of size 2^( 4) =       0.000449867710
  error estimate for blocks of size 2^( 5) =       0.000461879197
  error estimate for blocks of size 2^( 6) =       0.000472026495
  error estimate for blocks of size 2^( 7) =       0.000476480470

      target function =                  N/A
              le_mean =     -16.904945204885
             les_mean =     286.115360221055
             stat err =       0.000465063468
             autocorr =       1.279075679936
              std dev =       0.581539345184
             le_variance =       0.338188009998


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904945200344        initial
     1.4901e+01     1.4901e+02             1.4702e-05       -16.904945269656  <--
     5.9605e+01     5.9605e+02             3.6753e-06       -16.904945236442
     2.3842e+02     2.3842e+03             9.1881e-07       -16.904945204885

*****************************************************************************
Applying the update for shift_i =   1.4901e+01     and shift_s =   1.4901e+02
*****************************************************************************

  Execution time = 2.9618e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.093447e-01 1 1  ON 0
 uu_1                 1.425266e-01 1 1  ON 1
 uu_2                 4.086663e-02 1 1  ON 2
 uu_3                -2.151269e-02 1 1  ON 3
 uu_4                -6.690591e-02 1 1  ON 4
 uu_5                -1.013470e-01 1 1  ON 5
 uu_6                -1.281964e-01 1 1  ON 6
 uu_7                -1.409690e-01 1 1  ON 7
 uu_8                -1.328909e-01 1 1  ON 8
 uu_9                -1.043713e-01 1 1  ON 9
 ud_0                 4.443246e-01 1 1  ON 10
 ud_1                 1.801232e-01 1 1  ON 11
 ud_2                 6.331168e-02 1 1  ON 12
 ud_3                -6.193218e-03 1 1  ON 13
 ud_4                -6.409463e-02 1 1  ON 14
 ud_5                -1.067255e-01 1 1  ON 15
 ud_6                -1.344303e-01 1 1  ON 16
 ud_7                -1.516393e-01 1 1  ON 17
 ud_8                -1.522102e-01 1 1  ON 18
 ud_9                -1.426788e-01 1 1  ON 19
 eO_0                -7.585480e-01 1 1  ON 20
 eO_1                -4.404595e-01 1 1  ON 21
 eO_2                -2.263109e-02 1 1  ON 22
 eO_3                 2.977188e-01 1 1  ON 23
 eO_4                 5.252445e-01 1 1  ON 24
 eO_5                 4.868444e-01 1 1  ON 25
 eO_6                 2.596605e-01 1 1  ON 26
 eO_7                -4.097141e-02 1 1  ON 27
 eO_8                -2.205000e-01 1 1  ON 28
 eO_9                -8.520810e-02 1 1  ON 29
eH1_0                -2.413656e-01 1 1  ON 30
eH1_1                -1.439237e-01 1 1  ON 31
eH1_2                -9.912815e-02 1 1  ON 32
eH1_3                -4.537262e-02 1 1  ON 33
eH1_4                 2.805548e-03 1 1  ON 34
eH1_5                 3.789355e-02 1 1  ON 35
eH1_6                 9.707538e-02 1 1  ON 36
eH1_7                 1.537052e-01 1 1  ON 37
eH1_8                 1.760297e-01 1 1  ON 38
eH1_9                 6.634793e-02 1 1  ON 39
eH2_0                -2.394453e-01 1 1  ON 40
eH2_1                -1.418953e-01 1 1  ON 41
eH2_2                -9.679035e-02 1 1  ON 42
eH2_3                -4.309141e-02 1 1  ON 43
eH2_4                 5.122160e-03 1 1  ON 44
eH2_5                 3.978780e-02 1 1  ON 45
eH2_6                 9.959583e-02 1 1  ON 46
eH2_7                 1.556226e-01 1 1  ON 47
eH2_8                 1.820119e-01 1 1  ON 48
eH2_9                 5.575209e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5621e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.8686
    reference variance = 0.308486
====================================================
  Execution time = 2.0596e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4620e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7413e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346301551747
                                         uncertainty =       0.010856131597

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346301551747
                                         uncertainty =       0.010856131597

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416054474
  error estimate for blocks of size 2^( 2) =       0.000428429294
  error estimate for blocks of size 2^( 3) =       0.000440404299
  error estimate for blocks of size 2^( 4) =       0.000451387772
  error estimate for blocks of size 2^( 5) =       0.000459929535
  error estimate for blocks of size 2^( 6) =       0.000465962929
  error estimate for blocks of size 2^( 7) =       0.000467384860

      target function =                  N/A
              le_mean =     -16.906091072268
             les_mean =     286.162117821042
             stat err =       0.000461166274
             autocorr =       1.228611809541
              std dev =       0.588389879531
             le_variance =       0.346202650335


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690609107227e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+00, overlap shift 3.7253e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906091072268       residual = 5.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906091114000       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906091152446       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906091139865       residual = 7.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906091227184       residual = 3.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906091300465       residual = 9.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906091299153       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906091273238       residual = 5.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+00 is 5.316767e-05

solving harmonic davidson linear method for identity shift 1.4901e+01, overlap shift 1.4901e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906091072268       residual = 5.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906091082907       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906091092613       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906091088810       residual = 6.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906091110318       residual = 3.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906091127133       residual = 8.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906091128103       residual = 9.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+01 is 1.257720e-05

solving harmonic davidson linear method for identity shift 5.9605e+01, overlap shift 5.9605e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906091072268       residual = 5.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906091074941       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906091077373       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906091076378       residual = 6.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906091081725       residual = 3.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906091085820       residual = 7.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906091086151       residual = 9.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+01 is 3.153290e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.330695 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6348e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.093463e-01 1 1  ON 0
 uu_1                 1.425335e-01 1 1  ON 1
 uu_2                 4.087181e-02 1 1  ON 2
 uu_3                -2.151547e-02 1 1  ON 3
 uu_4                -6.689850e-02 1 1  ON 4
 uu_5                -1.013467e-01 1 1  ON 5
 uu_6                -1.281993e-01 1 1  ON 6
 uu_7                -1.409816e-01 1 1  ON 7
 uu_8                -1.328999e-01 1 1  ON 8
 uu_9                -1.043764e-01 1 1  ON 9
 ud_0                 4.443282e-01 1 1  ON 10
 ud_1                 1.801256e-01 1 1  ON 11
 ud_2                 6.331325e-02 1 1  ON 12
 ud_3                -6.188529e-03 1 1  ON 13
 ud_4                -6.409239e-02 1 1  ON 14
 ud_5                -1.067244e-01 1 1  ON 15
 ud_6                -1.344319e-01 1 1  ON 16
 ud_7                -1.516293e-01 1 1  ON 17
 ud_8                -1.522164e-01 1 1  ON 18
 ud_9                -1.426894e-01 1 1  ON 19
 eO_0                -7.585430e-01 1 1  ON 20
 eO_1                -4.404647e-01 1 1  ON 21
 eO_2                -2.262199e-02 1 1  ON 22
 eO_3                 2.977152e-01 1 1  ON 23
 eO_4                 5.252426e-01 1 1  ON 24
 eO_5                 4.868552e-01 1 1  ON 25
 eO_6                 2.596657e-01 1 1  ON 26
 eO_7                -4.097064e-02 1 1  ON 27
 eO_8                -2.205094e-01 1 1  ON 28
 eO_9                -8.521741e-02 1 1  ON 29
eH1_0                -2.413670e-01 1 1  ON 30
eH1_1                -1.439284e-01 1 1  ON 31
eH1_2                -9.913039e-02 1 1  ON 32
eH1_3                -4.537115e-02 1 1  ON 33
eH1_4                 2.807636e-03 1 1  ON 34
eH1_5                 3.788616e-02 1 1  ON 35
eH1_6                 9.707474e-02 1 1  ON 36
eH1_7                 1.536992e-01 1 1  ON 37
eH1_8                 1.760342e-01 1 1  ON 38
eH1_9                 6.636025e-02 1 1  ON 39
eH2_0                -2.394427e-01 1 1  ON 40
eH2_1                -1.418982e-01 1 1  ON 41
eH2_2                -9.679334e-02 1 1  ON 42
eH2_3                -4.308814e-02 1 1  ON 43
eH2_4                 5.120551e-03 1 1  ON 44
eH2_5                 3.977740e-02 1 1  ON 45
eH2_6                 9.958998e-02 1 1  ON 46
eH2_7                 1.556219e-01 1 1  ON 47
eH2_8                 1.820187e-01 1 1  ON 48
eH2_9                 5.576459e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.8756
    reference variance = 0.231275
====================================================
  Execution time = 2.0205e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3942e-01
  Total weights = 2.0000e+06
  Execution time = 1.8799e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339432118128
                                         uncertainty =       0.003710339954

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339432118128
                                         uncertainty =       0.003710339954

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411958725
  error estimate for blocks of size 2^( 2) =       0.000425402884
  error estimate for blocks of size 2^( 3) =       0.000439365103
  error estimate for blocks of size 2^( 4) =       0.000452959136
  error estimate for blocks of size 2^( 5) =       0.000465145004
  error estimate for blocks of size 2^( 6) =       0.000475418482
  error estimate for blocks of size 2^( 7) =       0.000483488639

      target function =                  N/A
              le_mean =     -16.905655212563
             les_mean =     286.140597979257
             stat err =       0.000469252815
             autocorr =       1.297497000364
              std dev =       0.582597616643
             le_variance =       0.339419982918

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339437404123
                                         uncertainty =       0.003710403062

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339437404123
                                         uncertainty =       0.003710403062

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411961935
  error estimate for blocks of size 2^( 2) =       0.000425405405
  error estimate for blocks of size 2^( 3) =       0.000439366513
  error estimate for blocks of size 2^( 4) =       0.000452960048
  error estimate for blocks of size 2^( 5) =       0.000465145700
  error estimate for blocks of size 2^( 6) =       0.000475419658
  error estimate for blocks of size 2^( 7) =       0.000483489652

      target function =                  N/A
              le_mean =     -16.905655038876
             les_mean =     286.140597394738
             stat err =       0.000469253765
             autocorr =       1.297482034979
              std dev =       0.582602154981
             le_variance =       0.339425270988

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339435287273
                                         uncertainty =       0.003710382504

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339435287273
                                         uncertainty =       0.003710382504

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411960649
  error estimate for blocks of size 2^( 2) =       0.000425404431
  error estimate for blocks of size 2^( 3) =       0.000439366049
  error estimate for blocks of size 2^( 4) =       0.000452959825
  error estimate for blocks of size 2^( 5) =       0.000465145592
  error estimate for blocks of size 2^( 6) =       0.000475419348
  error estimate for blocks of size 2^( 7) =       0.000483489406

      target function =                  N/A
              le_mean =     -16.905655125608
             les_mean =     286.140598209010
             stat err =       0.000469253543
             autocorr =       1.297488903888
              std dev =       0.582600337038
             le_variance =       0.339423152717

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339432521071
                                         uncertainty =       0.003710345463

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339432521071
                                         uncertainty =       0.003710345463

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411958970
  error estimate for blocks of size 2^( 2) =       0.000425403080
  error estimate for blocks of size 2^( 3) =       0.000439365223
  error estimate for blocks of size 2^( 4) =       0.000452959224
  error estimate for blocks of size 2^( 5) =       0.000465145078
  error estimate for blocks of size 2^( 6) =       0.000475418591
  error estimate for blocks of size 2^( 7) =       0.000483488734

      target function =                  N/A
              le_mean =     -16.905655201325
             les_mean =     286.140598002324
             stat err =       0.000469252907
             autocorr =       1.297495964505
              std dev =       0.582597962535
             le_variance =       0.339420385950


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905655212563        initial  <--
     3.7253e+00     3.7253e+01             5.3168e-05       -16.905655038876
     1.4901e+01     1.4901e+02             1.2577e-05       -16.905655125608
     5.9605e+01     5.9605e+02             3.1533e-06       -16.905655201325

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6285
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.093447e-01 1 1  ON 0
 uu_1                 1.425266e-01 1 1  ON 1
 uu_2                 4.086663e-02 1 1  ON 2
 uu_3                -2.151269e-02 1 1  ON 3
 uu_4                -6.690591e-02 1 1  ON 4
 uu_5                -1.013470e-01 1 1  ON 5
 uu_6                -1.281964e-01 1 1  ON 6
 uu_7                -1.409690e-01 1 1  ON 7
 uu_8                -1.328909e-01 1 1  ON 8
 uu_9                -1.043713e-01 1 1  ON 9
 ud_0                 4.443246e-01 1 1  ON 10
 ud_1                 1.801232e-01 1 1  ON 11
 ud_2                 6.331168e-02 1 1  ON 12
 ud_3                -6.193218e-03 1 1  ON 13
 ud_4                -6.409463e-02 1 1  ON 14
 ud_5                -1.067255e-01 1 1  ON 15
 ud_6                -1.344303e-01 1 1  ON 16
 ud_7                -1.516393e-01 1 1  ON 17
 ud_8                -1.522102e-01 1 1  ON 18
 ud_9                -1.426788e-01 1 1  ON 19
 eO_0                -7.585480e-01 1 1  ON 20
 eO_1                -4.404595e-01 1 1  ON 21
 eO_2                -2.263109e-02 1 1  ON 22
 eO_3                 2.977188e-01 1 1  ON 23
 eO_4                 5.252445e-01 1 1  ON 24
 eO_5                 4.868444e-01 1 1  ON 25
 eO_6                 2.596605e-01 1 1  ON 26
 eO_7                -4.097141e-02 1 1  ON 27
 eO_8                -2.205000e-01 1 1  ON 28
 eO_9                -8.520810e-02 1 1  ON 29
eH1_0                -2.413656e-01 1 1  ON 30
eH1_1                -1.439237e-01 1 1  ON 31
eH1_2                -9.912815e-02 1 1  ON 32
eH1_3                -4.537262e-02 1 1  ON 33
eH1_4                 2.805548e-03 1 1  ON 34
eH1_5                 3.789355e-02 1 1  ON 35
eH1_6                 9.707538e-02 1 1  ON 36
eH1_7                 1.537052e-01 1 1  ON 37
eH1_8                 1.760297e-01 1 1  ON 38
eH1_9                 6.634793e-02 1 1  ON 39
eH2_0                -2.394453e-01 1 1  ON 40
eH2_1                -1.418953e-01 1 1  ON 41
eH2_2                -9.679035e-02 1 1  ON 42
eH2_3                -4.309141e-02 1 1  ON 43
eH2_4                 5.122160e-03 1 1  ON 44
eH2_5                 3.978780e-02 1 1  ON 45
eH2_6                 9.959583e-02 1 1  ON 46
eH2_7                 1.556226e-01 1 1  ON 47
eH2_8                 1.820119e-01 1 1  ON 48
eH2_9                 5.575209e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5981e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.9215
    reference variance = 0.282882
====================================================
  Execution time = 2.0554e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.6695e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5443e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.367016965192
                                         uncertainty =       0.019859088399

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.367016965192
                                         uncertainty =       0.019859088399

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000428337665
  error estimate for blocks of size 2^( 2) =       0.000440671513
  error estimate for blocks of size 2^( 3) =       0.000452702622
  error estimate for blocks of size 2^( 4) =       0.000463941070
  error estimate for blocks of size 2^( 5) =       0.000473951643
  error estimate for blocks of size 2^( 6) =       0.000481763365
  error estimate for blocks of size 2^( 7) =       0.000485813607

      target function =                  N/A
              le_mean =     -16.905566209001
             les_mean =     286.165114973302
             stat err =       0.000476367421
             autocorr =       1.236834457558
              std dev =       0.605760934568
             le_variance =       0.366946309849


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690556620900e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+01, overlap shift 3.7253e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905566209001       residual = 9.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905566215555       residual = 4.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905566206222       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905566211376       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905566222989       residual = 3.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905566234111       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905566224190       residual = 4.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905566227555       residual = 2.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+01 is 6.119066e-06

solving harmonic davidson linear method for identity shift 1.4901e+02, overlap shift 1.4901e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905566209001       residual = 9.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905566210643       residual = 4.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905566208291       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905566209581       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905566212504       residual = 3.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905566215307       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905566212833       residual = 4.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905566213670       residual = 2.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+02 is 1.531919e-06

solving harmonic davidson linear method for identity shift 5.9605e+02, overlap shift 5.9605e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905566209001       residual = 9.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905566209412       residual = 4.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905566208823       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905566209145       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905566209877       residual = 3.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905566210579       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905566209962       residual = 4.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905566210170       residual = 2.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+02 is 3.831145e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.333421 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6109e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.093452e-01 1 1  ON 0
 uu_1                 1.425273e-01 1 1  ON 1
 uu_2                 4.086746e-02 1 1  ON 2
 uu_3                -2.151309e-02 1 1  ON 3
 uu_4                -6.690547e-02 1 1  ON 4
 uu_5                -1.013469e-01 1 1  ON 5
 uu_6                -1.281968e-01 1 1  ON 6
 uu_7                -1.409706e-01 1 1  ON 7
 uu_8                -1.328913e-01 1 1  ON 8
 uu_9                -1.043716e-01 1 1  ON 9
 ud_0                 4.443250e-01 1 1  ON 10
 ud_1                 1.801233e-01 1 1  ON 11
 ud_2                 6.331184e-02 1 1  ON 12
 ud_3                -6.191715e-03 1 1  ON 13
 ud_4                -6.409510e-02 1 1  ON 14
 ud_5                -1.067245e-01 1 1  ON 15
 ud_6                -1.344302e-01 1 1  ON 16
 ud_7                -1.516392e-01 1 1  ON 17
 ud_8                -1.522115e-01 1 1  ON 18
 ud_9                -1.426797e-01 1 1  ON 19
 eO_0                -7.585470e-01 1 1  ON 20
 eO_1                -4.404594e-01 1 1  ON 21
 eO_2                -2.263095e-02 1 1  ON 22
 eO_3                 2.977191e-01 1 1  ON 23
 eO_4                 5.252440e-01 1 1  ON 24
 eO_5                 4.868448e-01 1 1  ON 25
 eO_6                 2.596612e-01 1 1  ON 26
 eO_7                -4.097103e-02 1 1  ON 27
 eO_8                -2.205010e-01 1 1  ON 28
 eO_9                -8.520923e-02 1 1  ON 29
eH1_0                -2.413667e-01 1 1  ON 30
eH1_1                -1.439247e-01 1 1  ON 31
eH1_2                -9.912829e-02 1 1  ON 32
eH1_3                -4.537234e-02 1 1  ON 33
eH1_4                 2.805886e-03 1 1  ON 34
eH1_5                 3.789375e-02 1 1  ON 35
eH1_6                 9.707588e-02 1 1  ON 36
eH1_7                 1.537046e-01 1 1  ON 37
eH1_8                 1.760302e-01 1 1  ON 38
eH1_9                 6.634899e-02 1 1  ON 39
eH2_0                -2.394455e-01 1 1  ON 40
eH2_1                -1.418954e-01 1 1  ON 41
eH2_2                -9.679061e-02 1 1  ON 42
eH2_3                -4.309240e-02 1 1  ON 43
eH2_4                 5.122029e-03 1 1  ON 44
eH2_5                 3.978757e-02 1 1  ON 45
eH2_6                 9.959582e-02 1 1  ON 46
eH2_7                 1.556227e-01 1 1  ON 47
eH2_8                 1.820126e-01 1 1  ON 48
eH2_9                 5.575321e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.9655
    reference variance = 0.259136
====================================================
  Execution time = 2.0073e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4311e-01
  Total weights = 2.0000e+06
  Execution time = 1.8872e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343157072467
                                         uncertainty =       0.010827565945

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343157072467
                                         uncertainty =       0.010827565945

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414191505
  error estimate for blocks of size 2^( 2) =       0.000426528803
  error estimate for blocks of size 2^( 3) =       0.000439562100
  error estimate for blocks of size 2^( 4) =       0.000450921961
  error estimate for blocks of size 2^( 5) =       0.000461672736
  error estimate for blocks of size 2^( 6) =       0.000470783380
  error estimate for blocks of size 2^( 7) =       0.000477272751

      target function =                  N/A
              le_mean =     -16.905208723342
             les_mean =     286.129191014092
             stat err =       0.000465162707
             autocorr =       1.261268076001
              std dev =       0.585755244015
             le_variance =       0.343109205891

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343158032110
                                         uncertainty =       0.010827789020

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343158032110
                                         uncertainty =       0.010827789020

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414192084
  error estimate for blocks of size 2^( 2) =       0.000426529319
  error estimate for blocks of size 2^( 3) =       0.000439562584
  error estimate for blocks of size 2^( 4) =       0.000450922422
  error estimate for blocks of size 2^( 5) =       0.000461673208
  error estimate for blocks of size 2^( 6) =       0.000470783893
  error estimate for blocks of size 2^( 7) =       0.000477273411

      target function =                  N/A
              le_mean =     -16.905208746518
             les_mean =     286.129192757207
             stat err =       0.000465163234
             autocorr =       1.261267405108
              std dev =       0.585756063049
             le_variance =       0.343110165399

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343157563782
                                         uncertainty =       0.010827678435

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343157563782
                                         uncertainty =       0.010827678435

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414191802
  error estimate for blocks of size 2^( 2) =       0.000426529068
  error estimate for blocks of size 2^( 3) =       0.000439562348
  error estimate for blocks of size 2^( 4) =       0.000450922197
  error estimate for blocks of size 2^( 5) =       0.000461672978
  error estimate for blocks of size 2^( 6) =       0.000470783642
  error estimate for blocks of size 2^( 7) =       0.000477273088

      target function =                  N/A
              le_mean =     -16.905208735007
             les_mean =     286.129191899747
             stat err =       0.000465162976
             autocorr =       1.261267731217
              std dev =       0.585755663341
             le_variance =       0.343109697136

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343157134220
                                         uncertainty =       0.010827580037

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343157134220
                                         uncertainty =       0.010827580037

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414191542
  error estimate for blocks of size 2^( 2) =       0.000426528836
  error estimate for blocks of size 2^( 3) =       0.000439562131
  error estimate for blocks of size 2^( 4) =       0.000450921991
  error estimate for blocks of size 2^( 5) =       0.000461672767
  error estimate for blocks of size 2^( 6) =       0.000470783413
  error estimate for blocks of size 2^( 7) =       0.000477272793

      target function =                  N/A
              le_mean =     -16.905208724799
             les_mean =     286.129191125098
             stat err =       0.000465162741
             autocorr =       1.261268032607
              std dev =       0.585755296719
             le_variance =       0.343109267634


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905208723342        initial
     3.7253e+01     3.7253e+02             6.1191e-06       -16.905208746518  <--
     1.4901e+02     1.4901e+03             1.5319e-06       -16.905208735007
     5.9605e+02     5.9605e+03             3.8311e-07       -16.905208724799

*****************************************************************************
Applying the update for shift_i =   3.7253e+01     and shift_s =   3.7253e+02
*****************************************************************************

  Execution time = 2.9557e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.093466e-01 1 1  ON 0
 uu_1                 1.425293e-01 1 1  ON 1
 uu_2                 4.086993e-02 1 1  ON 2
 uu_3                -2.151423e-02 1 1  ON 3
 uu_4                -6.690416e-02 1 1  ON 4
 uu_5                -1.013467e-01 1 1  ON 5
 uu_6                -1.281982e-01 1 1  ON 6
 uu_7                -1.409752e-01 1 1  ON 7
 uu_8                -1.328925e-01 1 1  ON 8
 uu_9                -1.043726e-01 1 1  ON 9
 ud_0                 4.443265e-01 1 1  ON 10
 ud_1                 1.801234e-01 1 1  ON 11
 ud_2                 6.331234e-02 1 1  ON 12
 ud_3                -6.187256e-03 1 1  ON 13
 ud_4                -6.409645e-02 1 1  ON 14
 ud_5                -1.067214e-01 1 1  ON 15
 ud_6                -1.344301e-01 1 1  ON 16
 ud_7                -1.516390e-01 1 1  ON 17
 ud_8                -1.522155e-01 1 1  ON 18
 ud_9                -1.426822e-01 1 1  ON 19
 eO_0                -7.585440e-01 1 1  ON 20
 eO_1                -4.404593e-01 1 1  ON 21
 eO_2                -2.263053e-02 1 1  ON 22
 eO_3                 2.977199e-01 1 1  ON 23
 eO_4                 5.252426e-01 1 1  ON 24
 eO_5                 4.868459e-01 1 1  ON 25
 eO_6                 2.596631e-01 1 1  ON 26
 eO_7                -4.096991e-02 1 1  ON 27
 eO_8                -2.205042e-01 1 1  ON 28
 eO_9                -8.521265e-02 1 1  ON 29
eH1_0                -2.413699e-01 1 1  ON 30
eH1_1                -1.439277e-01 1 1  ON 31
eH1_2                -9.912873e-02 1 1  ON 32
eH1_3                -4.537153e-02 1 1  ON 33
eH1_4                 2.806901e-03 1 1  ON 34
eH1_5                 3.789436e-02 1 1  ON 35
eH1_6                 9.707737e-02 1 1  ON 36
eH1_7                 1.537028e-01 1 1  ON 37
eH1_8                 1.760316e-01 1 1  ON 38
eH1_9                 6.635218e-02 1 1  ON 39
eH2_0                -2.394461e-01 1 1  ON 40
eH2_1                -1.418956e-01 1 1  ON 41
eH2_2                -9.679141e-02 1 1  ON 42
eH2_3                -4.309538e-02 1 1  ON 43
eH2_4                 5.121631e-03 1 1  ON 44
eH2_5                 3.978690e-02 1 1  ON 45
eH2_6                 9.959581e-02 1 1  ON 46
eH2_7                 1.556229e-01 1 1  ON 47
eH2_8                 1.820146e-01 1 1  ON 48
eH2_9                 5.575657e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5671e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.9686
    reference variance = 0.34505
====================================================
  Execution time = 2.0524e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3654e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5186e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336601342980
                                         uncertainty =       0.002502470405

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336601342980
                                         uncertainty =       0.002502470405

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410209734
  error estimate for blocks of size 2^( 2) =       0.000422687775
  error estimate for blocks of size 2^( 3) =       0.000435442501
  error estimate for blocks of size 2^( 4) =       0.000448167963
  error estimate for blocks of size 2^( 5) =       0.000458876111
  error estimate for blocks of size 2^( 6) =       0.000467537532
  error estimate for blocks of size 2^( 7) =       0.000472028180

      target function =                  N/A
              le_mean =     -16.906435481102
             les_mean =     286.164104559868
             stat err =       0.000461652446
             autocorr =       1.266538393738
              std dev =       0.580124169022
             le_variance =       0.336544051484


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690643548110e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+00, overlap shift 9.3132e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906435481102       residual = 8.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906435502962       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906435479303       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906435475166       residual = 6.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906435482337       residual = 2.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906435516787       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906435516598       residual = 2.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906435509137       residual = 5.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+00 is 2.479822e-05

solving harmonic davidson linear method for identity shift 3.7253e+01, overlap shift 3.7253e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906435481102       residual = 8.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906435486614       residual = 3.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906435480514       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906435479343       residual = 6.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906435481099       residual = 2.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906435489409       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906435489171       residual = 2.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906435487428       residual = 4.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+01 is 6.210365e-06

solving harmonic davidson linear method for identity shift 1.4901e+02, overlap shift 1.4901e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906435481102       residual = 8.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906435482483       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906435480946       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906435480644       residual = 6.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906435481081       residual = 2.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906435483139       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906435483066       residual = 2.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906435482637       residual = 4.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+02 is 1.553238e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.336073 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6056e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.093486e-01 1 1  ON 0
 uu_1                 1.425287e-01 1 1  ON 1
 uu_2                 4.087066e-02 1 1  ON 2
 uu_3                -2.151368e-02 1 1  ON 3
 uu_4                -6.690206e-02 1 1  ON 4
 uu_5                -1.013455e-01 1 1  ON 5
 uu_6                -1.281985e-01 1 1  ON 6
 uu_7                -1.409761e-01 1 1  ON 7
 uu_8                -1.328987e-01 1 1  ON 8
 uu_9                -1.043767e-01 1 1  ON 9
 ud_0                 4.443277e-01 1 1  ON 10
 ud_1                 1.801278e-01 1 1  ON 11
 ud_2                 6.331347e-02 1 1  ON 12
 ud_3                -6.184487e-03 1 1  ON 13
 ud_4                -6.409887e-02 1 1  ON 14
 ud_5                -1.067210e-01 1 1  ON 15
 ud_6                -1.344297e-01 1 1  ON 16
 ud_7                -1.516426e-01 1 1  ON 17
 ud_8                -1.522193e-01 1 1  ON 18
 ud_9                -1.426815e-01 1 1  ON 19
 eO_0                -7.585452e-01 1 1  ON 20
 eO_1                -4.404562e-01 1 1  ON 21
 eO_2                -2.262977e-02 1 1  ON 22
 eO_3                 2.977202e-01 1 1  ON 23
 eO_4                 5.252419e-01 1 1  ON 24
 eO_5                 4.868512e-01 1 1  ON 25
 eO_6                 2.596640e-01 1 1  ON 26
 eO_7                -4.097138e-02 1 1  ON 27
 eO_8                -2.205077e-01 1 1  ON 28
 eO_9                -8.521577e-02 1 1  ON 29
eH1_0                -2.413717e-01 1 1  ON 30
eH1_1                -1.439290e-01 1 1  ON 31
eH1_2                -9.913114e-02 1 1  ON 32
eH1_3                -4.537173e-02 1 1  ON 33
eH1_4                 2.805182e-03 1 1  ON 34
eH1_5                 3.789606e-02 1 1  ON 35
eH1_6                 9.707496e-02 1 1  ON 36
eH1_7                 1.537020e-01 1 1  ON 37
eH1_8                 1.760343e-01 1 1  ON 38
eH1_9                 6.635729e-02 1 1  ON 39
eH2_0                -2.394507e-01 1 1  ON 40
eH2_1                -1.418979e-01 1 1  ON 41
eH2_2                -9.679165e-02 1 1  ON 42
eH2_3                -4.309516e-02 1 1  ON 43
eH2_4                 5.124526e-03 1 1  ON 44
eH2_5                 3.978836e-02 1 1  ON 45
eH2_6                 9.959357e-02 1 1  ON 46
eH2_7                 1.556221e-01 1 1  ON 47
eH2_8                 1.820160e-01 1 1  ON 48
eH2_9                 5.576037e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.7913
    reference variance = 0.399954
====================================================
  Execution time = 2.0040e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3593e-01
  Total weights = 2.0000e+06
  Execution time = 1.8593e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335629277687
                                         uncertainty =       0.003215801107

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335629277687
                                         uncertainty =       0.003215801107

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409833157
  error estimate for blocks of size 2^( 2) =       0.000422547695
  error estimate for blocks of size 2^( 3) =       0.000435795912
  error estimate for blocks of size 2^( 4) =       0.000448550020
  error estimate for blocks of size 2^( 5) =       0.000460432788
  error estimate for blocks of size 2^( 6) =       0.000469766954
  error estimate for blocks of size 2^( 7) =       0.000474722424

      target function =                  N/A
              le_mean =     -16.904914209517
             les_mean =     286.112050696613
             stat err =       0.000463368046
             autocorr =       1.278315279233
              std dev =       0.579591609186
             le_variance =       0.335926433439

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335627447444
                                         uncertainty =       0.003215757890

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335627447444
                                         uncertainty =       0.003215757890

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409832034
  error estimate for blocks of size 2^( 2) =       0.000422546522
  error estimate for blocks of size 2^( 3) =       0.000435794462
  error estimate for blocks of size 2^( 4) =       0.000448548348
  error estimate for blocks of size 2^( 5) =       0.000460431064
  error estimate for blocks of size 2^( 6) =       0.000469765462
  error estimate for blocks of size 2^( 7) =       0.000474721247

      target function =                  N/A
              le_mean =     -16.904914301118
             les_mean =     286.112051952061
             stat err =       0.000463366530
             autocorr =       1.278313923229
              std dev =       0.579590020515
             le_variance =       0.335924591881

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335628237677
                                         uncertainty =       0.003215777703

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335628237677
                                         uncertainty =       0.003215777703

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409832519
  error estimate for blocks of size 2^( 2) =       0.000422547034
  error estimate for blocks of size 2^( 3) =       0.000435795110
  error estimate for blocks of size 2^( 4) =       0.000448549106
  error estimate for blocks of size 2^( 5) =       0.000460431849
  error estimate for blocks of size 2^( 6) =       0.000469766131
  error estimate for blocks of size 2^( 7) =       0.000474721764

      target function =                  N/A
              le_mean =     -16.904914256947
             les_mean =     286.112051254075
             stat err =       0.000463367212
             autocorr =       1.278314659531
              std dev =       0.579590706701
             le_variance =       0.335925387295

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335629143473
                                         uncertainty =       0.003215798123

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335629143473
                                         uncertainty =       0.003215798123

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409833075
  error estimate for blocks of size 2^( 2) =       0.000422547609
  error estimate for blocks of size 2^( 3) =       0.000435795809
  error estimate for blocks of size 2^( 4) =       0.000448549903
  error estimate for blocks of size 2^( 5) =       0.000460432668
  error estimate for blocks of size 2^( 6) =       0.000469766848
  error estimate for blocks of size 2^( 7) =       0.000474722339

      target function =                  N/A
              le_mean =     -16.904914215476
             les_mean =     286.112050763080
             stat err =       0.000463367939
             autocorr =       1.278315203558
              std dev =       0.579591492727
             le_variance =       0.335926298442


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904914209517        initial
     9.3132e+00     9.3132e+01             2.4798e-05       -16.904914301118  <--
     3.7253e+01     3.7253e+02             6.2104e-06       -16.904914256947
     1.4901e+02     1.4901e+03             1.5532e-06       -16.904914215476

*****************************************************************************
Applying the update for shift_i =   9.3132e+00     and shift_s =   9.3132e+01
*****************************************************************************

  Execution time = 3.1959e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.093546e-01 1 1  ON 0
 uu_1                 1.425269e-01 1 1  ON 1
 uu_2                 4.087281e-02 1 1  ON 2
 uu_3                -2.151199e-02 1 1  ON 3
 uu_4                -6.689588e-02 1 1  ON 4
 uu_5                -1.013419e-01 1 1  ON 5
 uu_6                -1.281995e-01 1 1  ON 6
 uu_7                -1.409790e-01 1 1  ON 7
 uu_8                -1.329172e-01 1 1  ON 8
 uu_9                -1.043891e-01 1 1  ON 9
 ud_0                 4.443318e-01 1 1  ON 10
 ud_1                 1.801402e-01 1 1  ON 11
 ud_2                 6.331709e-02 1 1  ON 12
 ud_3                -6.176588e-03 1 1  ON 13
 ud_4                -6.410565e-02 1 1  ON 14
 ud_5                -1.067200e-01 1 1  ON 15
 ud_6                -1.344285e-01 1 1  ON 16
 ud_7                -1.516530e-01 1 1  ON 17
 ud_8                -1.522307e-01 1 1  ON 18
 ud_9                -1.426795e-01 1 1  ON 19
 eO_0                -7.585485e-01 1 1  ON 20
 eO_1                -4.404471e-01 1 1  ON 21
 eO_2                -2.262744e-02 1 1  ON 22
 eO_3                 2.977211e-01 1 1  ON 23
 eO_4                 5.252400e-01 1 1  ON 24
 eO_5                 4.868670e-01 1 1  ON 25
 eO_6                 2.596667e-01 1 1  ON 26
 eO_7                -4.097581e-02 1 1  ON 27
 eO_8                -2.205180e-01 1 1  ON 28
 eO_9                -8.522511e-02 1 1  ON 29
eH1_0                -2.413772e-01 1 1  ON 30
eH1_1                -1.439326e-01 1 1  ON 31
eH1_2                -9.913824e-02 1 1  ON 32
eH1_3                -4.537243e-02 1 1  ON 33
eH1_4                 2.800135e-03 1 1  ON 34
eH1_5                 3.790112e-02 1 1  ON 35
eH1_6                 9.706778e-02 1 1  ON 36
eH1_7                 1.536997e-01 1 1  ON 37
eH1_8                 1.760424e-01 1 1  ON 38
eH1_9                 6.637256e-02 1 1  ON 39
eH2_0                -2.394644e-01 1 1  ON 40
eH2_1                -1.419048e-01 1 1  ON 41
eH2_2                -9.679240e-02 1 1  ON 42
eH2_3                -4.309449e-02 1 1  ON 43
eH2_4                 5.133190e-03 1 1  ON 44
eH2_5                 3.979273e-02 1 1  ON 45
eH2_6                 9.958688e-02 1 1  ON 46
eH2_7                 1.556198e-01 1 1  ON 47
eH2_8                 1.820204e-01 1 1  ON 48
eH2_9                 5.577172e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8042e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.8707
    reference variance = 0.228179
====================================================
  Execution time = 2.0797e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3267e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5365e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332699436866
                                         uncertainty =       0.003408996458

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332699436866
                                         uncertainty =       0.003408996458

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407843342
  error estimate for blocks of size 2^( 2) =       0.000420572644
  error estimate for blocks of size 2^( 3) =       0.000434070761
  error estimate for blocks of size 2^( 4) =       0.000446351979
  error estimate for blocks of size 2^( 5) =       0.000457106027
  error estimate for blocks of size 2^( 6) =       0.000462829927
  error estimate for blocks of size 2^( 7) =       0.000463932102

      target function =                  N/A
              le_mean =     -16.906171172880
             les_mean =     286.151295944242
             stat err =       0.000457555009
             autocorr =       1.258635199121
              std dev =       0.576777586130
             le_variance =       0.332672383862


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690617117288e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+00, overlap shift 2.3283e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906171172880       residual = 4.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906171192816       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906171337645       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906171323343       residual = 5.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906171339844       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906171232570       residual = 6.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906171261905       residual = 3.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906171295398       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906171311244       residual = 1.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+00 is 1.013554e-04

solving harmonic davidson linear method for identity shift 9.3132e+00, overlap shift 9.3132e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906171172880       residual = 4.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906171178132       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906171214827       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906171210570       residual = 5.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906171218289       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906171195323       residual = 9.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906171191832       residual = 2.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906171203561       residual = 7.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+00 is 2.454829e-05

solving harmonic davidson linear method for identity shift 3.7253e+01, overlap shift 3.7253e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906171172880       residual = 4.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906171174211       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906171183391       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906171182296       residual = 5.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906171184491       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906171179027       residual = 9.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906171177593       residual = 2.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906171180553       residual = 6.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+01 is 6.148654e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.338938 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6345e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.093465e-01 1 1  ON 0
 uu_1                 1.425391e-01 1 1  ON 1
 uu_2                 4.088341e-02 1 1  ON 2
 uu_3                -2.151852e-02 1 1  ON 3
 uu_4                -6.688907e-02 1 1  ON 4
 uu_5                -1.013511e-01 1 1  ON 5
 uu_6                -1.282057e-01 1 1  ON 6
 uu_7                -1.409807e-01 1 1  ON 7
 uu_8                -1.329268e-01 1 1  ON 8
 uu_9                -1.043953e-01 1 1  ON 9
 ud_0                 4.443245e-01 1 1  ON 10
 ud_1                 1.801523e-01 1 1  ON 11
 ud_2                 6.332505e-02 1 1  ON 12
 ud_3                -6.167248e-03 1 1  ON 13
 ud_4                -6.410681e-02 1 1  ON 14
 ud_5                -1.067095e-01 1 1  ON 15
 ud_6                -1.344319e-01 1 1  ON 16
 ud_7                -1.516497e-01 1 1  ON 17
 ud_8                -1.522362e-01 1 1  ON 18
 ud_9                -1.426885e-01 1 1  ON 19
 eO_0                -7.585469e-01 1 1  ON 20
 eO_1                -4.404453e-01 1 1  ON 21
 eO_2                -2.262587e-02 1 1  ON 22
 eO_3                 2.977351e-01 1 1  ON 23
 eO_4                 5.252307e-01 1 1  ON 24
 eO_5                 4.868787e-01 1 1  ON 25
 eO_6                 2.596761e-01 1 1  ON 26
 eO_7                -4.097318e-02 1 1  ON 27
 eO_8                -2.205336e-01 1 1  ON 28
 eO_9                -8.523978e-02 1 1  ON 29
eH1_0                -2.413869e-01 1 1  ON 30
eH1_1                -1.439547e-01 1 1  ON 31
eH1_2                -9.915202e-02 1 1  ON 32
eH1_3                -4.537434e-02 1 1  ON 33
eH1_4                 2.819833e-03 1 1  ON 34
eH1_5                 3.790452e-02 1 1  ON 35
eH1_6                 9.706733e-02 1 1  ON 36
eH1_7                 1.537007e-01 1 1  ON 37
eH1_8                 1.760533e-01 1 1  ON 38
eH1_9                 6.638562e-02 1 1  ON 39
eH2_0                -2.394759e-01 1 1  ON 40
eH2_1                -1.419142e-01 1 1  ON 41
eH2_2                -9.681038e-02 1 1  ON 42
eH2_3                -4.309719e-02 1 1  ON 43
eH2_4                 5.136387e-03 1 1  ON 44
eH2_5                 3.980386e-02 1 1  ON 45
eH2_6                 9.958133e-02 1 1  ON 46
eH2_7                 1.556123e-01 1 1  ON 47
eH2_8                 1.820324e-01 1 1  ON 48
eH2_9                 5.579627e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.9646
    reference variance = 0.336985
====================================================
  Execution time = 2.1889e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4360e-01
  Total weights = 2.0000e+06
  Execution time = 1.9593e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343669552463
                                         uncertainty =       0.003842848418

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343669552463
                                         uncertainty =       0.003842848418

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414495814
  error estimate for blocks of size 2^( 2) =       0.000427229616
  error estimate for blocks of size 2^( 3) =       0.000439777138
  error estimate for blocks of size 2^( 4) =       0.000452505533
  error estimate for blocks of size 2^( 5) =       0.000462478211
  error estimate for blocks of size 2^( 6) =       0.000470964345
  error estimate for blocks of size 2^( 7) =       0.000473666016

      target function =                  N/A
              le_mean =     -16.905472354613
             les_mean =     286.138608919904
             stat err =       0.000464903526
             autocorr =       1.258013736518
              std dev =       0.586185601263
             le_variance =       0.343613559128

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343619866202
                                         uncertainty =       0.003841907843

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343619866202
                                         uncertainty =       0.003841907843

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414465851
  error estimate for blocks of size 2^( 2) =       0.000427199818
  error estimate for blocks of size 2^( 3) =       0.000439747371
  error estimate for blocks of size 2^( 4) =       0.000452475986
  error estimate for blocks of size 2^( 5) =       0.000462449821
  error estimate for blocks of size 2^( 6) =       0.000470936963
  error estimate for blocks of size 2^( 7) =       0.000473638694

      target function =                  N/A
              le_mean =     -16.905472092474
             les_mean =     286.138550381741
             stat err =       0.000464875366
             autocorr =       1.258043211739
              std dev =       0.586143228318
             le_variance =       0.343563884103

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343637773341
                                         uncertainty =       0.003842263694

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343637773341
                                         uncertainty =       0.003842263694

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414476650
  error estimate for blocks of size 2^( 2) =       0.000427210675
  error estimate for blocks of size 2^( 3) =       0.000439758339
  error estimate for blocks of size 2^( 4) =       0.000452486986
  error estimate for blocks of size 2^( 5) =       0.000462460376
  error estimate for blocks of size 2^( 6) =       0.000470947056
  error estimate for blocks of size 2^( 7) =       0.000473648697

      target function =                  N/A
              le_mean =     -16.905472211452
             les_mean =     286.138572307522
             stat err =       0.000464885779
             autocorr =       1.258034012453
              std dev =       0.586158500026
             le_variance =       0.343581787153

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343665421190
                                         uncertainty =       0.003842772344

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343665421190
                                         uncertainty =       0.003842772344

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414493322
  error estimate for blocks of size 2^( 2) =       0.000427227154
  error estimate for blocks of size 2^( 3) =       0.000439774696
  error estimate for blocks of size 2^( 4) =       0.000452503125
  error estimate for blocks of size 2^( 5) =       0.000462475895
  error estimate for blocks of size 2^( 6) =       0.000470962098
  error estimate for blocks of size 2^( 7) =       0.000473663766

      target function =                  N/A
              le_mean =     -16.905472335468
             les_mean =     286.138604142251
             stat err =       0.000464901221
             autocorr =       1.258016382543
              std dev =       0.586182078177
             le_variance =       0.343609428776


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905472354613        initial  <--
     2.3283e+00     2.3283e+01             1.0136e-04       -16.905472092474
     9.3132e+00     9.3132e+01             2.4548e-05       -16.905472211452
     3.7253e+01     3.7253e+02             6.1487e-06       -16.905472335468

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.3951
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.093546e-01 1 1  ON 0
 uu_1                 1.425269e-01 1 1  ON 1
 uu_2                 4.087281e-02 1 1  ON 2
 uu_3                -2.151199e-02 1 1  ON 3
 uu_4                -6.689588e-02 1 1  ON 4
 uu_5                -1.013419e-01 1 1  ON 5
 uu_6                -1.281995e-01 1 1  ON 6
 uu_7                -1.409790e-01 1 1  ON 7
 uu_8                -1.329172e-01 1 1  ON 8
 uu_9                -1.043891e-01 1 1  ON 9
 ud_0                 4.443318e-01 1 1  ON 10
 ud_1                 1.801402e-01 1 1  ON 11
 ud_2                 6.331709e-02 1 1  ON 12
 ud_3                -6.176588e-03 1 1  ON 13
 ud_4                -6.410565e-02 1 1  ON 14
 ud_5                -1.067200e-01 1 1  ON 15
 ud_6                -1.344285e-01 1 1  ON 16
 ud_7                -1.516530e-01 1 1  ON 17
 ud_8                -1.522307e-01 1 1  ON 18
 ud_9                -1.426795e-01 1 1  ON 19
 eO_0                -7.585485e-01 1 1  ON 20
 eO_1                -4.404471e-01 1 1  ON 21
 eO_2                -2.262744e-02 1 1  ON 22
 eO_3                 2.977211e-01 1 1  ON 23
 eO_4                 5.252400e-01 1 1  ON 24
 eO_5                 4.868670e-01 1 1  ON 25
 eO_6                 2.596667e-01 1 1  ON 26
 eO_7                -4.097581e-02 1 1  ON 27
 eO_8                -2.205180e-01 1 1  ON 28
 eO_9                -8.522511e-02 1 1  ON 29
eH1_0                -2.413772e-01 1 1  ON 30
eH1_1                -1.439326e-01 1 1  ON 31
eH1_2                -9.913824e-02 1 1  ON 32
eH1_3                -4.537243e-02 1 1  ON 33
eH1_4                 2.800135e-03 1 1  ON 34
eH1_5                 3.790112e-02 1 1  ON 35
eH1_6                 9.706778e-02 1 1  ON 36
eH1_7                 1.536997e-01 1 1  ON 37
eH1_8                 1.760424e-01 1 1  ON 38
eH1_9                 6.637256e-02 1 1  ON 39
eH2_0                -2.394644e-01 1 1  ON 40
eH2_1                -1.419048e-01 1 1  ON 41
eH2_2                -9.679240e-02 1 1  ON 42
eH2_3                -4.309449e-02 1 1  ON 43
eH2_4                 5.133190e-03 1 1  ON 44
eH2_5                 3.979273e-02 1 1  ON 45
eH2_6                 9.958688e-02 1 1  ON 46
eH2_7                 1.556198e-01 1 1  ON 47
eH2_8                 1.820204e-01 1 1  ON 48
eH2_9                 5.577172e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7745e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.8413
    reference variance = 0.317059
====================================================
  Execution time = 2.0546e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5270e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5365e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352725046259
                                         uncertainty =       0.015420918793

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352725046259
                                         uncertainty =       0.015420918793

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419942290
  error estimate for blocks of size 2^( 2) =       0.000432539162
  error estimate for blocks of size 2^( 3) =       0.000445447107
  error estimate for blocks of size 2^( 4) =       0.000456969233
  error estimate for blocks of size 2^( 5) =       0.000466901579
  error estimate for blocks of size 2^( 6) =       0.000471733796
  error estimate for blocks of size 2^( 7) =       0.000476056098

      target function =                  N/A
              le_mean =     -16.905658291010
             les_mean =     286.153985130252
             stat err =       0.000467915176
             autocorr =       1.241523767067
              std dev =       0.593888082217
             le_variance =       0.352703054199


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690565829101e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+01, overlap shift 2.3283e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905658291010       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905658277637       residual = 3.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905658275903       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905658259101       residual = 4.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905658241812       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905658239462       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905658241807       residual = 1.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905658246172       residual = 5.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+01 is 9.330612e-06

solving harmonic davidson linear method for identity shift 9.3132e+01, overlap shift 9.3132e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905658291010       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905658287652       residual = 3.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905658287201       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905658282972       residual = 4.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905658278536       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905658277941       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905658278509       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905658279577       residual = 5.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+01 is 2.343510e-06

solving harmonic davidson linear method for identity shift 3.7253e+02, overlap shift 3.7253e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905658291010       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905658290170       residual = 3.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905658290056       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905658288997       residual = 4.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905658287880       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905658287731       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905658287872       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905658288137       residual = 5.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+02 is 5.865628e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.341695 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6094e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.093551e-01 1 1  ON 0
 uu_1                 1.425280e-01 1 1  ON 1
 uu_2                 4.087278e-02 1 1  ON 2
 uu_3                -2.151260e-02 1 1  ON 3
 uu_4                -6.689678e-02 1 1  ON 4
 uu_5                -1.013425e-01 1 1  ON 5
 uu_6                -1.281992e-01 1 1  ON 6
 uu_7                -1.409810e-01 1 1  ON 7
 uu_8                -1.329175e-01 1 1  ON 8
 uu_9                -1.043886e-01 1 1  ON 9
 ud_0                 4.443315e-01 1 1  ON 10
 ud_1                 1.801415e-01 1 1  ON 11
 ud_2                 6.331718e-02 1 1  ON 12
 ud_3                -6.175425e-03 1 1  ON 13
 ud_4                -6.410570e-02 1 1  ON 14
 ud_5                -1.067187e-01 1 1  ON 15
 ud_6                -1.344287e-01 1 1  ON 16
 ud_7                -1.516532e-01 1 1  ON 17
 ud_8                -1.522324e-01 1 1  ON 18
 ud_9                -1.426806e-01 1 1  ON 19
 eO_0                -7.585487e-01 1 1  ON 20
 eO_1                -4.404471e-01 1 1  ON 21
 eO_2                -2.262614e-02 1 1  ON 22
 eO_3                 2.977211e-01 1 1  ON 23
 eO_4                 5.252401e-01 1 1  ON 24
 eO_5                 4.868676e-01 1 1  ON 25
 eO_6                 2.596675e-01 1 1  ON 26
 eO_7                -4.097529e-02 1 1  ON 27
 eO_8                -2.205193e-01 1 1  ON 28
 eO_9                -8.522655e-02 1 1  ON 29
eH1_0                -2.413778e-01 1 1  ON 30
eH1_1                -1.439343e-01 1 1  ON 31
eH1_2                -9.913949e-02 1 1  ON 32
eH1_3                -4.537267e-02 1 1  ON 33
eH1_4                 2.801574e-03 1 1  ON 34
eH1_5                 3.790062e-02 1 1  ON 35
eH1_6                 9.706685e-02 1 1  ON 36
eH1_7                 1.536997e-01 1 1  ON 37
eH1_8                 1.760440e-01 1 1  ON 38
eH1_9                 6.637455e-02 1 1  ON 39
eH2_0                -2.394649e-01 1 1  ON 40
eH2_1                -1.419071e-01 1 1  ON 41
eH2_2                -9.679290e-02 1 1  ON 42
eH2_3                -4.309426e-02 1 1  ON 43
eH2_4                 5.133706e-03 1 1  ON 44
eH2_5                 3.979276e-02 1 1  ON 45
eH2_6                 9.958605e-02 1 1  ON 46
eH2_7                 1.556193e-01 1 1  ON 47
eH2_8                 1.820218e-01 1 1  ON 48
eH2_9                 5.577386e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.873
    reference variance = 0.128656
====================================================
  Execution time = 2.0014e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3414e-01
  Total weights = 2.0000e+06
  Execution time = 1.8590e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334192397661
                                         uncertainty =       0.002818329842

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334192397661
                                         uncertainty =       0.002818329842

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408740019
  error estimate for blocks of size 2^( 2) =       0.000421143507
  error estimate for blocks of size 2^( 3) =       0.000433905446
  error estimate for blocks of size 2^( 4) =       0.000445905636
  error estimate for blocks of size 2^( 5) =       0.000456483433
  error estimate for blocks of size 2^( 6) =       0.000465310425
  error estimate for blocks of size 2^( 7) =       0.000472385468

      target function =                  N/A
              le_mean =     -16.905454793528
             les_mean =     286.128538414640
             stat err =       0.000460021241
             autocorr =       1.266664062501
              std dev =       0.578045677863
             le_variance =       0.334136805696

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334191347755
                                         uncertainty =       0.002818332516

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334191347755
                                         uncertainty =       0.002818332516

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408739376
  error estimate for blocks of size 2^( 2) =       0.000421142792
  error estimate for blocks of size 2^( 3) =       0.000433904645
  error estimate for blocks of size 2^( 4) =       0.000445904699
  error estimate for blocks of size 2^( 5) =       0.000456482546
  error estimate for blocks of size 2^( 6) =       0.000465309453
  error estimate for blocks of size 2^( 7) =       0.000472384449

      target function =                  N/A
              le_mean =     -16.905454803073
             les_mean =     286.128537686619
             stat err =       0.000460020287
             autocorr =       1.266662791909
              std dev =       0.578044768981
             le_variance =       0.334135754947

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334191856318
                                         uncertainty =       0.002818330972

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334191856318
                                         uncertainty =       0.002818330972

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408739687
  error estimate for blocks of size 2^( 2) =       0.000421143139
  error estimate for blocks of size 2^( 3) =       0.000433905035
  error estimate for blocks of size 2^( 4) =       0.000445905157
  error estimate for blocks of size 2^( 5) =       0.000456482979
  error estimate for blocks of size 2^( 6) =       0.000465309929
  error estimate for blocks of size 2^( 7) =       0.000472384947

      target function =                  N/A
              le_mean =     -16.905454798143
             les_mean =     286.128538028926
             stat err =       0.000460020753
             autocorr =       1.266663431721
              std dev =       0.578045209254
             le_variance =       0.334136263942

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334192329442
                                         uncertainty =       0.002818329977

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334192329442
                                         uncertainty =       0.002818329977

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408739977
  error estimate for blocks of size 2^( 2) =       0.000421143461
  error estimate for blocks of size 2^( 3) =       0.000433905395
  error estimate for blocks of size 2^( 4) =       0.000445905576
  error estimate for blocks of size 2^( 5) =       0.000456483376
  error estimate for blocks of size 2^( 6) =       0.000465310363
  error estimate for blocks of size 2^( 7) =       0.000472385403

      target function =                  N/A
              le_mean =     -16.905454794095
             les_mean =     286.128538365560
             stat err =       0.000460021179
             autocorr =       1.266663983788
              std dev =       0.578045618811
             le_variance =       0.334136737427


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905454793528        initial
     2.3283e+01     2.3283e+02             9.3306e-06       -16.905454803073  <--
     9.3132e+01     9.3132e+02             2.3435e-06       -16.905454798143
     3.7253e+02     3.7253e+03             5.8656e-07       -16.905454794095

*****************************************************************************
Applying the update for shift_i =   2.3283e+01     and shift_s =   2.3283e+02
*****************************************************************************

  Execution time = 2.9443e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.093566e-01 1 1  ON 0
 uu_1                 1.425313e-01 1 1  ON 1
 uu_2                 4.087270e-02 1 1  ON 2
 uu_3                -2.151444e-02 1 1  ON 3
 uu_4                -6.689946e-02 1 1  ON 4
 uu_5                -1.013442e-01 1 1  ON 5
 uu_6                -1.281984e-01 1 1  ON 6
 uu_7                -1.409870e-01 1 1  ON 7
 uu_8                -1.329183e-01 1 1  ON 8
 uu_9                -1.043873e-01 1 1  ON 9
 ud_0                 4.443306e-01 1 1  ON 10
 ud_1                 1.801455e-01 1 1  ON 11
 ud_2                 6.331748e-02 1 1  ON 12
 ud_3                -6.171999e-03 1 1  ON 13
 ud_4                -6.410579e-02 1 1  ON 14
 ud_5                -1.067147e-01 1 1  ON 15
 ud_6                -1.344291e-01 1 1  ON 16
 ud_7                -1.516536e-01 1 1  ON 17
 ud_8                -1.522373e-01 1 1  ON 18
 ud_9                -1.426841e-01 1 1  ON 19
 eO_0                -7.585493e-01 1 1  ON 20
 eO_1                -4.404472e-01 1 1  ON 21
 eO_2                -2.262226e-02 1 1  ON 22
 eO_3                 2.977210e-01 1 1  ON 23
 eO_4                 5.252405e-01 1 1  ON 24
 eO_5                 4.868693e-01 1 1  ON 25
 eO_6                 2.596697e-01 1 1  ON 26
 eO_7                -4.097373e-02 1 1  ON 27
 eO_8                -2.205233e-01 1 1  ON 28
 eO_9                -8.523086e-02 1 1  ON 29
eH1_0                -2.413798e-01 1 1  ON 30
eH1_1                -1.439391e-01 1 1  ON 31
eH1_2                -9.914324e-02 1 1  ON 32
eH1_3                -4.537340e-02 1 1  ON 33
eH1_4                 2.805870e-03 1 1  ON 34
eH1_5                 3.789915e-02 1 1  ON 35
eH1_6                 9.706407e-02 1 1  ON 36
eH1_7                 1.536996e-01 1 1  ON 37
eH1_8                 1.760488e-01 1 1  ON 38
eH1_9                 6.638055e-02 1 1  ON 39
eH2_0                -2.394664e-01 1 1  ON 40
eH2_1                -1.419141e-01 1 1  ON 41
eH2_2                -9.679437e-02 1 1  ON 42
eH2_3                -4.309360e-02 1 1  ON 43
eH2_4                 5.135254e-03 1 1  ON 44
eH2_5                 3.979285e-02 1 1  ON 45
eH2_6                 9.958356e-02 1 1  ON 46
eH2_7                 1.556178e-01 1 1  ON 47
eH2_8                 1.820260e-01 1 1  ON 48
eH2_9                 5.578028e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5542e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.8385
    reference variance = 0.374518
====================================================
  Execution time = 2.0308e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4486e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5684e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344815786756
                                         uncertainty =       0.005472995550

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344815786756
                                         uncertainty =       0.005472995550

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415247456
  error estimate for blocks of size 2^( 2) =       0.000428005565
  error estimate for blocks of size 2^( 3) =       0.000440999401
  error estimate for blocks of size 2^( 4) =       0.000453002247
  error estimate for blocks of size 2^( 5) =       0.000463989786
  error estimate for blocks of size 2^( 6) =       0.000472067314
  error estimate for blocks of size 2^( 7) =       0.000474974330

      target function =                  N/A
              le_mean =     -16.905245666882
             les_mean =     286.132191785048
             stat err =       0.000466008419
             autocorr =       1.259428639592
              std dev =       0.587248584359
             le_variance =       0.344860899831


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690524566688e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+00, overlap shift 5.8208e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905245666882       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905245747114       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905245849997       residual = 9.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905245890445       residual = 6.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905245853112       residual = 3.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905245870683       residual = 6.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905245879067       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905245878575       residual = 4.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+00 is 3.535525e-05

solving harmonic davidson linear method for identity shift 2.3283e+01, overlap shift 2.3283e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905245666882       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905245687381       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905245713804       residual = 9.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905245724295       residual = 6.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905245714397       residual = 3.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905245718355       residual = 6.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905245720027       residual = 9.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+01 is 8.450181e-06

solving harmonic davidson linear method for identity shift 9.3132e+01, overlap shift 9.3132e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905245666882       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905245672035       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905245678687       residual = 9.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905245681335       residual = 6.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905245678823       residual = 3.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905245679783       residual = 5.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905245680172       residual = 9.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+01 is 2.114924e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.344185 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5887e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.093557e-01 1 1  ON 0
 uu_1                 1.425346e-01 1 1  ON 1
 uu_2                 4.087139e-02 1 1  ON 2
 uu_3                -2.151301e-02 1 1  ON 3
 uu_4                -6.689687e-02 1 1  ON 4
 uu_5                -1.013415e-01 1 1  ON 5
 uu_6                -1.282043e-01 1 1  ON 6
 uu_7                -1.409924e-01 1 1  ON 7
 uu_8                -1.329189e-01 1 1  ON 8
 uu_9                -1.043897e-01 1 1  ON 9
 ud_0                 4.443309e-01 1 1  ON 10
 ud_1                 1.801491e-01 1 1  ON 11
 ud_2                 6.331538e-02 1 1  ON 12
 ud_3                -6.168659e-03 1 1  ON 13
 ud_4                -6.410638e-02 1 1  ON 14
 ud_5                -1.067147e-01 1 1  ON 15
 ud_6                -1.344281e-01 1 1  ON 16
 ud_7                -1.516539e-01 1 1  ON 17
 ud_8                -1.522389e-01 1 1  ON 18
 ud_9                -1.426849e-01 1 1  ON 19
 eO_0                -7.585533e-01 1 1  ON 20
 eO_1                -4.404453e-01 1 1  ON 21
 eO_2                -2.261878e-02 1 1  ON 22
 eO_3                 2.977196e-01 1 1  ON 23
 eO_4                 5.252403e-01 1 1  ON 24
 eO_5                 4.868772e-01 1 1  ON 25
 eO_6                 2.596708e-01 1 1  ON 26
 eO_7                -4.097198e-02 1 1  ON 27
 eO_8                -2.205271e-01 1 1  ON 28
 eO_9                -8.523633e-02 1 1  ON 29
eH1_0                -2.413846e-01 1 1  ON 30
eH1_1                -1.439434e-01 1 1  ON 31
eH1_2                -9.914724e-02 1 1  ON 32
eH1_3                -4.537133e-02 1 1  ON 33
eH1_4                 2.803973e-03 1 1  ON 34
eH1_5                 3.789445e-02 1 1  ON 35
eH1_6                 9.706263e-02 1 1  ON 36
eH1_7                 1.537015e-01 1 1  ON 37
eH1_8                 1.760563e-01 1 1  ON 38
eH1_9                 6.638900e-02 1 1  ON 39
eH2_0                -2.394740e-01 1 1  ON 40
eH2_1                -1.419143e-01 1 1  ON 41
eH2_2                -9.679500e-02 1 1  ON 42
eH2_3                -4.309805e-02 1 1  ON 43
eH2_4                 5.137893e-03 1 1  ON 44
eH2_5                 3.979528e-02 1 1  ON 45
eH2_6                 9.958279e-02 1 1  ON 46
eH2_7                 1.556169e-01 1 1  ON 47
eH2_8                 1.820288e-01 1 1  ON 48
eH2_9                 5.578662e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.8794
    reference variance = 0.239465
====================================================
  Execution time = 1.9934e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3869e-01
  Total weights = 2.0000e+06
  Execution time = 1.8655e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338680675302
                                         uncertainty =       0.003414592676

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338680675302
                                         uncertainty =       0.003414592676

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411515289
  error estimate for blocks of size 2^( 2) =       0.000423779065
  error estimate for blocks of size 2^( 3) =       0.000436600328
  error estimate for blocks of size 2^( 4) =       0.000448365325
  error estimate for blocks of size 2^( 5) =       0.000458620351
  error estimate for blocks of size 2^( 6) =       0.000466080735
  error estimate for blocks of size 2^( 7) =       0.000469627175

      target function =                  N/A
              le_mean =     -16.906232267362
             les_mean =     286.159378974772
             stat err =       0.000460673396
             autocorr =       1.253182482081
              std dev =       0.581970502795
             le_variance =       0.338689666123

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338686044977
                                         uncertainty =       0.003414321016

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338686044977
                                         uncertainty =       0.003414321016

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411518535
  error estimate for blocks of size 2^( 2) =       0.000423781983
  error estimate for blocks of size 2^( 3) =       0.000436602952
  error estimate for blocks of size 2^( 4) =       0.000448367637
  error estimate for blocks of size 2^( 5) =       0.000458622073
  error estimate for blocks of size 2^( 6) =       0.000466082352
  error estimate for blocks of size 2^( 7) =       0.000469628257

      target function =                  N/A
              le_mean =     -16.906232278825
             les_mean =     286.159384705072
             stat err =       0.000460675080
             autocorr =       1.253171872513
              std dev =       0.581975092962
             le_variance =       0.338695008828

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338682989249
                                         uncertainty =       0.003414438857

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338682989249
                                         uncertainty =       0.003414438857

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411516686
  error estimate for blocks of size 2^( 2) =       0.000423780296
  error estimate for blocks of size 2^( 3) =       0.000436601414
  error estimate for blocks of size 2^( 4) =       0.000448366252
  error estimate for blocks of size 2^( 5) =       0.000458620960
  error estimate for blocks of size 2^( 6) =       0.000466081300
  error estimate for blocks of size 2^( 7) =       0.000469627454

      target function =                  N/A
              le_mean =     -16.906232272749
             les_mean =     286.159381456451
             stat err =       0.000460673991
             autocorr =       1.253177210391
              std dev =       0.581972478428
             le_variance =       0.338691965648

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338680969154
                                         uncertainty =       0.003414573081

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338680969154
                                         uncertainty =       0.003414573081

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411515466
  error estimate for blocks of size 2^( 2) =       0.000423779221
  error estimate for blocks of size 2^( 3) =       0.000436600465
  error estimate for blocks of size 2^( 4) =       0.000448365442
  error estimate for blocks of size 2^( 5) =       0.000458620428
  error estimate for blocks of size 2^( 6) =       0.000466080806
  error estimate for blocks of size 2^( 7) =       0.000469627210

      target function =                  N/A
              le_mean =     -16.906232268134
             les_mean =     286.159379292887
             stat err =       0.000460673472
             autocorr =       1.253181811583
              std dev =       0.581970753686
             le_variance =       0.338689958146


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906232267362        initial
     5.8208e+00     5.8208e+01             3.5355e-05       -16.906232278825  <--
     2.3283e+01     2.3283e+02             8.4502e-06       -16.906232272749
     9.3132e+01     9.3132e+02             2.1149e-06       -16.906232268134

*****************************************************************************
Applying the update for shift_i =   5.8208e+00     and shift_s =   5.8208e+01
*****************************************************************************

  Execution time = 2.9379e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.093535e-01 1 1  ON 0
 uu_1                 1.425441e-01 1 1  ON 1
 uu_2                 4.086803e-02 1 1  ON 2
 uu_3                -2.151023e-02 1 1  ON 3
 uu_4                -6.688974e-02 1 1  ON 4
 uu_5                -1.013346e-01 1 1  ON 5
 uu_6                -1.282208e-01 1 1  ON 6
 uu_7                -1.410080e-01 1 1  ON 7
 uu_8                -1.329207e-01 1 1  ON 8
 uu_9                -1.043975e-01 1 1  ON 9
 ud_0                 4.443327e-01 1 1  ON 10
 ud_1                 1.801585e-01 1 1  ON 11
 ud_2                 6.331022e-02 1 1  ON 12
 ud_3                -6.158449e-03 1 1  ON 13
 ud_4                -6.410761e-02 1 1  ON 14
 ud_5                -1.067159e-01 1 1  ON 15
 ud_6                -1.344256e-01 1 1  ON 16
 ud_7                -1.516543e-01 1 1  ON 17
 ud_8                -1.522434e-01 1 1  ON 18
 ud_9                -1.426875e-01 1 1  ON 19
 eO_0                -7.585641e-01 1 1  ON 20
 eO_1                -4.404405e-01 1 1  ON 21
 eO_2                -2.260999e-02 1 1  ON 22
 eO_3                 2.977169e-01 1 1  ON 23
 eO_4                 5.252401e-01 1 1  ON 24
 eO_5                 4.869010e-01 1 1  ON 25
 eO_6                 2.596746e-01 1 1  ON 26
 eO_7                -4.096607e-02 1 1  ON 27
 eO_8                -2.205393e-01 1 1  ON 28
 eO_9                -8.525374e-02 1 1  ON 29
eH1_0                -2.413996e-01 1 1  ON 30
eH1_1                -1.439576e-01 1 1  ON 31
eH1_2                -9.915868e-02 1 1  ON 32
eH1_3                -4.536585e-02 1 1  ON 33
eH1_4                 2.797896e-03 1 1  ON 34
eH1_5                 3.788048e-02 1 1  ON 35
eH1_6                 9.705793e-02 1 1  ON 36
eH1_7                 1.537073e-01 1 1  ON 37
eH1_8                 1.760799e-01 1 1  ON 38
eH1_9                 6.641590e-02 1 1  ON 39
eH2_0                -2.394963e-01 1 1  ON 40
eH2_1                -1.419147e-01 1 1  ON 41
eH2_2                -9.679933e-02 1 1  ON 42
eH2_3                -4.311084e-02 1 1  ON 43
eH2_4                 5.144404e-03 1 1  ON 44
eH2_5                 3.980217e-02 1 1  ON 45
eH2_6                 9.958073e-02 1 1  ON 46
eH2_7                 1.556146e-01 1 1  ON 47
eH2_8                 1.820379e-01 1 1  ON 48
eH2_9                 5.580687e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5271e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.887
    reference variance = 0.277749
====================================================
  Execution time = 2.0726e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3909e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5668e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339086003959
                                         uncertainty =       0.003268717725

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339086003959
                                         uncertainty =       0.003268717725

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411758420
  error estimate for blocks of size 2^( 2) =       0.000424862073
  error estimate for blocks of size 2^( 3) =       0.000438219271
  error estimate for blocks of size 2^( 4) =       0.000451660980
  error estimate for blocks of size 2^( 5) =       0.000462806551
  error estimate for blocks of size 2^( 6) =       0.000470318035
  error estimate for blocks of size 2^( 7) =       0.000474504450

      target function =                  N/A
              le_mean =     -16.904986177459
             les_mean =     286.117647483622
             stat err =       0.000464822504
             autocorr =       1.274351733300
              std dev =       0.582314342151
             le_variance =       0.339089993075


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690498617746e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+00, overlap shift 1.4552e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904986177459       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904986554112       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904986632731       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904986349038       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904986464346       residual = 6.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904986503664       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904986458458       residual = 3.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904986413323       residual = 5.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+00 is 1.794512e-04

solving harmonic davidson linear method for identity shift 5.8208e+00, overlap shift 5.8208e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904986177459       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904986279618       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904986293476       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904986221542       residual = 9.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904986255053       residual = 6.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904986264811       residual = 5.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904986247513       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904986240972       residual = 3.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+00 is 4.655807e-05

solving harmonic davidson linear method for identity shift 2.3283e+01, overlap shift 2.3283e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904986177459       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904986203553       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904986206549       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904986188537       residual = 9.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904986197223       residual = 6.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904986199713       residual = 4.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904986194866       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904986193699       residual = 2.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+01 is 1.175497e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.346923 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6304e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.093390e-01 1 1  ON 0
 uu_1                 1.425479e-01 1 1  ON 1
 uu_2                 4.087951e-02 1 1  ON 2
 uu_3                -2.151022e-02 1 1  ON 3
 uu_4                -6.689733e-02 1 1  ON 4
 uu_5                -1.013355e-01 1 1  ON 5
 uu_6                -1.282141e-01 1 1  ON 6
 uu_7                -1.410546e-01 1 1  ON 7
 uu_8                -1.329313e-01 1 1  ON 8
 uu_9                -1.043861e-01 1 1  ON 9
 ud_0                 4.443323e-01 1 1  ON 10
 ud_1                 1.801388e-01 1 1  ON 11
 ud_2                 6.329971e-02 1 1  ON 12
 ud_3                -6.160722e-03 1 1  ON 13
 ud_4                -6.410811e-02 1 1  ON 14
 ud_5                -1.067038e-01 1 1  ON 15
 ud_6                -1.344416e-01 1 1  ON 16
 ud_7                -1.516429e-01 1 1  ON 17
 ud_8                -1.522303e-01 1 1  ON 18
 ud_9                -1.426685e-01 1 1  ON 19
 eO_0                -7.585589e-01 1 1  ON 20
 eO_1                -4.404416e-01 1 1  ON 21
 eO_2                -2.261659e-02 1 1  ON 22
 eO_3                 2.977215e-01 1 1  ON 23
 eO_4                 5.252339e-01 1 1  ON 24
 eO_5                 4.869313e-01 1 1  ON 25
 eO_6                 2.596782e-01 1 1  ON 26
 eO_7                -4.096707e-02 1 1  ON 27
 eO_8                -2.205501e-01 1 1  ON 28
 eO_9                -8.526924e-02 1 1  ON 29
eH1_0                -2.414153e-01 1 1  ON 30
eH1_1                -1.439844e-01 1 1  ON 31
eH1_2                -9.918189e-02 1 1  ON 32
eH1_3                -4.537699e-02 1 1  ON 33
eH1_4                 2.819439e-03 1 1  ON 34
eH1_5                 3.784229e-02 1 1  ON 35
eH1_6                 9.704431e-02 1 1  ON 36
eH1_7                 1.537322e-01 1 1  ON 37
eH1_8                 1.761157e-01 1 1  ON 38
eH1_9                 6.645452e-02 1 1  ON 39
eH2_0                -2.395109e-01 1 1  ON 40
eH2_1                -1.418953e-01 1 1  ON 41
eH2_2                -9.682099e-02 1 1  ON 42
eH2_3                -4.312454e-02 1 1  ON 43
eH2_4                 5.132338e-03 1 1  ON 44
eH2_5                 3.980075e-02 1 1  ON 45
eH2_6                 9.956700e-02 1 1  ON 46
eH2_7                 1.556177e-01 1 1  ON 47
eH2_8                 1.820547e-01 1 1  ON 48
eH2_9                 5.583956e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.8978
    reference variance = 0.146195
====================================================
  Execution time = 2.0149e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.4327e-01
  Total weights = 2.0000e+06
  Execution time = 1.8644e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343285353463
                                         uncertainty =       0.004579784394

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343285353463
                                         uncertainty =       0.004579784394

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414286902
  error estimate for blocks of size 2^( 2) =       0.000427209853
  error estimate for blocks of size 2^( 3) =       0.000440287232
  error estimate for blocks of size 2^( 4) =       0.000452955404
  error estimate for blocks of size 2^( 5) =       0.000463528687
  error estimate for blocks of size 2^( 6) =       0.000470638309
  error estimate for blocks of size 2^( 7) =       0.000475423748

      target function =                  N/A
              le_mean =     -16.904407118767
             les_mean =     286.102247139704
             stat err =       0.000465636537
             autocorr =       1.263256947436
              std dev =       0.585890155492
             le_variance =       0.343267274303

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343297194003
                                         uncertainty =       0.004579954216

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343297194003
                                         uncertainty =       0.004579954216

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414294135
  error estimate for blocks of size 2^( 2) =       0.000427216713
  error estimate for blocks of size 2^( 3) =       0.000440293476
  error estimate for blocks of size 2^( 4) =       0.000452960951
  error estimate for blocks of size 2^( 5) =       0.000463533633
  error estimate for blocks of size 2^( 6) =       0.000470640659
  error estimate for blocks of size 2^( 7) =       0.000475422851

      target function =                  N/A
              le_mean =     -16.904407373800
             les_mean =     286.102267748023
             stat err =       0.000465639524
             autocorr =       1.263229045297
              std dev =       0.585900384269
             le_variance =       0.343279260287

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343295912758
                                         uncertainty =       0.004579928637

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343295912758
                                         uncertainty =       0.004579928637

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414293323
  error estimate for blocks of size 2^( 2) =       0.000427215892
  error estimate for blocks of size 2^( 3) =       0.000440292782
  error estimate for blocks of size 2^( 4) =       0.000452960513
  error estimate for blocks of size 2^( 5) =       0.000463533448
  error estimate for blocks of size 2^( 6) =       0.000470641527
  error estimate for blocks of size 2^( 7) =       0.000475425222

      target function =                  N/A
              le_mean =     -16.904407247958
             les_mean =     286.102262148242
             stat err =       0.000465640177
             autocorr =       1.263237541851
              std dev =       0.585899236286
             le_variance =       0.343277915080

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343286854941
                                         uncertainty =       0.004579804567

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343286854941
                                         uncertainty =       0.004579804567

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414287814
  error estimate for blocks of size 2^( 2) =       0.000427210709
  error estimate for blocks of size 2^( 3) =       0.000440288020
  error estimate for blocks of size 2^( 4) =       0.000452956133
  error estimate for blocks of size 2^( 5) =       0.000463529370
  error estimate for blocks of size 2^( 6) =       0.000470638789
  error estimate for blocks of size 2^( 7) =       0.000475424005

      target function =                  N/A
              le_mean =     -16.904407133501
             les_mean =     286.102249149803
             stat err =       0.000465637074
             autocorr =       1.263254297990
              std dev =       0.585891445828
             le_variance =       0.343268786294


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904407118767        initial
     1.4552e+00     1.4552e+01             1.7945e-04       -16.904407373800  <--
     5.8208e+00     5.8208e+01             4.6558e-05       -16.904407247958
     2.3283e+01     2.3283e+02             1.1755e-05       -16.904407133501

*****************************************************************************
Applying the update for shift_i =   1.4552e+00     and shift_s =   1.4552e+01
*****************************************************************************

  Execution time = 2.9587e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.093021e-01 1 1  ON 0
 uu_1                 1.425593e-01 1 1  ON 1
 uu_2                 4.090626e-02 1 1  ON 2
 uu_3                -2.151027e-02 1 1  ON 3
 uu_4                -6.691553e-02 1 1  ON 4
 uu_5                -1.013404e-01 1 1  ON 5
 uu_6                -1.281983e-01 1 1  ON 6
 uu_7                -1.411874e-01 1 1  ON 7
 uu_8                -1.329628e-01 1 1  ON 8
 uu_9                -1.043528e-01 1 1  ON 9
 ud_0                 4.443207e-01 1 1  ON 10
 ud_1                 1.800884e-01 1 1  ON 11
 ud_2                 6.327114e-02 1 1  ON 12
 ud_3                -6.168190e-03 1 1  ON 13
 ud_4                -6.410841e-02 1 1  ON 14
 ud_5                -1.066742e-01 1 1  ON 15
 ud_6                -1.344818e-01 1 1  ON 16
 ud_7                -1.516104e-01 1 1  ON 17
 ud_8                -1.521921e-01 1 1  ON 18
 ud_9                -1.426124e-01 1 1  ON 19
 eO_0                -7.585432e-01 1 1  ON 20
 eO_1                -4.404457e-01 1 1  ON 21
 eO_2                -2.263571e-02 1 1  ON 22
 eO_3                 2.977328e-01 1 1  ON 23
 eO_4                 5.252178e-01 1 1  ON 24
 eO_5                 4.870200e-01 1 1  ON 25
 eO_6                 2.596890e-01 1 1  ON 26
 eO_7                -4.097023e-02 1 1  ON 27
 eO_8                -2.205818e-01 1 1  ON 28
 eO_9                -8.531454e-02 1 1  ON 29
eH1_0                -2.414625e-01 1 1  ON 30
eH1_1                -1.440605e-01 1 1  ON 31
eH1_2                -9.924657e-02 1 1  ON 32
eH1_3                -4.541103e-02 1 1  ON 33
eH1_4                 2.877030e-03 1 1  ON 34
eH1_5                 3.773247e-02 1 1  ON 35
eH1_6                 9.700351e-02 1 1  ON 36
eH1_7                 1.538054e-01 1 1  ON 37
eH1_8                 1.762209e-01 1 1  ON 38
eH1_9                 6.656784e-02 1 1  ON 39
eH2_0                -2.395503e-01 1 1  ON 40
eH2_1                -1.418495e-01 1 1  ON 41
eH2_2                -9.687997e-02 1 1  ON 42
eH2_3                -4.316271e-02 1 1  ON 43
eH2_4                 5.096365e-03 1 1  ON 44
eH2_5                 3.979714e-02 1 1  ON 45
eH2_6                 9.952723e-02 1 1  ON 46
eH2_7                 1.556269e-01 1 1  ON 47
eH2_8                 1.821044e-01 1 1  ON 48
eH2_9                 5.593540e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5897e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.9578
    reference variance = 0.287796
====================================================
  Execution time = 2.0060e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4351e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4679e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343646878181
                                         uncertainty =       0.004761005886

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343646878181
                                         uncertainty =       0.004761005886

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414432008
  error estimate for blocks of size 2^( 2) =       0.000427346576
  error estimate for blocks of size 2^( 3) =       0.000440341680
  error estimate for blocks of size 2^( 4) =       0.000452358050
  error estimate for blocks of size 2^( 5) =       0.000462876506
  error estimate for blocks of size 2^( 6) =       0.000470448267
  error estimate for blocks of size 2^( 7) =       0.000474144857

      target function =                  N/A
              le_mean =     -16.906213950436
             les_mean =     286.163577744897
             stat err =       0.000464956920
             autocorr =       1.258690199983
              std dev =       0.586095366589
             le_variance =       0.343507778737


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690621395044e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e-01, overlap shift 3.6380e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906213950436       residual = 6.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906212309089       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906211653124       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906211269898       residual = 6.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906212739696       residual = 3.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906213544501       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906213229168       residual = 8.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906213218130       residual = 2.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906212963088       residual = 7.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e-01 is 4.566752e-04

solving harmonic davidson linear method for identity shift 1.4552e+00, overlap shift 1.4552e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906213950436       residual = 6.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906213404806       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906212811048       residual = 3.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906213165248       residual = 6.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906213368985       residual = 3.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906213373048       residual = 9.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906213376638       residual = 2.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906213330396       residual = 6.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+00 is 1.142853e-04

solving harmonic davidson linear method for identity shift 5.8208e+00, overlap shift 5.8208e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906213950436       residual = 6.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906213801775       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906213605934       residual = 4.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906213668866       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906213720789       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906213745809       residual = 6.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906213743196       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906213734439       residual = 3.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+00 is 2.902378e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.349840 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5539e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.092473e-01 1 1  ON 0
 uu_1                 1.425775e-01 1 1  ON 1
 uu_2                 4.097257e-02 1 1  ON 2
 uu_3                -2.148686e-02 1 1  ON 3
 uu_4                -6.692643e-02 1 1  ON 4
 uu_5                -1.013084e-01 1 1  ON 5
 uu_6                -1.282167e-01 1 1  ON 6
 uu_7                -1.412658e-01 1 1  ON 7
 uu_8                -1.330712e-01 1 1  ON 8
 uu_9                -1.043638e-01 1 1  ON 9
 ud_0                 4.442885e-01 1 1  ON 10
 ud_1                 1.801454e-01 1 1  ON 11
 ud_2                 6.328671e-02 1 1  ON 12
 ud_3                -6.125441e-03 1 1  ON 13
 ud_4                -6.408391e-02 1 1  ON 14
 ud_5                -1.066236e-01 1 1  ON 15
 ud_6                -1.344956e-01 1 1  ON 16
 ud_7                -1.515428e-01 1 1  ON 17
 ud_8                -1.521797e-01 1 1  ON 18
 ud_9                -1.426957e-01 1 1  ON 19
 eO_0                -7.585470e-01 1 1  ON 20
 eO_1                -4.404359e-01 1 1  ON 21
 eO_2                -2.257618e-02 1 1  ON 22
 eO_3                 2.977412e-01 1 1  ON 23
 eO_4                 5.251972e-01 1 1  ON 24
 eO_5                 4.870697e-01 1 1  ON 25
 eO_6                 2.597502e-01 1 1  ON 26
 eO_7                -4.095726e-02 1 1  ON 27
 eO_8                -2.206510e-01 1 1  ON 28
 eO_9                -8.540397e-02 1 1  ON 29
eH1_0                -2.415085e-01 1 1  ON 30
eH1_1                -1.440666e-01 1 1  ON 31
eH1_2                -9.922707e-02 1 1  ON 32
eH1_3                -4.544244e-02 1 1  ON 33
eH1_4                 2.862836e-03 1 1  ON 34
eH1_5                 3.765959e-02 1 1  ON 35
eH1_6                 9.700138e-02 1 1  ON 36
eH1_7                 1.537874e-01 1 1  ON 37
eH1_8                 1.762813e-01 1 1  ON 38
eH1_9                 6.667796e-02 1 1  ON 39
eH2_0                -2.395486e-01 1 1  ON 40
eH2_1                -1.419532e-01 1 1  ON 41
eH2_2                -9.691126e-02 1 1  ON 42
eH2_3                -4.314312e-02 1 1  ON 43
eH2_4                 5.120487e-03 1 1  ON 44
eH2_5                 3.976213e-02 1 1  ON 45
eH2_6                 9.948462e-02 1 1  ON 46
eH2_7                 1.556184e-01 1 1  ON 47
eH2_8                 1.821680e-01 1 1  ON 48
eH2_9                 5.604969e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.0087
    reference variance = 0.520773
====================================================
  Execution time = 1.9842e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3857e-01
  Total weights = 2.0000e+06
  Execution time = 1.8647e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338735414433
                                         uncertainty =       0.003975343029

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338735414433
                                         uncertainty =       0.003975343029

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411500453
  error estimate for blocks of size 2^( 2) =       0.000424550527
  error estimate for blocks of size 2^( 3) =       0.000437739279
  error estimate for blocks of size 2^( 4) =       0.000450301494
  error estimate for blocks of size 2^( 5) =       0.000462122829
  error estimate for blocks of size 2^( 6) =       0.000471080481
  error estimate for blocks of size 2^( 7) =       0.000475317316

      target function =                  N/A
              le_mean =     -16.904822507530
             les_mean =     286.111689087474
             stat err =       0.000464705530
             autocorr =       1.275307888635
              std dev =       0.581949521611
             le_variance =       0.338665245703

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338543246012
                                         uncertainty =       0.003969962123

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338543246012
                                         uncertainty =       0.003969962123

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411383735
  error estimate for blocks of size 2^( 2) =       0.000424435591
  error estimate for blocks of size 2^( 3) =       0.000437624302
  error estimate for blocks of size 2^( 4) =       0.000450189237
  error estimate for blocks of size 2^( 5) =       0.000462011774
  error estimate for blocks of size 2^( 6) =       0.000470976581
  error estimate for blocks of size 2^( 7) =       0.000475222549

      target function =                  N/A
              le_mean =     -16.904820787285
             les_mean =     286.111438836630
             stat err =       0.000464600035
             autocorr =       1.275452361398
              std dev =       0.581784458075
             le_variance =       0.338473155658

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338549843156
                                         uncertainty =       0.003970739363

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338549843156
                                         uncertainty =       0.003970739363

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411387743
  error estimate for blocks of size 2^( 2) =       0.000424440711
  error estimate for blocks of size 2^( 3) =       0.000437630858
  error estimate for blocks of size 2^( 4) =       0.000450195879
  error estimate for blocks of size 2^( 5) =       0.000462018958
  error estimate for blocks of size 2^( 6) =       0.000470982240
  error estimate for blocks of size 2^( 7) =       0.000475225033

      target function =                  N/A
              le_mean =     -16.904821449598
             les_mean =     286.111467823653
             stat err =       0.000464605528
             autocorr =       1.275457667426
              std dev =       0.581790125466
             le_variance =       0.338479750090

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338707068182
                                         uncertainty =       0.003974649514

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338707068182
                                         uncertainty =       0.003974649514

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411483239
  error estimate for blocks of size 2^( 2) =       0.000424533779
  error estimate for blocks of size 2^( 3) =       0.000437722778
  error estimate for blocks of size 2^( 4) =       0.000450285423
  error estimate for blocks of size 2^( 5) =       0.000462107027
  error estimate for blocks of size 2^( 6) =       0.000471065494
  error estimate for blocks of size 2^( 7) =       0.000475303142

      target function =                  N/A
              le_mean =     -16.904822369389
             les_mean =     286.111656082635
             stat err =       0.000464690272
             autocorr =       1.275330841909
              std dev =       0.581925176763
             le_variance =       0.338636911351


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904822507530        initial  <--
     3.6380e-01     3.6380e+00             4.5668e-04       -16.904820787285
     1.4552e+00     1.4552e+01             1.1429e-04       -16.904821449598
     5.8208e+00     5.8208e+01             2.9024e-05       -16.904822369389

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.2715
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.093021e-01 1 1  ON 0
 uu_1                 1.425593e-01 1 1  ON 1
 uu_2                 4.090626e-02 1 1  ON 2
 uu_3                -2.151027e-02 1 1  ON 3
 uu_4                -6.691553e-02 1 1  ON 4
 uu_5                -1.013404e-01 1 1  ON 5
 uu_6                -1.281983e-01 1 1  ON 6
 uu_7                -1.411874e-01 1 1  ON 7
 uu_8                -1.329628e-01 1 1  ON 8
 uu_9                -1.043528e-01 1 1  ON 9
 ud_0                 4.443207e-01 1 1  ON 10
 ud_1                 1.800884e-01 1 1  ON 11
 ud_2                 6.327114e-02 1 1  ON 12
 ud_3                -6.168190e-03 1 1  ON 13
 ud_4                -6.410841e-02 1 1  ON 14
 ud_5                -1.066742e-01 1 1  ON 15
 ud_6                -1.344818e-01 1 1  ON 16
 ud_7                -1.516104e-01 1 1  ON 17
 ud_8                -1.521921e-01 1 1  ON 18
 ud_9                -1.426124e-01 1 1  ON 19
 eO_0                -7.585432e-01 1 1  ON 20
 eO_1                -4.404457e-01 1 1  ON 21
 eO_2                -2.263571e-02 1 1  ON 22
 eO_3                 2.977328e-01 1 1  ON 23
 eO_4                 5.252178e-01 1 1  ON 24
 eO_5                 4.870200e-01 1 1  ON 25
 eO_6                 2.596890e-01 1 1  ON 26
 eO_7                -4.097023e-02 1 1  ON 27
 eO_8                -2.205818e-01 1 1  ON 28
 eO_9                -8.531454e-02 1 1  ON 29
eH1_0                -2.414625e-01 1 1  ON 30
eH1_1                -1.440605e-01 1 1  ON 31
eH1_2                -9.924657e-02 1 1  ON 32
eH1_3                -4.541103e-02 1 1  ON 33
eH1_4                 2.877030e-03 1 1  ON 34
eH1_5                 3.773247e-02 1 1  ON 35
eH1_6                 9.700351e-02 1 1  ON 36
eH1_7                 1.538054e-01 1 1  ON 37
eH1_8                 1.762209e-01 1 1  ON 38
eH1_9                 6.656784e-02 1 1  ON 39
eH2_0                -2.395503e-01 1 1  ON 40
eH2_1                -1.418495e-01 1 1  ON 41
eH2_2                -9.687997e-02 1 1  ON 42
eH2_3                -4.316271e-02 1 1  ON 43
eH2_4                 5.096365e-03 1 1  ON 44
eH2_5                 3.979714e-02 1 1  ON 45
eH2_6                 9.952723e-02 1 1  ON 46
eH2_7                 1.556269e-01 1 1  ON 47
eH2_8                 1.821044e-01 1 1  ON 48
eH2_9                 5.593540e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4816e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.8833
    reference variance = 0.502835
====================================================
  Execution time = 2.2497e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3926e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5197e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339144736339
                                         uncertainty =       0.004152006876

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339144736339
                                         uncertainty =       0.004152006876

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411862515
  error estimate for blocks of size 2^( 2) =       0.000424621125
  error estimate for blocks of size 2^( 3) =       0.000437875576
  error estimate for blocks of size 2^( 4) =       0.000450256804
  error estimate for blocks of size 2^( 5) =       0.000460610247
  error estimate for blocks of size 2^( 6) =       0.000466686595
  error estimate for blocks of size 2^( 7) =       0.000473638250

      target function =                  N/A
              le_mean =     -16.905650355210
             les_mean =     286.140275226042
             stat err =       0.000462797974
             autocorr =       1.262636568276
              std dev =       0.582461555019
             le_variance =       0.339261463075


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690565035521e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+00, overlap shift 3.6380e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905650355210       residual = 3.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905650369205       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905650236426       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905650176875       residual = 8.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905650155429       residual = 2.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905650264877       residual = 7.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905650311699       residual = 2.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905650295402       residual = 4.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+00 is 5.691329e-05

solving harmonic davidson linear method for identity shift 1.4552e+01, overlap shift 1.4552e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905650355210       residual = 3.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905650358868       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905650324855       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905650309228       residual = 8.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905650302817       residual = 2.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905650329780       residual = 6.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905650341483       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905650337504       residual = 3.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+01 is 1.426857e-05

solving harmonic davidson linear method for identity shift 5.8208e+01, overlap shift 5.8208e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905650355210       residual = 3.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905650356135       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905650347578       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905650343625       residual = 8.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905650341951       residual = 2.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905650348665       residual = 6.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905650351580       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905650350593       residual = 3.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+01 is 3.569845e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.352623 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8028e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.093047e-01 1 1  ON 0
 uu_1                 1.425562e-01 1 1  ON 1
 uu_2                 4.090619e-02 1 1  ON 2
 uu_3                -2.151790e-02 1 1  ON 3
 uu_4                -6.692193e-02 1 1  ON 4
 uu_5                -1.013434e-01 1 1  ON 5
 uu_6                -1.281970e-01 1 1  ON 6
 uu_7                -1.411937e-01 1 1  ON 7
 uu_8                -1.329609e-01 1 1  ON 8
 uu_9                -1.043463e-01 1 1  ON 9
 ud_0                 4.443166e-01 1 1  ON 10
 ud_1                 1.800904e-01 1 1  ON 11
 ud_2                 6.327513e-02 1 1  ON 12
 ud_3                -6.167997e-03 1 1  ON 13
 ud_4                -6.410462e-02 1 1  ON 14
 ud_5                -1.066780e-01 1 1  ON 15
 ud_6                -1.344852e-01 1 1  ON 16
 ud_7                -1.516118e-01 1 1  ON 17
 ud_8                -1.521938e-01 1 1  ON 18
 ud_9                -1.426064e-01 1 1  ON 19
 eO_0                -7.585403e-01 1 1  ON 20
 eO_1                -4.404589e-01 1 1  ON 21
 eO_2                -2.262886e-02 1 1  ON 22
 eO_3                 2.977367e-01 1 1  ON 23
 eO_4                 5.252183e-01 1 1  ON 24
 eO_5                 4.870287e-01 1 1  ON 25
 eO_6                 2.596908e-01 1 1  ON 26
 eO_7                -4.096903e-02 1 1  ON 27
 eO_8                -2.205854e-01 1 1  ON 28
 eO_9                -8.532233e-02 1 1  ON 29
eH1_0                -2.414641e-01 1 1  ON 30
eH1_1                -1.440621e-01 1 1  ON 31
eH1_2                -9.925251e-02 1 1  ON 32
eH1_3                -4.541922e-02 1 1  ON 33
eH1_4                 2.873908e-03 1 1  ON 34
eH1_5                 3.772823e-02 1 1  ON 35
eH1_6                 9.700088e-02 1 1  ON 36
eH1_7                 1.538055e-01 1 1  ON 37
eH1_8                 1.762320e-01 1 1  ON 38
eH1_9                 6.658211e-02 1 1  ON 39
eH2_0                -2.395513e-01 1 1  ON 40
eH2_1                -1.418602e-01 1 1  ON 41
eH2_2                -9.688858e-02 1 1  ON 42
eH2_3                -4.316574e-02 1 1  ON 43
eH2_4                 5.092133e-03 1 1  ON 44
eH2_5                 3.980076e-02 1 1  ON 45
eH2_6                 9.953009e-02 1 1  ON 46
eH2_7                 1.556293e-01 1 1  ON 47
eH2_8                 1.821076e-01 1 1  ON 48
eH2_9                 5.594841e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.9681
    reference variance = 0.762944
====================================================
  Execution time = 1.9717e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3530e-01
  Total weights = 2.0000e+06
  Execution time = 1.8747e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335242706704
                                         uncertainty =       0.003219118321

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335242706704
                                         uncertainty =       0.003219118321

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409456725
  error estimate for blocks of size 2^( 2) =       0.000421918072
  error estimate for blocks of size 2^( 3) =       0.000435136480
  error estimate for blocks of size 2^( 4) =       0.000447145524
  error estimate for blocks of size 2^( 5) =       0.000457653908
  error estimate for blocks of size 2^( 6) =       0.000464542948
  error estimate for blocks of size 2^( 7) =       0.000469318834

      target function =                  N/A
              le_mean =     -16.905706395022
             les_mean =     286.138218166798
             stat err =       0.000459665303
             autocorr =       1.260281117794
              std dev =       0.579059254113
             le_variance =       0.335309619774

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335224883190
                                         uncertainty =       0.003219041618

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335224883190
                                         uncertainty =       0.003219041618

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409445842
  error estimate for blocks of size 2^( 2) =       0.000421908037
  error estimate for blocks of size 2^( 3) =       0.000435127012
  error estimate for blocks of size 2^( 4) =       0.000447136201
  error estimate for blocks of size 2^( 5) =       0.000457644489
  error estimate for blocks of size 2^( 6) =       0.000464533270
  error estimate for blocks of size 2^( 7) =       0.000469309057

      target function =                  N/A
              le_mean =     -16.905706094542
             les_mean =     286.138190182405
             stat err =       0.000459655754
             autocorr =       1.260295752254
              std dev =       0.579043862780
             le_variance =       0.335291795023

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335232695300
                                         uncertainty =       0.003219079119

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335232695300
                                         uncertainty =       0.003219079119

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409450612
  error estimate for blocks of size 2^( 2) =       0.000421912422
  error estimate for blocks of size 2^( 3) =       0.000435131147
  error estimate for blocks of size 2^( 4) =       0.000447140289
  error estimate for blocks of size 2^( 5) =       0.000457648633
  error estimate for blocks of size 2^( 6) =       0.000464537566
  error estimate for blocks of size 2^( 7) =       0.000469313401

      target function =                  N/A
              le_mean =     -16.905706233714
             les_mean =     286.138202700660
             stat err =       0.000459659972
             autocorr =       1.260289515877
              std dev =       0.579050608899
             le_variance =       0.335299607666

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335241415813
                                         uncertainty =       0.003219113406

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335241415813
                                         uncertainty =       0.003219113406

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409455937
  error estimate for blocks of size 2^( 2) =       0.000421917343
  error estimate for blocks of size 2^( 3) =       0.000435135792
  error estimate for blocks of size 2^( 4) =       0.000447144849
  error estimate for blocks of size 2^( 5) =       0.000457653228
  error estimate for blocks of size 2^( 6) =       0.000464542255
  error estimate for blocks of size 2^( 7) =       0.000469318135

      target function =                  N/A
              le_mean =     -16.905706374323
             les_mean =     286.138216175960
             stat err =       0.000459664617
             autocorr =       1.260282205342
              std dev =       0.579058139388
             le_variance =       0.335308328791


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905706395022        initial  <--
     3.6380e+00     3.6380e+01             5.6913e-05       -16.905706094542
     1.4552e+01     1.4552e+02             1.4269e-05       -16.905706233714
     5.8208e+01     5.8208e+02             3.5698e-06       -16.905706374323

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.1222
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.093021e-01 1 1  ON 0
 uu_1                 1.425593e-01 1 1  ON 1
 uu_2                 4.090626e-02 1 1  ON 2
 uu_3                -2.151027e-02 1 1  ON 3
 uu_4                -6.691553e-02 1 1  ON 4
 uu_5                -1.013404e-01 1 1  ON 5
 uu_6                -1.281983e-01 1 1  ON 6
 uu_7                -1.411874e-01 1 1  ON 7
 uu_8                -1.329628e-01 1 1  ON 8
 uu_9                -1.043528e-01 1 1  ON 9
 ud_0                 4.443207e-01 1 1  ON 10
 ud_1                 1.800884e-01 1 1  ON 11
 ud_2                 6.327114e-02 1 1  ON 12
 ud_3                -6.168190e-03 1 1  ON 13
 ud_4                -6.410841e-02 1 1  ON 14
 ud_5                -1.066742e-01 1 1  ON 15
 ud_6                -1.344818e-01 1 1  ON 16
 ud_7                -1.516104e-01 1 1  ON 17
 ud_8                -1.521921e-01 1 1  ON 18
 ud_9                -1.426124e-01 1 1  ON 19
 eO_0                -7.585432e-01 1 1  ON 20
 eO_1                -4.404457e-01 1 1  ON 21
 eO_2                -2.263571e-02 1 1  ON 22
 eO_3                 2.977328e-01 1 1  ON 23
 eO_4                 5.252178e-01 1 1  ON 24
 eO_5                 4.870200e-01 1 1  ON 25
 eO_6                 2.596890e-01 1 1  ON 26
 eO_7                -4.097023e-02 1 1  ON 27
 eO_8                -2.205818e-01 1 1  ON 28
 eO_9                -8.531454e-02 1 1  ON 29
eH1_0                -2.414625e-01 1 1  ON 30
eH1_1                -1.440605e-01 1 1  ON 31
eH1_2                -9.924657e-02 1 1  ON 32
eH1_3                -4.541103e-02 1 1  ON 33
eH1_4                 2.877030e-03 1 1  ON 34
eH1_5                 3.773247e-02 1 1  ON 35
eH1_6                 9.700351e-02 1 1  ON 36
eH1_7                 1.538054e-01 1 1  ON 37
eH1_8                 1.762209e-01 1 1  ON 38
eH1_9                 6.656784e-02 1 1  ON 39
eH2_0                -2.395503e-01 1 1  ON 40
eH2_1                -1.418495e-01 1 1  ON 41
eH2_2                -9.687997e-02 1 1  ON 42
eH2_3                -4.316271e-02 1 1  ON 43
eH2_4                 5.096365e-03 1 1  ON 44
eH2_5                 3.979714e-02 1 1  ON 45
eH2_6                 9.952723e-02 1 1  ON 46
eH2_7                 1.556269e-01 1 1  ON 47
eH2_8                 1.821044e-01 1 1  ON 48
eH2_9                 5.593540e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7155e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.8965
    reference variance = 0.234755
====================================================
  Execution time = 2.2287e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3829e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5307e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338366671301
                                         uncertainty =       0.004272815084

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338366671301
                                         uncertainty =       0.004272815084

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411269563
  error estimate for blocks of size 2^( 2) =       0.000423758598
  error estimate for blocks of size 2^( 3) =       0.000436781437
  error estimate for blocks of size 2^( 4) =       0.000449183630
  error estimate for blocks of size 2^( 5) =       0.000459911864
  error estimate for blocks of size 2^( 6) =       0.000466987729
  error estimate for blocks of size 2^( 7) =       0.000472837575

      target function =                  N/A
              le_mean =     -16.905849913231
             les_mean =     286.146046425902
             stat err =       0.000462230199
             autocorr =       1.263174918647
              std dev =       0.581622993312
             le_variance =       0.338285306350


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690584991323e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+01, overlap shift 3.6380e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905849913231       residual = 3.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905849906749       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905849905644       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905849893571       residual = 3.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905849894869       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905849899015       residual = 5.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905849900562       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905849900715       residual = 3.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+01 is 5.612510e-06

solving harmonic davidson linear method for identity shift 1.4552e+02, overlap shift 1.4552e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905849913231       residual = 3.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905849911606       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905849911323       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905849908292       residual = 3.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905849908614       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905849909632       residual = 5.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905849910014       residual = 1.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905849910059       residual = 3.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+02 is 1.403637e-06

solving harmonic davidson linear method for identity shift 5.8208e+02, overlap shift 5.8208e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905849913231       residual = 3.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905849912825       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905849912753       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905849911995       residual = 3.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905849912074       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905849912328       residual = 5.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905849912424       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905849912435       residual = 3.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+02 is 3.509409e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.355398 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7828e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.093019e-01 1 1  ON 0
 uu_1                 1.425596e-01 1 1  ON 1
 uu_2                 4.090718e-02 1 1  ON 2
 uu_3                -2.151038e-02 1 1  ON 3
 uu_4                -6.691495e-02 1 1  ON 4
 uu_5                -1.013411e-01 1 1  ON 5
 uu_6                -1.281985e-01 1 1  ON 6
 uu_7                -1.411879e-01 1 1  ON 7
 uu_8                -1.329633e-01 1 1  ON 8
 uu_9                -1.043533e-01 1 1  ON 9
 ud_0                 4.443213e-01 1 1  ON 10
 ud_1                 1.800887e-01 1 1  ON 11
 ud_2                 6.327161e-02 1 1  ON 12
 ud_3                -6.168260e-03 1 1  ON 13
 ud_4                -6.410819e-02 1 1  ON 14
 ud_5                -1.066737e-01 1 1  ON 15
 ud_6                -1.344818e-01 1 1  ON 16
 ud_7                -1.516104e-01 1 1  ON 17
 ud_8                -1.521920e-01 1 1  ON 18
 ud_9                -1.426132e-01 1 1  ON 19
 eO_0                -7.585428e-01 1 1  ON 20
 eO_1                -4.404461e-01 1 1  ON 21
 eO_2                -2.263525e-02 1 1  ON 22
 eO_3                 2.977329e-01 1 1  ON 23
 eO_4                 5.252178e-01 1 1  ON 24
 eO_5                 4.870206e-01 1 1  ON 25
 eO_6                 2.596893e-01 1 1  ON 26
 eO_7                -4.096958e-02 1 1  ON 27
 eO_8                -2.205826e-01 1 1  ON 28
 eO_9                -8.531567e-02 1 1  ON 29
eH1_0                -2.414631e-01 1 1  ON 30
eH1_1                -1.440614e-01 1 1  ON 31
eH1_2                -9.924630e-02 1 1  ON 32
eH1_3                -4.541131e-02 1 1  ON 33
eH1_4                 2.877232e-03 1 1  ON 34
eH1_5                 3.773194e-02 1 1  ON 35
eH1_6                 9.700326e-02 1 1  ON 36
eH1_7                 1.538052e-01 1 1  ON 37
eH1_8                 1.762217e-01 1 1  ON 38
eH1_9                 6.656925e-02 1 1  ON 39
eH2_0                -2.395500e-01 1 1  ON 40
eH2_1                -1.418502e-01 1 1  ON 41
eH2_2                -9.688083e-02 1 1  ON 42
eH2_3                -4.316324e-02 1 1  ON 43
eH2_4                 5.096508e-03 1 1  ON 44
eH2_5                 3.979757e-02 1 1  ON 45
eH2_6                 9.952724e-02 1 1  ON 46
eH2_7                 1.556268e-01 1 1  ON 47
eH2_8                 1.821050e-01 1 1  ON 48
eH2_9                 5.593637e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.9482
    reference variance = 0.244563
====================================================
  Execution time = 2.0083e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4560e-01
  Total weights = 2.0000e+06
  Execution time = 1.8574e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345686682709
                                         uncertainty =       0.006340849287

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345686682709
                                         uncertainty =       0.006340849287

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415689850
  error estimate for blocks of size 2^( 2) =       0.000427975531
  error estimate for blocks of size 2^( 3) =       0.000440874429
  error estimate for blocks of size 2^( 4) =       0.000452102544
  error estimate for blocks of size 2^( 5) =       0.000462484268
  error estimate for blocks of size 2^( 6) =       0.000468612480
  error estimate for blocks of size 2^( 7) =       0.000471264045

      target function =                  N/A
              le_mean =     -16.905522180155
             les_mean =     286.142276114316
             stat err =       0.000463615834
             autocorr =       1.243877693155
              std dev =       0.587874224139
             le_variance =       0.345596103407

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345686056533
                                         uncertainty =       0.006340859094

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345686056533
                                         uncertainty =       0.006340859094

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415689475
  error estimate for blocks of size 2^( 2) =       0.000427975161
  error estimate for blocks of size 2^( 3) =       0.000440874037
  error estimate for blocks of size 2^( 4) =       0.000452102156
  error estimate for blocks of size 2^( 5) =       0.000462483886
  error estimate for blocks of size 2^( 6) =       0.000468612130
  error estimate for blocks of size 2^( 7) =       0.000471263665

      target function =                  N/A
              le_mean =     -16.905522176281
             les_mean =     286.142275358441
             stat err =       0.000463615459
             autocorr =       1.243877929265
              std dev =       0.587873692646
             le_variance =       0.345595478506

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345686365092
                                         uncertainty =       0.006340854187

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345686365092
                                         uncertainty =       0.006340854187

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415689660
  error estimate for blocks of size 2^( 2) =       0.000427975343
  error estimate for blocks of size 2^( 3) =       0.000440874231
  error estimate for blocks of size 2^( 4) =       0.000452102348
  error estimate for blocks of size 2^( 5) =       0.000462484074
  error estimate for blocks of size 2^( 6) =       0.000468612303
  error estimate for blocks of size 2^( 7) =       0.000471263853

      target function =                  N/A
              le_mean =     -16.905522178201
             les_mean =     286.142275731273
             stat err =       0.000463615645
             autocorr =       1.243877815361
              std dev =       0.587873954546
             le_variance =       0.345595786434

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345686642851
                                         uncertainty =       0.006340849899

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345686642851
                                         uncertainty =       0.006340849899

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415689826
  error estimate for blocks of size 2^( 2) =       0.000427975507
  error estimate for blocks of size 2^( 3) =       0.000440874404
  error estimate for blocks of size 2^( 4) =       0.000452102520
  error estimate for blocks of size 2^( 5) =       0.000462484244
  error estimate for blocks of size 2^( 6) =       0.000468612458
  error estimate for blocks of size 2^( 7) =       0.000471264021

      target function =                  N/A
              le_mean =     -16.905522179909
             les_mean =     286.142276066216
             stat err =       0.000463615811
             autocorr =       1.243877708566
              std dev =       0.587874190307
             le_variance =       0.345596063629


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905522180155        initial  <--
     3.6380e+01     3.6380e+02             5.6125e-06       -16.905522176281
     1.4552e+02     1.4552e+03             1.4036e-06       -16.905522178201
     5.8208e+02     5.8208e+03             3.5094e-07       -16.905522179909

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4915
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.093021e-01 1 1  ON 0
 uu_1                 1.425593e-01 1 1  ON 1
 uu_2                 4.090626e-02 1 1  ON 2
 uu_3                -2.151027e-02 1 1  ON 3
 uu_4                -6.691553e-02 1 1  ON 4
 uu_5                -1.013404e-01 1 1  ON 5
 uu_6                -1.281983e-01 1 1  ON 6
 uu_7                -1.411874e-01 1 1  ON 7
 uu_8                -1.329628e-01 1 1  ON 8
 uu_9                -1.043528e-01 1 1  ON 9
 ud_0                 4.443207e-01 1 1  ON 10
 ud_1                 1.800884e-01 1 1  ON 11
 ud_2                 6.327114e-02 1 1  ON 12
 ud_3                -6.168190e-03 1 1  ON 13
 ud_4                -6.410841e-02 1 1  ON 14
 ud_5                -1.066742e-01 1 1  ON 15
 ud_6                -1.344818e-01 1 1  ON 16
 ud_7                -1.516104e-01 1 1  ON 17
 ud_8                -1.521921e-01 1 1  ON 18
 ud_9                -1.426124e-01 1 1  ON 19
 eO_0                -7.585432e-01 1 1  ON 20
 eO_1                -4.404457e-01 1 1  ON 21
 eO_2                -2.263571e-02 1 1  ON 22
 eO_3                 2.977328e-01 1 1  ON 23
 eO_4                 5.252178e-01 1 1  ON 24
 eO_5                 4.870200e-01 1 1  ON 25
 eO_6                 2.596890e-01 1 1  ON 26
 eO_7                -4.097023e-02 1 1  ON 27
 eO_8                -2.205818e-01 1 1  ON 28
 eO_9                -8.531454e-02 1 1  ON 29
eH1_0                -2.414625e-01 1 1  ON 30
eH1_1                -1.440605e-01 1 1  ON 31
eH1_2                -9.924657e-02 1 1  ON 32
eH1_3                -4.541103e-02 1 1  ON 33
eH1_4                 2.877030e-03 1 1  ON 34
eH1_5                 3.773247e-02 1 1  ON 35
eH1_6                 9.700351e-02 1 1  ON 36
eH1_7                 1.538054e-01 1 1  ON 37
eH1_8                 1.762209e-01 1 1  ON 38
eH1_9                 6.656784e-02 1 1  ON 39
eH2_0                -2.395503e-01 1 1  ON 40
eH2_1                -1.418495e-01 1 1  ON 41
eH2_2                -9.687997e-02 1 1  ON 42
eH2_3                -4.316271e-02 1 1  ON 43
eH2_4                 5.096365e-03 1 1  ON 44
eH2_5                 3.979714e-02 1 1  ON 45
eH2_6                 9.952723e-02 1 1  ON 46
eH2_7                 1.556269e-01 1 1  ON 47
eH2_8                 1.821044e-01 1 1  ON 48
eH2_9                 5.593540e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7325e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.9664
    reference variance = 0.260237
====================================================
  Execution time = 2.0075e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3883e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4454e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338929012840
                                         uncertainty =       0.003037446892

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338929012840
                                         uncertainty =       0.003037446892

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411602300
  error estimate for blocks of size 2^( 2) =       0.000424380783
  error estimate for blocks of size 2^( 3) =       0.000437201876
  error estimate for blocks of size 2^( 4) =       0.000448371523
  error estimate for blocks of size 2^( 5) =       0.000458733355
  error estimate for blocks of size 2^( 6) =       0.000464532099
  error estimate for blocks of size 2^( 7) =       0.000467800105

      target function =                  N/A
              le_mean =     -16.905098799941
             les_mean =     286.121198173706
             stat err =       0.000459859271
             autocorr =       1.248229107969
              std dev =       0.582093555495
             le_variance =       0.338832907349


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690509879994e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+02, overlap shift 3.6380e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905098799941       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905098801698       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905098802311       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905098802900       residual = 6.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905098803413       residual = 2.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905098803960       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905098803686       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905098803498       residual = 2.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+02 is 5.998213e-07

solving harmonic davidson linear method for identity shift 1.4552e+03, overlap shift 1.4552e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905098799941       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905098800381       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905098800534       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905098800680       residual = 6.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905098800810       residual = 2.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905098800947       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905098800878       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905098800831       residual = 2.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+03 is 1.499624e-07

solving harmonic davidson linear method for identity shift 5.8208e+03, overlap shift 5.8208e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905098799941       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905098800051       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905098800089       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905098800126       residual = 6.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905098800160       residual = 2.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905098800195       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905098800178       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905098800161       residual = 2.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+03 is 3.749105e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.358066 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5531e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.093021e-01 1 1  ON 0
 uu_1                 1.425593e-01 1 1  ON 1
 uu_2                 4.090627e-02 1 1  ON 2
 uu_3                -2.151032e-02 1 1  ON 3
 uu_4                -6.691552e-02 1 1  ON 4
 uu_5                -1.013404e-01 1 1  ON 5
 uu_6                -1.281983e-01 1 1  ON 6
 uu_7                -1.411875e-01 1 1  ON 7
 uu_8                -1.329628e-01 1 1  ON 8
 uu_9                -1.043528e-01 1 1  ON 9
 ud_0                 4.443208e-01 1 1  ON 10
 ud_1                 1.800885e-01 1 1  ON 11
 ud_2                 6.327117e-02 1 1  ON 12
 ud_3                -6.168097e-03 1 1  ON 13
 ud_4                -6.410844e-02 1 1  ON 14
 ud_5                -1.066742e-01 1 1  ON 15
 ud_6                -1.344818e-01 1 1  ON 16
 ud_7                -1.516105e-01 1 1  ON 17
 ud_8                -1.521922e-01 1 1  ON 18
 ud_9                -1.426124e-01 1 1  ON 19
 eO_0                -7.585433e-01 1 1  ON 20
 eO_1                -4.404458e-01 1 1  ON 21
 eO_2                -2.263563e-02 1 1  ON 22
 eO_3                 2.977329e-01 1 1  ON 23
 eO_4                 5.252178e-01 1 1  ON 24
 eO_5                 4.870201e-01 1 1  ON 25
 eO_6                 2.596891e-01 1 1  ON 26
 eO_7                -4.097023e-02 1 1  ON 27
 eO_8                -2.205819e-01 1 1  ON 28
 eO_9                -8.531463e-02 1 1  ON 29
eH1_0                -2.414626e-01 1 1  ON 30
eH1_1                -1.440605e-01 1 1  ON 31
eH1_2                -9.924658e-02 1 1  ON 32
eH1_3                -4.541105e-02 1 1  ON 33
eH1_4                 2.876977e-03 1 1  ON 34
eH1_5                 3.773253e-02 1 1  ON 35
eH1_6                 9.700346e-02 1 1  ON 36
eH1_7                 1.538054e-01 1 1  ON 37
eH1_8                 1.762210e-01 1 1  ON 38
eH1_9                 6.656795e-02 1 1  ON 39
eH2_0                -2.395503e-01 1 1  ON 40
eH2_1                -1.418496e-01 1 1  ON 41
eH2_2                -9.688003e-02 1 1  ON 42
eH2_3                -4.316274e-02 1 1  ON 43
eH2_4                 5.096287e-03 1 1  ON 44
eH2_5                 3.979718e-02 1 1  ON 45
eH2_6                 9.952724e-02 1 1  ON 46
eH2_7                 1.556270e-01 1 1  ON 47
eH2_8                 1.821045e-01 1 1  ON 48
eH2_9                 5.593552e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.8784
    reference variance = 0.191288
====================================================
  Execution time = 2.0143e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3931e-01
  Total weights = 2.0000e+06
  Execution time = 1.8738e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339176852192
                                         uncertainty =       0.004092181145

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339176852192
                                         uncertainty =       0.004092181145

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411893063
  error estimate for blocks of size 2^( 2) =       0.000424657368
  error estimate for blocks of size 2^( 3) =       0.000437946539
  error estimate for blocks of size 2^( 4) =       0.000450207698
  error estimate for blocks of size 2^( 5) =       0.000460032051
  error estimate for blocks of size 2^( 6) =       0.000468493158
  error estimate for blocks of size 2^( 7) =       0.000471978684

      target function =                  N/A
              le_mean =     -16.904984367331
             les_mean =     286.117808080476
             stat err =       0.000462677898
             autocorr =       1.261794273891
              std dev =       0.582504755718
             le_variance =       0.339311790434

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339177092544
                                         uncertainty =       0.004092184942

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339177092544
                                         uncertainty =       0.004092184942

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411893209
  error estimate for blocks of size 2^( 2) =       0.000424657502
  error estimate for blocks of size 2^( 3) =       0.000437946663
  error estimate for blocks of size 2^( 4) =       0.000450207815
  error estimate for blocks of size 2^( 5) =       0.000460032167
  error estimate for blocks of size 2^( 6) =       0.000468493269
  error estimate for blocks of size 2^( 7) =       0.000471978793

      target function =                  N/A
              le_mean =     -16.904984369312
             les_mean =     286.117808387817
             stat err =       0.000462678011
             autocorr =       1.261793996423
              std dev =       0.582504962031
             le_variance =       0.339312030791

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339176972482
                                         uncertainty =       0.004092183045

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339176972482
                                         uncertainty =       0.004092183045

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411893136
  error estimate for blocks of size 2^( 2) =       0.000424657436
  error estimate for blocks of size 2^( 3) =       0.000437946601
  error estimate for blocks of size 2^( 4) =       0.000450207756
  error estimate for blocks of size 2^( 5) =       0.000460032109
  error estimate for blocks of size 2^( 6) =       0.000468493213
  error estimate for blocks of size 2^( 7) =       0.000471978739

      target function =                  N/A
              le_mean =     -16.904984368322
             les_mean =     286.117808234274
             stat err =       0.000462677954
             autocorr =       1.261794135035
              std dev =       0.582504858973
             le_variance =       0.339311910727

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339176867231
                                         uncertainty =       0.004092181383

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339176867231
                                         uncertainty =       0.004092181383

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411893072
  error estimate for blocks of size 2^( 2) =       0.000424657377
  error estimate for blocks of size 2^( 3) =       0.000437946547
  error estimate for blocks of size 2^( 4) =       0.000450207705
  error estimate for blocks of size 2^( 5) =       0.000460032059
  error estimate for blocks of size 2^( 6) =       0.000468493165
  error estimate for blocks of size 2^( 7) =       0.000471978691

      target function =                  N/A
              le_mean =     -16.904984367455
             les_mean =     286.117808099704
             stat err =       0.000462677905
             autocorr =       1.261794256532
              std dev =       0.582504768628
             le_variance =       0.339311805474


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904984367331        initial
     3.6380e+02     3.6380e+03             5.9982e-07       -16.904984369312  <--
     1.4552e+03     1.4552e+04             1.4996e-07       -16.904984368322
     5.8208e+03     5.8208e+04             3.7491e-08       -16.904984367455

*****************************************************************************
Applying the update for shift_i =   3.6380e+02     and shift_s =   3.6380e+03
*****************************************************************************

  Execution time = 2.9691e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.093021e-01 1 1  ON 0
 uu_1                 1.425595e-01 1 1  ON 1
 uu_2                 4.090627e-02 1 1  ON 2
 uu_3                -2.151045e-02 1 1  ON 3
 uu_4                -6.691550e-02 1 1  ON 4
 uu_5                -1.013404e-01 1 1  ON 5
 uu_6                -1.281984e-01 1 1  ON 6
 uu_7                -1.411877e-01 1 1  ON 7
 uu_8                -1.329629e-01 1 1  ON 8
 uu_9                -1.043529e-01 1 1  ON 9
 ud_0                 4.443210e-01 1 1  ON 10
 ud_1                 1.800886e-01 1 1  ON 11
 ud_2                 6.327125e-02 1 1  ON 12
 ud_3                -6.167822e-03 1 1  ON 13
 ud_4                -6.410854e-02 1 1  ON 14
 ud_5                -1.066741e-01 1 1  ON 15
 ud_6                -1.344817e-01 1 1  ON 16
 ud_7                -1.516106e-01 1 1  ON 17
 ud_8                -1.521927e-01 1 1  ON 18
 ud_9                -1.426126e-01 1 1  ON 19
 eO_0                -7.585434e-01 1 1  ON 20
 eO_1                -4.404460e-01 1 1  ON 21
 eO_2                -2.263538e-02 1 1  ON 22
 eO_3                 2.977331e-01 1 1  ON 23
 eO_4                 5.252179e-01 1 1  ON 24
 eO_5                 4.870204e-01 1 1  ON 25
 eO_6                 2.596893e-01 1 1  ON 26
 eO_7                -4.097026e-02 1 1  ON 27
 eO_8                -2.205823e-01 1 1  ON 28
 eO_9                -8.531491e-02 1 1  ON 29
eH1_0                -2.414627e-01 1 1  ON 30
eH1_1                -1.440607e-01 1 1  ON 31
eH1_2                -9.924661e-02 1 1  ON 32
eH1_3                -4.541113e-02 1 1  ON 33
eH1_4                 2.876818e-03 1 1  ON 34
eH1_5                 3.773270e-02 1 1  ON 35
eH1_6                 9.700332e-02 1 1  ON 36
eH1_7                 1.538053e-01 1 1  ON 37
eH1_8                 1.762212e-01 1 1  ON 38
eH1_9                 6.656826e-02 1 1  ON 39
eH2_0                -2.395505e-01 1 1  ON 40
eH2_1                -1.418500e-01 1 1  ON 41
eH2_2                -9.688019e-02 1 1  ON 42
eH2_3                -4.316280e-02 1 1  ON 43
eH2_4                 5.096053e-03 1 1  ON 44
eH2_5                 3.979729e-02 1 1  ON 45
eH2_6                 9.952725e-02 1 1  ON 46
eH2_7                 1.556272e-01 1 1  ON 47
eH2_8                 1.821048e-01 1 1  ON 48
eH2_9                 5.593588e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5227e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.8884
    reference variance = 0.3362
====================================================
  Execution time = 2.0404e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4420e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4515e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344159710819
                                         uncertainty =       0.006038854730

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344159710819
                                         uncertainty =       0.006038854730

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414848214
  error estimate for blocks of size 2^( 2) =       0.000427488457
  error estimate for blocks of size 2^( 3) =       0.000441008086
  error estimate for blocks of size 2^( 4) =       0.000453370403
  error estimate for blocks of size 2^( 5) =       0.000463968255
  error estimate for blocks of size 2^( 6) =       0.000472154950
  error estimate for blocks of size 2^( 7) =       0.000478067403

      target function =                  N/A
              le_mean =     -16.904693570220
             les_mean =     286.112862612014
             stat err =       0.000466890253
             autocorr =       1.266634069394
              std dev =       0.586683970369
             le_variance =       0.344198081088


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690469357022e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+01, overlap shift 9.0949e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904693570220       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904693565021       residual = 3.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904693571116       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904693571521       residual = 4.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904693576722       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904693578350       residual = 9.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904693575758       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904693574669       residual = 4.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+01 is 2.576582e-06

solving harmonic davidson linear method for identity shift 3.6380e+02, overlap shift 3.6380e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904693570220       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904693568918       residual = 3.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904693570444       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904693570544       residual = 4.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904693571839       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904693572246       residual = 9.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904693571601       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904693571330       residual = 4.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+02 is 6.442149e-07

solving harmonic davidson linear method for identity shift 1.4552e+03, overlap shift 1.4552e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904693570220       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904693569894       residual = 3.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904693570276       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904693570301       residual = 4.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904693570624       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904693570726       residual = 9.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904693570565       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904693570496       residual = 4.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+03 is 1.610581e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.360804 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5866e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.093022e-01 1 1  ON 0
 uu_1                 1.425595e-01 1 1  ON 1
 uu_2                 4.090625e-02 1 1  ON 2
 uu_3                -2.151071e-02 1 1  ON 3
 uu_4                -6.691542e-02 1 1  ON 4
 uu_5                -1.013405e-01 1 1  ON 5
 uu_6                -1.281987e-01 1 1  ON 6
 uu_7                -1.411876e-01 1 1  ON 7
 uu_8                -1.329628e-01 1 1  ON 8
 uu_9                -1.043529e-01 1 1  ON 9
 ud_0                 4.443209e-01 1 1  ON 10
 ud_1                 1.800890e-01 1 1  ON 11
 ud_2                 6.327112e-02 1 1  ON 12
 ud_3                -6.167631e-03 1 1  ON 13
 ud_4                -6.410865e-02 1 1  ON 14
 ud_5                -1.066743e-01 1 1  ON 15
 ud_6                -1.344818e-01 1 1  ON 16
 ud_7                -1.516104e-01 1 1  ON 17
 ud_8                -1.521925e-01 1 1  ON 18
 ud_9                -1.426126e-01 1 1  ON 19
 eO_0                -7.585433e-01 1 1  ON 20
 eO_1                -4.404462e-01 1 1  ON 21
 eO_2                -2.263540e-02 1 1  ON 22
 eO_3                 2.977331e-01 1 1  ON 23
 eO_4                 5.252181e-01 1 1  ON 24
 eO_5                 4.870208e-01 1 1  ON 25
 eO_6                 2.596894e-01 1 1  ON 26
 eO_7                -4.097014e-02 1 1  ON 27
 eO_8                -2.205825e-01 1 1  ON 28
 eO_9                -8.531525e-02 1 1  ON 29
eH1_0                -2.414628e-01 1 1  ON 30
eH1_1                -1.440611e-01 1 1  ON 31
eH1_2                -9.924704e-02 1 1  ON 32
eH1_3                -4.541112e-02 1 1  ON 33
eH1_4                 2.876810e-03 1 1  ON 34
eH1_5                 3.773279e-02 1 1  ON 35
eH1_6                 9.700333e-02 1 1  ON 36
eH1_7                 1.538053e-01 1 1  ON 37
eH1_8                 1.762215e-01 1 1  ON 38
eH1_9                 6.656874e-02 1 1  ON 39
eH2_0                -2.395503e-01 1 1  ON 40
eH2_1                -1.418500e-01 1 1  ON 41
eH2_2                -9.688074e-02 1 1  ON 42
eH2_3                -4.316293e-02 1 1  ON 43
eH2_4                 5.095726e-03 1 1  ON 44
eH2_5                 3.979708e-02 1 1  ON 45
eH2_6                 9.952714e-02 1 1  ON 46
eH2_7                 1.556272e-01 1 1  ON 47
eH2_8                 1.821052e-01 1 1  ON 48
eH2_9                 5.593652e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.9033
    reference variance = 0.134212
====================================================
  Execution time = 2.0288e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3831e-01
  Total weights = 2.0000e+06
  Execution time = 1.8645e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338316875130
                                         uncertainty =       0.002896585282

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338316875130
                                         uncertainty =       0.002896585282

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411283487
  error estimate for blocks of size 2^( 2) =       0.000424709610
  error estimate for blocks of size 2^( 3) =       0.000437871942
  error estimate for blocks of size 2^( 4) =       0.000450284425
  error estimate for blocks of size 2^( 5) =       0.000462003953
  error estimate for blocks of size 2^( 6) =       0.000468206804
  error estimate for blocks of size 2^( 7) =       0.000471262800

      target function =                  N/A
              le_mean =     -16.905865590035
             les_mean =     286.146599392801
             stat err =       0.000462939496
             autocorr =       1.266968804738
              std dev =       0.581642685512
             le_variance =       0.338308213610

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338317103830
                                         uncertainty =       0.002896587993

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338317103830
                                         uncertainty =       0.002896587993

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411283626
  error estimate for blocks of size 2^( 2) =       0.000424709735
  error estimate for blocks of size 2^( 3) =       0.000437872042
  error estimate for blocks of size 2^( 4) =       0.000450284526
  error estimate for blocks of size 2^( 5) =       0.000462004039
  error estimate for blocks of size 2^( 6) =       0.000468206871
  error estimate for blocks of size 2^( 7) =       0.000471262855

      target function =                  N/A
              le_mean =     -16.905865601494
             les_mean =     286.146600008432
             stat err =       0.000462939573
             autocorr =       1.266968373327
              std dev =       0.581642881676
             le_variance =       0.338308441804

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338316988830
                                         uncertainty =       0.002896586623

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338316988830
                                         uncertainty =       0.002896586623

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411283556
  error estimate for blocks of size 2^( 2) =       0.000424709672
  error estimate for blocks of size 2^( 3) =       0.000437871992
  error estimate for blocks of size 2^( 4) =       0.000450284475
  error estimate for blocks of size 2^( 5) =       0.000462003996
  error estimate for blocks of size 2^( 6) =       0.000468206837
  error estimate for blocks of size 2^( 7) =       0.000471262827

      target function =                  N/A
              le_mean =     -16.905865595796
             les_mean =     286.146599701018
             stat err =       0.000462939534
             autocorr =       1.266968589200
              std dev =       0.581642783033
             le_variance =       0.338308327054

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338316889319
                                         uncertainty =       0.002896585449

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338316889319
                                         uncertainty =       0.002896585449

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411283496
  error estimate for blocks of size 2^( 2) =       0.000424709617
  error estimate for blocks of size 2^( 3) =       0.000437871949
  error estimate for blocks of size 2^( 4) =       0.000450284431
  error estimate for blocks of size 2^( 5) =       0.000462003958
  error estimate for blocks of size 2^( 6) =       0.000468206808
  error estimate for blocks of size 2^( 7) =       0.000471262803

      target function =                  N/A
              le_mean =     -16.905865590756
             les_mean =     286.146599431327
             stat err =       0.000462939500
             autocorr =       1.266968777804
              std dev =       0.581642697682
             le_variance =       0.338308227767


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905865590035        initial
     9.0949e+01     9.0949e+02             2.5766e-06       -16.905865601494  <--
     3.6380e+02     3.6380e+03             6.4421e-07       -16.905865595796
     1.4552e+03     1.4552e+04             1.6106e-07       -16.905865590756

*****************************************************************************
Applying the update for shift_i =   9.0949e+01     and shift_s =   9.0949e+02
*****************************************************************************

  Execution time = 2.9712e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.093026e-01 1 1  ON 0
 uu_1                 1.425593e-01 1 1  ON 1
 uu_2                 4.090619e-02 1 1  ON 2
 uu_3                -2.151148e-02 1 1  ON 3
 uu_4                -6.691519e-02 1 1  ON 4
 uu_5                -1.013407e-01 1 1  ON 5
 uu_6                -1.281995e-01 1 1  ON 6
 uu_7                -1.411874e-01 1 1  ON 7
 uu_8                -1.329623e-01 1 1  ON 8
 uu_9                -1.043529e-01 1 1  ON 9
 ud_0                 4.443206e-01 1 1  ON 10
 ud_1                 1.800901e-01 1 1  ON 11
 ud_2                 6.327076e-02 1 1  ON 12
 ud_3                -6.167062e-03 1 1  ON 13
 ud_4                -6.410897e-02 1 1  ON 14
 ud_5                -1.066747e-01 1 1  ON 15
 ud_6                -1.344821e-01 1 1  ON 16
 ud_7                -1.516099e-01 1 1  ON 17
 ud_8                -1.521921e-01 1 1  ON 18
 ud_9                -1.426129e-01 1 1  ON 19
 eO_0                -7.585429e-01 1 1  ON 20
 eO_1                -4.404467e-01 1 1  ON 21
 eO_2                -2.263547e-02 1 1  ON 22
 eO_3                 2.977331e-01 1 1  ON 23
 eO_4                 5.252185e-01 1 1  ON 24
 eO_5                 4.870218e-01 1 1  ON 25
 eO_6                 2.596896e-01 1 1  ON 26
 eO_7                -4.096980e-02 1 1  ON 27
 eO_8                -2.205832e-01 1 1  ON 28
 eO_9                -8.531629e-02 1 1  ON 29
eH1_0                -2.414631e-01 1 1  ON 30
eH1_1                -1.440625e-01 1 1  ON 31
eH1_2                -9.924833e-02 1 1  ON 32
eH1_3                -4.541110e-02 1 1  ON 33
eH1_4                 2.876789e-03 1 1  ON 34
eH1_5                 3.773306e-02 1 1  ON 35
eH1_6                 9.700336e-02 1 1  ON 36
eH1_7                 1.538053e-01 1 1  ON 37
eH1_8                 1.762226e-01 1 1  ON 38
eH1_9                 6.657018e-02 1 1  ON 39
eH2_0                -2.395497e-01 1 1  ON 40
eH2_1                -1.418500e-01 1 1  ON 41
eH2_2                -9.688236e-02 1 1  ON 42
eH2_3                -4.316331e-02 1 1  ON 43
eH2_4                 5.094749e-03 1 1  ON 44
eH2_5                 3.979646e-02 1 1  ON 45
eH2_6                 9.952681e-02 1 1  ON 46
eH2_7                 1.556273e-01 1 1  ON 47
eH2_8                 1.821064e-01 1 1  ON 48
eH2_9                 5.593846e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5584e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.9378
    reference variance = 0.259571
====================================================
  Execution time = 2.0122e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3670e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5748e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336814252950
                                         uncertainty =       0.003160533086

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336814252950
                                         uncertainty =       0.003160533086

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410303722
  error estimate for blocks of size 2^( 2) =       0.000423130857
  error estimate for blocks of size 2^( 3) =       0.000435970461
  error estimate for blocks of size 2^( 4) =       0.000448481092
  error estimate for blocks of size 2^( 5) =       0.000459345674
  error estimate for blocks of size 2^( 6) =       0.000468462142
  error estimate for blocks of size 2^( 7) =       0.000472072648

      target function =                  N/A
              le_mean =     -16.905266348195
             les_mean =     286.124728424404
             stat err =       0.000462090389
             autocorr =       1.268361225941
              std dev =       0.580257089014
             le_variance =       0.336698289351


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690526634819e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+01, overlap shift 2.2737e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905266348195       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905266351529       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905266377635       residual = 5.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905266375993       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905266386942       residual = 4.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905266376014       residual = 6.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905266382738       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905266381843       residual = 3.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.2737e+01 is 9.516217e-06

solving harmonic davidson linear method for identity shift 9.0949e+01, overlap shift 9.0949e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905266348195       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905266349036       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905266355652       residual = 5.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905266355311       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905266358223       residual = 4.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905266355507       residual = 6.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905266357047       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905266356819       residual = 3.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+01 is 2.379698e-06

solving harmonic davidson linear method for identity shift 3.6380e+02, overlap shift 3.6380e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905266348195       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905266348406       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905266350065       residual = 5.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905266349984       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905266350723       residual = 4.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905266350046       residual = 6.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905266350422       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905266350364       residual = 3.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+02 is 5.949664e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.363535 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5707e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.093025e-01 1 1  ON 0
 uu_1                 1.425599e-01 1 1  ON 1
 uu_2                 4.090768e-02 1 1  ON 2
 uu_3                -2.151238e-02 1 1  ON 3
 uu_4                -6.691497e-02 1 1  ON 4
 uu_5                -1.013415e-01 1 1  ON 5
 uu_6                -1.282004e-01 1 1  ON 6
 uu_7                -1.411879e-01 1 1  ON 7
 uu_8                -1.329630e-01 1 1  ON 8
 uu_9                -1.043534e-01 1 1  ON 9
 ud_0                 4.443200e-01 1 1  ON 10
 ud_1                 1.800901e-01 1 1  ON 11
 ud_2                 6.327047e-02 1 1  ON 12
 ud_3                -6.166364e-03 1 1  ON 13
 ud_4                -6.410836e-02 1 1  ON 14
 ud_5                -1.066744e-01 1 1  ON 15
 ud_6                -1.344820e-01 1 1  ON 16
 ud_7                -1.516091e-01 1 1  ON 17
 ud_8                -1.521923e-01 1 1  ON 18
 ud_9                -1.426132e-01 1 1  ON 19
 eO_0                -7.585423e-01 1 1  ON 20
 eO_1                -4.404476e-01 1 1  ON 21
 eO_2                -2.263461e-02 1 1  ON 22
 eO_3                 2.977327e-01 1 1  ON 23
 eO_4                 5.252183e-01 1 1  ON 24
 eO_5                 4.870238e-01 1 1  ON 25
 eO_6                 2.596906e-01 1 1  ON 26
 eO_7                -4.096948e-02 1 1  ON 27
 eO_8                -2.205843e-01 1 1  ON 28
 eO_9                -8.531797e-02 1 1  ON 29
eH1_0                -2.414645e-01 1 1  ON 30
eH1_1                -1.440633e-01 1 1  ON 31
eH1_2                -9.924877e-02 1 1  ON 32
eH1_3                -4.541171e-02 1 1  ON 33
eH1_4                 2.876378e-03 1 1  ON 34
eH1_5                 3.773187e-02 1 1  ON 35
eH1_6                 9.700303e-02 1 1  ON 36
eH1_7                 1.538065e-01 1 1  ON 37
eH1_8                 1.762246e-01 1 1  ON 38
eH1_9                 6.657220e-02 1 1  ON 39
eH2_0                -2.395492e-01 1 1  ON 40
eH2_1                -1.418522e-01 1 1  ON 41
eH2_2                -9.688318e-02 1 1  ON 42
eH2_3                -4.316286e-02 1 1  ON 43
eH2_4                 5.094273e-03 1 1  ON 44
eH2_5                 3.979557e-02 1 1  ON 45
eH2_6                 9.952587e-02 1 1  ON 46
eH2_7                 1.556278e-01 1 1  ON 47
eH2_8                 1.821078e-01 1 1  ON 48
eH2_9                 5.594084e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.8792
    reference variance = 0.39409
====================================================
  Execution time = 2.0087e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3623e-01
  Total weights = 2.0000e+06
  Execution time = 1.8696e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336248354877
                                         uncertainty =       0.003035566643

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336248354877
                                         uncertainty =       0.003035566643

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410020907
  error estimate for blocks of size 2^( 2) =       0.000423008169
  error estimate for blocks of size 2^( 3) =       0.000436637085
  error estimate for blocks of size 2^( 4) =       0.000450125085
  error estimate for blocks of size 2^( 5) =       0.000461656762
  error estimate for blocks of size 2^( 6) =       0.000470472384
  error estimate for blocks of size 2^( 7) =       0.000475487669

      target function =                  N/A
              le_mean =     -16.905520176933
             les_mean =     286.132846573524
             stat err =       0.000464435475
             autocorr =       1.283035772054
              std dev =       0.579857128053
             le_variance =       0.336234288954

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336245327970
                                         uncertainty =       0.003035550245

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336245327970
                                         uncertainty =       0.003035550245

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410019062
  error estimate for blocks of size 2^( 2) =       0.000423006363
  error estimate for blocks of size 2^( 3) =       0.000436635327
  error estimate for blocks of size 2^( 4) =       0.000450123464
  error estimate for blocks of size 2^( 5) =       0.000461655306
  error estimate for blocks of size 2^( 6) =       0.000470471033
  error estimate for blocks of size 2^( 7) =       0.000475486188

      target function =                  N/A
              le_mean =     -16.905520142249
             les_mean =     286.132842374435
             stat err =       0.000464433998
             autocorr =       1.283039159131
              std dev =       0.579854518450
             le_variance =       0.336231262567

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336246824048
                                         uncertainty =       0.003035558412

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336246824048
                                         uncertainty =       0.003035558412

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410019974
  error estimate for blocks of size 2^( 2) =       0.000423007256
  error estimate for blocks of size 2^( 3) =       0.000436636196
  error estimate for blocks of size 2^( 4) =       0.000450124265
  error estimate for blocks of size 2^( 5) =       0.000461656026
  error estimate for blocks of size 2^( 6) =       0.000470471701
  error estimate for blocks of size 2^( 7) =       0.000475486920

      target function =                  N/A
              le_mean =     -16.905520159238
             les_mean =     286.132844444675
             stat err =       0.000464434728
             autocorr =       1.283037486850
              std dev =       0.579855808267
             le_variance =       0.336232758381

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336248162933
                                         uncertainty =       0.003035565613

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336248162933
                                         uncertainty =       0.003035565613

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410020790
  error estimate for blocks of size 2^( 2) =       0.000423008055
  error estimate for blocks of size 2^( 3) =       0.000436636973
  error estimate for blocks of size 2^( 4) =       0.000450124982
  error estimate for blocks of size 2^( 5) =       0.000461656670
  error estimate for blocks of size 2^( 6) =       0.000470472298
  error estimate for blocks of size 2^( 7) =       0.000475487575

      target function =                  N/A
              le_mean =     -16.905520174705
             les_mean =     286.132846306279
             stat err =       0.000464435381
             autocorr =       1.283035987089
              std dev =       0.579856962570
             le_variance =       0.336234097041


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905520176933        initial  <--
     2.2737e+01     2.2737e+02             9.5162e-06       -16.905520142249
     9.0949e+01     9.0949e+02             2.3797e-06       -16.905520159238
     3.6380e+02     3.6380e+03             5.9497e-07       -16.905520174705

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5417
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.093026e-01 1 1  ON 0
 uu_1                 1.425593e-01 1 1  ON 1
 uu_2                 4.090619e-02 1 1  ON 2
 uu_3                -2.151148e-02 1 1  ON 3
 uu_4                -6.691519e-02 1 1  ON 4
 uu_5                -1.013407e-01 1 1  ON 5
 uu_6                -1.281995e-01 1 1  ON 6
 uu_7                -1.411874e-01 1 1  ON 7
 uu_8                -1.329623e-01 1 1  ON 8
 uu_9                -1.043529e-01 1 1  ON 9
 ud_0                 4.443206e-01 1 1  ON 10
 ud_1                 1.800901e-01 1 1  ON 11
 ud_2                 6.327076e-02 1 1  ON 12
 ud_3                -6.167062e-03 1 1  ON 13
 ud_4                -6.410897e-02 1 1  ON 14
 ud_5                -1.066747e-01 1 1  ON 15
 ud_6                -1.344821e-01 1 1  ON 16
 ud_7                -1.516099e-01 1 1  ON 17
 ud_8                -1.521921e-01 1 1  ON 18
 ud_9                -1.426129e-01 1 1  ON 19
 eO_0                -7.585429e-01 1 1  ON 20
 eO_1                -4.404467e-01 1 1  ON 21
 eO_2                -2.263547e-02 1 1  ON 22
 eO_3                 2.977331e-01 1 1  ON 23
 eO_4                 5.252185e-01 1 1  ON 24
 eO_5                 4.870218e-01 1 1  ON 25
 eO_6                 2.596896e-01 1 1  ON 26
 eO_7                -4.096980e-02 1 1  ON 27
 eO_8                -2.205832e-01 1 1  ON 28
 eO_9                -8.531629e-02 1 1  ON 29
eH1_0                -2.414631e-01 1 1  ON 30
eH1_1                -1.440625e-01 1 1  ON 31
eH1_2                -9.924833e-02 1 1  ON 32
eH1_3                -4.541110e-02 1 1  ON 33
eH1_4                 2.876789e-03 1 1  ON 34
eH1_5                 3.773306e-02 1 1  ON 35
eH1_6                 9.700336e-02 1 1  ON 36
eH1_7                 1.538053e-01 1 1  ON 37
eH1_8                 1.762226e-01 1 1  ON 38
eH1_9                 6.657018e-02 1 1  ON 39
eH2_0                -2.395497e-01 1 1  ON 40
eH2_1                -1.418500e-01 1 1  ON 41
eH2_2                -9.688236e-02 1 1  ON 42
eH2_3                -4.316331e-02 1 1  ON 43
eH2_4                 5.094749e-03 1 1  ON 44
eH2_5                 3.979646e-02 1 1  ON 45
eH2_6                 9.952681e-02 1 1  ON 46
eH2_7                 1.556273e-01 1 1  ON 47
eH2_8                 1.821064e-01 1 1  ON 48
eH2_9                 5.593846e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5254e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.8384
    reference variance = 0.156787
====================================================
  Execution time = 2.0310e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.5248e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5624e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352513978201
                                         uncertainty =       0.010085750272

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352513978201
                                         uncertainty =       0.010085750272

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419807126
  error estimate for blocks of size 2^( 2) =       0.000432946873
  error estimate for blocks of size 2^( 3) =       0.000445684558
  error estimate for blocks of size 2^( 4) =       0.000458750234
  error estimate for blocks of size 2^( 5) =       0.000470101486
  error estimate for blocks of size 2^( 6) =       0.000480040108
  error estimate for blocks of size 2^( 7) =       0.000485077059

      target function =                  N/A
              le_mean =     -16.904757416684
             les_mean =     286.123299187585
             stat err =       0.000473492222
             autocorr =       1.272114153160
              std dev =       0.593696931857
             le_variance =       0.352476046896


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690475741668e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+02, overlap shift 2.2737e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904757416684       residual = 6.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904757418056       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904757420627       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904757421636       residual = 5.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904757424272       residual = 6.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904757424669       residual = 4.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904757424315       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904757424296       residual = 2.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.2737e+02 is 1.100797e-06

solving harmonic davidson linear method for identity shift 9.0949e+02, overlap shift 9.0949e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904757416684       residual = 6.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904757417027       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904757417671       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904757417922       residual = 5.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904757418581       residual = 6.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904757418682       residual = 4.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904757418593       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904757418590       residual = 2.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+02 is 2.753560e-07

solving harmonic davidson linear method for identity shift 3.6380e+03, overlap shift 3.6380e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904757416684       residual = 6.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904757416770       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904757416931       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904757416993       residual = 5.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904757417158       residual = 6.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904757417189       residual = 4.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904757417166       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904757417162       residual = 2.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+03 is 6.884880e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.366239 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5883e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.093026e-01 1 1  ON 0
 uu_1                 1.425592e-01 1 1  ON 1
 uu_2                 4.090623e-02 1 1  ON 2
 uu_3                -2.151159e-02 1 1  ON 3
 uu_4                -6.691521e-02 1 1  ON 4
 uu_5                -1.013408e-01 1 1  ON 5
 uu_6                -1.281996e-01 1 1  ON 6
 uu_7                -1.411875e-01 1 1  ON 7
 uu_8                -1.329623e-01 1 1  ON 8
 uu_9                -1.043528e-01 1 1  ON 9
 ud_0                 4.443207e-01 1 1  ON 10
 ud_1                 1.800901e-01 1 1  ON 11
 ud_2                 6.327066e-02 1 1  ON 12
 ud_3                -6.167055e-03 1 1  ON 13
 ud_4                -6.410895e-02 1 1  ON 14
 ud_5                -1.066748e-01 1 1  ON 15
 ud_6                -1.344821e-01 1 1  ON 16
 ud_7                -1.516100e-01 1 1  ON 17
 ud_8                -1.521920e-01 1 1  ON 18
 ud_9                -1.426129e-01 1 1  ON 19
 eO_0                -7.585429e-01 1 1  ON 20
 eO_1                -4.404468e-01 1 1  ON 21
 eO_2                -2.263534e-02 1 1  ON 22
 eO_3                 2.977331e-01 1 1  ON 23
 eO_4                 5.252186e-01 1 1  ON 24
 eO_5                 4.870219e-01 1 1  ON 25
 eO_6                 2.596896e-01 1 1  ON 26
 eO_7                -4.096975e-02 1 1  ON 27
 eO_8                -2.205832e-01 1 1  ON 28
 eO_9                -8.531641e-02 1 1  ON 29
eH1_0                -2.414632e-01 1 1  ON 30
eH1_1                -1.440628e-01 1 1  ON 31
eH1_2                -9.924835e-02 1 1  ON 32
eH1_3                -4.541122e-02 1 1  ON 33
eH1_4                 2.876712e-03 1 1  ON 34
eH1_5                 3.773311e-02 1 1  ON 35
eH1_6                 9.700340e-02 1 1  ON 36
eH1_7                 1.538055e-01 1 1  ON 37
eH1_8                 1.762228e-01 1 1  ON 38
eH1_9                 6.657035e-02 1 1  ON 39
eH2_0                -2.395498e-01 1 1  ON 40
eH2_1                -1.418499e-01 1 1  ON 41
eH2_2                -9.688246e-02 1 1  ON 42
eH2_3                -4.316332e-02 1 1  ON 43
eH2_4                 5.094748e-03 1 1  ON 44
eH2_5                 3.979633e-02 1 1  ON 45
eH2_6                 9.952664e-02 1 1  ON 46
eH2_7                 1.556273e-01 1 1  ON 47
eH2_8                 1.821065e-01 1 1  ON 48
eH2_9                 5.593871e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.897
    reference variance = 0.175898
====================================================
  Execution time = 2.2130e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4671e-01
  Total weights = 2.0000e+06
  Execution time = 1.8592e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346146445939
                                         uncertainty =       0.006984318952

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346146445939
                                         uncertainty =       0.006984318952

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416356962
  error estimate for blocks of size 2^( 2) =       0.000429045698
  error estimate for blocks of size 2^( 3) =       0.000442275412
  error estimate for blocks of size 2^( 4) =       0.000454086425
  error estimate for blocks of size 2^( 5) =       0.000463992464
  error estimate for blocks of size 2^( 6) =       0.000472569703
  error estimate for blocks of size 2^( 7) =       0.000475241260

      target function =                  N/A
              le_mean =     -16.905243862617
             les_mean =     286.133976121240
             stat err =       0.000466472463
             autocorr =       1.255221472492
              std dev =       0.588817662802
             le_variance =       0.346706240027

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346146870325
                                         uncertainty =       0.006984325298

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346146870325
                                         uncertainty =       0.006984325298

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416357219
  error estimate for blocks of size 2^( 2) =       0.000429045949
  error estimate for blocks of size 2^( 3) =       0.000442275654
  error estimate for blocks of size 2^( 4) =       0.000454086653
  error estimate for blocks of size 2^( 5) =       0.000463992695
  error estimate for blocks of size 2^( 6) =       0.000472569932
  error estimate for blocks of size 2^( 7) =       0.000475241457

      target function =                  N/A
              le_mean =     -16.905243861144
             les_mean =     286.133976499721
             stat err =       0.000466472684
             autocorr =       1.255221114827
              std dev =       0.588818026501
             le_variance =       0.346706668333

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346146658373
                                         uncertainty =       0.006984322127

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346146658373
                                         uncertainty =       0.006984322127

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416357091
  error estimate for blocks of size 2^( 2) =       0.000429045824
  error estimate for blocks of size 2^( 3) =       0.000442275533
  error estimate for blocks of size 2^( 4) =       0.000454086539
  error estimate for blocks of size 2^( 5) =       0.000463992580
  error estimate for blocks of size 2^( 6) =       0.000472569818
  error estimate for blocks of size 2^( 7) =       0.000475241359

      target function =                  N/A
              le_mean =     -16.905243861878
             les_mean =     286.133976310646
             stat err =       0.000466472574
             autocorr =       1.255221293455
              std dev =       0.588817844859
             le_variance =       0.346706454424

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346146472501
                                         uncertainty =       0.006984319349

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346146472501
                                         uncertainty =       0.006984319349

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416356978
  error estimate for blocks of size 2^( 2) =       0.000429045714
  error estimate for blocks of size 2^( 3) =       0.000442275427
  error estimate for blocks of size 2^( 4) =       0.000454086439
  error estimate for blocks of size 2^( 5) =       0.000463992479
  error estimate for blocks of size 2^( 6) =       0.000472569717
  error estimate for blocks of size 2^( 7) =       0.000475241272

      target function =                  N/A
              le_mean =     -16.905243862525
             les_mean =     286.133976144918
             stat err =       0.000466472477
             autocorr =       1.255221450115
              std dev =       0.588817685565
             le_variance =       0.346706266834


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905243862617        initial  <--
     2.2737e+02     2.2737e+03             1.1008e-06       -16.905243861144
     9.0949e+02     9.0949e+03             2.7536e-07       -16.905243861878
     3.6380e+03     3.6380e+04             6.8849e-08       -16.905243862525

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.5556
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.093026e-01 1 1  ON 0
 uu_1                 1.425593e-01 1 1  ON 1
 uu_2                 4.090619e-02 1 1  ON 2
 uu_3                -2.151148e-02 1 1  ON 3
 uu_4                -6.691519e-02 1 1  ON 4
 uu_5                -1.013407e-01 1 1  ON 5
 uu_6                -1.281995e-01 1 1  ON 6
 uu_7                -1.411874e-01 1 1  ON 7
 uu_8                -1.329623e-01 1 1  ON 8
 uu_9                -1.043529e-01 1 1  ON 9
 ud_0                 4.443206e-01 1 1  ON 10
 ud_1                 1.800901e-01 1 1  ON 11
 ud_2                 6.327076e-02 1 1  ON 12
 ud_3                -6.167062e-03 1 1  ON 13
 ud_4                -6.410897e-02 1 1  ON 14
 ud_5                -1.066747e-01 1 1  ON 15
 ud_6                -1.344821e-01 1 1  ON 16
 ud_7                -1.516099e-01 1 1  ON 17
 ud_8                -1.521921e-01 1 1  ON 18
 ud_9                -1.426129e-01 1 1  ON 19
 eO_0                -7.585429e-01 1 1  ON 20
 eO_1                -4.404467e-01 1 1  ON 21
 eO_2                -2.263547e-02 1 1  ON 22
 eO_3                 2.977331e-01 1 1  ON 23
 eO_4                 5.252185e-01 1 1  ON 24
 eO_5                 4.870218e-01 1 1  ON 25
 eO_6                 2.596896e-01 1 1  ON 26
 eO_7                -4.096980e-02 1 1  ON 27
 eO_8                -2.205832e-01 1 1  ON 28
 eO_9                -8.531629e-02 1 1  ON 29
eH1_0                -2.414631e-01 1 1  ON 30
eH1_1                -1.440625e-01 1 1  ON 31
eH1_2                -9.924833e-02 1 1  ON 32
eH1_3                -4.541110e-02 1 1  ON 33
eH1_4                 2.876789e-03 1 1  ON 34
eH1_5                 3.773306e-02 1 1  ON 35
eH1_6                 9.700336e-02 1 1  ON 36
eH1_7                 1.538053e-01 1 1  ON 37
eH1_8                 1.762226e-01 1 1  ON 38
eH1_9                 6.657018e-02 1 1  ON 39
eH2_0                -2.395497e-01 1 1  ON 40
eH2_1                -1.418500e-01 1 1  ON 41
eH2_2                -9.688236e-02 1 1  ON 42
eH2_3                -4.316331e-02 1 1  ON 43
eH2_4                 5.094749e-03 1 1  ON 44
eH2_5                 3.979646e-02 1 1  ON 45
eH2_6                 9.952681e-02 1 1  ON 46
eH2_7                 1.556273e-01 1 1  ON 47
eH2_8                 1.821064e-01 1 1  ON 48
eH2_9                 5.593846e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7444e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.8666
    reference variance = 0.221809
====================================================
  Execution time = 2.0241e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4483e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5144e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344969513987
                                         uncertainty =       0.003972137142

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344969513987
                                         uncertainty =       0.003972137142

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415228713
  error estimate for blocks of size 2^( 2) =       0.000427764920
  error estimate for blocks of size 2^( 3) =       0.000441323611
  error estimate for blocks of size 2^( 4) =       0.000453007590
  error estimate for blocks of size 2^( 5) =       0.000463703778
  error estimate for blocks of size 2^( 6) =       0.000471217708
  error estimate for blocks of size 2^( 7) =       0.000474939267

      target function =                  N/A
              le_mean =     -16.905580613129
             les_mean =     286.143485462077
             stat err =       0.000465717086
             autocorr =       1.257967984651
              std dev =       0.587222076809
             le_variance =       0.344829767492


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690558061313e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+03, overlap shift 2.2737e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905580613129       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905580613095       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905580613158       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905580613245       residual = 7.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905580613314       residual = 2.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905580613301       residual = 5.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905580613343       residual = 7.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.2737e+03 is 1.028441e-07

solving harmonic davidson linear method for identity shift 9.0949e+03, overlap shift 9.0949e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905580613129       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905580613120       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905580613136       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905580613158       residual = 7.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905580613168       residual = 2.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905580613173       residual = 5.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905580613186       residual = 7.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+03 is 2.571134e-08

solving harmonic davidson linear method for identity shift 3.6380e+04, overlap shift 3.6380e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905580613129       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905580613127       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905580613131       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905580613136       residual = 7.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905580613097       residual = 2.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905580613096       residual = 5.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905580613129       residual = 7.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+04 is 6.427855e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.368543 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5766e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.093026e-01 1 1  ON 0
 uu_1                 1.425593e-01 1 1  ON 1
 uu_2                 4.090620e-02 1 1  ON 2
 uu_3                -2.151149e-02 1 1  ON 3
 uu_4                -6.691519e-02 1 1  ON 4
 uu_5                -1.013407e-01 1 1  ON 5
 uu_6                -1.281995e-01 1 1  ON 6
 uu_7                -1.411874e-01 1 1  ON 7
 uu_8                -1.329623e-01 1 1  ON 8
 uu_9                -1.043529e-01 1 1  ON 9
 ud_0                 4.443207e-01 1 1  ON 10
 ud_1                 1.800901e-01 1 1  ON 11
 ud_2                 6.327076e-02 1 1  ON 12
 ud_3                -6.167057e-03 1 1  ON 13
 ud_4                -6.410898e-02 1 1  ON 14
 ud_5                -1.066747e-01 1 1  ON 15
 ud_6                -1.344821e-01 1 1  ON 16
 ud_7                -1.516099e-01 1 1  ON 17
 ud_8                -1.521922e-01 1 1  ON 18
 ud_9                -1.426129e-01 1 1  ON 19
 eO_0                -7.585429e-01 1 1  ON 20
 eO_1                -4.404467e-01 1 1  ON 21
 eO_2                -2.263545e-02 1 1  ON 22
 eO_3                 2.977331e-01 1 1  ON 23
 eO_4                 5.252185e-01 1 1  ON 24
 eO_5                 4.870218e-01 1 1  ON 25
 eO_6                 2.596896e-01 1 1  ON 26
 eO_7                -4.096980e-02 1 1  ON 27
 eO_8                -2.205832e-01 1 1  ON 28
 eO_9                -8.531630e-02 1 1  ON 29
eH1_0                -2.414631e-01 1 1  ON 30
eH1_1                -1.440625e-01 1 1  ON 31
eH1_2                -9.924834e-02 1 1  ON 32
eH1_3                -4.541111e-02 1 1  ON 33
eH1_4                 2.876786e-03 1 1  ON 34
eH1_5                 3.773306e-02 1 1  ON 35
eH1_6                 9.700336e-02 1 1  ON 36
eH1_7                 1.538053e-01 1 1  ON 37
eH1_8                 1.762226e-01 1 1  ON 38
eH1_9                 6.657019e-02 1 1  ON 39
eH2_0                -2.395497e-01 1 1  ON 40
eH2_1                -1.418500e-01 1 1  ON 41
eH2_2                -9.688236e-02 1 1  ON 42
eH2_3                -4.316331e-02 1 1  ON 43
eH2_4                 5.094752e-03 1 1  ON 44
eH2_5                 3.979646e-02 1 1  ON 45
eH2_6                 9.952680e-02 1 1  ON 46
eH2_7                 1.556273e-01 1 1  ON 47
eH2_8                 1.821064e-01 1 1  ON 48
eH2_9                 5.593848e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.9132
    reference variance = 0.297529
====================================================
  Execution time = 2.1989e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3912e-01
  Total weights = 2.0000e+06
  Execution time = 1.8676e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339241154010
                                         uncertainty =       0.004904962523

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339241154010
                                         uncertainty =       0.004904962523

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411779116
  error estimate for blocks of size 2^( 2) =       0.000424493848
  error estimate for blocks of size 2^( 3) =       0.000437803146
  error estimate for blocks of size 2^( 4) =       0.000450790148
  error estimate for blocks of size 2^( 5) =       0.000461841594
  error estimate for blocks of size 2^( 6) =       0.000469254297
  error estimate for blocks of size 2^( 7) =       0.000474779651

      target function =                  N/A
              le_mean =     -16.905163938004
             les_mean =     286.123691681991
             stat err =       0.000464166422
             autocorr =       1.270629129131
              std dev =       0.582343610563
             le_variance =       0.339124080763

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339241137168
                                         uncertainty =       0.004904962619

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339241137168
                                         uncertainty =       0.004904962619

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411779106
  error estimate for blocks of size 2^( 2) =       0.000424493837
  error estimate for blocks of size 2^( 3) =       0.000437803136
  error estimate for blocks of size 2^( 4) =       0.000450790138
  error estimate for blocks of size 2^( 5) =       0.000461841583
  error estimate for blocks of size 2^( 6) =       0.000469254286
  error estimate for blocks of size 2^( 7) =       0.000474779640

      target function =                  N/A
              le_mean =     -16.905163938030
             les_mean =     286.123691666005
             stat err =       0.000464166412
             autocorr =       1.270629133177
              std dev =       0.582343596093
             le_variance =       0.339124063910

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339241145587
                                         uncertainty =       0.004904962571

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339241145587
                                         uncertainty =       0.004904962571

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411779111
  error estimate for blocks of size 2^( 2) =       0.000424493843
  error estimate for blocks of size 2^( 3) =       0.000437803141
  error estimate for blocks of size 2^( 4) =       0.000450790143
  error estimate for blocks of size 2^( 5) =       0.000461841588
  error estimate for blocks of size 2^( 6) =       0.000469254291
  error estimate for blocks of size 2^( 7) =       0.000474779646

      target function =                  N/A
              le_mean =     -16.905163938017
             les_mean =     286.123691673995
             stat err =       0.000464166417
             autocorr =       1.270629131159
              std dev =       0.582343603326
             le_variance =       0.339124072334

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339241152957
                                         uncertainty =       0.004904962529

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339241152957
                                         uncertainty =       0.004904962529

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411779115
  error estimate for blocks of size 2^( 2) =       0.000424493847
  error estimate for blocks of size 2^( 3) =       0.000437803145
  error estimate for blocks of size 2^( 4) =       0.000450790147
  error estimate for blocks of size 2^( 5) =       0.000461841593
  error estimate for blocks of size 2^( 6) =       0.000469254296
  error estimate for blocks of size 2^( 7) =       0.000474779651

      target function =                  N/A
              le_mean =     -16.905163938006
             les_mean =     286.123691680991
             stat err =       0.000464166422
             autocorr =       1.270629129379
              std dev =       0.582343609658
             le_variance =       0.339124079710


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905163938004        initial
     2.2737e+03     2.2737e+04             1.0284e-07       -16.905163938030  <--
     9.0949e+03     9.0949e+04             2.5711e-08       -16.905163938017
     3.6380e+04     3.6380e+05             6.4279e-09       -16.905163938006

*****************************************************************************
Applying the update for shift_i =   2.2737e+03     and shift_s =   2.2737e+04
*****************************************************************************

  Execution time = 3.1433e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.093026e-01 1 1  ON 0
 uu_1                 1.425593e-01 1 1  ON 1
 uu_2                 4.090623e-02 1 1  ON 2
 uu_3                -2.151151e-02 1 1  ON 3
 uu_4                -6.691518e-02 1 1  ON 4
 uu_5                -1.013407e-01 1 1  ON 5
 uu_6                -1.281995e-01 1 1  ON 6
 uu_7                -1.411874e-01 1 1  ON 7
 uu_8                -1.329623e-01 1 1  ON 8
 uu_9                -1.043529e-01 1 1  ON 9
 ud_0                 4.443207e-01 1 1  ON 10
 ud_1                 1.800901e-01 1 1  ON 11
 ud_2                 6.327079e-02 1 1  ON 12
 ud_3                -6.167041e-03 1 1  ON 13
 ud_4                -6.410898e-02 1 1  ON 14
 ud_5                -1.066747e-01 1 1  ON 15
 ud_6                -1.344821e-01 1 1  ON 16
 ud_7                -1.516099e-01 1 1  ON 17
 ud_8                -1.521922e-01 1 1  ON 18
 ud_9                -1.426130e-01 1 1  ON 19
 eO_0                -7.585429e-01 1 1  ON 20
 eO_1                -4.404467e-01 1 1  ON 21
 eO_2                -2.263542e-02 1 1  ON 22
 eO_3                 2.977331e-01 1 1  ON 23
 eO_4                 5.252185e-01 1 1  ON 24
 eO_5                 4.870219e-01 1 1  ON 25
 eO_6                 2.596896e-01 1 1  ON 26
 eO_7                -4.096978e-02 1 1  ON 27
 eO_8                -2.205833e-01 1 1  ON 28
 eO_9                -8.531636e-02 1 1  ON 29
eH1_0                -2.414631e-01 1 1  ON 30
eH1_1                -1.440625e-01 1 1  ON 31
eH1_2                -9.924835e-02 1 1  ON 32
eH1_3                -4.541114e-02 1 1  ON 33
eH1_4                 2.876779e-03 1 1  ON 34
eH1_5                 3.773305e-02 1 1  ON 35
eH1_6                 9.700337e-02 1 1  ON 36
eH1_7                 1.538054e-01 1 1  ON 37
eH1_8                 1.762227e-01 1 1  ON 38
eH1_9                 6.657024e-02 1 1  ON 39
eH2_0                -2.395498e-01 1 1  ON 40
eH2_1                -1.418500e-01 1 1  ON 41
eH2_2                -9.688236e-02 1 1  ON 42
eH2_3                -4.316331e-02 1 1  ON 43
eH2_4                 5.094763e-03 1 1  ON 44
eH2_5                 3.979647e-02 1 1  ON 45
eH2_6                 9.952679e-02 1 1  ON 46
eH2_7                 1.556273e-01 1 1  ON 47
eH2_8                 1.821064e-01 1 1  ON 48
eH2_9                 5.593856e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7205e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.9175
    reference variance = 0.242736
====================================================
  Execution time = 2.0164e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3779e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5987e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337846046874
                                         uncertainty =       0.004392718391

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337846046874
                                         uncertainty =       0.004392718391

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410965725
  error estimate for blocks of size 2^( 2) =       0.000423587955
  error estimate for blocks of size 2^( 3) =       0.000436337839
  error estimate for blocks of size 2^( 4) =       0.000448511657
  error estimate for blocks of size 2^( 5) =       0.000459611872
  error estimate for blocks of size 2^( 6) =       0.000467605185
  error estimate for blocks of size 2^( 7) =       0.000472880235

      target function =                  N/A
              le_mean =     -16.904678160955
             les_mean =     286.105929211201
             stat err =       0.000462152237
             autocorr =       1.264616702188
              std dev =       0.581193302283
             le_variance =       0.337785654619


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690467816096e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.6843e+02, overlap shift 5.6843e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904678160955       residual = 6.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904678161109       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904678160764       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904678161123       residual = 7.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904678161946       residual = 3.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904678161923       residual = 7.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904678161906       residual = 2.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904678161837       residual = 4.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.6843e+02 is 3.587213e-07

solving harmonic davidson linear method for identity shift 2.2737e+03, overlap shift 2.2737e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904678160955       residual = 6.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904678160994       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904678160907       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904678160997       residual = 7.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904678161203       residual = 3.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904678161196       residual = 7.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904678161194       residual = 2.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904678161174       residual = 4.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.2737e+03 is 8.968334e-08

solving harmonic davidson linear method for identity shift 9.0949e+03, overlap shift 9.0949e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904678160955       residual = 6.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904678160965       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904678160943       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904678160966       residual = 7.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904678161017       residual = 3.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904678161019       residual = 7.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904678161018       residual = 2.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904678161001       residual = 4.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+03 is 2.242102e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.371261 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5774e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.093026e-01 1 1  ON 0
 uu_1                 1.425593e-01 1 1  ON 1
 uu_2                 4.090622e-02 1 1  ON 2
 uu_3                -2.151156e-02 1 1  ON 3
 uu_4                -6.691518e-02 1 1  ON 4
 uu_5                -1.013407e-01 1 1  ON 5
 uu_6                -1.281995e-01 1 1  ON 6
 uu_7                -1.411874e-01 1 1  ON 7
 uu_8                -1.329624e-01 1 1  ON 8
 uu_9                -1.043529e-01 1 1  ON 9
 ud_0                 4.443207e-01 1 1  ON 10
 ud_1                 1.800901e-01 1 1  ON 11
 ud_2                 6.327085e-02 1 1  ON 12
 ud_3                -6.166999e-03 1 1  ON 13
 ud_4                -6.410902e-02 1 1  ON 14
 ud_5                -1.066747e-01 1 1  ON 15
 ud_6                -1.344821e-01 1 1  ON 16
 ud_7                -1.516099e-01 1 1  ON 17
 ud_8                -1.521922e-01 1 1  ON 18
 ud_9                -1.426130e-01 1 1  ON 19
 eO_0                -7.585428e-01 1 1  ON 20
 eO_1                -4.404468e-01 1 1  ON 21
 eO_2                -2.263539e-02 1 1  ON 22
 eO_3                 2.977332e-01 1 1  ON 23
 eO_4                 5.252185e-01 1 1  ON 24
 eO_5                 4.870219e-01 1 1  ON 25
 eO_6                 2.596897e-01 1 1  ON 26
 eO_7                -4.096977e-02 1 1  ON 27
 eO_8                -2.205833e-01 1 1  ON 28
 eO_9                -8.531641e-02 1 1  ON 29
eH1_0                -2.414632e-01 1 1  ON 30
eH1_1                -1.440626e-01 1 1  ON 31
eH1_2                -9.924841e-02 1 1  ON 32
eH1_3                -4.541111e-02 1 1  ON 33
eH1_4                 2.876762e-03 1 1  ON 34
eH1_5                 3.773300e-02 1 1  ON 35
eH1_6                 9.700334e-02 1 1  ON 36
eH1_7                 1.538053e-01 1 1  ON 37
eH1_8                 1.762227e-01 1 1  ON 38
eH1_9                 6.657033e-02 1 1  ON 39
eH2_0                -2.395498e-01 1 1  ON 40
eH2_1                -1.418501e-01 1 1  ON 41
eH2_2                -9.688241e-02 1 1  ON 42
eH2_3                -4.316335e-02 1 1  ON 43
eH2_4                 5.094732e-03 1 1  ON 44
eH2_5                 3.979652e-02 1 1  ON 45
eH2_6                 9.952679e-02 1 1  ON 46
eH2_7                 1.556274e-01 1 1  ON 47
eH2_8                 1.821065e-01 1 1  ON 48
eH2_9                 5.593863e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.8502
    reference variance = 0.276955
====================================================
  Execution time = 1.9980e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.5561e-01
  Total weights = 2.0000e+06
  Execution time = 1.8710e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355417611570
                                         uncertainty =       0.015366726762

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355417611570
                                         uncertainty =       0.015366726762

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421668294
  error estimate for blocks of size 2^( 2) =       0.000433967831
  error estimate for blocks of size 2^( 3) =       0.000446905269
  error estimate for blocks of size 2^( 4) =       0.000458624876
  error estimate for blocks of size 2^( 5) =       0.000469685601
  error estimate for blocks of size 2^( 6) =       0.000477225813
  error estimate for blocks of size 2^( 7) =       0.000481993163

      target function =                  N/A
              le_mean =     -16.904845839552
             les_mean =     286.129420981573
             stat err =       0.000471882363
             autocorr =       1.252349647339
              std dev =       0.596329020216
             le_variance =       0.355608300352

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355417536512
                                         uncertainty =       0.015366736110

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355417536512
                                         uncertainty =       0.015366736110

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421668249
  error estimate for blocks of size 2^( 2) =       0.000433967791
  error estimate for blocks of size 2^( 3) =       0.000446905230
  error estimate for blocks of size 2^( 4) =       0.000458624837
  error estimate for blocks of size 2^( 5) =       0.000469685557
  error estimate for blocks of size 2^( 6) =       0.000477225771
  error estimate for blocks of size 2^( 7) =       0.000481993118

      target function =                  N/A
              le_mean =     -16.904845841176
             les_mean =     286.129420961225
             stat err =       0.000471882321
             autocorr =       1.252349685738
              std dev =       0.596328957113
             le_variance =       0.355608225091

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355417574024
                                         uncertainty =       0.015366731438

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355417574024
                                         uncertainty =       0.015366731438

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421668272
  error estimate for blocks of size 2^( 2) =       0.000433967811
  error estimate for blocks of size 2^( 3) =       0.000446905249
  error estimate for blocks of size 2^( 4) =       0.000458624856
  error estimate for blocks of size 2^( 5) =       0.000469685579
  error estimate for blocks of size 2^( 6) =       0.000477225792
  error estimate for blocks of size 2^( 7) =       0.000481993140

      target function =                  N/A
              le_mean =     -16.904845840365
             les_mean =     286.129420971391
             stat err =       0.000471882342
             autocorr =       1.252349666549
              std dev =       0.596328988650
             le_variance =       0.355608262705

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355417606876
                                         uncertainty =       0.015366727347

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355417606876
                                         uncertainty =       0.015366727347

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421668291
  error estimate for blocks of size 2^( 2) =       0.000433967829
  error estimate for blocks of size 2^( 3) =       0.000446905267
  error estimate for blocks of size 2^( 4) =       0.000458624874
  error estimate for blocks of size 2^( 5) =       0.000469685598
  error estimate for blocks of size 2^( 6) =       0.000477225811
  error estimate for blocks of size 2^( 7) =       0.000481993160

      target function =                  N/A
              le_mean =     -16.904845839654
             les_mean =     286.129420980299
             stat err =       0.000471882361
             autocorr =       1.252349649739
              std dev =       0.596329016270
             le_variance =       0.355608295646


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904845839552        initial
     5.6843e+02     5.6843e+03             3.5872e-07       -16.904845841176  <--
     2.2737e+03     2.2737e+04             8.9683e-08       -16.904845840365
     9.0949e+03     9.0949e+04             2.2421e-08       -16.904845839654

*****************************************************************************
Applying the update for shift_i =   5.6843e+02     and shift_s =   5.6843e+03
*****************************************************************************

  Execution time = 2.9455e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.093026e-01 1 1  ON 0
 uu_1                 1.425593e-01 1 1  ON 1
 uu_2                 4.090622e-02 1 1  ON 2
 uu_3                -2.151168e-02 1 1  ON 3
 uu_4                -6.691519e-02 1 1  ON 4
 uu_5                -1.013407e-01 1 1  ON 5
 uu_6                -1.281995e-01 1 1  ON 6
 uu_7                -1.411875e-01 1 1  ON 7
 uu_8                -1.329626e-01 1 1  ON 8
 uu_9                -1.043529e-01 1 1  ON 9
 ud_0                 4.443207e-01 1 1  ON 10
 ud_1                 1.800902e-01 1 1  ON 11
 ud_2                 6.327104e-02 1 1  ON 12
 ud_3                -6.166874e-03 1 1  ON 13
 ud_4                -6.410912e-02 1 1  ON 14
 ud_5                -1.066747e-01 1 1  ON 15
 ud_6                -1.344823e-01 1 1  ON 16
 ud_7                -1.516099e-01 1 1  ON 17
 ud_8                -1.521923e-01 1 1  ON 18
 ud_9                -1.426131e-01 1 1  ON 19
 eO_0                -7.585428e-01 1 1  ON 20
 eO_1                -4.404469e-01 1 1  ON 21
 eO_2                -2.263530e-02 1 1  ON 22
 eO_3                 2.977332e-01 1 1  ON 23
 eO_4                 5.252185e-01 1 1  ON 24
 eO_5                 4.870219e-01 1 1  ON 25
 eO_6                 2.596898e-01 1 1  ON 26
 eO_7                -4.096974e-02 1 1  ON 27
 eO_8                -2.205835e-01 1 1  ON 28
 eO_9                -8.531656e-02 1 1  ON 29
eH1_0                -2.414633e-01 1 1  ON 30
eH1_1                -1.440626e-01 1 1  ON 31
eH1_2                -9.924859e-02 1 1  ON 32
eH1_3                -4.541101e-02 1 1  ON 33
eH1_4                 2.876710e-03 1 1  ON 34
eH1_5                 3.773284e-02 1 1  ON 35
eH1_6                 9.700327e-02 1 1  ON 36
eH1_7                 1.538053e-01 1 1  ON 37
eH1_8                 1.762229e-01 1 1  ON 38
eH1_9                 6.657060e-02 1 1  ON 39
eH2_0                -2.395499e-01 1 1  ON 40
eH2_1                -1.418503e-01 1 1  ON 41
eH2_2                -9.688256e-02 1 1  ON 42
eH2_3                -4.316345e-02 1 1  ON 43
eH2_4                 5.094640e-03 1 1  ON 44
eH2_5                 3.979668e-02 1 1  ON 45
eH2_6                 9.952680e-02 1 1  ON 46
eH2_7                 1.556275e-01 1 1  ON 47
eH2_8                 1.821066e-01 1 1  ON 48
eH2_9                 5.593884e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5233e+01 secs
  Total Execution time = 2.2612e+03 secs

=========================================================
  A new xml input file : H2O.s039.cont.xml
