Rank =    0  Free Memory = 87719 MB
Rank =    1  Free Memory = 87718 MB
Rank =    2  Free Memory = 87718 MB
Rank =    3  Free Memory = 87718 MB
Rank =    4  Free Memory = 87718 MB
Rank =    5  Free Memory = 87718 MB
Rank =    6  Free Memory = 87718 MB
Rank =    7  Free Memory = 87717 MB
Rank =    8  Free Memory = 87717 MB
Rank =    9  Free Memory = 87717 MB
Rank =   10  Free Memory = 87717 MB
Rank =   11  Free Memory = 87717 MB
Rank =   12  Free Memory = 87717 MB
Rank =   13  Free Memory = 87717 MB
Rank =   14  Free Memory = 87716 MB
Rank =   15  Free Memory = 87703 MB
Rank =   16  Free Memory = 87702 MB
Rank =   17  Free Memory = 87702 MB
Rank =   18  Free Memory = 87702 MB
Rank =   19  Free Memory = 87702 MB
Rank =   20  Free Memory = 87702 MB
Rank =   21  Free Memory = 87702 MB
Rank =   22  Free Memory = 87702 MB
Rank =   23  Free Memory = 87702 MB
Rank =   24  Free Memory = 87702 MB
Rank =   25  Free Memory = 87702 MB
Rank =   26  Free Memory = 87702 MB
Rank =   27  Free Memory = 87702 MB
Rank =   28  Free Memory = 87702 MB
Rank =   29  Free Memory = 87702 MB
Rank =   30  Free Memory = 87702 MB
Rank =   31  Free Memory = 87702 MB
Rank =   32  Free Memory = 89942 MB
Rank =   33  Free Memory = 89942 MB
Rank =   34  Free Memory = 89942 MB
Rank =   35  Free Memory = 89942 MB
Rank =   36  Free Memory = 89942 MB
Rank =   37  Free Memory = 89942 MB
Rank =   38  Free Memory = 89942 MB
Rank =   39  Free Memory = 89942 MB
Rank =   40  Free Memory = 89942 MB
Rank =   41  Free Memory = 89942 MB
Rank =   42  Free Memory = 89942 MB
Rank =   43  Free Memory = 89942 MB
Rank =   44  Free Memory = 89942 MB
Rank =   45  Free Memory = 89942 MB
Rank =   46  Free Memory = 89942 MB
Rank =   47  Free Memory = 89942 MB
Rank =   48  Free Memory = 89942 MB
Rank =   49  Free Memory = 89942 MB
Rank =   50  Free Memory = 89942 MB
Rank =   51  Free Memory = 89942 MB
Rank =   52  Free Memory = 89942 MB
Rank =   53  Free Memory = 89942 MB
Rank =   54  Free Memory = 89942 MB
Rank =   55  Free Memory = 89942 MB
Rank =   56  Free Memory = 89942 MB
Rank =   57  Free Memory = 89942 MB
Rank =   58  Free Memory = 89942 MB
Rank =   59  Free Memory = 89942 MB
Rank =   60  Free Memory = 89942 MB
Rank =   61  Free Memory = 89942 MB
Rank =   62  Free Memory = 89942 MB
Rank =   63  Free Memory = 89942 MB
Rank =   64  Free Memory = 74483 MB
Rank =   65  Free Memory = 74483 MB
Rank =   66  Free Memory = 74483 MB
Rank =   67  Free Memory = 74483 MB
Rank =   68  Free Memory = 74483 MB
Rank =   69  Free Memory = 74483 MB
Rank =   70  Free Memory = 74483 MB
Rank =   71  Free Memory = 74483 MB
Rank =   72  Free Memory = 74483 MB
Rank =   73  Free Memory = 74483 MB
Rank =   74  Free Memory = 74483 MB
Rank =   75  Free Memory = 74483 MB
Rank =   76  Free Memory = 74483 MB
Rank =   77  Free Memory = 74483 MB
Rank =   78  Free Memory = 74482 MB
Rank =   79  Free Memory = 74482 MB
Rank =   80  Free Memory = 74482 MB
Rank =   81  Free Memory = 74482 MB
Rank =   82  Free Memory = 74482 MB
Rank =   83  Free Memory = 74482 MB
Rank =   84  Free Memory = 74482 MB
Rank =   85  Free Memory = 74482 MB
Rank =   86  Free Memory = 74482 MB
Rank =   87  Free Memory = 74482 MB
Rank =   88  Free Memory = 74482 MB
Rank =   89  Free Memory = 74482 MB
Rank =   90  Free Memory = 74482 MB
Rank =   91  Free Memory = 74482 MB
Rank =   92  Free Memory = 74482 MB
Rank =   93  Free Memory = 74482 MB
Rank =   94  Free Memory = 74482 MB
Rank =   95  Free Memory = 74482 MB
Rank =   96  Free Memory = 87950 MB
Rank =   97  Free Memory = 87950 MB
Rank =   98  Free Memory = 87950 MB
Rank =   99  Free Memory = 87950 MB
Rank =  100  Free Memory = 87950 MB
Rank =  101  Free Memory = 87950 MB
Rank =  102  Free Memory = 87950 MB
Rank =  103  Free Memory = 87950 MB
Rank =  104  Free Memory = 87950 MB
Rank =  105  Free Memory = 87950 MB
Rank =  106  Free Memory = 87950 MB
Rank =  107  Free Memory = 87950 MB
Rank =  108  Free Memory = 87950 MB
Rank =  109  Free Memory = 87950 MB
Rank =  110  Free Memory = 87950 MB
Rank =  111  Free Memory = 87950 MB
Rank =  112  Free Memory = 87950 MB
Rank =  113  Free Memory = 87950 MB
Rank =  114  Free Memory = 87950 MB
Rank =  115  Free Memory = 87950 MB
Rank =  116  Free Memory = 87950 MB
Rank =  117  Free Memory = 87950 MB
Rank =  118  Free Memory = 87950 MB
Rank =  119  Free Memory = 87950 MB
Rank =  120  Free Memory = 87950 MB
Rank =  121  Free Memory = 87949 MB
Rank =  122  Free Memory = 87949 MB
Rank =  123  Free Memory = 87949 MB
Rank =  124  Free Memory = 87949 MB
Rank =  125  Free Memory = 87949 MB
Rank =  126  Free Memory = 87949 MB
Rank =  127  Free Memory = 87949 MB
  Input file(s): opt_h2o_1b1_gvpabs_run001d.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 39b7557df04c29964085ccccce933740e3918067-dirty
  Last git commit date: Wed Mar 22 11:37:25 2023 -0700
  Last git commit subject: deleting more debugging statements
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_1b1_gvpabs_run001d.xml

  Project = H2O
  date    = 2023-03-24 21:17:49 PDT
  host    = n0016.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 493

  Range of prime numbers to use as seeds over processors and threads = 3539-4603


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 3.093026e-01    1         1  ON     0
     uu_1                 1.425593e-01    1         1  ON     1
     uu_2                 4.090622e-02    1         1  ON     2
     uu_3                -2.151168e-02    1         1  ON     3
     uu_4                -6.691519e-02    1         1  ON     4
     uu_5                -1.013407e-01    1         1  ON     5
     uu_6                -1.281995e-01    1         1  ON     6
     uu_7                -1.411875e-01    1         1  ON     7
     uu_8                -1.329626e-01    1         1  ON     8
     uu_9                -1.043529e-01    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 4.443207e-01    1         1  ON     0
     ud_1                 1.800902e-01    1         1  ON     1
     ud_2                 6.327104e-02    1         1  ON     2
     ud_3                -6.166874e-03    1         1  ON     3
     ud_4                -6.410912e-02    1         1  ON     4
     ud_5                -1.066747e-01    1         1  ON     5
     ud_6                -1.344823e-01    1         1  ON     6
     ud_7                -1.516099e-01    1         1  ON     7
     ud_8                -1.521923e-01    1         1  ON     8
     ud_9                -1.426131e-01    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.585428e-01    1         1  ON     0
     eO_1                -4.404469e-01    1         1  ON     1
     eO_2                -2.263530e-02    1         1  ON     2
     eO_3                 2.977332e-01    1         1  ON     3
     eO_4                 5.252185e-01    1         1  ON     4
     eO_5                 4.870219e-01    1         1  ON     5
     eO_6                 2.596898e-01    1         1  ON     6
     eO_7                -4.096974e-02    1         1  ON     7
     eO_8                -2.205835e-01    1         1  ON     8
     eO_9                -8.531656e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.414633e-01    1         1  ON     0
     eH1_1                -1.440626e-01    1         1  ON     1
     eH1_2                -9.924859e-02    1         1  ON     2
     eH1_3                -4.541101e-02    1         1  ON     3
     eH1_4                 2.876710e-03    1         1  ON     4
     eH1_5                 3.773284e-02    1         1  ON     5
     eH1_6                 9.700327e-02    1         1  ON     6
     eH1_7                 1.538053e-01    1         1  ON     7
     eH1_8                 1.762229e-01    1         1  ON     8
     eH1_9                 6.657060e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.395499e-01    1         1  ON     0
     eH2_1                -1.418503e-01    1         1  ON     1
     eH2_2                -9.688256e-02    1         1  ON     2
     eH2_3                -4.316345e-02    1         1  ON     3
     eH2_4                 5.094640e-03    1         1  ON     4
     eH2_5                 3.979668e-02    1         1  ON     5
     eH2_6                 9.952680e-02    1         1  ON     6
     eH2_7                 1.556275e-01    1         1  ON     7
     eH2_8                 1.821066e-01    1         1  ON     8
     eH2_9                 5.593884e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 75 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 2.725222e+00
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 30 unique up determinants.
Found 30 unique down determinants.
Number of terms in pairs array: 20
Number of terms in pairs array: 20
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 2.5659e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u  6.1002844054e-01  1.3250453608e-01 -4.2267217978e-01
    u -4.3494847795e-01 -2.3203549626e-01  1.0876787134e-01
    u -1.5984350305e-01  8.1842956548e-01  5.1837161342e-02
    u  1.1948334779e+00  1.4453040952e+00  1.6346730752e+00
    d -9.5054657961e-01  2.3768909128e-01 -6.0876959125e-01
    d -2.0429807517e-01  1.5546410594e+00 -1.0292769217e-01
    d  4.7451519973e-01  3.4811618685e-02  3.5425821429e-01
    d -8.6403568621e-02 -1.8286319639e+00  9.9844026831e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.8633
    reference variance = 0.196612
====================================================
  Execution time = 2.0868e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3410e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5516e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334158489663
                                         uncertainty =       0.003556449961

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334158489663
                                         uncertainty =       0.003556449961

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408718871
  error estimate for blocks of size 2^( 2) =       0.000421435523
  error estimate for blocks of size 2^( 3) =       0.000434694735
  error estimate for blocks of size 2^( 4) =       0.000446632767
  error estimate for blocks of size 2^( 5) =       0.000457386430
  error estimate for blocks of size 2^( 6) =       0.000465638911
  error estimate for blocks of size 2^( 7) =       0.000473777571

      target function =                  N/A
              le_mean =     -16.905781091401
             les_mean =     286.139536374231
             stat err =       0.000460858920
             autocorr =       1.271412904660
              std dev =       0.578015770482
             le_variance =       0.334102230926


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.690578109140e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905781091401       residual = 2.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905794629069       residual = 2.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905801822278       residual = 7.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905803619181       residual = 5.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905805731718       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905805448565       residual = 7.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905807052994       residual = 2.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905807560993       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905806344904       residual = 5.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905806473171       residual = 3.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905806824343       residual = 6.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.823605e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905781091401       residual = 2.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905786280471       residual = 3.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905789360154       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905789954373       residual = 3.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905790275168       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905790359669       residual = 4.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905790747084       residual = 9.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905791074474       residual = 4.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905790754478       residual = 6.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 6.836076e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905781091401       residual = 2.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905782588200       residual = 3.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905783546368       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905783734853       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905783760408       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905783721309       residual = 3.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905783851957       residual = 7.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905783930739       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905783897467       residual = 2.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 1.945014e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.006402 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6439e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  3.092480e-01                 1 1 ON  0
uu_1  1.425519e-01                 1 1 ON  1
uu_2  4.098273e-02                 1 1 ON  2
uu_3  -2.145414e-02                1 1 ON  3
uu_4  -6.683423e-02                1 1 ON  4
uu_5  -1.013541e-01                1 1 ON  5
uu_6  -1.282478e-01                1 1 ON  6
uu_7  -1.413355e-01                1 1 ON  7
uu_8  -1.330250e-01                1 1 ON  8
uu_9  -1.043702e-01                1 1 ON  9
ud_0  4.450043e-01                 1 1 ON  10
ud_1  1.805196e-01                 1 1 ON  11
ud_2  6.296274e-02                 1 1 ON  12
ud_3  -6.582474e-03                1 1 ON  13
ud_4  -6.424634e-02                1 1 ON  14
ud_5  -1.067951e-01                1 1 ON  15
ud_6  -1.345735e-01                1 1 ON  16
ud_7  -1.516206e-01                1 1 ON  17
ud_8  -1.521692e-01                1 1 ON  18
ud_9  -1.426399e-01                1 1 ON  19
eO_0  -7.588418e-01                1 1 ON  20
eO_1  -4.403821e-01                1 1 ON  21
eO_2  -2.245004e-02                1 1 ON  22
eO_3  2.979942e-01                 1 1 ON  23
eO_4  5.252395e-01                 1 1 ON  24
eO_5  4.870200e-01                 1 1 ON  25
eO_6  2.596374e-01                 1 1 ON  26
eO_7  -4.094472e-02                1 1 ON  27
eO_8  -2.206355e-01                1 1 ON  28
eO_9  -8.544730e-02                1 1 ON  29
eH1_0 -2.417531e-01                1 1 ON  30
eH1_1 -1.442424e-01                1 1 ON  31
eH1_2 -9.917500e-02                1 1 ON  32
eH1_3 -4.532069e-02                1 1 ON  33
eH1_4 3.014139e-03                 1 1 ON  34
eH1_5 3.773048e-02                 1 1 ON  35
eH1_6 9.700554e-02                 1 1 ON  36
eH1_7 1.537355e-01                 1 1 ON  37
eH1_8 1.763174e-01                 1 1 ON  38
eH1_9 6.670256e-02                 1 1 ON  39
eH2_0 -2.399331e-01                1 1 ON  40
eH2_1 -1.420393e-01                1 1 ON  41
eH2_2 -9.685081e-02                1 1 ON  42
eH2_3 -4.306923e-02                1 1 ON  43
eH2_4 5.133507e-03                 1 1 ON  44
eH2_5 3.990720e-02                 1 1 ON  45
eH2_6 9.950630e-02                 1 1 ON  46
eH2_7 1.555925e-01                 1 1 ON  47
eH2_8 1.822576e-01                 1 1 ON  48
eH2_9 5.613640e-02                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.8393
    reference variance = 0.289939
====================================================
  Execution time = 2.0579e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3767e-01
  Total weights = 2.0000e+06
  Execution time = 1.8701e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337093032171
                                         uncertainty =       0.003228318159

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337093032171
                                         uncertainty =       0.003228318159

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410578801
  error estimate for blocks of size 2^( 2) =       0.000423133716
  error estimate for blocks of size 2^( 3) =       0.000436439974
  error estimate for blocks of size 2^( 4) =       0.000448414674
  error estimate for blocks of size 2^( 5) =       0.000459903956
  error estimate for blocks of size 2^( 6) =       0.000467988460
  error estimate for blocks of size 2^( 7) =       0.000474773067

      target function =                  N/A
              le_mean =     -16.905544690150
             les_mean =     286.134591006477
             stat err =       0.000462770039
             autocorr =       1.270391041333
              std dev =       0.580646109419
             le_variance =       0.337149904383

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338424796419
                                         uncertainty =       0.003235039715

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338424796419
                                         uncertainty =       0.003235039715

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411389664
  error estimate for blocks of size 2^( 2) =       0.000423871915
  error estimate for blocks of size 2^( 3) =       0.000437097372
  error estimate for blocks of size 2^( 4) =       0.000449017061
  error estimate for blocks of size 2^( 5) =       0.000460469304
  error estimate for blocks of size 2^( 6) =       0.000468518102
  error estimate for blocks of size 2^( 7) =       0.000475231580

      target function =                  N/A
              le_mean =     -16.905539492081
             les_mean =     286.135748260079
             stat err =       0.000463309012
             autocorr =       1.268337239140
              std dev =       0.581792841996
             le_variance =       0.338482910998

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338146172298
                                         uncertainty =       0.003232871219

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338146172298
                                         uncertainty =       0.003232871219

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411220251
  error estimate for blocks of size 2^( 2) =       0.000423716263
  error estimate for blocks of size 2^( 3) =       0.000436957207
  error estimate for blocks of size 2^( 4) =       0.000448888383
  error estimate for blocks of size 2^( 5) =       0.000460346094
  error estimate for blocks of size 2^( 6) =       0.000468401745
  error estimate for blocks of size 2^( 7) =       0.000475132572

      target function =                  N/A
              le_mean =     -16.905540448488
             les_mean =     286.135501875216
             stat err =       0.000463192199
             autocorr =       1.268742492485
              std dev =       0.581553255386
             le_variance =       0.338204188850

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337241221231
                                         uncertainty =       0.003228909041

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337241221231
                                         uncertainty =       0.003228909041

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410669130
  error estimate for blocks of size 2^( 2) =       0.000423214839
  error estimate for blocks of size 2^( 3) =       0.000436511020
  error estimate for blocks of size 2^( 4) =       0.000448479113
  error estimate for blocks of size 2^( 5) =       0.000459963438
  error estimate for blocks of size 2^( 6) =       0.000468043659
  error estimate for blocks of size 2^( 7) =       0.000474820544

      target function =                  N/A
              le_mean =     -16.905543022950
             les_mean =     286.134683000891
             stat err =       0.000462826689
             autocorr =       1.270143155158
              std dev =       0.580773853332
             le_variance =       0.337298268714


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905544690150        initial  <--
     2.5000e-01     2.5000e+00             1.8236e-03       -16.905539492081
     1.0000e+00     1.0000e+01             6.8361e-04       -16.905540448488
     4.0000e+00     4.0000e+01             1.9450e-04       -16.905543022950

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0537
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 3.093026e-01 1 1  ON 0
 uu_1                 1.425593e-01 1 1  ON 1
 uu_2                 4.090622e-02 1 1  ON 2
 uu_3                -2.151168e-02 1 1  ON 3
 uu_4                -6.691519e-02 1 1  ON 4
 uu_5                -1.013407e-01 1 1  ON 5
 uu_6                -1.281995e-01 1 1  ON 6
 uu_7                -1.411875e-01 1 1  ON 7
 uu_8                -1.329626e-01 1 1  ON 8
 uu_9                -1.043529e-01 1 1  ON 9
 ud_0                 4.443207e-01 1 1  ON 10
 ud_1                 1.800902e-01 1 1  ON 11
 ud_2                 6.327104e-02 1 1  ON 12
 ud_3                -6.166874e-03 1 1  ON 13
 ud_4                -6.410912e-02 1 1  ON 14
 ud_5                -1.066747e-01 1 1  ON 15
 ud_6                -1.344823e-01 1 1  ON 16
 ud_7                -1.516099e-01 1 1  ON 17
 ud_8                -1.521923e-01 1 1  ON 18
 ud_9                -1.426131e-01 1 1  ON 19
 eO_0                -7.585428e-01 1 1  ON 20
 eO_1                -4.404469e-01 1 1  ON 21
 eO_2                -2.263530e-02 1 1  ON 22
 eO_3                 2.977332e-01 1 1  ON 23
 eO_4                 5.252185e-01 1 1  ON 24
 eO_5                 4.870219e-01 1 1  ON 25
 eO_6                 2.596898e-01 1 1  ON 26
 eO_7                -4.096974e-02 1 1  ON 27
 eO_8                -2.205835e-01 1 1  ON 28
 eO_9                -8.531656e-02 1 1  ON 29
eH1_0                -2.414633e-01 1 1  ON 30
eH1_1                -1.440626e-01 1 1  ON 31
eH1_2                -9.924859e-02 1 1  ON 32
eH1_3                -4.541101e-02 1 1  ON 33
eH1_4                 2.876710e-03 1 1  ON 34
eH1_5                 3.773284e-02 1 1  ON 35
eH1_6                 9.700327e-02 1 1  ON 36
eH1_7                 1.538053e-01 1 1  ON 37
eH1_8                 1.762229e-01 1 1  ON 38
eH1_9                 6.657060e-02 1 1  ON 39
eH2_0                -2.395499e-01 1 1  ON 40
eH2_1                -1.418503e-01 1 1  ON 41
eH2_2                -9.688256e-02 1 1  ON 42
eH2_3                -4.316345e-02 1 1  ON 43
eH2_4                 5.094640e-03 1 1  ON 44
eH2_5                 3.979668e-02 1 1  ON 45
eH2_6                 9.952680e-02 1 1  ON 46
eH2_7                 1.556275e-01 1 1  ON 47
eH2_8                 1.821066e-01 1 1  ON 48
eH2_9                 5.593884e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6499e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6851e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.8499
    reference variance = 0.279918
====================================================
  Execution time = 2.0303e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4153e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7488e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341566421405
                                         uncertainty =       0.004785636493

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341566421405
                                         uncertainty =       0.004785636493

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413239104
  error estimate for blocks of size 2^( 2) =       0.000425771868
  error estimate for blocks of size 2^( 3) =       0.000438902583
  error estimate for blocks of size 2^( 4) =       0.000450572300
  error estimate for blocks of size 2^( 5) =       0.000461197121
  error estimate for blocks of size 2^( 6) =       0.000470579920
  error estimate for blocks of size 2^( 7) =       0.000475239056

      target function =                  N/A
              le_mean =     -16.905233783314
             les_mean =     286.128462211397
             stat err =       0.000464397099
             autocorr =       1.262920972217
              std dev =       0.584408344952
             le_variance =       0.341533113649


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690523378331e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905233783314       residual = 2.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905235706381       residual = 4.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905236960419       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905237298218       residual = 3.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905237169855       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905237158961       residual = 4.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905237526508       residual = 9.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905237610098       residual = 3.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905237619546       residual = 4.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 2.665898e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905233783314       residual = 2.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905234294894       residual = 4.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905234637147       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905234728190       residual = 3.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905234673643       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905234648520       residual = 4.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905234743260       residual = 9.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905234767991       residual = 2.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905234774888       residual = 3.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 6.950104e-05

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905233783314       residual = 2.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905233913292       residual = 4.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905234000914       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905234024177       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905234009068       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905234000852       residual = 4.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905234024339       residual = 9.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905234030878       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905234032819       residual = 2.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+01 is 1.797484e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.009460 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6067e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.092866e-01 1 1  ON 0
 uu_1                 1.425415e-01 1 1  ON 1
 uu_2                 4.091058e-02 1 1  ON 2
 uu_3                -2.151618e-02 1 1  ON 3
 uu_4                -6.690673e-02 1 1  ON 4
 uu_5                -1.013360e-01 1 1  ON 5
 uu_6                -1.282023e-01 1 1  ON 6
 uu_7                -1.411838e-01 1 1  ON 7
 uu_8                -1.329558e-01 1 1  ON 8
 uu_9                -1.043515e-01 1 1  ON 9
 ud_0                 4.443889e-01 1 1  ON 10
 ud_1                 1.801597e-01 1 1  ON 11
 ud_2                 6.322678e-02 1 1  ON 12
 ud_3                -6.216706e-03 1 1  ON 13
 ud_4                -6.411762e-02 1 1  ON 14
 ud_5                -1.066897e-01 1 1  ON 15
 ud_6                -1.344972e-01 1 1  ON 16
 ud_7                -1.516190e-01 1 1  ON 17
 ud_8                -1.521960e-01 1 1  ON 18
 ud_9                -1.426090e-01 1 1  ON 19
 eO_0                -7.585808e-01 1 1  ON 20
 eO_1                -4.404565e-01 1 1  ON 21
 eO_2                -2.259754e-02 1 1  ON 22
 eO_3                 2.977612e-01 1 1  ON 23
 eO_4                 5.252119e-01 1 1  ON 24
 eO_5                 4.870311e-01 1 1  ON 25
 eO_6                 2.596903e-01 1 1  ON 26
 eO_7                -4.096642e-02 1 1  ON 27
 eO_8                -2.205903e-01 1 1  ON 28
 eO_9                -8.533054e-02 1 1  ON 29
eH1_0                -2.415027e-01 1 1  ON 30
eH1_1                -1.440788e-01 1 1  ON 31
eH1_2                -9.922841e-02 1 1  ON 32
eH1_3                -4.540248e-02 1 1  ON 33
eH1_4                 2.882297e-03 1 1  ON 34
eH1_5                 3.772870e-02 1 1  ON 35
eH1_6                 9.699748e-02 1 1  ON 36
eH1_7                 1.538025e-01 1 1  ON 37
eH1_8                 1.762405e-01 1 1  ON 38
eH1_9                 6.658850e-02 1 1  ON 39
eH2_0                -2.395730e-01 1 1  ON 40
eH2_1                -1.418817e-01 1 1  ON 41
eH2_2                -9.688239e-02 1 1  ON 42
eH2_3                -4.315688e-02 1 1  ON 43
eH2_4                 5.110941e-03 1 1  ON 44
eH2_5                 3.979716e-02 1 1  ON 45
eH2_6                 9.952251e-02 1 1  ON 46
eH2_7                 1.556208e-01 1 1  ON 47
eH2_8                 1.821220e-01 1 1  ON 48
eH2_9                 5.596439e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.9149
    reference variance = 0.295272
====================================================
  Execution time = 2.1977e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3148e-01
  Total weights = 2.0000e+06
  Execution time = 1.8905e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331506134143
                                         uncertainty =       0.002430358424

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331506134143
                                         uncertainty =       0.002430358424

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407083191
  error estimate for blocks of size 2^( 2) =       0.000419831438
  error estimate for blocks of size 2^( 3) =       0.000432894396
  error estimate for blocks of size 2^( 4) =       0.000445294599
  error estimate for blocks of size 2^( 5) =       0.000455120665
  error estimate for blocks of size 2^( 6) =       0.000463382408
  error estimate for blocks of size 2^( 7) =       0.000469776394

      target function =                  N/A
              le_mean =     -16.906152416572
             les_mean =     286.149422815684
             stat err =       0.000458393517
             autocorr =       1.267974712463
              std dev =       0.575702569951
             le_variance =       0.331433449048

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331681409587
                                         uncertainty =       0.002432217900

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331681409587
                                         uncertainty =       0.002432217900

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407190735
  error estimate for blocks of size 2^( 2) =       0.000419925632
  error estimate for blocks of size 2^( 3) =       0.000432975387
  error estimate for blocks of size 2^( 4) =       0.000445365835
  error estimate for blocks of size 2^( 5) =       0.000455186484
  error estimate for blocks of size 2^( 6) =       0.000463442253
  error estimate for blocks of size 2^( 7) =       0.000469834655

      target function =                  N/A
              le_mean =     -16.906150690885
             les_mean =     286.149539605998
             stat err =       0.000458457307
             autocorr =       1.267657770106
              std dev =       0.575854659528
             le_variance =       0.331608588900

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331595589343
                                         uncertainty =       0.002431335916

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331595589343
                                         uncertainty =       0.002431335916

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407138079
  error estimate for blocks of size 2^( 2) =       0.000419879084
  error estimate for blocks of size 2^( 3) =       0.000432934877
  error estimate for blocks of size 2^( 4) =       0.000445329850
  error estimate for blocks of size 2^( 5) =       0.000455153002
  error estimate for blocks of size 2^( 6) =       0.000463411612
  error estimate for blocks of size 2^( 7) =       0.000469804638

      target function =                  N/A
              le_mean =     -16.906151412322
             les_mean =     286.149478241870
             stat err =       0.000458424775
             autocorr =       1.267805742836
              std dev =       0.575780193527
             le_variance =       0.331522831259

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331517257796
                                         uncertainty =       0.002430481905

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331517257796
                                         uncertainty =       0.002430481905

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407090017
  error estimate for blocks of size 2^( 2) =       0.000419837333
  error estimate for blocks of size 2^( 3) =       0.000432899372
  error estimate for blocks of size 2^( 4) =       0.000445298907
  error estimate for blocks of size 2^( 5) =       0.000455124602
  error estimate for blocks of size 2^( 6) =       0.000463385949
  error estimate for blocks of size 2^( 7) =       0.000469779810

      target function =                  N/A
              le_mean =     -16.906152273606
             les_mean =     286.149429096036
             stat err =       0.000458397317
             autocorr =       1.267953216617
              std dev =       0.575712222732
             le_variance =       0.331444563403


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906152416572        initial  <--
     2.5000e+00     2.5000e+01             2.6659e-04       -16.906150690885
     1.0000e+01     1.0000e+02             6.9501e-05       -16.906151412322
     4.0000e+01     4.0000e+02             1.7975e-05       -16.906152273606

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.5077
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.093026e-01 1 1  ON 0
 uu_1                 1.425593e-01 1 1  ON 1
 uu_2                 4.090622e-02 1 1  ON 2
 uu_3                -2.151168e-02 1 1  ON 3
 uu_4                -6.691519e-02 1 1  ON 4
 uu_5                -1.013407e-01 1 1  ON 5
 uu_6                -1.281995e-01 1 1  ON 6
 uu_7                -1.411875e-01 1 1  ON 7
 uu_8                -1.329626e-01 1 1  ON 8
 uu_9                -1.043529e-01 1 1  ON 9
 ud_0                 4.443207e-01 1 1  ON 10
 ud_1                 1.800902e-01 1 1  ON 11
 ud_2                 6.327104e-02 1 1  ON 12
 ud_3                -6.166874e-03 1 1  ON 13
 ud_4                -6.410912e-02 1 1  ON 14
 ud_5                -1.066747e-01 1 1  ON 15
 ud_6                -1.344823e-01 1 1  ON 16
 ud_7                -1.516099e-01 1 1  ON 17
 ud_8                -1.521923e-01 1 1  ON 18
 ud_9                -1.426131e-01 1 1  ON 19
 eO_0                -7.585428e-01 1 1  ON 20
 eO_1                -4.404469e-01 1 1  ON 21
 eO_2                -2.263530e-02 1 1  ON 22
 eO_3                 2.977332e-01 1 1  ON 23
 eO_4                 5.252185e-01 1 1  ON 24
 eO_5                 4.870219e-01 1 1  ON 25
 eO_6                 2.596898e-01 1 1  ON 26
 eO_7                -4.096974e-02 1 1  ON 27
 eO_8                -2.205835e-01 1 1  ON 28
 eO_9                -8.531656e-02 1 1  ON 29
eH1_0                -2.414633e-01 1 1  ON 30
eH1_1                -1.440626e-01 1 1  ON 31
eH1_2                -9.924859e-02 1 1  ON 32
eH1_3                -4.541101e-02 1 1  ON 33
eH1_4                 2.876710e-03 1 1  ON 34
eH1_5                 3.773284e-02 1 1  ON 35
eH1_6                 9.700327e-02 1 1  ON 36
eH1_7                 1.538053e-01 1 1  ON 37
eH1_8                 1.762229e-01 1 1  ON 38
eH1_9                 6.657060e-02 1 1  ON 39
eH2_0                -2.395499e-01 1 1  ON 40
eH2_1                -1.418503e-01 1 1  ON 41
eH2_2                -9.688256e-02 1 1  ON 42
eH2_3                -4.316345e-02 1 1  ON 43
eH2_4                 5.094640e-03 1 1  ON 44
eH2_5                 3.979668e-02 1 1  ON 45
eH2_6                 9.952680e-02 1 1  ON 46
eH2_7                 1.556275e-01 1 1  ON 47
eH2_8                 1.821066e-01 1 1  ON 48
eH2_9                 5.593884e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7581e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6867e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.9638
    reference variance = 0.288084
====================================================
  Execution time = 2.0355e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3935e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5487e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339414572109
                                         uncertainty =       0.004547711976

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339414572109
                                         uncertainty =       0.004547711976

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411916099
  error estimate for blocks of size 2^( 2) =       0.000424613875
  error estimate for blocks of size 2^( 3) =       0.000438511990
  error estimate for blocks of size 2^( 4) =       0.000451418724
  error estimate for blocks of size 2^( 5) =       0.000463025064
  error estimate for blocks of size 2^( 6) =       0.000474715145
  error estimate for blocks of size 2^( 7) =       0.000476806668

      target function =                  N/A
              le_mean =     -16.905698601951
             les_mean =     286.141994794834
             stat err =       0.000466491400
             autocorr =       1.282536558228
              std dev =       0.582537333152
             le_variance =       0.339349744516


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690569860195e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905698601951       residual = 2.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905699160311       residual = 3.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905699390126       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905699445827       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905699515504       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905699521530       residual = 4.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905699534874       residual = 7.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905699535616       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905699537706       residual = 2.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+01 is 2.778966e-05

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905698601951       residual = 2.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905698742408       residual = 3.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905698800443       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905698814581       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905698832291       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905698833902       residual = 4.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905698837062       residual = 7.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905698837277       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905698837802       residual = 1.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+02 is 7.045534e-06

solving harmonic davidson linear method for identity shift 4.0000e+02, overlap shift 4.0000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905698601951       residual = 2.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905698637120       residual = 3.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905698651665       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905698655213       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905698659659       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905698660069       residual = 4.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905698660847       residual = 7.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905698660903       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905698661034       residual = 1.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+02 is 1.767662e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.012542 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5915e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.093003e-01 1 1  ON 0
 uu_1                 1.425591e-01 1 1  ON 1
 uu_2                 4.090670e-02 1 1  ON 2
 uu_3                -2.151078e-02 1 1  ON 3
 uu_4                -6.691387e-02 1 1  ON 4
 uu_5                -1.013413e-01 1 1  ON 5
 uu_6                -1.282000e-01 1 1  ON 6
 uu_7                -1.411886e-01 1 1  ON 7
 uu_8                -1.329632e-01 1 1  ON 8
 uu_9                -1.043527e-01 1 1  ON 9
 ud_0                 4.443260e-01 1 1  ON 10
 ud_1                 1.800972e-01 1 1  ON 11
 ud_2                 6.326710e-02 1 1  ON 12
 ud_3                -6.172014e-03 1 1  ON 13
 ud_4                -6.411094e-02 1 1  ON 14
 ud_5                -1.066761e-01 1 1  ON 15
 ud_6                -1.344833e-01 1 1  ON 16
 ud_7                -1.516108e-01 1 1  ON 17
 ud_8                -1.521910e-01 1 1  ON 18
 ud_9                -1.426121e-01 1 1  ON 19
 eO_0                -7.585468e-01 1 1  ON 20
 eO_1                -4.404457e-01 1 1  ON 21
 eO_2                -2.263355e-02 1 1  ON 22
 eO_3                 2.977370e-01 1 1  ON 23
 eO_4                 5.252181e-01 1 1  ON 24
 eO_5                 4.870215e-01 1 1  ON 25
 eO_6                 2.596892e-01 1 1  ON 26
 eO_7                -4.096969e-02 1 1  ON 27
 eO_8                -2.205837e-01 1 1  ON 28
 eO_9                -8.531747e-02 1 1  ON 29
eH1_0                -2.414659e-01 1 1  ON 30
eH1_1                -1.440643e-01 1 1  ON 31
eH1_2                -9.924857e-02 1 1  ON 32
eH1_3                -4.540978e-02 1 1  ON 33
eH1_4                 2.877136e-03 1 1  ON 34
eH1_5                 3.773209e-02 1 1  ON 35
eH1_6                 9.700292e-02 1 1  ON 36
eH1_7                 1.538052e-01 1 1  ON 37
eH1_8                 1.762241e-01 1 1  ON 38
eH1_9                 6.657278e-02 1 1  ON 39
eH2_0                -2.395539e-01 1 1  ON 40
eH2_1                -1.418531e-01 1 1  ON 41
eH2_2                -9.688352e-02 1 1  ON 42
eH2_3                -4.316331e-02 1 1  ON 43
eH2_4                 5.096570e-03 1 1  ON 44
eH2_5                 3.979679e-02 1 1  ON 45
eH2_6                 9.952742e-02 1 1  ON 46
eH2_7                 1.556278e-01 1 1  ON 47
eH2_8                 1.821079e-01 1 1  ON 48
eH2_9                 5.594156e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.8825
    reference variance = 0.44257
====================================================
  Execution time = 2.0008e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4189e-01
  Total weights = 2.0000e+06
  Execution time = 1.8806e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341891870310
                                         uncertainty =       0.004301980921

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341891870310
                                         uncertainty =       0.004301980921

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413455337
  error estimate for blocks of size 2^( 2) =       0.000426312822
  error estimate for blocks of size 2^( 3) =       0.000439315222
  error estimate for blocks of size 2^( 4) =       0.000451574966
  error estimate for blocks of size 2^( 5) =       0.000462869540
  error estimate for blocks of size 2^( 6) =       0.000470565203
  error estimate for blocks of size 2^( 7) =       0.000477074472

      target function =                  N/A
              le_mean =     -16.905206513140
             les_mean =     286.127897713060
             stat err =       0.000465521045
             autocorr =       1.267714427329
              std dev =       0.584714145621
             le_variance =       0.341890632089

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341905475596
                                         uncertainty =       0.004302119846

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341905475596
                                         uncertainty =       0.004302119846

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413463562
  error estimate for blocks of size 2^( 2) =       0.000426319791
  error estimate for blocks of size 2^( 3) =       0.000439320898
  error estimate for blocks of size 2^( 4) =       0.000451579901
  error estimate for blocks of size 2^( 5) =       0.000462873987
  error estimate for blocks of size 2^( 6) =       0.000470569869
  error estimate for blocks of size 2^( 7) =       0.000477079138

      target function =                  N/A
              le_mean =     -16.905206567802
             les_mean =     286.127913163678
             stat err =       0.000465525724
             autocorr =       1.267689473057
              std dev =       0.584725777248
             le_variance =       0.341904234579

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341898644308
                                         uncertainty =       0.004302049916

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341898644308
                                         uncertainty =       0.004302049916

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413459433
  error estimate for blocks of size 2^( 2) =       0.000426316285
  error estimate for blocks of size 2^( 3) =       0.000439318035
  error estimate for blocks of size 2^( 4) =       0.000451577406
  error estimate for blocks of size 2^( 5) =       0.000462871736
  error estimate for blocks of size 2^( 6) =       0.000470567511
  error estimate for blocks of size 2^( 7) =       0.000477076782

      target function =                  N/A
              le_mean =     -16.905206539107
             les_mean =     286.127905363589
             stat err =       0.000465523359
             autocorr =       1.267701915466
              std dev =       0.584719936962
             le_variance =       0.341897404681

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341892715439
                                         uncertainty =       0.004301989528

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341892715439
                                         uncertainty =       0.004301989528

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413455848
  error estimate for blocks of size 2^( 2) =       0.000426313254
  error estimate for blocks of size 2^( 3) =       0.000439315573
  error estimate for blocks of size 2^( 4) =       0.000451575269
  error estimate for blocks of size 2^( 5) =       0.000462869813
  error estimate for blocks of size 2^( 6) =       0.000470565490
  error estimate for blocks of size 2^( 7) =       0.000477074759

      target function =                  N/A
              le_mean =     -16.905206516229
             les_mean =     286.127898662450
             stat err =       0.000465521333
             autocorr =       1.267712861926
              std dev =       0.584714868155
             le_variance =       0.341891477041


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905206513140        initial
     2.5000e+01     2.5000e+02             2.7790e-05       -16.905206567802  <--
     1.0000e+02     1.0000e+03             7.0455e-06       -16.905206539107
     4.0000e+02     4.0000e+03             1.7677e-06       -16.905206516229

*****************************************************************************
Applying the update for shift_i =   2.5000e+01     and shift_s =   2.5000e+02
*****************************************************************************

  Execution time = 2.9511e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.092935e-01 1 1  ON 0
 uu_1                 1.425583e-01 1 1  ON 1
 uu_2                 4.090812e-02 1 1  ON 2
 uu_3                -2.150811e-02 1 1  ON 3
 uu_4                -6.690999e-02 1 1  ON 4
 uu_5                -1.013433e-01 1 1  ON 5
 uu_6                -1.282018e-01 1 1  ON 6
 uu_7                -1.411916e-01 1 1  ON 7
 uu_8                -1.329652e-01 1 1  ON 8
 uu_9                -1.043520e-01 1 1  ON 9
 ud_0                 4.443419e-01 1 1  ON 10
 ud_1                 1.801180e-01 1 1  ON 11
 ud_2                 6.325556e-02 1 1  ON 12
 ud_3                -6.187356e-03 1 1  ON 13
 ud_4                -6.411646e-02 1 1  ON 14
 ud_5                -1.066803e-01 1 1  ON 15
 ud_6                -1.344863e-01 1 1  ON 16
 ud_7                -1.516135e-01 1 1  ON 17
 ud_8                -1.521870e-01 1 1  ON 18
 ud_9                -1.426090e-01 1 1  ON 19
 eO_0                -7.585587e-01 1 1  ON 20
 eO_1                -4.404423e-01 1 1  ON 21
 eO_2                -2.262834e-02 1 1  ON 22
 eO_3                 2.977482e-01 1 1  ON 23
 eO_4                 5.252169e-01 1 1  ON 24
 eO_5                 4.870203e-01 1 1  ON 25
 eO_6                 2.596877e-01 1 1  ON 26
 eO_7                -4.096954e-02 1 1  ON 27
 eO_8                -2.205845e-01 1 1  ON 28
 eO_9                -8.532022e-02 1 1  ON 29
eH1_0                -2.414736e-01 1 1  ON 30
eH1_1                -1.440693e-01 1 1  ON 31
eH1_2                -9.924851e-02 1 1  ON 32
eH1_3                -4.540611e-02 1 1  ON 33
eH1_4                 2.878413e-03 1 1  ON 34
eH1_5                 3.772983e-02 1 1  ON 35
eH1_6                 9.700187e-02 1 1  ON 36
eH1_7                 1.538051e-01 1 1  ON 37
eH1_8                 1.762276e-01 1 1  ON 38
eH1_9                 6.657929e-02 1 1  ON 39
eH2_0                -2.395659e-01 1 1  ON 40
eH2_1                -1.418613e-01 1 1  ON 41
eH2_2                -9.688640e-02 1 1  ON 42
eH2_3                -4.316289e-02 1 1  ON 43
eH2_4                 5.102322e-03 1 1  ON 44
eH2_5                 3.979711e-02 1 1  ON 45
eH2_6                 9.952930e-02 1 1  ON 46
eH2_7                 1.556288e-01 1 1  ON 47
eH2_8                 1.821117e-01 1 1  ON 48
eH2_9                 5.594969e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5431e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6886e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.8783
    reference variance = 0.303443
====================================================
  Execution time = 2.0423e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4525e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6721e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345264549415
                                         uncertainty =       0.006781114075

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345264549415
                                         uncertainty =       0.006781114075

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415479020
  error estimate for blocks of size 2^( 2) =       0.000428140278
  error estimate for blocks of size 2^( 3) =       0.000441551794
  error estimate for blocks of size 2^( 4) =       0.000454565972
  error estimate for blocks of size 2^( 5) =       0.000465354840
  error estimate for blocks of size 2^( 6) =       0.000473564002
  error estimate for blocks of size 2^( 7) =       0.000478944023

      target function =                  N/A
              le_mean =     -16.905404879234
             les_mean =     286.137959590991
             stat err =       0.000468107209
             autocorr =       1.269382366867
              std dev =       0.587576065526
             le_variance =       0.345245632779


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690540487923e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905404879234       residual = 2.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905405224215       residual = 3.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905405347555       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905405444164       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905405597211       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905405728260       residual = 3.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905405654779       residual = 8.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905405669239       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905405676211       residual = 2.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 1.007236e-04

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905404879234       residual = 2.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905404967722       residual = 3.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905405000328       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905405026377       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905405067203       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905405104371       residual = 3.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905405085218       residual = 7.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905405088277       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905405089419       residual = 1.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+01 is 2.550943e-05

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905404879234       residual = 2.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905404901501       residual = 3.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905404909770       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905404916410       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905404926790       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905404936386       residual = 3.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905404931564       residual = 7.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905404932289       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905404932539       residual = 1.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+02 is 6.395503e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.015645 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6107e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.092893e-01 1 1  ON 0
 uu_1                 1.425575e-01 1 1  ON 1
 uu_2                 4.091015e-02 1 1  ON 2
 uu_3                -2.150869e-02 1 1  ON 3
 uu_4                -6.690522e-02 1 1  ON 4
 uu_5                -1.013455e-01 1 1  ON 5
 uu_6                -1.282043e-01 1 1  ON 6
 uu_7                -1.411996e-01 1 1  ON 7
 uu_8                -1.329664e-01 1 1  ON 8
 uu_9                -1.043506e-01 1 1  ON 9
 ud_0                 4.443674e-01 1 1  ON 10
 ud_1                 1.801404e-01 1 1  ON 11
 ud_2                 6.323915e-02 1 1  ON 12
 ud_3                -6.205644e-03 1 1  ON 13
 ud_4                -6.412488e-02 1 1  ON 14
 ud_5                -1.066814e-01 1 1  ON 15
 ud_6                -1.344909e-01 1 1  ON 16
 ud_7                -1.516168e-01 1 1  ON 17
 ud_8                -1.521859e-01 1 1  ON 18
 ud_9                -1.426059e-01 1 1  ON 19
 eO_0                -7.585735e-01 1 1  ON 20
 eO_1                -4.404460e-01 1 1  ON 21
 eO_2                -2.261874e-02 1 1  ON 22
 eO_3                 2.977663e-01 1 1  ON 23
 eO_4                 5.252153e-01 1 1  ON 24
 eO_5                 4.870193e-01 1 1  ON 25
 eO_6                 2.596883e-01 1 1  ON 26
 eO_7                -4.096861e-02 1 1  ON 27
 eO_8                -2.205874e-01 1 1  ON 28
 eO_9                -8.532449e-02 1 1  ON 29
eH1_0                -2.414837e-01 1 1  ON 30
eH1_1                -1.440745e-01 1 1  ON 31
eH1_2                -9.924615e-02 1 1  ON 32
eH1_3                -4.540644e-02 1 1  ON 33
eH1_4                 2.879408e-03 1 1  ON 34
eH1_5                 3.773080e-02 1 1  ON 35
eH1_6                 9.699775e-02 1 1  ON 36
eH1_7                 1.538031e-01 1 1  ON 37
eH1_8                 1.762343e-01 1 1  ON 38
eH1_9                 6.658876e-02 1 1  ON 39
eH2_0                -2.395814e-01 1 1  ON 40
eH2_1                -1.418698e-01 1 1  ON 41
eH2_2                -9.688157e-02 1 1  ON 42
eH2_3                -4.316068e-02 1 1  ON 43
eH2_4                 5.108133e-03 1 1  ON 44
eH2_5                 3.979982e-02 1 1  ON 45
eH2_6                 9.952892e-02 1 1  ON 46
eH2_7                 1.556261e-01 1 1  ON 47
eH2_8                 1.821136e-01 1 1  ON 48
eH2_9                 5.595671e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.9061
    reference variance = 0.270289
====================================================
  Execution time = 2.0518e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3333e-01
  Total weights = 2.0000e+06
  Execution time = 1.8783e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333402413282
                                         uncertainty =       0.003172003387

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333402413282
                                         uncertainty =       0.003172003387

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408232420
  error estimate for blocks of size 2^( 2) =       0.000421212486
  error estimate for blocks of size 2^( 3) =       0.000434379555
  error estimate for blocks of size 2^( 4) =       0.000446678548
  error estimate for blocks of size 2^( 5) =       0.000458809660
  error estimate for blocks of size 2^( 6) =       0.000466573170
  error estimate for blocks of size 2^( 7) =       0.000470517618

      target function =                  N/A
              le_mean =     -16.905644017078
             les_mean =     286.134106883283
             stat err =       0.000460644749
             autocorr =       1.273260502068
              std dev =       0.577327825210
             le_variance =       0.333307417762

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333478980906
                                         uncertainty =       0.003173504166

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333478980906
                                         uncertainty =       0.003173504166

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408279325
  error estimate for blocks of size 2^( 2) =       0.000421253811
  error estimate for blocks of size 2^( 3) =       0.000434415575
  error estimate for blocks of size 2^( 4) =       0.000446711699
  error estimate for blocks of size 2^( 5) =       0.000458842585
  error estimate for blocks of size 2^( 6) =       0.000466610141
  error estimate for blocks of size 2^( 7) =       0.000470553482

      target function =                  N/A
              le_mean =     -16.905643890567
             les_mean =     286.134179201857
             stat err =       0.000460679477
             autocorr =       1.273159908353
              std dev =       0.577394158157
             le_variance =       0.333384013874

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333441309759
                                         uncertainty =       0.003172780921

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333441309759
                                         uncertainty =       0.003172780921

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408256249
  error estimate for blocks of size 2^( 2) =       0.000421233420
  error estimate for blocks of size 2^( 3) =       0.000434397742
  error estimate for blocks of size 2^( 4) =       0.000446695245
  error estimate for blocks of size 2^( 5) =       0.000458826228
  error estimate for blocks of size 2^( 6) =       0.000466591917
  error estimate for blocks of size 2^( 7) =       0.000470535763

      target function =                  N/A
              le_mean =     -16.905643932244
             les_mean =     286.134142926423
             stat err =       0.000460662288
             autocorr =       1.273208821971
              std dev =       0.577361523900
             le_variance =       0.333346329280

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333407284238
                                         uncertainty =       0.003172101456

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333407284238
                                         uncertainty =       0.003172101456

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408235404
  error estimate for blocks of size 2^( 2) =       0.000421215104
  error estimate for blocks of size 2^( 3) =       0.000434381826
  error estimate for blocks of size 2^( 4) =       0.000446680631
  error estimate for blocks of size 2^( 5) =       0.000458811726
  error estimate for blocks of size 2^( 6) =       0.000466575514
  error estimate for blocks of size 2^( 7) =       0.000470519885

      target function =                  N/A
              le_mean =     -16.905644004168
             les_mean =     286.134111319616
             stat err =       0.000460646939
             autocorr =       1.273253992721
              std dev =       0.577332045382
             le_variance =       0.333312290625


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905644017078        initial  <--
     6.2500e+00     6.2500e+01             1.0072e-04       -16.905643890567
     2.5000e+01     2.5000e+02             2.5509e-05       -16.905643932244
     1.0000e+02     1.0000e+03             6.3955e-06       -16.905644004168

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0045
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.092935e-01 1 1  ON 0
 uu_1                 1.425583e-01 1 1  ON 1
 uu_2                 4.090812e-02 1 1  ON 2
 uu_3                -2.150811e-02 1 1  ON 3
 uu_4                -6.690999e-02 1 1  ON 4
 uu_5                -1.013433e-01 1 1  ON 5
 uu_6                -1.282018e-01 1 1  ON 6
 uu_7                -1.411916e-01 1 1  ON 7
 uu_8                -1.329652e-01 1 1  ON 8
 uu_9                -1.043520e-01 1 1  ON 9
 ud_0                 4.443419e-01 1 1  ON 10
 ud_1                 1.801180e-01 1 1  ON 11
 ud_2                 6.325556e-02 1 1  ON 12
 ud_3                -6.187356e-03 1 1  ON 13
 ud_4                -6.411646e-02 1 1  ON 14
 ud_5                -1.066803e-01 1 1  ON 15
 ud_6                -1.344863e-01 1 1  ON 16
 ud_7                -1.516135e-01 1 1  ON 17
 ud_8                -1.521870e-01 1 1  ON 18
 ud_9                -1.426090e-01 1 1  ON 19
 eO_0                -7.585587e-01 1 1  ON 20
 eO_1                -4.404423e-01 1 1  ON 21
 eO_2                -2.262834e-02 1 1  ON 22
 eO_3                 2.977482e-01 1 1  ON 23
 eO_4                 5.252169e-01 1 1  ON 24
 eO_5                 4.870203e-01 1 1  ON 25
 eO_6                 2.596877e-01 1 1  ON 26
 eO_7                -4.096954e-02 1 1  ON 27
 eO_8                -2.205845e-01 1 1  ON 28
 eO_9                -8.532022e-02 1 1  ON 29
eH1_0                -2.414736e-01 1 1  ON 30
eH1_1                -1.440693e-01 1 1  ON 31
eH1_2                -9.924851e-02 1 1  ON 32
eH1_3                -4.540611e-02 1 1  ON 33
eH1_4                 2.878413e-03 1 1  ON 34
eH1_5                 3.772983e-02 1 1  ON 35
eH1_6                 9.700187e-02 1 1  ON 36
eH1_7                 1.538051e-01 1 1  ON 37
eH1_8                 1.762276e-01 1 1  ON 38
eH1_9                 6.657929e-02 1 1  ON 39
eH2_0                -2.395659e-01 1 1  ON 40
eH2_1                -1.418613e-01 1 1  ON 41
eH2_2                -9.688640e-02 1 1  ON 42
eH2_3                -4.316289e-02 1 1  ON 43
eH2_4                 5.102322e-03 1 1  ON 44
eH2_5                 3.979711e-02 1 1  ON 45
eH2_6                 9.952930e-02 1 1  ON 46
eH2_7                 1.556288e-01 1 1  ON 47
eH2_8                 1.821117e-01 1 1  ON 48
eH2_9                 5.594969e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6118e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6887e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.8636
    reference variance = 0.538413
====================================================
  Execution time = 2.0548e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3722e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6484e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337149314952
                                         uncertainty =       0.003167918244

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337149314952
                                         uncertainty =       0.003167918244

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410621206
  error estimate for blocks of size 2^( 2) =       0.000422967102
  error estimate for blocks of size 2^( 3) =       0.000435639794
  error estimate for blocks of size 2^( 4) =       0.000447389554
  error estimate for blocks of size 2^( 5) =       0.000457660175
  error estimate for blocks of size 2^( 6) =       0.000464638811
  error estimate for blocks of size 2^( 7) =       0.000467354698

      target function =                  N/A
              le_mean =     -16.906324285476
             les_mean =     286.161020226961
             stat err =       0.000459260810
             autocorr =       1.250938691011
              std dev =       0.580706078736
             le_variance =       0.337219549881


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690632428548e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906324285476       residual = 2.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906324399357       residual = 3.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906324443855       residual = 8.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906324466388       residual = 4.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906324487671       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906324491952       residual = 3.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906324495139       residual = 6.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906324495360       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906324498739       residual = 1.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+01 is 1.153047e-05

solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906324285476       residual = 2.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906324314017       residual = 3.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906324325172       residual = 8.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906324330804       residual = 4.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906324336109       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906324337173       residual = 3.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906324337979       residual = 6.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906324338037       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906324338884       residual = 1.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+02 is 2.897285e-06

solving harmonic davidson linear method for identity shift 1.0000e+03, overlap shift 1.0000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906324285476       residual = 2.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906324292616       residual = 3.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906324295407       residual = 8.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906324296815       residual = 4.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906324298140       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906324298405       residual = 3.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906324298608       residual = 6.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906324298623       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906324298831       residual = 1.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+03 is 7.252467e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.018725 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6208e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.092935e-01 1 1  ON 0
 uu_1                 1.425583e-01 1 1  ON 1
 uu_2                 4.090818e-02 1 1  ON 2
 uu_3                -2.150753e-02 1 1  ON 3
 uu_4                -6.690999e-02 1 1  ON 4
 uu_5                -1.013431e-01 1 1  ON 5
 uu_6                -1.282016e-01 1 1  ON 6
 uu_7                -1.411921e-01 1 1  ON 7
 uu_8                -1.329657e-01 1 1  ON 8
 uu_9                -1.043524e-01 1 1  ON 9
 ud_0                 4.443446e-01 1 1  ON 10
 ud_1                 1.801209e-01 1 1  ON 11
 ud_2                 6.325430e-02 1 1  ON 12
 ud_3                -6.188726e-03 1 1  ON 13
 ud_4                -6.411705e-02 1 1  ON 14
 ud_5                -1.066802e-01 1 1  ON 15
 ud_6                -1.344869e-01 1 1  ON 16
 ud_7                -1.516138e-01 1 1  ON 17
 ud_8                -1.521876e-01 1 1  ON 18
 ud_9                -1.426096e-01 1 1  ON 19
 eO_0                -7.585603e-01 1 1  ON 20
 eO_1                -4.404419e-01 1 1  ON 21
 eO_2                -2.262734e-02 1 1  ON 22
 eO_3                 2.977497e-01 1 1  ON 23
 eO_4                 5.252170e-01 1 1  ON 24
 eO_5                 4.870203e-01 1 1  ON 25
 eO_6                 2.596879e-01 1 1  ON 26
 eO_7                -4.096959e-02 1 1  ON 27
 eO_8                -2.205852e-01 1 1  ON 28
 eO_9                -8.532084e-02 1 1  ON 29
eH1_0                -2.414752e-01 1 1  ON 30
eH1_1                -1.440708e-01 1 1  ON 31
eH1_2                -9.924798e-02 1 1  ON 32
eH1_3                -4.540533e-02 1 1  ON 33
eH1_4                 2.878899e-03 1 1  ON 34
eH1_5                 3.773045e-02 1 1  ON 35
eH1_6                 9.700194e-02 1 1  ON 36
eH1_7                 1.538049e-01 1 1  ON 37
eH1_8                 1.762277e-01 1 1  ON 38
eH1_9                 6.657980e-02 1 1  ON 39
eH2_0                -2.395675e-01 1 1  ON 40
eH2_1                -1.418619e-01 1 1  ON 41
eH2_2                -9.688614e-02 1 1  ON 42
eH2_3                -4.316240e-02 1 1  ON 43
eH2_4                 5.103007e-03 1 1  ON 44
eH2_5                 3.979678e-02 1 1  ON 45
eH2_6                 9.952905e-02 1 1  ON 46
eH2_7                 1.556288e-01 1 1  ON 47
eH2_8                 1.821121e-01 1 1  ON 48
eH2_9                 5.595050e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.8773
    reference variance = 0.258199
====================================================
  Execution time = 1.9947e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3922e-01
  Total weights = 2.0000e+06
  Execution time = 2.0255e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339312383271
                                         uncertainty =       0.004402506980

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339312383271
                                         uncertainty =       0.004402506980

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411839206
  error estimate for blocks of size 2^( 2) =       0.000424893912
  error estimate for blocks of size 2^( 3) =       0.000437998996
  error estimate for blocks of size 2^( 4) =       0.000449854664
  error estimate for blocks of size 2^( 5) =       0.000460188276
  error estimate for blocks of size 2^( 6) =       0.000466636502
  error estimate for blocks of size 2^( 7) =       0.000470389199

      target function =                  N/A
              le_mean =     -16.905428936349
             les_mean =     286.132750416330
             stat err =       0.000461767160
             autocorr =       1.257160453070
              std dev =       0.582428591341
             le_variance =       0.339223064012

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339319041453
                                         uncertainty =       0.004402581804

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339319041453
                                         uncertainty =       0.004402581804

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411843248
  error estimate for blocks of size 2^( 2) =       0.000424897380
  error estimate for blocks of size 2^( 3) =       0.000438001859
  error estimate for blocks of size 2^( 4) =       0.000449857056
  error estimate for blocks of size 2^( 5) =       0.000460190343
  error estimate for blocks of size 2^( 6) =       0.000466638458
  error estimate for blocks of size 2^( 7) =       0.000470391077

      target function =                  N/A
              le_mean =     -16.905428949602
             les_mean =     286.132757522652
             stat err =       0.000461769233
             autocorr =       1.257147065050
              std dev =       0.582434307217
             le_variance =       0.339229722224

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339315714151
                                         uncertainty =       0.004402544440

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339315714151
                                         uncertainty =       0.004402544440

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411841228
  error estimate for blocks of size 2^( 2) =       0.000424895646
  error estimate for blocks of size 2^( 3) =       0.000438000427
  error estimate for blocks of size 2^( 4) =       0.000449855858
  error estimate for blocks of size 2^( 5) =       0.000460189307
  error estimate for blocks of size 2^( 6) =       0.000466637477
  error estimate for blocks of size 2^( 7) =       0.000470390135

      target function =                  N/A
              le_mean =     -16.905428942853
             les_mean =     286.132753967163
             stat err =       0.000461768194
             autocorr =       1.257153738959
              std dev =       0.582431450826
             le_variance =       0.339226394911

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339312799592
                                         uncertainty =       0.004402511664

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339312799592
                                         uncertainty =       0.004402511664

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411839459
  error estimate for blocks of size 2^( 2) =       0.000424894129
  error estimate for blocks of size 2^( 3) =       0.000437999175
  error estimate for blocks of size 2^( 4) =       0.000449854813
  error estimate for blocks of size 2^( 5) =       0.000460188405
  error estimate for blocks of size 2^( 6) =       0.000466636624
  error estimate for blocks of size 2^( 7) =       0.000470389316

      target function =                  N/A
              le_mean =     -16.905428937142
             les_mean =     286.132750859470
             stat err =       0.000461767289
             autocorr =       1.257159613120
              std dev =       0.582428948745
             le_variance =       0.339223480336


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905428936349        initial
     6.2500e+01     6.2500e+02             1.1530e-05       -16.905428949602  <--
     2.5000e+02     2.5000e+03             2.8973e-06       -16.905428942853
     1.0000e+03     1.0000e+04             7.2525e-07       -16.905428937142

*****************************************************************************
Applying the update for shift_i =   6.2500e+01     and shift_s =   6.2500e+02
*****************************************************************************

  Execution time = 3.1559e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.092933e-01 1 1  ON 0
 uu_1                 1.425581e-01 1 1  ON 1
 uu_2                 4.090837e-02 1 1  ON 2
 uu_3                -2.150581e-02 1 1  ON 3
 uu_4                -6.690997e-02 1 1  ON 4
 uu_5                -1.013426e-01 1 1  ON 5
 uu_6                -1.282010e-01 1 1  ON 6
 uu_7                -1.411935e-01 1 1  ON 7
 uu_8                -1.329673e-01 1 1  ON 8
 uu_9                -1.043536e-01 1 1  ON 9
 ud_0                 4.443527e-01 1 1  ON 10
 ud_1                 1.801295e-01 1 1  ON 11
 ud_2                 6.325054e-02 1 1  ON 12
 ud_3                -6.192832e-03 1 1  ON 13
 ud_4                -6.411883e-02 1 1  ON 14
 ud_5                -1.066798e-01 1 1  ON 15
 ud_6                -1.344888e-01 1 1  ON 16
 ud_7                -1.516146e-01 1 1  ON 17
 ud_8                -1.521892e-01 1 1  ON 18
 ud_9                -1.426112e-01 1 1  ON 19
 eO_0                -7.585650e-01 1 1  ON 20
 eO_1                -4.404406e-01 1 1  ON 21
 eO_2                -2.262437e-02 1 1  ON 22
 eO_3                 2.977541e-01 1 1  ON 23
 eO_4                 5.252170e-01 1 1  ON 24
 eO_5                 4.870201e-01 1 1  ON 25
 eO_6                 2.596886e-01 1 1  ON 26
 eO_7                -4.096972e-02 1 1  ON 27
 eO_8                -2.205874e-01 1 1  ON 28
 eO_9                -8.532273e-02 1 1  ON 29
eH1_0                -2.414798e-01 1 1  ON 30
eH1_1                -1.440753e-01 1 1  ON 31
eH1_2                -9.924639e-02 1 1  ON 32
eH1_3                -4.540298e-02 1 1  ON 33
eH1_4                 2.880356e-03 1 1  ON 34
eH1_5                 3.773231e-02 1 1  ON 35
eH1_6                 9.700215e-02 1 1  ON 36
eH1_7                 1.538045e-01 1 1  ON 37
eH1_8                 1.762282e-01 1 1  ON 38
eH1_9                 6.658133e-02 1 1  ON 39
eH2_0                -2.395720e-01 1 1  ON 40
eH2_1                -1.418636e-01 1 1  ON 41
eH2_2                -9.688539e-02 1 1  ON 42
eH2_3                -4.316091e-02 1 1  ON 43
eH2_4                 5.105057e-03 1 1  ON 44
eH2_5                 3.979582e-02 1 1  ON 45
eH2_6                 9.952831e-02 1 1  ON 46
eH2_7                 1.556286e-01 1 1  ON 47
eH2_8                 1.821134e-01 1 1  ON 48
eH2_9                 5.595293e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7772e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6884e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.9054
    reference variance = 0.276362
====================================================
  Execution time = 2.0311e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4727e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5767e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347303364576
                                         uncertainty =       0.005255203143

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347303364576
                                         uncertainty =       0.005255203143

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416693684
  error estimate for blocks of size 2^( 2) =       0.000429331141
  error estimate for blocks of size 2^( 3) =       0.000442501197
  error estimate for blocks of size 2^( 4) =       0.000455267811
  error estimate for blocks of size 2^( 5) =       0.000466841294
  error estimate for blocks of size 2^( 6) =       0.000475537828
  error estimate for blocks of size 2^( 7) =       0.000482509008

      target function =                  N/A
              le_mean =     -16.905500586434
             les_mean =     286.143217157076
             stat err =       0.000470038985
             autocorr =       1.272430070972
              std dev =       0.589293859455
             le_variance =       0.347267252791


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690550058643e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905500586434       residual = 2.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905500893021       residual = 4.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905501128863       residual = 7.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905501150252       residual = 3.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905501192556       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905501233275       residual = 3.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905501179837       residual = 7.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905501194487       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905501200305       residual = 1.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 4.437661e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905500586434       residual = 2.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905500663857       residual = 4.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905500723914       residual = 7.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905500729532       residual = 3.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905500740232       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905500750707       residual = 3.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905500737299       residual = 7.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905500740688       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905500742243       residual = 1.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+01 is 1.113127e-05

solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905500586434       residual = 2.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905500605839       residual = 4.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905500620923       residual = 7.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905500622345       residual = 3.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905500625029       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905500627667       residual = 3.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905500624312       residual = 7.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905500625142       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905500625537       residual = 1.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+02 is 2.784913e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.021804 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5899e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.092918e-01 1 1  ON 0
 uu_1                 1.425573e-01 1 1  ON 1
 uu_2                 4.090978e-02 1 1  ON 2
 uu_3                -2.150379e-02 1 1  ON 3
 uu_4                -6.690777e-02 1 1  ON 4
 uu_5                -1.013429e-01 1 1  ON 5
 uu_6                -1.282037e-01 1 1  ON 6
 uu_7                -1.411948e-01 1 1  ON 7
 uu_8                -1.329676e-01 1 1  ON 8
 uu_9                -1.043550e-01 1 1  ON 9
 ud_0                 4.443638e-01 1 1  ON 10
 ud_1                 1.801403e-01 1 1  ON 11
 ud_2                 6.324423e-02 1 1  ON 12
 ud_3                -6.199812e-03 1 1  ON 13
 ud_4                -6.412108e-02 1 1  ON 14
 ud_5                -1.066797e-01 1 1  ON 15
 ud_6                -1.344919e-01 1 1  ON 16
 ud_7                -1.516149e-01 1 1  ON 17
 ud_8                -1.521890e-01 1 1  ON 18
 ud_9                -1.426125e-01 1 1  ON 19
 eO_0                -7.585698e-01 1 1  ON 20
 eO_1                -4.404411e-01 1 1  ON 21
 eO_2                -2.261989e-02 1 1  ON 22
 eO_3                 2.977592e-01 1 1  ON 23
 eO_4                 5.252171e-01 1 1  ON 24
 eO_5                 4.870198e-01 1 1  ON 25
 eO_6                 2.596875e-01 1 1  ON 26
 eO_7                -4.096833e-02 1 1  ON 27
 eO_8                -2.205887e-01 1 1  ON 28
 eO_9                -8.532523e-02 1 1  ON 29
eH1_0                -2.414864e-01 1 1  ON 30
eH1_1                -1.440779e-01 1 1  ON 31
eH1_2                -9.924498e-02 1 1  ON 32
eH1_3                -4.540101e-02 1 1  ON 33
eH1_4                 2.880601e-03 1 1  ON 34
eH1_5                 3.773319e-02 1 1  ON 35
eH1_6                 9.700234e-02 1 1  ON 36
eH1_7                 1.538055e-01 1 1  ON 37
eH1_8                 1.762295e-01 1 1  ON 38
eH1_9                 6.658347e-02 1 1  ON 39
eH2_0                -2.395773e-01 1 1  ON 40
eH2_1                -1.418667e-01 1 1  ON 41
eH2_2                -9.688482e-02 1 1  ON 42
eH2_3                -4.315922e-02 1 1  ON 43
eH2_4                 5.106163e-03 1 1  ON 44
eH2_5                 3.979555e-02 1 1  ON 45
eH2_6                 9.952750e-02 1 1  ON 46
eH2_7                 1.556284e-01 1 1  ON 47
eH2_8                 1.821157e-01 1 1  ON 48
eH2_9                 5.595666e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.8293
    reference variance = 0.316645
====================================================
  Execution time = 1.9932e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3237e-01
  Total weights = 2.0000e+06
  Execution time = 1.8720e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332069070550
                                         uncertainty =       0.003318915949

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332069070550
                                         uncertainty =       0.003318915949

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407654006
  error estimate for blocks of size 2^( 2) =       0.000420417762
  error estimate for blocks of size 2^( 3) =       0.000433370883
  error estimate for blocks of size 2^( 4) =       0.000445959034
  error estimate for blocks of size 2^( 5) =       0.000456671314
  error estimate for blocks of size 2^( 6) =       0.000464338211
  error estimate for blocks of size 2^( 7) =       0.000467321233

      target function =                  N/A
              le_mean =     -16.906234032176
             les_mean =     286.153112561297
             stat err =       0.000458572448
             autocorr =       1.265413569053
              std dev =       0.576509823654
             le_variance =       0.332363576770

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332097460779
                                         uncertainty =       0.003319137451

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332097460779
                                         uncertainty =       0.003319137451

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407671488
  error estimate for blocks of size 2^( 2) =       0.000420432639
  error estimate for blocks of size 2^( 3) =       0.000433383315
  error estimate for blocks of size 2^( 4) =       0.000445969716
  error estimate for blocks of size 2^( 5) =       0.000456681070
  error estimate for blocks of size 2^( 6) =       0.000464347490
  error estimate for blocks of size 2^( 7) =       0.000467328549

      target function =                  N/A
              le_mean =     -16.906233740942
             les_mean =     286.153131221409
             stat err =       0.000458581706
             autocorr =       1.265356132834
              std dev =       0.576534547302
             le_variance =       0.332392084233

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332083320874
                                         uncertainty =       0.003319026773

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332083320874
                                         uncertainty =       0.003319026773

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407662781
  error estimate for blocks of size 2^( 2) =       0.000420425216
  error estimate for blocks of size 2^( 3) =       0.000433377099
  error estimate for blocks of size 2^( 4) =       0.000445964364
  error estimate for blocks of size 2^( 5) =       0.000456676172
  error estimate for blocks of size 2^( 6) =       0.000464342830
  error estimate for blocks of size 2^( 7) =       0.000467324850

      target function =                  N/A
              le_mean =     -16.906233879445
             les_mean =     286.153121707029
             stat err =       0.000458577054
             autocorr =       1.265384508491
              std dev =       0.576522234359
             le_variance =       0.332377886710

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332070851799
                                         uncertainty =       0.003318929800

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332070851799
                                         uncertainty =       0.003318929800

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407655103
  error estimate for blocks of size 2^( 2) =       0.000420418693
  error estimate for blocks of size 2^( 3) =       0.000433371658
  error estimate for blocks of size 2^( 4) =       0.000445959698
  error estimate for blocks of size 2^( 5) =       0.000456671919
  error estimate for blocks of size 2^( 6) =       0.000464338786
  error estimate for blocks of size 2^( 7) =       0.000467321682

      target function =                  N/A
              le_mean =     -16.906234012573
             les_mean =     286.153113687188
             stat err =       0.000458573022
             autocorr =       1.265409924673
              std dev =       0.576511374999
             le_variance =       0.332365365503


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906234032176        initial  <--
     1.5625e+01     1.5625e+02             4.4377e-05       -16.906233740942
     6.2500e+01     6.2500e+02             1.1131e-05       -16.906233879445
     2.5000e+02     2.5000e+03             2.7849e-06       -16.906234012573

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4077
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.092933e-01 1 1  ON 0
 uu_1                 1.425581e-01 1 1  ON 1
 uu_2                 4.090837e-02 1 1  ON 2
 uu_3                -2.150581e-02 1 1  ON 3
 uu_4                -6.690997e-02 1 1  ON 4
 uu_5                -1.013426e-01 1 1  ON 5
 uu_6                -1.282010e-01 1 1  ON 6
 uu_7                -1.411935e-01 1 1  ON 7
 uu_8                -1.329673e-01 1 1  ON 8
 uu_9                -1.043536e-01 1 1  ON 9
 ud_0                 4.443527e-01 1 1  ON 10
 ud_1                 1.801295e-01 1 1  ON 11
 ud_2                 6.325054e-02 1 1  ON 12
 ud_3                -6.192832e-03 1 1  ON 13
 ud_4                -6.411883e-02 1 1  ON 14
 ud_5                -1.066798e-01 1 1  ON 15
 ud_6                -1.344888e-01 1 1  ON 16
 ud_7                -1.516146e-01 1 1  ON 17
 ud_8                -1.521892e-01 1 1  ON 18
 ud_9                -1.426112e-01 1 1  ON 19
 eO_0                -7.585650e-01 1 1  ON 20
 eO_1                -4.404406e-01 1 1  ON 21
 eO_2                -2.262437e-02 1 1  ON 22
 eO_3                 2.977541e-01 1 1  ON 23
 eO_4                 5.252170e-01 1 1  ON 24
 eO_5                 4.870201e-01 1 1  ON 25
 eO_6                 2.596886e-01 1 1  ON 26
 eO_7                -4.096972e-02 1 1  ON 27
 eO_8                -2.205874e-01 1 1  ON 28
 eO_9                -8.532273e-02 1 1  ON 29
eH1_0                -2.414798e-01 1 1  ON 30
eH1_1                -1.440753e-01 1 1  ON 31
eH1_2                -9.924639e-02 1 1  ON 32
eH1_3                -4.540298e-02 1 1  ON 33
eH1_4                 2.880356e-03 1 1  ON 34
eH1_5                 3.773231e-02 1 1  ON 35
eH1_6                 9.700215e-02 1 1  ON 36
eH1_7                 1.538045e-01 1 1  ON 37
eH1_8                 1.762282e-01 1 1  ON 38
eH1_9                 6.658133e-02 1 1  ON 39
eH2_0                -2.395720e-01 1 1  ON 40
eH2_1                -1.418636e-01 1 1  ON 41
eH2_2                -9.688539e-02 1 1  ON 42
eH2_3                -4.316091e-02 1 1  ON 43
eH2_4                 5.105057e-03 1 1  ON 44
eH2_5                 3.979582e-02 1 1  ON 45
eH2_6                 9.952831e-02 1 1  ON 46
eH2_7                 1.556286e-01 1 1  ON 47
eH2_8                 1.821134e-01 1 1  ON 48
eH2_9                 5.595293e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5313e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6881e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.8689
    reference variance = 0.235816
====================================================
  Execution time = 2.0534e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3797e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6254e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337957166128
                                         uncertainty =       0.004049119147

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337957166128
                                         uncertainty =       0.004049119147

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411079548
  error estimate for blocks of size 2^( 2) =       0.000424159149
  error estimate for blocks of size 2^( 3) =       0.000438056637
  error estimate for blocks of size 2^( 4) =       0.000450649572
  error estimate for blocks of size 2^( 5) =       0.000461509281
  error estimate for blocks of size 2^( 6) =       0.000469257100
  error estimate for blocks of size 2^( 7) =       0.000475764350

      target function =                  N/A
              le_mean =     -16.905878586326
             les_mean =     286.146703395721
             stat err =       0.000464295076
             autocorr =       1.275664338959
              std dev =       0.581354271598
             le_variance =       0.337972789106


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690587858633e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905878586326       residual = 2.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905878619234       residual = 3.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905878620252       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905878620928       residual = 3.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905878622067       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905878624734       residual = 3.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905878627842       residual = 6.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905878627333       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905878628100       residual = 1.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+02 is 4.700652e-06

solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905878586326       residual = 2.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905878594562       residual = 3.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905878594817       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905878594984       residual = 3.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905878595260       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905878595922       residual = 3.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905878596702       residual = 6.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905878596574       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905878596767       residual = 1.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+02 is 1.177725e-06

solving harmonic davidson linear method for identity shift 2.5000e+03, overlap shift 2.5000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905878586326       residual = 2.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905878588386       residual = 3.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905878588450       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905878588491       residual = 3.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905878588560       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905878588723       residual = 3.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905878588921       residual = 6.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905878588883       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905878588935       residual = 1.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+03 is 2.945921e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.024876 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6171e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.092932e-01 1 1  ON 0
 uu_1                 1.425580e-01 1 1  ON 1
 uu_2                 4.090851e-02 1 1  ON 2
 uu_3                -2.150573e-02 1 1  ON 3
 uu_4                -6.690980e-02 1 1  ON 4
 uu_5                -1.013426e-01 1 1  ON 5
 uu_6                -1.282009e-01 1 1  ON 6
 uu_7                -1.411937e-01 1 1  ON 7
 uu_8                -1.329676e-01 1 1  ON 8
 uu_9                -1.043538e-01 1 1  ON 9
 ud_0                 4.443537e-01 1 1  ON 10
 ud_1                 1.801307e-01 1 1  ON 11
 ud_2                 6.324994e-02 1 1  ON 12
 ud_3                -6.193458e-03 1 1  ON 13
 ud_4                -6.411898e-02 1 1  ON 14
 ud_5                -1.066799e-01 1 1  ON 15
 ud_6                -1.344889e-01 1 1  ON 16
 ud_7                -1.516148e-01 1 1  ON 17
 ud_8                -1.521894e-01 1 1  ON 18
 ud_9                -1.426113e-01 1 1  ON 19
 eO_0                -7.585654e-01 1 1  ON 20
 eO_1                -4.404408e-01 1 1  ON 21
 eO_2                -2.262396e-02 1 1  ON 22
 eO_3                 2.977545e-01 1 1  ON 23
 eO_4                 5.252172e-01 1 1  ON 24
 eO_5                 4.870202e-01 1 1  ON 25
 eO_6                 2.596886e-01 1 1  ON 26
 eO_7                -4.096978e-02 1 1  ON 27
 eO_8                -2.205876e-01 1 1  ON 28
 eO_9                -8.532294e-02 1 1  ON 29
eH1_0                -2.414802e-01 1 1  ON 30
eH1_1                -1.440755e-01 1 1  ON 31
eH1_2                -9.924615e-02 1 1  ON 32
eH1_3                -4.540278e-02 1 1  ON 33
eH1_4                 2.880338e-03 1 1  ON 34
eH1_5                 3.773221e-02 1 1  ON 35
eH1_6                 9.700211e-02 1 1  ON 36
eH1_7                 1.538044e-01 1 1  ON 37
eH1_8                 1.762284e-01 1 1  ON 38
eH1_9                 6.658157e-02 1 1  ON 39
eH2_0                -2.395725e-01 1 1  ON 40
eH2_1                -1.418639e-01 1 1  ON 41
eH2_2                -9.688528e-02 1 1  ON 42
eH2_3                -4.316077e-02 1 1  ON 43
eH2_4                 5.105185e-03 1 1  ON 44
eH2_5                 3.979586e-02 1 1  ON 45
eH2_6                 9.952825e-02 1 1  ON 46
eH2_7                 1.556286e-01 1 1  ON 47
eH2_8                 1.821135e-01 1 1  ON 48
eH2_9                 5.595329e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.8579
    reference variance = 0.286356
====================================================
  Execution time = 2.0117e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4057e-01
  Total weights = 2.0000e+06
  Execution time = 1.8793e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340621907964
                                         uncertainty =       0.004971545310

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340621907964
                                         uncertainty =       0.004971545310

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412655015
  error estimate for blocks of size 2^( 2) =       0.000425248597
  error estimate for blocks of size 2^( 3) =       0.000437629327
  error estimate for blocks of size 2^( 4) =       0.000449030032
  error estimate for blocks of size 2^( 5) =       0.000458440908
  error estimate for blocks of size 2^( 6) =       0.000465408794
  error estimate for blocks of size 2^( 7) =       0.000470233692

      target function =                  N/A
              le_mean =     -16.905768893218
             les_mean =     286.145590022949
             stat err =       0.000460778357
             autocorr =       1.246837595153
              std dev =       0.583582318394
             le_variance =       0.340568322342

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340624574791
                                         uncertainty =       0.004971593570

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340624574791
                                         uncertainty =       0.004971593570

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412656630
  error estimate for blocks of size 2^( 2) =       0.000425249986
  error estimate for blocks of size 2^( 3) =       0.000437630488
  error estimate for blocks of size 2^( 4) =       0.000449031024
  error estimate for blocks of size 2^( 5) =       0.000458441770
  error estimate for blocks of size 2^( 6) =       0.000465409523
  error estimate for blocks of size 2^( 7) =       0.000470234362

      target function =                  N/A
              le_mean =     -16.905768849027
             les_mean =     286.145591195107
             stat err =       0.000460779170
             autocorr =       1.246832233995
              std dev =       0.583584602820
             le_variance =       0.340570988649

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340623241494
                                         uncertainty =       0.004971569485

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340623241494
                                         uncertainty =       0.004971569485

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412655822
  error estimate for blocks of size 2^( 2) =       0.000425249291
  error estimate for blocks of size 2^( 3) =       0.000437629907
  error estimate for blocks of size 2^( 4) =       0.000449030528
  error estimate for blocks of size 2^( 5) =       0.000458441339
  error estimate for blocks of size 2^( 6) =       0.000465409158
  error estimate for blocks of size 2^( 7) =       0.000470234026

      target function =                  N/A
              le_mean =     -16.905768871021
             les_mean =     286.145590605699
             stat err =       0.000460778763
             autocorr =       1.246834911545
              std dev =       0.583583460709
             le_variance =       0.340569655613

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340622074642
                                         uncertainty =       0.004971548333

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340622074642
                                         uncertainty =       0.004971548333

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412655116
  error estimate for blocks of size 2^( 2) =       0.000425248683
  error estimate for blocks of size 2^( 3) =       0.000437629399
  error estimate for blocks of size 2^( 4) =       0.000449030094
  error estimate for blocks of size 2^( 5) =       0.000458440962
  error estimate for blocks of size 2^( 6) =       0.000465408840
  error estimate for blocks of size 2^( 7) =       0.000470233734

      target function =                  N/A
              le_mean =     -16.905768890437
             les_mean =     286.145590095573
             stat err =       0.000460778407
             autocorr =       1.246837259599
              std dev =       0.583582461172
             le_variance =       0.340568488987


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905768893218        initial  <--
     1.5625e+02     1.5625e+03             4.7007e-06       -16.905768849027
     6.2500e+02     6.2500e+03             1.1777e-06       -16.905768871021
     2.5000e+03     2.5000e+04             2.9459e-07       -16.905768890437

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5992
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.092933e-01 1 1  ON 0
 uu_1                 1.425581e-01 1 1  ON 1
 uu_2                 4.090837e-02 1 1  ON 2
 uu_3                -2.150581e-02 1 1  ON 3
 uu_4                -6.690997e-02 1 1  ON 4
 uu_5                -1.013426e-01 1 1  ON 5
 uu_6                -1.282010e-01 1 1  ON 6
 uu_7                -1.411935e-01 1 1  ON 7
 uu_8                -1.329673e-01 1 1  ON 8
 uu_9                -1.043536e-01 1 1  ON 9
 ud_0                 4.443527e-01 1 1  ON 10
 ud_1                 1.801295e-01 1 1  ON 11
 ud_2                 6.325054e-02 1 1  ON 12
 ud_3                -6.192832e-03 1 1  ON 13
 ud_4                -6.411883e-02 1 1  ON 14
 ud_5                -1.066798e-01 1 1  ON 15
 ud_6                -1.344888e-01 1 1  ON 16
 ud_7                -1.516146e-01 1 1  ON 17
 ud_8                -1.521892e-01 1 1  ON 18
 ud_9                -1.426112e-01 1 1  ON 19
 eO_0                -7.585650e-01 1 1  ON 20
 eO_1                -4.404406e-01 1 1  ON 21
 eO_2                -2.262437e-02 1 1  ON 22
 eO_3                 2.977541e-01 1 1  ON 23
 eO_4                 5.252170e-01 1 1  ON 24
 eO_5                 4.870201e-01 1 1  ON 25
 eO_6                 2.596886e-01 1 1  ON 26
 eO_7                -4.096972e-02 1 1  ON 27
 eO_8                -2.205874e-01 1 1  ON 28
 eO_9                -8.532273e-02 1 1  ON 29
eH1_0                -2.414798e-01 1 1  ON 30
eH1_1                -1.440753e-01 1 1  ON 31
eH1_2                -9.924639e-02 1 1  ON 32
eH1_3                -4.540298e-02 1 1  ON 33
eH1_4                 2.880356e-03 1 1  ON 34
eH1_5                 3.773231e-02 1 1  ON 35
eH1_6                 9.700215e-02 1 1  ON 36
eH1_7                 1.538045e-01 1 1  ON 37
eH1_8                 1.762282e-01 1 1  ON 38
eH1_9                 6.658133e-02 1 1  ON 39
eH2_0                -2.395720e-01 1 1  ON 40
eH2_1                -1.418636e-01 1 1  ON 41
eH2_2                -9.688539e-02 1 1  ON 42
eH2_3                -4.316091e-02 1 1  ON 43
eH2_4                 5.105057e-03 1 1  ON 44
eH2_5                 3.979582e-02 1 1  ON 45
eH2_6                 9.952831e-02 1 1  ON 46
eH2_7                 1.556286e-01 1 1  ON 47
eH2_8                 1.821134e-01 1 1  ON 48
eH2_9                 5.595293e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5776e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6879e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.8606
    reference variance = 0.338607
====================================================
  Execution time = 2.2764e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4510e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5813e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345077847205
                                         uncertainty =       0.003665709827

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345077847205
                                         uncertainty =       0.003665709827

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415390634
  error estimate for blocks of size 2^( 2) =       0.000428391285
  error estimate for blocks of size 2^( 3) =       0.000441668012
  error estimate for blocks of size 2^( 4) =       0.000454807719
  error estimate for blocks of size 2^( 5) =       0.000466222566
  error estimate for blocks of size 2^( 6) =       0.000475337717
  error estimate for blocks of size 2^( 7) =       0.000478214596

      target function =                  N/A
              le_mean =     -16.905760677124
             les_mean =     286.149842656962
             stat err =       0.000468645649
             autocorr =       1.272845758306
              std dev =       0.587451068021
             le_variance =       0.345098757319


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690576067712e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905760677124       residual = 2.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905760679952       residual = 3.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905760680463       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905760680516       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905760680365       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905760680175       residual = 2.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905760680761       residual = 5.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905760680814       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905760680942       residual = 1.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+03 is 3.897039e-07

solving harmonic davidson linear method for identity shift 6.2500e+03, overlap shift 6.2500e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905760677124       residual = 2.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905760677831       residual = 3.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905760677959       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905760677971       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905760677933       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905760677884       residual = 2.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905760678033       residual = 5.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905760678044       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905760678084       residual = 1.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+03 is 9.744887e-08

solving harmonic davidson linear method for identity shift 2.5000e+04, overlap shift 2.5000e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905760677124       residual = 2.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905760677301       residual = 3.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905760677333       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905760677336       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905760677330       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905760677315       residual = 2.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905760677352       residual = 5.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905760677356       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905760677364       residual = 1.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+04 is 2.436365e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.027931 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8357e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.092933e-01 1 1  ON 0
 uu_1                 1.425581e-01 1 1  ON 1
 uu_2                 4.090838e-02 1 1  ON 2
 uu_3                -2.150581e-02 1 1  ON 3
 uu_4                -6.690996e-02 1 1  ON 4
 uu_5                -1.013426e-01 1 1  ON 5
 uu_6                -1.282010e-01 1 1  ON 6
 uu_7                -1.411936e-01 1 1  ON 7
 uu_8                -1.329673e-01 1 1  ON 8
 uu_9                -1.043536e-01 1 1  ON 9
 ud_0                 4.443527e-01 1 1  ON 10
 ud_1                 1.801296e-01 1 1  ON 11
 ud_2                 6.325048e-02 1 1  ON 12
 ud_3                -6.192900e-03 1 1  ON 13
 ud_4                -6.411886e-02 1 1  ON 14
 ud_5                -1.066798e-01 1 1  ON 15
 ud_6                -1.344888e-01 1 1  ON 16
 ud_7                -1.516146e-01 1 1  ON 17
 ud_8                -1.521892e-01 1 1  ON 18
 ud_9                -1.426112e-01 1 1  ON 19
 eO_0                -7.585651e-01 1 1  ON 20
 eO_1                -4.404406e-01 1 1  ON 21
 eO_2                -2.262434e-02 1 1  ON 22
 eO_3                 2.977542e-01 1 1  ON 23
 eO_4                 5.252170e-01 1 1  ON 24
 eO_5                 4.870201e-01 1 1  ON 25
 eO_6                 2.596886e-01 1 1  ON 26
 eO_7                -4.096973e-02 1 1  ON 27
 eO_8                -2.205874e-01 1 1  ON 28
 eO_9                -8.532274e-02 1 1  ON 29
eH1_0                -2.414798e-01 1 1  ON 30
eH1_1                -1.440753e-01 1 1  ON 31
eH1_2                -9.924638e-02 1 1  ON 32
eH1_3                -4.540298e-02 1 1  ON 33
eH1_4                 2.880383e-03 1 1  ON 34
eH1_5                 3.773232e-02 1 1  ON 35
eH1_6                 9.700215e-02 1 1  ON 36
eH1_7                 1.538045e-01 1 1  ON 37
eH1_8                 1.762283e-01 1 1  ON 38
eH1_9                 6.658135e-02 1 1  ON 39
eH2_0                -2.395720e-01 1 1  ON 40
eH2_1                -1.418636e-01 1 1  ON 41
eH2_2                -9.688538e-02 1 1  ON 42
eH2_3                -4.316090e-02 1 1  ON 43
eH2_4                 5.105042e-03 1 1  ON 44
eH2_5                 3.979584e-02 1 1  ON 45
eH2_6                 9.952831e-02 1 1  ON 46
eH2_7                 1.556286e-01 1 1  ON 47
eH2_8                 1.821134e-01 1 1  ON 48
eH2_9                 5.595297e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.9246
    reference variance = 0.185044
====================================================
  Execution time = 2.0136e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3517e-01
  Total weights = 2.0000e+06
  Execution time = 1.8819e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335095063411
                                         uncertainty =       0.003051695920

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335095063411
                                         uncertainty =       0.003051695920

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409373105
  error estimate for blocks of size 2^( 2) =       0.000421943446
  error estimate for blocks of size 2^( 3) =       0.000435625316
  error estimate for blocks of size 2^( 4) =       0.000447991183
  error estimate for blocks of size 2^( 5) =       0.000458607234
  error estimate for blocks of size 2^( 6) =       0.000464909626
  error estimate for blocks of size 2^( 7) =       0.000469794164

      target function =                  N/A
              le_mean =     -16.905430416579
             les_mean =     286.128750080030
             stat err =       0.000460325552
             autocorr =       1.264420566138
              std dev =       0.578940996835
             le_variance =       0.335172677816

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335095278094
                                         uncertainty =       0.003051698264

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335095278094
                                         uncertainty =       0.003051698264

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409373236
  error estimate for blocks of size 2^( 2) =       0.000421943560
  error estimate for blocks of size 2^( 3) =       0.000435625412
  error estimate for blocks of size 2^( 4) =       0.000447991268
  error estimate for blocks of size 2^( 5) =       0.000458607319
  error estimate for blocks of size 2^( 6) =       0.000464909706
  error estimate for blocks of size 2^( 7) =       0.000469794226

      target function =                  N/A
              le_mean =     -16.905430416092
             les_mean =     286.128750278043
             stat err =       0.000460325630
             autocorr =       1.264420185234
              std dev =       0.578941182067
             le_variance =       0.335172892293

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335095170748
                                         uncertainty =       0.003051697092

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335095170748
                                         uncertainty =       0.003051697092

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409373170
  error estimate for blocks of size 2^( 2) =       0.000421943503
  error estimate for blocks of size 2^( 3) =       0.000435625364
  error estimate for blocks of size 2^( 4) =       0.000447991225
  error estimate for blocks of size 2^( 5) =       0.000458607277
  error estimate for blocks of size 2^( 6) =       0.000464909666
  error estimate for blocks of size 2^( 7) =       0.000469794195

      target function =                  N/A
              le_mean =     -16.905430416335
             les_mean =     286.128750179020
             stat err =       0.000460325591
             autocorr =       1.264420375669
              std dev =       0.578941089448
             le_variance =       0.335172785051

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335095076828
                                         uncertainty =       0.003051696066

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335095076828
                                         uncertainty =       0.003051696066

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409373113
  error estimate for blocks of size 2^( 2) =       0.000421943453
  error estimate for blocks of size 2^( 3) =       0.000435625322
  error estimate for blocks of size 2^( 4) =       0.000447991188
  error estimate for blocks of size 2^( 5) =       0.000458607240
  error estimate for blocks of size 2^( 6) =       0.000464909631
  error estimate for blocks of size 2^( 7) =       0.000469794168

      target function =                  N/A
              le_mean =     -16.905430416549
             les_mean =     286.128750092403
             stat err =       0.000460325557
             autocorr =       1.264420542332
              std dev =       0.578941008411
             le_variance =       0.335172691220


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905430416579        initial  <--
     1.5625e+03     1.5625e+04             3.8970e-07       -16.905430416092
     6.2500e+03     6.2500e+04             9.7449e-08       -16.905430416335
     2.5000e+04     2.5000e+05             2.4364e-08       -16.905430416549

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6589
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.092933e-01 1 1  ON 0
 uu_1                 1.425581e-01 1 1  ON 1
 uu_2                 4.090837e-02 1 1  ON 2
 uu_3                -2.150581e-02 1 1  ON 3
 uu_4                -6.690997e-02 1 1  ON 4
 uu_5                -1.013426e-01 1 1  ON 5
 uu_6                -1.282010e-01 1 1  ON 6
 uu_7                -1.411935e-01 1 1  ON 7
 uu_8                -1.329673e-01 1 1  ON 8
 uu_9                -1.043536e-01 1 1  ON 9
 ud_0                 4.443527e-01 1 1  ON 10
 ud_1                 1.801295e-01 1 1  ON 11
 ud_2                 6.325054e-02 1 1  ON 12
 ud_3                -6.192832e-03 1 1  ON 13
 ud_4                -6.411883e-02 1 1  ON 14
 ud_5                -1.066798e-01 1 1  ON 15
 ud_6                -1.344888e-01 1 1  ON 16
 ud_7                -1.516146e-01 1 1  ON 17
 ud_8                -1.521892e-01 1 1  ON 18
 ud_9                -1.426112e-01 1 1  ON 19
 eO_0                -7.585650e-01 1 1  ON 20
 eO_1                -4.404406e-01 1 1  ON 21
 eO_2                -2.262437e-02 1 1  ON 22
 eO_3                 2.977541e-01 1 1  ON 23
 eO_4                 5.252170e-01 1 1  ON 24
 eO_5                 4.870201e-01 1 1  ON 25
 eO_6                 2.596886e-01 1 1  ON 26
 eO_7                -4.096972e-02 1 1  ON 27
 eO_8                -2.205874e-01 1 1  ON 28
 eO_9                -8.532273e-02 1 1  ON 29
eH1_0                -2.414798e-01 1 1  ON 30
eH1_1                -1.440753e-01 1 1  ON 31
eH1_2                -9.924639e-02 1 1  ON 32
eH1_3                -4.540298e-02 1 1  ON 33
eH1_4                 2.880356e-03 1 1  ON 34
eH1_5                 3.773231e-02 1 1  ON 35
eH1_6                 9.700215e-02 1 1  ON 36
eH1_7                 1.538045e-01 1 1  ON 37
eH1_8                 1.762282e-01 1 1  ON 38
eH1_9                 6.658133e-02 1 1  ON 39
eH2_0                -2.395720e-01 1 1  ON 40
eH2_1                -1.418636e-01 1 1  ON 41
eH2_2                -9.688539e-02 1 1  ON 42
eH2_3                -4.316091e-02 1 1  ON 43
eH2_4                 5.105057e-03 1 1  ON 44
eH2_5                 3.979582e-02 1 1  ON 45
eH2_6                 9.952831e-02 1 1  ON 46
eH2_7                 1.556286e-01 1 1  ON 47
eH2_8                 1.821134e-01 1 1  ON 48
eH2_9                 5.595293e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8022e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6880e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.8849
    reference variance = 0.331779
====================================================
  Execution time = 2.0408e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3574e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5274e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335825183052
                                         uncertainty =       0.003552141632

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335825183052
                                         uncertainty =       0.003552141632

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409721258
  error estimate for blocks of size 2^( 2) =       0.000422176092
  error estimate for blocks of size 2^( 3) =       0.000435282134
  error estimate for blocks of size 2^( 4) =       0.000447319267
  error estimate for blocks of size 2^( 5) =       0.000458306005
  error estimate for blocks of size 2^( 6) =       0.000467085632
  error estimate for blocks of size 2^( 7) =       0.000471665297

      target function =                  N/A
              le_mean =     -16.906498496668
             les_mean =     286.165434268992
             stat err =       0.000461094050
             autocorr =       1.266490803511
              std dev =       0.579433360306
             le_variance =       0.335743019036


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690649849667e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+04, overlap shift 1.5625e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906498496668       residual = 2.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906498497163       residual = 3.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906498497564       residual = 8.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906498497582       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906498497616       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906498497688       residual = 3.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906498497688       residual = 5.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906498497699       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906498497683       residual = 1.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+04 is 4.690810e-08

solving harmonic davidson linear method for identity shift 6.2500e+04, overlap shift 6.2500e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906498496668       residual = 2.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906498496792       residual = 3.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906498496892       residual = 8.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906498496896       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906498496897       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906498496929       residual = 3.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906498496952       residual = 5.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906498496920       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906498496911       residual = 1.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+04 is 1.172728e-08

solving harmonic davidson linear method for identity shift 2.5000e+05, overlap shift 2.5000e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906498496668       residual = 2.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906498496699       residual = 3.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906498496724       residual = 8.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906498496725       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906498496673       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906498496729       residual = 3.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906498496724       residual = 5.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906498496528       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906498496756       residual = 1.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+05 is 2.931834e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.030962 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5947e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.092933e-01 1 1  ON 0
 uu_1                 1.425581e-01 1 1  ON 1
 uu_2                 4.090837e-02 1 1  ON 2
 uu_3                -2.150581e-02 1 1  ON 3
 uu_4                -6.690997e-02 1 1  ON 4
 uu_5                -1.013426e-01 1 1  ON 5
 uu_6                -1.282010e-01 1 1  ON 6
 uu_7                -1.411935e-01 1 1  ON 7
 uu_8                -1.329673e-01 1 1  ON 8
 uu_9                -1.043536e-01 1 1  ON 9
 ud_0                 4.443527e-01 1 1  ON 10
 ud_1                 1.801295e-01 1 1  ON 11
 ud_2                 6.325054e-02 1 1  ON 12
 ud_3                -6.192838e-03 1 1  ON 13
 ud_4                -6.411883e-02 1 1  ON 14
 ud_5                -1.066798e-01 1 1  ON 15
 ud_6                -1.344888e-01 1 1  ON 16
 ud_7                -1.516146e-01 1 1  ON 17
 ud_8                -1.521893e-01 1 1  ON 18
 ud_9                -1.426112e-01 1 1  ON 19
 eO_0                -7.585650e-01 1 1  ON 20
 eO_1                -4.404406e-01 1 1  ON 21
 eO_2                -2.262437e-02 1 1  ON 22
 eO_3                 2.977541e-01 1 1  ON 23
 eO_4                 5.252170e-01 1 1  ON 24
 eO_5                 4.870201e-01 1 1  ON 25
 eO_6                 2.596886e-01 1 1  ON 26
 eO_7                -4.096972e-02 1 1  ON 27
 eO_8                -2.205874e-01 1 1  ON 28
 eO_9                -8.532273e-02 1 1  ON 29
eH1_0                -2.414798e-01 1 1  ON 30
eH1_1                -1.440753e-01 1 1  ON 31
eH1_2                -9.924639e-02 1 1  ON 32
eH1_3                -4.540298e-02 1 1  ON 33
eH1_4                 2.880358e-03 1 1  ON 34
eH1_5                 3.773231e-02 1 1  ON 35
eH1_6                 9.700214e-02 1 1  ON 36
eH1_7                 1.538045e-01 1 1  ON 37
eH1_8                 1.762283e-01 1 1  ON 38
eH1_9                 6.658133e-02 1 1  ON 39
eH2_0                -2.395720e-01 1 1  ON 40
eH2_1                -1.418636e-01 1 1  ON 41
eH2_2                -9.688539e-02 1 1  ON 42
eH2_3                -4.316090e-02 1 1  ON 43
eH2_4                 5.105058e-03 1 1  ON 44
eH2_5                 3.979582e-02 1 1  ON 45
eH2_6                 9.952831e-02 1 1  ON 46
eH2_7                 1.556286e-01 1 1  ON 47
eH2_8                 1.821134e-01 1 1  ON 48
eH2_9                 5.595293e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.886
    reference variance = 0.20761
====================================================
  Execution time = 2.0027e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3805e-01
  Total weights = 2.0000e+06
  Execution time = 1.8765e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338058061318
                                         uncertainty =       0.004235342478

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338058061318
                                         uncertainty =       0.004235342478

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411125189
  error estimate for blocks of size 2^( 2) =       0.000423430449
  error estimate for blocks of size 2^( 3) =       0.000436322131
  error estimate for blocks of size 2^( 4) =       0.000448419035
  error estimate for blocks of size 2^( 5) =       0.000457656380
  error estimate for blocks of size 2^( 6) =       0.000466273606
  error estimate for blocks of size 2^( 7) =       0.000471953160

      target function =                  N/A
              le_mean =     -16.905765011314
             les_mean =     286.142938290961
             stat err =       0.000461075545
             autocorr =       1.257754860525
              std dev =       0.581418818263
             le_variance =       0.338047842230

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338058081456
                                         uncertainty =       0.004235342765

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338058081456
                                         uncertainty =       0.004235342765

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411125201
  error estimate for blocks of size 2^( 2) =       0.000423430458
  error estimate for blocks of size 2^( 3) =       0.000436322138
  error estimate for blocks of size 2^( 4) =       0.000448419041
  error estimate for blocks of size 2^( 5) =       0.000457656385
  error estimate for blocks of size 2^( 6) =       0.000466273611
  error estimate for blocks of size 2^( 7) =       0.000471953164

      target function =                  N/A
              le_mean =     -16.905765010807
             les_mean =     286.142938293969
             stat err =       0.000461075550
             autocorr =       1.257754813538
              std dev =       0.581418835577
             le_variance =       0.338047862364

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338058071387
                                         uncertainty =       0.004235342621

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338058071387
                                         uncertainty =       0.004235342621

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411125195
  error estimate for blocks of size 2^( 2) =       0.000423430453
  error estimate for blocks of size 2^( 3) =       0.000436322134
  error estimate for blocks of size 2^( 4) =       0.000448419038
  error estimate for blocks of size 2^( 5) =       0.000457656383
  error estimate for blocks of size 2^( 6) =       0.000466273609
  error estimate for blocks of size 2^( 7) =       0.000471953162

      target function =                  N/A
              le_mean =     -16.905765011060
             les_mean =     286.142938292464
             stat err =       0.000461075548
             autocorr =       1.257754837036
              std dev =       0.581418826920
             le_variance =       0.338047852297

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338058062577
                                         uncertainty =       0.004235342496

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338058062577
                                         uncertainty =       0.004235342496

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411125190
  error estimate for blocks of size 2^( 2) =       0.000423430449
  error estimate for blocks of size 2^( 3) =       0.000436322131
  error estimate for blocks of size 2^( 4) =       0.000448419035
  error estimate for blocks of size 2^( 5) =       0.000457656380
  error estimate for blocks of size 2^( 6) =       0.000466273607
  error estimate for blocks of size 2^( 7) =       0.000471953160

      target function =                  N/A
              le_mean =     -16.905765011282
             les_mean =     286.142938291149
             stat err =       0.000461075545
             autocorr =       1.257754857581
              std dev =       0.581418819345
             le_variance =       0.338047843488


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905765011314        initial  <--
     1.5625e+04     1.5625e+05             4.6908e-08       -16.905765010807
     6.2500e+04     6.2500e+05             1.1727e-08       -16.905765011060
     2.5000e+05     2.5000e+06             2.9318e-09       -16.905765011282

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5280
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.092933e-01 1 1  ON 0
 uu_1                 1.425581e-01 1 1  ON 1
 uu_2                 4.090837e-02 1 1  ON 2
 uu_3                -2.150581e-02 1 1  ON 3
 uu_4                -6.690997e-02 1 1  ON 4
 uu_5                -1.013426e-01 1 1  ON 5
 uu_6                -1.282010e-01 1 1  ON 6
 uu_7                -1.411935e-01 1 1  ON 7
 uu_8                -1.329673e-01 1 1  ON 8
 uu_9                -1.043536e-01 1 1  ON 9
 ud_0                 4.443527e-01 1 1  ON 10
 ud_1                 1.801295e-01 1 1  ON 11
 ud_2                 6.325054e-02 1 1  ON 12
 ud_3                -6.192832e-03 1 1  ON 13
 ud_4                -6.411883e-02 1 1  ON 14
 ud_5                -1.066798e-01 1 1  ON 15
 ud_6                -1.344888e-01 1 1  ON 16
 ud_7                -1.516146e-01 1 1  ON 17
 ud_8                -1.521892e-01 1 1  ON 18
 ud_9                -1.426112e-01 1 1  ON 19
 eO_0                -7.585650e-01 1 1  ON 20
 eO_1                -4.404406e-01 1 1  ON 21
 eO_2                -2.262437e-02 1 1  ON 22
 eO_3                 2.977541e-01 1 1  ON 23
 eO_4                 5.252170e-01 1 1  ON 24
 eO_5                 4.870201e-01 1 1  ON 25
 eO_6                 2.596886e-01 1 1  ON 26
 eO_7                -4.096972e-02 1 1  ON 27
 eO_8                -2.205874e-01 1 1  ON 28
 eO_9                -8.532273e-02 1 1  ON 29
eH1_0                -2.414798e-01 1 1  ON 30
eH1_1                -1.440753e-01 1 1  ON 31
eH1_2                -9.924639e-02 1 1  ON 32
eH1_3                -4.540298e-02 1 1  ON 33
eH1_4                 2.880356e-03 1 1  ON 34
eH1_5                 3.773231e-02 1 1  ON 35
eH1_6                 9.700215e-02 1 1  ON 36
eH1_7                 1.538045e-01 1 1  ON 37
eH1_8                 1.762282e-01 1 1  ON 38
eH1_9                 6.658133e-02 1 1  ON 39
eH2_0                -2.395720e-01 1 1  ON 40
eH2_1                -1.418636e-01 1 1  ON 41
eH2_2                -9.688539e-02 1 1  ON 42
eH2_3                -4.316091e-02 1 1  ON 43
eH2_4                 5.105057e-03 1 1  ON 44
eH2_5                 3.979582e-02 1 1  ON 45
eH2_6                 9.952831e-02 1 1  ON 46
eH2_7                 1.556286e-01 1 1  ON 47
eH2_8                 1.821134e-01 1 1  ON 48
eH2_9                 5.595293e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5481e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6881e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.9074
    reference variance = 0.233372
====================================================
  Execution time = 2.0658e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3469e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5353e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334612083665
                                         uncertainty =       0.003997939871

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334612083665
                                         uncertainty =       0.003997939871

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409080256
  error estimate for blocks of size 2^( 2) =       0.000421809138
  error estimate for blocks of size 2^( 3) =       0.000434940580
  error estimate for blocks of size 2^( 4) =       0.000446577487
  error estimate for blocks of size 2^( 5) =       0.000456510830
  error estimate for blocks of size 2^( 6) =       0.000463715425
  error estimate for blocks of size 2^( 7) =       0.000466677184

      target function =                  N/A
              le_mean =     -16.906124560803
             les_mean =     286.151740810541
             stat err =       0.000458370232
             autocorr =       1.255497264888
              std dev =       0.578526846828
             le_variance =       0.334693312501


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690612456080e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+05, overlap shift 1.5625e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906124560803       residual = 2.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906124560831       residual = 3.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906124560830       residual = 9.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906124560775       residual = 3.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906124560791       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906124560799       residual = 2.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906124560874       residual = 7.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906124561435       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906124561133       residual = 1.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+05 is 4.571097e-09

solving harmonic davidson linear method for identity shift 6.2500e+05, overlap shift 6.2500e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906124560803       residual = 2.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906124560810       residual = 3.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906124560810       residual = 9.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906124560680       residual = 3.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906124560812       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906124560882       residual = 2.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906124560874       residual = 7.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906124560609       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906124560719       residual = 1.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+05 is 1.142776e-09

solving harmonic davidson linear method for identity shift 2.5000e+06, overlap shift 2.5000e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906124560803       residual = 2.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906124560805       residual = 3.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906124560805       residual = 9.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906124560805       residual = 3.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906124561477       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906124559905       residual = 2.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906124560382       residual = 7.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906124560602       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906124560382       residual = 1.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+06 is 2.856940e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.033980 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6205e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.092933e-01 1 1  ON 0
 uu_1                 1.425581e-01 1 1  ON 1
 uu_2                 4.090837e-02 1 1  ON 2
 uu_3                -2.150581e-02 1 1  ON 3
 uu_4                -6.690997e-02 1 1  ON 4
 uu_5                -1.013426e-01 1 1  ON 5
 uu_6                -1.282010e-01 1 1  ON 6
 uu_7                -1.411935e-01 1 1  ON 7
 uu_8                -1.329673e-01 1 1  ON 8
 uu_9                -1.043536e-01 1 1  ON 9
 ud_0                 4.443527e-01 1 1  ON 10
 ud_1                 1.801295e-01 1 1  ON 11
 ud_2                 6.325054e-02 1 1  ON 12
 ud_3                -6.192833e-03 1 1  ON 13
 ud_4                -6.411883e-02 1 1  ON 14
 ud_5                -1.066798e-01 1 1  ON 15
 ud_6                -1.344888e-01 1 1  ON 16
 ud_7                -1.516146e-01 1 1  ON 17
 ud_8                -1.521892e-01 1 1  ON 18
 ud_9                -1.426112e-01 1 1  ON 19
 eO_0                -7.585650e-01 1 1  ON 20
 eO_1                -4.404406e-01 1 1  ON 21
 eO_2                -2.262437e-02 1 1  ON 22
 eO_3                 2.977541e-01 1 1  ON 23
 eO_4                 5.252170e-01 1 1  ON 24
 eO_5                 4.870201e-01 1 1  ON 25
 eO_6                 2.596886e-01 1 1  ON 26
 eO_7                -4.096972e-02 1 1  ON 27
 eO_8                -2.205874e-01 1 1  ON 28
 eO_9                -8.532273e-02 1 1  ON 29
eH1_0                -2.414798e-01 1 1  ON 30
eH1_1                -1.440753e-01 1 1  ON 31
eH1_2                -9.924639e-02 1 1  ON 32
eH1_3                -4.540298e-02 1 1  ON 33
eH1_4                 2.880356e-03 1 1  ON 34
eH1_5                 3.773231e-02 1 1  ON 35
eH1_6                 9.700215e-02 1 1  ON 36
eH1_7                 1.538045e-01 1 1  ON 37
eH1_8                 1.762282e-01 1 1  ON 38
eH1_9                 6.658133e-02 1 1  ON 39
eH2_0                -2.395720e-01 1 1  ON 40
eH2_1                -1.418636e-01 1 1  ON 41
eH2_2                -9.688539e-02 1 1  ON 42
eH2_3                -4.316091e-02 1 1  ON 43
eH2_4                 5.105057e-03 1 1  ON 44
eH2_5                 3.979582e-02 1 1  ON 45
eH2_6                 9.952831e-02 1 1  ON 46
eH2_7                 1.556286e-01 1 1  ON 47
eH2_8                 1.821134e-01 1 1  ON 48
eH2_9                 5.595293e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.8972
    reference variance = 0.324585
====================================================
  Execution time = 1.9839e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3291e-01
  Total weights = 2.0000e+06
  Execution time = 1.8706e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332703788969
                                         uncertainty =       0.002373031698

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332703788969
                                         uncertainty =       0.002373031698

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407988449
  error estimate for blocks of size 2^( 2) =       0.000420882437
  error estimate for blocks of size 2^( 3) =       0.000434347908
  error estimate for blocks of size 2^( 4) =       0.000446830384
  error estimate for blocks of size 2^( 5) =       0.000457357744
  error estimate for blocks of size 2^( 6) =       0.000465172019
  error estimate for blocks of size 2^( 7) =       0.000470316334

      target function =                  N/A
              le_mean =     -16.906069847032
             les_mean =     286.148106655749
             stat err =       0.000459919120
             autocorr =       1.270770703068
              std dev =       0.576982798243
             le_variance =       0.332909149468

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332703790462
                                         uncertainty =       0.002373031714

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332703790462
                                         uncertainty =       0.002373031714

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407988450
  error estimate for blocks of size 2^( 2) =       0.000420882438
  error estimate for blocks of size 2^( 3) =       0.000434347908
  error estimate for blocks of size 2^( 4) =       0.000446830384
  error estimate for blocks of size 2^( 5) =       0.000457357744
  error estimate for blocks of size 2^( 6) =       0.000465172019
  error estimate for blocks of size 2^( 7) =       0.000470316334

      target function =                  N/A
              le_mean =     -16.906069847023
             les_mean =     286.148106656932
             stat err =       0.000459919120
             autocorr =       1.270770698804
              std dev =       0.576982799538
             le_variance =       0.332909150963

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332703789715
                                         uncertainty =       0.002373031706

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332703789715
                                         uncertainty =       0.002373031706

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407988450
  error estimate for blocks of size 2^( 2) =       0.000420882438
  error estimate for blocks of size 2^( 3) =       0.000434347908
  error estimate for blocks of size 2^( 4) =       0.000446830384
  error estimate for blocks of size 2^( 5) =       0.000457357744
  error estimate for blocks of size 2^( 6) =       0.000465172019
  error estimate for blocks of size 2^( 7) =       0.000470316334

      target function =                  N/A
              le_mean =     -16.906069847028
             les_mean =     286.148106656340
             stat err =       0.000459919120
             autocorr =       1.270770700929
              std dev =       0.576982798891
             le_variance =       0.332909150216

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332703789062
                                         uncertainty =       0.002373031699

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332703789062
                                         uncertainty =       0.002373031699

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407988449
  error estimate for blocks of size 2^( 2) =       0.000420882437
  error estimate for blocks of size 2^( 3) =       0.000434347908
  error estimate for blocks of size 2^( 4) =       0.000446830384
  error estimate for blocks of size 2^( 5) =       0.000457357744
  error estimate for blocks of size 2^( 6) =       0.000465172019
  error estimate for blocks of size 2^( 7) =       0.000470316334

      target function =                  N/A
              le_mean =     -16.906069847032
             les_mean =     286.148106655823
             stat err =       0.000459919120
             autocorr =       1.270770702799
              std dev =       0.576982798324
             le_variance =       0.332909149562


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906069847032        initial  <--
     1.5625e+05     1.5625e+06             4.5711e-09       -16.906069847023
     6.2500e+05     6.2500e+06             1.1428e-09       -16.906069847028
     2.5000e+06     2.5000e+07             2.8569e-10       -16.906069847032

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.2997
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.092933e-01 1 1  ON 0
 uu_1                 1.425581e-01 1 1  ON 1
 uu_2                 4.090837e-02 1 1  ON 2
 uu_3                -2.150581e-02 1 1  ON 3
 uu_4                -6.690997e-02 1 1  ON 4
 uu_5                -1.013426e-01 1 1  ON 5
 uu_6                -1.282010e-01 1 1  ON 6
 uu_7                -1.411935e-01 1 1  ON 7
 uu_8                -1.329673e-01 1 1  ON 8
 uu_9                -1.043536e-01 1 1  ON 9
 ud_0                 4.443527e-01 1 1  ON 10
 ud_1                 1.801295e-01 1 1  ON 11
 ud_2                 6.325054e-02 1 1  ON 12
 ud_3                -6.192832e-03 1 1  ON 13
 ud_4                -6.411883e-02 1 1  ON 14
 ud_5                -1.066798e-01 1 1  ON 15
 ud_6                -1.344888e-01 1 1  ON 16
 ud_7                -1.516146e-01 1 1  ON 17
 ud_8                -1.521892e-01 1 1  ON 18
 ud_9                -1.426112e-01 1 1  ON 19
 eO_0                -7.585650e-01 1 1  ON 20
 eO_1                -4.404406e-01 1 1  ON 21
 eO_2                -2.262437e-02 1 1  ON 22
 eO_3                 2.977541e-01 1 1  ON 23
 eO_4                 5.252170e-01 1 1  ON 24
 eO_5                 4.870201e-01 1 1  ON 25
 eO_6                 2.596886e-01 1 1  ON 26
 eO_7                -4.096972e-02 1 1  ON 27
 eO_8                -2.205874e-01 1 1  ON 28
 eO_9                -8.532273e-02 1 1  ON 29
eH1_0                -2.414798e-01 1 1  ON 30
eH1_1                -1.440753e-01 1 1  ON 31
eH1_2                -9.924639e-02 1 1  ON 32
eH1_3                -4.540298e-02 1 1  ON 33
eH1_4                 2.880356e-03 1 1  ON 34
eH1_5                 3.773231e-02 1 1  ON 35
eH1_6                 9.700215e-02 1 1  ON 36
eH1_7                 1.538045e-01 1 1  ON 37
eH1_8                 1.762282e-01 1 1  ON 38
eH1_9                 6.658133e-02 1 1  ON 39
eH2_0                -2.395720e-01 1 1  ON 40
eH2_1                -1.418636e-01 1 1  ON 41
eH2_2                -9.688539e-02 1 1  ON 42
eH2_3                -4.316091e-02 1 1  ON 43
eH2_4                 5.105057e-03 1 1  ON 44
eH2_5                 3.979582e-02 1 1  ON 45
eH2_6                 9.952831e-02 1 1  ON 46
eH2_7                 1.556286e-01 1 1  ON 47
eH2_8                 1.821134e-01 1 1  ON 48
eH2_9                 5.595293e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5510e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6883e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.8998
    reference variance = 0.193452
====================================================
  Execution time = 2.2562e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.6100e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5619e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.361074400114
                                         uncertainty =       0.010838630773

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.361074400114
                                         uncertainty =       0.010838630773

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000424851111
  error estimate for blocks of size 2^( 2) =       0.000437659088
  error estimate for blocks of size 2^( 3) =       0.000450288144
  error estimate for blocks of size 2^( 4) =       0.000461690324
  error estimate for blocks of size 2^( 5) =       0.000471691007
  error estimate for blocks of size 2^( 6) =       0.000479859281
  error estimate for blocks of size 2^( 7) =       0.000481843905

      target function =                  N/A
              le_mean =     -16.905481550927
             les_mean =     286.156303221610
             stat err =       0.000473771129
             autocorr =       1.243551187965
              std dev =       0.600830203458
             le_variance =       0.360996933388


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690548155093e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+06, overlap shift 1.5625e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905481550927       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905481550931       residual = 3.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905481550932       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905481550932       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905481551687       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905481551097       residual = 2.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905481550580       residual = 6.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905481550837       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905481548622       residual = 1.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+06 is 3.702475e-10

solving harmonic davidson linear method for identity shift 6.2500e+06, overlap shift 6.2500e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905481550927       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905481550928       residual = 3.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905481550928       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905481550825       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905481553450       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905481549805       residual = 2.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905481542234       residual = 6.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905481559691       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905481551745       residual = 1.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+06 is 9.256199e-11

solving harmonic davidson linear method for identity shift 2.5000e+07, overlap shift 2.5000e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905481550927       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905481550927       residual = 3.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905481550927       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905481550927       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905481556230       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905481551370       residual = 2.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905481545750       residual = 6.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905481563206       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905481535985       residual = 1.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+07 is 2.314060e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.037021 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8136e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.092933e-01 1 1  ON 0
 uu_1                 1.425581e-01 1 1  ON 1
 uu_2                 4.090837e-02 1 1  ON 2
 uu_3                -2.150581e-02 1 1  ON 3
 uu_4                -6.690997e-02 1 1  ON 4
 uu_5                -1.013426e-01 1 1  ON 5
 uu_6                -1.282010e-01 1 1  ON 6
 uu_7                -1.411935e-01 1 1  ON 7
 uu_8                -1.329673e-01 1 1  ON 8
 uu_9                -1.043536e-01 1 1  ON 9
 ud_0                 4.443527e-01 1 1  ON 10
 ud_1                 1.801295e-01 1 1  ON 11
 ud_2                 6.325054e-02 1 1  ON 12
 ud_3                -6.192832e-03 1 1  ON 13
 ud_4                -6.411883e-02 1 1  ON 14
 ud_5                -1.066798e-01 1 1  ON 15
 ud_6                -1.344888e-01 1 1  ON 16
 ud_7                -1.516146e-01 1 1  ON 17
 ud_8                -1.521892e-01 1 1  ON 18
 ud_9                -1.426112e-01 1 1  ON 19
 eO_0                -7.585650e-01 1 1  ON 20
 eO_1                -4.404406e-01 1 1  ON 21
 eO_2                -2.262437e-02 1 1  ON 22
 eO_3                 2.977541e-01 1 1  ON 23
 eO_4                 5.252170e-01 1 1  ON 24
 eO_5                 4.870201e-01 1 1  ON 25
 eO_6                 2.596886e-01 1 1  ON 26
 eO_7                -4.096972e-02 1 1  ON 27
 eO_8                -2.205874e-01 1 1  ON 28
 eO_9                -8.532273e-02 1 1  ON 29
eH1_0                -2.414798e-01 1 1  ON 30
eH1_1                -1.440753e-01 1 1  ON 31
eH1_2                -9.924639e-02 1 1  ON 32
eH1_3                -4.540298e-02 1 1  ON 33
eH1_4                 2.880356e-03 1 1  ON 34
eH1_5                 3.773231e-02 1 1  ON 35
eH1_6                 9.700215e-02 1 1  ON 36
eH1_7                 1.538045e-01 1 1  ON 37
eH1_8                 1.762282e-01 1 1  ON 38
eH1_9                 6.658133e-02 1 1  ON 39
eH2_0                -2.395720e-01 1 1  ON 40
eH2_1                -1.418636e-01 1 1  ON 41
eH2_2                -9.688539e-02 1 1  ON 42
eH2_3                -4.316091e-02 1 1  ON 43
eH2_4                 5.105057e-03 1 1  ON 44
eH2_5                 3.979582e-02 1 1  ON 45
eH2_6                 9.952831e-02 1 1  ON 46
eH2_7                 1.556286e-01 1 1  ON 47
eH2_8                 1.821134e-01 1 1  ON 48
eH2_9                 5.595293e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.8214
    reference variance = 0.261908
====================================================
  Execution time = 2.0002e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4857e-01
  Total weights = 2.0000e+06
  Execution time = 1.8716e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348651475745
                                         uncertainty =       0.006616670469

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348651475745
                                         uncertainty =       0.006616670469

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417472592
  error estimate for blocks of size 2^( 2) =       0.000429899731
  error estimate for blocks of size 2^( 3) =       0.000443178658
  error estimate for blocks of size 2^( 4) =       0.000455427721
  error estimate for blocks of size 2^( 5) =       0.000465056533
  error estimate for blocks of size 2^( 6) =       0.000471335850
  error estimate for blocks of size 2^( 7) =       0.000478677550

      target function =                  N/A
              le_mean =     -16.905950013726
             les_mean =     286.159712422343
             stat err =       0.000467624414
             autocorr =       1.254695719882
              std dev =       0.590395401413
             le_variance =       0.348566730009

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348651476009
                                         uncertainty =       0.006616670456

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348651476009
                                         uncertainty =       0.006616670456

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417472592
  error estimate for blocks of size 2^( 2) =       0.000429899731
  error estimate for blocks of size 2^( 3) =       0.000443178658
  error estimate for blocks of size 2^( 4) =       0.000455427722
  error estimate for blocks of size 2^( 5) =       0.000465056533
  error estimate for blocks of size 2^( 6) =       0.000471335850
  error estimate for blocks of size 2^( 7) =       0.000478677550

      target function =                  N/A
              le_mean =     -16.905950013727
             les_mean =     286.159712422638
             stat err =       0.000467624414
             autocorr =       1.254695719509
              std dev =       0.590395401636
             le_variance =       0.348566730273

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348651475877
                                         uncertainty =       0.006616670463

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348651475877
                                         uncertainty =       0.006616670463

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417472592
  error estimate for blocks of size 2^( 2) =       0.000429899731
  error estimate for blocks of size 2^( 3) =       0.000443178658
  error estimate for blocks of size 2^( 4) =       0.000455427721
  error estimate for blocks of size 2^( 5) =       0.000465056533
  error estimate for blocks of size 2^( 6) =       0.000471335850
  error estimate for blocks of size 2^( 7) =       0.000478677550

      target function =                  N/A
              le_mean =     -16.905950013727
             les_mean =     286.159712422490
             stat err =       0.000467624414
             autocorr =       1.254695719693
              std dev =       0.590395401524
             le_variance =       0.348566730141

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348651475762
                                         uncertainty =       0.006616670468

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348651475762
                                         uncertainty =       0.006616670468

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417472592
  error estimate for blocks of size 2^( 2) =       0.000429899731
  error estimate for blocks of size 2^( 3) =       0.000443178658
  error estimate for blocks of size 2^( 4) =       0.000455427721
  error estimate for blocks of size 2^( 5) =       0.000465056533
  error estimate for blocks of size 2^( 6) =       0.000471335850
  error estimate for blocks of size 2^( 7) =       0.000478677550

      target function =                  N/A
              le_mean =     -16.905950013726
             les_mean =     286.159712422361
             stat err =       0.000467624414
             autocorr =       1.254695719858
              std dev =       0.590395401427
             le_variance =       0.348566730026


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905950013726        initial
     1.5625e+06     1.5625e+07             3.7025e-10       -16.905950013727  <--
     6.2500e+06     6.2500e+07             9.2562e-11       -16.905950013727
     2.5000e+07     2.5000e+08             2.3141e-11       -16.905950013726

*****************************************************************************
Applying the update for shift_i =   1.5625e+06     and shift_s =   1.5625e+07
*****************************************************************************

  Execution time = 2.9446e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.092933e-01 1 1  ON 0
 uu_1                 1.425581e-01 1 1  ON 1
 uu_2                 4.090837e-02 1 1  ON 2
 uu_3                -2.150581e-02 1 1  ON 3
 uu_4                -6.690997e-02 1 1  ON 4
 uu_5                -1.013426e-01 1 1  ON 5
 uu_6                -1.282010e-01 1 1  ON 6
 uu_7                -1.411935e-01 1 1  ON 7
 uu_8                -1.329673e-01 1 1  ON 8
 uu_9                -1.043536e-01 1 1  ON 9
 ud_0                 4.443527e-01 1 1  ON 10
 ud_1                 1.801295e-01 1 1  ON 11
 ud_2                 6.325054e-02 1 1  ON 12
 ud_3                -6.192833e-03 1 1  ON 13
 ud_4                -6.411883e-02 1 1  ON 14
 ud_5                -1.066798e-01 1 1  ON 15
 ud_6                -1.344888e-01 1 1  ON 16
 ud_7                -1.516146e-01 1 1  ON 17
 ud_8                -1.521892e-01 1 1  ON 18
 ud_9                -1.426112e-01 1 1  ON 19
 eO_0                -7.585650e-01 1 1  ON 20
 eO_1                -4.404406e-01 1 1  ON 21
 eO_2                -2.262437e-02 1 1  ON 22
 eO_3                 2.977541e-01 1 1  ON 23
 eO_4                 5.252170e-01 1 1  ON 24
 eO_5                 4.870201e-01 1 1  ON 25
 eO_6                 2.596886e-01 1 1  ON 26
 eO_7                -4.096972e-02 1 1  ON 27
 eO_8                -2.205874e-01 1 1  ON 28
 eO_9                -8.532273e-02 1 1  ON 29
eH1_0                -2.414798e-01 1 1  ON 30
eH1_1                -1.440753e-01 1 1  ON 31
eH1_2                -9.924639e-02 1 1  ON 32
eH1_3                -4.540298e-02 1 1  ON 33
eH1_4                 2.880356e-03 1 1  ON 34
eH1_5                 3.773231e-02 1 1  ON 35
eH1_6                 9.700215e-02 1 1  ON 36
eH1_7                 1.538045e-01 1 1  ON 37
eH1_8                 1.762282e-01 1 1  ON 38
eH1_9                 6.658133e-02 1 1  ON 39
eH2_0                -2.395720e-01 1 1  ON 40
eH2_1                -1.418636e-01 1 1  ON 41
eH2_2                -9.688539e-02 1 1  ON 42
eH2_3                -4.316091e-02 1 1  ON 43
eH2_4                 5.105057e-03 1 1  ON 44
eH2_5                 3.979582e-02 1 1  ON 45
eH2_6                 9.952831e-02 1 1  ON 46
eH2_7                 1.556286e-01 1 1  ON 47
eH2_8                 1.821134e-01 1 1  ON 48
eH2_9                 5.595293e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7588e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6881e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.8586
    reference variance = 0.129042
====================================================
  Execution time = 2.0332e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4083e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5779e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340968506775
                                         uncertainty =       0.004236894494

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340968506775
                                         uncertainty =       0.004236894494

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412813212
  error estimate for blocks of size 2^( 2) =       0.000425668193
  error estimate for blocks of size 2^( 3) =       0.000438149988
  error estimate for blocks of size 2^( 4) =       0.000449319718
  error estimate for blocks of size 2^( 5) =       0.000458298180
  error estimate for blocks of size 2^( 6) =       0.000464372882
  error estimate for blocks of size 2^( 7) =       0.000467026658

      target function =                  N/A
              le_mean =     -16.905471619458
             les_mean =     286.135800001160
             stat err =       0.000459754360
             autocorr =       1.240350815067
              std dev =       0.583806042503
             le_variance =       0.340829495262


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690547161946e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+05, overlap shift 3.9062e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905471619458       residual = 2.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905471619472       residual = 3.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905471619481       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905471619620       residual = 4.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905471619439       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905471619449       residual = 3.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905471619401       residual = 7.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905471619781       residual = 1.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905471620208       residual = 1.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+05 is 1.934793e-09

solving harmonic davidson linear method for identity shift 1.5625e+06, overlap shift 1.5625e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905471619458       residual = 2.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905471619462       residual = 3.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905471619464       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905471619465       residual = 4.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905471620168       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905471619348       residual = 3.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905471619686       residual = 7.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905471619752       residual = 1.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905471619946       residual = 1.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+06 is 4.836989e-10

solving harmonic davidson linear method for identity shift 6.2500e+06, overlap shift 6.2500e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905471619458       residual = 2.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905471619459       residual = 3.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905471619460       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905471619460       residual = 4.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905471619159       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905471620190       residual = 3.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905471617346       residual = 7.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905471622977       residual = 1.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905471619489       residual = 1.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+06 is 1.209249e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.040063 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5936e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.092933e-01 1 1  ON 0
 uu_1                 1.425581e-01 1 1  ON 1
 uu_2                 4.090837e-02 1 1  ON 2
 uu_3                -2.150581e-02 1 1  ON 3
 uu_4                -6.690997e-02 1 1  ON 4
 uu_5                -1.013426e-01 1 1  ON 5
 uu_6                -1.282010e-01 1 1  ON 6
 uu_7                -1.411935e-01 1 1  ON 7
 uu_8                -1.329673e-01 1 1  ON 8
 uu_9                -1.043536e-01 1 1  ON 9
 ud_0                 4.443527e-01 1 1  ON 10
 ud_1                 1.801295e-01 1 1  ON 11
 ud_2                 6.325054e-02 1 1  ON 12
 ud_3                -6.192833e-03 1 1  ON 13
 ud_4                -6.411883e-02 1 1  ON 14
 ud_5                -1.066798e-01 1 1  ON 15
 ud_6                -1.344888e-01 1 1  ON 16
 ud_7                -1.516146e-01 1 1  ON 17
 ud_8                -1.521892e-01 1 1  ON 18
 ud_9                -1.426112e-01 1 1  ON 19
 eO_0                -7.585650e-01 1 1  ON 20
 eO_1                -4.404406e-01 1 1  ON 21
 eO_2                -2.262437e-02 1 1  ON 22
 eO_3                 2.977541e-01 1 1  ON 23
 eO_4                 5.252170e-01 1 1  ON 24
 eO_5                 4.870201e-01 1 1  ON 25
 eO_6                 2.596886e-01 1 1  ON 26
 eO_7                -4.096972e-02 1 1  ON 27
 eO_8                -2.205874e-01 1 1  ON 28
 eO_9                -8.532273e-02 1 1  ON 29
eH1_0                -2.414798e-01 1 1  ON 30
eH1_1                -1.440753e-01 1 1  ON 31
eH1_2                -9.924639e-02 1 1  ON 32
eH1_3                -4.540298e-02 1 1  ON 33
eH1_4                 2.880356e-03 1 1  ON 34
eH1_5                 3.773231e-02 1 1  ON 35
eH1_6                 9.700215e-02 1 1  ON 36
eH1_7                 1.538045e-01 1 1  ON 37
eH1_8                 1.762282e-01 1 1  ON 38
eH1_9                 6.658133e-02 1 1  ON 39
eH2_0                -2.395720e-01 1 1  ON 40
eH2_1                -1.418636e-01 1 1  ON 41
eH2_2                -9.688539e-02 1 1  ON 42
eH2_3                -4.316091e-02 1 1  ON 43
eH2_4                 5.105057e-03 1 1  ON 44
eH2_5                 3.979582e-02 1 1  ON 45
eH2_6                 9.952831e-02 1 1  ON 46
eH2_7                 1.556286e-01 1 1  ON 47
eH2_8                 1.821134e-01 1 1  ON 48
eH2_9                 5.595293e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.8974
    reference variance = 0.243405
====================================================
  Execution time = 2.0130e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3841e-01
  Total weights = 2.0000e+06
  Execution time = 1.8777e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338369432120
                                         uncertainty =       0.005660711047

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338369432120
                                         uncertainty =       0.005660711047

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411348093
  error estimate for blocks of size 2^( 2) =       0.000424167918
  error estimate for blocks of size 2^( 3) =       0.000437202762
  error estimate for blocks of size 2^( 4) =       0.000448849205
  error estimate for blocks of size 2^( 5) =       0.000458580238
  error estimate for blocks of size 2^( 6) =       0.000464988765
  error estimate for blocks of size 2^( 7) =       0.000467609550

      target function =                  N/A
              le_mean =     -16.906528280715
             les_mean =     286.169112845067
             stat err =       0.000460006939
             autocorr =       1.250575134985
              std dev =       0.581734052358
             le_variance =       0.338414507673

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338369433011
                                         uncertainty =       0.005660711045

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338369433011
                                         uncertainty =       0.005660711045

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411348094
  error estimate for blocks of size 2^( 2) =       0.000424167918
  error estimate for blocks of size 2^( 3) =       0.000437202762
  error estimate for blocks of size 2^( 4) =       0.000448849205
  error estimate for blocks of size 2^( 5) =       0.000458580238
  error estimate for blocks of size 2^( 6) =       0.000464988766
  error estimate for blocks of size 2^( 7) =       0.000467609550

      target function =                  N/A
              le_mean =     -16.906528280702
             les_mean =     286.169112845543
             stat err =       0.000460006940
             autocorr =       1.250575133061
              std dev =       0.581734053126
             le_variance =       0.338414508566

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338369432566
                                         uncertainty =       0.005660711046

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338369432566
                                         uncertainty =       0.005660711046

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411348094
  error estimate for blocks of size 2^( 2) =       0.000424167918
  error estimate for blocks of size 2^( 3) =       0.000437202762
  error estimate for blocks of size 2^( 4) =       0.000448849205
  error estimate for blocks of size 2^( 5) =       0.000458580238
  error estimate for blocks of size 2^( 6) =       0.000464988765
  error estimate for blocks of size 2^( 7) =       0.000467609550

      target function =                  N/A
              le_mean =     -16.906528280708
             les_mean =     286.169112845305
             stat err =       0.000460006940
             autocorr =       1.250575134014
              std dev =       0.581734052742
             le_variance =       0.338414508120

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338369432176
                                         uncertainty =       0.005660711047

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338369432176
                                         uncertainty =       0.005660711047

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411348093
  error estimate for blocks of size 2^( 2) =       0.000424167918
  error estimate for blocks of size 2^( 3) =       0.000437202762
  error estimate for blocks of size 2^( 4) =       0.000448849205
  error estimate for blocks of size 2^( 5) =       0.000458580238
  error estimate for blocks of size 2^( 6) =       0.000464988765
  error estimate for blocks of size 2^( 7) =       0.000467609550

      target function =                  N/A
              le_mean =     -16.906528280714
             les_mean =     286.169112845097
             stat err =       0.000460006939
             autocorr =       1.250575134857
              std dev =       0.581734052406
             le_variance =       0.338414507729


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906528280715        initial  <--
     3.9062e+05     3.9062e+06             1.9348e-09       -16.906528280702
     1.5625e+06     1.5625e+07             4.8370e-10       -16.906528280708
     6.2500e+06     6.2500e+07             1.2092e-10       -16.906528280714

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6019
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.092933e-01 1 1  ON 0
 uu_1                 1.425581e-01 1 1  ON 1
 uu_2                 4.090837e-02 1 1  ON 2
 uu_3                -2.150581e-02 1 1  ON 3
 uu_4                -6.690997e-02 1 1  ON 4
 uu_5                -1.013426e-01 1 1  ON 5
 uu_6                -1.282010e-01 1 1  ON 6
 uu_7                -1.411935e-01 1 1  ON 7
 uu_8                -1.329673e-01 1 1  ON 8
 uu_9                -1.043536e-01 1 1  ON 9
 ud_0                 4.443527e-01 1 1  ON 10
 ud_1                 1.801295e-01 1 1  ON 11
 ud_2                 6.325054e-02 1 1  ON 12
 ud_3                -6.192833e-03 1 1  ON 13
 ud_4                -6.411883e-02 1 1  ON 14
 ud_5                -1.066798e-01 1 1  ON 15
 ud_6                -1.344888e-01 1 1  ON 16
 ud_7                -1.516146e-01 1 1  ON 17
 ud_8                -1.521892e-01 1 1  ON 18
 ud_9                -1.426112e-01 1 1  ON 19
 eO_0                -7.585650e-01 1 1  ON 20
 eO_1                -4.404406e-01 1 1  ON 21
 eO_2                -2.262437e-02 1 1  ON 22
 eO_3                 2.977541e-01 1 1  ON 23
 eO_4                 5.252170e-01 1 1  ON 24
 eO_5                 4.870201e-01 1 1  ON 25
 eO_6                 2.596886e-01 1 1  ON 26
 eO_7                -4.096972e-02 1 1  ON 27
 eO_8                -2.205874e-01 1 1  ON 28
 eO_9                -8.532273e-02 1 1  ON 29
eH1_0                -2.414798e-01 1 1  ON 30
eH1_1                -1.440753e-01 1 1  ON 31
eH1_2                -9.924639e-02 1 1  ON 32
eH1_3                -4.540298e-02 1 1  ON 33
eH1_4                 2.880356e-03 1 1  ON 34
eH1_5                 3.773231e-02 1 1  ON 35
eH1_6                 9.700215e-02 1 1  ON 36
eH1_7                 1.538045e-01 1 1  ON 37
eH1_8                 1.762282e-01 1 1  ON 38
eH1_9                 6.658133e-02 1 1  ON 39
eH2_0                -2.395720e-01 1 1  ON 40
eH2_1                -1.418636e-01 1 1  ON 41
eH2_2                -9.688539e-02 1 1  ON 42
eH2_3                -4.316091e-02 1 1  ON 43
eH2_4                 5.105057e-03 1 1  ON 44
eH2_5                 3.979582e-02 1 1  ON 45
eH2_6                 9.952831e-02 1 1  ON 46
eH2_7                 1.556286e-01 1 1  ON 47
eH2_8                 1.821134e-01 1 1  ON 48
eH2_9                 5.595293e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5544e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6881e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.9556
    reference variance = 0.246436
====================================================
  Execution time = 2.2175e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3344e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6431e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333241832055
                                         uncertainty =       0.003305704341

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333241832055
                                         uncertainty =       0.003305704341

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408316513
  error estimate for blocks of size 2^( 2) =       0.000420808066
  error estimate for blocks of size 2^( 3) =       0.000433794400
  error estimate for blocks of size 2^( 4) =       0.000445513737
  error estimate for blocks of size 2^( 5) =       0.000455463786
  error estimate for blocks of size 2^( 6) =       0.000462473056
  error estimate for blocks of size 2^( 7) =       0.000469417529

      target function =                  N/A
              le_mean =     -16.905191540278
             les_mean =     286.118945595971
             stat err =       0.000458217027
             autocorr =       1.259356125695
              std dev =       0.577446750094
             le_variance =       0.333444749194


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690519154028e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+06, overlap shift 3.9062e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905191540278       residual = 2.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905191540281       residual = 3.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905191540282       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905191540280       residual = 3.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905191540282       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905191540669       residual = 3.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905191542722       residual = 6.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905191539036       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905191540296       residual = 1.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+06 is 1.755750e-10

solving harmonic davidson linear method for identity shift 1.5625e+07, overlap shift 1.5625e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905191540278       residual = 2.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905191540279       residual = 3.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905191540279       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905191536955       residual = 3.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905191533585       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905191542771       residual = 3.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905191551648       residual = 6.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905191542217       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905191539986       residual = 1.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+07 is 4.389413e-11

solving harmonic davidson linear method for identity shift 6.2500e+07, overlap shift 6.2500e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905191540278       residual = 2.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905191540279       residual = 3.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905191540279       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905191540279       residual = 3.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905191541421       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905191528275       residual = 3.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905191466107       residual = 6.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905191474460       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905191619364       residual = 1.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+07 is 1.097225e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.043067 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7829e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.092933e-01 1 1  ON 0
 uu_1                 1.425581e-01 1 1  ON 1
 uu_2                 4.090837e-02 1 1  ON 2
 uu_3                -2.150581e-02 1 1  ON 3
 uu_4                -6.690997e-02 1 1  ON 4
 uu_5                -1.013426e-01 1 1  ON 5
 uu_6                -1.282010e-01 1 1  ON 6
 uu_7                -1.411935e-01 1 1  ON 7
 uu_8                -1.329673e-01 1 1  ON 8
 uu_9                -1.043536e-01 1 1  ON 9
 ud_0                 4.443527e-01 1 1  ON 10
 ud_1                 1.801295e-01 1 1  ON 11
 ud_2                 6.325054e-02 1 1  ON 12
 ud_3                -6.192833e-03 1 1  ON 13
 ud_4                -6.411883e-02 1 1  ON 14
 ud_5                -1.066798e-01 1 1  ON 15
 ud_6                -1.344888e-01 1 1  ON 16
 ud_7                -1.516146e-01 1 1  ON 17
 ud_8                -1.521892e-01 1 1  ON 18
 ud_9                -1.426112e-01 1 1  ON 19
 eO_0                -7.585650e-01 1 1  ON 20
 eO_1                -4.404406e-01 1 1  ON 21
 eO_2                -2.262437e-02 1 1  ON 22
 eO_3                 2.977541e-01 1 1  ON 23
 eO_4                 5.252170e-01 1 1  ON 24
 eO_5                 4.870201e-01 1 1  ON 25
 eO_6                 2.596886e-01 1 1  ON 26
 eO_7                -4.096972e-02 1 1  ON 27
 eO_8                -2.205874e-01 1 1  ON 28
 eO_9                -8.532273e-02 1 1  ON 29
eH1_0                -2.414798e-01 1 1  ON 30
eH1_1                -1.440753e-01 1 1  ON 31
eH1_2                -9.924639e-02 1 1  ON 32
eH1_3                -4.540298e-02 1 1  ON 33
eH1_4                 2.880356e-03 1 1  ON 34
eH1_5                 3.773231e-02 1 1  ON 35
eH1_6                 9.700215e-02 1 1  ON 36
eH1_7                 1.538045e-01 1 1  ON 37
eH1_8                 1.762282e-01 1 1  ON 38
eH1_9                 6.658133e-02 1 1  ON 39
eH2_0                -2.395720e-01 1 1  ON 40
eH2_1                -1.418636e-01 1 1  ON 41
eH2_2                -9.688539e-02 1 1  ON 42
eH2_3                -4.316091e-02 1 1  ON 43
eH2_4                 5.105057e-03 1 1  ON 44
eH2_5                 3.979582e-02 1 1  ON 45
eH2_6                 9.952831e-02 1 1  ON 46
eH2_7                 1.556286e-01 1 1  ON 47
eH2_8                 1.821134e-01 1 1  ON 48
eH2_9                 5.595293e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.925
    reference variance = 0.22847
====================================================
  Execution time = 2.0052e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3587e-01
  Total weights = 2.0000e+06
  Execution time = 1.8815e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335990556809
                                         uncertainty =       0.003555829934

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335990556809
                                         uncertainty =       0.003555829934

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409795812
  error estimate for blocks of size 2^( 2) =       0.000422507892
  error estimate for blocks of size 2^( 3) =       0.000435443008
  error estimate for blocks of size 2^( 4) =       0.000447261145
  error estimate for blocks of size 2^( 5) =       0.000458533351
  error estimate for blocks of size 2^( 6) =       0.000465476084
  error estimate for blocks of size 2^( 7) =       0.000468367404

      target function =                  N/A
              le_mean =     -16.906017615159
             les_mean =     286.149296650635
             stat err =       0.000459909496
             autocorr =       1.259533500007
              std dev =       0.579538794642
             le_variance =       0.335865214495

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335990556911
                                         uncertainty =       0.003555829935

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335990556911
                                         uncertainty =       0.003555829935

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409795812
  error estimate for blocks of size 2^( 2) =       0.000422507892
  error estimate for blocks of size 2^( 3) =       0.000435443008
  error estimate for blocks of size 2^( 4) =       0.000447261145
  error estimate for blocks of size 2^( 5) =       0.000458533351
  error estimate for blocks of size 2^( 6) =       0.000465476084
  error estimate for blocks of size 2^( 7) =       0.000468367405

      target function =                  N/A
              le_mean =     -16.906017615159
             les_mean =     286.149296650729
             stat err =       0.000459909496
             autocorr =       1.259533499806
              std dev =       0.579538794729
             le_variance =       0.335865214596

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335990556860
                                         uncertainty =       0.003555829935

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335990556860
                                         uncertainty =       0.003555829935

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409795812
  error estimate for blocks of size 2^( 2) =       0.000422507892
  error estimate for blocks of size 2^( 3) =       0.000435443008
  error estimate for blocks of size 2^( 4) =       0.000447261145
  error estimate for blocks of size 2^( 5) =       0.000458533351
  error estimate for blocks of size 2^( 6) =       0.000465476084
  error estimate for blocks of size 2^( 7) =       0.000468367404

      target function =                  N/A
              le_mean =     -16.906017615159
             les_mean =     286.149296650682
             stat err =       0.000459909496
             autocorr =       1.259533499892
              std dev =       0.579538794685
             le_variance =       0.335865214545

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335990556816
                                         uncertainty =       0.003555829934

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335990556816
                                         uncertainty =       0.003555829934

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409795812
  error estimate for blocks of size 2^( 2) =       0.000422507892
  error estimate for blocks of size 2^( 3) =       0.000435443008
  error estimate for blocks of size 2^( 4) =       0.000447261145
  error estimate for blocks of size 2^( 5) =       0.000458533351
  error estimate for blocks of size 2^( 6) =       0.000465476084
  error estimate for blocks of size 2^( 7) =       0.000468367404

      target function =                  N/A
              le_mean =     -16.906017615159
             les_mean =     286.149296650641
             stat err =       0.000459909496
             autocorr =       1.259533499989
              std dev =       0.579538794647
             le_variance =       0.335865214501


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906017615159        initial  <--
     3.9062e+06     3.9062e+07             1.7558e-10       -16.906017615159
     1.5625e+07     1.5625e+08             4.3894e-11       -16.906017615159
     6.2500e+07     6.2500e+08             1.0972e-11       -16.906017615159

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5598
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.092933e-01 1 1  ON 0
 uu_1                 1.425581e-01 1 1  ON 1
 uu_2                 4.090837e-02 1 1  ON 2
 uu_3                -2.150581e-02 1 1  ON 3
 uu_4                -6.690997e-02 1 1  ON 4
 uu_5                -1.013426e-01 1 1  ON 5
 uu_6                -1.282010e-01 1 1  ON 6
 uu_7                -1.411935e-01 1 1  ON 7
 uu_8                -1.329673e-01 1 1  ON 8
 uu_9                -1.043536e-01 1 1  ON 9
 ud_0                 4.443527e-01 1 1  ON 10
 ud_1                 1.801295e-01 1 1  ON 11
 ud_2                 6.325054e-02 1 1  ON 12
 ud_3                -6.192833e-03 1 1  ON 13
 ud_4                -6.411883e-02 1 1  ON 14
 ud_5                -1.066798e-01 1 1  ON 15
 ud_6                -1.344888e-01 1 1  ON 16
 ud_7                -1.516146e-01 1 1  ON 17
 ud_8                -1.521892e-01 1 1  ON 18
 ud_9                -1.426112e-01 1 1  ON 19
 eO_0                -7.585650e-01 1 1  ON 20
 eO_1                -4.404406e-01 1 1  ON 21
 eO_2                -2.262437e-02 1 1  ON 22
 eO_3                 2.977541e-01 1 1  ON 23
 eO_4                 5.252170e-01 1 1  ON 24
 eO_5                 4.870201e-01 1 1  ON 25
 eO_6                 2.596886e-01 1 1  ON 26
 eO_7                -4.096972e-02 1 1  ON 27
 eO_8                -2.205874e-01 1 1  ON 28
 eO_9                -8.532273e-02 1 1  ON 29
eH1_0                -2.414798e-01 1 1  ON 30
eH1_1                -1.440753e-01 1 1  ON 31
eH1_2                -9.924639e-02 1 1  ON 32
eH1_3                -4.540298e-02 1 1  ON 33
eH1_4                 2.880356e-03 1 1  ON 34
eH1_5                 3.773231e-02 1 1  ON 35
eH1_6                 9.700215e-02 1 1  ON 36
eH1_7                 1.538045e-01 1 1  ON 37
eH1_8                 1.762282e-01 1 1  ON 38
eH1_9                 6.658133e-02 1 1  ON 39
eH2_0                -2.395720e-01 1 1  ON 40
eH2_1                -1.418636e-01 1 1  ON 41
eH2_2                -9.688539e-02 1 1  ON 42
eH2_3                -4.316091e-02 1 1  ON 43
eH2_4                 5.105057e-03 1 1  ON 44
eH2_5                 3.979582e-02 1 1  ON 45
eH2_6                 9.952831e-02 1 1  ON 46
eH2_7                 1.556286e-01 1 1  ON 47
eH2_8                 1.821134e-01 1 1  ON 48
eH2_9                 5.595293e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7395e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6885e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.8783
    reference variance = 0.362016
====================================================
  Execution time = 2.0506e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3784e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6045e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337921245411
                                         uncertainty =       0.004155315821

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337921245411
                                         uncertainty =       0.004155315821

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410999309
  error estimate for blocks of size 2^( 2) =       0.000423730474
  error estimate for blocks of size 2^( 3) =       0.000437242921
  error estimate for blocks of size 2^( 4) =       0.000448974376
  error estimate for blocks of size 2^( 5) =       0.000458841293
  error estimate for blocks of size 2^( 6) =       0.000465289711
  error estimate for blocks of size 2^( 7) =       0.000470390733

      target function =                  N/A
              le_mean =     -16.905611327611
             les_mean =     286.137535054899
             stat err =       0.000460874028
             autocorr =       1.257425567952
              std dev =       0.581240796557
             le_variance =       0.337840863582


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690561132761e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+07, overlap shift 3.9062e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905611327611       residual = 2.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905611327611       residual = 4.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905611327611       residual = 8.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905611327611       residual = 4.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905611323090       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905611325213       residual = 3.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905611335771       residual = 5.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905611297596       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905611317017       residual = 1.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+07 is 1.944943e-11

solving harmonic davidson linear method for identity shift 1.5625e+08, overlap shift 1.5625e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905611327611       residual = 2.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905611327611       residual = 4.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905611327611       residual = 8.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905611327611       residual = 4.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905611280891       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905611287048       residual = 3.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905611430455       residual = 5.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905611450917       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905611338028       residual = 1.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+08 is 4.863085e-12

solving harmonic davidson linear method for identity shift 6.2500e+08, overlap shift 6.2500e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905611327611       residual = 2.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905611327611       residual = 4.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905611327611       residual = 8.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905611327611       residual = 4.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905611598668       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905611327611       residual = 3.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905611526643       residual = 5.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905611262737       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905611032720       residual = 1.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+08 is 1.215766e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.046079 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6125e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.092933e-01 1 1  ON 0
 uu_1                 1.425581e-01 1 1  ON 1
 uu_2                 4.090837e-02 1 1  ON 2
 uu_3                -2.150581e-02 1 1  ON 3
 uu_4                -6.690997e-02 1 1  ON 4
 uu_5                -1.013426e-01 1 1  ON 5
 uu_6                -1.282010e-01 1 1  ON 6
 uu_7                -1.411935e-01 1 1  ON 7
 uu_8                -1.329673e-01 1 1  ON 8
 uu_9                -1.043536e-01 1 1  ON 9
 ud_0                 4.443527e-01 1 1  ON 10
 ud_1                 1.801295e-01 1 1  ON 11
 ud_2                 6.325054e-02 1 1  ON 12
 ud_3                -6.192833e-03 1 1  ON 13
 ud_4                -6.411883e-02 1 1  ON 14
 ud_5                -1.066798e-01 1 1  ON 15
 ud_6                -1.344888e-01 1 1  ON 16
 ud_7                -1.516146e-01 1 1  ON 17
 ud_8                -1.521892e-01 1 1  ON 18
 ud_9                -1.426112e-01 1 1  ON 19
 eO_0                -7.585650e-01 1 1  ON 20
 eO_1                -4.404406e-01 1 1  ON 21
 eO_2                -2.262437e-02 1 1  ON 22
 eO_3                 2.977541e-01 1 1  ON 23
 eO_4                 5.252170e-01 1 1  ON 24
 eO_5                 4.870201e-01 1 1  ON 25
 eO_6                 2.596886e-01 1 1  ON 26
 eO_7                -4.096972e-02 1 1  ON 27
 eO_8                -2.205874e-01 1 1  ON 28
 eO_9                -8.532273e-02 1 1  ON 29
eH1_0                -2.414798e-01 1 1  ON 30
eH1_1                -1.440753e-01 1 1  ON 31
eH1_2                -9.924639e-02 1 1  ON 32
eH1_3                -4.540298e-02 1 1  ON 33
eH1_4                 2.880356e-03 1 1  ON 34
eH1_5                 3.773231e-02 1 1  ON 35
eH1_6                 9.700215e-02 1 1  ON 36
eH1_7                 1.538045e-01 1 1  ON 37
eH1_8                 1.762282e-01 1 1  ON 38
eH1_9                 6.658133e-02 1 1  ON 39
eH2_0                -2.395720e-01 1 1  ON 40
eH2_1                -1.418636e-01 1 1  ON 41
eH2_2                -9.688539e-02 1 1  ON 42
eH2_3                -4.316091e-02 1 1  ON 43
eH2_4                 5.105057e-03 1 1  ON 44
eH2_5                 3.979582e-02 1 1  ON 45
eH2_6                 9.952831e-02 1 1  ON 46
eH2_7                 1.556286e-01 1 1  ON 47
eH2_8                 1.821134e-01 1 1  ON 48
eH2_9                 5.595293e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.8658
    reference variance = 0.270632
====================================================
  Execution time = 1.9855e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4297e-01
  Total weights = 2.0000e+06
  Execution time = 1.8798e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343012064687
                                         uncertainty =       0.006497129833

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343012064687
                                         uncertainty =       0.006497129833

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414109920
  error estimate for blocks of size 2^( 2) =       0.000426734496
  error estimate for blocks of size 2^( 3) =       0.000439503884
  error estimate for blocks of size 2^( 4) =       0.000451463379
  error estimate for blocks of size 2^( 5) =       0.000461655294
  error estimate for blocks of size 2^( 6) =       0.000468726285
  error estimate for blocks of size 2^( 7) =       0.000474481922

      target function =                  N/A
              le_mean =     -16.906490956703
             les_mean =     286.172410349327
             stat err =       0.000464081720
             autocorr =       1.255907505816
              std dev =       0.585639865217
             le_variance =       0.342974051731

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343012064696
                                         uncertainty =       0.006497129833

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343012064696
                                         uncertainty =       0.006497129833

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414109920
  error estimate for blocks of size 2^( 2) =       0.000426734496
  error estimate for blocks of size 2^( 3) =       0.000439503884
  error estimate for blocks of size 2^( 4) =       0.000451463379
  error estimate for blocks of size 2^( 5) =       0.000461655294
  error estimate for blocks of size 2^( 6) =       0.000468726285
  error estimate for blocks of size 2^( 7) =       0.000474481922

      target function =                  N/A
              le_mean =     -16.906490956703
             les_mean =     286.172410349339
             stat err =       0.000464081720
             autocorr =       1.255907505797
              std dev =       0.585639865224
             le_variance =       0.342974051740

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343012064691
                                         uncertainty =       0.006497129833

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343012064691
                                         uncertainty =       0.006497129833

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414109920
  error estimate for blocks of size 2^( 2) =       0.000426734496
  error estimate for blocks of size 2^( 3) =       0.000439503884
  error estimate for blocks of size 2^( 4) =       0.000451463379
  error estimate for blocks of size 2^( 5) =       0.000461655294
  error estimate for blocks of size 2^( 6) =       0.000468726285
  error estimate for blocks of size 2^( 7) =       0.000474481922

      target function =                  N/A
              le_mean =     -16.906490956703
             les_mean =     286.172410349333
             stat err =       0.000464081720
             autocorr =       1.255907505805
              std dev =       0.585639865220
             le_variance =       0.342974051735

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343012064688
                                         uncertainty =       0.006497129833

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343012064688
                                         uncertainty =       0.006497129833

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414109920
  error estimate for blocks of size 2^( 2) =       0.000426734496
  error estimate for blocks of size 2^( 3) =       0.000439503884
  error estimate for blocks of size 2^( 4) =       0.000451463379
  error estimate for blocks of size 2^( 5) =       0.000461655294
  error estimate for blocks of size 2^( 6) =       0.000468726285
  error estimate for blocks of size 2^( 7) =       0.000474481922

      target function =                  N/A
              le_mean =     -16.906490956703
             les_mean =     286.172410349328
             stat err =       0.000464081720
             autocorr =       1.255907505812
              std dev =       0.585639865217
             le_variance =       0.342974051732


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906490956703        initial
     3.9062e+07     3.9062e+08             1.9449e-11       -16.906490956703  <--
     1.5625e+08     1.5625e+09             4.8631e-12       -16.906490956703
     6.2500e+08     6.2500e+09             1.2158e-12       -16.906490956703

*****************************************************************************
Applying the update for shift_i =   3.9062e+07     and shift_s =   3.9062e+08
*****************************************************************************

  Execution time = 2.9348e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.092933e-01 1 1  ON 0
 uu_1                 1.425581e-01 1 1  ON 1
 uu_2                 4.090837e-02 1 1  ON 2
 uu_3                -2.150581e-02 1 1  ON 3
 uu_4                -6.690997e-02 1 1  ON 4
 uu_5                -1.013426e-01 1 1  ON 5
 uu_6                -1.282010e-01 1 1  ON 6
 uu_7                -1.411935e-01 1 1  ON 7
 uu_8                -1.329673e-01 1 1  ON 8
 uu_9                -1.043536e-01 1 1  ON 9
 ud_0                 4.443527e-01 1 1  ON 10
 ud_1                 1.801295e-01 1 1  ON 11
 ud_2                 6.325054e-02 1 1  ON 12
 ud_3                -6.192833e-03 1 1  ON 13
 ud_4                -6.411883e-02 1 1  ON 14
 ud_5                -1.066798e-01 1 1  ON 15
 ud_6                -1.344888e-01 1 1  ON 16
 ud_7                -1.516146e-01 1 1  ON 17
 ud_8                -1.521892e-01 1 1  ON 18
 ud_9                -1.426112e-01 1 1  ON 19
 eO_0                -7.585650e-01 1 1  ON 20
 eO_1                -4.404406e-01 1 1  ON 21
 eO_2                -2.262437e-02 1 1  ON 22
 eO_3                 2.977541e-01 1 1  ON 23
 eO_4                 5.252170e-01 1 1  ON 24
 eO_5                 4.870201e-01 1 1  ON 25
 eO_6                 2.596886e-01 1 1  ON 26
 eO_7                -4.096972e-02 1 1  ON 27
 eO_8                -2.205874e-01 1 1  ON 28
 eO_9                -8.532273e-02 1 1  ON 29
eH1_0                -2.414798e-01 1 1  ON 30
eH1_1                -1.440753e-01 1 1  ON 31
eH1_2                -9.924639e-02 1 1  ON 32
eH1_3                -4.540298e-02 1 1  ON 33
eH1_4                 2.880356e-03 1 1  ON 34
eH1_5                 3.773231e-02 1 1  ON 35
eH1_6                 9.700215e-02 1 1  ON 36
eH1_7                 1.538045e-01 1 1  ON 37
eH1_8                 1.762282e-01 1 1  ON 38
eH1_9                 6.658133e-02 1 1  ON 39
eH2_0                -2.395720e-01 1 1  ON 40
eH2_1                -1.418636e-01 1 1  ON 41
eH2_2                -9.688539e-02 1 1  ON 42
eH2_3                -4.316091e-02 1 1  ON 43
eH2_4                 5.105057e-03 1 1  ON 44
eH2_5                 3.979582e-02 1 1  ON 45
eH2_6                 9.952831e-02 1 1  ON 46
eH2_7                 1.556286e-01 1 1  ON 47
eH2_8                 1.821134e-01 1 1  ON 48
eH2_9                 5.595293e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5479e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6884e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.9221
    reference variance = 0.236095
====================================================
  Execution time = 2.0811e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3680e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7517e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336869236783
                                         uncertainty =       0.003514501142

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336869236783
                                         uncertainty =       0.003514501142

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410367437
  error estimate for blocks of size 2^( 2) =       0.000423311145
  error estimate for blocks of size 2^( 3) =       0.000436565662
  error estimate for blocks of size 2^( 4) =       0.000448455348
  error estimate for blocks of size 2^( 5) =       0.000459254458
  error estimate for blocks of size 2^( 6) =       0.000467544945
  error estimate for blocks of size 2^( 7) =       0.000472174175

      target function =                  N/A
              le_mean =     -16.905333412875
             les_mean =     286.127100498278
             stat err =       0.000461857232
             autocorr =       1.266688166769
              std dev =       0.580347194531
             le_variance =       0.336802866199


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690533341288e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+06, overlap shift 9.7656e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905333412875       residual = 3.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905333412876       residual = 3.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905333412876       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905333415129       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905333409952       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905333413001       residual = 3.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905333416714       residual = 7.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905333397827       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905333397504       residual = 1.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+06 is 7.014664e-11

solving harmonic davidson linear method for identity shift 3.9062e+07, overlap shift 3.9062e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905333412875       residual = 3.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905333412876       residual = 3.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905333412876       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905333412876       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905333407040       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905333404408       residual = 3.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905333424671       residual = 7.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905333479352       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905333392240       residual = 1.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+07 is 1.753760e-11

solving harmonic davidson linear method for identity shift 1.5625e+08, overlap shift 1.5625e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905333412875       residual = 3.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905333412875       residual = 3.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905333412875       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905333431496       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905333505807       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905333441707       residual = 3.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905333376023       residual = 7.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905333407351       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905333413715       residual = 1.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+08 is 4.384275e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.049076 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6575e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.092933e-01 1 1  ON 0
 uu_1                 1.425581e-01 1 1  ON 1
 uu_2                 4.090837e-02 1 1  ON 2
 uu_3                -2.150581e-02 1 1  ON 3
 uu_4                -6.690997e-02 1 1  ON 4
 uu_5                -1.013426e-01 1 1  ON 5
 uu_6                -1.282010e-01 1 1  ON 6
 uu_7                -1.411935e-01 1 1  ON 7
 uu_8                -1.329673e-01 1 1  ON 8
 uu_9                -1.043536e-01 1 1  ON 9
 ud_0                 4.443527e-01 1 1  ON 10
 ud_1                 1.801295e-01 1 1  ON 11
 ud_2                 6.325054e-02 1 1  ON 12
 ud_3                -6.192833e-03 1 1  ON 13
 ud_4                -6.411883e-02 1 1  ON 14
 ud_5                -1.066798e-01 1 1  ON 15
 ud_6                -1.344888e-01 1 1  ON 16
 ud_7                -1.516146e-01 1 1  ON 17
 ud_8                -1.521892e-01 1 1  ON 18
 ud_9                -1.426112e-01 1 1  ON 19
 eO_0                -7.585650e-01 1 1  ON 20
 eO_1                -4.404406e-01 1 1  ON 21
 eO_2                -2.262437e-02 1 1  ON 22
 eO_3                 2.977541e-01 1 1  ON 23
 eO_4                 5.252170e-01 1 1  ON 24
 eO_5                 4.870201e-01 1 1  ON 25
 eO_6                 2.596886e-01 1 1  ON 26
 eO_7                -4.096972e-02 1 1  ON 27
 eO_8                -2.205874e-01 1 1  ON 28
 eO_9                -8.532273e-02 1 1  ON 29
eH1_0                -2.414798e-01 1 1  ON 30
eH1_1                -1.440753e-01 1 1  ON 31
eH1_2                -9.924639e-02 1 1  ON 32
eH1_3                -4.540298e-02 1 1  ON 33
eH1_4                 2.880356e-03 1 1  ON 34
eH1_5                 3.773231e-02 1 1  ON 35
eH1_6                 9.700215e-02 1 1  ON 36
eH1_7                 1.538045e-01 1 1  ON 37
eH1_8                 1.762282e-01 1 1  ON 38
eH1_9                 6.658133e-02 1 1  ON 39
eH2_0                -2.395720e-01 1 1  ON 40
eH2_1                -1.418636e-01 1 1  ON 41
eH2_2                -9.688539e-02 1 1  ON 42
eH2_3                -4.316091e-02 1 1  ON 43
eH2_4                 5.105057e-03 1 1  ON 44
eH2_5                 3.979582e-02 1 1  ON 45
eH2_6                 9.952831e-02 1 1  ON 46
eH2_7                 1.556286e-01 1 1  ON 47
eH2_8                 1.821134e-01 1 1  ON 48
eH2_9                 5.595293e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.9545
    reference variance = 0.302098
====================================================
  Execution time = 1.9869e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3511e-01
  Total weights = 2.0000e+06
  Execution time = 1.8725e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335067284350
                                         uncertainty =       0.003690719061

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335067284350
                                         uncertainty =       0.003690719061

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409333094
  error estimate for blocks of size 2^( 2) =       0.000421681076
  error estimate for blocks of size 2^( 3) =       0.000434613018
  error estimate for blocks of size 2^( 4) =       0.000445600788
  error estimate for blocks of size 2^( 5) =       0.000455857339
  error estimate for blocks of size 2^( 6) =       0.000463902266
  error estimate for blocks of size 2^( 7) =       0.000468557432

      target function =                  N/A
              le_mean =     -16.906087150097
             les_mean =     286.150889723419
             stat err =       0.000458479456
             autocorr =       1.254544421727
              std dev =       0.578884413597
             le_variance =       0.335107164305

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335067284398
                                         uncertainty =       0.003690719061

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335067284398
                                         uncertainty =       0.003690719061

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409333094
  error estimate for blocks of size 2^( 2) =       0.000421681076
  error estimate for blocks of size 2^( 3) =       0.000434613018
  error estimate for blocks of size 2^( 4) =       0.000445600788
  error estimate for blocks of size 2^( 5) =       0.000455857339
  error estimate for blocks of size 2^( 6) =       0.000463902266
  error estimate for blocks of size 2^( 7) =       0.000468557432

      target function =                  N/A
              le_mean =     -16.906087150096
             les_mean =     286.150889723447
             stat err =       0.000458479456
             autocorr =       1.254544421648
              std dev =       0.578884413638
             le_variance =       0.335107164353

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335067284374
                                         uncertainty =       0.003690719061

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335067284374
                                         uncertainty =       0.003690719061

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409333094
  error estimate for blocks of size 2^( 2) =       0.000421681076
  error estimate for blocks of size 2^( 3) =       0.000434613018
  error estimate for blocks of size 2^( 4) =       0.000445600788
  error estimate for blocks of size 2^( 5) =       0.000455857339
  error estimate for blocks of size 2^( 6) =       0.000463902266
  error estimate for blocks of size 2^( 7) =       0.000468557432

      target function =                  N/A
              le_mean =     -16.906087150096
             les_mean =     286.150889723433
             stat err =       0.000458479456
             autocorr =       1.254544421678
              std dev =       0.578884413618
             le_variance =       0.335107164329

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335067284353
                                         uncertainty =       0.003690719061

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335067284353
                                         uncertainty =       0.003690719061

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409333094
  error estimate for blocks of size 2^( 2) =       0.000421681076
  error estimate for blocks of size 2^( 3) =       0.000434613018
  error estimate for blocks of size 2^( 4) =       0.000445600788
  error estimate for blocks of size 2^( 5) =       0.000455857339
  error estimate for blocks of size 2^( 6) =       0.000463902266
  error estimate for blocks of size 2^( 7) =       0.000468557432

      target function =                  N/A
              le_mean =     -16.906087150097
             les_mean =     286.150889723420
             stat err =       0.000458479456
             autocorr =       1.254544421715
              std dev =       0.578884413600
             le_variance =       0.335107164309


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906087150097        initial  <--
     9.7656e+06     9.7656e+07             7.0147e-11       -16.906087150096
     3.9062e+07     3.9062e+08             1.7538e-11       -16.906087150096
     1.5625e+08     1.5625e+09             4.3843e-12       -16.906087150097

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.3259
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.092933e-01 1 1  ON 0
 uu_1                 1.425581e-01 1 1  ON 1
 uu_2                 4.090837e-02 1 1  ON 2
 uu_3                -2.150581e-02 1 1  ON 3
 uu_4                -6.690997e-02 1 1  ON 4
 uu_5                -1.013426e-01 1 1  ON 5
 uu_6                -1.282010e-01 1 1  ON 6
 uu_7                -1.411935e-01 1 1  ON 7
 uu_8                -1.329673e-01 1 1  ON 8
 uu_9                -1.043536e-01 1 1  ON 9
 ud_0                 4.443527e-01 1 1  ON 10
 ud_1                 1.801295e-01 1 1  ON 11
 ud_2                 6.325054e-02 1 1  ON 12
 ud_3                -6.192833e-03 1 1  ON 13
 ud_4                -6.411883e-02 1 1  ON 14
 ud_5                -1.066798e-01 1 1  ON 15
 ud_6                -1.344888e-01 1 1  ON 16
 ud_7                -1.516146e-01 1 1  ON 17
 ud_8                -1.521892e-01 1 1  ON 18
 ud_9                -1.426112e-01 1 1  ON 19
 eO_0                -7.585650e-01 1 1  ON 20
 eO_1                -4.404406e-01 1 1  ON 21
 eO_2                -2.262437e-02 1 1  ON 22
 eO_3                 2.977541e-01 1 1  ON 23
 eO_4                 5.252170e-01 1 1  ON 24
 eO_5                 4.870201e-01 1 1  ON 25
 eO_6                 2.596886e-01 1 1  ON 26
 eO_7                -4.096972e-02 1 1  ON 27
 eO_8                -2.205874e-01 1 1  ON 28
 eO_9                -8.532273e-02 1 1  ON 29
eH1_0                -2.414798e-01 1 1  ON 30
eH1_1                -1.440753e-01 1 1  ON 31
eH1_2                -9.924639e-02 1 1  ON 32
eH1_3                -4.540298e-02 1 1  ON 33
eH1_4                 2.880356e-03 1 1  ON 34
eH1_5                 3.773231e-02 1 1  ON 35
eH1_6                 9.700215e-02 1 1  ON 36
eH1_7                 1.538045e-01 1 1  ON 37
eH1_8                 1.762282e-01 1 1  ON 38
eH1_9                 6.658133e-02 1 1  ON 39
eH2_0                -2.395720e-01 1 1  ON 40
eH2_1                -1.418636e-01 1 1  ON 41
eH2_2                -9.688539e-02 1 1  ON 42
eH2_3                -4.316091e-02 1 1  ON 43
eH2_4                 5.105057e-03 1 1  ON 44
eH2_5                 3.979582e-02 1 1  ON 45
eH2_6                 9.952831e-02 1 1  ON 46
eH2_7                 1.556286e-01 1 1  ON 47
eH2_8                 1.821134e-01 1 1  ON 48
eH2_9                 5.595293e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5907e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6888e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.9376
    reference variance = 0.207493
====================================================
  Execution time = 2.0707e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3782e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6896e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337800577431
                                         uncertainty =       0.004804222079

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337800577431
                                         uncertainty =       0.004804222079

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410983958
  error estimate for blocks of size 2^( 2) =       0.000423890580
  error estimate for blocks of size 2^( 3) =       0.000437691301
  error estimate for blocks of size 2^( 4) =       0.000449888669
  error estimate for blocks of size 2^( 5) =       0.000462176133
  error estimate for blocks of size 2^( 6) =       0.000471151760
  error estimate for blocks of size 2^( 7) =       0.000476559228

      target function =                  N/A
              le_mean =     -16.905470030913
             les_mean =     286.132732425129
             stat err =       0.000464943947
             autocorr =       1.279827552745
              std dev =       0.581219087724
             le_variance =       0.337815627935


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690547003091e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+07, overlap shift 9.7656e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905470030913       residual = 2.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905470030913       residual = 3.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905470030913       residual = 7.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905470061509       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905470030913       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905470030913       residual = 2.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905470032083       residual = 6.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905470073033       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905469892435       residual = 1.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+07 is 6.826419e-12

solving harmonic davidson linear method for identity shift 3.9062e+08, overlap shift 3.9062e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905470030913       residual = 2.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905470030913       residual = 3.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905470030913       residual = 7.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905470030913       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905470030913       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905469837304       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905470072638       residual = 6.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905469943607       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905469971390       residual = 1.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+08 is 1.706381e-12

solving harmonic davidson linear method for identity shift 1.5625e+09, overlap shift 1.5625e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905470030913       residual = 2.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905470030913       residual = 3.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905470030913       residual = 7.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905471062413       residual = 3.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905469658277       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905470011940       residual = 2.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905469951512       residual = 6.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905469186667       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905470334703       residual = 1.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+09 is 4.265248e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.052072 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6408e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.092933e-01 1 1  ON 0
 uu_1                 1.425581e-01 1 1  ON 1
 uu_2                 4.090837e-02 1 1  ON 2
 uu_3                -2.150581e-02 1 1  ON 3
 uu_4                -6.690997e-02 1 1  ON 4
 uu_5                -1.013426e-01 1 1  ON 5
 uu_6                -1.282010e-01 1 1  ON 6
 uu_7                -1.411935e-01 1 1  ON 7
 uu_8                -1.329673e-01 1 1  ON 8
 uu_9                -1.043536e-01 1 1  ON 9
 ud_0                 4.443527e-01 1 1  ON 10
 ud_1                 1.801295e-01 1 1  ON 11
 ud_2                 6.325054e-02 1 1  ON 12
 ud_3                -6.192833e-03 1 1  ON 13
 ud_4                -6.411883e-02 1 1  ON 14
 ud_5                -1.066798e-01 1 1  ON 15
 ud_6                -1.344888e-01 1 1  ON 16
 ud_7                -1.516146e-01 1 1  ON 17
 ud_8                -1.521892e-01 1 1  ON 18
 ud_9                -1.426112e-01 1 1  ON 19
 eO_0                -7.585650e-01 1 1  ON 20
 eO_1                -4.404406e-01 1 1  ON 21
 eO_2                -2.262437e-02 1 1  ON 22
 eO_3                 2.977541e-01 1 1  ON 23
 eO_4                 5.252170e-01 1 1  ON 24
 eO_5                 4.870201e-01 1 1  ON 25
 eO_6                 2.596886e-01 1 1  ON 26
 eO_7                -4.096972e-02 1 1  ON 27
 eO_8                -2.205874e-01 1 1  ON 28
 eO_9                -8.532273e-02 1 1  ON 29
eH1_0                -2.414798e-01 1 1  ON 30
eH1_1                -1.440753e-01 1 1  ON 31
eH1_2                -9.924639e-02 1 1  ON 32
eH1_3                -4.540298e-02 1 1  ON 33
eH1_4                 2.880356e-03 1 1  ON 34
eH1_5                 3.773231e-02 1 1  ON 35
eH1_6                 9.700215e-02 1 1  ON 36
eH1_7                 1.538045e-01 1 1  ON 37
eH1_8                 1.762282e-01 1 1  ON 38
eH1_9                 6.658133e-02 1 1  ON 39
eH2_0                -2.395720e-01 1 1  ON 40
eH2_1                -1.418636e-01 1 1  ON 41
eH2_2                -9.688539e-02 1 1  ON 42
eH2_3                -4.316091e-02 1 1  ON 43
eH2_4                 5.105057e-03 1 1  ON 44
eH2_5                 3.979582e-02 1 1  ON 45
eH2_6                 9.952831e-02 1 1  ON 46
eH2_7                 1.556286e-01 1 1  ON 47
eH2_8                 1.821134e-01 1 1  ON 48
eH2_9                 5.595293e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.8794
    reference variance = 0.267939
====================================================
  Execution time = 2.2005e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.2949e-01
  Total weights = 2.0000e+06
  Execution time = 1.8837e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329508849784
                                         uncertainty =       0.003169187068

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329508849784
                                         uncertainty =       0.003169187068

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405885688
  error estimate for blocks of size 2^( 2) =       0.000418796505
  error estimate for blocks of size 2^( 3) =       0.000431709086
  error estimate for blocks of size 2^( 4) =       0.000443659213
  error estimate for blocks of size 2^( 5) =       0.000453470124
  error estimate for blocks of size 2^( 6) =       0.000461446088
  error estimate for blocks of size 2^( 7) =       0.000466811414

      target function =                  N/A
              le_mean =     -16.906208860811
             les_mean =     286.149384264496
             stat err =       0.000456346710
             autocorr =       1.264102735248
              std dev =       0.574009045107
             le_variance =       0.329486383865

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329508849787
                                         uncertainty =       0.003169187068

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329508849787
                                         uncertainty =       0.003169187068

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405885688
  error estimate for blocks of size 2^( 2) =       0.000418796505
  error estimate for blocks of size 2^( 3) =       0.000431709086
  error estimate for blocks of size 2^( 4) =       0.000443659213
  error estimate for blocks of size 2^( 5) =       0.000453470124
  error estimate for blocks of size 2^( 6) =       0.000461446088
  error estimate for blocks of size 2^( 7) =       0.000466811414

      target function =                  N/A
              le_mean =     -16.906208860811
             les_mean =     286.149384264500
             stat err =       0.000456346710
             autocorr =       1.264102735253
              std dev =       0.574009045110
             le_variance =       0.329486383868

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329508849786
                                         uncertainty =       0.003169187068

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329508849786
                                         uncertainty =       0.003169187068

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405885688
  error estimate for blocks of size 2^( 2) =       0.000418796505
  error estimate for blocks of size 2^( 3) =       0.000431709086
  error estimate for blocks of size 2^( 4) =       0.000443659213
  error estimate for blocks of size 2^( 5) =       0.000453470124
  error estimate for blocks of size 2^( 6) =       0.000461446088
  error estimate for blocks of size 2^( 7) =       0.000466811414

      target function =                  N/A
              le_mean =     -16.906208860811
             les_mean =     286.149384264498
             stat err =       0.000456346710
             autocorr =       1.264102735244
              std dev =       0.574009045109
             le_variance =       0.329486383866

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329508849784
                                         uncertainty =       0.003169187068

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329508849784
                                         uncertainty =       0.003169187068

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405885688
  error estimate for blocks of size 2^( 2) =       0.000418796505
  error estimate for blocks of size 2^( 3) =       0.000431709086
  error estimate for blocks of size 2^( 4) =       0.000443659213
  error estimate for blocks of size 2^( 5) =       0.000453470124
  error estimate for blocks of size 2^( 6) =       0.000461446088
  error estimate for blocks of size 2^( 7) =       0.000466811414

      target function =                  N/A
              le_mean =     -16.906208860811
             les_mean =     286.149384264496
             stat err =       0.000456346710
             autocorr =       1.264102735244
              std dev =       0.574009045107
             le_variance =       0.329486383865


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906208860811        initial
     9.7656e+07     9.7656e+08             6.8264e-12       -16.906208860811  <--
     3.9062e+08     3.9062e+09             1.7064e-12       -16.906208860811
     1.5625e+09     1.5625e+10             4.2652e-13       -16.906208860811

*****************************************************************************
Applying the update for shift_i =   9.7656e+07     and shift_s =   9.7656e+08
*****************************************************************************

  Execution time = 3.1518e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.092933e-01 1 1  ON 0
 uu_1                 1.425581e-01 1 1  ON 1
 uu_2                 4.090837e-02 1 1  ON 2
 uu_3                -2.150581e-02 1 1  ON 3
 uu_4                -6.690997e-02 1 1  ON 4
 uu_5                -1.013426e-01 1 1  ON 5
 uu_6                -1.282010e-01 1 1  ON 6
 uu_7                -1.411935e-01 1 1  ON 7
 uu_8                -1.329673e-01 1 1  ON 8
 uu_9                -1.043536e-01 1 1  ON 9
 ud_0                 4.443527e-01 1 1  ON 10
 ud_1                 1.801295e-01 1 1  ON 11
 ud_2                 6.325054e-02 1 1  ON 12
 ud_3                -6.192833e-03 1 1  ON 13
 ud_4                -6.411883e-02 1 1  ON 14
 ud_5                -1.066798e-01 1 1  ON 15
 ud_6                -1.344888e-01 1 1  ON 16
 ud_7                -1.516146e-01 1 1  ON 17
 ud_8                -1.521892e-01 1 1  ON 18
 ud_9                -1.426112e-01 1 1  ON 19
 eO_0                -7.585650e-01 1 1  ON 20
 eO_1                -4.404406e-01 1 1  ON 21
 eO_2                -2.262437e-02 1 1  ON 22
 eO_3                 2.977541e-01 1 1  ON 23
 eO_4                 5.252170e-01 1 1  ON 24
 eO_5                 4.870201e-01 1 1  ON 25
 eO_6                 2.596886e-01 1 1  ON 26
 eO_7                -4.096972e-02 1 1  ON 27
 eO_8                -2.205874e-01 1 1  ON 28
 eO_9                -8.532273e-02 1 1  ON 29
eH1_0                -2.414798e-01 1 1  ON 30
eH1_1                -1.440753e-01 1 1  ON 31
eH1_2                -9.924639e-02 1 1  ON 32
eH1_3                -4.540298e-02 1 1  ON 33
eH1_4                 2.880356e-03 1 1  ON 34
eH1_5                 3.773231e-02 1 1  ON 35
eH1_6                 9.700215e-02 1 1  ON 36
eH1_7                 1.538045e-01 1 1  ON 37
eH1_8                 1.762282e-01 1 1  ON 38
eH1_9                 6.658133e-02 1 1  ON 39
eH2_0                -2.395720e-01 1 1  ON 40
eH2_1                -1.418636e-01 1 1  ON 41
eH2_2                -9.688539e-02 1 1  ON 42
eH2_3                -4.316091e-02 1 1  ON 43
eH2_4                 5.105057e-03 1 1  ON 44
eH2_5                 3.979582e-02 1 1  ON 45
eH2_6                 9.952831e-02 1 1  ON 46
eH2_7                 1.556286e-01 1 1  ON 47
eH2_8                 1.821134e-01 1 1  ON 48
eH2_9                 5.595293e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7932e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6889e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.8418
    reference variance = 0.265189
====================================================
  Execution time = 2.0611e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.8589e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5548e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.385958315038
                                         uncertainty =       0.053522067530

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.385958315038
                                         uncertainty =       0.053522067530

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000439256277
  error estimate for blocks of size 2^( 2) =       0.000451365853
  error estimate for blocks of size 2^( 3) =       0.000464087883
  error estimate for blocks of size 2^( 4) =       0.000476390732
  error estimate for blocks of size 2^( 5) =       0.000486824044
  error estimate for blocks of size 2^( 6) =       0.000494121429
  error estimate for blocks of size 2^( 7) =       0.000499909324

      target function =                  N/A
              le_mean =     -16.904860029443
             les_mean =     286.160184576459
             stat err =       0.000489311382
             autocorr =       1.240893997038
              std dev =       0.621202184759
             le_variance =       0.385892154349


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690486002944e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+07, overlap shift 2.4414e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904860029443       residual = 2.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904860029443       residual = 3.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904860029443       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904860029443       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904860003712       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904860037289       residual = 2.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904860035882       residual = 6.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904860027540       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.904860029443       residual = 1.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+07 is 2.457695e-11

solving harmonic davidson linear method for identity shift 9.7656e+07, overlap shift 9.7656e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904860029443       residual = 2.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904860029443       residual = 3.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904860029443       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904860029443       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904859983785       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904860071293       residual = 2.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904860043594       residual = 6.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904860056973       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.904859993967       residual = 1.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+07 is 6.144532e-12

solving harmonic davidson linear method for identity shift 3.9062e+08, overlap shift 3.9062e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904860029443       residual = 2.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904860029443       residual = 3.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904860029443       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904860029443       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904860028488       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904859822114       residual = 2.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904860138186       residual = 6.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904860285263       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.904860473397       residual = 1.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+08 is 1.536504e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.055099 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6177e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.092933e-01 1 1  ON 0
 uu_1                 1.425581e-01 1 1  ON 1
 uu_2                 4.090837e-02 1 1  ON 2
 uu_3                -2.150581e-02 1 1  ON 3
 uu_4                -6.690997e-02 1 1  ON 4
 uu_5                -1.013426e-01 1 1  ON 5
 uu_6                -1.282010e-01 1 1  ON 6
 uu_7                -1.411935e-01 1 1  ON 7
 uu_8                -1.329673e-01 1 1  ON 8
 uu_9                -1.043536e-01 1 1  ON 9
 ud_0                 4.443527e-01 1 1  ON 10
 ud_1                 1.801295e-01 1 1  ON 11
 ud_2                 6.325054e-02 1 1  ON 12
 ud_3                -6.192833e-03 1 1  ON 13
 ud_4                -6.411883e-02 1 1  ON 14
 ud_5                -1.066798e-01 1 1  ON 15
 ud_6                -1.344888e-01 1 1  ON 16
 ud_7                -1.516146e-01 1 1  ON 17
 ud_8                -1.521892e-01 1 1  ON 18
 ud_9                -1.426112e-01 1 1  ON 19
 eO_0                -7.585650e-01 1 1  ON 20
 eO_1                -4.404406e-01 1 1  ON 21
 eO_2                -2.262437e-02 1 1  ON 22
 eO_3                 2.977541e-01 1 1  ON 23
 eO_4                 5.252170e-01 1 1  ON 24
 eO_5                 4.870201e-01 1 1  ON 25
 eO_6                 2.596886e-01 1 1  ON 26
 eO_7                -4.096972e-02 1 1  ON 27
 eO_8                -2.205874e-01 1 1  ON 28
 eO_9                -8.532273e-02 1 1  ON 29
eH1_0                -2.414798e-01 1 1  ON 30
eH1_1                -1.440753e-01 1 1  ON 31
eH1_2                -9.924639e-02 1 1  ON 32
eH1_3                -4.540298e-02 1 1  ON 33
eH1_4                 2.880356e-03 1 1  ON 34
eH1_5                 3.773231e-02 1 1  ON 35
eH1_6                 9.700215e-02 1 1  ON 36
eH1_7                 1.538045e-01 1 1  ON 37
eH1_8                 1.762282e-01 1 1  ON 38
eH1_9                 6.658133e-02 1 1  ON 39
eH2_0                -2.395720e-01 1 1  ON 40
eH2_1                -1.418636e-01 1 1  ON 41
eH2_2                -9.688539e-02 1 1  ON 42
eH2_3                -4.316091e-02 1 1  ON 43
eH2_4                 5.105057e-03 1 1  ON 44
eH2_5                 3.979582e-02 1 1  ON 45
eH2_6                 9.952831e-02 1 1  ON 46
eH2_7                 1.556286e-01 1 1  ON 47
eH2_8                 1.821134e-01 1 1  ON 48
eH2_9                 5.595293e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.8279
    reference variance = 0.284132
====================================================
  Execution time = 1.9950e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3923e-01
  Total weights = 2.0000e+06
  Execution time = 1.8798e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339144229089
                                         uncertainty =       0.010163223191

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339144229089
                                         uncertainty =       0.010163223191

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411845488
  error estimate for blocks of size 2^( 2) =       0.000424446777
  error estimate for blocks of size 2^( 3) =       0.000437377542
  error estimate for blocks of size 2^( 4) =       0.000450425841
  error estimate for blocks of size 2^( 5) =       0.000461452138
  error estimate for blocks of size 2^( 6) =       0.000469551581
  error estimate for blocks of size 2^( 7) =       0.000475739334

      target function =                  N/A
              le_mean =     -16.905615680022
             les_mean =     286.139074762502
             stat err =       0.000464292224
             autocorr =       1.270908239809
              std dev =       0.582437474341
             le_variance =       0.339233411517

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339144229105
                                         uncertainty =       0.010163223192

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339144229105
                                         uncertainty =       0.010163223192

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411845488
  error estimate for blocks of size 2^( 2) =       0.000424446777
  error estimate for blocks of size 2^( 3) =       0.000437377542
  error estimate for blocks of size 2^( 4) =       0.000450425841
  error estimate for blocks of size 2^( 5) =       0.000461452138
  error estimate for blocks of size 2^( 6) =       0.000469551581
  error estimate for blocks of size 2^( 7) =       0.000475739334

      target function =                  N/A
              le_mean =     -16.905615680022
             les_mean =     286.139074762526
             stat err =       0.000464292224
             autocorr =       1.270908239789
              std dev =       0.582437474354
             le_variance =       0.339233411532

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339144229097
                                         uncertainty =       0.010163223191

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339144229097
                                         uncertainty =       0.010163223191

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411845488
  error estimate for blocks of size 2^( 2) =       0.000424446777
  error estimate for blocks of size 2^( 3) =       0.000437377542
  error estimate for blocks of size 2^( 4) =       0.000450425841
  error estimate for blocks of size 2^( 5) =       0.000461452138
  error estimate for blocks of size 2^( 6) =       0.000469551581
  error estimate for blocks of size 2^( 7) =       0.000475739334

      target function =                  N/A
              le_mean =     -16.905615680022
             les_mean =     286.139074762514
             stat err =       0.000464292224
             autocorr =       1.270908239801
              std dev =       0.582437474348
             le_variance =       0.339233411524

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339144229090
                                         uncertainty =       0.010163223191

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339144229090
                                         uncertainty =       0.010163223191

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411845488
  error estimate for blocks of size 2^( 2) =       0.000424446777
  error estimate for blocks of size 2^( 3) =       0.000437377542
  error estimate for blocks of size 2^( 4) =       0.000450425841
  error estimate for blocks of size 2^( 5) =       0.000461452138
  error estimate for blocks of size 2^( 6) =       0.000469551581
  error estimate for blocks of size 2^( 7) =       0.000475739334

      target function =                  N/A
              le_mean =     -16.905615680022
             les_mean =     286.139074762504
             stat err =       0.000464292224
             autocorr =       1.270908239805
              std dev =       0.582437474342
             le_variance =       0.339233411518


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905615680022        initial
     2.4414e+07     2.4414e+08             2.4577e-11       -16.905615680022  <--
     9.7656e+07     9.7656e+08             6.1445e-12       -16.905615680022
     3.9062e+08     3.9062e+09             1.5365e-12       -16.905615680022

*****************************************************************************
Applying the update for shift_i =   2.4414e+07     and shift_s =   2.4414e+08
*****************************************************************************

  Execution time = 2.9449e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.092933e-01 1 1  ON 0
 uu_1                 1.425581e-01 1 1  ON 1
 uu_2                 4.090837e-02 1 1  ON 2
 uu_3                -2.150581e-02 1 1  ON 3
 uu_4                -6.690997e-02 1 1  ON 4
 uu_5                -1.013426e-01 1 1  ON 5
 uu_6                -1.282010e-01 1 1  ON 6
 uu_7                -1.411935e-01 1 1  ON 7
 uu_8                -1.329673e-01 1 1  ON 8
 uu_9                -1.043536e-01 1 1  ON 9
 ud_0                 4.443527e-01 1 1  ON 10
 ud_1                 1.801295e-01 1 1  ON 11
 ud_2                 6.325054e-02 1 1  ON 12
 ud_3                -6.192833e-03 1 1  ON 13
 ud_4                -6.411883e-02 1 1  ON 14
 ud_5                -1.066798e-01 1 1  ON 15
 ud_6                -1.344888e-01 1 1  ON 16
 ud_7                -1.516146e-01 1 1  ON 17
 ud_8                -1.521892e-01 1 1  ON 18
 ud_9                -1.426112e-01 1 1  ON 19
 eO_0                -7.585650e-01 1 1  ON 20
 eO_1                -4.404406e-01 1 1  ON 21
 eO_2                -2.262437e-02 1 1  ON 22
 eO_3                 2.977541e-01 1 1  ON 23
 eO_4                 5.252170e-01 1 1  ON 24
 eO_5                 4.870201e-01 1 1  ON 25
 eO_6                 2.596886e-01 1 1  ON 26
 eO_7                -4.096972e-02 1 1  ON 27
 eO_8                -2.205874e-01 1 1  ON 28
 eO_9                -8.532273e-02 1 1  ON 29
eH1_0                -2.414798e-01 1 1  ON 30
eH1_1                -1.440753e-01 1 1  ON 31
eH1_2                -9.924639e-02 1 1  ON 32
eH1_3                -4.540298e-02 1 1  ON 33
eH1_4                 2.880356e-03 1 1  ON 34
eH1_5                 3.773231e-02 1 1  ON 35
eH1_6                 9.700215e-02 1 1  ON 36
eH1_7                 1.538045e-01 1 1  ON 37
eH1_8                 1.762282e-01 1 1  ON 38
eH1_9                 6.658133e-02 1 1  ON 39
eH2_0                -2.395720e-01 1 1  ON 40
eH2_1                -1.418636e-01 1 1  ON 41
eH2_2                -9.688539e-02 1 1  ON 42
eH2_3                -4.316091e-02 1 1  ON 43
eH2_4                 5.105057e-03 1 1  ON 44
eH2_5                 3.979582e-02 1 1  ON 45
eH2_6                 9.952831e-02 1 1  ON 46
eH2_7                 1.556286e-01 1 1  ON 47
eH2_8                 1.821134e-01 1 1  ON 48
eH2_9                 5.595293e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5633e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6886e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.9635
    reference variance = 0.257156
====================================================
  Execution time = 2.0227e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4603e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6847e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345950735567
                                         uncertainty =       0.004756336739

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345950735567
                                         uncertainty =       0.004756336739

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415951999
  error estimate for blocks of size 2^( 2) =       0.000428540871
  error estimate for blocks of size 2^( 3) =       0.000441285516
  error estimate for blocks of size 2^( 4) =       0.000453696166
  error estimate for blocks of size 2^( 5) =       0.000464933056
  error estimate for blocks of size 2^( 6) =       0.000472139938
  error estimate for blocks of size 2^( 7) =       0.000478448095

      target function =                  N/A
              le_mean =     -16.906085037804
             les_mean =     286.161743262958
             stat err =       0.000467304314
             autocorr =       1.262156328973
              std dev =       0.588244957911
             le_variance =       0.346032130508


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690608503780e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+06, overlap shift 6.1035e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906085037804       residual = 2.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906085037806       residual = 3.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906085037806       residual = 6.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906085037806       residual = 4.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906085036221       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906085037807       residual = 3.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906085037489       residual = 6.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906085035338       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906085037855       residual = 1.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+06 is 1.185524e-10

solving harmonic davidson linear method for identity shift 2.4414e+07, overlap shift 2.4414e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906085037804       residual = 2.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906085037805       residual = 3.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906085037805       residual = 6.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906085037682       residual = 4.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906085031199       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906085038900       residual = 3.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906085038089       residual = 6.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906085024559       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906085011105       residual = 1.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+07 is 2.963779e-11

solving harmonic davidson linear method for identity shift 9.7656e+07, overlap shift 9.7656e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906085037804       residual = 2.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906085037804       residual = 3.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906085037804       residual = 6.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906085045717       residual = 4.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906085088956       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906085017227       residual = 3.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906085043398       residual = 6.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906085036103       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906085044777       residual = 1.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+07 is 7.409509e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.058040 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5923e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.092933e-01 1 1  ON 0
 uu_1                 1.425581e-01 1 1  ON 1
 uu_2                 4.090837e-02 1 1  ON 2
 uu_3                -2.150581e-02 1 1  ON 3
 uu_4                -6.690997e-02 1 1  ON 4
 uu_5                -1.013426e-01 1 1  ON 5
 uu_6                -1.282010e-01 1 1  ON 6
 uu_7                -1.411935e-01 1 1  ON 7
 uu_8                -1.329673e-01 1 1  ON 8
 uu_9                -1.043536e-01 1 1  ON 9
 ud_0                 4.443527e-01 1 1  ON 10
 ud_1                 1.801295e-01 1 1  ON 11
 ud_2                 6.325054e-02 1 1  ON 12
 ud_3                -6.192833e-03 1 1  ON 13
 ud_4                -6.411883e-02 1 1  ON 14
 ud_5                -1.066798e-01 1 1  ON 15
 ud_6                -1.344888e-01 1 1  ON 16
 ud_7                -1.516146e-01 1 1  ON 17
 ud_8                -1.521892e-01 1 1  ON 18
 ud_9                -1.426112e-01 1 1  ON 19
 eO_0                -7.585650e-01 1 1  ON 20
 eO_1                -4.404406e-01 1 1  ON 21
 eO_2                -2.262437e-02 1 1  ON 22
 eO_3                 2.977541e-01 1 1  ON 23
 eO_4                 5.252170e-01 1 1  ON 24
 eO_5                 4.870201e-01 1 1  ON 25
 eO_6                 2.596886e-01 1 1  ON 26
 eO_7                -4.096972e-02 1 1  ON 27
 eO_8                -2.205874e-01 1 1  ON 28
 eO_9                -8.532273e-02 1 1  ON 29
eH1_0                -2.414798e-01 1 1  ON 30
eH1_1                -1.440753e-01 1 1  ON 31
eH1_2                -9.924639e-02 1 1  ON 32
eH1_3                -4.540298e-02 1 1  ON 33
eH1_4                 2.880356e-03 1 1  ON 34
eH1_5                 3.773231e-02 1 1  ON 35
eH1_6                 9.700215e-02 1 1  ON 36
eH1_7                 1.538045e-01 1 1  ON 37
eH1_8                 1.762282e-01 1 1  ON 38
eH1_9                 6.658133e-02 1 1  ON 39
eH2_0                -2.395720e-01 1 1  ON 40
eH2_1                -1.418636e-01 1 1  ON 41
eH2_2                -9.688539e-02 1 1  ON 42
eH2_3                -4.316091e-02 1 1  ON 43
eH2_4                 5.105057e-03 1 1  ON 44
eH2_5                 3.979582e-02 1 1  ON 45
eH2_6                 9.952831e-02 1 1  ON 46
eH2_7                 1.556286e-01 1 1  ON 47
eH2_8                 1.821134e-01 1 1  ON 48
eH2_9                 5.595293e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.944
    reference variance = 0.21271
====================================================
  Execution time = 2.2087e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3389e-01
  Total weights = 2.0000e+06
  Execution time = 1.8873e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333931620514
                                         uncertainty =       0.003113002770

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333931620514
                                         uncertainty =       0.003113002770

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408588332
  error estimate for blocks of size 2^( 2) =       0.000421297154
  error estimate for blocks of size 2^( 3) =       0.000434580069
  error estimate for blocks of size 2^( 4) =       0.000445959353
  error estimate for blocks of size 2^( 5) =       0.000457175536
  error estimate for blocks of size 2^( 6) =       0.000464752937
  error estimate for blocks of size 2^( 7) =       0.000470179863

      target function =                  N/A
              le_mean =     -16.906524593024
             les_mean =     286.164462498081
             stat err =       0.000459516922
             autocorr =       1.264826911704
              std dev =       0.577831160880
             le_variance =       0.333888850484

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333931620569
                                         uncertainty =       0.003113002771

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333931620569
                                         uncertainty =       0.003113002771

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408588332
  error estimate for blocks of size 2^( 2) =       0.000421297154
  error estimate for blocks of size 2^( 3) =       0.000434580069
  error estimate for blocks of size 2^( 4) =       0.000445959353
  error estimate for blocks of size 2^( 5) =       0.000457175536
  error estimate for blocks of size 2^( 6) =       0.000464752937
  error estimate for blocks of size 2^( 7) =       0.000470179863

      target function =                  N/A
              le_mean =     -16.906524593024
             les_mean =     286.164462498113
             stat err =       0.000459516922
             autocorr =       1.264826911606
              std dev =       0.577831160928
             le_variance =       0.333888850539

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333931620541
                                         uncertainty =       0.003113002771

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333931620541
                                         uncertainty =       0.003113002771

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408588332
  error estimate for blocks of size 2^( 2) =       0.000421297154
  error estimate for blocks of size 2^( 3) =       0.000434580069
  error estimate for blocks of size 2^( 4) =       0.000445959353
  error estimate for blocks of size 2^( 5) =       0.000457175536
  error estimate for blocks of size 2^( 6) =       0.000464752937
  error estimate for blocks of size 2^( 7) =       0.000470179863

      target function =                  N/A
              le_mean =     -16.906524593024
             les_mean =     286.164462498097
             stat err =       0.000459516922
             autocorr =       1.264826911648
              std dev =       0.577831160904
             le_variance =       0.333888850511

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333931620517
                                         uncertainty =       0.003113002770

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333931620517
                                         uncertainty =       0.003113002770

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408588332
  error estimate for blocks of size 2^( 2) =       0.000421297154
  error estimate for blocks of size 2^( 3) =       0.000434580069
  error estimate for blocks of size 2^( 4) =       0.000445959353
  error estimate for blocks of size 2^( 5) =       0.000457175536
  error estimate for blocks of size 2^( 6) =       0.000464752937
  error estimate for blocks of size 2^( 7) =       0.000470179863

      target function =                  N/A
              le_mean =     -16.906524593024
             les_mean =     286.164462498083
             stat err =       0.000459516922
             autocorr =       1.264826911697
              std dev =       0.577831160883
             le_variance =       0.333888850487


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906524593024        initial  <--
     6.1035e+06     6.1035e+07             1.1855e-10       -16.906524593024
     2.4414e+07     2.4414e+08             2.9638e-11       -16.906524593024
     9.7656e+07     9.7656e+08             7.4095e-12       -16.906524593024

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.6156
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.092933e-01 1 1  ON 0
 uu_1                 1.425581e-01 1 1  ON 1
 uu_2                 4.090837e-02 1 1  ON 2
 uu_3                -2.150581e-02 1 1  ON 3
 uu_4                -6.690997e-02 1 1  ON 4
 uu_5                -1.013426e-01 1 1  ON 5
 uu_6                -1.282010e-01 1 1  ON 6
 uu_7                -1.411935e-01 1 1  ON 7
 uu_8                -1.329673e-01 1 1  ON 8
 uu_9                -1.043536e-01 1 1  ON 9
 ud_0                 4.443527e-01 1 1  ON 10
 ud_1                 1.801295e-01 1 1  ON 11
 ud_2                 6.325054e-02 1 1  ON 12
 ud_3                -6.192833e-03 1 1  ON 13
 ud_4                -6.411883e-02 1 1  ON 14
 ud_5                -1.066798e-01 1 1  ON 15
 ud_6                -1.344888e-01 1 1  ON 16
 ud_7                -1.516146e-01 1 1  ON 17
 ud_8                -1.521892e-01 1 1  ON 18
 ud_9                -1.426112e-01 1 1  ON 19
 eO_0                -7.585650e-01 1 1  ON 20
 eO_1                -4.404406e-01 1 1  ON 21
 eO_2                -2.262437e-02 1 1  ON 22
 eO_3                 2.977541e-01 1 1  ON 23
 eO_4                 5.252170e-01 1 1  ON 24
 eO_5                 4.870201e-01 1 1  ON 25
 eO_6                 2.596886e-01 1 1  ON 26
 eO_7                -4.096972e-02 1 1  ON 27
 eO_8                -2.205874e-01 1 1  ON 28
 eO_9                -8.532273e-02 1 1  ON 29
eH1_0                -2.414798e-01 1 1  ON 30
eH1_1                -1.440753e-01 1 1  ON 31
eH1_2                -9.924639e-02 1 1  ON 32
eH1_3                -4.540298e-02 1 1  ON 33
eH1_4                 2.880356e-03 1 1  ON 34
eH1_5                 3.773231e-02 1 1  ON 35
eH1_6                 9.700215e-02 1 1  ON 36
eH1_7                 1.538045e-01 1 1  ON 37
eH1_8                 1.762282e-01 1 1  ON 38
eH1_9                 6.658133e-02 1 1  ON 39
eH2_0                -2.395720e-01 1 1  ON 40
eH2_1                -1.418636e-01 1 1  ON 41
eH2_2                -9.688539e-02 1 1  ON 42
eH2_3                -4.316091e-02 1 1  ON 43
eH2_4                 5.105057e-03 1 1  ON 44
eH2_5                 3.979582e-02 1 1  ON 45
eH2_6                 9.952831e-02 1 1  ON 46
eH2_7                 1.556286e-01 1 1  ON 47
eH2_8                 1.821134e-01 1 1  ON 48
eH2_9                 5.595293e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7545e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6890e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.0264
    reference variance = 0.234845
====================================================
  Execution time = 2.0653e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4574e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5804e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345837696772
                                         uncertainty =       0.010010342325

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345837696772
                                         uncertainty =       0.010010342325

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415776808
  error estimate for blocks of size 2^( 2) =       0.000428435035
  error estimate for blocks of size 2^( 3) =       0.000441085952
  error estimate for blocks of size 2^( 4) =       0.000453331084
  error estimate for blocks of size 2^( 5) =       0.000462827053
  error estimate for blocks of size 2^( 6) =       0.000470823348
  error estimate for blocks of size 2^( 7) =       0.000474351022

      target function =                  N/A
              le_mean =     -16.904962571467
             les_mean =     286.123500078479
             stat err =       0.000465333126
             autocorr =       1.252585612134
              std dev =       0.587997201233
             le_variance =       0.345740708658


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690496257147e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+07, overlap shift 6.1035e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904962571467       residual = 2.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904962571467       residual = 3.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904962571467       residual = 9.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904962571467       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904962576756       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904962606319       residual = 2.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904962545990       residual = 7.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904962606867       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.904962563693       residual = 1.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+07 is 1.178415e-11

solving harmonic davidson linear method for identity shift 2.4414e+08, overlap shift 2.4414e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904962571467       residual = 2.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904962571467       residual = 3.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904962571467       residual = 9.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904962530828       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904962703226       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904962502673       residual = 2.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904962565755       residual = 7.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904962606969       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.904962577531       residual = 1.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+08 is 2.945968e-12

solving harmonic davidson linear method for identity shift 9.7656e+08, overlap shift 9.7656e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904962571467       residual = 2.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904962571467       residual = 3.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904962571467       residual = 9.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904962824984       residual = 3.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904963147625       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904962583306       residual = 2.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904962476454       residual = 7.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904960968372       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.904962567011       residual = 1.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+08 is 7.354026e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.061044 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6246e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.092933e-01 1 1  ON 0
 uu_1                 1.425581e-01 1 1  ON 1
 uu_2                 4.090837e-02 1 1  ON 2
 uu_3                -2.150581e-02 1 1  ON 3
 uu_4                -6.690997e-02 1 1  ON 4
 uu_5                -1.013426e-01 1 1  ON 5
 uu_6                -1.282010e-01 1 1  ON 6
 uu_7                -1.411935e-01 1 1  ON 7
 uu_8                -1.329673e-01 1 1  ON 8
 uu_9                -1.043536e-01 1 1  ON 9
 ud_0                 4.443527e-01 1 1  ON 10
 ud_1                 1.801295e-01 1 1  ON 11
 ud_2                 6.325054e-02 1 1  ON 12
 ud_3                -6.192833e-03 1 1  ON 13
 ud_4                -6.411883e-02 1 1  ON 14
 ud_5                -1.066798e-01 1 1  ON 15
 ud_6                -1.344888e-01 1 1  ON 16
 ud_7                -1.516146e-01 1 1  ON 17
 ud_8                -1.521892e-01 1 1  ON 18
 ud_9                -1.426112e-01 1 1  ON 19
 eO_0                -7.585650e-01 1 1  ON 20
 eO_1                -4.404406e-01 1 1  ON 21
 eO_2                -2.262437e-02 1 1  ON 22
 eO_3                 2.977541e-01 1 1  ON 23
 eO_4                 5.252170e-01 1 1  ON 24
 eO_5                 4.870201e-01 1 1  ON 25
 eO_6                 2.596886e-01 1 1  ON 26
 eO_7                -4.096972e-02 1 1  ON 27
 eO_8                -2.205874e-01 1 1  ON 28
 eO_9                -8.532273e-02 1 1  ON 29
eH1_0                -2.414798e-01 1 1  ON 30
eH1_1                -1.440753e-01 1 1  ON 31
eH1_2                -9.924639e-02 1 1  ON 32
eH1_3                -4.540298e-02 1 1  ON 33
eH1_4                 2.880356e-03 1 1  ON 34
eH1_5                 3.773231e-02 1 1  ON 35
eH1_6                 9.700215e-02 1 1  ON 36
eH1_7                 1.538045e-01 1 1  ON 37
eH1_8                 1.762282e-01 1 1  ON 38
eH1_9                 6.658133e-02 1 1  ON 39
eH2_0                -2.395720e-01 1 1  ON 40
eH2_1                -1.418636e-01 1 1  ON 41
eH2_2                -9.688539e-02 1 1  ON 42
eH2_3                -4.316091e-02 1 1  ON 43
eH2_4                 5.105057e-03 1 1  ON 44
eH2_5                 3.979582e-02 1 1  ON 45
eH2_6                 9.952831e-02 1 1  ON 46
eH2_7                 1.556286e-01 1 1  ON 47
eH2_8                 1.821134e-01 1 1  ON 48
eH2_9                 5.595293e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.9117
    reference variance = 0.369259
====================================================
  Execution time = 2.0090e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4843e-01
  Total weights = 2.0000e+06
  Execution time = 1.8722e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348475917349
                                         uncertainty =       0.006692785300

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348475917349
                                         uncertainty =       0.006692785300

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417389824
  error estimate for blocks of size 2^( 2) =       0.000429732175
  error estimate for blocks of size 2^( 3) =       0.000442854534
  error estimate for blocks of size 2^( 4) =       0.000455112690
  error estimate for blocks of size 2^( 5) =       0.000466589112
  error estimate for blocks of size 2^( 6) =       0.000475194107
  error estimate for blocks of size 2^( 7) =       0.000481458809

      target function =                  N/A
              le_mean =     -16.905648207894
             les_mean =     286.149369685917
             stat err =       0.000469588679
             autocorr =       1.265760452913
              std dev =       0.590278350504
             le_variance =       0.348428531074

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348475917356
                                         uncertainty =       0.006692785300

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348475917356
                                         uncertainty =       0.006692785300

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417389824
  error estimate for blocks of size 2^( 2) =       0.000429732175
  error estimate for blocks of size 2^( 3) =       0.000442854534
  error estimate for blocks of size 2^( 4) =       0.000455112690
  error estimate for blocks of size 2^( 5) =       0.000466589112
  error estimate for blocks of size 2^( 6) =       0.000475194107
  error estimate for blocks of size 2^( 7) =       0.000481458809

      target function =                  N/A
              le_mean =     -16.905648207894
             les_mean =     286.149369685923
             stat err =       0.000469588679
             autocorr =       1.265760452892
              std dev =       0.590278350510
             le_variance =       0.348428531081

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348475917353
                                         uncertainty =       0.006692785300

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348475917353
                                         uncertainty =       0.006692785300

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417389824
  error estimate for blocks of size 2^( 2) =       0.000429732175
  error estimate for blocks of size 2^( 3) =       0.000442854534
  error estimate for blocks of size 2^( 4) =       0.000455112690
  error estimate for blocks of size 2^( 5) =       0.000466589112
  error estimate for blocks of size 2^( 6) =       0.000475194107
  error estimate for blocks of size 2^( 7) =       0.000481458809

      target function =                  N/A
              le_mean =     -16.905648207894
             les_mean =     286.149369685920
             stat err =       0.000469588679
             autocorr =       1.265760452903
              std dev =       0.590278350507
             le_variance =       0.348428531077

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348475917350
                                         uncertainty =       0.006692785300

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348475917350
                                         uncertainty =       0.006692785300

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417389824
  error estimate for blocks of size 2^( 2) =       0.000429732175
  error estimate for blocks of size 2^( 3) =       0.000442854534
  error estimate for blocks of size 2^( 4) =       0.000455112690
  error estimate for blocks of size 2^( 5) =       0.000466589112
  error estimate for blocks of size 2^( 6) =       0.000475194107
  error estimate for blocks of size 2^( 7) =       0.000481458809

      target function =                  N/A
              le_mean =     -16.905648207894
             les_mean =     286.149369685917
             stat err =       0.000469588679
             autocorr =       1.265760452906
              std dev =       0.590278350504
             le_variance =       0.348428531074


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905648207894        initial  <--
     6.1035e+07     6.1035e+08             1.1784e-11       -16.905648207894
     2.4414e+08     2.4414e+09             2.9460e-12       -16.905648207894
     9.7656e+08     9.7656e+09             7.3540e-13       -16.905648207894

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5469
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.092933e-01 1 1  ON 0
 uu_1                 1.425581e-01 1 1  ON 1
 uu_2                 4.090837e-02 1 1  ON 2
 uu_3                -2.150581e-02 1 1  ON 3
 uu_4                -6.690997e-02 1 1  ON 4
 uu_5                -1.013426e-01 1 1  ON 5
 uu_6                -1.282010e-01 1 1  ON 6
 uu_7                -1.411935e-01 1 1  ON 7
 uu_8                -1.329673e-01 1 1  ON 8
 uu_9                -1.043536e-01 1 1  ON 9
 ud_0                 4.443527e-01 1 1  ON 10
 ud_1                 1.801295e-01 1 1  ON 11
 ud_2                 6.325054e-02 1 1  ON 12
 ud_3                -6.192833e-03 1 1  ON 13
 ud_4                -6.411883e-02 1 1  ON 14
 ud_5                -1.066798e-01 1 1  ON 15
 ud_6                -1.344888e-01 1 1  ON 16
 ud_7                -1.516146e-01 1 1  ON 17
 ud_8                -1.521892e-01 1 1  ON 18
 ud_9                -1.426112e-01 1 1  ON 19
 eO_0                -7.585650e-01 1 1  ON 20
 eO_1                -4.404406e-01 1 1  ON 21
 eO_2                -2.262437e-02 1 1  ON 22
 eO_3                 2.977541e-01 1 1  ON 23
 eO_4                 5.252170e-01 1 1  ON 24
 eO_5                 4.870201e-01 1 1  ON 25
 eO_6                 2.596886e-01 1 1  ON 26
 eO_7                -4.096972e-02 1 1  ON 27
 eO_8                -2.205874e-01 1 1  ON 28
 eO_9                -8.532273e-02 1 1  ON 29
eH1_0                -2.414798e-01 1 1  ON 30
eH1_1                -1.440753e-01 1 1  ON 31
eH1_2                -9.924639e-02 1 1  ON 32
eH1_3                -4.540298e-02 1 1  ON 33
eH1_4                 2.880356e-03 1 1  ON 34
eH1_5                 3.773231e-02 1 1  ON 35
eH1_6                 9.700215e-02 1 1  ON 36
eH1_7                 1.538045e-01 1 1  ON 37
eH1_8                 1.762282e-01 1 1  ON 38
eH1_9                 6.658133e-02 1 1  ON 39
eH2_0                -2.395720e-01 1 1  ON 40
eH2_1                -1.418636e-01 1 1  ON 41
eH2_2                -9.688539e-02 1 1  ON 42
eH2_3                -4.316091e-02 1 1  ON 43
eH2_4                 5.105057e-03 1 1  ON 44
eH2_5                 3.979582e-02 1 1  ON 45
eH2_6                 9.952831e-02 1 1  ON 46
eH2_7                 1.556286e-01 1 1  ON 47
eH2_8                 1.821134e-01 1 1  ON 48
eH2_9                 5.595293e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5799e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6894e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.9279
    reference variance = 0.193276
====================================================
  Execution time = 2.0119e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3202e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6143e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332050558916
                                         uncertainty =       0.002416590558

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332050558916
                                         uncertainty =       0.002416590558

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407443526
  error estimate for blocks of size 2^( 2) =       0.000420440368
  error estimate for blocks of size 2^( 3) =       0.000434114322
  error estimate for blocks of size 2^( 4) =       0.000446338469
  error estimate for blocks of size 2^( 5) =       0.000457452557
  error estimate for blocks of size 2^( 6) =       0.000466191464
  error estimate for blocks of size 2^( 7) =       0.000469316889

      target function =                  N/A
              le_mean =     -16.906240599379
             les_mean =     286.152991492051
             stat err =       0.000459824845
             autocorr =       1.273649772361
              std dev =       0.576212160551
             le_variance =       0.332020453967


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690624059938e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+08, overlap shift 6.1035e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906240599379       residual = 2.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906240599379       residual = 3.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906240599379       residual = 9.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906240599379       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906240600272       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906240547575       residual = 2.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906240601133       residual = 6.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906240720842       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906240606892       residual = 1.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+08 is 1.153220e-12

solving harmonic davidson linear method for identity shift 2.4414e+09, overlap shift 2.4414e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906240599379       residual = 2.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906240599379       residual = 3.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906240599379       residual = 9.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906239980024       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906239649964       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906240599379       residual = 2.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906240577890       residual = 6.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906238200002       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906239318984       residual = 1.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+09 is 2.874837e-13

solving harmonic davidson linear method for identity shift 9.7656e+09, overlap shift 9.7656e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906240599379       residual = 2.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906240599379       residual = 3.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906240599379       residual = 9.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906241646333       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906240599379       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906238050300       residual = 2.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906241096023       residual = 5.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906239933148       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906242344179       residual = 2.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+09 is 7.202269e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.064076 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5745e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.092933e-01 1 1  ON 0
 uu_1                 1.425581e-01 1 1  ON 1
 uu_2                 4.090837e-02 1 1  ON 2
 uu_3                -2.150581e-02 1 1  ON 3
 uu_4                -6.690997e-02 1 1  ON 4
 uu_5                -1.013426e-01 1 1  ON 5
 uu_6                -1.282010e-01 1 1  ON 6
 uu_7                -1.411935e-01 1 1  ON 7
 uu_8                -1.329673e-01 1 1  ON 8
 uu_9                -1.043536e-01 1 1  ON 9
 ud_0                 4.443527e-01 1 1  ON 10
 ud_1                 1.801295e-01 1 1  ON 11
 ud_2                 6.325054e-02 1 1  ON 12
 ud_3                -6.192833e-03 1 1  ON 13
 ud_4                -6.411883e-02 1 1  ON 14
 ud_5                -1.066798e-01 1 1  ON 15
 ud_6                -1.344888e-01 1 1  ON 16
 ud_7                -1.516146e-01 1 1  ON 17
 ud_8                -1.521892e-01 1 1  ON 18
 ud_9                -1.426112e-01 1 1  ON 19
 eO_0                -7.585650e-01 1 1  ON 20
 eO_1                -4.404406e-01 1 1  ON 21
 eO_2                -2.262437e-02 1 1  ON 22
 eO_3                 2.977541e-01 1 1  ON 23
 eO_4                 5.252170e-01 1 1  ON 24
 eO_5                 4.870201e-01 1 1  ON 25
 eO_6                 2.596886e-01 1 1  ON 26
 eO_7                -4.096972e-02 1 1  ON 27
 eO_8                -2.205874e-01 1 1  ON 28
 eO_9                -8.532273e-02 1 1  ON 29
eH1_0                -2.414798e-01 1 1  ON 30
eH1_1                -1.440753e-01 1 1  ON 31
eH1_2                -9.924639e-02 1 1  ON 32
eH1_3                -4.540298e-02 1 1  ON 33
eH1_4                 2.880356e-03 1 1  ON 34
eH1_5                 3.773231e-02 1 1  ON 35
eH1_6                 9.700215e-02 1 1  ON 36
eH1_7                 1.538045e-01 1 1  ON 37
eH1_8                 1.762282e-01 1 1  ON 38
eH1_9                 6.658133e-02 1 1  ON 39
eH2_0                -2.395720e-01 1 1  ON 40
eH2_1                -1.418636e-01 1 1  ON 41
eH2_2                -9.688539e-02 1 1  ON 42
eH2_3                -4.316091e-02 1 1  ON 43
eH2_4                 5.105057e-03 1 1  ON 44
eH2_5                 3.979582e-02 1 1  ON 45
eH2_6                 9.952831e-02 1 1  ON 46
eH2_7                 1.556286e-01 1 1  ON 47
eH2_8                 1.821134e-01 1 1  ON 48
eH2_9                 5.595293e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.9047
    reference variance = 0.38476
====================================================
  Execution time = 1.9932e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3700e-01
  Total weights = 2.0000e+06
  Execution time = 1.8795e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337045712926
                                         uncertainty =       0.003229085598

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337045712926
                                         uncertainty =       0.003229085598

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410490014
  error estimate for blocks of size 2^( 2) =       0.000422954017
  error estimate for blocks of size 2^( 3) =       0.000435865379
  error estimate for blocks of size 2^( 4) =       0.000447771652
  error estimate for blocks of size 2^( 5) =       0.000458152382
  error estimate for blocks of size 2^( 6) =       0.000466562807
  error estimate for blocks of size 2^( 7) =       0.000470840666

      target function =                  N/A
              le_mean =     -16.906613082945
             les_mean =     286.170569871750
             stat err =       0.000460831877
             autocorr =       1.260317107148
              std dev =       0.580520545588
             le_variance =       0.337004103850

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337045712927
                                         uncertainty =       0.003229085598

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337045712927
                                         uncertainty =       0.003229085598

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410490014
  error estimate for blocks of size 2^( 2) =       0.000422954017
  error estimate for blocks of size 2^( 3) =       0.000435865379
  error estimate for blocks of size 2^( 4) =       0.000447771652
  error estimate for blocks of size 2^( 5) =       0.000458152382
  error estimate for blocks of size 2^( 6) =       0.000466562807
  error estimate for blocks of size 2^( 7) =       0.000470840666

      target function =                  N/A
              le_mean =     -16.906613082945
             les_mean =     286.170569871751
             stat err =       0.000460831877
             autocorr =       1.260317107156
              std dev =       0.580520545588
             le_variance =       0.337004103850

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337045712927
                                         uncertainty =       0.003229085598

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337045712927
                                         uncertainty =       0.003229085598

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410490014
  error estimate for blocks of size 2^( 2) =       0.000422954017
  error estimate for blocks of size 2^( 3) =       0.000435865379
  error estimate for blocks of size 2^( 4) =       0.000447771652
  error estimate for blocks of size 2^( 5) =       0.000458152382
  error estimate for blocks of size 2^( 6) =       0.000466562807
  error estimate for blocks of size 2^( 7) =       0.000470840666

      target function =                  N/A
              le_mean =     -16.906613082945
             les_mean =     286.170569871751
             stat err =       0.000460831877
             autocorr =       1.260317107158
              std dev =       0.580520545588
             le_variance =       0.337004103850

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337045712926
                                         uncertainty =       0.003229085598

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337045712926
                                         uncertainty =       0.003229085598

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410490014
  error estimate for blocks of size 2^( 2) =       0.000422954017
  error estimate for blocks of size 2^( 3) =       0.000435865379
  error estimate for blocks of size 2^( 4) =       0.000447771652
  error estimate for blocks of size 2^( 5) =       0.000458152382
  error estimate for blocks of size 2^( 6) =       0.000466562807
  error estimate for blocks of size 2^( 7) =       0.000470840666

      target function =                  N/A
              le_mean =     -16.906613082945
             les_mean =     286.170569871750
             stat err =       0.000460831877
             autocorr =       1.260317107148
              std dev =       0.580520545588
             le_variance =       0.337004103850


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906613082945        initial  <--
     6.1035e+08     6.1035e+09             1.1532e-12       -16.906613082945
     2.4414e+09     2.4414e+10             2.8748e-13       -16.906613082945
     9.7656e+09     9.7656e+10             7.2023e-14       -16.906613082945

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4203
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.092933e-01 1 1  ON 0
 uu_1                 1.425581e-01 1 1  ON 1
 uu_2                 4.090837e-02 1 1  ON 2
 uu_3                -2.150581e-02 1 1  ON 3
 uu_4                -6.690997e-02 1 1  ON 4
 uu_5                -1.013426e-01 1 1  ON 5
 uu_6                -1.282010e-01 1 1  ON 6
 uu_7                -1.411935e-01 1 1  ON 7
 uu_8                -1.329673e-01 1 1  ON 8
 uu_9                -1.043536e-01 1 1  ON 9
 ud_0                 4.443527e-01 1 1  ON 10
 ud_1                 1.801295e-01 1 1  ON 11
 ud_2                 6.325054e-02 1 1  ON 12
 ud_3                -6.192833e-03 1 1  ON 13
 ud_4                -6.411883e-02 1 1  ON 14
 ud_5                -1.066798e-01 1 1  ON 15
 ud_6                -1.344888e-01 1 1  ON 16
 ud_7                -1.516146e-01 1 1  ON 17
 ud_8                -1.521892e-01 1 1  ON 18
 ud_9                -1.426112e-01 1 1  ON 19
 eO_0                -7.585650e-01 1 1  ON 20
 eO_1                -4.404406e-01 1 1  ON 21
 eO_2                -2.262437e-02 1 1  ON 22
 eO_3                 2.977541e-01 1 1  ON 23
 eO_4                 5.252170e-01 1 1  ON 24
 eO_5                 4.870201e-01 1 1  ON 25
 eO_6                 2.596886e-01 1 1  ON 26
 eO_7                -4.096972e-02 1 1  ON 27
 eO_8                -2.205874e-01 1 1  ON 28
 eO_9                -8.532273e-02 1 1  ON 29
eH1_0                -2.414798e-01 1 1  ON 30
eH1_1                -1.440753e-01 1 1  ON 31
eH1_2                -9.924639e-02 1 1  ON 32
eH1_3                -4.540298e-02 1 1  ON 33
eH1_4                 2.880356e-03 1 1  ON 34
eH1_5                 3.773231e-02 1 1  ON 35
eH1_6                 9.700215e-02 1 1  ON 36
eH1_7                 1.538045e-01 1 1  ON 37
eH1_8                 1.762282e-01 1 1  ON 38
eH1_9                 6.658133e-02 1 1  ON 39
eH2_0                -2.395720e-01 1 1  ON 40
eH2_1                -1.418636e-01 1 1  ON 41
eH2_2                -9.688539e-02 1 1  ON 42
eH2_3                -4.316091e-02 1 1  ON 43
eH2_4                 5.105057e-03 1 1  ON 44
eH2_5                 3.979582e-02 1 1  ON 45
eH2_6                 9.952831e-02 1 1  ON 46
eH2_7                 1.556286e-01 1 1  ON 47
eH2_8                 1.821134e-01 1 1  ON 48
eH2_9                 5.595293e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5172e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6895e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.888
    reference variance = 0.39559
====================================================
  Execution time = 2.0427e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3998e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4974e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340062307535
                                         uncertainty =       0.006514503878

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340062307535
                                         uncertainty =       0.006514503878

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412300452
  error estimate for blocks of size 2^( 2) =       0.000424980288
  error estimate for blocks of size 2^( 3) =       0.000438206417
  error estimate for blocks of size 2^( 4) =       0.000450968718
  error estimate for blocks of size 2^( 5) =       0.000462893159
  error estimate for blocks of size 2^( 6) =       0.000471468956
  error estimate for blocks of size 2^( 7) =       0.000477181104

      target function =                  N/A
              le_mean =     -16.905525595948
             les_mean =     286.136778829928
             stat err =       0.000465627984
             autocorr =       1.275412080518
              std dev =       0.583080890318
             le_variance =       0.339983324655


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690552559595e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+09, overlap shift 6.1035e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905525595948       residual = 2.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905525595948       residual = 3.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905525595948       residual = 9.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905525595948       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905522793525       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905525218532       residual = 2.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905524921433       residual = 5.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905526533762       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905531989787       residual = 8.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+09 is 9.610105e-14

solving harmonic davidson linear method for identity shift 2.4414e+10, overlap shift 2.4414e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905525595948       residual = 2.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905525595948       residual = 3.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905525595948       residual = 9.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905525595948       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905525595948       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905530701030       residual = 2.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905522469054       residual = 7.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905524226138       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905538235679       residual = 2.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905501027118       residual = 9.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905518920244       residual = 3.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905486654528       residual = 2.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905546211612       residual = 5.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905686998500       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.905078670672       residual = 2.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.905150567274       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.905702903106       residual = 3.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.903939602671       residual = 3.36e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.906258663231       residual = 7.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.905793860412       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.904510911737       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.903959945626       residual = 3.45e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.905882708197       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.904142540705       residual = 2.75e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.905209351145       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.907131511302       residual = 3.44e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.902387747031       residual = 1.32e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.906422549675       residual = 9.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.907169604339       residual = 3.22e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.908938047354       residual = 1.60e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.904243274272       residual = 2.10e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.907322939097       residual = 4.02e-04           smallest_sin_value = 9.97e-01
davidson iteration   32 stopping due to small subspace S singular value of 9.88e-01
davidson solver did not converge after         32 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+10 is 2.389917e-14

solving harmonic davidson linear method for identity shift 9.7656e+10, overlap shift 9.7656e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905525595948       residual = 2.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905525595948       residual = 3.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905525595948       residual = 9.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905465360759       residual = 4.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905474235812       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905525595948       residual = 4.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905528995770       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905504643529       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905466187217       residual = 4.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905466849230       residual = 3.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905940650547       residual = 2.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905776793067       residual = 7.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.901966280344       residual = 1.66e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.904921567621       residual = 5.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.909131284365       residual = 1.71e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.909250497601       residual = 1.82e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.904682175413       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.911913836211       residual = 5.42e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.903789058317       residual = 3.81e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.913888204252       residual = 9.53e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.902447851897       residual = 1.33e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.901578862134       residual = 2.01e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.920815491015       residual = 3.26e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.903983456023       residual = 2.65e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.913196532301       residual = 7.87e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.905726475036       residual = 5.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.900579637235       residual = 3.20e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.904409534658       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.903499768564       residual = 5.51e-04           smallest_sin_value = 9.98e-01
davidson iteration   29 stopping due to small subspace S singular value of 9.87e-01
davidson solver did not converge after         29 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+10 is 5.565919e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.092105 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5961e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.092933e-01 1 1  ON 0
 uu_1                 1.425581e-01 1 1  ON 1
 uu_2                 4.090837e-02 1 1  ON 2
 uu_3                -2.150581e-02 1 1  ON 3
 uu_4                -6.690997e-02 1 1  ON 4
 uu_5                -1.013426e-01 1 1  ON 5
 uu_6                -1.282010e-01 1 1  ON 6
 uu_7                -1.411935e-01 1 1  ON 7
 uu_8                -1.329673e-01 1 1  ON 8
 uu_9                -1.043536e-01 1 1  ON 9
 ud_0                 4.443527e-01 1 1  ON 10
 ud_1                 1.801295e-01 1 1  ON 11
 ud_2                 6.325054e-02 1 1  ON 12
 ud_3                -6.192833e-03 1 1  ON 13
 ud_4                -6.411883e-02 1 1  ON 14
 ud_5                -1.066798e-01 1 1  ON 15
 ud_6                -1.344888e-01 1 1  ON 16
 ud_7                -1.516146e-01 1 1  ON 17
 ud_8                -1.521892e-01 1 1  ON 18
 ud_9                -1.426112e-01 1 1  ON 19
 eO_0                -7.585650e-01 1 1  ON 20
 eO_1                -4.404406e-01 1 1  ON 21
 eO_2                -2.262437e-02 1 1  ON 22
 eO_3                 2.977541e-01 1 1  ON 23
 eO_4                 5.252170e-01 1 1  ON 24
 eO_5                 4.870201e-01 1 1  ON 25
 eO_6                 2.596886e-01 1 1  ON 26
 eO_7                -4.096972e-02 1 1  ON 27
 eO_8                -2.205874e-01 1 1  ON 28
 eO_9                -8.532273e-02 1 1  ON 29
eH1_0                -2.414798e-01 1 1  ON 30
eH1_1                -1.440753e-01 1 1  ON 31
eH1_2                -9.924639e-02 1 1  ON 32
eH1_3                -4.540298e-02 1 1  ON 33
eH1_4                 2.880356e-03 1 1  ON 34
eH1_5                 3.773231e-02 1 1  ON 35
eH1_6                 9.700215e-02 1 1  ON 36
eH1_7                 1.538045e-01 1 1  ON 37
eH1_8                 1.762282e-01 1 1  ON 38
eH1_9                 6.658133e-02 1 1  ON 39
eH2_0                -2.395720e-01 1 1  ON 40
eH2_1                -1.418636e-01 1 1  ON 41
eH2_2                -9.688539e-02 1 1  ON 42
eH2_3                -4.316091e-02 1 1  ON 43
eH2_4                 5.105057e-03 1 1  ON 44
eH2_5                 3.979582e-02 1 1  ON 45
eH2_6                 9.952831e-02 1 1  ON 46
eH2_7                 1.556286e-01 1 1  ON 47
eH2_8                 1.821134e-01 1 1  ON 48
eH2_9                 5.595293e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.8977
    reference variance = 0.229577
====================================================
  Execution time = 2.0728e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4147e-01
  Total weights = 2.0000e+06
  Execution time = 2.3784e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341554812513
                                         uncertainty =       0.005991857343

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341554812513
                                         uncertainty =       0.005991857343

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413199213
  error estimate for blocks of size 2^( 2) =       0.000425627913
  error estimate for blocks of size 2^( 3) =       0.000439227861
  error estimate for blocks of size 2^( 4) =       0.000452096642
  error estimate for blocks of size 2^( 5) =       0.000464356721
  error estimate for blocks of size 2^( 6) =       0.000473883750
  error estimate for blocks of size 2^( 7) =       0.000480288598

      target function =                  N/A
              le_mean =     -16.905651202514
             les_mean =     286.142509590004
             stat err =       0.000467656428
             autocorr =       1.280957863004
              std dev =       0.584351931347
             le_variance =       0.341467179668

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341554812513
                                         uncertainty =       0.005991857343

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341554812513
                                         uncertainty =       0.005991857343

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413199213
  error estimate for blocks of size 2^( 2) =       0.000425627913
  error estimate for blocks of size 2^( 3) =       0.000439227861
  error estimate for blocks of size 2^( 4) =       0.000452096642
  error estimate for blocks of size 2^( 5) =       0.000464356721
  error estimate for blocks of size 2^( 6) =       0.000473883750
  error estimate for blocks of size 2^( 7) =       0.000480288598

      target function =                  N/A
              le_mean =     -16.905651202514
             les_mean =     286.142509590004
             stat err =       0.000467656428
             autocorr =       1.280957863004
              std dev =       0.584351931347
             le_variance =       0.341467179669

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341554812513
                                         uncertainty =       0.005991857343

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341554812513
                                         uncertainty =       0.005991857343

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413199213
  error estimate for blocks of size 2^( 2) =       0.000425627913
  error estimate for blocks of size 2^( 3) =       0.000439227861
  error estimate for blocks of size 2^( 4) =       0.000452096642
  error estimate for blocks of size 2^( 5) =       0.000464356721
  error estimate for blocks of size 2^( 6) =       0.000473883750
  error estimate for blocks of size 2^( 7) =       0.000480288598

      target function =                  N/A
              le_mean =     -16.905651202514
             les_mean =     286.142509590004
             stat err =       0.000467656428
             autocorr =       1.280957863005
              std dev =       0.584351931347
             le_variance =       0.341467179668

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341554812513
                                         uncertainty =       0.005991857343

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341554812513
                                         uncertainty =       0.005991857343

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413199213
  error estimate for blocks of size 2^( 2) =       0.000425627913
  error estimate for blocks of size 2^( 3) =       0.000439227861
  error estimate for blocks of size 2^( 4) =       0.000452096642
  error estimate for blocks of size 2^( 5) =       0.000464356721
  error estimate for blocks of size 2^( 6) =       0.000473883750
  error estimate for blocks of size 2^( 7) =       0.000480288598

      target function =                  N/A
              le_mean =     -16.905651202514
             les_mean =     286.142509590004
             stat err =       0.000467656428
             autocorr =       1.280957863004
              std dev =       0.584351931347
             le_variance =       0.341467179668


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905651202514        initial  <--
     6.1035e+09     6.1035e+10             9.6101e-14       -16.905651202514
     2.4414e+10     2.4414e+11             2.3899e-14       -16.905651202514
     9.7656e+10     9.7656e+11             5.5659e-15       -16.905651202514

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.9187
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.092933e-01 1 1  ON 0
 uu_1                 1.425581e-01 1 1  ON 1
 uu_2                 4.090837e-02 1 1  ON 2
 uu_3                -2.150581e-02 1 1  ON 3
 uu_4                -6.690997e-02 1 1  ON 4
 uu_5                -1.013426e-01 1 1  ON 5
 uu_6                -1.282010e-01 1 1  ON 6
 uu_7                -1.411935e-01 1 1  ON 7
 uu_8                -1.329673e-01 1 1  ON 8
 uu_9                -1.043536e-01 1 1  ON 9
 ud_0                 4.443527e-01 1 1  ON 10
 ud_1                 1.801295e-01 1 1  ON 11
 ud_2                 6.325054e-02 1 1  ON 12
 ud_3                -6.192833e-03 1 1  ON 13
 ud_4                -6.411883e-02 1 1  ON 14
 ud_5                -1.066798e-01 1 1  ON 15
 ud_6                -1.344888e-01 1 1  ON 16
 ud_7                -1.516146e-01 1 1  ON 17
 ud_8                -1.521892e-01 1 1  ON 18
 ud_9                -1.426112e-01 1 1  ON 19
 eO_0                -7.585650e-01 1 1  ON 20
 eO_1                -4.404406e-01 1 1  ON 21
 eO_2                -2.262437e-02 1 1  ON 22
 eO_3                 2.977541e-01 1 1  ON 23
 eO_4                 5.252170e-01 1 1  ON 24
 eO_5                 4.870201e-01 1 1  ON 25
 eO_6                 2.596886e-01 1 1  ON 26
 eO_7                -4.096972e-02 1 1  ON 27
 eO_8                -2.205874e-01 1 1  ON 28
 eO_9                -8.532273e-02 1 1  ON 29
eH1_0                -2.414798e-01 1 1  ON 30
eH1_1                -1.440753e-01 1 1  ON 31
eH1_2                -9.924639e-02 1 1  ON 32
eH1_3                -4.540298e-02 1 1  ON 33
eH1_4                 2.880356e-03 1 1  ON 34
eH1_5                 3.773231e-02 1 1  ON 35
eH1_6                 9.700215e-02 1 1  ON 36
eH1_7                 1.538045e-01 1 1  ON 37
eH1_8                 1.762282e-01 1 1  ON 38
eH1_9                 6.658133e-02 1 1  ON 39
eH2_0                -2.395720e-01 1 1  ON 40
eH2_1                -1.418636e-01 1 1  ON 41
eH2_2                -9.688539e-02 1 1  ON 42
eH2_3                -4.316091e-02 1 1  ON 43
eH2_4                 5.105057e-03 1 1  ON 44
eH2_5                 3.979582e-02 1 1  ON 45
eH2_6                 9.952831e-02 1 1  ON 46
eH2_7                 1.556286e-01 1 1  ON 47
eH2_8                 1.821134e-01 1 1  ON 48
eH2_9                 5.595293e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6886e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6895e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.9436
    reference variance = 0.31943
====================================================
  Execution time = 2.0770e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3395e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5445e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334072201144
                                         uncertainty =       0.002585410721

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334072201144
                                         uncertainty =       0.002585410721

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408624501
  error estimate for blocks of size 2^( 2) =       0.000421109729
  error estimate for blocks of size 2^( 3) =       0.000434274002
  error estimate for blocks of size 2^( 4) =       0.000446543480
  error estimate for blocks of size 2^( 5) =       0.000455988646
  error estimate for blocks of size 2^( 6) =       0.000464149757
  error estimate for blocks of size 2^( 7) =       0.000469151170

      target function =                  N/A
              le_mean =     -16.906277805037
             les_mean =     286.156177019410
             stat err =       0.000458958263
             autocorr =       1.261529993547
              std dev =       0.577882310937
             le_variance =       0.333947965294


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690627780504e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+10, overlap shift 6.1035e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906277805037       residual = 2.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906277805037       residual = 4.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906277805037       residual = 9.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906281719351       residual = 3.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906268639435       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906293931354       residual = 4.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906252086583       residual = 2.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906254308343       residual = 9.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906202358341       residual = 7.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906167863441       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906278307030       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906710284863       residual = 2.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905821069370       residual = 2.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906455931424       residual = 3.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906204247160       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906631361970       residual = 1.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.907976971441       residual = 3.93e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.910640481883       residual = 2.51e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.906045608441       residual = 6.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.903305789332       residual = 1.14e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.905027276643       residual = 2.26e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.903553848260       residual = 9.81e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.905719692361       residual = 7.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.915030908039       residual = 1.01e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.903633352854       residual = 9.03e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.902946582665       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.903787096253       residual = 7.71e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.901895805181       residual = 2.56e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.907048827479       residual = 8.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.897424572310       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.905729851778       residual = 6.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.902234958765       residual = 2.37e-03           smallest_sin_value = 9.97e-01
davidson iteration   32 stopping due to small subspace S singular value of 9.83e-01
davidson solver did not converge after         32 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+10 is 1.299663e-14

solving harmonic davidson linear method for identity shift 2.4414e+11, overlap shift 2.4414e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906277805037       residual = 2.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906277805037       residual = 4.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906277805037       residual = 9.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906268757171       residual = 4.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906279348120       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906301736407       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906325268545       residual = 3.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905384201558       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906041107950       residual = 9.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905326431392       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906473446574       residual = 6.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.903212318567       residual = 1.26e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.904445289164       residual = 4.84e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.902619297873       residual = 1.63e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.902464400763       residual = 1.73e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.902022413293       residual = 2.62e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.919867729829       residual = 2.47e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.904960372889       residual = 2.34e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.912729376384       residual = 5.17e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.911439482316       residual = 2.89e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.912467575926       residual = 4.57e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.918913173678       residual = 2.12e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.886504707300       residual = 5.22e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.926295718819       residual = 5.05e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.886486164954       residual = 4.89e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.884695160001       residual = 5.90e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.908414894740       residual = 1.81e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.929283604371       residual = 6.25e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.934262673249       residual = 1.02e-01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.894309182176       residual = 2.17e-02           smallest_sin_value = 9.99e-01
davidson iteration   30:   krylov dim =  31   energy =     -16.906086111154       residual = 1.28e-03           smallest_sin_value = 9.97e-01
davidson iteration   31 stopping due to small subspace S singular value of 9.84e-01
davidson solver did not converge after         31 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+11 is 3.166115e-15

solving harmonic davidson linear method for identity shift 9.7656e+11, overlap shift 9.7656e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906277805037       residual = 2.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906277805037       residual = 4.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906277805037       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906277805037       residual = 6.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905758632632       residual = 3.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906308318774       residual = 3.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906377378794       residual = 2.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905828176743       residual = 2.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.903548546487       residual = 9.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.911316578765       residual = 3.34e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905276563343       residual = 1.00e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905673484770       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.911298719041       residual = 3.42e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.908616164309       residual = 5.70e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.907461789899       residual = 2.43e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.907720532992       residual = 2.77e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.890080335221       residual = 3.61e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.908453306923       residual = 2.40e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.916408148919       residual = 1.54e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.777743774342       residual = 2.17e+00           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.898834288726       residual = 9.75e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.970226969445       residual = 5.68e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.915945153070       residual = 1.64e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.837822809337       residual = 6.17e-01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.814969463471       residual = 1.08e+00           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.809919172484       residual = 1.20e+00           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.768552954591       residual = 2.57e+00           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.141033824570       residual = 7.17e+00           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.824079217310       residual = 9.76e-01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.894994499040       residual = 2.10e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.966218733420       residual = 5.16e-01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.787650980622       residual = 1.80e+00           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -16.906732698667       residual = 1.28e-02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -16.831903277405       residual = 8.17e-01           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -16.771102012269       residual = 2.17e+00           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -16.861225063354       residual = 3.99e-01           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   energy =     -16.859921042309       residual = 7.46e-01           smallest_sin_value = 9.96e-01
davidson iteration   37 stopping due to small subspace S singular value of 9.81e-01
davidson solver did not converge after         37 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+11 is 6.672391e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.141375 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6373e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.092933e-01 1 1  ON 0
 uu_1                 1.425581e-01 1 1  ON 1
 uu_2                 4.090837e-02 1 1  ON 2
 uu_3                -2.150581e-02 1 1  ON 3
 uu_4                -6.690997e-02 1 1  ON 4
 uu_5                -1.013426e-01 1 1  ON 5
 uu_6                -1.282010e-01 1 1  ON 6
 uu_7                -1.411935e-01 1 1  ON 7
 uu_8                -1.329673e-01 1 1  ON 8
 uu_9                -1.043536e-01 1 1  ON 9
 ud_0                 4.443527e-01 1 1  ON 10
 ud_1                 1.801295e-01 1 1  ON 11
 ud_2                 6.325054e-02 1 1  ON 12
 ud_3                -6.192833e-03 1 1  ON 13
 ud_4                -6.411883e-02 1 1  ON 14
 ud_5                -1.066798e-01 1 1  ON 15
 ud_6                -1.344888e-01 1 1  ON 16
 ud_7                -1.516146e-01 1 1  ON 17
 ud_8                -1.521892e-01 1 1  ON 18
 ud_9                -1.426112e-01 1 1  ON 19
 eO_0                -7.585650e-01 1 1  ON 20
 eO_1                -4.404406e-01 1 1  ON 21
 eO_2                -2.262437e-02 1 1  ON 22
 eO_3                 2.977541e-01 1 1  ON 23
 eO_4                 5.252170e-01 1 1  ON 24
 eO_5                 4.870201e-01 1 1  ON 25
 eO_6                 2.596886e-01 1 1  ON 26
 eO_7                -4.096972e-02 1 1  ON 27
 eO_8                -2.205874e-01 1 1  ON 28
 eO_9                -8.532273e-02 1 1  ON 29
eH1_0                -2.414798e-01 1 1  ON 30
eH1_1                -1.440753e-01 1 1  ON 31
eH1_2                -9.924639e-02 1 1  ON 32
eH1_3                -4.540298e-02 1 1  ON 33
eH1_4                 2.880356e-03 1 1  ON 34
eH1_5                 3.773231e-02 1 1  ON 35
eH1_6                 9.700215e-02 1 1  ON 36
eH1_7                 1.538045e-01 1 1  ON 37
eH1_8                 1.762282e-01 1 1  ON 38
eH1_9                 6.658133e-02 1 1  ON 39
eH2_0                -2.395720e-01 1 1  ON 40
eH2_1                -1.418636e-01 1 1  ON 41
eH2_2                -9.688539e-02 1 1  ON 42
eH2_3                -4.316091e-02 1 1  ON 43
eH2_4                 5.105057e-03 1 1  ON 44
eH2_5                 3.979582e-02 1 1  ON 45
eH2_6                 9.952831e-02 1 1  ON 46
eH2_7                 1.556286e-01 1 1  ON 47
eH2_8                 1.821134e-01 1 1  ON 48
eH2_9                 5.595293e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.8815
    reference variance = 0.202741
====================================================
  Execution time = 2.0081e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4538e-01
  Total weights = 2.0000e+06
  Execution time = 1.8795e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345528489277
                                         uncertainty =       0.007170052437

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345528489277
                                         uncertainty =       0.007170052437

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415559768
  error estimate for blocks of size 2^( 2) =       0.000428355406
  error estimate for blocks of size 2^( 3) =       0.000440944702
  error estimate for blocks of size 2^( 4) =       0.000452819305
  error estimate for blocks of size 2^( 5) =       0.000463405657
  error estimate for blocks of size 2^( 6) =       0.000471602038
  error estimate for blocks of size 2^( 7) =       0.000478263636

      target function =                  N/A
              le_mean =     -16.905621001206
             les_mean =     286.145401104490
             stat err =       0.000466522659
             autocorr =       1.260313230159
              std dev =       0.587690259204
             le_variance =       0.345379840763

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345528489277
                                         uncertainty =       0.007170052437

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345528489277
                                         uncertainty =       0.007170052437

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415559768
  error estimate for blocks of size 2^( 2) =       0.000428355406
  error estimate for blocks of size 2^( 3) =       0.000440944702
  error estimate for blocks of size 2^( 4) =       0.000452819305
  error estimate for blocks of size 2^( 5) =       0.000463405657
  error estimate for blocks of size 2^( 6) =       0.000471602038
  error estimate for blocks of size 2^( 7) =       0.000478263636

      target function =                  N/A
              le_mean =     -16.905621001206
             les_mean =     286.145401104490
             stat err =       0.000466522659
             autocorr =       1.260313230164
              std dev =       0.587690259204
             le_variance =       0.345379840763

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345528489277
                                         uncertainty =       0.007170052437

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345528489277
                                         uncertainty =       0.007170052437

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415559768
  error estimate for blocks of size 2^( 2) =       0.000428355406
  error estimate for blocks of size 2^( 3) =       0.000440944702
  error estimate for blocks of size 2^( 4) =       0.000452819305
  error estimate for blocks of size 2^( 5) =       0.000463405657
  error estimate for blocks of size 2^( 6) =       0.000471602038
  error estimate for blocks of size 2^( 7) =       0.000478263636

      target function =                  N/A
              le_mean =     -16.905621001206
             les_mean =     286.145401104490
             stat err =       0.000466522659
             autocorr =       1.260313230164
              std dev =       0.587690259204
             le_variance =       0.345379840763

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345528489277
                                         uncertainty =       0.007170052437

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345528489277
                                         uncertainty =       0.007170052437

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415559768
  error estimate for blocks of size 2^( 2) =       0.000428355406
  error estimate for blocks of size 2^( 3) =       0.000440944702
  error estimate for blocks of size 2^( 4) =       0.000452819305
  error estimate for blocks of size 2^( 5) =       0.000463405657
  error estimate for blocks of size 2^( 6) =       0.000471602038
  error estimate for blocks of size 2^( 7) =       0.000478263636

      target function =                  N/A
              le_mean =     -16.905621001206
             les_mean =     286.145401104490
             stat err =       0.000466522659
             autocorr =       1.260313230162
              std dev =       0.587690259204
             le_variance =       0.345379840763


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905621001206        initial
     6.1035e+10     6.1035e+11             1.2997e-14       -16.905621001206
     2.4414e+11     2.4414e+12             3.1661e-15       -16.905621001206
     9.7656e+11     9.7656e+12             6.6724e-16       -16.905621001206  <--

*****************************************************************************
Applying the update for shift_i =   9.7656e+11     and shift_s =   9.7656e+12
*****************************************************************************

  Execution time = 2.9572e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.092933e-01 1 1  ON 0
 uu_1                 1.425581e-01 1 1  ON 1
 uu_2                 4.090837e-02 1 1  ON 2
 uu_3                -2.150581e-02 1 1  ON 3
 uu_4                -6.690997e-02 1 1  ON 4
 uu_5                -1.013426e-01 1 1  ON 5
 uu_6                -1.282010e-01 1 1  ON 6
 uu_7                -1.411935e-01 1 1  ON 7
 uu_8                -1.329673e-01 1 1  ON 8
 uu_9                -1.043536e-01 1 1  ON 9
 ud_0                 4.443527e-01 1 1  ON 10
 ud_1                 1.801295e-01 1 1  ON 11
 ud_2                 6.325054e-02 1 1  ON 12
 ud_3                -6.192833e-03 1 1  ON 13
 ud_4                -6.411883e-02 1 1  ON 14
 ud_5                -1.066798e-01 1 1  ON 15
 ud_6                -1.344888e-01 1 1  ON 16
 ud_7                -1.516146e-01 1 1  ON 17
 ud_8                -1.521892e-01 1 1  ON 18
 ud_9                -1.426112e-01 1 1  ON 19
 eO_0                -7.585650e-01 1 1  ON 20
 eO_1                -4.404406e-01 1 1  ON 21
 eO_2                -2.262437e-02 1 1  ON 22
 eO_3                 2.977541e-01 1 1  ON 23
 eO_4                 5.252170e-01 1 1  ON 24
 eO_5                 4.870201e-01 1 1  ON 25
 eO_6                 2.596886e-01 1 1  ON 26
 eO_7                -4.096972e-02 1 1  ON 27
 eO_8                -2.205874e-01 1 1  ON 28
 eO_9                -8.532273e-02 1 1  ON 29
eH1_0                -2.414798e-01 1 1  ON 30
eH1_1                -1.440753e-01 1 1  ON 31
eH1_2                -9.924639e-02 1 1  ON 32
eH1_3                -4.540298e-02 1 1  ON 33
eH1_4                 2.880356e-03 1 1  ON 34
eH1_5                 3.773231e-02 1 1  ON 35
eH1_6                 9.700215e-02 1 1  ON 36
eH1_7                 1.538045e-01 1 1  ON 37
eH1_8                 1.762282e-01 1 1  ON 38
eH1_9                 6.658133e-02 1 1  ON 39
eH2_0                -2.395720e-01 1 1  ON 40
eH2_1                -1.418636e-01 1 1  ON 41
eH2_2                -9.688539e-02 1 1  ON 42
eH2_3                -4.316091e-02 1 1  ON 43
eH2_4                 5.105057e-03 1 1  ON 44
eH2_5                 3.979582e-02 1 1  ON 45
eH2_6                 9.952831e-02 1 1  ON 46
eH2_7                 1.556286e-01 1 1  ON 47
eH2_8                 1.821134e-01 1 1  ON 48
eH2_9                 5.595293e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5952e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6896e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.8858
    reference variance = 1.08058
====================================================
  Execution time = 2.0531e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3233e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5560e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332382518045
                                         uncertainty =       0.003475737704

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332382518045
                                         uncertainty =       0.003475737704

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407636066
  error estimate for blocks of size 2^( 2) =       0.000420390342
  error estimate for blocks of size 2^( 3) =       0.000433728643
  error estimate for blocks of size 2^( 4) =       0.000446085709
  error estimate for blocks of size 2^( 5) =       0.000456884498
  error estimate for blocks of size 2^( 6) =       0.000465551800
  error estimate for blocks of size 2^( 7) =       0.000469939077

      target function =                  N/A
              le_mean =     -16.906105030926
             les_mean =     286.148721475195
             stat err =       0.000459615271
             autocorr =       1.271287264984
              std dev =       0.576484453097
             le_variance =       0.332334324663


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690610503093e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+11, overlap shift 2.4414e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906105030926       residual = 2.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906105030926       residual = 3.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906105030926       residual = 9.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905961055941       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906105326659       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906180992119       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906387576891       residual = 8.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906597996705       residual = 3.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906286618015       residual = 6.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905607267812       residual = 4.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905636128419       residual = 4.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905886453077       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905184715960       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905491909855       residual = 5.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.907717656896       residual = 3.55e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.935726695987       residual = 1.16e-01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.914509801837       residual = 9.06e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.916768774793       residual = 1.45e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.902901345781       residual = 1.34e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.903152048898       residual = 1.63e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.861765263213       residual = 2.62e-01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.875887523262       residual = 1.19e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.926064198585       residual = 5.19e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.881220321443       residual = 8.58e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.892024248739       residual = 2.78e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.918896323295       residual = 2.19e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.918484427186       residual = 2.11e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.907476264623       residual = 3.75e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.905969153211       residual = 3.64e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.935888110197       residual = 1.19e-01           smallest_sin_value = 9.99e-01
davidson iteration   30:   krylov dim =  31   energy =     -16.933365996814       residual = 8.84e-02           smallest_sin_value = 9.98e-01
davidson iteration   31:   krylov dim =  32   energy =     -16.883089610652       residual = 8.96e-02           smallest_sin_value = 9.94e-01
davidson iteration   32 stopping due to small subspace S singular value of 9.69e-01
davidson solver did not converge after         32 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+11 is 2.916870e-15

solving harmonic davidson linear method for identity shift 9.7656e+11, overlap shift 9.7656e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906105030926       residual = 2.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906105030926       residual = 3.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906105030926       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906095205117       residual = 6.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906259472883       residual = 9.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905869162807       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.899978999007       residual = 4.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911817332795       residual = 3.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.904620022329       residual = 2.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.897104832561       residual = 1.13e-02           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.883999465558       residual = 6.52e-02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.877863455479       residual = 1.02e-01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.914355320248       residual = 8.02e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.902014113719       residual = 2.99e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.937146885155       residual = 1.27e-01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.918111068868       residual = 2.12e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.903995987703       residual = 5.72e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.908118263671       residual = 1.78e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.928673308712       residual = 6.73e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.891774629372       residual = 2.92e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.884303426009       residual = 5.55e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.822207629805       residual = 9.53e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.002041057902       residual = 1.17e+00           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.974624477642       residual = 6.02e-01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.868736837915       residual = 1.95e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.041606916052       residual = 2.48e+00           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.023898310144       residual = 1.82e+00           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.825000900092       residual = 9.72e-01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.824389347982       residual = 9.42e-01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.901232896403       residual = 1.77e-02           smallest_sin_value = 9.99e-01
davidson iteration   30:   krylov dim =  31   energy =     -17.004798298872       residual = 1.20e+00           smallest_sin_value = 9.98e-01
davidson iteration   31:   krylov dim =  32   energy =     -16.788319464408       residual = 1.64e+00           smallest_sin_value = 9.95e-01
davidson iteration   32 stopping due to small subspace S singular value of 9.87e-01
davidson solver did not converge after         32 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+11 is 6.862735e-16

solving harmonic davidson linear method for identity shift 3.9062e+12, overlap shift 3.9062e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906105030926       residual = 2.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906105030926       residual = 2.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.21e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+12 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.170216 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6125e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.092933e-01 1 1  ON 0
 uu_1                 1.425581e-01 1 1  ON 1
 uu_2                 4.090837e-02 1 1  ON 2
 uu_3                -2.150581e-02 1 1  ON 3
 uu_4                -6.690997e-02 1 1  ON 4
 uu_5                -1.013426e-01 1 1  ON 5
 uu_6                -1.282010e-01 1 1  ON 6
 uu_7                -1.411935e-01 1 1  ON 7
 uu_8                -1.329673e-01 1 1  ON 8
 uu_9                -1.043536e-01 1 1  ON 9
 ud_0                 4.443527e-01 1 1  ON 10
 ud_1                 1.801295e-01 1 1  ON 11
 ud_2                 6.325054e-02 1 1  ON 12
 ud_3                -6.192833e-03 1 1  ON 13
 ud_4                -6.411883e-02 1 1  ON 14
 ud_5                -1.066798e-01 1 1  ON 15
 ud_6                -1.344888e-01 1 1  ON 16
 ud_7                -1.516146e-01 1 1  ON 17
 ud_8                -1.521892e-01 1 1  ON 18
 ud_9                -1.426112e-01 1 1  ON 19
 eO_0                -7.585650e-01 1 1  ON 20
 eO_1                -4.404406e-01 1 1  ON 21
 eO_2                -2.262437e-02 1 1  ON 22
 eO_3                 2.977541e-01 1 1  ON 23
 eO_4                 5.252170e-01 1 1  ON 24
 eO_5                 4.870201e-01 1 1  ON 25
 eO_6                 2.596886e-01 1 1  ON 26
 eO_7                -4.096972e-02 1 1  ON 27
 eO_8                -2.205874e-01 1 1  ON 28
 eO_9                -8.532273e-02 1 1  ON 29
eH1_0                -2.414798e-01 1 1  ON 30
eH1_1                -1.440753e-01 1 1  ON 31
eH1_2                -9.924639e-02 1 1  ON 32
eH1_3                -4.540298e-02 1 1  ON 33
eH1_4                 2.880356e-03 1 1  ON 34
eH1_5                 3.773231e-02 1 1  ON 35
eH1_6                 9.700215e-02 1 1  ON 36
eH1_7                 1.538045e-01 1 1  ON 37
eH1_8                 1.762282e-01 1 1  ON 38
eH1_9                 6.658133e-02 1 1  ON 39
eH2_0                -2.395720e-01 1 1  ON 40
eH2_1                -1.418636e-01 1 1  ON 41
eH2_2                -9.688539e-02 1 1  ON 42
eH2_3                -4.316091e-02 1 1  ON 43
eH2_4                 5.105057e-03 1 1  ON 44
eH2_5                 3.979582e-02 1 1  ON 45
eH2_6                 9.952831e-02 1 1  ON 46
eH2_7                 1.556286e-01 1 1  ON 47
eH2_8                 1.821134e-01 1 1  ON 48
eH2_9                 5.595293e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.8792
    reference variance = 0.448771
====================================================
  Execution time = 2.0065e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4273e-01
  Total weights = 2.0000e+06
  Execution time = 1.8810e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342783827552
                                         uncertainty =       0.005927057679

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342783827552
                                         uncertainty =       0.005927057679

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413963036
  error estimate for blocks of size 2^( 2) =       0.000426465555
  error estimate for blocks of size 2^( 3) =       0.000439454046
  error estimate for blocks of size 2^( 4) =       0.000451771951
  error estimate for blocks of size 2^( 5) =       0.000463537397
  error estimate for blocks of size 2^( 6) =       0.000472140196
  error estimate for blocks of size 2^( 7) =       0.000477017305

      target function =                  N/A
              le_mean =     -16.906960055972
             les_mean =     286.188028953544
             stat err =       0.000466116712
             autocorr =       1.267845174314
              std dev =       0.585432140117
             le_variance =       0.342730790682

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342783827552
                                         uncertainty =       0.005927057679

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342783827552
                                         uncertainty =       0.005927057679

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413963036
  error estimate for blocks of size 2^( 2) =       0.000426465555
  error estimate for blocks of size 2^( 3) =       0.000439454046
  error estimate for blocks of size 2^( 4) =       0.000451771951
  error estimate for blocks of size 2^( 5) =       0.000463537397
  error estimate for blocks of size 2^( 6) =       0.000472140196
  error estimate for blocks of size 2^( 7) =       0.000477017305

      target function =                  N/A
              le_mean =     -16.906960055972
             les_mean =     286.188028953543
             stat err =       0.000466116712
             autocorr =       1.267845174308
              std dev =       0.585432140117
             le_variance =       0.342730790682

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342783827552
                                         uncertainty =       0.005927057679

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342783827552
                                         uncertainty =       0.005927057679

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413963036
  error estimate for blocks of size 2^( 2) =       0.000426465555
  error estimate for blocks of size 2^( 3) =       0.000439454046
  error estimate for blocks of size 2^( 4) =       0.000451771951
  error estimate for blocks of size 2^( 5) =       0.000463537397
  error estimate for blocks of size 2^( 6) =       0.000472140196
  error estimate for blocks of size 2^( 7) =       0.000477017305

      target function =                  N/A
              le_mean =     -16.906960055972
             les_mean =     286.188028953543
             stat err =       0.000466116712
             autocorr =       1.267845174310
              std dev =       0.585432140117
             le_variance =       0.342730790682

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342783827552
                                         uncertainty =       0.005927057679

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342783827552
                                         uncertainty =       0.005927057679

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413963036
  error estimate for blocks of size 2^( 2) =       0.000426465555
  error estimate for blocks of size 2^( 3) =       0.000439454046
  error estimate for blocks of size 2^( 4) =       0.000451771951
  error estimate for blocks of size 2^( 5) =       0.000463537397
  error estimate for blocks of size 2^( 6) =       0.000472140196
  error estimate for blocks of size 2^( 7) =       0.000477017305

      target function =                  N/A
              le_mean =     -16.906960055972
             les_mean =     286.188028953544
             stat err =       0.000466116712
             autocorr =       1.267845174314
              std dev =       0.585432140117
             le_variance =       0.342730790682


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906960055972        initial  <--
     2.4414e+11     2.4414e+12             2.9169e-15       -16.906960055972
     9.7656e+11     9.7656e+12             6.8627e-16       -16.906960055972
     3.9062e+12     3.9062e+13             0.0000e+00       -16.906960055972

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 33.1266
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.092933e-01 1 1  ON 0
 uu_1                 1.425581e-01 1 1  ON 1
 uu_2                 4.090837e-02 1 1  ON 2
 uu_3                -2.150581e-02 1 1  ON 3
 uu_4                -6.690997e-02 1 1  ON 4
 uu_5                -1.013426e-01 1 1  ON 5
 uu_6                -1.282010e-01 1 1  ON 6
 uu_7                -1.411935e-01 1 1  ON 7
 uu_8                -1.329673e-01 1 1  ON 8
 uu_9                -1.043536e-01 1 1  ON 9
 ud_0                 4.443527e-01 1 1  ON 10
 ud_1                 1.801295e-01 1 1  ON 11
 ud_2                 6.325054e-02 1 1  ON 12
 ud_3                -6.192833e-03 1 1  ON 13
 ud_4                -6.411883e-02 1 1  ON 14
 ud_5                -1.066798e-01 1 1  ON 15
 ud_6                -1.344888e-01 1 1  ON 16
 ud_7                -1.516146e-01 1 1  ON 17
 ud_8                -1.521892e-01 1 1  ON 18
 ud_9                -1.426112e-01 1 1  ON 19
 eO_0                -7.585650e-01 1 1  ON 20
 eO_1                -4.404406e-01 1 1  ON 21
 eO_2                -2.262437e-02 1 1  ON 22
 eO_3                 2.977541e-01 1 1  ON 23
 eO_4                 5.252170e-01 1 1  ON 24
 eO_5                 4.870201e-01 1 1  ON 25
 eO_6                 2.596886e-01 1 1  ON 26
 eO_7                -4.096972e-02 1 1  ON 27
 eO_8                -2.205874e-01 1 1  ON 28
 eO_9                -8.532273e-02 1 1  ON 29
eH1_0                -2.414798e-01 1 1  ON 30
eH1_1                -1.440753e-01 1 1  ON 31
eH1_2                -9.924639e-02 1 1  ON 32
eH1_3                -4.540298e-02 1 1  ON 33
eH1_4                 2.880356e-03 1 1  ON 34
eH1_5                 3.773231e-02 1 1  ON 35
eH1_6                 9.700215e-02 1 1  ON 36
eH1_7                 1.538045e-01 1 1  ON 37
eH1_8                 1.762282e-01 1 1  ON 38
eH1_9                 6.658133e-02 1 1  ON 39
eH2_0                -2.395720e-01 1 1  ON 40
eH2_1                -1.418636e-01 1 1  ON 41
eH2_2                -9.688539e-02 1 1  ON 42
eH2_3                -4.316091e-02 1 1  ON 43
eH2_4                 5.105057e-03 1 1  ON 44
eH2_5                 3.979582e-02 1 1  ON 45
eH2_6                 9.952831e-02 1 1  ON 46
eH2_7                 1.556286e-01 1 1  ON 47
eH2_8                 1.821134e-01 1 1  ON 48
eH2_9                 5.595293e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9257e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6895e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.9681
    reference variance = 0.605944
====================================================
  Execution time = 2.0813e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5188e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6388e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351936373010
                                         uncertainty =       0.019432300774

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351936373010
                                         uncertainty =       0.019432300774

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419452642
  error estimate for blocks of size 2^( 2) =       0.000431561941
  error estimate for blocks of size 2^( 3) =       0.000444440916
  error estimate for blocks of size 2^( 4) =       0.000456152183
  error estimate for blocks of size 2^( 5) =       0.000465818149
  error estimate for blocks of size 2^( 6) =       0.000472393613
  error estimate for blocks of size 2^( 7) =       0.000478146396

      target function =                  N/A
              le_mean =     -16.905770352264
             les_mean =     286.156952066145
             stat err =       0.000468127585
             autocorr =       1.245554103970
              std dev =       0.593195615796
             le_variance =       0.351881038600


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690577035226e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+12, overlap shift 2.4414e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905770352264       residual = 2.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905770352264       residual = 3.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905770352264       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904101817998       residual = 5.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905866344578       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905739242721       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904878280649       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911996613771       residual = 6.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.921557883232       residual = 3.34e-02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.933711228417       residual = 1.03e-01           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.900056382011       residual = 5.55e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.893280118829       residual = 2.18e-02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.915109730069       residual = 1.28e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.877057968232       residual = 1.06e-01           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.957483977333       residual = 3.45e-01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.889554776996       residual = 2.57e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.914385740281       residual = 1.50e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.895415734690       residual = 1.72e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.910424494356       residual = 5.42e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.934145640082       residual = 1.38e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.870763753220       residual = 1.72e-01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.898516754671       residual = 2.32e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.933515130549       residual = 1.28e-01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.930143847745       residual = 8.37e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.845346120160       residual = 5.20e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.842837629432       residual = 1.02e+00           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.799242766395       residual = 1.78e+00           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.499534115332       residual = 1.80e+01           smallest_sin_value = 9.98e-01
davidson iteration   28:   krylov dim =  29   energy =     -16.791777094244       residual = 2.11e+00           smallest_sin_value = 9.96e-01
davidson iteration   29 stopping due to small subspace S singular value of 9.81e-01
davidson solver did not converge after         29 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+12 is 2.905389e-16

solving harmonic davidson linear method for identity shift 9.7656e+12, overlap shift 9.7656e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905770352264       residual = 2.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905770352264       residual = 2.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.19e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+12 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.9062e+13, overlap shift 3.9062e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905770352264       residual = 2.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905770352264       residual = 2.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.19e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+13 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.182219 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6473e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.092933e-01 1 1  ON 0
 uu_1                 1.425581e-01 1 1  ON 1
 uu_2                 4.090837e-02 1 1  ON 2
 uu_3                -2.150581e-02 1 1  ON 3
 uu_4                -6.690997e-02 1 1  ON 4
 uu_5                -1.013426e-01 1 1  ON 5
 uu_6                -1.282010e-01 1 1  ON 6
 uu_7                -1.411935e-01 1 1  ON 7
 uu_8                -1.329673e-01 1 1  ON 8
 uu_9                -1.043536e-01 1 1  ON 9
 ud_0                 4.443527e-01 1 1  ON 10
 ud_1                 1.801295e-01 1 1  ON 11
 ud_2                 6.325054e-02 1 1  ON 12
 ud_3                -6.192833e-03 1 1  ON 13
 ud_4                -6.411883e-02 1 1  ON 14
 ud_5                -1.066798e-01 1 1  ON 15
 ud_6                -1.344888e-01 1 1  ON 16
 ud_7                -1.516146e-01 1 1  ON 17
 ud_8                -1.521892e-01 1 1  ON 18
 ud_9                -1.426112e-01 1 1  ON 19
 eO_0                -7.585650e-01 1 1  ON 20
 eO_1                -4.404406e-01 1 1  ON 21
 eO_2                -2.262437e-02 1 1  ON 22
 eO_3                 2.977541e-01 1 1  ON 23
 eO_4                 5.252170e-01 1 1  ON 24
 eO_5                 4.870201e-01 1 1  ON 25
 eO_6                 2.596886e-01 1 1  ON 26
 eO_7                -4.096972e-02 1 1  ON 27
 eO_8                -2.205874e-01 1 1  ON 28
 eO_9                -8.532273e-02 1 1  ON 29
eH1_0                -2.414798e-01 1 1  ON 30
eH1_1                -1.440753e-01 1 1  ON 31
eH1_2                -9.924639e-02 1 1  ON 32
eH1_3                -4.540298e-02 1 1  ON 33
eH1_4                 2.880356e-03 1 1  ON 34
eH1_5                 3.773231e-02 1 1  ON 35
eH1_6                 9.700215e-02 1 1  ON 36
eH1_7                 1.538045e-01 1 1  ON 37
eH1_8                 1.762282e-01 1 1  ON 38
eH1_9                 6.658133e-02 1 1  ON 39
eH2_0                -2.395720e-01 1 1  ON 40
eH2_1                -1.418636e-01 1 1  ON 41
eH2_2                -9.688539e-02 1 1  ON 42
eH2_3                -4.316091e-02 1 1  ON 43
eH2_4                 5.105057e-03 1 1  ON 44
eH2_5                 3.979582e-02 1 1  ON 45
eH2_6                 9.952831e-02 1 1  ON 46
eH2_7                 1.556286e-01 1 1  ON 47
eH2_8                 1.821134e-01 1 1  ON 48
eH2_9                 5.595293e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.857
    reference variance = 0.264219
====================================================
  Execution time = 2.0458e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3566e-01
  Total weights = 2.0000e+06
  Execution time = 1.8743e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335745946185
                                         uncertainty =       0.004623190479

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335745946185
                                         uncertainty =       0.004623190479

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409668566
  error estimate for blocks of size 2^( 2) =       0.000422541070
  error estimate for blocks of size 2^( 3) =       0.000435593464
  error estimate for blocks of size 2^( 4) =       0.000447471461
  error estimate for blocks of size 2^( 5) =       0.000458333192
  error estimate for blocks of size 2^( 6) =       0.000465264911
  error estimate for blocks of size 2^( 7) =       0.000468940135

      target function =                  N/A
              le_mean =     -16.905181002356
             les_mean =     286.120801222820
             stat err =       0.000460002425
             autocorr =       1.260825424386
              std dev =       0.579358842380
             le_variance =       0.335656668244

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335745946185
                                         uncertainty =       0.004623190479

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335745946185
                                         uncertainty =       0.004623190479

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409668566
  error estimate for blocks of size 2^( 2) =       0.000422541070
  error estimate for blocks of size 2^( 3) =       0.000435593464
  error estimate for blocks of size 2^( 4) =       0.000447471461
  error estimate for blocks of size 2^( 5) =       0.000458333192
  error estimate for blocks of size 2^( 6) =       0.000465264911
  error estimate for blocks of size 2^( 7) =       0.000468940135

      target function =                  N/A
              le_mean =     -16.905181002356
             les_mean =     286.120801222821
             stat err =       0.000460002425
             autocorr =       1.260825424388
              std dev =       0.579358842380
             le_variance =       0.335656668244

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335745946185
                                         uncertainty =       0.004623190479

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335745946185
                                         uncertainty =       0.004623190479

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409668566
  error estimate for blocks of size 2^( 2) =       0.000422541070
  error estimate for blocks of size 2^( 3) =       0.000435593464
  error estimate for blocks of size 2^( 4) =       0.000447471461
  error estimate for blocks of size 2^( 5) =       0.000458333192
  error estimate for blocks of size 2^( 6) =       0.000465264911
  error estimate for blocks of size 2^( 7) =       0.000468940135

      target function =                  N/A
              le_mean =     -16.905181002356
             les_mean =     286.120801222820
             stat err =       0.000460002425
             autocorr =       1.260825424386
              std dev =       0.579358842380
             le_variance =       0.335656668244

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335745946185
                                         uncertainty =       0.004623190479

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335745946185
                                         uncertainty =       0.004623190479

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409668566
  error estimate for blocks of size 2^( 2) =       0.000422541070
  error estimate for blocks of size 2^( 3) =       0.000435593464
  error estimate for blocks of size 2^( 4) =       0.000447471461
  error estimate for blocks of size 2^( 5) =       0.000458333192
  error estimate for blocks of size 2^( 6) =       0.000465264911
  error estimate for blocks of size 2^( 7) =       0.000468940135

      target function =                  N/A
              le_mean =     -16.905181002356
             les_mean =     286.120801222820
             stat err =       0.000460002425
             autocorr =       1.260825424386
              std dev =       0.579358842380
             le_variance =       0.335656668244


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905181002356        initial  <--
     2.4414e+12     2.4414e+13             2.9054e-16       -16.905181002356
     9.7656e+12     9.7656e+13             0.0000e+00       -16.905181002356
     3.9062e+13     3.9062e+14             0.0000e+00       -16.905181002356

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9403
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.092933e-01 1 1  ON 0
 uu_1                 1.425581e-01 1 1  ON 1
 uu_2                 4.090837e-02 1 1  ON 2
 uu_3                -2.150581e-02 1 1  ON 3
 uu_4                -6.690997e-02 1 1  ON 4
 uu_5                -1.013426e-01 1 1  ON 5
 uu_6                -1.282010e-01 1 1  ON 6
 uu_7                -1.411935e-01 1 1  ON 7
 uu_8                -1.329673e-01 1 1  ON 8
 uu_9                -1.043536e-01 1 1  ON 9
 ud_0                 4.443527e-01 1 1  ON 10
 ud_1                 1.801295e-01 1 1  ON 11
 ud_2                 6.325054e-02 1 1  ON 12
 ud_3                -6.192833e-03 1 1  ON 13
 ud_4                -6.411883e-02 1 1  ON 14
 ud_5                -1.066798e-01 1 1  ON 15
 ud_6                -1.344888e-01 1 1  ON 16
 ud_7                -1.516146e-01 1 1  ON 17
 ud_8                -1.521892e-01 1 1  ON 18
 ud_9                -1.426112e-01 1 1  ON 19
 eO_0                -7.585650e-01 1 1  ON 20
 eO_1                -4.404406e-01 1 1  ON 21
 eO_2                -2.262437e-02 1 1  ON 22
 eO_3                 2.977541e-01 1 1  ON 23
 eO_4                 5.252170e-01 1 1  ON 24
 eO_5                 4.870201e-01 1 1  ON 25
 eO_6                 2.596886e-01 1 1  ON 26
 eO_7                -4.096972e-02 1 1  ON 27
 eO_8                -2.205874e-01 1 1  ON 28
 eO_9                -8.532273e-02 1 1  ON 29
eH1_0                -2.414798e-01 1 1  ON 30
eH1_1                -1.440753e-01 1 1  ON 31
eH1_2                -9.924639e-02 1 1  ON 32
eH1_3                -4.540298e-02 1 1  ON 33
eH1_4                 2.880356e-03 1 1  ON 34
eH1_5                 3.773231e-02 1 1  ON 35
eH1_6                 9.700215e-02 1 1  ON 36
eH1_7                 1.538045e-01 1 1  ON 37
eH1_8                 1.762282e-01 1 1  ON 38
eH1_9                 6.658133e-02 1 1  ON 39
eH2_0                -2.395720e-01 1 1  ON 40
eH2_1                -1.418636e-01 1 1  ON 41
eH2_2                -9.688539e-02 1 1  ON 42
eH2_3                -4.316091e-02 1 1  ON 43
eH2_4                 5.105057e-03 1 1  ON 44
eH2_5                 3.979582e-02 1 1  ON 45
eH2_6                 9.952831e-02 1 1  ON 46
eH2_7                 1.556286e-01 1 1  ON 47
eH2_8                 1.821134e-01 1 1  ON 48
eH2_9                 5.595293e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6420e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6896e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.9221
    reference variance = 0.27911
====================================================
  Execution time = 2.1072e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3267e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5844e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332704177815
                                         uncertainty =       0.003324182924

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332704177815
                                         uncertainty =       0.003324182924

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407843684
  error estimate for blocks of size 2^( 2) =       0.000420680197
  error estimate for blocks of size 2^( 3) =       0.000434187621
  error estimate for blocks of size 2^( 4) =       0.000446458074
  error estimate for blocks of size 2^( 5) =       0.000457238803
  error estimate for blocks of size 2^( 6) =       0.000465821787
  error estimate for blocks of size 2^( 7) =       0.000471279418

      target function =                  N/A
              le_mean =     -16.906282650821
             les_mean =     286.155065843767
             stat err =       0.000460199521
             autocorr =       1.273224076429
              std dev =       0.576778068809
             le_variance =       0.332672940659


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690628265082e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+13, overlap shift 2.4414e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906282650821       residual = 2.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906282650821       residual = 2.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.19e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 9.7656e+13, overlap shift 9.7656e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906282650821       residual = 2.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906282650821       residual = 2.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.19e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.9062e+14, overlap shift 3.9062e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906282650821       residual = 2.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906282650821       residual = 2.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.19e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+14 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.183312 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6666e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.092933e-01 1 1  ON 0
 uu_1                 1.425581e-01 1 1  ON 1
 uu_2                 4.090837e-02 1 1  ON 2
 uu_3                -2.150581e-02 1 1  ON 3
 uu_4                -6.690997e-02 1 1  ON 4
 uu_5                -1.013426e-01 1 1  ON 5
 uu_6                -1.282010e-01 1 1  ON 6
 uu_7                -1.411935e-01 1 1  ON 7
 uu_8                -1.329673e-01 1 1  ON 8
 uu_9                -1.043536e-01 1 1  ON 9
 ud_0                 4.443527e-01 1 1  ON 10
 ud_1                 1.801295e-01 1 1  ON 11
 ud_2                 6.325054e-02 1 1  ON 12
 ud_3                -6.192833e-03 1 1  ON 13
 ud_4                -6.411883e-02 1 1  ON 14
 ud_5                -1.066798e-01 1 1  ON 15
 ud_6                -1.344888e-01 1 1  ON 16
 ud_7                -1.516146e-01 1 1  ON 17
 ud_8                -1.521892e-01 1 1  ON 18
 ud_9                -1.426112e-01 1 1  ON 19
 eO_0                -7.585650e-01 1 1  ON 20
 eO_1                -4.404406e-01 1 1  ON 21
 eO_2                -2.262437e-02 1 1  ON 22
 eO_3                 2.977541e-01 1 1  ON 23
 eO_4                 5.252170e-01 1 1  ON 24
 eO_5                 4.870201e-01 1 1  ON 25
 eO_6                 2.596886e-01 1 1  ON 26
 eO_7                -4.096972e-02 1 1  ON 27
 eO_8                -2.205874e-01 1 1  ON 28
 eO_9                -8.532273e-02 1 1  ON 29
eH1_0                -2.414798e-01 1 1  ON 30
eH1_1                -1.440753e-01 1 1  ON 31
eH1_2                -9.924639e-02 1 1  ON 32
eH1_3                -4.540298e-02 1 1  ON 33
eH1_4                 2.880356e-03 1 1  ON 34
eH1_5                 3.773231e-02 1 1  ON 35
eH1_6                 9.700215e-02 1 1  ON 36
eH1_7                 1.538045e-01 1 1  ON 37
eH1_8                 1.762282e-01 1 1  ON 38
eH1_9                 6.658133e-02 1 1  ON 39
eH2_0                -2.395720e-01 1 1  ON 40
eH2_1                -1.418636e-01 1 1  ON 41
eH2_2                -9.688539e-02 1 1  ON 42
eH2_3                -4.316091e-02 1 1  ON 43
eH2_4                 5.105057e-03 1 1  ON 44
eH2_5                 3.979582e-02 1 1  ON 45
eH2_6                 9.952831e-02 1 1  ON 46
eH2_7                 1.556286e-01 1 1  ON 47
eH2_8                 1.821134e-01 1 1  ON 48
eH2_9                 5.595293e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.9908
    reference variance = 0.982949
====================================================
  Execution time = 2.0461e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3740e-01
  Total weights = 2.0000e+06
  Execution time = 1.8720e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337436450942
                                         uncertainty =       0.003718330360

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337436450942
                                         uncertainty =       0.003718330360

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410728220
  error estimate for blocks of size 2^( 2) =       0.000423292259
  error estimate for blocks of size 2^( 3) =       0.000436293726
  error estimate for blocks of size 2^( 4) =       0.000448459888
  error estimate for blocks of size 2^( 5) =       0.000457647833
  error estimate for blocks of size 2^( 6) =       0.000465409886
  error estimate for blocks of size 2^( 7) =       0.000470076463

      target function =                  N/A
              le_mean =     -16.906091211542
             les_mean =     286.153315225817
             stat err =       0.000460398517
             autocorr =       1.256489161117
              std dev =       0.580857419281
             le_variance =       0.337395341534

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337436450942
                                         uncertainty =       0.003718330360

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337436450942
                                         uncertainty =       0.003718330360

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410728220
  error estimate for blocks of size 2^( 2) =       0.000423292259
  error estimate for blocks of size 2^( 3) =       0.000436293726
  error estimate for blocks of size 2^( 4) =       0.000448459888
  error estimate for blocks of size 2^( 5) =       0.000457647833
  error estimate for blocks of size 2^( 6) =       0.000465409886
  error estimate for blocks of size 2^( 7) =       0.000470076463

      target function =                  N/A
              le_mean =     -16.906091211542
             les_mean =     286.153315225817
             stat err =       0.000460398517
             autocorr =       1.256489161117
              std dev =       0.580857419281
             le_variance =       0.337395341534

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337436450942
                                         uncertainty =       0.003718330360

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337436450942
                                         uncertainty =       0.003718330360

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410728220
  error estimate for blocks of size 2^( 2) =       0.000423292259
  error estimate for blocks of size 2^( 3) =       0.000436293726
  error estimate for blocks of size 2^( 4) =       0.000448459888
  error estimate for blocks of size 2^( 5) =       0.000457647833
  error estimate for blocks of size 2^( 6) =       0.000465409886
  error estimate for blocks of size 2^( 7) =       0.000470076463

      target function =                  N/A
              le_mean =     -16.906091211542
             les_mean =     286.153315225817
             stat err =       0.000460398517
             autocorr =       1.256489161117
              std dev =       0.580857419281
             le_variance =       0.337395341534

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337436450942
                                         uncertainty =       0.003718330360

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337436450942
                                         uncertainty =       0.003718330360

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410728220
  error estimate for blocks of size 2^( 2) =       0.000423292259
  error estimate for blocks of size 2^( 3) =       0.000436293726
  error estimate for blocks of size 2^( 4) =       0.000448459888
  error estimate for blocks of size 2^( 5) =       0.000457647833
  error estimate for blocks of size 2^( 6) =       0.000465409886
  error estimate for blocks of size 2^( 7) =       0.000470076463

      target function =                  N/A
              le_mean =     -16.906091211542
             les_mean =     286.153315225817
             stat err =       0.000460398517
             autocorr =       1.256489161117
              std dev =       0.580857419281
             le_variance =       0.337395341534


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906091211542        initial  <--
     2.4414e+13     2.4414e+14             0.0000e+00       -16.906091211542
     9.7656e+13     9.7656e+14             0.0000e+00       -16.906091211542
     3.9062e+14     3.9062e+15             0.0000e+00       -16.906091211542

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9218
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.092933e-01 1 1  ON 0
 uu_1                 1.425581e-01 1 1  ON 1
 uu_2                 4.090837e-02 1 1  ON 2
 uu_3                -2.150581e-02 1 1  ON 3
 uu_4                -6.690997e-02 1 1  ON 4
 uu_5                -1.013426e-01 1 1  ON 5
 uu_6                -1.282010e-01 1 1  ON 6
 uu_7                -1.411935e-01 1 1  ON 7
 uu_8                -1.329673e-01 1 1  ON 8
 uu_9                -1.043536e-01 1 1  ON 9
 ud_0                 4.443527e-01 1 1  ON 10
 ud_1                 1.801295e-01 1 1  ON 11
 ud_2                 6.325054e-02 1 1  ON 12
 ud_3                -6.192833e-03 1 1  ON 13
 ud_4                -6.411883e-02 1 1  ON 14
 ud_5                -1.066798e-01 1 1  ON 15
 ud_6                -1.344888e-01 1 1  ON 16
 ud_7                -1.516146e-01 1 1  ON 17
 ud_8                -1.521892e-01 1 1  ON 18
 ud_9                -1.426112e-01 1 1  ON 19
 eO_0                -7.585650e-01 1 1  ON 20
 eO_1                -4.404406e-01 1 1  ON 21
 eO_2                -2.262437e-02 1 1  ON 22
 eO_3                 2.977541e-01 1 1  ON 23
 eO_4                 5.252170e-01 1 1  ON 24
 eO_5                 4.870201e-01 1 1  ON 25
 eO_6                 2.596886e-01 1 1  ON 26
 eO_7                -4.096972e-02 1 1  ON 27
 eO_8                -2.205874e-01 1 1  ON 28
 eO_9                -8.532273e-02 1 1  ON 29
eH1_0                -2.414798e-01 1 1  ON 30
eH1_1                -1.440753e-01 1 1  ON 31
eH1_2                -9.924639e-02 1 1  ON 32
eH1_3                -4.540298e-02 1 1  ON 33
eH1_4                 2.880356e-03 1 1  ON 34
eH1_5                 3.773231e-02 1 1  ON 35
eH1_6                 9.700215e-02 1 1  ON 36
eH1_7                 1.538045e-01 1 1  ON 37
eH1_8                 1.762282e-01 1 1  ON 38
eH1_9                 6.658133e-02 1 1  ON 39
eH2_0                -2.395720e-01 1 1  ON 40
eH2_1                -1.418636e-01 1 1  ON 41
eH2_2                -9.688539e-02 1 1  ON 42
eH2_3                -4.316091e-02 1 1  ON 43
eH2_4                 5.105057e-03 1 1  ON 44
eH2_5                 3.979582e-02 1 1  ON 45
eH2_6                 9.952831e-02 1 1  ON 46
eH2_7                 1.556286e-01 1 1  ON 47
eH2_8                 1.821134e-01 1 1  ON 48
eH2_9                 5.595293e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6594e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.9777
    reference variance = 0.415595
====================================================
  Execution time = 2.0971e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3035e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5386e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330331386434
                                         uncertainty =       0.002854508217

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330331386434
                                         uncertainty =       0.002854508217

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406418860
  error estimate for blocks of size 2^( 2) =       0.000419014392
  error estimate for blocks of size 2^( 3) =       0.000432123552
  error estimate for blocks of size 2^( 4) =       0.000444227632
  error estimate for blocks of size 2^( 5) =       0.000455408964
  error estimate for blocks of size 2^( 6) =       0.000462861127
  error estimate for blocks of size 2^( 7) =       0.000466434520

      target function =                  N/A
              le_mean =     -16.906864309793
             les_mean =     286.172413204682
             stat err =       0.000457233061
             autocorr =       1.265690563690
              std dev =       0.574763064317
             le_variance =       0.330352580104


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690686430979e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+14, overlap shift 2.4414e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906864309793       residual = 2.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906864309793       residual = 2.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.18e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+14 is 0.000000e+00

solving harmonic davidson linear method for identity shift 9.7656e+14, overlap shift 9.7656e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906864309793       residual = 2.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906864309793       residual = 2.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+14 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.9062e+15, overlap shift 3.9062e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906864309793       residual = 2.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906864309793       residual = 2.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+15 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.184365 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6519e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.092933e-01 1 1  ON 0
 uu_1                 1.425581e-01 1 1  ON 1
 uu_2                 4.090837e-02 1 1  ON 2
 uu_3                -2.150581e-02 1 1  ON 3
 uu_4                -6.690997e-02 1 1  ON 4
 uu_5                -1.013426e-01 1 1  ON 5
 uu_6                -1.282010e-01 1 1  ON 6
 uu_7                -1.411935e-01 1 1  ON 7
 uu_8                -1.329673e-01 1 1  ON 8
 uu_9                -1.043536e-01 1 1  ON 9
 ud_0                 4.443527e-01 1 1  ON 10
 ud_1                 1.801295e-01 1 1  ON 11
 ud_2                 6.325054e-02 1 1  ON 12
 ud_3                -6.192833e-03 1 1  ON 13
 ud_4                -6.411883e-02 1 1  ON 14
 ud_5                -1.066798e-01 1 1  ON 15
 ud_6                -1.344888e-01 1 1  ON 16
 ud_7                -1.516146e-01 1 1  ON 17
 ud_8                -1.521892e-01 1 1  ON 18
 ud_9                -1.426112e-01 1 1  ON 19
 eO_0                -7.585650e-01 1 1  ON 20
 eO_1                -4.404406e-01 1 1  ON 21
 eO_2                -2.262437e-02 1 1  ON 22
 eO_3                 2.977541e-01 1 1  ON 23
 eO_4                 5.252170e-01 1 1  ON 24
 eO_5                 4.870201e-01 1 1  ON 25
 eO_6                 2.596886e-01 1 1  ON 26
 eO_7                -4.096972e-02 1 1  ON 27
 eO_8                -2.205874e-01 1 1  ON 28
 eO_9                -8.532273e-02 1 1  ON 29
eH1_0                -2.414798e-01 1 1  ON 30
eH1_1                -1.440753e-01 1 1  ON 31
eH1_2                -9.924639e-02 1 1  ON 32
eH1_3                -4.540298e-02 1 1  ON 33
eH1_4                 2.880356e-03 1 1  ON 34
eH1_5                 3.773231e-02 1 1  ON 35
eH1_6                 9.700215e-02 1 1  ON 36
eH1_7                 1.538045e-01 1 1  ON 37
eH1_8                 1.762282e-01 1 1  ON 38
eH1_9                 6.658133e-02 1 1  ON 39
eH2_0                -2.395720e-01 1 1  ON 40
eH2_1                -1.418636e-01 1 1  ON 41
eH2_2                -9.688539e-02 1 1  ON 42
eH2_3                -4.316091e-02 1 1  ON 43
eH2_4                 5.105057e-03 1 1  ON 44
eH2_5                 3.979582e-02 1 1  ON 45
eH2_6                 9.952831e-02 1 1  ON 46
eH2_7                 1.556286e-01 1 1  ON 47
eH2_8                 1.821134e-01 1 1  ON 48
eH2_9                 5.595293e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.9356
    reference variance = 0.28489
====================================================
  Execution time = 2.0736e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.6034e-01
  Total weights = 2.0000e+06
  Execution time = 1.8510e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.360437069870
                                         uncertainty =       0.024409786038

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.360437069870
                                         uncertainty =       0.024409786038

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000424465438
  error estimate for blocks of size 2^( 2) =       0.000436767807
  error estimate for blocks of size 2^( 3) =       0.000450035477
  error estimate for blocks of size 2^( 4) =       0.000462677288
  error estimate for blocks of size 2^( 5) =       0.000471762883
  error estimate for blocks of size 2^( 6) =       0.000477673932
  error estimate for blocks of size 2^( 7) =       0.000480435696

      target function =                  N/A
              le_mean =     -16.905368150842
             les_mean =     286.151813951359
             stat err =       0.000473137450
             autocorr =       1.242481645266
              std dev =       0.600284779114
             le_variance =       0.360341816035

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.360437069870
                                         uncertainty =       0.024409786038

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.360437069870
                                         uncertainty =       0.024409786038

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000424465438
  error estimate for blocks of size 2^( 2) =       0.000436767807
  error estimate for blocks of size 2^( 3) =       0.000450035477
  error estimate for blocks of size 2^( 4) =       0.000462677288
  error estimate for blocks of size 2^( 5) =       0.000471762883
  error estimate for blocks of size 2^( 6) =       0.000477673932
  error estimate for blocks of size 2^( 7) =       0.000480435696

      target function =                  N/A
              le_mean =     -16.905368150842
             les_mean =     286.151813951359
             stat err =       0.000473137450
             autocorr =       1.242481645266
              std dev =       0.600284779114
             le_variance =       0.360341816035

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.360437069870
                                         uncertainty =       0.024409786038

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.360437069870
                                         uncertainty =       0.024409786038

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000424465438
  error estimate for blocks of size 2^( 2) =       0.000436767807
  error estimate for blocks of size 2^( 3) =       0.000450035477
  error estimate for blocks of size 2^( 4) =       0.000462677288
  error estimate for blocks of size 2^( 5) =       0.000471762883
  error estimate for blocks of size 2^( 6) =       0.000477673932
  error estimate for blocks of size 2^( 7) =       0.000480435696

      target function =                  N/A
              le_mean =     -16.905368150842
             les_mean =     286.151813951359
             stat err =       0.000473137450
             autocorr =       1.242481645266
              std dev =       0.600284779114
             le_variance =       0.360341816035

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.360437069870
                                         uncertainty =       0.024409786038

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.360437069870
                                         uncertainty =       0.024409786038

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000424465438
  error estimate for blocks of size 2^( 2) =       0.000436767807
  error estimate for blocks of size 2^( 3) =       0.000450035477
  error estimate for blocks of size 2^( 4) =       0.000462677288
  error estimate for blocks of size 2^( 5) =       0.000471762883
  error estimate for blocks of size 2^( 6) =       0.000477673932
  error estimate for blocks of size 2^( 7) =       0.000480435696

      target function =                  N/A
              le_mean =     -16.905368150842
             les_mean =     286.151813951359
             stat err =       0.000473137450
             autocorr =       1.242481645266
              std dev =       0.600284779114
             le_variance =       0.360341816035


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905368150842        initial  <--
     2.4414e+14     2.4414e+15             0.0000e+00       -16.905368150842
     9.7656e+14     9.7656e+15             0.0000e+00       -16.905368150842
     3.9062e+15     3.9062e+16             0.0000e+00       -16.905368150842

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.1394
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.092933e-01 1 1  ON 0
 uu_1                 1.425581e-01 1 1  ON 1
 uu_2                 4.090837e-02 1 1  ON 2
 uu_3                -2.150581e-02 1 1  ON 3
 uu_4                -6.690997e-02 1 1  ON 4
 uu_5                -1.013426e-01 1 1  ON 5
 uu_6                -1.282010e-01 1 1  ON 6
 uu_7                -1.411935e-01 1 1  ON 7
 uu_8                -1.329673e-01 1 1  ON 8
 uu_9                -1.043536e-01 1 1  ON 9
 ud_0                 4.443527e-01 1 1  ON 10
 ud_1                 1.801295e-01 1 1  ON 11
 ud_2                 6.325054e-02 1 1  ON 12
 ud_3                -6.192833e-03 1 1  ON 13
 ud_4                -6.411883e-02 1 1  ON 14
 ud_5                -1.066798e-01 1 1  ON 15
 ud_6                -1.344888e-01 1 1  ON 16
 ud_7                -1.516146e-01 1 1  ON 17
 ud_8                -1.521892e-01 1 1  ON 18
 ud_9                -1.426112e-01 1 1  ON 19
 eO_0                -7.585650e-01 1 1  ON 20
 eO_1                -4.404406e-01 1 1  ON 21
 eO_2                -2.262437e-02 1 1  ON 22
 eO_3                 2.977541e-01 1 1  ON 23
 eO_4                 5.252170e-01 1 1  ON 24
 eO_5                 4.870201e-01 1 1  ON 25
 eO_6                 2.596886e-01 1 1  ON 26
 eO_7                -4.096972e-02 1 1  ON 27
 eO_8                -2.205874e-01 1 1  ON 28
 eO_9                -8.532273e-02 1 1  ON 29
eH1_0                -2.414798e-01 1 1  ON 30
eH1_1                -1.440753e-01 1 1  ON 31
eH1_2                -9.924639e-02 1 1  ON 32
eH1_3                -4.540298e-02 1 1  ON 33
eH1_4                 2.880356e-03 1 1  ON 34
eH1_5                 3.773231e-02 1 1  ON 35
eH1_6                 9.700215e-02 1 1  ON 36
eH1_7                 1.538045e-01 1 1  ON 37
eH1_8                 1.762282e-01 1 1  ON 38
eH1_9                 6.658133e-02 1 1  ON 39
eH2_0                -2.395720e-01 1 1  ON 40
eH2_1                -1.418636e-01 1 1  ON 41
eH2_2                -9.688539e-02 1 1  ON 42
eH2_3                -4.316091e-02 1 1  ON 43
eH2_4                 5.105057e-03 1 1  ON 44
eH2_5                 3.979582e-02 1 1  ON 45
eH2_6                 9.952831e-02 1 1  ON 46
eH2_7                 1.556286e-01 1 1  ON 47
eH2_8                 1.821134e-01 1 1  ON 48
eH2_9                 5.595293e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6664e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.8918
    reference variance = 0.298098
====================================================
  Execution time = 2.2762e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3941e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5892e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338759992717
                                         uncertainty =       0.003872243473

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338759992717
                                         uncertainty =       0.003872243473

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411951340
  error estimate for blocks of size 2^( 2) =       0.000425189520
  error estimate for blocks of size 2^( 3) =       0.000438266585
  error estimate for blocks of size 2^( 4) =       0.000450147017
  error estimate for blocks of size 2^( 5) =       0.000461473919
  error estimate for blocks of size 2^( 6) =       0.000469279604
  error estimate for blocks of size 2^( 7) =       0.000474887023

      target function =                  N/A
              le_mean =     -16.906110441151
             les_mean =     286.155977892393
             stat err =       0.000463946891
             autocorr =       1.268366305726
              std dev =       0.582587172626
             le_variance =       0.339407813708


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690611044115e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+15, overlap shift 2.4414e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906110441151       residual = 2.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906110441151       residual = 2.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+15 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+15, overlap shift 9.7656e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906110441151       residual = 2.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906110441151       residual = 2.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+15 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+16, overlap shift 3.9062e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906110441151       residual = 2.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906110441151       residual = 2.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+16 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.185456 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8361e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.092933e-01 1 1  ON 0
 uu_1                 1.425581e-01 1 1  ON 1
 uu_2                 4.090837e-02 1 1  ON 2
 uu_3                -2.150581e-02 1 1  ON 3
 uu_4                -6.690997e-02 1 1  ON 4
 uu_5                -1.013426e-01 1 1  ON 5
 uu_6                -1.282010e-01 1 1  ON 6
 uu_7                -1.411935e-01 1 1  ON 7
 uu_8                -1.329673e-01 1 1  ON 8
 uu_9                -1.043536e-01 1 1  ON 9
 ud_0                 4.443527e-01 1 1  ON 10
 ud_1                 1.801295e-01 1 1  ON 11
 ud_2                 6.325054e-02 1 1  ON 12
 ud_3                -6.192833e-03 1 1  ON 13
 ud_4                -6.411883e-02 1 1  ON 14
 ud_5                -1.066798e-01 1 1  ON 15
 ud_6                -1.344888e-01 1 1  ON 16
 ud_7                -1.516146e-01 1 1  ON 17
 ud_8                -1.521892e-01 1 1  ON 18
 ud_9                -1.426112e-01 1 1  ON 19
 eO_0                -7.585650e-01 1 1  ON 20
 eO_1                -4.404406e-01 1 1  ON 21
 eO_2                -2.262437e-02 1 1  ON 22
 eO_3                 2.977541e-01 1 1  ON 23
 eO_4                 5.252170e-01 1 1  ON 24
 eO_5                 4.870201e-01 1 1  ON 25
 eO_6                 2.596886e-01 1 1  ON 26
 eO_7                -4.096972e-02 1 1  ON 27
 eO_8                -2.205874e-01 1 1  ON 28
 eO_9                -8.532273e-02 1 1  ON 29
eH1_0                -2.414798e-01 1 1  ON 30
eH1_1                -1.440753e-01 1 1  ON 31
eH1_2                -9.924639e-02 1 1  ON 32
eH1_3                -4.540298e-02 1 1  ON 33
eH1_4                 2.880356e-03 1 1  ON 34
eH1_5                 3.773231e-02 1 1  ON 35
eH1_6                 9.700215e-02 1 1  ON 36
eH1_7                 1.538045e-01 1 1  ON 37
eH1_8                 1.762282e-01 1 1  ON 38
eH1_9                 6.658133e-02 1 1  ON 39
eH2_0                -2.395720e-01 1 1  ON 40
eH2_1                -1.418636e-01 1 1  ON 41
eH2_2                -9.688539e-02 1 1  ON 42
eH2_3                -4.316091e-02 1 1  ON 43
eH2_4                 5.105057e-03 1 1  ON 44
eH2_5                 3.979582e-02 1 1  ON 45
eH2_6                 9.952831e-02 1 1  ON 46
eH2_7                 1.556286e-01 1 1  ON 47
eH2_8                 1.821134e-01 1 1  ON 48
eH2_9                 5.595293e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.9355
    reference variance = 0.170304
====================================================
  Execution time = 2.0558e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3713e-01
  Total weights = 2.0000e+06
  Execution time = 1.8772e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337161366184
                                         uncertainty =       0.003979024834

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337161366184
                                         uncertainty =       0.003979024834

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410565549
  error estimate for blocks of size 2^( 2) =       0.000422616617
  error estimate for blocks of size 2^( 3) =       0.000435115592
  error estimate for blocks of size 2^( 4) =       0.000446800073
  error estimate for blocks of size 2^( 5) =       0.000457541010
  error estimate for blocks of size 2^( 6) =       0.000465629459
  error estimate for blocks of size 2^( 7) =       0.000469505497

      target function =                  N/A
              le_mean =     -16.905512567768
             les_mean =     286.133483150600
             stat err =       0.000459869010
             autocorr =       1.254594208844
              std dev =       0.580627367773
             le_variance =       0.337128140207

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337161366184
                                         uncertainty =       0.003979024834

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337161366184
                                         uncertainty =       0.003979024834

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410565549
  error estimate for blocks of size 2^( 2) =       0.000422616617
  error estimate for blocks of size 2^( 3) =       0.000435115592
  error estimate for blocks of size 2^( 4) =       0.000446800073
  error estimate for blocks of size 2^( 5) =       0.000457541010
  error estimate for blocks of size 2^( 6) =       0.000465629459
  error estimate for blocks of size 2^( 7) =       0.000469505497

      target function =                  N/A
              le_mean =     -16.905512567768
             les_mean =     286.133483150600
             stat err =       0.000459869010
             autocorr =       1.254594208844
              std dev =       0.580627367773
             le_variance =       0.337128140207

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337161366184
                                         uncertainty =       0.003979024834

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337161366184
                                         uncertainty =       0.003979024834

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410565549
  error estimate for blocks of size 2^( 2) =       0.000422616617
  error estimate for blocks of size 2^( 3) =       0.000435115592
  error estimate for blocks of size 2^( 4) =       0.000446800073
  error estimate for blocks of size 2^( 5) =       0.000457541010
  error estimate for blocks of size 2^( 6) =       0.000465629459
  error estimate for blocks of size 2^( 7) =       0.000469505497

      target function =                  N/A
              le_mean =     -16.905512567768
             les_mean =     286.133483150600
             stat err =       0.000459869010
             autocorr =       1.254594208844
              std dev =       0.580627367773
             le_variance =       0.337128140207

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337161366184
                                         uncertainty =       0.003979024834

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337161366184
                                         uncertainty =       0.003979024834

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410565549
  error estimate for blocks of size 2^( 2) =       0.000422616617
  error estimate for blocks of size 2^( 3) =       0.000435115592
  error estimate for blocks of size 2^( 4) =       0.000446800073
  error estimate for blocks of size 2^( 5) =       0.000457541010
  error estimate for blocks of size 2^( 6) =       0.000465629459
  error estimate for blocks of size 2^( 7) =       0.000469505497

      target function =                  N/A
              le_mean =     -16.905512567768
             les_mean =     286.133483150600
             stat err =       0.000459869010
             autocorr =       1.254594208844
              std dev =       0.580627367773
             le_variance =       0.337128140207


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905512567768        initial  <--
     2.4414e+15     2.4414e+16             0.0000e+00       -16.905512567768
     9.7656e+15     9.7656e+16             0.0000e+00       -16.905512567768
     3.9062e+16     3.9062e+17             0.0000e+00       -16.905512567768

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.1492
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.092933e-01 1 1  ON 0
 uu_1                 1.425581e-01 1 1  ON 1
 uu_2                 4.090837e-02 1 1  ON 2
 uu_3                -2.150581e-02 1 1  ON 3
 uu_4                -6.690997e-02 1 1  ON 4
 uu_5                -1.013426e-01 1 1  ON 5
 uu_6                -1.282010e-01 1 1  ON 6
 uu_7                -1.411935e-01 1 1  ON 7
 uu_8                -1.329673e-01 1 1  ON 8
 uu_9                -1.043536e-01 1 1  ON 9
 ud_0                 4.443527e-01 1 1  ON 10
 ud_1                 1.801295e-01 1 1  ON 11
 ud_2                 6.325054e-02 1 1  ON 12
 ud_3                -6.192833e-03 1 1  ON 13
 ud_4                -6.411883e-02 1 1  ON 14
 ud_5                -1.066798e-01 1 1  ON 15
 ud_6                -1.344888e-01 1 1  ON 16
 ud_7                -1.516146e-01 1 1  ON 17
 ud_8                -1.521892e-01 1 1  ON 18
 ud_9                -1.426112e-01 1 1  ON 19
 eO_0                -7.585650e-01 1 1  ON 20
 eO_1                -4.404406e-01 1 1  ON 21
 eO_2                -2.262437e-02 1 1  ON 22
 eO_3                 2.977541e-01 1 1  ON 23
 eO_4                 5.252170e-01 1 1  ON 24
 eO_5                 4.870201e-01 1 1  ON 25
 eO_6                 2.596886e-01 1 1  ON 26
 eO_7                -4.096972e-02 1 1  ON 27
 eO_8                -2.205874e-01 1 1  ON 28
 eO_9                -8.532273e-02 1 1  ON 29
eH1_0                -2.414798e-01 1 1  ON 30
eH1_1                -1.440753e-01 1 1  ON 31
eH1_2                -9.924639e-02 1 1  ON 32
eH1_3                -4.540298e-02 1 1  ON 33
eH1_4                 2.880356e-03 1 1  ON 34
eH1_5                 3.773231e-02 1 1  ON 35
eH1_6                 9.700215e-02 1 1  ON 36
eH1_7                 1.538045e-01 1 1  ON 37
eH1_8                 1.762282e-01 1 1  ON 38
eH1_9                 6.658133e-02 1 1  ON 39
eH2_0                -2.395720e-01 1 1  ON 40
eH2_1                -1.418636e-01 1 1  ON 41
eH2_2                -9.688539e-02 1 1  ON 42
eH2_3                -4.316091e-02 1 1  ON 43
eH2_4                 5.105057e-03 1 1  ON 44
eH2_5                 3.979582e-02 1 1  ON 45
eH2_6                 9.952831e-02 1 1  ON 46
eH2_7                 1.556286e-01 1 1  ON 47
eH2_8                 1.821134e-01 1 1  ON 48
eH2_9                 5.595293e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8516e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.9802
    reference variance = 0.332906
====================================================
  Execution time = 2.1022e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3292e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5316e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332917603988
                                         uncertainty =       0.003075298771

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332917603988
                                         uncertainty =       0.003075298771

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407994416
  error estimate for blocks of size 2^( 2) =       0.000420431363
  error estimate for blocks of size 2^( 3) =       0.000433770705
  error estimate for blocks of size 2^( 4) =       0.000445917224
  error estimate for blocks of size 2^( 5) =       0.000456605973
  error estimate for blocks of size 2^( 6) =       0.000464003646
  error estimate for blocks of size 2^( 7) =       0.000467811406

      target function =                  N/A
              le_mean =     -16.905692674086
             les_mean =     286.135363510959
             stat err =       0.000458584563
             autocorr =       1.263369603476
              std dev =       0.576991236317
             le_variance =       0.332918886787


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690569267409e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+16, overlap shift 2.4414e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905692674086       residual = 1.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905692674086       residual = 2.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905692674086       residual = 7.22e+00           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -13.582383726394       residual = 9.02e+03           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+16 is 1.034274e-20

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+16, overlap shift 9.7656e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905692674086       residual = 1.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905692674086       residual = 2.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905692674085       residual = 2.51e+00           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+16 is 2.585684e-21

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+17, overlap shift 3.9062e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905692674086       residual = 1.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905692674086       residual = 2.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905692674086       residual = 2.06e+00           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905692674084       residual = 2.93e-02           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+17 is 6.464211e-22

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.187034 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6564e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.092933e-01 1 1  ON 0
 uu_1                 1.425581e-01 1 1  ON 1
 uu_2                 4.090837e-02 1 1  ON 2
 uu_3                -2.150581e-02 1 1  ON 3
 uu_4                -6.690997e-02 1 1  ON 4
 uu_5                -1.013426e-01 1 1  ON 5
 uu_6                -1.282010e-01 1 1  ON 6
 uu_7                -1.411935e-01 1 1  ON 7
 uu_8                -1.329673e-01 1 1  ON 8
 uu_9                -1.043536e-01 1 1  ON 9
 ud_0                 4.443527e-01 1 1  ON 10
 ud_1                 1.801295e-01 1 1  ON 11
 ud_2                 6.325054e-02 1 1  ON 12
 ud_3                -6.192833e-03 1 1  ON 13
 ud_4                -6.411883e-02 1 1  ON 14
 ud_5                -1.066798e-01 1 1  ON 15
 ud_6                -1.344888e-01 1 1  ON 16
 ud_7                -1.516146e-01 1 1  ON 17
 ud_8                -1.521892e-01 1 1  ON 18
 ud_9                -1.426112e-01 1 1  ON 19
 eO_0                -7.585650e-01 1 1  ON 20
 eO_1                -4.404406e-01 1 1  ON 21
 eO_2                -2.262437e-02 1 1  ON 22
 eO_3                 2.977541e-01 1 1  ON 23
 eO_4                 5.252170e-01 1 1  ON 24
 eO_5                 4.870201e-01 1 1  ON 25
 eO_6                 2.596886e-01 1 1  ON 26
 eO_7                -4.096972e-02 1 1  ON 27
 eO_8                -2.205874e-01 1 1  ON 28
 eO_9                -8.532273e-02 1 1  ON 29
eH1_0                -2.414798e-01 1 1  ON 30
eH1_1                -1.440753e-01 1 1  ON 31
eH1_2                -9.924639e-02 1 1  ON 32
eH1_3                -4.540298e-02 1 1  ON 33
eH1_4                 2.880356e-03 1 1  ON 34
eH1_5                 3.773231e-02 1 1  ON 35
eH1_6                 9.700215e-02 1 1  ON 36
eH1_7                 1.538045e-01 1 1  ON 37
eH1_8                 1.762282e-01 1 1  ON 38
eH1_9                 6.658133e-02 1 1  ON 39
eH2_0                -2.395720e-01 1 1  ON 40
eH2_1                -1.418636e-01 1 1  ON 41
eH2_2                -9.688539e-02 1 1  ON 42
eH2_3                -4.316091e-02 1 1  ON 43
eH2_4                 5.105057e-03 1 1  ON 44
eH2_5                 3.979582e-02 1 1  ON 45
eH2_6                 9.952831e-02 1 1  ON 46
eH2_7                 1.556286e-01 1 1  ON 47
eH2_8                 1.821134e-01 1 1  ON 48
eH2_9                 5.595293e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.9275
    reference variance = 0.221134
====================================================
  Execution time = 2.0445e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3511e-01
  Total weights = 2.0000e+06
  Execution time = 1.8774e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335206223206
                                         uncertainty =       0.002889295508

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335206223206
                                         uncertainty =       0.002889295508

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409335611
  error estimate for blocks of size 2^( 2) =       0.000421653327
  error estimate for blocks of size 2^( 3) =       0.000435100453
  error estimate for blocks of size 2^( 4) =       0.000446687887
  error estimate for blocks of size 2^( 5) =       0.000457483195
  error estimate for blocks of size 2^( 6) =       0.000463025179
  error estimate for blocks of size 2^( 7) =       0.000468647207

      target function =                  N/A
              le_mean =     -16.905790091653
             les_mean =     286.140849740621
             stat err =       0.000458960867
             autocorr =       1.257164928231
              std dev =       0.578887972875
             le_variance =       0.335111285139

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335206223206
                                         uncertainty =       0.002889295508

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335206223206
                                         uncertainty =       0.002889295508

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409335611
  error estimate for blocks of size 2^( 2) =       0.000421653327
  error estimate for blocks of size 2^( 3) =       0.000435100453
  error estimate for blocks of size 2^( 4) =       0.000446687887
  error estimate for blocks of size 2^( 5) =       0.000457483195
  error estimate for blocks of size 2^( 6) =       0.000463025179
  error estimate for blocks of size 2^( 7) =       0.000468647207

      target function =                  N/A
              le_mean =     -16.905790091653
             les_mean =     286.140849740621
             stat err =       0.000458960867
             autocorr =       1.257164928231
              std dev =       0.578887972875
             le_variance =       0.335111285139

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335206223206
                                         uncertainty =       0.002889295508

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335206223206
                                         uncertainty =       0.002889295508

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409335611
  error estimate for blocks of size 2^( 2) =       0.000421653327
  error estimate for blocks of size 2^( 3) =       0.000435100453
  error estimate for blocks of size 2^( 4) =       0.000446687887
  error estimate for blocks of size 2^( 5) =       0.000457483195
  error estimate for blocks of size 2^( 6) =       0.000463025179
  error estimate for blocks of size 2^( 7) =       0.000468647207

      target function =                  N/A
              le_mean =     -16.905790091653
             les_mean =     286.140849740621
             stat err =       0.000458960867
             autocorr =       1.257164928231
              std dev =       0.578887972875
             le_variance =       0.335111285139

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335206223206
                                         uncertainty =       0.002889295508

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335206223206
                                         uncertainty =       0.002889295508

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409335611
  error estimate for blocks of size 2^( 2) =       0.000421653327
  error estimate for blocks of size 2^( 3) =       0.000435100453
  error estimate for blocks of size 2^( 4) =       0.000446687887
  error estimate for blocks of size 2^( 5) =       0.000457483195
  error estimate for blocks of size 2^( 6) =       0.000463025179
  error estimate for blocks of size 2^( 7) =       0.000468647207

      target function =                  N/A
              le_mean =     -16.905790091653
             les_mean =     286.140849740621
             stat err =       0.000458960867
             autocorr =       1.257164928231
              std dev =       0.578887972875
             le_variance =       0.335111285139


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905790091653        initial  <--
     2.4414e+16     2.4414e+17             1.0343e-20       -16.905790091653
     9.7656e+16     9.7656e+17             2.5857e-21       -16.905790091653
     3.9062e+17     3.9062e+18             6.4642e-22       -16.905790091653

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9246
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.092933e-01 1 1  ON 0
 uu_1                 1.425581e-01 1 1  ON 1
 uu_2                 4.090837e-02 1 1  ON 2
 uu_3                -2.150581e-02 1 1  ON 3
 uu_4                -6.690997e-02 1 1  ON 4
 uu_5                -1.013426e-01 1 1  ON 5
 uu_6                -1.282010e-01 1 1  ON 6
 uu_7                -1.411935e-01 1 1  ON 7
 uu_8                -1.329673e-01 1 1  ON 8
 uu_9                -1.043536e-01 1 1  ON 9
 ud_0                 4.443527e-01 1 1  ON 10
 ud_1                 1.801295e-01 1 1  ON 11
 ud_2                 6.325054e-02 1 1  ON 12
 ud_3                -6.192833e-03 1 1  ON 13
 ud_4                -6.411883e-02 1 1  ON 14
 ud_5                -1.066798e-01 1 1  ON 15
 ud_6                -1.344888e-01 1 1  ON 16
 ud_7                -1.516146e-01 1 1  ON 17
 ud_8                -1.521892e-01 1 1  ON 18
 ud_9                -1.426112e-01 1 1  ON 19
 eO_0                -7.585650e-01 1 1  ON 20
 eO_1                -4.404406e-01 1 1  ON 21
 eO_2                -2.262437e-02 1 1  ON 22
 eO_3                 2.977541e-01 1 1  ON 23
 eO_4                 5.252170e-01 1 1  ON 24
 eO_5                 4.870201e-01 1 1  ON 25
 eO_6                 2.596886e-01 1 1  ON 26
 eO_7                -4.096972e-02 1 1  ON 27
 eO_8                -2.205874e-01 1 1  ON 28
 eO_9                -8.532273e-02 1 1  ON 29
eH1_0                -2.414798e-01 1 1  ON 30
eH1_1                -1.440753e-01 1 1  ON 31
eH1_2                -9.924639e-02 1 1  ON 32
eH1_3                -4.540298e-02 1 1  ON 33
eH1_4                 2.880356e-03 1 1  ON 34
eH1_5                 3.773231e-02 1 1  ON 35
eH1_6                 9.700215e-02 1 1  ON 36
eH1_7                 1.538045e-01 1 1  ON 37
eH1_8                 1.762282e-01 1 1  ON 38
eH1_9                 6.658133e-02 1 1  ON 39
eH2_0                -2.395720e-01 1 1  ON 40
eH2_1                -1.418636e-01 1 1  ON 41
eH2_2                -9.688539e-02 1 1  ON 42
eH2_3                -4.316091e-02 1 1  ON 43
eH2_4                 5.105057e-03 1 1  ON 44
eH2_5                 3.979582e-02 1 1  ON 45
eH2_6                 9.952831e-02 1 1  ON 46
eH2_7                 1.556286e-01 1 1  ON 47
eH2_8                 1.821134e-01 1 1  ON 48
eH2_9                 5.595293e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6494e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.9614
    reference variance = 0.23158
====================================================
  Execution time = 2.2884e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3354e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7402e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333561338951
                                         uncertainty =       0.003394843003

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333561338951
                                         uncertainty =       0.003394843003

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408372455
  error estimate for blocks of size 2^( 2) =       0.000421263138
  error estimate for blocks of size 2^( 3) =       0.000434411163
  error estimate for blocks of size 2^( 4) =       0.000447455397
  error estimate for blocks of size 2^( 5) =       0.000459115717
  error estimate for blocks of size 2^( 6) =       0.000468272952
  error estimate for blocks of size 2^( 7) =       0.000474627826

      target function =                  N/A
              le_mean =     -16.905106661459
             les_mean =     286.116167191911
             stat err =       0.000462367973
             autocorr =       1.281924970227
              std dev =       0.577525863824
             le_variance =       0.333536123386


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690510666146e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+17, overlap shift 2.4414e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905106661459       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905106661459       residual = 3.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905106661459       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+17 is 2.053034e-21

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+17, overlap shift 9.7656e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905106661459       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905106661459       residual = 3.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905106661459       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -11.005042216228       residual = 4.57e+03           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+17 is 5.132585e-22

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+18, overlap shift 3.9062e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905106661459       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905106661459       residual = 3.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905106661459       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+18 is 1.283146e-22

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.188494 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8635e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.092933e-01 1 1  ON 0
 uu_1                 1.425581e-01 1 1  ON 1
 uu_2                 4.090837e-02 1 1  ON 2
 uu_3                -2.150581e-02 1 1  ON 3
 uu_4                -6.690997e-02 1 1  ON 4
 uu_5                -1.013426e-01 1 1  ON 5
 uu_6                -1.282010e-01 1 1  ON 6
 uu_7                -1.411935e-01 1 1  ON 7
 uu_8                -1.329673e-01 1 1  ON 8
 uu_9                -1.043536e-01 1 1  ON 9
 ud_0                 4.443527e-01 1 1  ON 10
 ud_1                 1.801295e-01 1 1  ON 11
 ud_2                 6.325054e-02 1 1  ON 12
 ud_3                -6.192833e-03 1 1  ON 13
 ud_4                -6.411883e-02 1 1  ON 14
 ud_5                -1.066798e-01 1 1  ON 15
 ud_6                -1.344888e-01 1 1  ON 16
 ud_7                -1.516146e-01 1 1  ON 17
 ud_8                -1.521892e-01 1 1  ON 18
 ud_9                -1.426112e-01 1 1  ON 19
 eO_0                -7.585650e-01 1 1  ON 20
 eO_1                -4.404406e-01 1 1  ON 21
 eO_2                -2.262437e-02 1 1  ON 22
 eO_3                 2.977541e-01 1 1  ON 23
 eO_4                 5.252170e-01 1 1  ON 24
 eO_5                 4.870201e-01 1 1  ON 25
 eO_6                 2.596886e-01 1 1  ON 26
 eO_7                -4.096972e-02 1 1  ON 27
 eO_8                -2.205874e-01 1 1  ON 28
 eO_9                -8.532273e-02 1 1  ON 29
eH1_0                -2.414798e-01 1 1  ON 30
eH1_1                -1.440753e-01 1 1  ON 31
eH1_2                -9.924639e-02 1 1  ON 32
eH1_3                -4.540298e-02 1 1  ON 33
eH1_4                 2.880356e-03 1 1  ON 34
eH1_5                 3.773231e-02 1 1  ON 35
eH1_6                 9.700215e-02 1 1  ON 36
eH1_7                 1.538045e-01 1 1  ON 37
eH1_8                 1.762282e-01 1 1  ON 38
eH1_9                 6.658133e-02 1 1  ON 39
eH2_0                -2.395720e-01 1 1  ON 40
eH2_1                -1.418636e-01 1 1  ON 41
eH2_2                -9.688539e-02 1 1  ON 42
eH2_3                -4.316091e-02 1 1  ON 43
eH2_4                 5.105057e-03 1 1  ON 44
eH2_5                 3.979582e-02 1 1  ON 45
eH2_6                 9.952831e-02 1 1  ON 46
eH2_7                 1.556286e-01 1 1  ON 47
eH2_8                 1.821134e-01 1 1  ON 48
eH2_9                 5.595293e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.957
    reference variance = 0.423435
====================================================
  Execution time = 2.0360e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5678e-01
  Total weights = 2.0000e+06
  Execution time = 1.8566e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356444516426
                                         uncertainty =       0.017197257160

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356444516426
                                         uncertainty =       0.017197257160

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422365154
  error estimate for blocks of size 2^( 2) =       0.000434742044
  error estimate for blocks of size 2^( 3) =       0.000446966546
  error estimate for blocks of size 2^( 4) =       0.000458243905
  error estimate for blocks of size 2^( 5) =       0.000467996920
  error estimate for blocks of size 2^( 6) =       0.000473194744
  error estimate for blocks of size 2^( 7) =       0.000475498642

      target function =                  N/A
              le_mean =     -16.905910971497
             les_mean =     286.166610244193
             stat err =       0.000468733553
             autocorr =       1.231617703784
              std dev =       0.597314528876
             le_variance =       0.356784646406

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356444516426
                                         uncertainty =       0.017197257160

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356444516426
                                         uncertainty =       0.017197257160

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422365154
  error estimate for blocks of size 2^( 2) =       0.000434742044
  error estimate for blocks of size 2^( 3) =       0.000446966546
  error estimate for blocks of size 2^( 4) =       0.000458243905
  error estimate for blocks of size 2^( 5) =       0.000467996920
  error estimate for blocks of size 2^( 6) =       0.000473194744
  error estimate for blocks of size 2^( 7) =       0.000475498642

      target function =                  N/A
              le_mean =     -16.905910971497
             les_mean =     286.166610244193
             stat err =       0.000468733553
             autocorr =       1.231617703784
              std dev =       0.597314528876
             le_variance =       0.356784646406

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356444516426
                                         uncertainty =       0.017197257160

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356444516426
                                         uncertainty =       0.017197257160

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422365154
  error estimate for blocks of size 2^( 2) =       0.000434742044
  error estimate for blocks of size 2^( 3) =       0.000446966546
  error estimate for blocks of size 2^( 4) =       0.000458243905
  error estimate for blocks of size 2^( 5) =       0.000467996920
  error estimate for blocks of size 2^( 6) =       0.000473194744
  error estimate for blocks of size 2^( 7) =       0.000475498642

      target function =                  N/A
              le_mean =     -16.905910971497
             les_mean =     286.166610244193
             stat err =       0.000468733553
             autocorr =       1.231617703784
              std dev =       0.597314528876
             le_variance =       0.356784646406

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356444516426
                                         uncertainty =       0.017197257160

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356444516426
                                         uncertainty =       0.017197257160

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422365154
  error estimate for blocks of size 2^( 2) =       0.000434742044
  error estimate for blocks of size 2^( 3) =       0.000446966546
  error estimate for blocks of size 2^( 4) =       0.000458243905
  error estimate for blocks of size 2^( 5) =       0.000467996920
  error estimate for blocks of size 2^( 6) =       0.000473194744
  error estimate for blocks of size 2^( 7) =       0.000475498642

      target function =                  N/A
              le_mean =     -16.905910971497
             les_mean =     286.166610244193
             stat err =       0.000468733553
             autocorr =       1.231617703784
              std dev =       0.597314528876
             le_variance =       0.356784646406


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905910971497        initial  <--
     2.4414e+17     2.4414e+18             2.0530e-21       -16.905910971497
     9.7656e+17     9.7656e+18             5.1326e-22       -16.905910971497
     3.9062e+18     3.9062e+19             1.2831e-22       -16.905910971497

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7485
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.092933e-01 1 1  ON 0
 uu_1                 1.425581e-01 1 1  ON 1
 uu_2                 4.090837e-02 1 1  ON 2
 uu_3                -2.150581e-02 1 1  ON 3
 uu_4                -6.690997e-02 1 1  ON 4
 uu_5                -1.013426e-01 1 1  ON 5
 uu_6                -1.282010e-01 1 1  ON 6
 uu_7                -1.411935e-01 1 1  ON 7
 uu_8                -1.329673e-01 1 1  ON 8
 uu_9                -1.043536e-01 1 1  ON 9
 ud_0                 4.443527e-01 1 1  ON 10
 ud_1                 1.801295e-01 1 1  ON 11
 ud_2                 6.325054e-02 1 1  ON 12
 ud_3                -6.192833e-03 1 1  ON 13
 ud_4                -6.411883e-02 1 1  ON 14
 ud_5                -1.066798e-01 1 1  ON 15
 ud_6                -1.344888e-01 1 1  ON 16
 ud_7                -1.516146e-01 1 1  ON 17
 ud_8                -1.521892e-01 1 1  ON 18
 ud_9                -1.426112e-01 1 1  ON 19
 eO_0                -7.585650e-01 1 1  ON 20
 eO_1                -4.404406e-01 1 1  ON 21
 eO_2                -2.262437e-02 1 1  ON 22
 eO_3                 2.977541e-01 1 1  ON 23
 eO_4                 5.252170e-01 1 1  ON 24
 eO_5                 4.870201e-01 1 1  ON 25
 eO_6                 2.596886e-01 1 1  ON 26
 eO_7                -4.096972e-02 1 1  ON 27
 eO_8                -2.205874e-01 1 1  ON 28
 eO_9                -8.532273e-02 1 1  ON 29
eH1_0                -2.414798e-01 1 1  ON 30
eH1_1                -1.440753e-01 1 1  ON 31
eH1_2                -9.924639e-02 1 1  ON 32
eH1_3                -4.540298e-02 1 1  ON 33
eH1_4                 2.880356e-03 1 1  ON 34
eH1_5                 3.773231e-02 1 1  ON 35
eH1_6                 9.700215e-02 1 1  ON 36
eH1_7                 1.538045e-01 1 1  ON 37
eH1_8                 1.762282e-01 1 1  ON 38
eH1_9                 6.658133e-02 1 1  ON 39
eH2_0                -2.395720e-01 1 1  ON 40
eH2_1                -1.418636e-01 1 1  ON 41
eH2_2                -9.688539e-02 1 1  ON 42
eH2_3                -4.316091e-02 1 1  ON 43
eH2_4                 5.105057e-03 1 1  ON 44
eH2_5                 3.979582e-02 1 1  ON 45
eH2_6                 9.952831e-02 1 1  ON 46
eH2_7                 1.556286e-01 1 1  ON 47
eH2_8                 1.821134e-01 1 1  ON 48
eH2_9                 5.595293e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8389e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.966
    reference variance = 0.324948
====================================================
  Execution time = 2.1152e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3643e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4998e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336410820588
                                         uncertainty =       0.004346241940

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336410820588
                                         uncertainty =       0.004346241940

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410141107
  error estimate for blocks of size 2^( 2) =       0.000423132327
  error estimate for blocks of size 2^( 3) =       0.000436313878
  error estimate for blocks of size 2^( 4) =       0.000448352277
  error estimate for blocks of size 2^( 5) =       0.000458204720
  error estimate for blocks of size 2^( 6) =       0.000466199877
  error estimate for blocks of size 2^( 7) =       0.000471937610

      target function =                  N/A
              le_mean =     -16.905487044594
             les_mean =     286.131923501303
             stat err =       0.000461173621
             autocorr =       1.264335459649
              std dev =       0.580027115378
             le_variance =       0.336431454574


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690548704459e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+18, overlap shift 2.4414e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905487044594       residual = 2.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905487044594       residual = 2.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+18, overlap shift 9.7656e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905487044594       residual = 2.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905487044594       residual = 2.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+19, overlap shift 3.9062e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905487044594       residual = 2.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905487044594       residual = 2.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.189581 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6662e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.092933e-01 1 1  ON 0
 uu_1                 1.425581e-01 1 1  ON 1
 uu_2                 4.090837e-02 1 1  ON 2
 uu_3                -2.150581e-02 1 1  ON 3
 uu_4                -6.690997e-02 1 1  ON 4
 uu_5                -1.013426e-01 1 1  ON 5
 uu_6                -1.282010e-01 1 1  ON 6
 uu_7                -1.411935e-01 1 1  ON 7
 uu_8                -1.329673e-01 1 1  ON 8
 uu_9                -1.043536e-01 1 1  ON 9
 ud_0                 4.443527e-01 1 1  ON 10
 ud_1                 1.801295e-01 1 1  ON 11
 ud_2                 6.325054e-02 1 1  ON 12
 ud_3                -6.192833e-03 1 1  ON 13
 ud_4                -6.411883e-02 1 1  ON 14
 ud_5                -1.066798e-01 1 1  ON 15
 ud_6                -1.344888e-01 1 1  ON 16
 ud_7                -1.516146e-01 1 1  ON 17
 ud_8                -1.521892e-01 1 1  ON 18
 ud_9                -1.426112e-01 1 1  ON 19
 eO_0                -7.585650e-01 1 1  ON 20
 eO_1                -4.404406e-01 1 1  ON 21
 eO_2                -2.262437e-02 1 1  ON 22
 eO_3                 2.977541e-01 1 1  ON 23
 eO_4                 5.252170e-01 1 1  ON 24
 eO_5                 4.870201e-01 1 1  ON 25
 eO_6                 2.596886e-01 1 1  ON 26
 eO_7                -4.096972e-02 1 1  ON 27
 eO_8                -2.205874e-01 1 1  ON 28
 eO_9                -8.532273e-02 1 1  ON 29
eH1_0                -2.414798e-01 1 1  ON 30
eH1_1                -1.440753e-01 1 1  ON 31
eH1_2                -9.924639e-02 1 1  ON 32
eH1_3                -4.540298e-02 1 1  ON 33
eH1_4                 2.880356e-03 1 1  ON 34
eH1_5                 3.773231e-02 1 1  ON 35
eH1_6                 9.700215e-02 1 1  ON 36
eH1_7                 1.538045e-01 1 1  ON 37
eH1_8                 1.762282e-01 1 1  ON 38
eH1_9                 6.658133e-02 1 1  ON 39
eH2_0                -2.395720e-01 1 1  ON 40
eH2_1                -1.418636e-01 1 1  ON 41
eH2_2                -9.688539e-02 1 1  ON 42
eH2_3                -4.316091e-02 1 1  ON 43
eH2_4                 5.105057e-03 1 1  ON 44
eH2_5                 3.979582e-02 1 1  ON 45
eH2_6                 9.952831e-02 1 1  ON 46
eH2_7                 1.556286e-01 1 1  ON 47
eH2_8                 1.821134e-01 1 1  ON 48
eH2_9                 5.595293e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.9351
    reference variance = 0.184702
====================================================
  Execution time = 2.0608e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3409e-01
  Total weights = 2.0000e+06
  Execution time = 1.8735e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334051423066
                                         uncertainty =       0.004400327263

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334051423066
                                         uncertainty =       0.004400327263

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408712390
  error estimate for blocks of size 2^( 2) =       0.000421159954
  error estimate for blocks of size 2^( 3) =       0.000433566860
  error estimate for blocks of size 2^( 4) =       0.000445400068
  error estimate for blocks of size 2^( 5) =       0.000455744018
  error estimate for blocks of size 2^( 6) =       0.000461862561
  error estimate for blocks of size 2^( 7) =       0.000462302643

      target function =                  N/A
              le_mean =     -16.906388211058
             les_mean =     286.160053810886
             stat err =       0.000456327322
             autocorr =       1.246571918655
              std dev =       0.578006604579
             le_variance =       0.334091634937

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334051423066
                                         uncertainty =       0.004400327263

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334051423066
                                         uncertainty =       0.004400327263

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408712390
  error estimate for blocks of size 2^( 2) =       0.000421159954
  error estimate for blocks of size 2^( 3) =       0.000433566860
  error estimate for blocks of size 2^( 4) =       0.000445400068
  error estimate for blocks of size 2^( 5) =       0.000455744018
  error estimate for blocks of size 2^( 6) =       0.000461862561
  error estimate for blocks of size 2^( 7) =       0.000462302643

      target function =                  N/A
              le_mean =     -16.906388211058
             les_mean =     286.160053810886
             stat err =       0.000456327322
             autocorr =       1.246571918655
              std dev =       0.578006604579
             le_variance =       0.334091634937

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334051423066
                                         uncertainty =       0.004400327263

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334051423066
                                         uncertainty =       0.004400327263

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408712390
  error estimate for blocks of size 2^( 2) =       0.000421159954
  error estimate for blocks of size 2^( 3) =       0.000433566860
  error estimate for blocks of size 2^( 4) =       0.000445400068
  error estimate for blocks of size 2^( 5) =       0.000455744018
  error estimate for blocks of size 2^( 6) =       0.000461862561
  error estimate for blocks of size 2^( 7) =       0.000462302643

      target function =                  N/A
              le_mean =     -16.906388211058
             les_mean =     286.160053810886
             stat err =       0.000456327322
             autocorr =       1.246571918655
              std dev =       0.578006604579
             le_variance =       0.334091634937

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334051423066
                                         uncertainty =       0.004400327263

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334051423066
                                         uncertainty =       0.004400327263

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408712390
  error estimate for blocks of size 2^( 2) =       0.000421159954
  error estimate for blocks of size 2^( 3) =       0.000433566860
  error estimate for blocks of size 2^( 4) =       0.000445400068
  error estimate for blocks of size 2^( 5) =       0.000455744018
  error estimate for blocks of size 2^( 6) =       0.000461862561
  error estimate for blocks of size 2^( 7) =       0.000462302643

      target function =                  N/A
              le_mean =     -16.906388211058
             les_mean =     286.160053810886
             stat err =       0.000456327322
             autocorr =       1.246571918655
              std dev =       0.578006604579
             le_variance =       0.334091634937


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906388211058        initial  <--
     2.4414e+18     2.4414e+19             0.0000e+00       -16.906388211058
     9.7656e+18     9.7656e+19             0.0000e+00       -16.906388211058
     3.9062e+19     3.9062e+20             0.0000e+00       -16.906388211058

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0727
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.092933e-01 1 1  ON 0
 uu_1                 1.425581e-01 1 1  ON 1
 uu_2                 4.090837e-02 1 1  ON 2
 uu_3                -2.150581e-02 1 1  ON 3
 uu_4                -6.690997e-02 1 1  ON 4
 uu_5                -1.013426e-01 1 1  ON 5
 uu_6                -1.282010e-01 1 1  ON 6
 uu_7                -1.411935e-01 1 1  ON 7
 uu_8                -1.329673e-01 1 1  ON 8
 uu_9                -1.043536e-01 1 1  ON 9
 ud_0                 4.443527e-01 1 1  ON 10
 ud_1                 1.801295e-01 1 1  ON 11
 ud_2                 6.325054e-02 1 1  ON 12
 ud_3                -6.192833e-03 1 1  ON 13
 ud_4                -6.411883e-02 1 1  ON 14
 ud_5                -1.066798e-01 1 1  ON 15
 ud_6                -1.344888e-01 1 1  ON 16
 ud_7                -1.516146e-01 1 1  ON 17
 ud_8                -1.521892e-01 1 1  ON 18
 ud_9                -1.426112e-01 1 1  ON 19
 eO_0                -7.585650e-01 1 1  ON 20
 eO_1                -4.404406e-01 1 1  ON 21
 eO_2                -2.262437e-02 1 1  ON 22
 eO_3                 2.977541e-01 1 1  ON 23
 eO_4                 5.252170e-01 1 1  ON 24
 eO_5                 4.870201e-01 1 1  ON 25
 eO_6                 2.596886e-01 1 1  ON 26
 eO_7                -4.096972e-02 1 1  ON 27
 eO_8                -2.205874e-01 1 1  ON 28
 eO_9                -8.532273e-02 1 1  ON 29
eH1_0                -2.414798e-01 1 1  ON 30
eH1_1                -1.440753e-01 1 1  ON 31
eH1_2                -9.924639e-02 1 1  ON 32
eH1_3                -4.540298e-02 1 1  ON 33
eH1_4                 2.880356e-03 1 1  ON 34
eH1_5                 3.773231e-02 1 1  ON 35
eH1_6                 9.700215e-02 1 1  ON 36
eH1_7                 1.538045e-01 1 1  ON 37
eH1_8                 1.762282e-01 1 1  ON 38
eH1_9                 6.658133e-02 1 1  ON 39
eH2_0                -2.395720e-01 1 1  ON 40
eH2_1                -1.418636e-01 1 1  ON 41
eH2_2                -9.688539e-02 1 1  ON 42
eH2_3                -4.316091e-02 1 1  ON 43
eH2_4                 5.105057e-03 1 1  ON 44
eH2_5                 3.979582e-02 1 1  ON 45
eH2_6                 9.952831e-02 1 1  ON 46
eH2_7                 1.556286e-01 1 1  ON 47
eH2_8                 1.821134e-01 1 1  ON 48
eH2_9                 5.595293e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6740e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.894
    reference variance = 0.272911
====================================================
  Execution time = 2.0994e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3451e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4491e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334449816363
                                         uncertainty =       0.004345871201

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334449816363
                                         uncertainty =       0.004345871201

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408965383
  error estimate for blocks of size 2^( 2) =       0.000421953061
  error estimate for blocks of size 2^( 3) =       0.000435349458
  error estimate for blocks of size 2^( 4) =       0.000447536344
  error estimate for blocks of size 2^( 5) =       0.000458483453
  error estimate for blocks of size 2^( 6) =       0.000463845245
  error estimate for blocks of size 2^( 7) =       0.000470709116

      target function =                  N/A
              le_mean =     -16.906193723245
             les_mean =     286.153891409197
             stat err =       0.000460143539
             autocorr =       1.265941278273
              std dev =       0.578364390817
             le_variance =       0.334505368565


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690619372324e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+19, overlap shift 2.4414e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906193723245       residual = 2.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906193723245       residual = 2.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+19, overlap shift 9.7656e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906193723245       residual = 2.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906193723245       residual = 2.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+20, overlap shift 3.9062e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906193723245       residual = 2.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906193723245       residual = 2.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.190655 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6453e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.092933e-01 1 1  ON 0
 uu_1                 1.425581e-01 1 1  ON 1
 uu_2                 4.090837e-02 1 1  ON 2
 uu_3                -2.150581e-02 1 1  ON 3
 uu_4                -6.690997e-02 1 1  ON 4
 uu_5                -1.013426e-01 1 1  ON 5
 uu_6                -1.282010e-01 1 1  ON 6
 uu_7                -1.411935e-01 1 1  ON 7
 uu_8                -1.329673e-01 1 1  ON 8
 uu_9                -1.043536e-01 1 1  ON 9
 ud_0                 4.443527e-01 1 1  ON 10
 ud_1                 1.801295e-01 1 1  ON 11
 ud_2                 6.325054e-02 1 1  ON 12
 ud_3                -6.192833e-03 1 1  ON 13
 ud_4                -6.411883e-02 1 1  ON 14
 ud_5                -1.066798e-01 1 1  ON 15
 ud_6                -1.344888e-01 1 1  ON 16
 ud_7                -1.516146e-01 1 1  ON 17
 ud_8                -1.521892e-01 1 1  ON 18
 ud_9                -1.426112e-01 1 1  ON 19
 eO_0                -7.585650e-01 1 1  ON 20
 eO_1                -4.404406e-01 1 1  ON 21
 eO_2                -2.262437e-02 1 1  ON 22
 eO_3                 2.977541e-01 1 1  ON 23
 eO_4                 5.252170e-01 1 1  ON 24
 eO_5                 4.870201e-01 1 1  ON 25
 eO_6                 2.596886e-01 1 1  ON 26
 eO_7                -4.096972e-02 1 1  ON 27
 eO_8                -2.205874e-01 1 1  ON 28
 eO_9                -8.532273e-02 1 1  ON 29
eH1_0                -2.414798e-01 1 1  ON 30
eH1_1                -1.440753e-01 1 1  ON 31
eH1_2                -9.924639e-02 1 1  ON 32
eH1_3                -4.540298e-02 1 1  ON 33
eH1_4                 2.880356e-03 1 1  ON 34
eH1_5                 3.773231e-02 1 1  ON 35
eH1_6                 9.700215e-02 1 1  ON 36
eH1_7                 1.538045e-01 1 1  ON 37
eH1_8                 1.762282e-01 1 1  ON 38
eH1_9                 6.658133e-02 1 1  ON 39
eH2_0                -2.395720e-01 1 1  ON 40
eH2_1                -1.418636e-01 1 1  ON 41
eH2_2                -9.688539e-02 1 1  ON 42
eH2_3                -4.316091e-02 1 1  ON 43
eH2_4                 5.105057e-03 1 1  ON 44
eH2_5                 3.979582e-02 1 1  ON 45
eH2_6                 9.952831e-02 1 1  ON 46
eH2_7                 1.556286e-01 1 1  ON 47
eH2_8                 1.821134e-01 1 1  ON 48
eH2_9                 5.595293e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.8662
    reference variance = 0.195793
====================================================
  Execution time = 2.0636e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5043e-01
  Total weights = 2.0000e+06
  Execution time = 1.8610e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350521775408
                                         uncertainty =       0.016561294746

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350521775408
                                         uncertainty =       0.016561294746

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418588070
  error estimate for blocks of size 2^( 2) =       0.000431213729
  error estimate for blocks of size 2^( 3) =       0.000444394669
  error estimate for blocks of size 2^( 4) =       0.000456079257
  error estimate for blocks of size 2^( 5) =       0.000466214607
  error estimate for blocks of size 2^( 6) =       0.000473330480
  error estimate for blocks of size 2^( 7) =       0.000476381586

      target function =                  N/A
              le_mean =     -16.905911864771
             les_mean =     286.160287748245
             stat err =       0.000468001483
             autocorr =       1.250030948820
              std dev =       0.591972925107
             le_variance =       0.350431944060

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350521775408
                                         uncertainty =       0.016561294746

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350521775408
                                         uncertainty =       0.016561294746

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418588070
  error estimate for blocks of size 2^( 2) =       0.000431213729
  error estimate for blocks of size 2^( 3) =       0.000444394669
  error estimate for blocks of size 2^( 4) =       0.000456079257
  error estimate for blocks of size 2^( 5) =       0.000466214607
  error estimate for blocks of size 2^( 6) =       0.000473330480
  error estimate for blocks of size 2^( 7) =       0.000476381586

      target function =                  N/A
              le_mean =     -16.905911864771
             les_mean =     286.160287748245
             stat err =       0.000468001483
             autocorr =       1.250030948820
              std dev =       0.591972925107
             le_variance =       0.350431944060

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350521775408
                                         uncertainty =       0.016561294746

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350521775408
                                         uncertainty =       0.016561294746

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418588070
  error estimate for blocks of size 2^( 2) =       0.000431213729
  error estimate for blocks of size 2^( 3) =       0.000444394669
  error estimate for blocks of size 2^( 4) =       0.000456079257
  error estimate for blocks of size 2^( 5) =       0.000466214607
  error estimate for blocks of size 2^( 6) =       0.000473330480
  error estimate for blocks of size 2^( 7) =       0.000476381586

      target function =                  N/A
              le_mean =     -16.905911864771
             les_mean =     286.160287748245
             stat err =       0.000468001483
             autocorr =       1.250030948820
              std dev =       0.591972925107
             le_variance =       0.350431944060

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350521775408
                                         uncertainty =       0.016561294746

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350521775408
                                         uncertainty =       0.016561294746

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418588070
  error estimate for blocks of size 2^( 2) =       0.000431213729
  error estimate for blocks of size 2^( 3) =       0.000444394669
  error estimate for blocks of size 2^( 4) =       0.000456079257
  error estimate for blocks of size 2^( 5) =       0.000466214607
  error estimate for blocks of size 2^( 6) =       0.000473330480
  error estimate for blocks of size 2^( 7) =       0.000476381586

      target function =                  N/A
              le_mean =     -16.905911864771
             les_mean =     286.160287748245
             stat err =       0.000468001483
             autocorr =       1.250030948820
              std dev =       0.591972925107
             le_variance =       0.350431944060


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905911864771        initial  <--
     2.4414e+19     2.4414e+20             0.0000e+00       -16.905911864771
     9.7656e+19     9.7656e+20             0.0000e+00       -16.905911864771
     3.9062e+20     3.9062e+21             0.0000e+00       -16.905911864771

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0438
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.092933e-01 1 1  ON 0
 uu_1                 1.425581e-01 1 1  ON 1
 uu_2                 4.090837e-02 1 1  ON 2
 uu_3                -2.150581e-02 1 1  ON 3
 uu_4                -6.690997e-02 1 1  ON 4
 uu_5                -1.013426e-01 1 1  ON 5
 uu_6                -1.282010e-01 1 1  ON 6
 uu_7                -1.411935e-01 1 1  ON 7
 uu_8                -1.329673e-01 1 1  ON 8
 uu_9                -1.043536e-01 1 1  ON 9
 ud_0                 4.443527e-01 1 1  ON 10
 ud_1                 1.801295e-01 1 1  ON 11
 ud_2                 6.325054e-02 1 1  ON 12
 ud_3                -6.192833e-03 1 1  ON 13
 ud_4                -6.411883e-02 1 1  ON 14
 ud_5                -1.066798e-01 1 1  ON 15
 ud_6                -1.344888e-01 1 1  ON 16
 ud_7                -1.516146e-01 1 1  ON 17
 ud_8                -1.521892e-01 1 1  ON 18
 ud_9                -1.426112e-01 1 1  ON 19
 eO_0                -7.585650e-01 1 1  ON 20
 eO_1                -4.404406e-01 1 1  ON 21
 eO_2                -2.262437e-02 1 1  ON 22
 eO_3                 2.977541e-01 1 1  ON 23
 eO_4                 5.252170e-01 1 1  ON 24
 eO_5                 4.870201e-01 1 1  ON 25
 eO_6                 2.596886e-01 1 1  ON 26
 eO_7                -4.096972e-02 1 1  ON 27
 eO_8                -2.205874e-01 1 1  ON 28
 eO_9                -8.532273e-02 1 1  ON 29
eH1_0                -2.414798e-01 1 1  ON 30
eH1_1                -1.440753e-01 1 1  ON 31
eH1_2                -9.924639e-02 1 1  ON 32
eH1_3                -4.540298e-02 1 1  ON 33
eH1_4                 2.880356e-03 1 1  ON 34
eH1_5                 3.773231e-02 1 1  ON 35
eH1_6                 9.700215e-02 1 1  ON 36
eH1_7                 1.538045e-01 1 1  ON 37
eH1_8                 1.762282e-01 1 1  ON 38
eH1_9                 6.658133e-02 1 1  ON 39
eH2_0                -2.395720e-01 1 1  ON 40
eH2_1                -1.418636e-01 1 1  ON 41
eH2_2                -9.688539e-02 1 1  ON 42
eH2_3                -4.316091e-02 1 1  ON 43
eH2_4                 5.105057e-03 1 1  ON 44
eH2_5                 3.979582e-02 1 1  ON 45
eH2_6                 9.952831e-02 1 1  ON 46
eH2_7                 1.556286e-01 1 1  ON 47
eH2_8                 1.821134e-01 1 1  ON 48
eH2_9                 5.595293e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6502e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.8738
    reference variance = 0.140363
====================================================
  Execution time = 2.2719e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3633e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5265e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336397317576
                                         uncertainty =       0.003367842556

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336397317576
                                         uncertainty =       0.003367842556

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410076826
  error estimate for blocks of size 2^( 2) =       0.000422626502
  error estimate for blocks of size 2^( 3) =       0.000435035607
  error estimate for blocks of size 2^( 4) =       0.000446507841
  error estimate for blocks of size 2^( 5) =       0.000457408567
  error estimate for blocks of size 2^( 6) =       0.000463914209
  error estimate for blocks of size 2^( 7) =       0.000470692185

      target function =                  N/A
              le_mean =     -16.905987927619
             les_mean =     286.148753646485
             stat err =       0.000459630700
             autocorr =       1.256283350940
              std dev =       0.579936208433
             le_variance =       0.336326005852


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690598792762e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+20, overlap shift 2.4414e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905987927619       residual = 2.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905987927619       residual = 2.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905987927619       residual = 5.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905987927619       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+20 is 2.425520e-24

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+20, overlap shift 9.7656e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905987927619       residual = 2.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905987927619       residual = 2.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905987927619       residual = 2.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+20 is 2.720564e-25

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+21, overlap shift 3.9062e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905987927619       residual = 2.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905987927619       residual = 2.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905987927619       residual = 5.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905987927619       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905987927619       residual = 2.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+21 is 1.515950e-25

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.192300 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8256e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.092933e-01 1 1  ON 0
 uu_1                 1.425581e-01 1 1  ON 1
 uu_2                 4.090837e-02 1 1  ON 2
 uu_3                -2.150581e-02 1 1  ON 3
 uu_4                -6.690997e-02 1 1  ON 4
 uu_5                -1.013426e-01 1 1  ON 5
 uu_6                -1.282010e-01 1 1  ON 6
 uu_7                -1.411935e-01 1 1  ON 7
 uu_8                -1.329673e-01 1 1  ON 8
 uu_9                -1.043536e-01 1 1  ON 9
 ud_0                 4.443527e-01 1 1  ON 10
 ud_1                 1.801295e-01 1 1  ON 11
 ud_2                 6.325054e-02 1 1  ON 12
 ud_3                -6.192833e-03 1 1  ON 13
 ud_4                -6.411883e-02 1 1  ON 14
 ud_5                -1.066798e-01 1 1  ON 15
 ud_6                -1.344888e-01 1 1  ON 16
 ud_7                -1.516146e-01 1 1  ON 17
 ud_8                -1.521892e-01 1 1  ON 18
 ud_9                -1.426112e-01 1 1  ON 19
 eO_0                -7.585650e-01 1 1  ON 20
 eO_1                -4.404406e-01 1 1  ON 21
 eO_2                -2.262437e-02 1 1  ON 22
 eO_3                 2.977541e-01 1 1  ON 23
 eO_4                 5.252170e-01 1 1  ON 24
 eO_5                 4.870201e-01 1 1  ON 25
 eO_6                 2.596886e-01 1 1  ON 26
 eO_7                -4.096972e-02 1 1  ON 27
 eO_8                -2.205874e-01 1 1  ON 28
 eO_9                -8.532273e-02 1 1  ON 29
eH1_0                -2.414798e-01 1 1  ON 30
eH1_1                -1.440753e-01 1 1  ON 31
eH1_2                -9.924639e-02 1 1  ON 32
eH1_3                -4.540298e-02 1 1  ON 33
eH1_4                 2.880356e-03 1 1  ON 34
eH1_5                 3.773231e-02 1 1  ON 35
eH1_6                 9.700215e-02 1 1  ON 36
eH1_7                 1.538045e-01 1 1  ON 37
eH1_8                 1.762282e-01 1 1  ON 38
eH1_9                 6.658133e-02 1 1  ON 39
eH2_0                -2.395720e-01 1 1  ON 40
eH2_1                -1.418636e-01 1 1  ON 41
eH2_2                -9.688539e-02 1 1  ON 42
eH2_3                -4.316091e-02 1 1  ON 43
eH2_4                 5.105057e-03 1 1  ON 44
eH2_5                 3.979582e-02 1 1  ON 45
eH2_6                 9.952831e-02 1 1  ON 46
eH2_7                 1.556286e-01 1 1  ON 47
eH2_8                 1.821134e-01 1 1  ON 48
eH2_9                 5.595293e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.8243
    reference variance = 0.391189
====================================================
  Execution time = 2.0352e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3623e-01
  Total weights = 2.0000e+06
  Execution time = 1.8654e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336127443397
                                         uncertainty =       0.005559194263

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336127443397
                                         uncertainty =       0.005559194263

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410019512
  error estimate for blocks of size 2^( 2) =       0.000422194864
  error estimate for blocks of size 2^( 3) =       0.000435393365
  error estimate for blocks of size 2^( 4) =       0.000447895663
  error estimate for blocks of size 2^( 5) =       0.000458904961
  error estimate for blocks of size 2^( 6) =       0.000467108773
  error estimate for blocks of size 2^( 7) =       0.000470582762

      target function =                  N/A
              le_mean =     -16.905741994359
             les_mean =     286.140344211864
             stat err =       0.000461123040
             autocorr =       1.264807976109
              std dev =       0.579855154463
             le_variance =       0.336232000158

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336127443397
                                         uncertainty =       0.005559194263

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336127443397
                                         uncertainty =       0.005559194263

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410019512
  error estimate for blocks of size 2^( 2) =       0.000422194864
  error estimate for blocks of size 2^( 3) =       0.000435393365
  error estimate for blocks of size 2^( 4) =       0.000447895663
  error estimate for blocks of size 2^( 5) =       0.000458904961
  error estimate for blocks of size 2^( 6) =       0.000467108773
  error estimate for blocks of size 2^( 7) =       0.000470582762

      target function =                  N/A
              le_mean =     -16.905741994359
             les_mean =     286.140344211864
             stat err =       0.000461123040
             autocorr =       1.264807976109
              std dev =       0.579855154463
             le_variance =       0.336232000158

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336127443397
                                         uncertainty =       0.005559194263

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336127443397
                                         uncertainty =       0.005559194263

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410019512
  error estimate for blocks of size 2^( 2) =       0.000422194864
  error estimate for blocks of size 2^( 3) =       0.000435393365
  error estimate for blocks of size 2^( 4) =       0.000447895663
  error estimate for blocks of size 2^( 5) =       0.000458904961
  error estimate for blocks of size 2^( 6) =       0.000467108773
  error estimate for blocks of size 2^( 7) =       0.000470582762

      target function =                  N/A
              le_mean =     -16.905741994359
             les_mean =     286.140344211864
             stat err =       0.000461123040
             autocorr =       1.264807976109
              std dev =       0.579855154463
             le_variance =       0.336232000158

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336127443397
                                         uncertainty =       0.005559194263

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336127443397
                                         uncertainty =       0.005559194263

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410019512
  error estimate for blocks of size 2^( 2) =       0.000422194864
  error estimate for blocks of size 2^( 3) =       0.000435393365
  error estimate for blocks of size 2^( 4) =       0.000447895663
  error estimate for blocks of size 2^( 5) =       0.000458904961
  error estimate for blocks of size 2^( 6) =       0.000467108773
  error estimate for blocks of size 2^( 7) =       0.000470582762

      target function =                  N/A
              le_mean =     -16.905741994359
             les_mean =     286.140344211864
             stat err =       0.000461123040
             autocorr =       1.264807976109
              std dev =       0.579855154463
             le_variance =       0.336232000158


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905741994359        initial  <--
     2.4414e+20     2.4414e+21             2.4255e-24       -16.905741994359
     9.7656e+20     9.7656e+21             2.7206e-25       -16.905741994359
     3.9062e+21     3.9062e+22             1.5160e-25       -16.905741994359

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7807
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.092933e-01 1 1  ON 0
 uu_1                 1.425581e-01 1 1  ON 1
 uu_2                 4.090837e-02 1 1  ON 2
 uu_3                -2.150581e-02 1 1  ON 3
 uu_4                -6.690997e-02 1 1  ON 4
 uu_5                -1.013426e-01 1 1  ON 5
 uu_6                -1.282010e-01 1 1  ON 6
 uu_7                -1.411935e-01 1 1  ON 7
 uu_8                -1.329673e-01 1 1  ON 8
 uu_9                -1.043536e-01 1 1  ON 9
 ud_0                 4.443527e-01 1 1  ON 10
 ud_1                 1.801295e-01 1 1  ON 11
 ud_2                 6.325054e-02 1 1  ON 12
 ud_3                -6.192833e-03 1 1  ON 13
 ud_4                -6.411883e-02 1 1  ON 14
 ud_5                -1.066798e-01 1 1  ON 15
 ud_6                -1.344888e-01 1 1  ON 16
 ud_7                -1.516146e-01 1 1  ON 17
 ud_8                -1.521892e-01 1 1  ON 18
 ud_9                -1.426112e-01 1 1  ON 19
 eO_0                -7.585650e-01 1 1  ON 20
 eO_1                -4.404406e-01 1 1  ON 21
 eO_2                -2.262437e-02 1 1  ON 22
 eO_3                 2.977541e-01 1 1  ON 23
 eO_4                 5.252170e-01 1 1  ON 24
 eO_5                 4.870201e-01 1 1  ON 25
 eO_6                 2.596886e-01 1 1  ON 26
 eO_7                -4.096972e-02 1 1  ON 27
 eO_8                -2.205874e-01 1 1  ON 28
 eO_9                -8.532273e-02 1 1  ON 29
eH1_0                -2.414798e-01 1 1  ON 30
eH1_1                -1.440753e-01 1 1  ON 31
eH1_2                -9.924639e-02 1 1  ON 32
eH1_3                -4.540298e-02 1 1  ON 33
eH1_4                 2.880356e-03 1 1  ON 34
eH1_5                 3.773231e-02 1 1  ON 35
eH1_6                 9.700215e-02 1 1  ON 36
eH1_7                 1.538045e-01 1 1  ON 37
eH1_8                 1.762282e-01 1 1  ON 38
eH1_9                 6.658133e-02 1 1  ON 39
eH2_0                -2.395720e-01 1 1  ON 40
eH2_1                -1.418636e-01 1 1  ON 41
eH2_2                -9.688539e-02 1 1  ON 42
eH2_3                -4.316091e-02 1 1  ON 43
eH2_4                 5.105057e-03 1 1  ON 44
eH2_5                 3.979582e-02 1 1  ON 45
eH2_6                 9.952831e-02 1 1  ON 46
eH2_7                 1.556286e-01 1 1  ON 47
eH2_8                 1.821134e-01 1 1  ON 48
eH2_9                 5.595293e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8043e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.9373
    reference variance = 0.24331
====================================================
  Execution time = 2.0970e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3415e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5825e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334216385128
                                         uncertainty =       0.003421501150

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334216385128
                                         uncertainty =       0.003421501150

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408750173
  error estimate for blocks of size 2^( 2) =       0.000421842854
  error estimate for blocks of size 2^( 3) =       0.000435323370
  error estimate for blocks of size 2^( 4) =       0.000447417746
  error estimate for blocks of size 2^( 5) =       0.000458292212
  error estimate for blocks of size 2^( 6) =       0.000466720491
  error estimate for blocks of size 2^( 7) =       0.000473030980

      target function =                  N/A
              le_mean =     -16.906209735756
             les_mean =     286.154080870478
             stat err =       0.000461365357
             autocorr =       1.274013598303
              std dev =       0.578060038557
             le_variance =       0.334153408177


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690620973576e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+21, overlap shift 2.4414e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906209735756       residual = 2.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906209735756       residual = 2.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+21, overlap shift 9.7656e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906209735756       residual = 2.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906209735756       residual = 2.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+22, overlap shift 3.9062e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906209735756       residual = 2.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906209735756       residual = 2.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.193370 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6563e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.092933e-01 1 1  ON 0
 uu_1                 1.425581e-01 1 1  ON 1
 uu_2                 4.090837e-02 1 1  ON 2
 uu_3                -2.150581e-02 1 1  ON 3
 uu_4                -6.690997e-02 1 1  ON 4
 uu_5                -1.013426e-01 1 1  ON 5
 uu_6                -1.282010e-01 1 1  ON 6
 uu_7                -1.411935e-01 1 1  ON 7
 uu_8                -1.329673e-01 1 1  ON 8
 uu_9                -1.043536e-01 1 1  ON 9
 ud_0                 4.443527e-01 1 1  ON 10
 ud_1                 1.801295e-01 1 1  ON 11
 ud_2                 6.325054e-02 1 1  ON 12
 ud_3                -6.192833e-03 1 1  ON 13
 ud_4                -6.411883e-02 1 1  ON 14
 ud_5                -1.066798e-01 1 1  ON 15
 ud_6                -1.344888e-01 1 1  ON 16
 ud_7                -1.516146e-01 1 1  ON 17
 ud_8                -1.521892e-01 1 1  ON 18
 ud_9                -1.426112e-01 1 1  ON 19
 eO_0                -7.585650e-01 1 1  ON 20
 eO_1                -4.404406e-01 1 1  ON 21
 eO_2                -2.262437e-02 1 1  ON 22
 eO_3                 2.977541e-01 1 1  ON 23
 eO_4                 5.252170e-01 1 1  ON 24
 eO_5                 4.870201e-01 1 1  ON 25
 eO_6                 2.596886e-01 1 1  ON 26
 eO_7                -4.096972e-02 1 1  ON 27
 eO_8                -2.205874e-01 1 1  ON 28
 eO_9                -8.532273e-02 1 1  ON 29
eH1_0                -2.414798e-01 1 1  ON 30
eH1_1                -1.440753e-01 1 1  ON 31
eH1_2                -9.924639e-02 1 1  ON 32
eH1_3                -4.540298e-02 1 1  ON 33
eH1_4                 2.880356e-03 1 1  ON 34
eH1_5                 3.773231e-02 1 1  ON 35
eH1_6                 9.700215e-02 1 1  ON 36
eH1_7                 1.538045e-01 1 1  ON 37
eH1_8                 1.762282e-01 1 1  ON 38
eH1_9                 6.658133e-02 1 1  ON 39
eH2_0                -2.395720e-01 1 1  ON 40
eH2_1                -1.418636e-01 1 1  ON 41
eH2_2                -9.688539e-02 1 1  ON 42
eH2_3                -4.316091e-02 1 1  ON 43
eH2_4                 5.105057e-03 1 1  ON 44
eH2_5                 3.979582e-02 1 1  ON 45
eH2_6                 9.952831e-02 1 1  ON 46
eH2_7                 1.556286e-01 1 1  ON 47
eH2_8                 1.821134e-01 1 1  ON 48
eH2_9                 5.595293e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.9206
    reference variance = 0.252392
====================================================
  Execution time = 2.0380e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4121e-01
  Total weights = 2.0000e+06
  Execution time = 1.8752e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341328363198
                                         uncertainty =       0.006321168781

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341328363198
                                         uncertainty =       0.006321168781

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413043357
  error estimate for blocks of size 2^( 2) =       0.000425635491
  error estimate for blocks of size 2^( 3) =       0.000438325785
  error estimate for blocks of size 2^( 4) =       0.000450165949
  error estimate for blocks of size 2^( 5) =       0.000460356392
  error estimate for blocks of size 2^( 6) =       0.000467743287
  error estimate for blocks of size 2^( 7) =       0.000470073740

      target function =                  N/A
              le_mean =     -16.905422649450
             les_mean =     286.134524414742
             stat err =       0.000462084842
             autocorr =       1.251561405212
              std dev =       0.584131516696
             le_variance =       0.341209628797

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341328363198
                                         uncertainty =       0.006321168781

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341328363198
                                         uncertainty =       0.006321168781

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413043357
  error estimate for blocks of size 2^( 2) =       0.000425635491
  error estimate for blocks of size 2^( 3) =       0.000438325785
  error estimate for blocks of size 2^( 4) =       0.000450165949
  error estimate for blocks of size 2^( 5) =       0.000460356392
  error estimate for blocks of size 2^( 6) =       0.000467743287
  error estimate for blocks of size 2^( 7) =       0.000470073740

      target function =                  N/A
              le_mean =     -16.905422649450
             les_mean =     286.134524414742
             stat err =       0.000462084842
             autocorr =       1.251561405212
              std dev =       0.584131516696
             le_variance =       0.341209628797

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341328363198
                                         uncertainty =       0.006321168781

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341328363198
                                         uncertainty =       0.006321168781

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413043357
  error estimate for blocks of size 2^( 2) =       0.000425635491
  error estimate for blocks of size 2^( 3) =       0.000438325785
  error estimate for blocks of size 2^( 4) =       0.000450165949
  error estimate for blocks of size 2^( 5) =       0.000460356392
  error estimate for blocks of size 2^( 6) =       0.000467743287
  error estimate for blocks of size 2^( 7) =       0.000470073740

      target function =                  N/A
              le_mean =     -16.905422649450
             les_mean =     286.134524414742
             stat err =       0.000462084842
             autocorr =       1.251561405212
              std dev =       0.584131516696
             le_variance =       0.341209628797

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341328363198
                                         uncertainty =       0.006321168781

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341328363198
                                         uncertainty =       0.006321168781

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413043357
  error estimate for blocks of size 2^( 2) =       0.000425635491
  error estimate for blocks of size 2^( 3) =       0.000438325785
  error estimate for blocks of size 2^( 4) =       0.000450165949
  error estimate for blocks of size 2^( 5) =       0.000460356392
  error estimate for blocks of size 2^( 6) =       0.000467743287
  error estimate for blocks of size 2^( 7) =       0.000470073740

      target function =                  N/A
              le_mean =     -16.905422649450
             les_mean =     286.134524414742
             stat err =       0.000462084842
             autocorr =       1.251561405212
              std dev =       0.584131516696
             le_variance =       0.341209628797


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905422649450        initial  <--
     2.4414e+21     2.4414e+22             0.0000e+00       -16.905422649450
     9.7656e+21     9.7656e+22             0.0000e+00       -16.905422649450
     3.9062e+22     3.9062e+23             0.0000e+00       -16.905422649450

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8866
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.092933e-01 1 1  ON 0
 uu_1                 1.425581e-01 1 1  ON 1
 uu_2                 4.090837e-02 1 1  ON 2
 uu_3                -2.150581e-02 1 1  ON 3
 uu_4                -6.690997e-02 1 1  ON 4
 uu_5                -1.013426e-01 1 1  ON 5
 uu_6                -1.282010e-01 1 1  ON 6
 uu_7                -1.411935e-01 1 1  ON 7
 uu_8                -1.329673e-01 1 1  ON 8
 uu_9                -1.043536e-01 1 1  ON 9
 ud_0                 4.443527e-01 1 1  ON 10
 ud_1                 1.801295e-01 1 1  ON 11
 ud_2                 6.325054e-02 1 1  ON 12
 ud_3                -6.192833e-03 1 1  ON 13
 ud_4                -6.411883e-02 1 1  ON 14
 ud_5                -1.066798e-01 1 1  ON 15
 ud_6                -1.344888e-01 1 1  ON 16
 ud_7                -1.516146e-01 1 1  ON 17
 ud_8                -1.521892e-01 1 1  ON 18
 ud_9                -1.426112e-01 1 1  ON 19
 eO_0                -7.585650e-01 1 1  ON 20
 eO_1                -4.404406e-01 1 1  ON 21
 eO_2                -2.262437e-02 1 1  ON 22
 eO_3                 2.977541e-01 1 1  ON 23
 eO_4                 5.252170e-01 1 1  ON 24
 eO_5                 4.870201e-01 1 1  ON 25
 eO_6                 2.596886e-01 1 1  ON 26
 eO_7                -4.096972e-02 1 1  ON 27
 eO_8                -2.205874e-01 1 1  ON 28
 eO_9                -8.532273e-02 1 1  ON 29
eH1_0                -2.414798e-01 1 1  ON 30
eH1_1                -1.440753e-01 1 1  ON 31
eH1_2                -9.924639e-02 1 1  ON 32
eH1_3                -4.540298e-02 1 1  ON 33
eH1_4                 2.880356e-03 1 1  ON 34
eH1_5                 3.773231e-02 1 1  ON 35
eH1_6                 9.700215e-02 1 1  ON 36
eH1_7                 1.538045e-01 1 1  ON 37
eH1_8                 1.762282e-01 1 1  ON 38
eH1_9                 6.658133e-02 1 1  ON 39
eH2_0                -2.395720e-01 1 1  ON 40
eH2_1                -1.418636e-01 1 1  ON 41
eH2_2                -9.688539e-02 1 1  ON 42
eH2_3                -4.316091e-02 1 1  ON 43
eH2_4                 5.105057e-03 1 1  ON 44
eH2_5                 3.979582e-02 1 1  ON 45
eH2_6                 9.952831e-02 1 1  ON 46
eH2_7                 1.556286e-01 1 1  ON 47
eH2_8                 1.821134e-01 1 1  ON 48
eH2_9                 5.595293e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6455e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.8499
    reference variance = 0.499943
====================================================
  Execution time = 2.0793e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4068e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7342e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340700458353
                                         uncertainty =       0.006850682382

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340700458353
                                         uncertainty =       0.006850682382

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412722399
  error estimate for blocks of size 2^( 2) =       0.000425488407
  error estimate for blocks of size 2^( 3) =       0.000438463139
  error estimate for blocks of size 2^( 4) =       0.000450365400
  error estimate for blocks of size 2^( 5) =       0.000461424681
  error estimate for blocks of size 2^( 6) =       0.000469989597
  error estimate for blocks of size 2^( 7) =       0.000476391007

      target function =                  N/A
              le_mean =     -16.905753958555
             les_mean =     286.145196293844
             stat err =       0.000464542671
             autocorr =       1.266879030479
              std dev =       0.583677613916
             le_variance =       0.340679556987


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690575395855e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+22, overlap shift 2.4414e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905753958555       residual = 2.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905753958555       residual = 3.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905753958555       residual = 2.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+22 is 1.139552e-26

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+22, overlap shift 9.7656e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905753958555       residual = 2.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905753958555       residual = 2.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+23, overlap shift 3.9062e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905753958555       residual = 2.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905753958555       residual = 2.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.207164 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9063e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.092933e-01 1 1  ON 0
 uu_1                 1.425581e-01 1 1  ON 1
 uu_2                 4.090837e-02 1 1  ON 2
 uu_3                -2.150581e-02 1 1  ON 3
 uu_4                -6.690997e-02 1 1  ON 4
 uu_5                -1.013426e-01 1 1  ON 5
 uu_6                -1.282010e-01 1 1  ON 6
 uu_7                -1.411935e-01 1 1  ON 7
 uu_8                -1.329673e-01 1 1  ON 8
 uu_9                -1.043536e-01 1 1  ON 9
 ud_0                 4.443527e-01 1 1  ON 10
 ud_1                 1.801295e-01 1 1  ON 11
 ud_2                 6.325054e-02 1 1  ON 12
 ud_3                -6.192833e-03 1 1  ON 13
 ud_4                -6.411883e-02 1 1  ON 14
 ud_5                -1.066798e-01 1 1  ON 15
 ud_6                -1.344888e-01 1 1  ON 16
 ud_7                -1.516146e-01 1 1  ON 17
 ud_8                -1.521892e-01 1 1  ON 18
 ud_9                -1.426112e-01 1 1  ON 19
 eO_0                -7.585650e-01 1 1  ON 20
 eO_1                -4.404406e-01 1 1  ON 21
 eO_2                -2.262437e-02 1 1  ON 22
 eO_3                 2.977541e-01 1 1  ON 23
 eO_4                 5.252170e-01 1 1  ON 24
 eO_5                 4.870201e-01 1 1  ON 25
 eO_6                 2.596886e-01 1 1  ON 26
 eO_7                -4.096972e-02 1 1  ON 27
 eO_8                -2.205874e-01 1 1  ON 28
 eO_9                -8.532273e-02 1 1  ON 29
eH1_0                -2.414798e-01 1 1  ON 30
eH1_1                -1.440753e-01 1 1  ON 31
eH1_2                -9.924639e-02 1 1  ON 32
eH1_3                -4.540298e-02 1 1  ON 33
eH1_4                 2.880356e-03 1 1  ON 34
eH1_5                 3.773231e-02 1 1  ON 35
eH1_6                 9.700215e-02 1 1  ON 36
eH1_7                 1.538045e-01 1 1  ON 37
eH1_8                 1.762282e-01 1 1  ON 38
eH1_9                 6.658133e-02 1 1  ON 39
eH2_0                -2.395720e-01 1 1  ON 40
eH2_1                -1.418636e-01 1 1  ON 41
eH2_2                -9.688539e-02 1 1  ON 42
eH2_3                -4.316091e-02 1 1  ON 43
eH2_4                 5.105057e-03 1 1  ON 44
eH2_5                 3.979582e-02 1 1  ON 45
eH2_6                 9.952831e-02 1 1  ON 46
eH2_7                 1.556286e-01 1 1  ON 47
eH2_8                 1.821134e-01 1 1  ON 48
eH2_9                 5.595293e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.9038
    reference variance = 0.396505
====================================================
  Execution time = 2.0114e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4413e-01
  Total weights = 2.0000e+06
  Execution time = 1.8742e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344208077496
                                         uncertainty =       0.006847465203

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344208077496
                                         uncertainty =       0.006847465203

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414807407
  error estimate for blocks of size 2^( 2) =       0.000427647051
  error estimate for blocks of size 2^( 3) =       0.000441114669
  error estimate for blocks of size 2^( 4) =       0.000453442377
  error estimate for blocks of size 2^( 5) =       0.000463821611
  error estimate for blocks of size 2^( 6) =       0.000470282416
  error estimate for blocks of size 2^( 7) =       0.000475705989

      target function =                  N/A
              le_mean =     -16.905707229300
             les_mean =     286.147067121011
             stat err =       0.000465813098
             autocorr =       1.261044424638
              std dev =       0.586626261155
             le_variance =       0.344130370277

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344208077496
                                         uncertainty =       0.006847465203

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344208077496
                                         uncertainty =       0.006847465203

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414807407
  error estimate for blocks of size 2^( 2) =       0.000427647051
  error estimate for blocks of size 2^( 3) =       0.000441114669
  error estimate for blocks of size 2^( 4) =       0.000453442377
  error estimate for blocks of size 2^( 5) =       0.000463821611
  error estimate for blocks of size 2^( 6) =       0.000470282416
  error estimate for blocks of size 2^( 7) =       0.000475705989

      target function =                  N/A
              le_mean =     -16.905707229300
             les_mean =     286.147067121011
             stat err =       0.000465813098
             autocorr =       1.261044424638
              std dev =       0.586626261155
             le_variance =       0.344130370277

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344208077496
                                         uncertainty =       0.006847465203

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344208077496
                                         uncertainty =       0.006847465203

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414807407
  error estimate for blocks of size 2^( 2) =       0.000427647051
  error estimate for blocks of size 2^( 3) =       0.000441114669
  error estimate for blocks of size 2^( 4) =       0.000453442377
  error estimate for blocks of size 2^( 5) =       0.000463821611
  error estimate for blocks of size 2^( 6) =       0.000470282416
  error estimate for blocks of size 2^( 7) =       0.000475705989

      target function =                  N/A
              le_mean =     -16.905707229300
             les_mean =     286.147067121011
             stat err =       0.000465813098
             autocorr =       1.261044424638
              std dev =       0.586626261155
             le_variance =       0.344130370277

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344208077496
                                         uncertainty =       0.006847465203

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344208077496
                                         uncertainty =       0.006847465203

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414807407
  error estimate for blocks of size 2^( 2) =       0.000427647051
  error estimate for blocks of size 2^( 3) =       0.000441114669
  error estimate for blocks of size 2^( 4) =       0.000453442377
  error estimate for blocks of size 2^( 5) =       0.000463821611
  error estimate for blocks of size 2^( 6) =       0.000470282416
  error estimate for blocks of size 2^( 7) =       0.000475705989

      target function =                  N/A
              le_mean =     -16.905707229300
             les_mean =     286.147067121011
             stat err =       0.000465813098
             autocorr =       1.261044424638
              std dev =       0.586626261155
             le_variance =       0.344130370277


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905707229300        initial  <--
     2.4414e+22     2.4414e+23             1.1396e-26       -16.905707229300
     9.7656e+22     9.7656e+23             0.0000e+00       -16.905707229300
     3.9062e+23     3.9062e+24             0.0000e+00       -16.905707229300

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5692
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.092933e-01 1 1  ON 0
 uu_1                 1.425581e-01 1 1  ON 1
 uu_2                 4.090837e-02 1 1  ON 2
 uu_3                -2.150581e-02 1 1  ON 3
 uu_4                -6.690997e-02 1 1  ON 4
 uu_5                -1.013426e-01 1 1  ON 5
 uu_6                -1.282010e-01 1 1  ON 6
 uu_7                -1.411935e-01 1 1  ON 7
 uu_8                -1.329673e-01 1 1  ON 8
 uu_9                -1.043536e-01 1 1  ON 9
 ud_0                 4.443527e-01 1 1  ON 10
 ud_1                 1.801295e-01 1 1  ON 11
 ud_2                 6.325054e-02 1 1  ON 12
 ud_3                -6.192833e-03 1 1  ON 13
 ud_4                -6.411883e-02 1 1  ON 14
 ud_5                -1.066798e-01 1 1  ON 15
 ud_6                -1.344888e-01 1 1  ON 16
 ud_7                -1.516146e-01 1 1  ON 17
 ud_8                -1.521892e-01 1 1  ON 18
 ud_9                -1.426112e-01 1 1  ON 19
 eO_0                -7.585650e-01 1 1  ON 20
 eO_1                -4.404406e-01 1 1  ON 21
 eO_2                -2.262437e-02 1 1  ON 22
 eO_3                 2.977541e-01 1 1  ON 23
 eO_4                 5.252170e-01 1 1  ON 24
 eO_5                 4.870201e-01 1 1  ON 25
 eO_6                 2.596886e-01 1 1  ON 26
 eO_7                -4.096972e-02 1 1  ON 27
 eO_8                -2.205874e-01 1 1  ON 28
 eO_9                -8.532273e-02 1 1  ON 29
eH1_0                -2.414798e-01 1 1  ON 30
eH1_1                -1.440753e-01 1 1  ON 31
eH1_2                -9.924639e-02 1 1  ON 32
eH1_3                -4.540298e-02 1 1  ON 33
eH1_4                 2.880356e-03 1 1  ON 34
eH1_5                 3.773231e-02 1 1  ON 35
eH1_6                 9.700215e-02 1 1  ON 36
eH1_7                 1.538045e-01 1 1  ON 37
eH1_8                 1.762282e-01 1 1  ON 38
eH1_9                 6.658133e-02 1 1  ON 39
eH2_0                -2.395720e-01 1 1  ON 40
eH2_1                -1.418636e-01 1 1  ON 41
eH2_2                -9.688539e-02 1 1  ON 42
eH2_3                -4.316091e-02 1 1  ON 43
eH2_4                 5.105057e-03 1 1  ON 44
eH2_5                 3.979582e-02 1 1  ON 45
eH2_6                 9.952831e-02 1 1  ON 46
eH2_7                 1.556286e-01 1 1  ON 47
eH2_8                 1.821134e-01 1 1  ON 48
eH2_9                 5.595293e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8638e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.8894
    reference variance = 0.121455
====================================================
  Execution time = 2.0189e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3929e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5314e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339307434906
                                         uncertainty =       0.004937944262

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339307434906
                                         uncertainty =       0.004937944262

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411879966
  error estimate for blocks of size 2^( 2) =       0.000424363617
  error estimate for blocks of size 2^( 3) =       0.000436913740
  error estimate for blocks of size 2^( 4) =       0.000448837150
  error estimate for blocks of size 2^( 5) =       0.000458981510
  error estimate for blocks of size 2^( 6) =       0.000467197115
  error estimate for blocks of size 2^( 7) =       0.000473518407

      target function =                  N/A
              le_mean =     -16.906598913669
             les_mean =     286.172376871081
             stat err =       0.000462133546
             autocorr =       1.258907011060
              std dev =       0.582486234207
             le_variance =       0.339290213040


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690659891367e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+23, overlap shift 2.4414e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906598913669       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906598913669       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+23 is 0.000000e+00

solving harmonic davidson linear method for identity shift 9.7656e+23, overlap shift 9.7656e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906598913669       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906598913669       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+24, overlap shift 3.9062e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906598913669       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906598913669       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+24 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.208220 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5730e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.092933e-01 1 1  ON 0
 uu_1                 1.425581e-01 1 1  ON 1
 uu_2                 4.090837e-02 1 1  ON 2
 uu_3                -2.150581e-02 1 1  ON 3
 uu_4                -6.690997e-02 1 1  ON 4
 uu_5                -1.013426e-01 1 1  ON 5
 uu_6                -1.282010e-01 1 1  ON 6
 uu_7                -1.411935e-01 1 1  ON 7
 uu_8                -1.329673e-01 1 1  ON 8
 uu_9                -1.043536e-01 1 1  ON 9
 ud_0                 4.443527e-01 1 1  ON 10
 ud_1                 1.801295e-01 1 1  ON 11
 ud_2                 6.325054e-02 1 1  ON 12
 ud_3                -6.192833e-03 1 1  ON 13
 ud_4                -6.411883e-02 1 1  ON 14
 ud_5                -1.066798e-01 1 1  ON 15
 ud_6                -1.344888e-01 1 1  ON 16
 ud_7                -1.516146e-01 1 1  ON 17
 ud_8                -1.521892e-01 1 1  ON 18
 ud_9                -1.426112e-01 1 1  ON 19
 eO_0                -7.585650e-01 1 1  ON 20
 eO_1                -4.404406e-01 1 1  ON 21
 eO_2                -2.262437e-02 1 1  ON 22
 eO_3                 2.977541e-01 1 1  ON 23
 eO_4                 5.252170e-01 1 1  ON 24
 eO_5                 4.870201e-01 1 1  ON 25
 eO_6                 2.596886e-01 1 1  ON 26
 eO_7                -4.096972e-02 1 1  ON 27
 eO_8                -2.205874e-01 1 1  ON 28
 eO_9                -8.532273e-02 1 1  ON 29
eH1_0                -2.414798e-01 1 1  ON 30
eH1_1                -1.440753e-01 1 1  ON 31
eH1_2                -9.924639e-02 1 1  ON 32
eH1_3                -4.540298e-02 1 1  ON 33
eH1_4                 2.880356e-03 1 1  ON 34
eH1_5                 3.773231e-02 1 1  ON 35
eH1_6                 9.700215e-02 1 1  ON 36
eH1_7                 1.538045e-01 1 1  ON 37
eH1_8                 1.762282e-01 1 1  ON 38
eH1_9                 6.658133e-02 1 1  ON 39
eH2_0                -2.395720e-01 1 1  ON 40
eH2_1                -1.418636e-01 1 1  ON 41
eH2_2                -9.688539e-02 1 1  ON 42
eH2_3                -4.316091e-02 1 1  ON 43
eH2_4                 5.105057e-03 1 1  ON 44
eH2_5                 3.979582e-02 1 1  ON 45
eH2_6                 9.952831e-02 1 1  ON 46
eH2_7                 1.556286e-01 1 1  ON 47
eH2_8                 1.821134e-01 1 1  ON 48
eH2_9                 5.595293e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.9459
    reference variance = 0.218567
====================================================
  Execution time = 1.9953e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3480e-01
  Total weights = 2.0000e+06
  Execution time = 1.8762e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334816904725
                                         uncertainty =       0.003250246070

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334816904725
                                         uncertainty =       0.003250246070

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409146401
  error estimate for blocks of size 2^( 2) =       0.000422670779
  error estimate for blocks of size 2^( 3) =       0.000436228006
  error estimate for blocks of size 2^( 4) =       0.000448784045
  error estimate for blocks of size 2^( 5) =       0.000459987714
  error estimate for blocks of size 2^( 6) =       0.000468062123
  error estimate for blocks of size 2^( 7) =       0.000473041310

      target function =                  N/A
              le_mean =     -16.905588130667
             les_mean =     286.133711431625
             stat err =       0.000462468798
             autocorr =       1.277636771434
              std dev =       0.578620389600
             le_variance =       0.334801555260

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334816904725
                                         uncertainty =       0.003250246070

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334816904725
                                         uncertainty =       0.003250246070

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409146401
  error estimate for blocks of size 2^( 2) =       0.000422670779
  error estimate for blocks of size 2^( 3) =       0.000436228006
  error estimate for blocks of size 2^( 4) =       0.000448784045
  error estimate for blocks of size 2^( 5) =       0.000459987714
  error estimate for blocks of size 2^( 6) =       0.000468062123
  error estimate for blocks of size 2^( 7) =       0.000473041310

      target function =                  N/A
              le_mean =     -16.905588130667
             les_mean =     286.133711431625
             stat err =       0.000462468798
             autocorr =       1.277636771434
              std dev =       0.578620389600
             le_variance =       0.334801555260

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334816904725
                                         uncertainty =       0.003250246070

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334816904725
                                         uncertainty =       0.003250246070

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409146401
  error estimate for blocks of size 2^( 2) =       0.000422670779
  error estimate for blocks of size 2^( 3) =       0.000436228006
  error estimate for blocks of size 2^( 4) =       0.000448784045
  error estimate for blocks of size 2^( 5) =       0.000459987714
  error estimate for blocks of size 2^( 6) =       0.000468062123
  error estimate for blocks of size 2^( 7) =       0.000473041310

      target function =                  N/A
              le_mean =     -16.905588130667
             les_mean =     286.133711431625
             stat err =       0.000462468798
             autocorr =       1.277636771434
              std dev =       0.578620389600
             le_variance =       0.334801555260

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334816904725
                                         uncertainty =       0.003250246070

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334816904725
                                         uncertainty =       0.003250246070

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409146401
  error estimate for blocks of size 2^( 2) =       0.000422670779
  error estimate for blocks of size 2^( 3) =       0.000436228006
  error estimate for blocks of size 2^( 4) =       0.000448784045
  error estimate for blocks of size 2^( 5) =       0.000459987714
  error estimate for blocks of size 2^( 6) =       0.000468062123
  error estimate for blocks of size 2^( 7) =       0.000473041310

      target function =                  N/A
              le_mean =     -16.905588130667
             les_mean =     286.133711431625
             stat err =       0.000462468798
             autocorr =       1.277636771434
              std dev =       0.578620389600
             le_variance =       0.334801555260


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905588130667        initial  <--
     2.4414e+23     2.4414e+24             0.0000e+00       -16.905588130667
     9.7656e+23     9.7656e+24             0.0000e+00       -16.905588130667
     3.9062e+24     3.9062e+25             0.0000e+00       -16.905588130667

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4134
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.092933e-01 1 1  ON 0
 uu_1                 1.425581e-01 1 1  ON 1
 uu_2                 4.090837e-02 1 1  ON 2
 uu_3                -2.150581e-02 1 1  ON 3
 uu_4                -6.690997e-02 1 1  ON 4
 uu_5                -1.013426e-01 1 1  ON 5
 uu_6                -1.282010e-01 1 1  ON 6
 uu_7                -1.411935e-01 1 1  ON 7
 uu_8                -1.329673e-01 1 1  ON 8
 uu_9                -1.043536e-01 1 1  ON 9
 ud_0                 4.443527e-01 1 1  ON 10
 ud_1                 1.801295e-01 1 1  ON 11
 ud_2                 6.325054e-02 1 1  ON 12
 ud_3                -6.192833e-03 1 1  ON 13
 ud_4                -6.411883e-02 1 1  ON 14
 ud_5                -1.066798e-01 1 1  ON 15
 ud_6                -1.344888e-01 1 1  ON 16
 ud_7                -1.516146e-01 1 1  ON 17
 ud_8                -1.521892e-01 1 1  ON 18
 ud_9                -1.426112e-01 1 1  ON 19
 eO_0                -7.585650e-01 1 1  ON 20
 eO_1                -4.404406e-01 1 1  ON 21
 eO_2                -2.262437e-02 1 1  ON 22
 eO_3                 2.977541e-01 1 1  ON 23
 eO_4                 5.252170e-01 1 1  ON 24
 eO_5                 4.870201e-01 1 1  ON 25
 eO_6                 2.596886e-01 1 1  ON 26
 eO_7                -4.096972e-02 1 1  ON 27
 eO_8                -2.205874e-01 1 1  ON 28
 eO_9                -8.532273e-02 1 1  ON 29
eH1_0                -2.414798e-01 1 1  ON 30
eH1_1                -1.440753e-01 1 1  ON 31
eH1_2                -9.924639e-02 1 1  ON 32
eH1_3                -4.540298e-02 1 1  ON 33
eH1_4                 2.880356e-03 1 1  ON 34
eH1_5                 3.773231e-02 1 1  ON 35
eH1_6                 9.700215e-02 1 1  ON 36
eH1_7                 1.538045e-01 1 1  ON 37
eH1_8                 1.762282e-01 1 1  ON 38
eH1_9                 6.658133e-02 1 1  ON 39
eH2_0                -2.395720e-01 1 1  ON 40
eH2_1                -1.418636e-01 1 1  ON 41
eH2_2                -9.688539e-02 1 1  ON 42
eH2_3                -4.316091e-02 1 1  ON 43
eH2_4                 5.105057e-03 1 1  ON 44
eH2_5                 3.979582e-02 1 1  ON 45
eH2_6                 9.952831e-02 1 1  ON 46
eH2_7                 1.556286e-01 1 1  ON 47
eH2_8                 1.821134e-01 1 1  ON 48
eH2_9                 5.595293e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5150e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.9035
    reference variance = 0.192886
====================================================
  Execution time = 2.0424e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4206e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6066e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342109524097
                                         uncertainty =       0.007534519589

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342109524097
                                         uncertainty =       0.007534519589

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413556642
  error estimate for blocks of size 2^( 2) =       0.000426792873
  error estimate for blocks of size 2^( 3) =       0.000440728632
  error estimate for blocks of size 2^( 4) =       0.000453780705
  error estimate for blocks of size 2^( 5) =       0.000465536520
  error estimate for blocks of size 2^( 6) =       0.000475240782
  error estimate for blocks of size 2^( 7) =       0.000481134955

      target function =                  N/A
              le_mean =     -16.905467216270
             les_mean =     286.136879822414
             stat err =       0.000468923240
             autocorr =       1.285681850317
              std dev =       0.584857412579
             le_variance =       0.342058193049


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690546721627e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+24, overlap shift 2.4414e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905467216270       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905467216270       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+24, overlap shift 9.7656e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905467216270       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905467216270       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+25, overlap shift 3.9062e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905467216270       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905467216270       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+25 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.209264 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6040e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.092933e-01 1 1  ON 0
 uu_1                 1.425581e-01 1 1  ON 1
 uu_2                 4.090837e-02 1 1  ON 2
 uu_3                -2.150581e-02 1 1  ON 3
 uu_4                -6.690997e-02 1 1  ON 4
 uu_5                -1.013426e-01 1 1  ON 5
 uu_6                -1.282010e-01 1 1  ON 6
 uu_7                -1.411935e-01 1 1  ON 7
 uu_8                -1.329673e-01 1 1  ON 8
 uu_9                -1.043536e-01 1 1  ON 9
 ud_0                 4.443527e-01 1 1  ON 10
 ud_1                 1.801295e-01 1 1  ON 11
 ud_2                 6.325054e-02 1 1  ON 12
 ud_3                -6.192833e-03 1 1  ON 13
 ud_4                -6.411883e-02 1 1  ON 14
 ud_5                -1.066798e-01 1 1  ON 15
 ud_6                -1.344888e-01 1 1  ON 16
 ud_7                -1.516146e-01 1 1  ON 17
 ud_8                -1.521892e-01 1 1  ON 18
 ud_9                -1.426112e-01 1 1  ON 19
 eO_0                -7.585650e-01 1 1  ON 20
 eO_1                -4.404406e-01 1 1  ON 21
 eO_2                -2.262437e-02 1 1  ON 22
 eO_3                 2.977541e-01 1 1  ON 23
 eO_4                 5.252170e-01 1 1  ON 24
 eO_5                 4.870201e-01 1 1  ON 25
 eO_6                 2.596886e-01 1 1  ON 26
 eO_7                -4.096972e-02 1 1  ON 27
 eO_8                -2.205874e-01 1 1  ON 28
 eO_9                -8.532273e-02 1 1  ON 29
eH1_0                -2.414798e-01 1 1  ON 30
eH1_1                -1.440753e-01 1 1  ON 31
eH1_2                -9.924639e-02 1 1  ON 32
eH1_3                -4.540298e-02 1 1  ON 33
eH1_4                 2.880356e-03 1 1  ON 34
eH1_5                 3.773231e-02 1 1  ON 35
eH1_6                 9.700215e-02 1 1  ON 36
eH1_7                 1.538045e-01 1 1  ON 37
eH1_8                 1.762282e-01 1 1  ON 38
eH1_9                 6.658133e-02 1 1  ON 39
eH2_0                -2.395720e-01 1 1  ON 40
eH2_1                -1.418636e-01 1 1  ON 41
eH2_2                -9.688539e-02 1 1  ON 42
eH2_3                -4.316091e-02 1 1  ON 43
eH2_4                 5.105057e-03 1 1  ON 44
eH2_5                 3.979582e-02 1 1  ON 45
eH2_6                 9.952831e-02 1 1  ON 46
eH2_7                 1.556286e-01 1 1  ON 47
eH2_8                 1.821134e-01 1 1  ON 48
eH2_9                 5.595293e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.9113
    reference variance = 0.483457
====================================================
  Execution time = 2.0011e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3425e-01
  Total weights = 2.0000e+06
  Execution time = 1.8797e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334268072578
                                         uncertainty =       0.003753241079

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334268072578
                                         uncertainty =       0.003753241079

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408811855
  error estimate for blocks of size 2^( 2) =       0.000421694827
  error estimate for blocks of size 2^( 3) =       0.000434680052
  error estimate for blocks of size 2^( 4) =       0.000447383728
  error estimate for blocks of size 2^( 5) =       0.000458416115
  error estimate for blocks of size 2^( 6) =       0.000466890084
  error estimate for blocks of size 2^( 7) =       0.000472535577

      target function =                  N/A
              le_mean =     -16.905794644758
             les_mean =     286.140146669360
             stat err =       0.000461306376
             autocorr =       1.273303555916
              std dev =       0.578147269972
             le_variance =       0.334254265776

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334268072578
                                         uncertainty =       0.003753241079

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334268072578
                                         uncertainty =       0.003753241079

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408811855
  error estimate for blocks of size 2^( 2) =       0.000421694827
  error estimate for blocks of size 2^( 3) =       0.000434680052
  error estimate for blocks of size 2^( 4) =       0.000447383728
  error estimate for blocks of size 2^( 5) =       0.000458416115
  error estimate for blocks of size 2^( 6) =       0.000466890084
  error estimate for blocks of size 2^( 7) =       0.000472535577

      target function =                  N/A
              le_mean =     -16.905794644758
             les_mean =     286.140146669360
             stat err =       0.000461306376
             autocorr =       1.273303555916
              std dev =       0.578147269972
             le_variance =       0.334254265776

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334268072578
                                         uncertainty =       0.003753241079

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334268072578
                                         uncertainty =       0.003753241079

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408811855
  error estimate for blocks of size 2^( 2) =       0.000421694827
  error estimate for blocks of size 2^( 3) =       0.000434680052
  error estimate for blocks of size 2^( 4) =       0.000447383728
  error estimate for blocks of size 2^( 5) =       0.000458416115
  error estimate for blocks of size 2^( 6) =       0.000466890084
  error estimate for blocks of size 2^( 7) =       0.000472535577

      target function =                  N/A
              le_mean =     -16.905794644758
             les_mean =     286.140146669360
             stat err =       0.000461306376
             autocorr =       1.273303555916
              std dev =       0.578147269972
             le_variance =       0.334254265776

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334268072578
                                         uncertainty =       0.003753241079

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334268072578
                                         uncertainty =       0.003753241079

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408811855
  error estimate for blocks of size 2^( 2) =       0.000421694827
  error estimate for blocks of size 2^( 3) =       0.000434680052
  error estimate for blocks of size 2^( 4) =       0.000447383728
  error estimate for blocks of size 2^( 5) =       0.000458416115
  error estimate for blocks of size 2^( 6) =       0.000466890084
  error estimate for blocks of size 2^( 7) =       0.000472535577

      target function =                  N/A
              le_mean =     -16.905794644758
             les_mean =     286.140146669360
             stat err =       0.000461306376
             autocorr =       1.273303555916
              std dev =       0.578147269972
             le_variance =       0.334254265776


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905794644758        initial  <--
     2.4414e+24     2.4414e+25             0.0000e+00       -16.905794644758
     9.7656e+24     9.7656e+25             0.0000e+00       -16.905794644758
     3.9062e+25     3.9062e+26             0.0000e+00       -16.905794644758

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4869
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.092933e-01 1 1  ON 0
 uu_1                 1.425581e-01 1 1  ON 1
 uu_2                 4.090837e-02 1 1  ON 2
 uu_3                -2.150581e-02 1 1  ON 3
 uu_4                -6.690997e-02 1 1  ON 4
 uu_5                -1.013426e-01 1 1  ON 5
 uu_6                -1.282010e-01 1 1  ON 6
 uu_7                -1.411935e-01 1 1  ON 7
 uu_8                -1.329673e-01 1 1  ON 8
 uu_9                -1.043536e-01 1 1  ON 9
 ud_0                 4.443527e-01 1 1  ON 10
 ud_1                 1.801295e-01 1 1  ON 11
 ud_2                 6.325054e-02 1 1  ON 12
 ud_3                -6.192833e-03 1 1  ON 13
 ud_4                -6.411883e-02 1 1  ON 14
 ud_5                -1.066798e-01 1 1  ON 15
 ud_6                -1.344888e-01 1 1  ON 16
 ud_7                -1.516146e-01 1 1  ON 17
 ud_8                -1.521892e-01 1 1  ON 18
 ud_9                -1.426112e-01 1 1  ON 19
 eO_0                -7.585650e-01 1 1  ON 20
 eO_1                -4.404406e-01 1 1  ON 21
 eO_2                -2.262437e-02 1 1  ON 22
 eO_3                 2.977541e-01 1 1  ON 23
 eO_4                 5.252170e-01 1 1  ON 24
 eO_5                 4.870201e-01 1 1  ON 25
 eO_6                 2.596886e-01 1 1  ON 26
 eO_7                -4.096972e-02 1 1  ON 27
 eO_8                -2.205874e-01 1 1  ON 28
 eO_9                -8.532273e-02 1 1  ON 29
eH1_0                -2.414798e-01 1 1  ON 30
eH1_1                -1.440753e-01 1 1  ON 31
eH1_2                -9.924639e-02 1 1  ON 32
eH1_3                -4.540298e-02 1 1  ON 33
eH1_4                 2.880356e-03 1 1  ON 34
eH1_5                 3.773231e-02 1 1  ON 35
eH1_6                 9.700215e-02 1 1  ON 36
eH1_7                 1.538045e-01 1 1  ON 37
eH1_8                 1.762282e-01 1 1  ON 38
eH1_9                 6.658133e-02 1 1  ON 39
eH2_0                -2.395720e-01 1 1  ON 40
eH2_1                -1.418636e-01 1 1  ON 41
eH2_2                -9.688539e-02 1 1  ON 42
eH2_3                -4.316091e-02 1 1  ON 43
eH2_4                 5.105057e-03 1 1  ON 44
eH2_5                 3.979582e-02 1 1  ON 45
eH2_6                 9.952831e-02 1 1  ON 46
eH2_7                 1.556286e-01 1 1  ON 47
eH2_8                 1.821134e-01 1 1  ON 48
eH2_9                 5.595293e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5533e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.863
    reference variance = 0.285244
====================================================
  Execution time = 2.0591e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3454e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4824e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334632786988
                                         uncertainty =       0.002588536081

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334632786988
                                         uncertainty =       0.002588536081

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408988604
  error estimate for blocks of size 2^( 2) =       0.000422066001
  error estimate for blocks of size 2^( 3) =       0.000435718311
  error estimate for blocks of size 2^( 4) =       0.000448240983
  error estimate for blocks of size 2^( 5) =       0.000459784648
  error estimate for blocks of size 2^( 6) =       0.000467131126
  error estimate for blocks of size 2^( 7) =       0.000472064770

      target function =                  N/A
              le_mean =     -16.905900454865
             les_mean =     286.144013378775
             stat err =       0.000461805382
             autocorr =       1.274957083892
              std dev =       0.578397230497
             le_variance =       0.334543356247


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690590045486e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+25, overlap shift 2.4414e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905900454865       residual = 2.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905900454865       residual = 3.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905900454865       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905900454865       residual = 6.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+25 is 2.321771e-29

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+25, overlap shift 9.7656e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905900454865       residual = 2.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905900454865       residual = 3.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905900454865       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905900454862       residual = 3.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+25 is 5.804427e-30

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+26, overlap shift 3.9062e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905900454865       residual = 2.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905900454865       residual = 3.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905900454865       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905900454862       residual = 6.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+26 is 1.451107e-30

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.210841 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6084e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.092933e-01 1 1  ON 0
 uu_1                 1.425581e-01 1 1  ON 1
 uu_2                 4.090837e-02 1 1  ON 2
 uu_3                -2.150581e-02 1 1  ON 3
 uu_4                -6.690997e-02 1 1  ON 4
 uu_5                -1.013426e-01 1 1  ON 5
 uu_6                -1.282010e-01 1 1  ON 6
 uu_7                -1.411935e-01 1 1  ON 7
 uu_8                -1.329673e-01 1 1  ON 8
 uu_9                -1.043536e-01 1 1  ON 9
 ud_0                 4.443527e-01 1 1  ON 10
 ud_1                 1.801295e-01 1 1  ON 11
 ud_2                 6.325054e-02 1 1  ON 12
 ud_3                -6.192833e-03 1 1  ON 13
 ud_4                -6.411883e-02 1 1  ON 14
 ud_5                -1.066798e-01 1 1  ON 15
 ud_6                -1.344888e-01 1 1  ON 16
 ud_7                -1.516146e-01 1 1  ON 17
 ud_8                -1.521892e-01 1 1  ON 18
 ud_9                -1.426112e-01 1 1  ON 19
 eO_0                -7.585650e-01 1 1  ON 20
 eO_1                -4.404406e-01 1 1  ON 21
 eO_2                -2.262437e-02 1 1  ON 22
 eO_3                 2.977541e-01 1 1  ON 23
 eO_4                 5.252170e-01 1 1  ON 24
 eO_5                 4.870201e-01 1 1  ON 25
 eO_6                 2.596886e-01 1 1  ON 26
 eO_7                -4.096972e-02 1 1  ON 27
 eO_8                -2.205874e-01 1 1  ON 28
 eO_9                -8.532273e-02 1 1  ON 29
eH1_0                -2.414798e-01 1 1  ON 30
eH1_1                -1.440753e-01 1 1  ON 31
eH1_2                -9.924639e-02 1 1  ON 32
eH1_3                -4.540298e-02 1 1  ON 33
eH1_4                 2.880356e-03 1 1  ON 34
eH1_5                 3.773231e-02 1 1  ON 35
eH1_6                 9.700215e-02 1 1  ON 36
eH1_7                 1.538045e-01 1 1  ON 37
eH1_8                 1.762282e-01 1 1  ON 38
eH1_9                 6.658133e-02 1 1  ON 39
eH2_0                -2.395720e-01 1 1  ON 40
eH2_1                -1.418636e-01 1 1  ON 41
eH2_2                -9.688539e-02 1 1  ON 42
eH2_3                -4.316091e-02 1 1  ON 43
eH2_4                 5.105057e-03 1 1  ON 44
eH2_5                 3.979582e-02 1 1  ON 45
eH2_6                 9.952831e-02 1 1  ON 46
eH2_7                 1.556286e-01 1 1  ON 47
eH2_8                 1.821134e-01 1 1  ON 48
eH2_9                 5.595293e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.9501
    reference variance = 0.220282
====================================================
  Execution time = 2.2459e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4051e-01
  Total weights = 2.0000e+06
  Execution time = 1.8781e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340556798736
                                         uncertainty =       0.004434267140

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340556798736
                                         uncertainty =       0.004434267140

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412622272
  error estimate for blocks of size 2^( 2) =       0.000425677393
  error estimate for blocks of size 2^( 3) =       0.000439837920
  error estimate for blocks of size 2^( 4) =       0.000453207932
  error estimate for blocks of size 2^( 5) =       0.000465418702
  error estimate for blocks of size 2^( 6) =       0.000475509463
  error estimate for blocks of size 2^( 7) =       0.000482089635

      target function =                  N/A
              le_mean =     -16.905900693979
             les_mean =     286.149992382755
             stat err =       0.000469056433
             autocorr =       1.292245002591
              std dev =       0.583536012892
             le_variance =       0.340514278342

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340556798736
                                         uncertainty =       0.004434267140

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340556798736
                                         uncertainty =       0.004434267140

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412622272
  error estimate for blocks of size 2^( 2) =       0.000425677393
  error estimate for blocks of size 2^( 3) =       0.000439837920
  error estimate for blocks of size 2^( 4) =       0.000453207932
  error estimate for blocks of size 2^( 5) =       0.000465418702
  error estimate for blocks of size 2^( 6) =       0.000475509463
  error estimate for blocks of size 2^( 7) =       0.000482089635

      target function =                  N/A
              le_mean =     -16.905900693979
             les_mean =     286.149992382755
             stat err =       0.000469056433
             autocorr =       1.292245002591
              std dev =       0.583536012892
             le_variance =       0.340514278342

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340556798736
                                         uncertainty =       0.004434267140

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340556798736
                                         uncertainty =       0.004434267140

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412622272
  error estimate for blocks of size 2^( 2) =       0.000425677393
  error estimate for blocks of size 2^( 3) =       0.000439837920
  error estimate for blocks of size 2^( 4) =       0.000453207932
  error estimate for blocks of size 2^( 5) =       0.000465418702
  error estimate for blocks of size 2^( 6) =       0.000475509463
  error estimate for blocks of size 2^( 7) =       0.000482089635

      target function =                  N/A
              le_mean =     -16.905900693979
             les_mean =     286.149992382755
             stat err =       0.000469056433
             autocorr =       1.292245002591
              std dev =       0.583536012892
             le_variance =       0.340514278342

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340556798736
                                         uncertainty =       0.004434267140

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340556798736
                                         uncertainty =       0.004434267140

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412622272
  error estimate for blocks of size 2^( 2) =       0.000425677393
  error estimate for blocks of size 2^( 3) =       0.000439837920
  error estimate for blocks of size 2^( 4) =       0.000453207932
  error estimate for blocks of size 2^( 5) =       0.000465418702
  error estimate for blocks of size 2^( 6) =       0.000475509463
  error estimate for blocks of size 2^( 7) =       0.000482089635

      target function =                  N/A
              le_mean =     -16.905900693979
             les_mean =     286.149992382755
             stat err =       0.000469056433
             autocorr =       1.292245002591
              std dev =       0.583536012892
             le_variance =       0.340514278342


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905900693979        initial  <--
     2.4414e+25     2.4414e+26             2.3218e-29       -16.905900693979
     9.7656e+25     9.7656e+26             5.8044e-30       -16.905900693979
     3.9062e+26     3.9062e+27             1.4511e-30       -16.905900693979

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.9360
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.092933e-01 1 1  ON 0
 uu_1                 1.425581e-01 1 1  ON 1
 uu_2                 4.090837e-02 1 1  ON 2
 uu_3                -2.150581e-02 1 1  ON 3
 uu_4                -6.690997e-02 1 1  ON 4
 uu_5                -1.013426e-01 1 1  ON 5
 uu_6                -1.282010e-01 1 1  ON 6
 uu_7                -1.411935e-01 1 1  ON 7
 uu_8                -1.329673e-01 1 1  ON 8
 uu_9                -1.043536e-01 1 1  ON 9
 ud_0                 4.443527e-01 1 1  ON 10
 ud_1                 1.801295e-01 1 1  ON 11
 ud_2                 6.325054e-02 1 1  ON 12
 ud_3                -6.192833e-03 1 1  ON 13
 ud_4                -6.411883e-02 1 1  ON 14
 ud_5                -1.066798e-01 1 1  ON 15
 ud_6                -1.344888e-01 1 1  ON 16
 ud_7                -1.516146e-01 1 1  ON 17
 ud_8                -1.521892e-01 1 1  ON 18
 ud_9                -1.426112e-01 1 1  ON 19
 eO_0                -7.585650e-01 1 1  ON 20
 eO_1                -4.404406e-01 1 1  ON 21
 eO_2                -2.262437e-02 1 1  ON 22
 eO_3                 2.977541e-01 1 1  ON 23
 eO_4                 5.252170e-01 1 1  ON 24
 eO_5                 4.870201e-01 1 1  ON 25
 eO_6                 2.596886e-01 1 1  ON 26
 eO_7                -4.096972e-02 1 1  ON 27
 eO_8                -2.205874e-01 1 1  ON 28
 eO_9                -8.532273e-02 1 1  ON 29
eH1_0                -2.414798e-01 1 1  ON 30
eH1_1                -1.440753e-01 1 1  ON 31
eH1_2                -9.924639e-02 1 1  ON 32
eH1_3                -4.540298e-02 1 1  ON 33
eH1_4                 2.880356e-03 1 1  ON 34
eH1_5                 3.773231e-02 1 1  ON 35
eH1_6                 9.700215e-02 1 1  ON 36
eH1_7                 1.538045e-01 1 1  ON 37
eH1_8                 1.762282e-01 1 1  ON 38
eH1_9                 6.658133e-02 1 1  ON 39
eH2_0                -2.395720e-01 1 1  ON 40
eH2_1                -1.418636e-01 1 1  ON 41
eH2_2                -9.688539e-02 1 1  ON 42
eH2_3                -4.316091e-02 1 1  ON 43
eH2_4                 5.105057e-03 1 1  ON 44
eH2_5                 3.979582e-02 1 1  ON 45
eH2_6                 9.952831e-02 1 1  ON 46
eH2_7                 1.556286e-01 1 1  ON 47
eH2_8                 1.821134e-01 1 1  ON 48
eH2_9                 5.595293e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8026e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.9112
    reference variance = 0.277802
====================================================
  Execution time = 2.0361e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4425e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5090e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344352174726
                                         uncertainty =       0.007640783350

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344352174726
                                         uncertainty =       0.007640783350

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414880031
  error estimate for blocks of size 2^( 2) =       0.000427219694
  error estimate for blocks of size 2^( 3) =       0.000439572184
  error estimate for blocks of size 2^( 4) =       0.000451281625
  error estimate for blocks of size 2^( 5) =       0.000461769241
  error estimate for blocks of size 2^( 6) =       0.000469719312
  error estimate for blocks of size 2^( 7) =       0.000474462209

      target function =                  N/A
              le_mean =     -16.906214096036
             les_mean =     286.164325769305
             stat err =       0.000464308097
             autocorr =       1.252470340734
              std dev =       0.586728966746
             le_variance =       0.344250880418


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690621409604e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+26, overlap shift 2.4414e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906214096036       residual = 2.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906214096036       residual = 3.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906214096036       residual = 2.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+26 is 1.183400e-30

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+26, overlap shift 9.7656e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906214096036       residual = 2.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906214096036       residual = 3.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906445886019       residual = 1.09e+09           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+26 is 2.958501e-31

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+27, overlap shift 3.9062e+28 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906214096036       residual = 2.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906214096036       residual = 3.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906214096036       residual = 2.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+27 is 7.396253e-32

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.212203 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5880e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.092933e-01 1 1  ON 0
 uu_1                 1.425581e-01 1 1  ON 1
 uu_2                 4.090837e-02 1 1  ON 2
 uu_3                -2.150581e-02 1 1  ON 3
 uu_4                -6.690997e-02 1 1  ON 4
 uu_5                -1.013426e-01 1 1  ON 5
 uu_6                -1.282010e-01 1 1  ON 6
 uu_7                -1.411935e-01 1 1  ON 7
 uu_8                -1.329673e-01 1 1  ON 8
 uu_9                -1.043536e-01 1 1  ON 9
 ud_0                 4.443527e-01 1 1  ON 10
 ud_1                 1.801295e-01 1 1  ON 11
 ud_2                 6.325054e-02 1 1  ON 12
 ud_3                -6.192833e-03 1 1  ON 13
 ud_4                -6.411883e-02 1 1  ON 14
 ud_5                -1.066798e-01 1 1  ON 15
 ud_6                -1.344888e-01 1 1  ON 16
 ud_7                -1.516146e-01 1 1  ON 17
 ud_8                -1.521892e-01 1 1  ON 18
 ud_9                -1.426112e-01 1 1  ON 19
 eO_0                -7.585650e-01 1 1  ON 20
 eO_1                -4.404406e-01 1 1  ON 21
 eO_2                -2.262437e-02 1 1  ON 22
 eO_3                 2.977541e-01 1 1  ON 23
 eO_4                 5.252170e-01 1 1  ON 24
 eO_5                 4.870201e-01 1 1  ON 25
 eO_6                 2.596886e-01 1 1  ON 26
 eO_7                -4.096972e-02 1 1  ON 27
 eO_8                -2.205874e-01 1 1  ON 28
 eO_9                -8.532273e-02 1 1  ON 29
eH1_0                -2.414798e-01 1 1  ON 30
eH1_1                -1.440753e-01 1 1  ON 31
eH1_2                -9.924639e-02 1 1  ON 32
eH1_3                -4.540298e-02 1 1  ON 33
eH1_4                 2.880356e-03 1 1  ON 34
eH1_5                 3.773231e-02 1 1  ON 35
eH1_6                 9.700215e-02 1 1  ON 36
eH1_7                 1.538045e-01 1 1  ON 37
eH1_8                 1.762282e-01 1 1  ON 38
eH1_9                 6.658133e-02 1 1  ON 39
eH2_0                -2.395720e-01 1 1  ON 40
eH2_1                -1.418636e-01 1 1  ON 41
eH2_2                -9.688539e-02 1 1  ON 42
eH2_3                -4.316091e-02 1 1  ON 43
eH2_4                 5.105057e-03 1 1  ON 44
eH2_5                 3.979582e-02 1 1  ON 45
eH2_6                 9.952831e-02 1 1  ON 46
eH2_7                 1.556286e-01 1 1  ON 47
eH2_8                 1.821134e-01 1 1  ON 48
eH2_9                 5.595293e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.8926
    reference variance = 0.202583
====================================================
  Execution time = 2.0065e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4805e-01
  Total weights = 2.0000e+06
  Execution time = 1.8877e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348169268244
                                         uncertainty =       0.010230178926

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348169268244
                                         uncertainty =       0.010230178926

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417163619
  error estimate for blocks of size 2^( 2) =       0.000429764139
  error estimate for blocks of size 2^( 3) =       0.000443636439
  error estimate for blocks of size 2^( 4) =       0.000456519771
  error estimate for blocks of size 2^( 5) =       0.000467478470
  error estimate for blocks of size 2^( 6) =       0.000474826667
  error estimate for blocks of size 2^( 7) =       0.000479855144

      target function =                  N/A
              le_mean =     -16.905373337960
             les_mean =     286.139698492140
             stat err =       0.000469670013
             autocorr =       1.267572509135
              std dev =       0.589958447999
             le_variance =       0.348050970366

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348169268244
                                         uncertainty =       0.010230178926

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348169268244
                                         uncertainty =       0.010230178926

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417163619
  error estimate for blocks of size 2^( 2) =       0.000429764139
  error estimate for blocks of size 2^( 3) =       0.000443636439
  error estimate for blocks of size 2^( 4) =       0.000456519771
  error estimate for blocks of size 2^( 5) =       0.000467478470
  error estimate for blocks of size 2^( 6) =       0.000474826667
  error estimate for blocks of size 2^( 7) =       0.000479855144

      target function =                  N/A
              le_mean =     -16.905373337960
             les_mean =     286.139698492140
             stat err =       0.000469670013
             autocorr =       1.267572509135
              std dev =       0.589958447999
             le_variance =       0.348050970366

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348169268244
                                         uncertainty =       0.010230178926

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348169268244
                                         uncertainty =       0.010230178926

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417163619
  error estimate for blocks of size 2^( 2) =       0.000429764139
  error estimate for blocks of size 2^( 3) =       0.000443636439
  error estimate for blocks of size 2^( 4) =       0.000456519771
  error estimate for blocks of size 2^( 5) =       0.000467478470
  error estimate for blocks of size 2^( 6) =       0.000474826667
  error estimate for blocks of size 2^( 7) =       0.000479855144

      target function =                  N/A
              le_mean =     -16.905373337960
             les_mean =     286.139698492140
             stat err =       0.000469670013
             autocorr =       1.267572509135
              std dev =       0.589958447999
             le_variance =       0.348050970366

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348169268244
                                         uncertainty =       0.010230178926

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348169268244
                                         uncertainty =       0.010230178926

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417163619
  error estimate for blocks of size 2^( 2) =       0.000429764139
  error estimate for blocks of size 2^( 3) =       0.000443636439
  error estimate for blocks of size 2^( 4) =       0.000456519771
  error estimate for blocks of size 2^( 5) =       0.000467478470
  error estimate for blocks of size 2^( 6) =       0.000474826667
  error estimate for blocks of size 2^( 7) =       0.000479855144

      target function =                  N/A
              le_mean =     -16.905373337960
             les_mean =     286.139698492140
             stat err =       0.000469670013
             autocorr =       1.267572509135
              std dev =       0.589958447999
             le_variance =       0.348050970366


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905373337960        initial  <--
     2.4414e+26     2.4414e+27             1.1834e-30       -16.905373337960
     9.7656e+26     9.7656e+27             2.9585e-31       -16.905373337960
     3.9062e+27     3.9062e+28             7.3963e-32       -16.905373337960

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5836
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.092933e-01 1 1  ON 0
 uu_1                 1.425581e-01 1 1  ON 1
 uu_2                 4.090837e-02 1 1  ON 2
 uu_3                -2.150581e-02 1 1  ON 3
 uu_4                -6.690997e-02 1 1  ON 4
 uu_5                -1.013426e-01 1 1  ON 5
 uu_6                -1.282010e-01 1 1  ON 6
 uu_7                -1.411935e-01 1 1  ON 7
 uu_8                -1.329673e-01 1 1  ON 8
 uu_9                -1.043536e-01 1 1  ON 9
 ud_0                 4.443527e-01 1 1  ON 10
 ud_1                 1.801295e-01 1 1  ON 11
 ud_2                 6.325054e-02 1 1  ON 12
 ud_3                -6.192833e-03 1 1  ON 13
 ud_4                -6.411883e-02 1 1  ON 14
 ud_5                -1.066798e-01 1 1  ON 15
 ud_6                -1.344888e-01 1 1  ON 16
 ud_7                -1.516146e-01 1 1  ON 17
 ud_8                -1.521892e-01 1 1  ON 18
 ud_9                -1.426112e-01 1 1  ON 19
 eO_0                -7.585650e-01 1 1  ON 20
 eO_1                -4.404406e-01 1 1  ON 21
 eO_2                -2.262437e-02 1 1  ON 22
 eO_3                 2.977541e-01 1 1  ON 23
 eO_4                 5.252170e-01 1 1  ON 24
 eO_5                 4.870201e-01 1 1  ON 25
 eO_6                 2.596886e-01 1 1  ON 26
 eO_7                -4.096972e-02 1 1  ON 27
 eO_8                -2.205874e-01 1 1  ON 28
 eO_9                -8.532273e-02 1 1  ON 29
eH1_0                -2.414798e-01 1 1  ON 30
eH1_1                -1.440753e-01 1 1  ON 31
eH1_2                -9.924639e-02 1 1  ON 32
eH1_3                -4.540298e-02 1 1  ON 33
eH1_4                 2.880356e-03 1 1  ON 34
eH1_5                 3.773231e-02 1 1  ON 35
eH1_6                 9.700215e-02 1 1  ON 36
eH1_7                 1.538045e-01 1 1  ON 37
eH1_8                 1.762282e-01 1 1  ON 38
eH1_9                 6.658133e-02 1 1  ON 39
eH2_0                -2.395720e-01 1 1  ON 40
eH2_1                -1.418636e-01 1 1  ON 41
eH2_2                -9.688539e-02 1 1  ON 42
eH2_3                -4.316091e-02 1 1  ON 43
eH2_4                 5.105057e-03 1 1  ON 44
eH2_5                 3.979582e-02 1 1  ON 45
eH2_6                 9.952831e-02 1 1  ON 46
eH2_7                 1.556286e-01 1 1  ON 47
eH2_8                 1.821134e-01 1 1  ON 48
eH2_9                 5.595293e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5469e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.8848
    reference variance = 0.277385
====================================================
  Execution time = 2.0515e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3873e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5348e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338522972531
                                         uncertainty =       0.004802468022

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338522972531
                                         uncertainty =       0.004802468022

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411542326
  error estimate for blocks of size 2^( 2) =       0.000424041696
  error estimate for blocks of size 2^( 3) =       0.000436651625
  error estimate for blocks of size 2^( 4) =       0.000448399689
  error estimate for blocks of size 2^( 5) =       0.000457996332
  error estimate for blocks of size 2^( 6) =       0.000464083595
  error estimate for blocks of size 2^( 7) =       0.000471376457

      target function =                  N/A
              le_mean =     -16.905811827572
             les_mean =     286.145207552340
             stat err =       0.000460464018
             autocorr =       1.251879079549
              std dev =       0.582008739131
             le_variance =       0.338734172425


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690581182757e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+27, overlap shift 2.4414e+28 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905811827572       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905811827572       residual = 4.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905811827572       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+27 is 1.193843e-31

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+27, overlap shift 9.7656e+28 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905811827572       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905811827572       residual = 4.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905811827630       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+27 is 2.984607e-32

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+28, overlap shift 3.9062e+29 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905811827572       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905811827572       residual = 4.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905811827630       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+28 is 7.461517e-33

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.213530 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6060e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.092933e-01 1 1  ON 0
 uu_1                 1.425581e-01 1 1  ON 1
 uu_2                 4.090837e-02 1 1  ON 2
 uu_3                -2.150581e-02 1 1  ON 3
 uu_4                -6.690997e-02 1 1  ON 4
 uu_5                -1.013426e-01 1 1  ON 5
 uu_6                -1.282010e-01 1 1  ON 6
 uu_7                -1.411935e-01 1 1  ON 7
 uu_8                -1.329673e-01 1 1  ON 8
 uu_9                -1.043536e-01 1 1  ON 9
 ud_0                 4.443527e-01 1 1  ON 10
 ud_1                 1.801295e-01 1 1  ON 11
 ud_2                 6.325054e-02 1 1  ON 12
 ud_3                -6.192833e-03 1 1  ON 13
 ud_4                -6.411883e-02 1 1  ON 14
 ud_5                -1.066798e-01 1 1  ON 15
 ud_6                -1.344888e-01 1 1  ON 16
 ud_7                -1.516146e-01 1 1  ON 17
 ud_8                -1.521892e-01 1 1  ON 18
 ud_9                -1.426112e-01 1 1  ON 19
 eO_0                -7.585650e-01 1 1  ON 20
 eO_1                -4.404406e-01 1 1  ON 21
 eO_2                -2.262437e-02 1 1  ON 22
 eO_3                 2.977541e-01 1 1  ON 23
 eO_4                 5.252170e-01 1 1  ON 24
 eO_5                 4.870201e-01 1 1  ON 25
 eO_6                 2.596886e-01 1 1  ON 26
 eO_7                -4.096972e-02 1 1  ON 27
 eO_8                -2.205874e-01 1 1  ON 28
 eO_9                -8.532273e-02 1 1  ON 29
eH1_0                -2.414798e-01 1 1  ON 30
eH1_1                -1.440753e-01 1 1  ON 31
eH1_2                -9.924639e-02 1 1  ON 32
eH1_3                -4.540298e-02 1 1  ON 33
eH1_4                 2.880356e-03 1 1  ON 34
eH1_5                 3.773231e-02 1 1  ON 35
eH1_6                 9.700215e-02 1 1  ON 36
eH1_7                 1.538045e-01 1 1  ON 37
eH1_8                 1.762282e-01 1 1  ON 38
eH1_9                 6.658133e-02 1 1  ON 39
eH2_0                -2.395720e-01 1 1  ON 40
eH2_1                -1.418636e-01 1 1  ON 41
eH2_2                -9.688539e-02 1 1  ON 42
eH2_3                -4.316091e-02 1 1  ON 43
eH2_4                 5.105057e-03 1 1  ON 44
eH2_5                 3.979582e-02 1 1  ON 45
eH2_6                 9.952831e-02 1 1  ON 46
eH2_7                 1.556286e-01 1 1  ON 47
eH2_8                 1.821134e-01 1 1  ON 48
eH2_9                 5.595293e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.8525
    reference variance = 0.339856
====================================================
  Execution time = 2.2027e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5691e-01
  Total weights = 2.0000e+06
  Execution time = 1.8953e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.357028492428
                                         uncertainty =       0.013216504810

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.357028492428
                                         uncertainty =       0.013216504810

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422437619
  error estimate for blocks of size 2^( 2) =       0.000434809069
  error estimate for blocks of size 2^( 3) =       0.000447051269
  error estimate for blocks of size 2^( 4) =       0.000458183582
  error estimate for blocks of size 2^( 5) =       0.000468546379
  error estimate for blocks of size 2^( 6) =       0.000476433292
  error estimate for blocks of size 2^( 7) =       0.000482818203

      target function =                  N/A
              le_mean =     -16.906027832820
             les_mean =     286.170683989331
             stat err =       0.000471495364
             autocorr =       1.245746516549
              std dev =       0.597417009875
             le_variance =       0.356907083687

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.357028492428
                                         uncertainty =       0.013216504810

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.357028492428
                                         uncertainty =       0.013216504810

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422437619
  error estimate for blocks of size 2^( 2) =       0.000434809069
  error estimate for blocks of size 2^( 3) =       0.000447051269
  error estimate for blocks of size 2^( 4) =       0.000458183582
  error estimate for blocks of size 2^( 5) =       0.000468546379
  error estimate for blocks of size 2^( 6) =       0.000476433292
  error estimate for blocks of size 2^( 7) =       0.000482818203

      target function =                  N/A
              le_mean =     -16.906027832820
             les_mean =     286.170683989331
             stat err =       0.000471495364
             autocorr =       1.245746516549
              std dev =       0.597417009875
             le_variance =       0.356907083687

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.357028492428
                                         uncertainty =       0.013216504810

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.357028492428
                                         uncertainty =       0.013216504810

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422437619
  error estimate for blocks of size 2^( 2) =       0.000434809069
  error estimate for blocks of size 2^( 3) =       0.000447051269
  error estimate for blocks of size 2^( 4) =       0.000458183582
  error estimate for blocks of size 2^( 5) =       0.000468546379
  error estimate for blocks of size 2^( 6) =       0.000476433292
  error estimate for blocks of size 2^( 7) =       0.000482818203

      target function =                  N/A
              le_mean =     -16.906027832820
             les_mean =     286.170683989331
             stat err =       0.000471495364
             autocorr =       1.245746516549
              std dev =       0.597417009875
             le_variance =       0.356907083687

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.357028492428
                                         uncertainty =       0.013216504810

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.357028492428
                                         uncertainty =       0.013216504810

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422437619
  error estimate for blocks of size 2^( 2) =       0.000434809069
  error estimate for blocks of size 2^( 3) =       0.000447051269
  error estimate for blocks of size 2^( 4) =       0.000458183582
  error estimate for blocks of size 2^( 5) =       0.000468546379
  error estimate for blocks of size 2^( 6) =       0.000476433292
  error estimate for blocks of size 2^( 7) =       0.000482818203

      target function =                  N/A
              le_mean =     -16.906027832820
             les_mean =     286.170683989331
             stat err =       0.000471495364
             autocorr =       1.245746516549
              std dev =       0.597417009875
             le_variance =       0.356907083687


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906027832820        initial  <--
     2.4414e+27     2.4414e+28             1.1938e-31       -16.906027832820
     9.7656e+27     9.7656e+28             2.9846e-32       -16.906027832820
     3.9062e+28     3.9062e+29             7.4615e-33       -16.906027832820

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.5336
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.092933e-01 1 1  ON 0
 uu_1                 1.425581e-01 1 1  ON 1
 uu_2                 4.090837e-02 1 1  ON 2
 uu_3                -2.150581e-02 1 1  ON 3
 uu_4                -6.690997e-02 1 1  ON 4
 uu_5                -1.013426e-01 1 1  ON 5
 uu_6                -1.282010e-01 1 1  ON 6
 uu_7                -1.411935e-01 1 1  ON 7
 uu_8                -1.329673e-01 1 1  ON 8
 uu_9                -1.043536e-01 1 1  ON 9
 ud_0                 4.443527e-01 1 1  ON 10
 ud_1                 1.801295e-01 1 1  ON 11
 ud_2                 6.325054e-02 1 1  ON 12
 ud_3                -6.192833e-03 1 1  ON 13
 ud_4                -6.411883e-02 1 1  ON 14
 ud_5                -1.066798e-01 1 1  ON 15
 ud_6                -1.344888e-01 1 1  ON 16
 ud_7                -1.516146e-01 1 1  ON 17
 ud_8                -1.521892e-01 1 1  ON 18
 ud_9                -1.426112e-01 1 1  ON 19
 eO_0                -7.585650e-01 1 1  ON 20
 eO_1                -4.404406e-01 1 1  ON 21
 eO_2                -2.262437e-02 1 1  ON 22
 eO_3                 2.977541e-01 1 1  ON 23
 eO_4                 5.252170e-01 1 1  ON 24
 eO_5                 4.870201e-01 1 1  ON 25
 eO_6                 2.596886e-01 1 1  ON 26
 eO_7                -4.096972e-02 1 1  ON 27
 eO_8                -2.205874e-01 1 1  ON 28
 eO_9                -8.532273e-02 1 1  ON 29
eH1_0                -2.414798e-01 1 1  ON 30
eH1_1                -1.440753e-01 1 1  ON 31
eH1_2                -9.924639e-02 1 1  ON 32
eH1_3                -4.540298e-02 1 1  ON 33
eH1_4                 2.880356e-03 1 1  ON 34
eH1_5                 3.773231e-02 1 1  ON 35
eH1_6                 9.700215e-02 1 1  ON 36
eH1_7                 1.538045e-01 1 1  ON 37
eH1_8                 1.762282e-01 1 1  ON 38
eH1_9                 6.658133e-02 1 1  ON 39
eH2_0                -2.395720e-01 1 1  ON 40
eH2_1                -1.418636e-01 1 1  ON 41
eH2_2                -9.688539e-02 1 1  ON 42
eH2_3                -4.316091e-02 1 1  ON 43
eH2_4                 5.105057e-03 1 1  ON 44
eH2_5                 3.979582e-02 1 1  ON 45
eH2_6                 9.952831e-02 1 1  ON 46
eH2_7                 1.556286e-01 1 1  ON 47
eH2_8                 1.821134e-01 1 1  ON 48
eH2_9                 5.595293e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7599e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.9165
    reference variance = 0.316821
====================================================
  Execution time = 2.0355e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4586e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6099e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345948503691
                                         uncertainty =       0.007585184914

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345948503691
                                         uncertainty =       0.007585184914

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415851173
  error estimate for blocks of size 2^( 2) =       0.000428326786
  error estimate for blocks of size 2^( 3) =       0.000442050833
  error estimate for blocks of size 2^( 4) =       0.000454415862
  error estimate for blocks of size 2^( 5) =       0.000464970971
  error estimate for blocks of size 2^( 6) =       0.000472460148
  error estimate for blocks of size 2^( 7) =       0.000480947997

      target function =                  N/A
              le_mean =     -16.905478194240
             les_mean =     286.141057199668
             stat err =       0.000468198744
             autocorr =       1.267606994265
              std dev =       0.588102369224
             le_variance =       0.345864396687


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690547819424e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+28, overlap shift 2.4414e+29 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905478194240       residual = 2.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905478194240       residual = 2.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+28 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+28, overlap shift 9.7656e+29 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905478194240       residual = 2.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905478194240       residual = 2.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+28 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+29, overlap shift 3.9062e+30 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905478194240       residual = 2.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905478194240       residual = 2.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+29 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.214587 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5975e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.092933e-01 1 1  ON 0
 uu_1                 1.425581e-01 1 1  ON 1
 uu_2                 4.090837e-02 1 1  ON 2
 uu_3                -2.150581e-02 1 1  ON 3
 uu_4                -6.690997e-02 1 1  ON 4
 uu_5                -1.013426e-01 1 1  ON 5
 uu_6                -1.282010e-01 1 1  ON 6
 uu_7                -1.411935e-01 1 1  ON 7
 uu_8                -1.329673e-01 1 1  ON 8
 uu_9                -1.043536e-01 1 1  ON 9
 ud_0                 4.443527e-01 1 1  ON 10
 ud_1                 1.801295e-01 1 1  ON 11
 ud_2                 6.325054e-02 1 1  ON 12
 ud_3                -6.192833e-03 1 1  ON 13
 ud_4                -6.411883e-02 1 1  ON 14
 ud_5                -1.066798e-01 1 1  ON 15
 ud_6                -1.344888e-01 1 1  ON 16
 ud_7                -1.516146e-01 1 1  ON 17
 ud_8                -1.521892e-01 1 1  ON 18
 ud_9                -1.426112e-01 1 1  ON 19
 eO_0                -7.585650e-01 1 1  ON 20
 eO_1                -4.404406e-01 1 1  ON 21
 eO_2                -2.262437e-02 1 1  ON 22
 eO_3                 2.977541e-01 1 1  ON 23
 eO_4                 5.252170e-01 1 1  ON 24
 eO_5                 4.870201e-01 1 1  ON 25
 eO_6                 2.596886e-01 1 1  ON 26
 eO_7                -4.096972e-02 1 1  ON 27
 eO_8                -2.205874e-01 1 1  ON 28
 eO_9                -8.532273e-02 1 1  ON 29
eH1_0                -2.414798e-01 1 1  ON 30
eH1_1                -1.440753e-01 1 1  ON 31
eH1_2                -9.924639e-02 1 1  ON 32
eH1_3                -4.540298e-02 1 1  ON 33
eH1_4                 2.880356e-03 1 1  ON 34
eH1_5                 3.773231e-02 1 1  ON 35
eH1_6                 9.700215e-02 1 1  ON 36
eH1_7                 1.538045e-01 1 1  ON 37
eH1_8                 1.762282e-01 1 1  ON 38
eH1_9                 6.658133e-02 1 1  ON 39
eH2_0                -2.395720e-01 1 1  ON 40
eH2_1                -1.418636e-01 1 1  ON 41
eH2_2                -9.688539e-02 1 1  ON 42
eH2_3                -4.316091e-02 1 1  ON 43
eH2_4                 5.105057e-03 1 1  ON 44
eH2_5                 3.979582e-02 1 1  ON 45
eH2_6                 9.952831e-02 1 1  ON 46
eH2_7                 1.556286e-01 1 1  ON 47
eH2_8                 1.821134e-01 1 1  ON 48
eH2_9                 5.595293e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.862
    reference variance = 0.260042
====================================================
  Execution time = 1.9888e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3824e-01
  Total weights = 2.0000e+06
  Execution time = 1.8620e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338278546576
                                         uncertainty =       0.006704994636

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338278546576
                                         uncertainty =       0.006704994636

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411240708
  error estimate for blocks of size 2^( 2) =       0.000423924418
  error estimate for blocks of size 2^( 3) =       0.000436663648
  error estimate for blocks of size 2^( 4) =       0.000448675741
  error estimate for blocks of size 2^( 5) =       0.000459209650
  error estimate for blocks of size 2^( 6) =       0.000466775060
  error estimate for blocks of size 2^( 7) =       0.000471439819

      target function =                  N/A
              le_mean =     -16.906186346564
             les_mean =     286.157374455105
             stat err =       0.000461525068
             autocorr =       1.259500642564
              std dev =       0.581582186362
             le_variance =       0.338237839493

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338278546576
                                         uncertainty =       0.006704994636

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338278546576
                                         uncertainty =       0.006704994636

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411240708
  error estimate for blocks of size 2^( 2) =       0.000423924418
  error estimate for blocks of size 2^( 3) =       0.000436663648
  error estimate for blocks of size 2^( 4) =       0.000448675741
  error estimate for blocks of size 2^( 5) =       0.000459209650
  error estimate for blocks of size 2^( 6) =       0.000466775060
  error estimate for blocks of size 2^( 7) =       0.000471439819

      target function =                  N/A
              le_mean =     -16.906186346564
             les_mean =     286.157374455105
             stat err =       0.000461525068
             autocorr =       1.259500642564
              std dev =       0.581582186362
             le_variance =       0.338237839493

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338278546576
                                         uncertainty =       0.006704994636

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338278546576
                                         uncertainty =       0.006704994636

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411240708
  error estimate for blocks of size 2^( 2) =       0.000423924418
  error estimate for blocks of size 2^( 3) =       0.000436663648
  error estimate for blocks of size 2^( 4) =       0.000448675741
  error estimate for blocks of size 2^( 5) =       0.000459209650
  error estimate for blocks of size 2^( 6) =       0.000466775060
  error estimate for blocks of size 2^( 7) =       0.000471439819

      target function =                  N/A
              le_mean =     -16.906186346564
             les_mean =     286.157374455105
             stat err =       0.000461525068
             autocorr =       1.259500642564
              std dev =       0.581582186362
             le_variance =       0.338237839493

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338278546576
                                         uncertainty =       0.006704994636

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338278546576
                                         uncertainty =       0.006704994636

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411240708
  error estimate for blocks of size 2^( 2) =       0.000423924418
  error estimate for blocks of size 2^( 3) =       0.000436663648
  error estimate for blocks of size 2^( 4) =       0.000448675741
  error estimate for blocks of size 2^( 5) =       0.000459209650
  error estimate for blocks of size 2^( 6) =       0.000466775060
  error estimate for blocks of size 2^( 7) =       0.000471439819

      target function =                  N/A
              le_mean =     -16.906186346564
             les_mean =     286.157374455105
             stat err =       0.000461525068
             autocorr =       1.259500642564
              std dev =       0.581582186362
             le_variance =       0.338237839493


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906186346564        initial  <--
     2.4414e+28     2.4414e+29             0.0000e+00       -16.906186346564
     9.7656e+28     9.7656e+29             0.0000e+00       -16.906186346564
     3.9062e+29     3.9062e+30             0.0000e+00       -16.906186346564

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.3016
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.092933e-01 1 1  ON 0
 uu_1                 1.425581e-01 1 1  ON 1
 uu_2                 4.090837e-02 1 1  ON 2
 uu_3                -2.150581e-02 1 1  ON 3
 uu_4                -6.690997e-02 1 1  ON 4
 uu_5                -1.013426e-01 1 1  ON 5
 uu_6                -1.282010e-01 1 1  ON 6
 uu_7                -1.411935e-01 1 1  ON 7
 uu_8                -1.329673e-01 1 1  ON 8
 uu_9                -1.043536e-01 1 1  ON 9
 ud_0                 4.443527e-01 1 1  ON 10
 ud_1                 1.801295e-01 1 1  ON 11
 ud_2                 6.325054e-02 1 1  ON 12
 ud_3                -6.192833e-03 1 1  ON 13
 ud_4                -6.411883e-02 1 1  ON 14
 ud_5                -1.066798e-01 1 1  ON 15
 ud_6                -1.344888e-01 1 1  ON 16
 ud_7                -1.516146e-01 1 1  ON 17
 ud_8                -1.521892e-01 1 1  ON 18
 ud_9                -1.426112e-01 1 1  ON 19
 eO_0                -7.585650e-01 1 1  ON 20
 eO_1                -4.404406e-01 1 1  ON 21
 eO_2                -2.262437e-02 1 1  ON 22
 eO_3                 2.977541e-01 1 1  ON 23
 eO_4                 5.252170e-01 1 1  ON 24
 eO_5                 4.870201e-01 1 1  ON 25
 eO_6                 2.596886e-01 1 1  ON 26
 eO_7                -4.096972e-02 1 1  ON 27
 eO_8                -2.205874e-01 1 1  ON 28
 eO_9                -8.532273e-02 1 1  ON 29
eH1_0                -2.414798e-01 1 1  ON 30
eH1_1                -1.440753e-01 1 1  ON 31
eH1_2                -9.924639e-02 1 1  ON 32
eH1_3                -4.540298e-02 1 1  ON 33
eH1_4                 2.880356e-03 1 1  ON 34
eH1_5                 3.773231e-02 1 1  ON 35
eH1_6                 9.700215e-02 1 1  ON 36
eH1_7                 1.538045e-01 1 1  ON 37
eH1_8                 1.762282e-01 1 1  ON 38
eH1_9                 6.658133e-02 1 1  ON 39
eH2_0                -2.395720e-01 1 1  ON 40
eH2_1                -1.418636e-01 1 1  ON 41
eH2_2                -9.688539e-02 1 1  ON 42
eH2_3                -4.316091e-02 1 1  ON 43
eH2_4                 5.105057e-03 1 1  ON 44
eH2_5                 3.979582e-02 1 1  ON 45
eH2_6                 9.952831e-02 1 1  ON 46
eH2_7                 1.556286e-01 1 1  ON 47
eH2_8                 1.821134e-01 1 1  ON 48
eH2_9                 5.595293e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5281e+01 secs
  Total Execution time = 2.2665e+03 secs

=========================================================
  A new xml input file : H2O.s039.cont.xml
