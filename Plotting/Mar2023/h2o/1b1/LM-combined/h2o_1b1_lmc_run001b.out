Rank =    0  Free Memory = 86587 MB
Rank =    1  Free Memory = 86587 MB
Rank =    2  Free Memory = 86587 MB
Rank =    3  Free Memory = 86587 MB
Rank =    4  Free Memory = 86586 MB
Rank =    5  Free Memory = 86586 MB
Rank =    6  Free Memory = 86585 MB
Rank =    7  Free Memory = 86585 MB
Rank =    8  Free Memory = 86585 MB
Rank =    9  Free Memory = 86585 MB
Rank =   10  Free Memory = 86585 MB
Rank =   11  Free Memory = 86585 MB
Rank =   12  Free Memory = 86584 MB
Rank =   13  Free Memory = 86584 MB
Rank =   14  Free Memory = 86583 MB
Rank =   15  Free Memory = 86571 MB
Rank =   16  Free Memory = 86571 MB
Rank =   17  Free Memory = 86571 MB
Rank =   18  Free Memory = 86571 MB
Rank =   19  Free Memory = 86571 MB
Rank =   20  Free Memory = 86571 MB
Rank =   21  Free Memory = 86571 MB
Rank =   22  Free Memory = 86571 MB
Rank =   23  Free Memory = 86571 MB
Rank =   24  Free Memory = 86571 MB
Rank =   25  Free Memory = 86571 MB
Rank =   26  Free Memory = 86571 MB
Rank =   27  Free Memory = 86571 MB
Rank =   28  Free Memory = 86571 MB
Rank =   29  Free Memory = 86571 MB
Rank =   30  Free Memory = 86571 MB
Rank =   31  Free Memory = 86571 MB
Rank =   32  Free Memory = 69889 MB
Rank =   33  Free Memory = 69889 MB
Rank =   34  Free Memory = 69889 MB
Rank =   35  Free Memory = 69889 MB
Rank =   36  Free Memory = 69889 MB
Rank =   37  Free Memory = 69889 MB
Rank =   38  Free Memory = 69889 MB
Rank =   39  Free Memory = 69889 MB
Rank =   40  Free Memory = 69889 MB
Rank =   41  Free Memory = 69889 MB
Rank =   42  Free Memory = 69889 MB
Rank =   43  Free Memory = 69889 MB
Rank =   44  Free Memory = 69889 MB
Rank =   45  Free Memory = 69889 MB
Rank =   46  Free Memory = 69889 MB
Rank =   47  Free Memory = 69889 MB
Rank =   48  Free Memory = 69889 MB
Rank =   49  Free Memory = 69889 MB
Rank =   50  Free Memory = 69889 MB
Rank =   51  Free Memory = 69889 MB
Rank =   52  Free Memory = 69889 MB
Rank =   53  Free Memory = 69889 MB
Rank =   54  Free Memory = 69889 MB
Rank =   55  Free Memory = 69889 MB
Rank =   56  Free Memory = 69889 MB
Rank =   57  Free Memory = 69889 MB
Rank =   58  Free Memory = 69889 MB
Rank =   59  Free Memory = 69889 MB
Rank =   60  Free Memory = 69889 MB
Rank =   61  Free Memory = 69889 MB
Rank =   62  Free Memory = 69889 MB
Rank =   63  Free Memory = 69889 MB
Rank =   64  Free Memory = 83835 MB
Rank =   65  Free Memory = 83835 MB
Rank =   66  Free Memory = 83835 MB
Rank =   67  Free Memory = 83835 MB
Rank =   68  Free Memory = 83835 MB
Rank =   69  Free Memory = 83835 MB
Rank =   70  Free Memory = 83835 MB
Rank =   71  Free Memory = 83835 MB
Rank =   72  Free Memory = 83835 MB
Rank =   73  Free Memory = 83834 MB
Rank =   74  Free Memory = 83834 MB
Rank =   75  Free Memory = 83834 MB
Rank =   76  Free Memory = 83834 MB
Rank =   77  Free Memory = 83834 MB
Rank =   78  Free Memory = 83834 MB
Rank =   79  Free Memory = 83834 MB
Rank =   80  Free Memory = 83834 MB
Rank =   81  Free Memory = 83834 MB
Rank =   82  Free Memory = 83834 MB
Rank =   83  Free Memory = 83834 MB
Rank =   84  Free Memory = 83834 MB
Rank =   85  Free Memory = 83834 MB
Rank =   86  Free Memory = 83834 MB
Rank =   87  Free Memory = 83834 MB
Rank =   88  Free Memory = 83834 MB
Rank =   89  Free Memory = 83834 MB
Rank =   90  Free Memory = 83834 MB
Rank =   91  Free Memory = 83834 MB
Rank =   92  Free Memory = 83834 MB
Rank =   93  Free Memory = 83834 MB
Rank =   94  Free Memory = 83834 MB
Rank =   95  Free Memory = 83834 MB
Rank =   96  Free Memory = 75467 MB
Rank =   97  Free Memory = 75467 MB
Rank =   98  Free Memory = 75466 MB
Rank =   99  Free Memory = 75466 MB
Rank =  100  Free Memory = 75466 MB
Rank =  101  Free Memory = 75466 MB
Rank =  102  Free Memory = 75466 MB
Rank =  103  Free Memory = 75466 MB
Rank =  104  Free Memory = 75466 MB
Rank =  105  Free Memory = 75466 MB
Rank =  106  Free Memory = 75466 MB
Rank =  107  Free Memory = 75466 MB
Rank =  108  Free Memory = 75466 MB
Rank =  109  Free Memory = 75466 MB
Rank =  110  Free Memory = 75466 MB
Rank =  111  Free Memory = 75466 MB
Rank =  112  Free Memory = 75466 MB
Rank =  113  Free Memory = 75466 MB
Rank =  114  Free Memory = 75466 MB
Rank =  115  Free Memory = 75466 MB
Rank =  116  Free Memory = 75466 MB
Rank =  117  Free Memory = 75466 MB
Rank =  118  Free Memory = 75466 MB
Rank =  119  Free Memory = 75466 MB
Rank =  120  Free Memory = 75466 MB
Rank =  121  Free Memory = 75466 MB
Rank =  122  Free Memory = 75466 MB
Rank =  123  Free Memory = 75466 MB
Rank =  124  Free Memory = 75466 MB
Rank =  125  Free Memory = 75466 MB
Rank =  126  Free Memory = 75466 MB
Rank =  127  Free Memory = 75466 MB
  Input file(s): opt_h2o_1b1_lmc_run001b.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: a1d851bbe8d902a0d3168a885b757a378aeaab54-dirty
  Last git commit date: Mon Feb 13 11:52:39 2023 -0800
  Last git commit subject: Print param update magnitude and largest update
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_1b1_lmc_run001b.xml

  Project = H2O
  date    = 2023-03-02 16:14:48 PST
  host    = n0100.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 1016

  Range of prime numbers to use as seeds over processors and threads = 8093-9241


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 3.027108e-01    1         1 OFF
     uu_1                 1.395499e-01    1         1 OFF
     uu_2                 4.158458e-02    1         1 OFF
     uu_3                -1.946409e-02    1         1 OFF
     uu_4                -6.333239e-02    1         1 OFF
     uu_5                -9.587524e-02    1         1 OFF
     uu_6                -1.205706e-01    1         1 OFF
     uu_7                -1.310580e-01    1         1 OFF
     uu_8                -1.203232e-01    1         1 OFF
     uu_9                -9.277332e-02    1         1 OFF

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 4.114416e-01    1         1 OFF
     ud_1                 1.583401e-01    1         1 OFF
     ud_2                 6.092685e-02    1         1 OFF
     ud_3                 2.699750e-03    1         1 OFF
     ud_4                -5.713986e-02    1         1 OFF
     ud_5                -1.014997e-01    1         1 OFF
     ud_6                -1.286687e-01    1         1 OFF
     ud_7                -1.435029e-01    1         1 OFF
     ud_8                -1.424319e-01    1         1 OFF
     ud_9                -1.344547e-01    1         1 OFF


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.043100e-01    1         1 OFF
     eO_1                -4.137154e-01    1         1 OFF
     eO_2                -3.185752e-02    1         1 OFF
     eO_3                 2.692030e-01    1         1 OFF
     eO_4                 4.916456e-01    1         1 OFF
     eO_5                 4.596091e-01    1         1 OFF
     eO_6                 2.360353e-01    1         1 OFF
     eO_7                -5.591968e-02    1         1 OFF
     eO_8                -1.959242e-01    1         1 OFF
     eO_9                -5.768884e-02    1         1 OFF

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.099404e-01    1         1 OFF
     eH1_1                -1.274877e-01    1         1 OFF
     eH1_2                -8.838243e-02    1         1 OFF
     eH1_3                -3.738645e-02    1         1 OFF
     eH1_4                 1.159942e-02    1         1 OFF
     eH1_5                 4.473069e-02    1         1 OFF
     eH1_6                 9.476145e-02    1         1 OFF
     eH1_7                 1.381756e-01    1         1 OFF
     eH1_8                 1.456924e-01    1         1 OFF
     eH1_9                 3.283823e-02    1         1 OFF

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.088198e-01    1         1 OFF
     eH2_1                -1.265485e-01    1         1 OFF
     eH2_2                -8.741031e-02    1         1 OFF
     eH2_3                -3.640778e-02    1         1 OFF
     eH2_4                 1.289653e-02    1         1 OFF
     eH2_5                 4.794967e-02    1         1 OFF
     eH2_6                 1.006131e-01    1         1 OFF
     eH2_7                 1.496008e-01    1         1 OFF
     eH2_8                 1.537439e-01    1         1 OFF
     eH2_9                 1.292423e-02    1         1 OFF

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 75 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.932065e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 30 unique up determinants.
Found 30 unique down determinants.
Number of terms in pairs array: 20
Number of terms in pairs array: 20
CI coefficients are optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 1.8298e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u  6.1002844054e-01  1.3250453608e-01 -4.2267217978e-01
    u -4.3494847795e-01 -2.3203549626e-01  1.0876787134e-01
    u -1.5984350305e-01  8.1842956548e-01  5.1837161342e-02
    u  1.1948334779e+00  1.4453040952e+00  1.6346730752e+00
    d -9.5054657961e-01  2.3768909128e-01 -6.0876959125e-01
    d -2.0429807517e-01  1.5546410594e+00 -1.0292769217e-01
    d  4.7451519973e-01  3.4811618685e-02  3.5425821429e-01
    d -8.6403568621e-02 -1.8286319639e+00  9.9844026831e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 100
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 74
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.8921
    reference variance = 0.195078
====================================================
  Execution time = 1.5199e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5264e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2231e-01
  Total weights = 1.951915864e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6158e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312637225443
                                         uncertainty =       0.003355267739

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312637225443
                                         uncertainty =       0.003355267739

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395319786
  error estimate for blocks of size 2^( 2) =       0.000409158978
  error estimate for blocks of size 2^( 3) =       0.000423398686
  error estimate for blocks of size 2^( 4) =       0.000436456944
  error estimate for blocks of size 2^( 5) =       0.000447420012
  error estimate for blocks of size 2^( 6) =       0.000453702933
  error estimate for blocks of size 2^( 7) =       0.000457689861

      target function =                  N/A
              le_mean =     -16.904536516613
             les_mean =     286.085669570035
             stat err =       0.000448817437
             autocorr =       1.288968606277
              std dev =       0.559066602852
             le_variance =       0.312555466424


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.690453651661e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904536516644       residual = 3.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904530827997       residual = 5.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904530341370       residual = 2.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904530194882       residual = 7.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.5000e-01 is 2.704995e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904536516644       residual = 3.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904534295911       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904534031303       residual = 3.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904534024206       residual = 3.42e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.0000e+00 is 1.050162e-03

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904536516644       residual = 3.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904535870797       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904535783447       residual = 3.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904535790743       residual = 3.85e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 4.0000e+00 is 3.049373e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.141642 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7962e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
ci_0001 7.011909e-01                 3 1 ON  0
ci_0002 6.994997e-01                 3 1 ON  1
ci_0003 -3.052699e-02                3 1 ON  2
ci_0004 -3.087736e-02                3 1 ON  3
ci_0005 -3.356402e-02                3 1 ON  4
ci_0006 -3.475567e-02                3 1 ON  5
ci_0007 -2.229883e-02                3 1 ON  6
ci_0008 -2.345165e-02                3 1 ON  7
ci_0009 -1.989065e-02                3 1 ON  8
ci_0010 -2.024258e-02                3 1 ON  9
ci_0011 -1.474428e-02                3 1 ON  10
ci_0012 -1.495121e-02                3 1 ON  11
ci_0013 1.611448e-02                 3 1 ON  12
ci_0014 1.547717e-02                 3 1 ON  13
ci_0015 1.587915e-02                 3 1 ON  14
ci_0016 1.531993e-02                 3 1 ON  15
ci_0017 1.412996e-02                 3 1 ON  16
ci_0018 1.405379e-02                 3 1 ON  17
ci_0019 1.228902e-02                 3 1 ON  18
ci_0020 1.187723e-02                 3 1 ON  19
ci_0021 7.012351e-03                 3 1 ON  20
ci_0022 7.544194e-03                 3 1 ON  21
ci_0023 -1.181126e-02                3 1 ON  22
ci_0024 -1.122977e-02                3 1 ON  23
ci_0025 -1.132932e-02                3 1 ON  24
ci_0026 -1.139560e-02                3 1 ON  25
ci_0027 -1.115523e-02                3 1 ON  26
ci_0028 -1.168326e-02                3 1 ON  27
ci_0029 -1.077068e-02                3 1 ON  28
ci_0030 -1.070534e-02                3 1 ON  29
ci_0031 1.909975e-02                 3 1 ON  30
ci_0032 1.939419e-02                 3 1 ON  31
ci_0033 1.008742e-02                 3 1 ON  32
ci_0034 1.043444e-02                 3 1 ON  33
ci_0035 6.945203e-03                 3 1 ON  34
ci_0036 6.002720e-03                 3 1 ON  35
ci_0037 -1.154447e-02                3 1 ON  36
ci_0038 -1.080541e-02                3 1 ON  37
ci_0039 -4.125694e-03                3 1 ON  38
ci_0040 -4.084177e-03                3 1 ON  39
ci_0041 8.750486e-03                 3 1 ON  40
ci_0042 8.356162e-03                 3 1 ON  41
ci_0043 -1.367494e-02                3 1 ON  42
ci_0044 -1.372557e-02                3 1 ON  43
ci_0045 8.111297e-03                 3 1 ON  44
ci_0046 8.066631e-03                 3 1 ON  45
ci_0047 -3.570271e-03                3 1 ON  46
ci_0048 -3.333271e-03                3 1 ON  47
ci_0049 -6.526149e-03                3 1 ON  48
ci_0050 -6.097515e-03                3 1 ON  49
ci_0051 -4.473985e-03                3 1 ON  50
ci_0052 -4.747240e-03                3 1 ON  51
ci_0053 -6.229492e-03                3 1 ON  52
ci_0054 -6.062986e-03                3 1 ON  53
ci_0055 6.780322e-03                 3 1 ON  54
ci_0056 6.859337e-03                 3 1 ON  55
ci_0057 5.781502e-03                 3 1 ON  56
ci_0058 5.063876e-03                 3 1 ON  57
ci_0059 -5.709122e-03                3 1 ON  58
ci_0060 -6.188321e-03                3 1 ON  59
ci_0061 -4.038343e-03                3 1 ON  60
ci_0062 -3.812961e-03                3 1 ON  61
ci_0063 -9.149312e-03                3 1 ON  62
ci_0064 -8.945821e-03                3 1 ON  63
ci_0065 -6.592590e-03                3 1 ON  64
ci_0066 -6.685380e-03                3 1 ON  65
ci_0067 -6.115859e-03                3 1 ON  66
ci_0068 -6.105706e-03                3 1 ON  67
ci_0069 5.209308e-03                 3 1 ON  68
ci_0070 5.500699e-03                 3 1 ON  69
ci_0071 4.464130e-03                 3 1 ON  70
ci_0072 4.651212e-03                 3 1 ON  71
ci_0073 5.196059e-03                 3 1 ON  72
ci_0074 5.446665e-03                 3 1 ON  73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.9337
    reference variance = 0.224506
====================================================
  Execution time = 1.4016e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2342e-01
  Total weights = 1.9519e+06
  Execution time = 1.8966e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312181751514
                                         uncertainty =       0.002977096863

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312181751514
                                         uncertainty =       0.002977096863

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395035956
  error estimate for blocks of size 2^( 2) =       0.000408853106
  error estimate for blocks of size 2^( 3) =       0.000422465531
  error estimate for blocks of size 2^( 4) =       0.000435095452
  error estimate for blocks of size 2^( 5) =       0.000445879924
  error estimate for blocks of size 2^( 6) =       0.000452306108
  error estimate for blocks of size 2^( 7) =       0.000458116188

      target function =                  N/A
              le_mean =     -16.904344019171
             les_mean =     286.082870921416
             stat err =       0.000447849418
             autocorr =       1.285259357981
              std dev =       0.558665206781
             le_variance =       0.312106813267

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311380465091
                                         uncertainty =       0.002769701982

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311380465091
                                         uncertainty =       0.002769701982

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394528882
  error estimate for blocks of size 2^( 2) =       0.000408367461
  error estimate for blocks of size 2^( 3) =       0.000422014570
  error estimate for blocks of size 2^( 4) =       0.000434637402
  error estimate for blocks of size 2^( 5) =       0.000445417335
  error estimate for blocks of size 2^( 6) =       0.000451868367
  error estimate for blocks of size 2^( 7) =       0.000457634628

      target function =                  N/A
              le_mean =     -16.904352888685
             les_mean =     286.109557712568
             stat err =       0.000447389433
             autocorr =       1.285919676101
              std dev =       0.557948095012
             le_variance =       0.311306076728

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311470395235
                                         uncertainty =       0.002798922420

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311470395235
                                         uncertainty =       0.002798922420

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394585830
  error estimate for blocks of size 2^( 2) =       0.000408419426
  error estimate for blocks of size 2^( 3) =       0.000422058024
  error estimate for blocks of size 2^( 4) =       0.000434683078
  error estimate for blocks of size 2^( 5) =       0.000445462274
  error estimate for blocks of size 2^( 6) =       0.000451911623
  error estimate for blocks of size 2^( 7) =       0.000457676666

      target function =                  N/A
              le_mean =     -16.904343169947
             les_mean =     286.091166624487
             stat err =       0.000447433410
             autocorr =       1.285801265824
              std dev =       0.558028632915
             le_variance =       0.311395955153

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312082218143
                                         uncertainty =       0.002941749923

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312082218143
                                         uncertainty =       0.002941749923

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394972957
  error estimate for blocks of size 2^( 2) =       0.000408793287
  error estimate for blocks of size 2^( 3) =       0.000422408270
  error estimate for blocks of size 2^( 4) =       0.000435028297
  error estimate for blocks of size 2^( 5) =       0.000445809991
  error estimate for blocks of size 2^( 6) =       0.000452232048
  error estimate for blocks of size 2^( 7) =       0.000458055583

      target function =                  N/A
              le_mean =     -16.904336175841
             les_mean =     286.394372812754
             stat err =       0.000447781480
             autocorr =       1.285279351859
              std dev =       0.558576112987
             le_variance =       0.312007274000


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904344019171        initial
     2.5000e-01     2.5000e+00             2.7050e-03       -16.904352888685  <--
     1.0000e+00     1.0000e+01             1.0502e-03       -16.904343169947
     4.0000e+00     4.0000e+01             3.0494e-04       -16.904336175841

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 2.4051e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
ci_0001                 7.011189e-01 3 1  ON 0
ci_0002                 6.996365e-01 3 1  ON 1
ci_0003                -3.045619e-02 3 1  ON 2
ci_0004                -3.092328e-02 3 1  ON 3
ci_0005                -3.366086e-02 3 1  ON 4
ci_0006                -3.479306e-02 3 1  ON 5
ci_0007                -2.185309e-02 3 1  ON 6
ci_0008                -2.318178e-02 3 1  ON 7
ci_0009                -1.986138e-02 3 1  ON 8
ci_0010                -2.026599e-02 3 1  ON 9
ci_0011                -1.477376e-02 3 1  ON 10
ci_0012                -1.481538e-02 3 1  ON 11
ci_0013                 1.605980e-02 3 1  ON 12
ci_0014                 1.527635e-02 3 1  ON 13
ci_0015                 1.614974e-02 3 1  ON 14
ci_0016                 1.559582e-02 3 1  ON 15
ci_0017                 1.425826e-02 3 1  ON 16
ci_0018                 1.406208e-02 3 1  ON 17
ci_0019                 1.261069e-02 3 1  ON 18
ci_0020                 1.185630e-02 3 1  ON 19
ci_0021                 6.897104e-03 3 1  ON 20
ci_0022                 7.158506e-03 3 1  ON 21
ci_0023                -1.184331e-02 3 1  ON 22
ci_0024                -1.122265e-02 3 1  ON 23
ci_0025                -1.119000e-02 3 1  ON 24
ci_0026                -1.119523e-02 3 1  ON 25
ci_0027                -1.141557e-02 3 1  ON 26
ci_0028                -1.147573e-02 3 1  ON 27
ci_0029                -1.085429e-02 3 1  ON 28
ci_0030                -1.048862e-02 3 1  ON 29
ci_0031                 1.942337e-02 3 1  ON 30
ci_0032                 1.932915e-02 3 1  ON 31
ci_0033                 9.746198e-03 3 1  ON 32
ci_0034                 1.063868e-02 3 1  ON 33
ci_0035                 6.608290e-03 3 1  ON 34
ci_0036                 4.347887e-03 3 1  ON 35
ci_0037                -1.150462e-02 3 1  ON 36
ci_0038                -1.066795e-02 3 1  ON 37
ci_0039                -4.192305e-03 3 1  ON 38
ci_0040                -4.017428e-03 3 1  ON 39
ci_0041                 8.605135e-03 3 1  ON 40
ci_0042                 8.380655e-03 3 1  ON 41
ci_0043                -1.325165e-02 3 1  ON 42
ci_0044                -1.355361e-02 3 1  ON 43
ci_0045                 8.126994e-03 3 1  ON 44
ci_0046                 7.887710e-03 3 1  ON 45
ci_0047                -3.628739e-03 3 1  ON 46
ci_0048                -3.158777e-03 3 1  ON 47
ci_0049                -6.786742e-03 3 1  ON 48
ci_0050                -5.925043e-03 3 1  ON 49
ci_0051                -4.466008e-03 3 1  ON 50
ci_0052                -4.605710e-03 3 1  ON 51
ci_0053                -6.287810e-03 3 1  ON 52
ci_0054                -5.920092e-03 3 1  ON 53
ci_0055                 6.396134e-03 3 1  ON 54
ci_0056                 6.757233e-03 3 1  ON 55
ci_0057                 5.673969e-03 3 1  ON 56
ci_0058                 4.652012e-03 3 1  ON 57
ci_0059                -5.804726e-03 3 1  ON 58
ci_0060                -5.906770e-03 3 1  ON 59
ci_0061                -3.679987e-03 3 1  ON 60
ci_0062                -4.028709e-03 3 1  ON 61
ci_0063                -9.183183e-03 3 1  ON 62
ci_0064                -8.529757e-03 3 1  ON 63
ci_0065                -6.663777e-03 3 1  ON 64
ci_0066                -6.887456e-03 3 1  ON 65
ci_0067                -6.030987e-03 3 1  ON 66
ci_0068                -6.256966e-03 3 1  ON 67
ci_0069                 5.320378e-03 3 1  ON 68
ci_0070                 5.450897e-03 3 1  ON 69
ci_0071                 4.222861e-03 3 1  ON 70
ci_0072                 5.178623e-03 3 1  ON 71
ci_0073                 5.141012e-03 3 1  ON 72
ci_0074                 5.516660e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2020e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6913e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.9376
    reference variance = 0.78193
====================================================
  Execution time = 1.4410e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5236e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2288e-01
  Total weights = 1.951686605e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5692e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310330548232
                                         uncertainty =       0.002170664714

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310330548232
                                         uncertainty =       0.002170664714

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393898693
  error estimate for blocks of size 2^( 2) =       0.000407919753
  error estimate for blocks of size 2^( 3) =       0.000421599306
  error estimate for blocks of size 2^( 4) =       0.000433451804
  error estimate for blocks of size 2^( 5) =       0.000444464932
  error estimate for blocks of size 2^( 6) =       0.000453733815
  error estimate for blocks of size 2^( 7) =       0.000457628919

      target function =                  N/A
              le_mean =     -16.904032305721
             les_mean =     286.069183511900
             stat err =       0.000447319868
             autocorr =       1.289636440241
              std dev =       0.557056873612
             le_variance =       0.310312360439


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690403230572e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904032305723       residual = 4.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904066205105       residual = 3.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904075041046       residual = 9.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904075161544       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904073039993       residual = 7.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904074684325       residual = 4.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904075148131       residual = 1.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.2500e-02 is 4.254883e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904032305723       residual = 4.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904051622852       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904054898576       residual = 7.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904055092602       residual = 3.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904054942033       residual = 1.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.5000e-01 is 2.111401e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904032305723       residual = 4.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904039405884       residual = 3.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904040361258       residual = 2.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904040455903       residual = 3.80e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.0000e+00 is 7.921775e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.144346 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6986e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
ci_0001                 7.022439e-01 3 1  ON 0
ci_0002                 6.985291e-01 3 1  ON 1
ci_0003                -3.065296e-02 3 1  ON 2
ci_0004                -3.121689e-02 3 1  ON 3
ci_0005                -3.370198e-02 3 1  ON 4
ci_0006                -3.409703e-02 3 1  ON 5
ci_0007                -2.277582e-02 3 1  ON 6
ci_0008                -2.264372e-02 3 1  ON 7
ci_0009                -1.990495e-02 3 1  ON 8
ci_0010                -1.977576e-02 3 1  ON 9
ci_0011                -1.513927e-02 3 1  ON 10
ci_0012                -1.525111e-02 3 1  ON 11
ci_0013                 1.558578e-02 3 1  ON 12
ci_0014                 1.530710e-02 3 1  ON 13
ci_0015                 1.654987e-02 3 1  ON 14
ci_0016                 1.570444e-02 3 1  ON 15
ci_0017                 1.452466e-02 3 1  ON 16
ci_0018                 1.362399e-02 3 1  ON 17
ci_0019                 1.226292e-02 3 1  ON 18
ci_0020                 1.202398e-02 3 1  ON 19
ci_0021                 6.207041e-03 3 1  ON 20
ci_0022                 8.223076e-03 3 1  ON 21
ci_0023                -1.172607e-02 3 1  ON 22
ci_0024                -1.104803e-02 3 1  ON 23
ci_0025                -1.155737e-02 3 1  ON 24
ci_0026                -1.154007e-02 3 1  ON 25
ci_0027                -1.188555e-02 3 1  ON 26
ci_0028                -1.136208e-02 3 1  ON 27
ci_0029                -1.038393e-02 3 1  ON 28
ci_0030                -1.016178e-02 3 1  ON 29
ci_0031                 1.917476e-02 3 1  ON 30
ci_0032                 1.916089e-02 3 1  ON 31
ci_0033                 8.338772e-03 3 1  ON 32
ci_0034                 9.422545e-03 3 1  ON 33
ci_0035                 5.019733e-03 3 1  ON 34
ci_0036                 6.459287e-03 3 1  ON 35
ci_0037                -1.114238e-02 3 1  ON 36
ci_0038                -1.130276e-02 3 1  ON 37
ci_0039                -4.421431e-03 3 1  ON 38
ci_0040                -4.321048e-03 3 1  ON 39
ci_0041                 8.649094e-03 3 1  ON 40
ci_0042                 8.835471e-03 3 1  ON 41
ci_0043                -1.355779e-02 3 1  ON 42
ci_0044                -1.341689e-02 3 1  ON 43
ci_0045                 8.227944e-03 3 1  ON 44
ci_0046                 7.887966e-03 3 1  ON 45
ci_0047                -3.414508e-03 3 1  ON 46
ci_0048                -2.970615e-03 3 1  ON 47
ci_0049                -6.297918e-03 3 1  ON 48
ci_0050                -7.343483e-03 3 1  ON 49
ci_0051                -4.280997e-03 3 1  ON 50
ci_0052                -4.645852e-03 3 1  ON 51
ci_0053                -6.154877e-03 3 1  ON 52
ci_0054                -5.667563e-03 3 1  ON 53
ci_0055                 6.739056e-03 3 1  ON 54
ci_0056                 7.629099e-03 3 1  ON 55
ci_0057                 4.714663e-03 3 1  ON 56
ci_0058                 6.075913e-03 3 1  ON 57
ci_0059                -5.732001e-03 3 1  ON 58
ci_0060                -6.405756e-03 3 1  ON 59
ci_0061                -3.345767e-03 3 1  ON 60
ci_0062                -3.940823e-03 3 1  ON 61
ci_0063                -9.135396e-03 3 1  ON 62
ci_0064                -8.457336e-03 3 1  ON 63
ci_0065                -6.683959e-03 3 1  ON 64
ci_0066                -6.895571e-03 3 1  ON 65
ci_0067                -5.568771e-03 3 1  ON 66
ci_0068                -6.331388e-03 3 1  ON 67
ci_0069                 5.586412e-03 3 1  ON 68
ci_0070                 5.453881e-03 3 1  ON 69
ci_0071                 4.087695e-03 3 1  ON 70
ci_0072                 4.773927e-03 3 1  ON 71
ci_0073                 5.244776e-03 3 1  ON 72
ci_0074                 5.705840e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.9252
    reference variance = 0.280902
====================================================
  Execution time = 1.4516e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2530e-01
  Total weights = 1.9517e+06
  Execution time = 1.9400e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00777766
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312256549175
                                         uncertainty =       0.002257036603

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312256549175
                                         uncertainty =       0.002257036603

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395186242
  error estimate for blocks of size 2^( 2) =       0.000409199205
  error estimate for blocks of size 2^( 3) =       0.000424126619
  error estimate for blocks of size 2^( 4) =       0.000437929584
  error estimate for blocks of size 2^( 5) =       0.000450375086
  error estimate for blocks of size 2^( 6) =       0.000459817236
  error estimate for blocks of size 2^( 7) =       0.000467081769

      target function =                  N/A
              le_mean =     -16.904681467743
             les_mean =     286.140685075962
             stat err =       0.000453800919
             autocorr =       1.318642617065
              std dev =       0.558877743527
             le_variance =       0.312344332209

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0158207
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313935999495
                                         uncertainty =       0.002305877695

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313935999495
                                         uncertainty =       0.002305877695

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396244868
  error estimate for blocks of size 2^( 2) =       0.000410195900
  error estimate for blocks of size 2^( 3) =       0.000425064868
  error estimate for blocks of size 2^( 4) =       0.000438815397
  error estimate for blocks of size 2^( 5) =       0.000451249210
  error estimate for blocks of size 2^( 6) =       0.000460624403
  error estimate for blocks of size 2^( 7) =       0.000467852013

      target function =                  N/A
              le_mean =     -16.904661972618
             les_mean =     286.111724742426
             stat err =       0.000454635255
             autocorr =       1.316433483834
              std dev =       0.560374866581
             le_variance =       0.314019991096

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00790744
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314524862157
                                         uncertainty =       0.002346897473

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314524862157
                                         uncertainty =       0.002346897473

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396615994
  error estimate for blocks of size 2^( 2) =       0.000410554680
  error estimate for blocks of size 2^( 3) =       0.000425409705
  error estimate for blocks of size 2^( 4) =       0.000439148859
  error estimate for blocks of size 2^( 5) =       0.000451583391
  error estimate for blocks of size 2^( 6) =       0.000460936535
  error estimate for blocks of size 2^( 7) =       0.000468135664

      target function =                  N/A
              le_mean =     -16.904681100988
             les_mean =     286.133263204605
             stat err =       0.000454951112
             autocorr =       1.315797372709
              std dev =       0.560899717754
             le_variance =       0.314608493376

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.040044
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312324870557
                                         uncertainty =       0.002247758954

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312324870557
                                         uncertainty =       0.002247758954

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395229062
  error estimate for blocks of size 2^( 2) =       0.000409238999
  error estimate for blocks of size 2^( 3) =       0.000424156773
  error estimate for blocks of size 2^( 4) =       0.000437943361
  error estimate for blocks of size 2^( 5) =       0.000450388184
  error estimate for blocks of size 2^( 6) =       0.000459887069
  error estimate for blocks of size 2^( 7) =       0.000467213797

      target function =                  N/A
              le_mean =     -16.904634067323
             les_mean =     286.107897611306
             stat err =       0.000453858103
             autocorr =       1.318689184140
              std dev =       0.558938299439
             le_variance =       0.312412022580


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904681467743        initial  <--
     6.2500e-02     6.2500e-01             4.2549e-03       -16.904661972618
     2.5000e-01     2.5000e+00             2.1114e-03       -16.904681100988
     1.0000e+00     1.0000e+01             7.9218e-04       -16.904634067323

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.1152
  </log>
  <optVariables href="H2O.s001.opt.xml">
ci_0001                 7.011189e-01 3 1  ON 0
ci_0002                 6.996365e-01 3 1  ON 1
ci_0003                -3.045619e-02 3 1  ON 2
ci_0004                -3.092328e-02 3 1  ON 3
ci_0005                -3.366086e-02 3 1  ON 4
ci_0006                -3.479306e-02 3 1  ON 5
ci_0007                -2.185309e-02 3 1  ON 6
ci_0008                -2.318178e-02 3 1  ON 7
ci_0009                -1.986138e-02 3 1  ON 8
ci_0010                -2.026599e-02 3 1  ON 9
ci_0011                -1.477376e-02 3 1  ON 10
ci_0012                -1.481538e-02 3 1  ON 11
ci_0013                 1.605980e-02 3 1  ON 12
ci_0014                 1.527635e-02 3 1  ON 13
ci_0015                 1.614974e-02 3 1  ON 14
ci_0016                 1.559582e-02 3 1  ON 15
ci_0017                 1.425826e-02 3 1  ON 16
ci_0018                 1.406208e-02 3 1  ON 17
ci_0019                 1.261069e-02 3 1  ON 18
ci_0020                 1.185630e-02 3 1  ON 19
ci_0021                 6.897104e-03 3 1  ON 20
ci_0022                 7.158506e-03 3 1  ON 21
ci_0023                -1.184331e-02 3 1  ON 22
ci_0024                -1.122265e-02 3 1  ON 23
ci_0025                -1.119000e-02 3 1  ON 24
ci_0026                -1.119523e-02 3 1  ON 25
ci_0027                -1.141557e-02 3 1  ON 26
ci_0028                -1.147573e-02 3 1  ON 27
ci_0029                -1.085429e-02 3 1  ON 28
ci_0030                -1.048862e-02 3 1  ON 29
ci_0031                 1.942337e-02 3 1  ON 30
ci_0032                 1.932915e-02 3 1  ON 31
ci_0033                 9.746198e-03 3 1  ON 32
ci_0034                 1.063868e-02 3 1  ON 33
ci_0035                 6.608290e-03 3 1  ON 34
ci_0036                 4.347887e-03 3 1  ON 35
ci_0037                -1.150462e-02 3 1  ON 36
ci_0038                -1.066795e-02 3 1  ON 37
ci_0039                -4.192305e-03 3 1  ON 38
ci_0040                -4.017428e-03 3 1  ON 39
ci_0041                 8.605135e-03 3 1  ON 40
ci_0042                 8.380655e-03 3 1  ON 41
ci_0043                -1.325165e-02 3 1  ON 42
ci_0044                -1.355361e-02 3 1  ON 43
ci_0045                 8.126994e-03 3 1  ON 44
ci_0046                 7.887710e-03 3 1  ON 45
ci_0047                -3.628739e-03 3 1  ON 46
ci_0048                -3.158777e-03 3 1  ON 47
ci_0049                -6.786742e-03 3 1  ON 48
ci_0050                -5.925043e-03 3 1  ON 49
ci_0051                -4.466008e-03 3 1  ON 50
ci_0052                -4.605710e-03 3 1  ON 51
ci_0053                -6.287810e-03 3 1  ON 52
ci_0054                -5.920092e-03 3 1  ON 53
ci_0055                 6.396134e-03 3 1  ON 54
ci_0056                 6.757233e-03 3 1  ON 55
ci_0057                 5.673969e-03 3 1  ON 56
ci_0058                 4.652012e-03 3 1  ON 57
ci_0059                -5.804726e-03 3 1  ON 58
ci_0060                -5.906770e-03 3 1  ON 59
ci_0061                -3.679987e-03 3 1  ON 60
ci_0062                -4.028709e-03 3 1  ON 61
ci_0063                -9.183183e-03 3 1  ON 62
ci_0064                -8.529757e-03 3 1  ON 63
ci_0065                -6.663777e-03 3 1  ON 64
ci_0066                -6.887456e-03 3 1  ON 65
ci_0067                -6.030987e-03 3 1  ON 66
ci_0068                -6.256966e-03 3 1  ON 67
ci_0069                 5.320378e-03 3 1  ON 68
ci_0070                 5.450897e-03 3 1  ON 69
ci_0071                 4.222861e-03 3 1  ON 70
ci_0072                 5.178623e-03 3 1  ON 71
ci_0073                 5.141012e-03 3 1  ON 72
ci_0074                 5.516660e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1108e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6922e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.9861
    reference variance = 0.412636
====================================================
  Execution time = 1.4373e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5254e+04
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.2517e-01
  Total weights = 1.951843928e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5839e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313055886611
                                         uncertainty =       0.002529643165

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313055886611
                                         uncertainty =       0.002529643165

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395632151
  error estimate for blocks of size 2^( 2) =       0.000409478367
  error estimate for blocks of size 2^( 3) =       0.000423798599
  error estimate for blocks of size 2^( 4) =       0.000437469470
  error estimate for blocks of size 2^( 5) =       0.000448847622
  error estimate for blocks of size 2^( 6) =       0.000456868664
  error estimate for blocks of size 2^( 7) =       0.000462085486

      target function =                  N/A
              le_mean =     -16.903400729641
             les_mean =     286.050124161112
             stat err =       0.000451317810
             autocorr =       1.301313066149
              std dev =       0.559508353688
             le_variance =       0.313049597847


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690340072964e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903400729637       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903412618073       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.903412696043       residual = 3.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.903412754077       residual = 5.40e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.2500e-01 is 7.527141e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903400729637       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903404380312       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.903404459729       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.903404457734       residual = 2.04e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.5000e+00 is 2.295389e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903400729637       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903401697552       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.903401724034       residual = 2.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.903401722236       residual = 2.93e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.0000e+01 is 6.072552e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.145729 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6962e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
ci_0001                 7.011316e-01 3 1  ON 0
ci_0002                 6.996317e-01 3 1  ON 1
ci_0003                -3.042003e-02 3 1  ON 2
ci_0004                -3.089721e-02 3 1  ON 3
ci_0005                -3.362910e-02 3 1  ON 4
ci_0006                -3.479823e-02 3 1  ON 5
ci_0007                -2.196075e-02 3 1  ON 6
ci_0008                -2.317936e-02 3 1  ON 7
ci_0009                -1.981505e-02 3 1  ON 8
ci_0010                -2.018851e-02 3 1  ON 9
ci_0011                -1.476686e-02 3 1  ON 10
ci_0012                -1.478722e-02 3 1  ON 11
ci_0013                 1.596556e-02 3 1  ON 12
ci_0014                 1.531444e-02 3 1  ON 13
ci_0015                 1.610030e-02 3 1  ON 14
ci_0016                 1.566576e-02 3 1  ON 15
ci_0017                 1.418527e-02 3 1  ON 16
ci_0018                 1.399412e-02 3 1  ON 17
ci_0019                 1.254752e-02 3 1  ON 18
ci_0020                 1.188020e-02 3 1  ON 19
ci_0021                 6.877796e-03 3 1  ON 20
ci_0022                 7.119158e-03 3 1  ON 21
ci_0023                -1.187434e-02 3 1  ON 22
ci_0024                -1.124794e-02 3 1  ON 23
ci_0025                -1.123554e-02 3 1  ON 24
ci_0026                -1.129266e-02 3 1  ON 25
ci_0027                -1.137403e-02 3 1  ON 26
ci_0028                -1.150083e-02 3 1  ON 27
ci_0029                -1.081945e-02 3 1  ON 28
ci_0030                -1.053241e-02 3 1  ON 29
ci_0031                 1.938858e-02 3 1  ON 30
ci_0032                 1.929475e-02 3 1  ON 31
ci_0033                 9.793523e-03 3 1  ON 32
ci_0034                 1.060540e-02 3 1  ON 33
ci_0035                 6.605032e-03 3 1  ON 34
ci_0036                 4.577426e-03 3 1  ON 35
ci_0037                -1.145928e-02 3 1  ON 36
ci_0038                -1.060327e-02 3 1  ON 37
ci_0039                -4.210349e-03 3 1  ON 38
ci_0040                -4.035913e-03 3 1  ON 39
ci_0041                 8.567497e-03 3 1  ON 40
ci_0042                 8.450593e-03 3 1  ON 41
ci_0043                -1.327108e-02 3 1  ON 42
ci_0044                -1.351742e-02 3 1  ON 43
ci_0045                 8.114024e-03 3 1  ON 44
ci_0046                 7.933657e-03 3 1  ON 45
ci_0047                -3.625622e-03 3 1  ON 46
ci_0048                -3.164489e-03 3 1  ON 47
ci_0049                -6.753458e-03 3 1  ON 48
ci_0050                -6.035693e-03 3 1  ON 49
ci_0051                -4.536466e-03 3 1  ON 50
ci_0052                -4.588725e-03 3 1  ON 51
ci_0053                -6.313116e-03 3 1  ON 52
ci_0054                -5.953216e-03 3 1  ON 53
ci_0055                 6.474460e-03 3 1  ON 54
ci_0056                 6.673579e-03 3 1  ON 55
ci_0057                 5.615285e-03 3 1  ON 56
ci_0058                 4.742829e-03 3 1  ON 57
ci_0059                -5.798724e-03 3 1  ON 58
ci_0060                -5.897599e-03 3 1  ON 59
ci_0061                -3.702271e-03 3 1  ON 60
ci_0062                -3.910311e-03 3 1  ON 61
ci_0063                -9.123828e-03 3 1  ON 62
ci_0064                -8.446882e-03 3 1  ON 63
ci_0065                -6.658809e-03 3 1  ON 64
ci_0066                -6.923444e-03 3 1  ON 65
ci_0067                -6.081789e-03 3 1  ON 66
ci_0068                -6.231870e-03 3 1  ON 67
ci_0069                 5.376992e-03 3 1  ON 68
ci_0070                 5.501590e-03 3 1  ON 69
ci_0071                 4.260320e-03 3 1  ON 70
ci_0072                 5.182837e-03 3 1  ON 71
ci_0073                 5.156718e-03 3 1  ON 72
ci_0074                 5.504407e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.8666
    reference variance = 0.153478
====================================================
  Execution time = 1.4290e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2594e-01
  Total weights = 1.9517e+06
  Execution time = 1.8904e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314222122897
                                         uncertainty =       0.003177361201

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314222122897
                                         uncertainty =       0.003177361201

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396344244
  error estimate for blocks of size 2^( 2) =       0.000410553119
  error estimate for blocks of size 2^( 3) =       0.000424511476
  error estimate for blocks of size 2^( 4) =       0.000437909061
  error estimate for blocks of size 2^( 5) =       0.000448061631
  error estimate for blocks of size 2^( 6) =       0.000454926403
  error estimate for blocks of size 2^( 7) =       0.000459266283

      target function =                  N/A
              le_mean =     -16.904327190679
             les_mean =     286.083172534598
             stat err =       0.000450040844
             autocorr =       1.289314153196
              std dev =       0.560515405625
             le_variance =       0.314177519943

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314478810003
                                         uncertainty =       0.003164595482

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314478810003
                                         uncertainty =       0.003164595482

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396505970
  error estimate for blocks of size 2^( 2) =       0.000410724253
  error estimate for blocks of size 2^( 3) =       0.000424682526
  error estimate for blocks of size 2^( 4) =       0.000438087055
  error estimate for blocks of size 2^( 5) =       0.000448240253
  error estimate for blocks of size 2^( 6) =       0.000455105336
  error estimate for blocks of size 2^( 7) =       0.000459453382

      target function =                  N/A
              le_mean =     -16.904327170761
             les_mean =     286.092323458948
             stat err =       0.000450221507
             autocorr =       1.289297121944
              std dev =       0.560744119899
             le_variance =       0.314433968002

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314376146901
                                         uncertainty =       0.003168825357

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314376146901
                                         uncertainty =       0.003168825357

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396441288
  error estimate for blocks of size 2^( 2) =       0.000410655801
  error estimate for blocks of size 2^( 3) =       0.000424613886
  error estimate for blocks of size 2^( 4) =       0.000438015222
  error estimate for blocks of size 2^( 5) =       0.000448169392
  error estimate for blocks of size 2^( 6) =       0.000455035899
  error estimate for blocks of size 2^( 7) =       0.000459379837

      target function =                  N/A
              le_mean =     -16.904325767556
             les_mean =     286.083647113342
             stat err =       0.000450150088
             autocorr =       1.289308722918
              std dev =       0.560652646349
             le_variance =       0.314331389858

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314241058270
                                         uncertainty =       0.003176161232

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314241058270
                                         uncertainty =       0.003176161232

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396356175
  error estimate for blocks of size 2^( 2) =       0.000410565763
  error estimate for blocks of size 2^( 3) =       0.000424524108
  error estimate for blocks of size 2^( 4) =       0.000437922249
  error estimate for blocks of size 2^( 5) =       0.000448075049
  error estimate for blocks of size 2^( 6) =       0.000454940087
  error estimate for blocks of size 2^( 7) =       0.000459280256

      target function =                  N/A
              le_mean =     -16.904326870563
             les_mean =     286.083107217314
             stat err =       0.000450054410
             autocorr =       1.289314259982
              std dev =       0.560532278479
             le_variance =       0.314196435216


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904327190679        initial  <--
     6.2500e-01     6.2500e+00             7.5271e-04       -16.904327170761
     2.5000e+00     2.5000e+01             2.2954e-04       -16.904325767556
     1.0000e+01     1.0000e+02             6.0726e-05       -16.904326870563

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.8524
  </log>
  <optVariables href="H2O.s002.opt.xml">
ci_0001                 7.011189e-01 3 1  ON 0
ci_0002                 6.996365e-01 3 1  ON 1
ci_0003                -3.045619e-02 3 1  ON 2
ci_0004                -3.092328e-02 3 1  ON 3
ci_0005                -3.366086e-02 3 1  ON 4
ci_0006                -3.479306e-02 3 1  ON 5
ci_0007                -2.185309e-02 3 1  ON 6
ci_0008                -2.318178e-02 3 1  ON 7
ci_0009                -1.986138e-02 3 1  ON 8
ci_0010                -2.026599e-02 3 1  ON 9
ci_0011                -1.477376e-02 3 1  ON 10
ci_0012                -1.481538e-02 3 1  ON 11
ci_0013                 1.605980e-02 3 1  ON 12
ci_0014                 1.527635e-02 3 1  ON 13
ci_0015                 1.614974e-02 3 1  ON 14
ci_0016                 1.559582e-02 3 1  ON 15
ci_0017                 1.425826e-02 3 1  ON 16
ci_0018                 1.406208e-02 3 1  ON 17
ci_0019                 1.261069e-02 3 1  ON 18
ci_0020                 1.185630e-02 3 1  ON 19
ci_0021                 6.897104e-03 3 1  ON 20
ci_0022                 7.158506e-03 3 1  ON 21
ci_0023                -1.184331e-02 3 1  ON 22
ci_0024                -1.122265e-02 3 1  ON 23
ci_0025                -1.119000e-02 3 1  ON 24
ci_0026                -1.119523e-02 3 1  ON 25
ci_0027                -1.141557e-02 3 1  ON 26
ci_0028                -1.147573e-02 3 1  ON 27
ci_0029                -1.085429e-02 3 1  ON 28
ci_0030                -1.048862e-02 3 1  ON 29
ci_0031                 1.942337e-02 3 1  ON 30
ci_0032                 1.932915e-02 3 1  ON 31
ci_0033                 9.746198e-03 3 1  ON 32
ci_0034                 1.063868e-02 3 1  ON 33
ci_0035                 6.608290e-03 3 1  ON 34
ci_0036                 4.347887e-03 3 1  ON 35
ci_0037                -1.150462e-02 3 1  ON 36
ci_0038                -1.066795e-02 3 1  ON 37
ci_0039                -4.192305e-03 3 1  ON 38
ci_0040                -4.017428e-03 3 1  ON 39
ci_0041                 8.605135e-03 3 1  ON 40
ci_0042                 8.380655e-03 3 1  ON 41
ci_0043                -1.325165e-02 3 1  ON 42
ci_0044                -1.355361e-02 3 1  ON 43
ci_0045                 8.126994e-03 3 1  ON 44
ci_0046                 7.887710e-03 3 1  ON 45
ci_0047                -3.628739e-03 3 1  ON 46
ci_0048                -3.158777e-03 3 1  ON 47
ci_0049                -6.786742e-03 3 1  ON 48
ci_0050                -5.925043e-03 3 1  ON 49
ci_0051                -4.466008e-03 3 1  ON 50
ci_0052                -4.605710e-03 3 1  ON 51
ci_0053                -6.287810e-03 3 1  ON 52
ci_0054                -5.920092e-03 3 1  ON 53
ci_0055                 6.396134e-03 3 1  ON 54
ci_0056                 6.757233e-03 3 1  ON 55
ci_0057                 5.673969e-03 3 1  ON 56
ci_0058                 4.652012e-03 3 1  ON 57
ci_0059                -5.804726e-03 3 1  ON 58
ci_0060                -5.906770e-03 3 1  ON 59
ci_0061                -3.679987e-03 3 1  ON 60
ci_0062                -4.028709e-03 3 1  ON 61
ci_0063                -9.183183e-03 3 1  ON 62
ci_0064                -8.529757e-03 3 1  ON 63
ci_0065                -6.663777e-03 3 1  ON 64
ci_0066                -6.887456e-03 3 1  ON 65
ci_0067                -6.030987e-03 3 1  ON 66
ci_0068                -6.256966e-03 3 1  ON 67
ci_0069                 5.320378e-03 3 1  ON 68
ci_0070                 5.450897e-03 3 1  ON 69
ci_0071                 4.222861e-03 3 1  ON 70
ci_0072                 5.178623e-03 3 1  ON 71
ci_0073                 5.141012e-03 3 1  ON 72
ci_0074                 5.516660e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0825e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6924e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.8098
    reference variance = 0.281274
====================================================
  Execution time = 1.4382e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5274e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2318e-01
  Total weights = 1.951787811e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5661e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312140379131
                                         uncertainty =       0.002131177668

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312140379131
                                         uncertainty =       0.002131177668

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395041063
  error estimate for blocks of size 2^( 2) =       0.000408873166
  error estimate for blocks of size 2^( 3) =       0.000422767365
  error estimate for blocks of size 2^( 4) =       0.000436068166
  error estimate for blocks of size 2^( 5) =       0.000446519176
  error estimate for blocks of size 2^( 6) =       0.000455504388
  error estimate for blocks of size 2^( 7) =       0.000463537341

      target function =                  N/A
              le_mean =     -16.904275525548
             les_mean =     286.077706447898
             stat err =       0.000450407268
             autocorr =       1.299948947780
              std dev =       0.558672428900
             le_variance =       0.312114882813


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690427552555e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904275525570       residual = 1.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904277145021       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904277163183       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904277159887       residual = 9.65e-11           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.2500e+00 is 9.721244e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904275525570       residual = 1.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904275940379       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904275944348       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904275943160       residual = 1.05e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.5000e+01 is 2.487046e-05

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904275525570       residual = 1.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904275629913       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904275630870       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904275630547       residual = 1.08e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.0000e+02 is 6.254127e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.150161 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6961e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
ci_0001                 7.011161e-01 3 1  ON 0
ci_0002                 6.996398e-01 3 1  ON 1
ci_0003                -3.045309e-02 3 1  ON 2
ci_0004                -3.090846e-02 3 1  ON 3
ci_0005                -3.366563e-02 3 1  ON 4
ci_0006                -3.478776e-02 3 1  ON 5
ci_0007                -2.185738e-02 3 1  ON 6
ci_0008                -2.317882e-02 3 1  ON 7
ci_0009                -1.986730e-02 3 1  ON 8
ci_0010                -2.026575e-02 3 1  ON 9
ci_0011                -1.477580e-02 3 1  ON 10
ci_0012                -1.481435e-02 3 1  ON 11
ci_0013                 1.605639e-02 3 1  ON 12
ci_0014                 1.527642e-02 3 1  ON 13
ci_0015                 1.613847e-02 3 1  ON 14
ci_0016                 1.559024e-02 3 1  ON 15
ci_0017                 1.425061e-02 3 1  ON 16
ci_0018                 1.405315e-02 3 1  ON 17
ci_0019                 1.260638e-02 3 1  ON 18
ci_0020                 1.185388e-02 3 1  ON 19
ci_0021                 6.897427e-03 3 1  ON 20
ci_0022                 7.156949e-03 3 1  ON 21
ci_0023                -1.183542e-02 3 1  ON 22
ci_0024                -1.122669e-02 3 1  ON 23
ci_0025                -1.119796e-02 3 1  ON 24
ci_0026                -1.119022e-02 3 1  ON 25
ci_0027                -1.141338e-02 3 1  ON 26
ci_0028                -1.147702e-02 3 1  ON 27
ci_0029                -1.085966e-02 3 1  ON 28
ci_0030                -1.049108e-02 3 1  ON 29
ci_0031                 1.941983e-02 3 1  ON 30
ci_0032                 1.932542e-02 3 1  ON 31
ci_0033                 9.751544e-03 3 1  ON 32
ci_0034                 1.063777e-02 3 1  ON 33
ci_0035                 6.615149e-03 3 1  ON 34
ci_0036                 4.372757e-03 3 1  ON 35
ci_0037                -1.149976e-02 3 1  ON 36
ci_0038                -1.067137e-02 3 1  ON 37
ci_0039                -4.199258e-03 3 1  ON 38
ci_0040                -4.014042e-03 3 1  ON 39
ci_0041                 8.609900e-03 3 1  ON 40
ci_0042                 8.388025e-03 3 1  ON 41
ci_0043                -1.325531e-02 3 1  ON 42
ci_0044                -1.356767e-02 3 1  ON 43
ci_0045                 8.129025e-03 3 1  ON 44
ci_0046                 7.902675e-03 3 1  ON 45
ci_0047                -3.625070e-03 3 1  ON 46
ci_0048                -3.149653e-03 3 1  ON 47
ci_0049                -6.778458e-03 3 1  ON 48
ci_0050                -5.932658e-03 3 1  ON 49
ci_0051                -4.468266e-03 3 1  ON 50
ci_0052                -4.611551e-03 3 1  ON 51
ci_0053                -6.284395e-03 3 1  ON 52
ci_0054                -5.919536e-03 3 1  ON 53
ci_0055                 6.405795e-03 3 1  ON 54
ci_0056                 6.762384e-03 3 1  ON 55
ci_0057                 5.675890e-03 3 1  ON 56
ci_0058                 4.658770e-03 3 1  ON 57
ci_0059                -5.809830e-03 3 1  ON 58
ci_0060                -5.908004e-03 3 1  ON 59
ci_0061                -3.681457e-03 3 1  ON 60
ci_0062                -4.017777e-03 3 1  ON 61
ci_0063                -9.179228e-03 3 1  ON 62
ci_0064                -8.522423e-03 3 1  ON 63
ci_0065                -6.670357e-03 3 1  ON 64
ci_0066                -6.886639e-03 3 1  ON 65
ci_0067                -6.032383e-03 3 1  ON 66
ci_0068                -6.261164e-03 3 1  ON 67
ci_0069                 5.326865e-03 3 1  ON 68
ci_0070                 5.459827e-03 3 1  ON 69
ci_0071                 4.220688e-03 3 1  ON 70
ci_0072                 5.174889e-03 3 1  ON 71
ci_0073                 5.149007e-03 3 1  ON 72
ci_0074                 5.508612e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.9089
    reference variance = 0.317875
====================================================
  Execution time = 1.6173e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2416e-01
  Total weights = 1.9515e+06
  Execution time = 2.0426e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312023863523
                                         uncertainty =       0.002533940272

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312023863523
                                         uncertainty =       0.002533940272

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394987853
  error estimate for blocks of size 2^( 2) =       0.000408580744
  error estimate for blocks of size 2^( 3) =       0.000423576887
  error estimate for blocks of size 2^( 4) =       0.000436989405
  error estimate for blocks of size 2^( 5) =       0.000448250596
  error estimate for blocks of size 2^( 6) =       0.000456584389
  error estimate for blocks of size 2^( 7) =       0.000461395063

      target function =                  N/A
              le_mean =     -16.903793353326
             les_mean =     286.062379927136
             stat err =       0.000450804863
             autocorr =       1.302595897950
              std dev =       0.558597178090
             le_variance =       0.312030807370

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312065186891
                                         uncertainty =       0.002540249550

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312065186891
                                         uncertainty =       0.002540249550

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395014005
  error estimate for blocks of size 2^( 2) =       0.000408606282
  error estimate for blocks of size 2^( 3) =       0.000423601048
  error estimate for blocks of size 2^( 4) =       0.000437012579
  error estimate for blocks of size 2^( 5) =       0.000448274164
  error estimate for blocks of size 2^( 6) =       0.000456606258
  error estimate for blocks of size 2^( 7) =       0.000461416708

      target function =                  N/A
              le_mean =     -16.903792364279
             les_mean =     286.064032055573
             stat err =       0.000450827427
             autocorr =       1.302553805891
              std dev =       0.558634162947
             le_variance =       0.312072128012

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312044853586
                                         uncertainty =       0.002537147421

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312044853586
                                         uncertainty =       0.002537147421

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395001137
  error estimate for blocks of size 2^( 2) =       0.000408593715
  error estimate for blocks of size 2^( 3) =       0.000423589166
  error estimate for blocks of size 2^( 4) =       0.000437001142
  error estimate for blocks of size 2^( 5) =       0.000448262541
  error estimate for blocks of size 2^( 6) =       0.000456595455
  error estimate for blocks of size 2^( 7) =       0.000461405969

      target function =                  N/A
              le_mean =     -16.903792787251
             les_mean =     286.062392646640
             stat err =       0.000450816277
             autocorr =       1.302574234604
              std dev =       0.558615965376
             le_variance =       0.312051796772

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312026480067
                                         uncertainty =       0.002534341965

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312026480067
                                         uncertainty =       0.002534341965

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394989509
  error estimate for blocks of size 2^( 2) =       0.000408582360
  error estimate for blocks of size 2^( 3) =       0.000423578417
  error estimate for blocks of size 2^( 4) =       0.000436990867
  error estimate for blocks of size 2^( 5) =       0.000448252085
  error estimate for blocks of size 2^( 6) =       0.000456585767
  error estimate for blocks of size 2^( 7) =       0.000461396422

      target function =                  N/A
              le_mean =     -16.903793278658
             les_mean =     286.062378986620
             stat err =       0.000450806285
             autocorr =       1.302593192893
              std dev =       0.558599520112
             le_variance =       0.312033423870


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.903793353326        initial  <--
     6.2500e+00     6.2500e+01             9.7212e-05       -16.903792364279
     2.5000e+01     2.5000e+02             2.4870e-05       -16.903792787251
     1.0000e+02     1.0000e+03             6.2541e-06       -16.903793278658

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 25.8583
  </log>
  <optVariables href="H2O.s003.opt.xml">
ci_0001                 7.011189e-01 3 1  ON 0
ci_0002                 6.996365e-01 3 1  ON 1
ci_0003                -3.045619e-02 3 1  ON 2
ci_0004                -3.092328e-02 3 1  ON 3
ci_0005                -3.366086e-02 3 1  ON 4
ci_0006                -3.479306e-02 3 1  ON 5
ci_0007                -2.185309e-02 3 1  ON 6
ci_0008                -2.318178e-02 3 1  ON 7
ci_0009                -1.986138e-02 3 1  ON 8
ci_0010                -2.026599e-02 3 1  ON 9
ci_0011                -1.477376e-02 3 1  ON 10
ci_0012                -1.481538e-02 3 1  ON 11
ci_0013                 1.605980e-02 3 1  ON 12
ci_0014                 1.527635e-02 3 1  ON 13
ci_0015                 1.614974e-02 3 1  ON 14
ci_0016                 1.559582e-02 3 1  ON 15
ci_0017                 1.425826e-02 3 1  ON 16
ci_0018                 1.406208e-02 3 1  ON 17
ci_0019                 1.261069e-02 3 1  ON 18
ci_0020                 1.185630e-02 3 1  ON 19
ci_0021                 6.897104e-03 3 1  ON 20
ci_0022                 7.158506e-03 3 1  ON 21
ci_0023                -1.184331e-02 3 1  ON 22
ci_0024                -1.122265e-02 3 1  ON 23
ci_0025                -1.119000e-02 3 1  ON 24
ci_0026                -1.119523e-02 3 1  ON 25
ci_0027                -1.141557e-02 3 1  ON 26
ci_0028                -1.147573e-02 3 1  ON 27
ci_0029                -1.085429e-02 3 1  ON 28
ci_0030                -1.048862e-02 3 1  ON 29
ci_0031                 1.942337e-02 3 1  ON 30
ci_0032                 1.932915e-02 3 1  ON 31
ci_0033                 9.746198e-03 3 1  ON 32
ci_0034                 1.063868e-02 3 1  ON 33
ci_0035                 6.608290e-03 3 1  ON 34
ci_0036                 4.347887e-03 3 1  ON 35
ci_0037                -1.150462e-02 3 1  ON 36
ci_0038                -1.066795e-02 3 1  ON 37
ci_0039                -4.192305e-03 3 1  ON 38
ci_0040                -4.017428e-03 3 1  ON 39
ci_0041                 8.605135e-03 3 1  ON 40
ci_0042                 8.380655e-03 3 1  ON 41
ci_0043                -1.325165e-02 3 1  ON 42
ci_0044                -1.355361e-02 3 1  ON 43
ci_0045                 8.126994e-03 3 1  ON 44
ci_0046                 7.887710e-03 3 1  ON 45
ci_0047                -3.628739e-03 3 1  ON 46
ci_0048                -3.158777e-03 3 1  ON 47
ci_0049                -6.786742e-03 3 1  ON 48
ci_0050                -5.925043e-03 3 1  ON 49
ci_0051                -4.466008e-03 3 1  ON 50
ci_0052                -4.605710e-03 3 1  ON 51
ci_0053                -6.287810e-03 3 1  ON 52
ci_0054                -5.920092e-03 3 1  ON 53
ci_0055                 6.396134e-03 3 1  ON 54
ci_0056                 6.757233e-03 3 1  ON 55
ci_0057                 5.673969e-03 3 1  ON 56
ci_0058                 4.652012e-03 3 1  ON 57
ci_0059                -5.804726e-03 3 1  ON 58
ci_0060                -5.906770e-03 3 1  ON 59
ci_0061                -3.679987e-03 3 1  ON 60
ci_0062                -4.028709e-03 3 1  ON 61
ci_0063                -9.183183e-03 3 1  ON 62
ci_0064                -8.529757e-03 3 1  ON 63
ci_0065                -6.663777e-03 3 1  ON 64
ci_0066                -6.887456e-03 3 1  ON 65
ci_0067                -6.030987e-03 3 1  ON 66
ci_0068                -6.256966e-03 3 1  ON 67
ci_0069                 5.320378e-03 3 1  ON 68
ci_0070                 5.450897e-03 3 1  ON 69
ci_0071                 4.222861e-03 3 1  ON 70
ci_0072                 5.178623e-03 3 1  ON 71
ci_0073                 5.141012e-03 3 1  ON 72
ci_0074                 5.516660e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2834e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.8186
    reference variance = 0.171926
====================================================
  Execution time = 1.4713e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5239e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2188e-01
  Total weights = 1.951413351e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5690e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310206187815
                                         uncertainty =       0.001999797074

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310206187815
                                         uncertainty =       0.001999797074

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393793566
  error estimate for blocks of size 2^( 2) =       0.000408318259
  error estimate for blocks of size 2^( 3) =       0.000423953162
  error estimate for blocks of size 2^( 4) =       0.000437797688
  error estimate for blocks of size 2^( 5) =       0.000450152462
  error estimate for blocks of size 2^( 6) =       0.000460857113
  error estimate for blocks of size 2^( 7) =       0.000466542690

      target function =                  N/A
              le_mean =     -16.903566649811
             les_mean =     286.052441772929
             stat err =       0.000453837488
             autocorr =       1.328200075942
              std dev =       0.556908202221
             le_variance =       0.310146745701


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690356664981e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903566649820       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903566754140       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.903566758968       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.903566758499       residual = 7.83e-11           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.2500e+01 is 5.846409e-06

solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903566649820       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903566675974       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.903566677195       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.903566677078       residual = 7.87e-11           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.5000e+02 is 1.465264e-06

solving harmonic davidson linear method for identity shift 1.0000e+03, overlap shift 1.0000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903566649820       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903566656363       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.903566656669       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.903566656641       residual = 7.88e-11           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.0000e+03 is 3.665457e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.151516 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7287e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
ci_0001                 7.011189e-01 3 1  ON 0
ci_0002                 6.996364e-01 3 1  ON 1
ci_0003                -3.045640e-02 3 1  ON 2
ci_0004                -3.092362e-02 3 1  ON 3
ci_0005                -3.366119e-02 3 1  ON 4
ci_0006                -3.479243e-02 3 1  ON 5
ci_0007                -2.185412e-02 3 1  ON 6
ci_0008                -2.318237e-02 3 1  ON 7
ci_0009                -1.986073e-02 3 1  ON 8
ci_0010                -2.026587e-02 3 1  ON 9
ci_0011                -1.477417e-02 3 1  ON 10
ci_0012                -1.481578e-02 3 1  ON 11
ci_0013                 1.605974e-02 3 1  ON 12
ci_0014                 1.527681e-02 3 1  ON 13
ci_0015                 1.615082e-02 3 1  ON 14
ci_0016                 1.559515e-02 3 1  ON 15
ci_0017                 1.425756e-02 3 1  ON 16
ci_0018                 1.406150e-02 3 1  ON 17
ci_0019                 1.261032e-02 3 1  ON 18
ci_0020                 1.185649e-02 3 1  ON 19
ci_0021                 6.896791e-03 3 1  ON 20
ci_0022                 7.158788e-03 3 1  ON 21
ci_0023                -1.184319e-02 3 1  ON 22
ci_0024                -1.122232e-02 3 1  ON 23
ci_0025                -1.118943e-02 3 1  ON 24
ci_0026                -1.119575e-02 3 1  ON 25
ci_0027                -1.141579e-02 3 1  ON 26
ci_0028                -1.147607e-02 3 1  ON 27
ci_0029                -1.085431e-02 3 1  ON 28
ci_0030                -1.048803e-02 3 1  ON 29
ci_0031                 1.942213e-02 3 1  ON 30
ci_0032                 1.932908e-02 3 1  ON 31
ci_0033                 9.746265e-03 3 1  ON 32
ci_0034                 1.063832e-02 3 1  ON 33
ci_0035                 6.608483e-03 3 1  ON 34
ci_0036                 4.349352e-03 3 1  ON 35
ci_0037                -1.150480e-02 3 1  ON 36
ci_0038                -1.066812e-02 3 1  ON 37
ci_0039                -4.191971e-03 3 1  ON 38
ci_0040                -4.018302e-03 3 1  ON 39
ci_0041                 8.604657e-03 3 1  ON 40
ci_0042                 8.381409e-03 3 1  ON 41
ci_0043                -1.325138e-02 3 1  ON 42
ci_0044                -1.355332e-02 3 1  ON 43
ci_0045                 8.127510e-03 3 1  ON 44
ci_0046                 7.887873e-03 3 1  ON 45
ci_0047                -3.628199e-03 3 1  ON 46
ci_0048                -3.159597e-03 3 1  ON 47
ci_0049                -6.786430e-03 3 1  ON 48
ci_0050                -5.926446e-03 3 1  ON 49
ci_0051                -4.466858e-03 3 1  ON 50
ci_0052                -4.605593e-03 3 1  ON 51
ci_0053                -6.287963e-03 3 1  ON 52
ci_0054                -5.920495e-03 3 1  ON 53
ci_0055                 6.396473e-03 3 1  ON 54
ci_0056                 6.757978e-03 3 1  ON 55
ci_0057                 5.673647e-03 3 1  ON 56
ci_0058                 4.652804e-03 3 1  ON 57
ci_0059                -5.805911e-03 3 1  ON 58
ci_0060                -5.906934e-03 3 1  ON 59
ci_0061                -3.679982e-03 3 1  ON 60
ci_0062                -4.028393e-03 3 1  ON 61
ci_0063                -9.182336e-03 3 1  ON 62
ci_0064                -8.529861e-03 3 1  ON 63
ci_0065                -6.663489e-03 3 1  ON 64
ci_0066                -6.886814e-03 3 1  ON 65
ci_0067                -6.032087e-03 3 1  ON 66
ci_0068                -6.258138e-03 3 1  ON 67
ci_0069                 5.321384e-03 3 1  ON 68
ci_0070                 5.450197e-03 3 1  ON 69
ci_0071                 4.223019e-03 3 1  ON 70
ci_0072                 5.178114e-03 3 1  ON 71
ci_0073                 5.141459e-03 3 1  ON 72
ci_0074                 5.516796e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.811
    reference variance = 0.226317
====================================================
  Execution time = 1.4004e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2343e-01
  Total weights = 1.9519e+06
  Execution time = 1.8908e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312376444807
                                         uncertainty =       0.004424060090

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312376444807
                                         uncertainty =       0.004424060090

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395165480
  error estimate for blocks of size 2^( 2) =       0.000409571920
  error estimate for blocks of size 2^( 3) =       0.000423514134
  error estimate for blocks of size 2^( 4) =       0.000436687916
  error estimate for blocks of size 2^( 5) =       0.000448551726
  error estimate for blocks of size 2^( 6) =       0.000455743401
  error estimate for blocks of size 2^( 7) =       0.000461439637

      target function =                  N/A
              le_mean =     -16.904192681019
             les_mean =     286.075156335860
             stat err =       0.000450605670
             autocorr =       1.300275276888
              std dev =       0.558848381351
             le_variance =       0.312311513339

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312380481857
                                         uncertainty =       0.004424171096

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312380481857
                                         uncertainty =       0.004424171096

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395168031
  error estimate for blocks of size 2^( 2) =       0.000409574298
  error estimate for blocks of size 2^( 3) =       0.000423516259
  error estimate for blocks of size 2^( 4) =       0.000436689833
  error estimate for blocks of size 2^( 5) =       0.000448553262
  error estimate for blocks of size 2^( 6) =       0.000455744959
  error estimate for blocks of size 2^( 7) =       0.000461441098

      target function =                  N/A
              le_mean =     -16.904192641458
             les_mean =     286.075164813177
             stat err =       0.000450607288
             autocorr =       1.300267827549
              std dev =       0.558851989197
             le_variance =       0.312315545830

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312378468359
                                         uncertainty =       0.004424115424

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312378468359
                                         uncertainty =       0.004424115424

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395166759
  error estimate for blocks of size 2^( 2) =       0.000409573112
  error estimate for blocks of size 2^( 3) =       0.000423515199
  error estimate for blocks of size 2^( 4) =       0.000436688877
  error estimate for blocks of size 2^( 5) =       0.000448552496
  error estimate for blocks of size 2^( 6) =       0.000455744181
  error estimate for blocks of size 2^( 7) =       0.000461440369

      target function =                  N/A
              le_mean =     -16.904192660983
             les_mean =     286.075160449440
             stat err =       0.000450606481
             autocorr =       1.300271540680
              std dev =       0.558850189771
             le_variance =       0.312313534607

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312376697767
                                         uncertainty =       0.004424067000

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312376697767
                                         uncertainty =       0.004424067000

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395165640
  error estimate for blocks of size 2^( 2) =       0.000409572069
  error estimate for blocks of size 2^( 3) =       0.000423514267
  error estimate for blocks of size 2^( 4) =       0.000436688036
  error estimate for blocks of size 2^( 5) =       0.000448551822
  error estimate for blocks of size 2^( 6) =       0.000455743498
  error estimate for blocks of size 2^( 7) =       0.000461439728

      target function =                  N/A
              le_mean =     -16.904192678488
             les_mean =     286.075156835606
             stat err =       0.000450605771
             autocorr =       1.300274809592
              std dev =       0.558848607419
             le_variance =       0.312311766014


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904192681019        initial  <--
     6.2500e+01     6.2500e+02             5.8464e-06       -16.904192641458
     2.5000e+02     2.5000e+03             1.4653e-06       -16.904192660983
     1.0000e+03     1.0000e+04             3.6655e-07       -16.904192678488

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.5515
  </log>
  <optVariables href="H2O.s004.opt.xml">
ci_0001                 7.011189e-01 3 1  ON 0
ci_0002                 6.996365e-01 3 1  ON 1
ci_0003                -3.045619e-02 3 1  ON 2
ci_0004                -3.092328e-02 3 1  ON 3
ci_0005                -3.366086e-02 3 1  ON 4
ci_0006                -3.479306e-02 3 1  ON 5
ci_0007                -2.185309e-02 3 1  ON 6
ci_0008                -2.318178e-02 3 1  ON 7
ci_0009                -1.986138e-02 3 1  ON 8
ci_0010                -2.026599e-02 3 1  ON 9
ci_0011                -1.477376e-02 3 1  ON 10
ci_0012                -1.481538e-02 3 1  ON 11
ci_0013                 1.605980e-02 3 1  ON 12
ci_0014                 1.527635e-02 3 1  ON 13
ci_0015                 1.614974e-02 3 1  ON 14
ci_0016                 1.559582e-02 3 1  ON 15
ci_0017                 1.425826e-02 3 1  ON 16
ci_0018                 1.406208e-02 3 1  ON 17
ci_0019                 1.261069e-02 3 1  ON 18
ci_0020                 1.185630e-02 3 1  ON 19
ci_0021                 6.897104e-03 3 1  ON 20
ci_0022                 7.158506e-03 3 1  ON 21
ci_0023                -1.184331e-02 3 1  ON 22
ci_0024                -1.122265e-02 3 1  ON 23
ci_0025                -1.119000e-02 3 1  ON 24
ci_0026                -1.119523e-02 3 1  ON 25
ci_0027                -1.141557e-02 3 1  ON 26
ci_0028                -1.147573e-02 3 1  ON 27
ci_0029                -1.085429e-02 3 1  ON 28
ci_0030                -1.048862e-02 3 1  ON 29
ci_0031                 1.942337e-02 3 1  ON 30
ci_0032                 1.932915e-02 3 1  ON 31
ci_0033                 9.746198e-03 3 1  ON 32
ci_0034                 1.063868e-02 3 1  ON 33
ci_0035                 6.608290e-03 3 1  ON 34
ci_0036                 4.347887e-03 3 1  ON 35
ci_0037                -1.150462e-02 3 1  ON 36
ci_0038                -1.066795e-02 3 1  ON 37
ci_0039                -4.192305e-03 3 1  ON 38
ci_0040                -4.017428e-03 3 1  ON 39
ci_0041                 8.605135e-03 3 1  ON 40
ci_0042                 8.380655e-03 3 1  ON 41
ci_0043                -1.325165e-02 3 1  ON 42
ci_0044                -1.355361e-02 3 1  ON 43
ci_0045                 8.126994e-03 3 1  ON 44
ci_0046                 7.887710e-03 3 1  ON 45
ci_0047                -3.628739e-03 3 1  ON 46
ci_0048                -3.158777e-03 3 1  ON 47
ci_0049                -6.786742e-03 3 1  ON 48
ci_0050                -5.925043e-03 3 1  ON 49
ci_0051                -4.466008e-03 3 1  ON 50
ci_0052                -4.605710e-03 3 1  ON 51
ci_0053                -6.287810e-03 3 1  ON 52
ci_0054                -5.920092e-03 3 1  ON 53
ci_0055                 6.396134e-03 3 1  ON 54
ci_0056                 6.757233e-03 3 1  ON 55
ci_0057                 5.673969e-03 3 1  ON 56
ci_0058                 4.652012e-03 3 1  ON 57
ci_0059                -5.804726e-03 3 1  ON 58
ci_0060                -5.906770e-03 3 1  ON 59
ci_0061                -3.679987e-03 3 1  ON 60
ci_0062                -4.028709e-03 3 1  ON 61
ci_0063                -9.183183e-03 3 1  ON 62
ci_0064                -8.529757e-03 3 1  ON 63
ci_0065                -6.663777e-03 3 1  ON 64
ci_0066                -6.887456e-03 3 1  ON 65
ci_0067                -6.030987e-03 3 1  ON 66
ci_0068                -6.256966e-03 3 1  ON 67
ci_0069                 5.320378e-03 3 1  ON 68
ci_0070                 5.450897e-03 3 1  ON 69
ci_0071                 4.222861e-03 3 1  ON 70
ci_0072                 5.178623e-03 3 1  ON 71
ci_0073                 5.141012e-03 3 1  ON 72
ci_0074                 5.516660e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0853e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6889e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.9346
    reference variance = 0.31247
====================================================
  Execution time = 1.4597e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5244e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2460e-01
  Total weights = 1.951761061e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5858e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313104344649
                                         uncertainty =       0.002814417963

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313104344649
                                         uncertainty =       0.002814417963

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395699021
  error estimate for blocks of size 2^( 2) =       0.000409474179
  error estimate for blocks of size 2^( 3) =       0.000423446427
  error estimate for blocks of size 2^( 4) =       0.000435900237
  error estimate for blocks of size 2^( 5) =       0.000446807767
  error estimate for blocks of size 2^( 6) =       0.000454852559
  error estimate for blocks of size 2^( 7) =       0.000461150905

      target function =                  N/A
              le_mean =     -16.903963082328
             les_mean =     286.068572028996
             stat err =       0.000449677867
             autocorr =       1.291436552223
              std dev =       0.559602921539
             le_variance =       0.313155429795


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690396308233e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903963082329       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903963085979       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.903963086458       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.903963086528       residual = 2.39e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.2500e+02 is 1.051966e-06

solving harmonic davidson linear method for identity shift 2.5000e+03, overlap shift 2.5000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903963082329       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903963083242       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.903963083362       residual = 2.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.903963083379       residual = 2.39e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.5000e+03 is 2.630511e-07

solving harmonic davidson linear method for identity shift 1.0000e+04, overlap shift 1.0000e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903963082329       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903963082557       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.903963082587       residual = 2.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.903963082592       residual = 2.39e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.0000e+04 is 6.576650e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.152888 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7188e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
ci_0001                 7.011190e-01 3 1  ON 0
ci_0002                 6.996365e-01 3 1  ON 1
ci_0003                -3.045623e-02 3 1  ON 2
ci_0004                -3.092322e-02 3 1  ON 3
ci_0005                -3.366086e-02 3 1  ON 4
ci_0006                -3.479301e-02 3 1  ON 5
ci_0007                -2.185304e-02 3 1  ON 6
ci_0008                -2.318173e-02 3 1  ON 7
ci_0009                -1.986131e-02 3 1  ON 8
ci_0010                -2.026603e-02 3 1  ON 9
ci_0011                -1.477376e-02 3 1  ON 10
ci_0012                -1.481540e-02 3 1  ON 11
ci_0013                 1.605975e-02 3 1  ON 12
ci_0014                 1.527640e-02 3 1  ON 13
ci_0015                 1.614973e-02 3 1  ON 14
ci_0016                 1.559584e-02 3 1  ON 15
ci_0017                 1.425824e-02 3 1  ON 16
ci_0018                 1.406207e-02 3 1  ON 17
ci_0019                 1.261059e-02 3 1  ON 18
ci_0020                 1.185628e-02 3 1  ON 19
ci_0021                 6.897176e-03 3 1  ON 20
ci_0022                 7.158559e-03 3 1  ON 21
ci_0023                -1.184333e-02 3 1  ON 22
ci_0024                -1.122260e-02 3 1  ON 23
ci_0025                -1.119011e-02 3 1  ON 24
ci_0026                -1.119526e-02 3 1  ON 25
ci_0027                -1.141550e-02 3 1  ON 26
ci_0028                -1.147572e-02 3 1  ON 27
ci_0029                -1.085431e-02 3 1  ON 28
ci_0030                -1.048864e-02 3 1  ON 29
ci_0031                 1.942333e-02 3 1  ON 30
ci_0032                 1.932918e-02 3 1  ON 31
ci_0033                 9.746215e-03 3 1  ON 32
ci_0034                 1.063874e-02 3 1  ON 33
ci_0035                 6.608281e-03 3 1  ON 34
ci_0036                 4.348150e-03 3 1  ON 35
ci_0037                -1.150457e-02 3 1  ON 36
ci_0038                -1.066791e-02 3 1  ON 37
ci_0039                -4.192296e-03 3 1  ON 38
ci_0040                -4.017416e-03 3 1  ON 39
ci_0041                 8.605105e-03 3 1  ON 40
ci_0042                 8.380607e-03 3 1  ON 41
ci_0043                -1.325162e-02 3 1  ON 42
ci_0044                -1.355362e-02 3 1  ON 43
ci_0045                 8.127036e-03 3 1  ON 44
ci_0046                 7.887743e-03 3 1  ON 45
ci_0047                -3.628723e-03 3 1  ON 46
ci_0048                -3.158832e-03 3 1  ON 47
ci_0049                -6.786664e-03 3 1  ON 48
ci_0050                -5.925034e-03 3 1  ON 49
ci_0051                -4.465964e-03 3 1  ON 50
ci_0052                -4.605721e-03 3 1  ON 51
ci_0053                -6.287798e-03 3 1  ON 52
ci_0054                -5.920072e-03 3 1  ON 53
ci_0055                 6.396195e-03 3 1  ON 54
ci_0056                 6.757295e-03 3 1  ON 55
ci_0057                 5.673942e-03 3 1  ON 56
ci_0058                 4.652074e-03 3 1  ON 57
ci_0059                -5.804733e-03 3 1  ON 58
ci_0060                -5.906797e-03 3 1  ON 59
ci_0061                -3.680023e-03 3 1  ON 60
ci_0062                -4.028606e-03 3 1  ON 61
ci_0063                -9.183239e-03 3 1  ON 62
ci_0064                -8.529788e-03 3 1  ON 63
ci_0065                -6.663747e-03 3 1  ON 64
ci_0066                -6.887389e-03 3 1  ON 65
ci_0067                -6.031009e-03 3 1  ON 66
ci_0068                -6.256869e-03 3 1  ON 67
ci_0069                 5.320353e-03 3 1  ON 68
ci_0070                 5.450846e-03 3 1  ON 69
ci_0071                 4.222909e-03 3 1  ON 70
ci_0072                 5.178514e-03 3 1  ON 71
ci_0073                 5.141034e-03 3 1  ON 72
ci_0074                 5.516659e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.9046
    reference variance = 0.296123
====================================================
  Execution time = 1.4208e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2072e-01
  Total weights = 1.9519e+06
  Execution time = 1.8946e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309360027345
                                         uncertainty =       0.001918704685

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309360027345
                                         uncertainty =       0.001918704685

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393401821
  error estimate for blocks of size 2^( 2) =       0.000407273374
  error estimate for blocks of size 2^( 3) =       0.000421237504
  error estimate for blocks of size 2^( 4) =       0.000434690345
  error estimate for blocks of size 2^( 5) =       0.000444185847
  error estimate for blocks of size 2^( 6) =       0.000451404154
  error estimate for blocks of size 2^( 7) =       0.000456832828

      target function =                  N/A
              le_mean =     -16.904608003084
             les_mean =     286.086493458839
             stat err =       0.000446778294
             autocorr =       1.289767407480
              std dev =       0.556354191121
             le_variance =       0.309529985978

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309360377613
                                         uncertainty =       0.001918749422

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309360377613
                                         uncertainty =       0.001918749422

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393402043
  error estimate for blocks of size 2^( 2) =       0.000407273588
  error estimate for blocks of size 2^( 3) =       0.000421237725
  error estimate for blocks of size 2^( 4) =       0.000434690567
  error estimate for blocks of size 2^( 5) =       0.000444186100
  error estimate for blocks of size 2^( 6) =       0.000451404439
  error estimate for blocks of size 2^( 7) =       0.000456833145

      target function =                  N/A
              le_mean =     -16.904608004249
             les_mean =     286.086493756222
             stat err =       0.000446778563
             autocorr =       1.289767503640
              std dev =       0.556354505346
             le_variance =       0.309530335619

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309360202484
                                         uncertainty =       0.001918727054

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309360202484
                                         uncertainty =       0.001918727054

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393401932
  error estimate for blocks of size 2^( 2) =       0.000407273481
  error estimate for blocks of size 2^( 3) =       0.000421237615
  error estimate for blocks of size 2^( 4) =       0.000434690456
  error estimate for blocks of size 2^( 5) =       0.000444185974
  error estimate for blocks of size 2^( 6) =       0.000451404297
  error estimate for blocks of size 2^( 7) =       0.000456832987

      target function =                  N/A
              le_mean =     -16.904608003665
             les_mean =     286.086493605118
             stat err =       0.000446778428
             autocorr =       1.289767455615
              std dev =       0.556354348238
             le_variance =       0.309530160803

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309360049235
                                         uncertainty =       0.001918707481

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309360049235
                                         uncertainty =       0.001918707481

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393401835
  error estimate for blocks of size 2^( 2) =       0.000407273387
  error estimate for blocks of size 2^( 3) =       0.000421237518
  error estimate for blocks of size 2^( 4) =       0.000434690359
  error estimate for blocks of size 2^( 5) =       0.000444185863
  error estimate for blocks of size 2^( 6) =       0.000451404172
  error estimate for blocks of size 2^( 7) =       0.000456832848

      target function =                  N/A
              le_mean =     -16.904608003156
             les_mean =     286.086493476864
             stat err =       0.000446778311
             autocorr =       1.289767413496
              std dev =       0.556354210759
             le_variance =       0.309530007829


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904608003084        initial
     6.2500e+02     6.2500e+03             1.0520e-06       -16.904608004249  <--
     2.5000e+03     2.5000e+04             2.6305e-07       -16.904608003665
     1.0000e+04     1.0000e+05             6.5767e-08       -16.904608003156

*****************************************************************************
Applying the update for shift_i =   6.2500e+02     and shift_s =   6.2500e+03
*****************************************************************************

  Execution time = 2.3764e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
ci_0001                 7.011190e-01 3 1  ON 0
ci_0002                 6.996365e-01 3 1  ON 1
ci_0003                -3.045633e-02 3 1  ON 2
ci_0004                -3.092303e-02 3 1  ON 3
ci_0005                -3.366084e-02 3 1  ON 4
ci_0006                -3.479284e-02 3 1  ON 5
ci_0007                -2.185289e-02 3 1  ON 6
ci_0008                -2.318158e-02 3 1  ON 7
ci_0009                -1.986110e-02 3 1  ON 8
ci_0010                -2.026614e-02 3 1  ON 9
ci_0011                -1.477377e-02 3 1  ON 10
ci_0012                -1.481548e-02 3 1  ON 11
ci_0013                 1.605959e-02 3 1  ON 12
ci_0014                 1.527653e-02 3 1  ON 13
ci_0015                 1.614970e-02 3 1  ON 14
ci_0016                 1.559589e-02 3 1  ON 15
ci_0017                 1.425818e-02 3 1  ON 16
ci_0018                 1.406204e-02 3 1  ON 17
ci_0019                 1.261027e-02 3 1  ON 18
ci_0020                 1.185621e-02 3 1  ON 19
ci_0021                 6.897391e-03 3 1  ON 20
ci_0022                 7.158715e-03 3 1  ON 21
ci_0023                -1.184340e-02 3 1  ON 22
ci_0024                -1.122247e-02 3 1  ON 23
ci_0025                -1.119045e-02 3 1  ON 24
ci_0026                -1.119536e-02 3 1  ON 25
ci_0027                -1.141529e-02 3 1  ON 26
ci_0028                -1.147571e-02 3 1  ON 27
ci_0029                -1.085435e-02 3 1  ON 28
ci_0030                -1.048870e-02 3 1  ON 29
ci_0031                 1.942319e-02 3 1  ON 30
ci_0032                 1.932928e-02 3 1  ON 31
ci_0033                 9.746269e-03 3 1  ON 32
ci_0034                 1.063892e-02 3 1  ON 33
ci_0035                 6.608253e-03 3 1  ON 34
ci_0036                 4.348939e-03 3 1  ON 35
ci_0037                -1.150442e-02 3 1  ON 36
ci_0038                -1.066781e-02 3 1  ON 37
ci_0039                -4.192269e-03 3 1  ON 38
ci_0040                -4.017377e-03 3 1  ON 39
ci_0041                 8.605015e-03 3 1  ON 40
ci_0042                 8.380461e-03 3 1  ON 41
ci_0043                -1.325155e-02 3 1  ON 42
ci_0044                -1.355362e-02 3 1  ON 43
ci_0045                 8.127162e-03 3 1  ON 44
ci_0046                 7.887842e-03 3 1  ON 45
ci_0047                -3.628677e-03 3 1  ON 46
ci_0048                -3.158997e-03 3 1  ON 47
ci_0049                -6.786430e-03 3 1  ON 48
ci_0050                -5.925006e-03 3 1  ON 49
ci_0051                -4.465833e-03 3 1  ON 50
ci_0052                -4.605755e-03 3 1  ON 51
ci_0053                -6.287761e-03 3 1  ON 52
ci_0054                -5.920013e-03 3 1  ON 53
ci_0055                 6.396379e-03 3 1  ON 54
ci_0056                 6.757478e-03 3 1  ON 55
ci_0057                 5.673859e-03 3 1  ON 56
ci_0058                 4.652262e-03 3 1  ON 57
ci_0059                -5.804755e-03 3 1  ON 58
ci_0060                -5.906879e-03 3 1  ON 59
ci_0061                -3.680130e-03 3 1  ON 60
ci_0062                -4.028296e-03 3 1  ON 61
ci_0063                -9.183406e-03 3 1  ON 62
ci_0064                -8.529880e-03 3 1  ON 63
ci_0065                -6.663656e-03 3 1  ON 64
ci_0066                -6.887186e-03 3 1  ON 65
ci_0067                -6.031077e-03 3 1  ON 66
ci_0068                -6.256579e-03 3 1  ON 67
ci_0069                 5.320280e-03 3 1  ON 68
ci_0070                 5.450694e-03 3 1  ON 69
ci_0071                 4.223054e-03 3 1  ON 70
ci_0072                 5.178189e-03 3 1  ON 71
ci_0073                 5.141100e-03 3 1  ON 72
ci_0074                 5.516657e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0957e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6894e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.8921
    reference variance = 0.175653
====================================================
  Execution time = 1.4326e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5219e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2475e-01
  Total weights = 1.951938349e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5721e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314182707662
                                         uncertainty =       0.001900879284

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314182707662
                                         uncertainty =       0.001900879284

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396328897
  error estimate for blocks of size 2^( 2) =       0.000410474751
  error estimate for blocks of size 2^( 3) =       0.000424591779
  error estimate for blocks of size 2^( 4) =       0.000438314053
  error estimate for blocks of size 2^( 5) =       0.000448828063
  error estimate for blocks of size 2^( 6) =       0.000457291664
  error estimate for blocks of size 2^( 7) =       0.000460420368

      target function =                  N/A
              le_mean =     -16.904247107350
             les_mean =     286.078324374830
             stat err =       0.000451213537
             autocorr =       1.296142537588
              std dev =       0.560493701514
             le_variance =       0.314153189437


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690424710735e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904247107346       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904247154094       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904247155610       residual = 1.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904247155177       residual = 1.32e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5625e+02 is 3.668962e-06

solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904247107346       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904247119046       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904247119428       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904247119320       residual = 1.33e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.2500e+02 is 9.183164e-07

solving harmonic davidson linear method for identity shift 2.5000e+03, overlap shift 2.5000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904247107346       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904247110271       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904247110367       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904247110341       residual = 1.33e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.5000e+03 is 2.296464e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.154257 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6903e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
ci_0001                 7.011188e-01 3 1  ON 0
ci_0002                 6.996366e-01 3 1  ON 1
ci_0003                -3.045656e-02 3 1  ON 2
ci_0004                -3.092326e-02 3 1  ON 3
ci_0005                -3.366085e-02 3 1  ON 4
ci_0006                -3.479290e-02 3 1  ON 5
ci_0007                -2.185303e-02 3 1  ON 6
ci_0008                -2.318142e-02 3 1  ON 7
ci_0009                -1.986094e-02 3 1  ON 8
ci_0010                -2.026607e-02 3 1  ON 9
ci_0011                -1.477431e-02 3 1  ON 10
ci_0012                -1.481560e-02 3 1  ON 11
ci_0013                 1.605947e-02 3 1  ON 12
ci_0014                 1.527658e-02 3 1  ON 13
ci_0015                 1.614950e-02 3 1  ON 14
ci_0016                 1.559585e-02 3 1  ON 15
ci_0017                 1.425811e-02 3 1  ON 16
ci_0018                 1.406172e-02 3 1  ON 17
ci_0019                 1.260988e-02 3 1  ON 18
ci_0020                 1.185614e-02 3 1  ON 19
ci_0021                 6.897627e-03 3 1  ON 20
ci_0022                 7.158612e-03 3 1  ON 21
ci_0023                -1.184333e-02 3 1  ON 22
ci_0024                -1.122265e-02 3 1  ON 23
ci_0025                -1.119041e-02 3 1  ON 24
ci_0026                -1.119549e-02 3 1  ON 25
ci_0027                -1.141532e-02 3 1  ON 26
ci_0028                -1.147580e-02 3 1  ON 27
ci_0029                -1.085447e-02 3 1  ON 28
ci_0030                -1.048879e-02 3 1  ON 29
ci_0031                 1.942315e-02 3 1  ON 30
ci_0032                 1.932955e-02 3 1  ON 31
ci_0033                 9.746385e-03 3 1  ON 32
ci_0034                 1.063901e-02 3 1  ON 33
ci_0035                 6.608588e-03 3 1  ON 34
ci_0036                 4.349440e-03 3 1  ON 35
ci_0037                -1.150438e-02 3 1  ON 36
ci_0038                -1.066791e-02 3 1  ON 37
ci_0039                -4.192489e-03 3 1  ON 38
ci_0040                -4.017462e-03 3 1  ON 39
ci_0041                 8.605212e-03 3 1  ON 40
ci_0042                 8.380618e-03 3 1  ON 41
ci_0043                -1.325140e-02 3 1  ON 42
ci_0044                -1.355379e-02 3 1  ON 43
ci_0045                 8.127212e-03 3 1  ON 44
ci_0046                 7.887979e-03 3 1  ON 45
ci_0047                -3.628315e-03 3 1  ON 46
ci_0048                -3.159052e-03 3 1  ON 47
ci_0049                -6.786300e-03 3 1  ON 48
ci_0050                -5.925128e-03 3 1  ON 49
ci_0051                -4.465863e-03 3 1  ON 50
ci_0052                -4.605694e-03 3 1  ON 51
ci_0053                -6.287774e-03 3 1  ON 52
ci_0054                -5.920183e-03 3 1  ON 53
ci_0055                 6.396514e-03 3 1  ON 54
ci_0056                 6.757536e-03 3 1  ON 55
ci_0057                 5.673789e-03 3 1  ON 56
ci_0058                 4.652741e-03 3 1  ON 57
ci_0059                -5.804789e-03 3 1  ON 58
ci_0060                -5.906994e-03 3 1  ON 59
ci_0061                -3.680121e-03 3 1  ON 60
ci_0062                -4.028148e-03 3 1  ON 61
ci_0063                -9.183388e-03 3 1  ON 62
ci_0064                -8.530025e-03 3 1  ON 63
ci_0065                -6.664575e-03 3 1  ON 64
ci_0066                -6.887152e-03 3 1  ON 65
ci_0067                -6.030837e-03 3 1  ON 66
ci_0068                -6.256438e-03 3 1  ON 67
ci_0069                 5.320340e-03 3 1  ON 68
ci_0070                 5.450612e-03 3 1  ON 69
ci_0071                 4.223203e-03 3 1  ON 70
ci_0072                 5.178048e-03 3 1  ON 71
ci_0073                 5.140912e-03 3 1  ON 72
ci_0074                 5.516060e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.8965
    reference variance = 0.322056
====================================================
  Execution time = 1.4433e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2292e-01
  Total weights = 1.9520e+06
  Execution time = 1.8979e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310913359408
                                         uncertainty =       0.002261380971

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310913359408
                                         uncertainty =       0.002261380971

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394394001
  error estimate for blocks of size 2^( 2) =       0.000408238101
  error estimate for blocks of size 2^( 3) =       0.000422209581
  error estimate for blocks of size 2^( 4) =       0.000434824752
  error estimate for blocks of size 2^( 5) =       0.000445945682
  error estimate for blocks of size 2^( 6) =       0.000453933941
  error estimate for blocks of size 2^( 7) =       0.000458646933

      target function =                  N/A
              le_mean =     -16.904166399281
             les_mean =     286.073756990441
             stat err =       0.000448337827
             autocorr =       1.292260783778
              std dev =       0.557757344526
             le_variance =       0.311093255373

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310913403085
                                         uncertainty =       0.002261363110

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310913403085
                                         uncertainty =       0.002261363110

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394394037
  error estimate for blocks of size 2^( 2) =       0.000408238088
  error estimate for blocks of size 2^( 3) =       0.000422209525
  error estimate for blocks of size 2^( 4) =       0.000434824692
  error estimate for blocks of size 2^( 5) =       0.000445945649
  error estimate for blocks of size 2^( 6) =       0.000453933894
  error estimate for blocks of size 2^( 7) =       0.000458646797

      target function =                  N/A
              le_mean =     -16.904166413927
             les_mean =     286.073756177943
             stat err =       0.000448337758
             autocorr =       1.292260149156
              std dev =       0.557757395682
             le_variance =       0.311093312438

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310913380939
                                         uncertainty =       0.002261372024

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310913380939
                                         uncertainty =       0.002261372024

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394394018
  error estimate for blocks of size 2^( 2) =       0.000408238094
  error estimate for blocks of size 2^( 3) =       0.000422209552
  error estimate for blocks of size 2^( 4) =       0.000434824722
  error estimate for blocks of size 2^( 5) =       0.000445945665
  error estimate for blocks of size 2^( 6) =       0.000453933917
  error estimate for blocks of size 2^( 7) =       0.000458646865

      target function =                  N/A
              le_mean =     -16.904166406581
             les_mean =     286.073756575617
             stat err =       0.000448337792
             autocorr =       1.292260466498
              std dev =       0.557757369834
             le_variance =       0.311093283604

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310913362070
                                         uncertainty =       0.002261379851

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310913362070
                                         uncertainty =       0.002261379851

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394394003
  error estimate for blocks of size 2^( 2) =       0.000408238100
  error estimate for blocks of size 2^( 3) =       0.000422209577
  error estimate for blocks of size 2^( 4) =       0.000434824748
  error estimate for blocks of size 2^( 5) =       0.000445945680
  error estimate for blocks of size 2^( 6) =       0.000453933938
  error estimate for blocks of size 2^( 7) =       0.000458646924

      target function =                  N/A
              le_mean =     -16.904166400191
             les_mean =     286.073756937688
             stat err =       0.000448337823
             autocorr =       1.292260744132
              std dev =       0.557757347664
             le_variance =       0.311093258873


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904166399281        initial
     1.5625e+02     1.5625e+03             3.6690e-06       -16.904166413927  <--
     6.2500e+02     6.2500e+03             9.1832e-07       -16.904166406581
     2.5000e+03     2.5000e+04             2.2965e-07       -16.904166400191

*****************************************************************************
Applying the update for shift_i =   1.5625e+02     and shift_s =   1.5625e+03
*****************************************************************************

  Execution time = 2.4000e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
ci_0001                 7.011184e-01 3 1  ON 0
ci_0002                 6.996368e-01 3 1  ON 1
ci_0003                -3.045723e-02 3 1  ON 2
ci_0004                -3.092397e-02 3 1  ON 3
ci_0005                -3.366088e-02 3 1  ON 4
ci_0006                -3.479308e-02 3 1  ON 5
ci_0007                -2.185345e-02 3 1  ON 6
ci_0008                -2.318094e-02 3 1  ON 7
ci_0009                -1.986045e-02 3 1  ON 8
ci_0010                -2.026586e-02 3 1  ON 9
ci_0011                -1.477591e-02 3 1  ON 10
ci_0012                -1.481597e-02 3 1  ON 11
ci_0013                 1.605911e-02 3 1  ON 12
ci_0014                 1.527674e-02 3 1  ON 13
ci_0015                 1.614889e-02 3 1  ON 14
ci_0016                 1.559571e-02 3 1  ON 15
ci_0017                 1.425789e-02 3 1  ON 16
ci_0018                 1.406076e-02 3 1  ON 17
ci_0019                 1.260871e-02 3 1  ON 18
ci_0020                 1.185593e-02 3 1  ON 19
ci_0021                 6.898336e-03 3 1  ON 20
ci_0022                 7.158304e-03 3 1  ON 21
ci_0023                -1.184314e-02 3 1  ON 22
ci_0024                -1.122318e-02 3 1  ON 23
ci_0025                -1.119028e-02 3 1  ON 24
ci_0026                -1.119588e-02 3 1  ON 25
ci_0027                -1.141539e-02 3 1  ON 26
ci_0028                -1.147607e-02 3 1  ON 27
ci_0029                -1.085482e-02 3 1  ON 28
ci_0030                -1.048907e-02 3 1  ON 29
ci_0031                 1.942303e-02 3 1  ON 30
ci_0032                 1.933036e-02 3 1  ON 31
ci_0033                 9.746736e-03 3 1  ON 32
ci_0034                 1.063929e-02 3 1  ON 33
ci_0035                 6.609592e-03 3 1  ON 34
ci_0036                 4.350942e-03 3 1  ON 35
ci_0037                -1.150429e-02 3 1  ON 36
ci_0038                -1.066822e-02 3 1  ON 37
ci_0039                -4.193147e-03 3 1  ON 38
ci_0040                -4.017718e-03 3 1  ON 39
ci_0041                 8.605801e-03 3 1  ON 40
ci_0042                 8.381086e-03 3 1  ON 41
ci_0043                -1.325093e-02 3 1  ON 42
ci_0044                -1.355431e-02 3 1  ON 43
ci_0045                 8.127361e-03 3 1  ON 44
ci_0046                 7.888390e-03 3 1  ON 45
ci_0047                -3.627233e-03 3 1  ON 46
ci_0048                -3.159217e-03 3 1  ON 47
ci_0049                -6.785912e-03 3 1  ON 48
ci_0050                -5.925495e-03 3 1  ON 49
ci_0051                -4.465952e-03 3 1  ON 50
ci_0052                -4.605512e-03 3 1  ON 51
ci_0053                -6.287812e-03 3 1  ON 52
ci_0054                -5.920693e-03 3 1  ON 53
ci_0055                 6.396918e-03 3 1  ON 54
ci_0056                 6.757709e-03 3 1  ON 55
ci_0057                 5.673580e-03 3 1  ON 56
ci_0058                 4.654178e-03 3 1  ON 57
ci_0059                -5.804892e-03 3 1  ON 58
ci_0060                -5.907336e-03 3 1  ON 59
ci_0061                -3.680094e-03 3 1  ON 60
ci_0062                -4.027704e-03 3 1  ON 61
ci_0063                -9.183333e-03 3 1  ON 62
ci_0064                -8.530459e-03 3 1  ON 63
ci_0065                -6.667325e-03 3 1  ON 64
ci_0066                -6.887048e-03 3 1  ON 65
ci_0067                -6.030119e-03 3 1  ON 66
ci_0068                -6.256014e-03 3 1  ON 67
ci_0069                 5.320519e-03 3 1  ON 68
ci_0070                 5.450364e-03 3 1  ON 69
ci_0071                 4.223649e-03 3 1  ON 70
ci_0072                 5.177625e-03 3 1  ON 71
ci_0073                 5.140349e-03 3 1  ON 72
ci_0074                 5.514272e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0909e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6894e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.8447
    reference variance = 0.234504
====================================================
  Execution time = 1.4290e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5270e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2595e-01
  Total weights = 1.951649080e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5703e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313689013832
                                         uncertainty =       0.002199240506

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313689013832
                                         uncertainty =       0.002199240506

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396002801
  error estimate for blocks of size 2^( 2) =       0.000410133420
  error estimate for blocks of size 2^( 3) =       0.000424926764
  error estimate for blocks of size 2^( 4) =       0.000438577166
  error estimate for blocks of size 2^( 5) =       0.000450214279
  error estimate for blocks of size 2^( 6) =       0.000459938524
  error estimate for blocks of size 2^( 7) =       0.000466261065

      target function =                  N/A
              le_mean =     -16.904130872260
             les_mean =     286.075587043550
             stat err =       0.000453747758
             autocorr =       1.312902484790
              std dev =       0.560032531227
             le_variance =       0.313636436032


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690413087226e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904130872281       residual = 1.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904130997215       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904130987530       residual = 2.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904130986561       residual = 4.43e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.9062e+01 is 1.176643e-05

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904130872281       residual = 1.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904130903631       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904130901231       residual = 2.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904130900990       residual = 4.53e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5625e+02 is 2.948169e-06

solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904130872281       residual = 1.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904130880126       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904130879528       residual = 2.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904130879467       residual = 4.56e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.2500e+02 is 7.374536e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.155521 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6865e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
ci_0001                 7.011188e-01 3 1  ON 0
ci_0002                 6.996365e-01 3 1  ON 1
ci_0003                -3.045708e-02 3 1  ON 2
ci_0004                -3.092450e-02 3 1  ON 3
ci_0005                -3.366064e-02 3 1  ON 4
ci_0006                -3.479380e-02 3 1  ON 5
ci_0007                -2.185437e-02 3 1  ON 6
ci_0008                -2.318080e-02 3 1  ON 7
ci_0009                -1.986008e-02 3 1  ON 8
ci_0010                -2.026466e-02 3 1  ON 9
ci_0011                -1.477561e-02 3 1  ON 10
ci_0012                -1.481615e-02 3 1  ON 11
ci_0013                 1.605797e-02 3 1  ON 12
ci_0014                 1.527760e-02 3 1  ON 13
ci_0015                 1.614866e-02 3 1  ON 14
ci_0016                 1.559562e-02 3 1  ON 15
ci_0017                 1.425647e-02 3 1  ON 16
ci_0018                 1.406149e-02 3 1  ON 17
ci_0019                 1.260702e-02 3 1  ON 18
ci_0020                 1.185558e-02 3 1  ON 19
ci_0021                 6.898417e-03 3 1  ON 20
ci_0022                 7.157125e-03 3 1  ON 21
ci_0023                -1.184360e-02 3 1  ON 22
ci_0024                -1.122304e-02 3 1  ON 23
ci_0025                -1.119071e-02 3 1  ON 24
ci_0026                -1.119664e-02 3 1  ON 25
ci_0027                -1.141479e-02 3 1  ON 26
ci_0028                -1.147606e-02 3 1  ON 27
ci_0029                -1.085589e-02 3 1  ON 28
ci_0030                -1.048972e-02 3 1  ON 29
ci_0031                 1.942270e-02 3 1  ON 30
ci_0032                 1.932846e-02 3 1  ON 31
ci_0033                 9.743788e-03 3 1  ON 32
ci_0034                 1.063933e-02 3 1  ON 33
ci_0035                 6.610460e-03 3 1  ON 34
ci_0036                 4.353742e-03 3 1  ON 35
ci_0037                -1.150434e-02 3 1  ON 36
ci_0038                -1.066924e-02 3 1  ON 37
ci_0039                -4.192894e-03 3 1  ON 38
ci_0040                -4.018357e-03 3 1  ON 39
ci_0041                 8.604161e-03 3 1  ON 40
ci_0042                 8.380873e-03 3 1  ON 41
ci_0043                -1.324948e-02 3 1  ON 42
ci_0044                -1.355339e-02 3 1  ON 43
ci_0045                 8.129575e-03 3 1  ON 44
ci_0046                 7.889618e-03 3 1  ON 45
ci_0047                -3.625938e-03 3 1  ON 46
ci_0048                -3.159523e-03 3 1  ON 47
ci_0049                -6.785050e-03 3 1  ON 48
ci_0050                -5.925131e-03 3 1  ON 49
ci_0051                -4.465149e-03 3 1  ON 50
ci_0052                -4.605536e-03 3 1  ON 51
ci_0053                -6.287508e-03 3 1  ON 52
ci_0054                -5.919887e-03 3 1  ON 53
ci_0055                 6.397585e-03 3 1  ON 54
ci_0056                 6.758380e-03 3 1  ON 55
ci_0057                 5.673398e-03 3 1  ON 56
ci_0058                 4.654524e-03 3 1  ON 57
ci_0059                -5.806142e-03 3 1  ON 58
ci_0060                -5.907523e-03 3 1  ON 59
ci_0061                -3.679585e-03 3 1  ON 60
ci_0062                -4.028084e-03 3 1  ON 61
ci_0063                -9.183693e-03 3 1  ON 62
ci_0064                -8.531725e-03 3 1  ON 63
ci_0065                -6.665803e-03 3 1  ON 64
ci_0066                -6.886300e-03 3 1  ON 65
ci_0067                -6.030534e-03 3 1  ON 66
ci_0068                -6.255248e-03 3 1  ON 67
ci_0069                 5.319964e-03 3 1  ON 68
ci_0070                 5.449263e-03 3 1  ON 69
ci_0071                 4.222902e-03 3 1  ON 70
ci_0072                 5.175832e-03 3 1  ON 71
ci_0073                 5.141064e-03 3 1  ON 72
ci_0074                 5.514917e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.9004
    reference variance = 0.332177
====================================================
  Execution time = 1.4285e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.3045e-01
  Total weights = 1.9516e+06
  Execution time = 1.8977e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315212227359
                                         uncertainty =       0.003188443599

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315212227359
                                         uncertainty =       0.003188443599

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396957429
  error estimate for blocks of size 2^( 2) =       0.000411068223
  error estimate for blocks of size 2^( 3) =       0.000425630014
  error estimate for blocks of size 2^( 4) =       0.000439419224
  error estimate for blocks of size 2^( 5) =       0.000450048798
  error estimate for blocks of size 2^( 6) =       0.000459251092
  error estimate for blocks of size 2^( 7) =       0.000465607819

      target function =                  N/A
              le_mean =     -16.903521851599
             les_mean =     286.059517034090
             stat err =       0.000453581733
             autocorr =       1.305639391766
              std dev =       0.561382579302
             le_variance =       0.315150400344

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315211827649
                                         uncertainty =       0.003187760439

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315211827649
                                         uncertainty =       0.003187760439

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396957167
  error estimate for blocks of size 2^( 2) =       0.000411068096
  error estimate for blocks of size 2^( 3) =       0.000425630045
  error estimate for blocks of size 2^( 4) =       0.000439419562
  error estimate for blocks of size 2^( 5) =       0.000450049278
  error estimate for blocks of size 2^( 6) =       0.000459251695
  error estimate for blocks of size 2^( 7) =       0.000465608522

      target function =                  N/A
              le_mean =     -16.903521886606
             les_mean =     286.059485427895
             stat err =       0.000453582264
             autocorr =       1.305644169367
              std dev =       0.561382209459
             le_variance =       0.315149985097

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315212017559
                                         uncertainty =       0.003188099166

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315212017559
                                         uncertainty =       0.003188099166

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396957292
  error estimate for blocks of size 2^( 2) =       0.000411068154
  error estimate for blocks of size 2^( 3) =       0.000425630024
  error estimate for blocks of size 2^( 4) =       0.000439419388
  error estimate for blocks of size 2^( 5) =       0.000450049034
  error estimate for blocks of size 2^( 6) =       0.000459251390
  error estimate for blocks of size 2^( 7) =       0.000465608167

      target function =                  N/A
              le_mean =     -16.903521868550
             les_mean =     286.059497338311
             stat err =       0.000453581995
             autocorr =       1.305641800643
              std dev =       0.561382385500
             le_variance =       0.315150182750

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315212200405
                                         uncertainty =       0.003188400414

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315212200405
                                         uncertainty =       0.003188400414

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396957411
  error estimate for blocks of size 2^( 2) =       0.000411068214
  error estimate for blocks of size 2^( 3) =       0.000425630015
  error estimate for blocks of size 2^( 4) =       0.000439419244
  error estimate for blocks of size 2^( 5) =       0.000450048827
  error estimate for blocks of size 2^( 6) =       0.000459251129
  error estimate for blocks of size 2^( 7) =       0.000465607862

      target function =                  N/A
              le_mean =     -16.903521853643
             les_mean =     286.059513990748
             stat err =       0.000453581765
             autocorr =       1.305639693888
              std dev =       0.561382554428
             le_variance =       0.315150372416


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.903521851599        initial
     3.9062e+01     3.9062e+02             1.1766e-05       -16.903521886606  <--
     1.5625e+02     1.5625e+03             2.9482e-06       -16.903521868550
     6.2500e+02     6.2500e+03             7.3745e-07       -16.903521853643

*****************************************************************************
Applying the update for shift_i =   3.9062e+01     and shift_s =   3.9062e+02
*****************************************************************************

  Execution time = 2.3870e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
ci_0001                 7.011200e-01 3 1  ON 0
ci_0002                 6.996357e-01 3 1  ON 1
ci_0003                -3.045665e-02 3 1  ON 2
ci_0004                -3.092609e-02 3 1  ON 3
ci_0005                -3.365991e-02 3 1  ON 4
ci_0006                -3.479595e-02 3 1  ON 5
ci_0007                -2.185711e-02 3 1  ON 6
ci_0008                -2.318039e-02 3 1  ON 7
ci_0009                -1.985896e-02 3 1  ON 8
ci_0010                -2.026111e-02 3 1  ON 9
ci_0011                -1.477473e-02 3 1  ON 10
ci_0012                -1.481667e-02 3 1  ON 11
ci_0013                 1.605455e-02 3 1  ON 12
ci_0014                 1.528016e-02 3 1  ON 13
ci_0015                 1.614798e-02 3 1  ON 14
ci_0016                 1.559535e-02 3 1  ON 15
ci_0017                 1.425225e-02 3 1  ON 16
ci_0018                 1.406367e-02 3 1  ON 17
ci_0019                 1.260197e-02 3 1  ON 18
ci_0020                 1.185456e-02 3 1  ON 19
ci_0021                 6.898656e-03 3 1  ON 20
ci_0022                 7.153595e-03 3 1  ON 21
ci_0023                -1.184495e-02 3 1  ON 22
ci_0024                -1.122263e-02 3 1  ON 23
ci_0025                -1.119197e-02 3 1  ON 24
ci_0026                -1.119891e-02 3 1  ON 25
ci_0027                -1.141301e-02 3 1  ON 26
ci_0028                -1.147604e-02 3 1  ON 27
ci_0029                -1.085907e-02 3 1  ON 28
ci_0030                -1.049165e-02 3 1  ON 29
ci_0031                 1.942173e-02 3 1  ON 30
ci_0032                 1.932279e-02 3 1  ON 31
ci_0033                 9.734970e-03 3 1  ON 32
ci_0034                 1.063944e-02 3 1  ON 33
ci_0035                 6.613052e-03 3 1  ON 34
ci_0036                 4.362100e-03 3 1  ON 35
ci_0037                -1.150449e-02 3 1  ON 36
ci_0038                -1.067230e-02 3 1  ON 37
ci_0039                -4.192141e-03 3 1  ON 38
ci_0040                -4.020257e-03 3 1  ON 39
ci_0041                 8.599270e-03 3 1  ON 40
ci_0042                 8.380239e-03 3 1  ON 41
ci_0043                -1.324512e-02 3 1  ON 42
ci_0044                -1.355065e-02 3 1  ON 43
ci_0045                 8.136192e-03 3 1  ON 44
ci_0046                 7.893286e-03 3 1  ON 45
ci_0047                -3.622087e-03 3 1  ON 46
ci_0048                -3.160435e-03 3 1  ON 47
ci_0049                -6.782479e-03 3 1  ON 48
ci_0050                -5.924044e-03 3 1  ON 49
ci_0051                -4.462760e-03 3 1  ON 50
ci_0052                -4.605605e-03 3 1  ON 51
ci_0053                -6.286602e-03 3 1  ON 52
ci_0054                -5.917487e-03 3 1  ON 53
ci_0055                 6.399576e-03 3 1  ON 54
ci_0056                 6.760383e-03 3 1  ON 55
ci_0057                 5.672854e-03 3 1  ON 56
ci_0058                 4.655558e-03 3 1  ON 57
ci_0059                -5.809861e-03 3 1  ON 58
ci_0060                -5.908079e-03 3 1  ON 59
ci_0061                -3.678069e-03 3 1  ON 60
ci_0062                -4.029218e-03 3 1  ON 61
ci_0063                -9.184765e-03 3 1  ON 62
ci_0064                -8.535497e-03 3 1  ON 63
ci_0065                -6.661265e-03 3 1  ON 64
ci_0066                -6.884068e-03 3 1  ON 65
ci_0067                -6.031768e-03 3 1  ON 66
ci_0068                -6.252969e-03 3 1  ON 67
ci_0069                 5.318311e-03 3 1  ON 68
ci_0070                 5.445987e-03 3 1  ON 69
ci_0071                 4.220673e-03 3 1  ON 70
ci_0072                 5.170479e-03 3 1  ON 71
ci_0073                 5.143188e-03 3 1  ON 72
ci_0074                 5.516833e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0741e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6891e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.9156
    reference variance = 1.07515
====================================================
  Execution time = 1.4336e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5242e+04
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.2080e-01
  Total weights = 1.951386550e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5738e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310533475399
                                         uncertainty =       0.002985235176

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310533475399
                                         uncertainty =       0.002985235176

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394071194
  error estimate for blocks of size 2^( 2) =       0.000408226219
  error estimate for blocks of size 2^( 3) =       0.000422511995
  error estimate for blocks of size 2^( 4) =       0.000435994365
  error estimate for blocks of size 2^( 5) =       0.000447701047
  error estimate for blocks of size 2^( 6) =       0.000456687711
  error estimate for blocks of size 2^( 7) =       0.000460497857

      target function =                  N/A
              le_mean =     -16.903404827904
             les_mean =     286.045893421180
             stat err =       0.000450220245
             autocorr =       1.305270909863
              std dev =       0.557300827788
             le_variance =       0.310584212653


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690340482790e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903404827931       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903405286329       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.903405337095       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.903405337257       residual = 9.79e-11           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.7656e+00 is 6.121542e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903404827931       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903404944436       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.903404957202       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.903404957231       residual = 1.08e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.9062e+01 is 1.553135e-05

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903404827931       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903404857178       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.903404860375       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.903404860381       residual = 1.11e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5625e+02 is 3.897318e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.156821 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6915e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
ci_0001                 7.011182e-01 3 1  ON 0
ci_0002                 6.996371e-01 3 1  ON 1
ci_0003                -3.045868e-02 3 1  ON 2
ci_0004                -3.092256e-02 3 1  ON 3
ci_0005                -3.366042e-02 3 1  ON 4
ci_0006                -3.479538e-02 3 1  ON 5
ci_0007                -2.185917e-02 3 1  ON 6
ci_0008                -2.317446e-02 3 1  ON 7
ci_0009                -1.986185e-02 3 1  ON 8
ci_0010                -2.025940e-02 3 1  ON 9
ci_0011                -1.477792e-02 3 1  ON 10
ci_0012                -1.481828e-02 3 1  ON 11
ci_0013                 1.605248e-02 3 1  ON 12
ci_0014                 1.528147e-02 3 1  ON 13
ci_0015                 1.615128e-02 3 1  ON 14
ci_0016                 1.560222e-02 3 1  ON 15
ci_0017                 1.424816e-02 3 1  ON 16
ci_0018                 1.406167e-02 3 1  ON 17
ci_0019                 1.259741e-02 3 1  ON 18
ci_0020                 1.185592e-02 3 1  ON 19
ci_0021                 6.900413e-03 3 1  ON 20
ci_0022                 7.154786e-03 3 1  ON 21
ci_0023                -1.184510e-02 3 1  ON 22
ci_0024                -1.121747e-02 3 1  ON 23
ci_0025                -1.119747e-02 3 1  ON 24
ci_0026                -1.120329e-02 3 1  ON 25
ci_0027                -1.141419e-02 3 1  ON 26
ci_0028                -1.147159e-02 3 1  ON 27
ci_0029                -1.086077e-02 3 1  ON 28
ci_0030                -1.049368e-02 3 1  ON 29
ci_0031                 1.942096e-02 3 1  ON 30
ci_0032                 1.932746e-02 3 1  ON 31
ci_0033                 9.736852e-03 3 1  ON 32
ci_0034                 1.064049e-02 3 1  ON 33
ci_0035                 6.616092e-03 3 1  ON 34
ci_0036                 4.377631e-03 3 1  ON 35
ci_0037                -1.149612e-02 3 1  ON 36
ci_0038                -1.067357e-02 3 1  ON 37
ci_0039                -4.200456e-03 3 1  ON 38
ci_0040                -4.024700e-03 3 1  ON 39
ci_0041                 8.597660e-03 3 1  ON 40
ci_0042                 8.382058e-03 3 1  ON 41
ci_0043                -1.324117e-02 3 1  ON 42
ci_0044                -1.355249e-02 3 1  ON 43
ci_0045                 8.138291e-03 3 1  ON 44
ci_0046                 7.896342e-03 3 1  ON 45
ci_0047                -3.623839e-03 3 1  ON 46
ci_0048                -3.163494e-03 3 1  ON 47
ci_0049                -6.782509e-03 3 1  ON 48
ci_0050                -5.923983e-03 3 1  ON 49
ci_0051                -4.461585e-03 3 1  ON 50
ci_0052                -4.603266e-03 3 1  ON 51
ci_0053                -6.290378e-03 3 1  ON 52
ci_0054                -5.922770e-03 3 1  ON 53
ci_0055                 6.403540e-03 3 1  ON 54
ci_0056                 6.761676e-03 3 1  ON 55
ci_0057                 5.667841e-03 3 1  ON 56
ci_0058                 4.661398e-03 3 1  ON 57
ci_0059                -5.812274e-03 3 1  ON 58
ci_0060                -5.907320e-03 3 1  ON 59
ci_0061                -3.680283e-03 3 1  ON 60
ci_0062                -4.029216e-03 3 1  ON 61
ci_0063                -9.189269e-03 3 1  ON 62
ci_0064                -8.540384e-03 3 1  ON 63
ci_0065                -6.659656e-03 3 1  ON 64
ci_0066                -6.881518e-03 3 1  ON 65
ci_0067                -6.035027e-03 3 1  ON 66
ci_0068                -6.249425e-03 3 1  ON 67
ci_0069                 5.315884e-03 3 1  ON 68
ci_0070                 5.445190e-03 3 1  ON 69
ci_0071                 4.219359e-03 3 1  ON 70
ci_0072                 5.168605e-03 3 1  ON 71
ci_0073                 5.144479e-03 3 1  ON 72
ci_0074                 5.514825e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.9256
    reference variance = 0.364282
====================================================
  Execution time = 1.4286e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.1899e-01
  Total weights = 1.9514e+06
  Execution time = 1.8921e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308766835067
                                         uncertainty =       0.002004044322

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308766835067
                                         uncertainty =       0.002004044322

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392965106
  error estimate for blocks of size 2^( 2) =       0.000407669494
  error estimate for blocks of size 2^( 3) =       0.000422221211
  error estimate for blocks of size 2^( 4) =       0.000435284611
  error estimate for blocks of size 2^( 5) =       0.000446468185
  error estimate for blocks of size 2^( 6) =       0.000455149295
  error estimate for blocks of size 2^( 7) =       0.000460638927

      target function =                  N/A
              le_mean =     -16.904042432276
             les_mean =     286.065630219413
             stat err =       0.000449385255
             autocorr =       1.307764849719
              std dev =       0.555736582279
             le_variance =       0.308843148883

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308785827640
                                         uncertainty =       0.002004963722

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308785827640
                                         uncertainty =       0.002004963722

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392977197
  error estimate for blocks of size 2^( 2) =       0.000407680799
  error estimate for blocks of size 2^( 3) =       0.000422231639
  error estimate for blocks of size 2^( 4) =       0.000435294832
  error estimate for blocks of size 2^( 5) =       0.000446477963
  error estimate for blocks of size 2^( 6) =       0.000455158521
  error estimate for blocks of size 2^( 7) =       0.000460649025

      target function =                  N/A
              le_mean =     -16.904042645811
             les_mean =     286.065753457633
             stat err =       0.000449395085
             autocorr =       1.307741588505
              std dev =       0.555753682011
             le_variance =       0.308862155069

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308776418507
                                         uncertainty =       0.002004508972

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308776418507
                                         uncertainty =       0.002004508972

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392971207
  error estimate for blocks of size 2^( 2) =       0.000407675195
  error estimate for blocks of size 2^( 3) =       0.000422226465
  error estimate for blocks of size 2^( 4) =       0.000435289758
  error estimate for blocks of size 2^( 5) =       0.000446473101
  error estimate for blocks of size 2^( 6) =       0.000455153929
  error estimate for blocks of size 2^( 7) =       0.000460644019

      target function =                  N/A
              le_mean =     -16.904042534930
             les_mean =     286.065651193771
             stat err =       0.000449390202
             autocorr =       1.307753033495
              std dev =       0.555745211181
             le_variance =       0.308852739751

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308768030407
                                         uncertainty =       0.002004102402

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308768030407
                                         uncertainty =       0.002004102402

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392965867
  error estimate for blocks of size 2^( 2) =       0.000407670205
  error estimate for blocks of size 2^( 3) =       0.000422221865
  error estimate for blocks of size 2^( 4) =       0.000435285252
  error estimate for blocks of size 2^( 5) =       0.000446468797
  error estimate for blocks of size 2^( 6) =       0.000455149871
  error estimate for blocks of size 2^( 7) =       0.000460639561

      target function =                  N/A
              le_mean =     -16.904042444361
             les_mean =     286.065632137126
             stat err =       0.000449385870
             autocorr =       1.307763368396
              std dev =       0.555737658590
             le_variance =       0.308844345175


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904042432276        initial
     9.7656e+00     9.7656e+01             6.1215e-05       -16.904042645811  <--
     3.9062e+01     3.9062e+02             1.5531e-05       -16.904042534930
     1.5625e+02     1.5625e+03             3.8973e-06       -16.904042444361

*****************************************************************************
Applying the update for shift_i =   9.7656e+00     and shift_s =   9.7656e+01
*****************************************************************************

  Execution time = 2.3853e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046464e-02 3 1  ON 2
ci_0004                -3.091212e-02 3 1  ON 3
ci_0005                -3.366196e-02 3 1  ON 4
ci_0006                -3.479372e-02 3 1  ON 5
ci_0007                -2.186530e-02 3 1  ON 6
ci_0008                -2.315684e-02 3 1  ON 7
ci_0009                -1.987032e-02 3 1  ON 8
ci_0010                -2.025439e-02 3 1  ON 9
ci_0011                -1.478730e-02 3 1  ON 10
ci_0012                -1.482301e-02 3 1  ON 11
ci_0013                 1.604635e-02 3 1  ON 12
ci_0014                 1.528534e-02 3 1  ON 13
ci_0015                 1.616097e-02 3 1  ON 14
ci_0016                 1.562241e-02 3 1  ON 15
ci_0017                 1.423615e-02 3 1  ON 16
ci_0018                 1.405583e-02 3 1  ON 17
ci_0019                 1.258399e-02 3 1  ON 18
ci_0020                 1.185992e-02 3 1  ON 19
ci_0021                 6.905650e-03 3 1  ON 20
ci_0022                 7.158315e-03 3 1  ON 21
ci_0023                -1.184553e-02 3 1  ON 22
ci_0024                -1.120241e-02 3 1  ON 23
ci_0025                -1.121362e-02 3 1  ON 24
ci_0026                -1.121615e-02 3 1  ON 25
ci_0027                -1.141764e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086571e-02 3 1  ON 28
ci_0030                -1.049961e-02 3 1  ON 29
ci_0031                 1.941868e-02 3 1  ON 30
ci_0032                 1.934132e-02 3 1  ON 31
ci_0033                 9.742440e-03 3 1  ON 32
ci_0034                 1.064359e-02 3 1  ON 33
ci_0035                 6.625049e-03 3 1  ON 34
ci_0036                 4.423315e-03 3 1  ON 35
ci_0037                -1.147143e-02 3 1  ON 36
ci_0038                -1.067730e-02 3 1  ON 37
ci_0039                -4.224481e-03 3 1  ON 38
ci_0040                -4.037545e-03 3 1  ON 39
ci_0041                 8.592948e-03 3 1  ON 40
ci_0042                 8.387405e-03 3 1  ON 41
ci_0043                -1.322946e-02 3 1  ON 42
ci_0044                -1.355797e-02 3 1  ON 43
ci_0045                 8.144493e-03 3 1  ON 44
ci_0046                 7.905365e-03 3 1  ON 45
ci_0047                -3.628904e-03 3 1  ON 46
ci_0048                -3.172351e-03 3 1  ON 47
ci_0049                -6.782582e-03 3 1  ON 48
ci_0050                -5.923778e-03 3 1  ON 49
ci_0051                -4.458184e-03 3 1  ON 50
ci_0052                -4.596475e-03 3 1  ON 51
ci_0053                -6.301372e-03 3 1  ON 52
ci_0054                -5.938148e-03 3 1  ON 53
ci_0055                 6.415218e-03 3 1  ON 54
ci_0056                 6.765489e-03 3 1  ON 55
ci_0057                 5.653064e-03 3 1  ON 56
ci_0058                 4.678573e-03 3 1  ON 57
ci_0059                -5.819294e-03 3 1  ON 58
ci_0060                -5.905117e-03 3 1  ON 59
ci_0061                -3.686790e-03 3 1  ON 60
ci_0062                -4.029202e-03 3 1  ON 61
ci_0063                -9.202421e-03 3 1  ON 62
ci_0064                -8.554649e-03 3 1  ON 63
ci_0065                -6.654943e-03 3 1  ON 64
ci_0066                -6.874045e-03 3 1  ON 65
ci_0067                -6.044475e-03 3 1  ON 66
ci_0068                -6.239134e-03 3 1  ON 67
ci_0069                 5.308838e-03 3 1  ON 68
ci_0070                 5.442889e-03 3 1  ON 69
ci_0071                 4.215513e-03 3 1  ON 70
ci_0072                 5.163090e-03 3 1  ON 71
ci_0073                 5.148216e-03 3 1  ON 72
ci_0074                 5.508994e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0786e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6895e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.9207
    reference variance = 0.258112
====================================================
  Execution time = 1.4434e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5241e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2062e-01
  Total weights = 1.951658283e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5807e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310694420245
                                         uncertainty =       0.001786513045

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310694420245
                                         uncertainty =       0.001786513045

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394140219
  error estimate for blocks of size 2^( 2) =       0.000408229039
  error estimate for blocks of size 2^( 3) =       0.000422042724
  error estimate for blocks of size 2^( 4) =       0.000434852488
  error estimate for blocks of size 2^( 5) =       0.000445659558
  error estimate for blocks of size 2^( 6) =       0.000450467430
  error estimate for blocks of size 2^( 7) =       0.000455807108

      target function =                  N/A
              le_mean =     -16.903905220339
             les_mean =     286.062628439847
             stat err =       0.000446696646
             autocorr =       1.284469739150
              std dev =       0.557398442700
             le_variance =       0.310693023924


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690390522034e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903905220363       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903907545774       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.903907688054       residual = 2.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.903907699914       residual = 1.98e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.4414e+00 is 1.955546e-04

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903905220363       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903905837910       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.903905871774       residual = 2.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.903905873860       residual = 2.32e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.7656e+00 is 5.176802e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903905220363       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903905377191       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.903905385546       residual = 2.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.903905385976       residual = 2.50e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.9062e+01 is 1.313568e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.158140 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7020e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
ci_0001                 7.011124e-01 3 1  ON 0
ci_0002                 6.996437e-01 3 1  ON 1
ci_0003                -3.045651e-02 3 1  ON 2
ci_0004                -3.090026e-02 3 1  ON 3
ci_0005                -3.365391e-02 3 1  ON 4
ci_0006                -3.478368e-02 3 1  ON 5
ci_0007                -2.186574e-02 3 1  ON 6
ci_0008                -2.316265e-02 3 1  ON 7
ci_0009                -1.985227e-02 3 1  ON 8
ci_0010                -2.022458e-02 3 1  ON 9
ci_0011                -1.477791e-02 3 1  ON 10
ci_0012                -1.483300e-02 3 1  ON 11
ci_0013                 1.603834e-02 3 1  ON 12
ci_0014                 1.528170e-02 3 1  ON 13
ci_0015                 1.613852e-02 3 1  ON 14
ci_0016                 1.560239e-02 3 1  ON 15
ci_0017                 1.422548e-02 3 1  ON 16
ci_0018                 1.406190e-02 3 1  ON 17
ci_0019                 1.257729e-02 3 1  ON 18
ci_0020                 1.186958e-02 3 1  ON 19
ci_0021                 6.914065e-03 3 1  ON 20
ci_0022                 7.168385e-03 3 1  ON 21
ci_0023                -1.183073e-02 3 1  ON 22
ci_0024                -1.121115e-02 3 1  ON 23
ci_0025                -1.122378e-02 3 1  ON 24
ci_0026                -1.122673e-02 3 1  ON 25
ci_0027                -1.140723e-02 3 1  ON 26
ci_0028                -1.144691e-02 3 1  ON 27
ci_0029                -1.085920e-02 3 1  ON 28
ci_0030                -1.048371e-02 3 1  ON 29
ci_0031                 1.938600e-02 3 1  ON 30
ci_0032                 1.935621e-02 3 1  ON 31
ci_0033                 9.760196e-03 3 1  ON 32
ci_0034                 1.065870e-02 3 1  ON 33
ci_0035                 6.655538e-03 3 1  ON 34
ci_0036                 4.475083e-03 3 1  ON 35
ci_0037                -1.145251e-02 3 1  ON 36
ci_0038                -1.069982e-02 3 1  ON 37
ci_0039                -4.209772e-03 3 1  ON 38
ci_0040                -4.036839e-03 3 1  ON 39
ci_0041                 8.621908e-03 3 1  ON 40
ci_0042                 8.409794e-03 3 1  ON 41
ci_0043                -1.322585e-02 3 1  ON 42
ci_0044                -1.359423e-02 3 1  ON 43
ci_0045                 8.144091e-03 3 1  ON 44
ci_0046                 7.915770e-03 3 1  ON 45
ci_0047                -3.641012e-03 3 1  ON 46
ci_0048                -3.177605e-03 3 1  ON 47
ci_0049                -6.779086e-03 3 1  ON 48
ci_0050                -5.956457e-03 3 1  ON 49
ci_0051                -4.456195e-03 3 1  ON 50
ci_0052                -4.584396e-03 3 1  ON 51
ci_0053                -6.311400e-03 3 1  ON 52
ci_0054                -5.944493e-03 3 1  ON 53
ci_0055                 6.415929e-03 3 1  ON 54
ci_0056                 6.771605e-03 3 1  ON 55
ci_0057                 5.631859e-03 3 1  ON 56
ci_0058                 4.697957e-03 3 1  ON 57
ci_0059                -5.836947e-03 3 1  ON 58
ci_0060                -5.913294e-03 3 1  ON 59
ci_0061                -3.671931e-03 3 1  ON 60
ci_0062                -4.042531e-03 3 1  ON 61
ci_0063                -9.196158e-03 3 1  ON 62
ci_0064                -8.564102e-03 3 1  ON 63
ci_0065                -6.658139e-03 3 1  ON 64
ci_0066                -6.873121e-03 3 1  ON 65
ci_0067                -6.046484e-03 3 1  ON 66
ci_0068                -6.247611e-03 3 1  ON 67
ci_0069                 5.329122e-03 3 1  ON 68
ci_0070                 5.456048e-03 3 1  ON 69
ci_0071                 4.208435e-03 3 1  ON 70
ci_0072                 5.138497e-03 3 1  ON 71
ci_0073                 5.122370e-03 3 1  ON 72
ci_0074                 5.480893e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.952
    reference variance = 0.344138
====================================================
  Execution time = 1.4271e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.1946e-01
  Total weights = 1.9519e+06
  Execution time = 1.8986e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309213866389
                                         uncertainty =       0.001882096880

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309213866389
                                         uncertainty =       0.001882096880

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393176951
  error estimate for blocks of size 2^( 2) =       0.000407102871
  error estimate for blocks of size 2^( 3) =       0.000420974716
  error estimate for blocks of size 2^( 4) =       0.000433113429
  error estimate for blocks of size 2^( 5) =       0.000442974957
  error estimate for blocks of size 2^( 6) =       0.000452017927
  error estimate for blocks of size 2^( 7) =       0.000455754821

      target function =                  N/A
              le_mean =     -16.903953219419
             les_mean =     286.063134682755
             stat err =       0.000445965284
             autocorr =       1.286548025620
              std dev =       0.556036176945
             le_variance =       0.309176230072

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309258694941
                                         uncertainty =       0.001884358135

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309258694941
                                         uncertainty =       0.001884358135

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393205563
  error estimate for blocks of size 2^( 2) =       0.000407133286
  error estimate for blocks of size 2^( 3) =       0.000421006245
  error estimate for blocks of size 2^( 4) =       0.000433145364
  error estimate for blocks of size 2^( 5) =       0.000443004064
  error estimate for blocks of size 2^( 6) =       0.000452052492
  error estimate for blocks of size 2^( 7) =       0.000455787187

      target function =                  N/A
              le_mean =     -16.903952919583
             les_mean =     286.063025516315
             stat err =       0.000445997277
             autocorr =       1.286545372836
              std dev =       0.556076639878
             le_variance =       0.309221229418

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309236596764
                                         uncertainty =       0.001883267916

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309236596764
                                         uncertainty =       0.001883267916

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393191462
  error estimate for blocks of size 2^( 2) =       0.000407118320
  error estimate for blocks of size 2^( 3) =       0.000420990878
  error estimate for blocks of size 2^( 4) =       0.000433129931
  error estimate for blocks of size 2^( 5) =       0.000442990264
  error estimate for blocks of size 2^( 6) =       0.000452036366
  error estimate for blocks of size 2^( 7) =       0.000455772341

      target function =                  N/A
              le_mean =     -16.903952747173
             les_mean =     286.066257759652
             stat err =       0.000445982225
             autocorr =       1.286550810251
              std dev =       0.556056698480
             le_variance =       0.309199051925

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309216602689
                                         uncertainty =       0.001882243476

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309216602689
                                         uncertainty =       0.001882243476

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393178699
  error estimate for blocks of size 2^( 2) =       0.000407104713
  error estimate for blocks of size 2^( 3) =       0.000420976633
  error estimate for blocks of size 2^( 4) =       0.000433115408
  error estimate for blocks of size 2^( 5) =       0.000442976732
  error estimate for blocks of size 2^( 6) =       0.000452020090
  error estimate for blocks of size 2^( 7) =       0.000455756841

      target function =                  N/A
              le_mean =     -16.903953177069
             les_mean =     286.063196874363
             stat err =       0.000445967268
             autocorr =       1.286548037747
              std dev =       0.556038647980
             le_variance =       0.309178978048


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.903953219419        initial  <--
     2.4414e+00     2.4414e+01             1.9555e-04       -16.903952919583
     9.7656e+00     9.7656e+01             5.1768e-05       -16.903952747173
     3.9062e+01     3.9062e+02             1.3136e-05       -16.903953177069

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.8605
  </log>
  <optVariables href="H2O.s009.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046464e-02 3 1  ON 2
ci_0004                -3.091212e-02 3 1  ON 3
ci_0005                -3.366196e-02 3 1  ON 4
ci_0006                -3.479372e-02 3 1  ON 5
ci_0007                -2.186530e-02 3 1  ON 6
ci_0008                -2.315684e-02 3 1  ON 7
ci_0009                -1.987032e-02 3 1  ON 8
ci_0010                -2.025439e-02 3 1  ON 9
ci_0011                -1.478730e-02 3 1  ON 10
ci_0012                -1.482301e-02 3 1  ON 11
ci_0013                 1.604635e-02 3 1  ON 12
ci_0014                 1.528534e-02 3 1  ON 13
ci_0015                 1.616097e-02 3 1  ON 14
ci_0016                 1.562241e-02 3 1  ON 15
ci_0017                 1.423615e-02 3 1  ON 16
ci_0018                 1.405583e-02 3 1  ON 17
ci_0019                 1.258399e-02 3 1  ON 18
ci_0020                 1.185992e-02 3 1  ON 19
ci_0021                 6.905650e-03 3 1  ON 20
ci_0022                 7.158315e-03 3 1  ON 21
ci_0023                -1.184553e-02 3 1  ON 22
ci_0024                -1.120241e-02 3 1  ON 23
ci_0025                -1.121362e-02 3 1  ON 24
ci_0026                -1.121615e-02 3 1  ON 25
ci_0027                -1.141764e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086571e-02 3 1  ON 28
ci_0030                -1.049961e-02 3 1  ON 29
ci_0031                 1.941868e-02 3 1  ON 30
ci_0032                 1.934132e-02 3 1  ON 31
ci_0033                 9.742440e-03 3 1  ON 32
ci_0034                 1.064359e-02 3 1  ON 33
ci_0035                 6.625049e-03 3 1  ON 34
ci_0036                 4.423315e-03 3 1  ON 35
ci_0037                -1.147143e-02 3 1  ON 36
ci_0038                -1.067730e-02 3 1  ON 37
ci_0039                -4.224481e-03 3 1  ON 38
ci_0040                -4.037545e-03 3 1  ON 39
ci_0041                 8.592948e-03 3 1  ON 40
ci_0042                 8.387405e-03 3 1  ON 41
ci_0043                -1.322946e-02 3 1  ON 42
ci_0044                -1.355797e-02 3 1  ON 43
ci_0045                 8.144493e-03 3 1  ON 44
ci_0046                 7.905365e-03 3 1  ON 45
ci_0047                -3.628904e-03 3 1  ON 46
ci_0048                -3.172351e-03 3 1  ON 47
ci_0049                -6.782582e-03 3 1  ON 48
ci_0050                -5.923778e-03 3 1  ON 49
ci_0051                -4.458184e-03 3 1  ON 50
ci_0052                -4.596475e-03 3 1  ON 51
ci_0053                -6.301372e-03 3 1  ON 52
ci_0054                -5.938148e-03 3 1  ON 53
ci_0055                 6.415218e-03 3 1  ON 54
ci_0056                 6.765489e-03 3 1  ON 55
ci_0057                 5.653064e-03 3 1  ON 56
ci_0058                 4.678573e-03 3 1  ON 57
ci_0059                -5.819294e-03 3 1  ON 58
ci_0060                -5.905117e-03 3 1  ON 59
ci_0061                -3.686790e-03 3 1  ON 60
ci_0062                -4.029202e-03 3 1  ON 61
ci_0063                -9.202421e-03 3 1  ON 62
ci_0064                -8.554649e-03 3 1  ON 63
ci_0065                -6.654943e-03 3 1  ON 64
ci_0066                -6.874045e-03 3 1  ON 65
ci_0067                -6.044475e-03 3 1  ON 66
ci_0068                -6.239134e-03 3 1  ON 67
ci_0069                 5.308838e-03 3 1  ON 68
ci_0070                 5.442889e-03 3 1  ON 69
ci_0071                 4.215513e-03 3 1  ON 70
ci_0072                 5.163090e-03 3 1  ON 71
ci_0073                 5.148216e-03 3 1  ON 72
ci_0074                 5.508994e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0886e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.9016
    reference variance = 0.291265
====================================================
  Execution time = 1.4389e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5283e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2315e-01
  Total weights = 1.951644136e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5671e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311772993023
                                         uncertainty =       0.002648128986

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311772993023
                                         uncertainty =       0.002648128986

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394850021
  error estimate for blocks of size 2^( 2) =       0.000409069129
  error estimate for blocks of size 2^( 3) =       0.000423280618
  error estimate for blocks of size 2^( 4) =       0.000436008723
  error estimate for blocks of size 2^( 5) =       0.000446838319
  error estimate for blocks of size 2^( 6) =       0.000456341215
  error estimate for blocks of size 2^( 7) =       0.000460384489

      target function =                  N/A
              le_mean =     -16.903939149142
             les_mean =     286.066311304722
             stat err =       0.000449893187
             autocorr =       1.298238553649
              std dev =       0.558402254403
             le_variance =       0.311813077722


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690393914914e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903939149138       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903939452298       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.903939465795       residual = 2.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.903939467903       residual = 2.67e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.4414e+01 is 2.209347e-05

solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903939149138       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903939225415       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.903939228836       residual = 2.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.903939229367       residual = 2.72e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.7656e+01 is 5.556473e-06

solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903939149138       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903939168238       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.903939169096       residual = 2.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.903939169229       residual = 2.73e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.9062e+02 is 1.391203e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.159421 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6960e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
ci_0001                 7.011131e-01 3 1  ON 0
ci_0002                 6.996405e-01 3 1  ON 1
ci_0003                -3.046523e-02 3 1  ON 2
ci_0004                -3.091397e-02 3 1  ON 3
ci_0005                -3.366266e-02 3 1  ON 4
ci_0006                -3.479432e-02 3 1  ON 5
ci_0007                -2.186745e-02 3 1  ON 6
ci_0008                -2.315629e-02 3 1  ON 7
ci_0009                -1.987163e-02 3 1  ON 8
ci_0010                -2.025264e-02 3 1  ON 9
ci_0011                -1.478836e-02 3 1  ON 10
ci_0012                -1.482244e-02 3 1  ON 11
ci_0013                 1.604582e-02 3 1  ON 12
ci_0014                 1.528531e-02 3 1  ON 13
ci_0015                 1.616126e-02 3 1  ON 14
ci_0016                 1.562185e-02 3 1  ON 15
ci_0017                 1.423528e-02 3 1  ON 16
ci_0018                 1.405525e-02 3 1  ON 17
ci_0019                 1.258221e-02 3 1  ON 18
ci_0020                 1.185911e-02 3 1  ON 19
ci_0021                 6.905039e-03 3 1  ON 20
ci_0022                 7.158036e-03 3 1  ON 21
ci_0023                -1.184458e-02 3 1  ON 22
ci_0024                -1.120386e-02 3 1  ON 23
ci_0025                -1.121483e-02 3 1  ON 24
ci_0026                -1.121860e-02 3 1  ON 25
ci_0027                -1.141958e-02 3 1  ON 26
ci_0028                -1.145878e-02 3 1  ON 27
ci_0029                -1.086535e-02 3 1  ON 28
ci_0030                -1.049802e-02 3 1  ON 29
ci_0031                 1.941725e-02 3 1  ON 30
ci_0032                 1.934226e-02 3 1  ON 31
ci_0033                 9.741981e-03 3 1  ON 32
ci_0034                 1.064462e-02 3 1  ON 33
ci_0035                 6.624939e-03 3 1  ON 34
ci_0036                 4.428872e-03 3 1  ON 35
ci_0037                -1.147020e-02 3 1  ON 36
ci_0038                -1.067735e-02 3 1  ON 37
ci_0039                -4.226112e-03 3 1  ON 38
ci_0040                -4.037491e-03 3 1  ON 39
ci_0041                 8.591796e-03 3 1  ON 40
ci_0042                 8.389561e-03 3 1  ON 41
ci_0043                -1.322906e-02 3 1  ON 42
ci_0044                -1.355909e-02 3 1  ON 43
ci_0045                 8.146307e-03 3 1  ON 44
ci_0046                 7.908215e-03 3 1  ON 45
ci_0047                -3.627927e-03 3 1  ON 46
ci_0048                -3.173202e-03 3 1  ON 47
ci_0049                -6.780134e-03 3 1  ON 48
ci_0050                -5.924873e-03 3 1  ON 49
ci_0051                -4.459408e-03 3 1  ON 50
ci_0052                -4.596374e-03 3 1  ON 51
ci_0053                -6.300817e-03 3 1  ON 52
ci_0054                -5.939167e-03 3 1  ON 53
ci_0055                 6.417614e-03 3 1  ON 54
ci_0056                 6.766173e-03 3 1  ON 55
ci_0057                 5.652267e-03 3 1  ON 56
ci_0058                 4.679862e-03 3 1  ON 57
ci_0059                -5.818041e-03 3 1  ON 58
ci_0060                -5.907081e-03 3 1  ON 59
ci_0061                -3.687810e-03 3 1  ON 60
ci_0062                -4.027637e-03 3 1  ON 61
ci_0063                -9.201664e-03 3 1  ON 62
ci_0064                -8.555015e-03 3 1  ON 63
ci_0065                -6.653082e-03 3 1  ON 64
ci_0066                -6.874423e-03 3 1  ON 65
ci_0067                -6.043377e-03 3 1  ON 66
ci_0068                -6.239860e-03 3 1  ON 67
ci_0069                 5.308707e-03 3 1  ON 68
ci_0070                 5.441090e-03 3 1  ON 69
ci_0071                 4.217135e-03 3 1  ON 70
ci_0072                 5.161541e-03 3 1  ON 71
ci_0073                 5.149645e-03 3 1  ON 72
ci_0074                 5.506934e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.7975
    reference variance = 0.4633
====================================================
  Execution time = 1.4065e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2501e-01
  Total weights = 1.9519e+06
  Execution time = 1.9038e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313253046919
                                         uncertainty =       0.002229411570

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313253046919
                                         uncertainty =       0.002229411570

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395726394
  error estimate for blocks of size 2^( 2) =       0.000409736397
  error estimate for blocks of size 2^( 3) =       0.000424109003
  error estimate for blocks of size 2^( 4) =       0.000438091072
  error estimate for blocks of size 2^( 5) =       0.000449774642
  error estimate for blocks of size 2^( 6) =       0.000459879005
  error estimate for blocks of size 2^( 7) =       0.000462964966

      target function =                  N/A
              le_mean =     -16.904027935996
             les_mean =     286.071159474884
             stat err =       0.000452677421
             autocorr =       1.308541890513
              std dev =       0.559641633661
             le_variance =       0.313198758126

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313258826838
                                         uncertainty =       0.002229870747

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313258826838
                                         uncertainty =       0.002229870747

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395730043
  error estimate for blocks of size 2^( 2) =       0.000409739952
  error estimate for blocks of size 2^( 3) =       0.000424112271
  error estimate for blocks of size 2^( 4) =       0.000438094192
  error estimate for blocks of size 2^( 5) =       0.000449777805
  error estimate for blocks of size 2^( 6) =       0.000459881669
  error estimate for blocks of size 2^( 7) =       0.000462966955

      target function =                  N/A
              le_mean =     -16.904027916414
             les_mean =     286.071180099990
             stat err =       0.000452680155
             autocorr =       1.308533570998
              std dev =       0.559646793163
             le_variance =       0.313204533097

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313255941971
                                         uncertainty =       0.002229641284

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313255941971
                                         uncertainty =       0.002229641284

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395728222
  error estimate for blocks of size 2^( 2) =       0.000409738178
  error estimate for blocks of size 2^( 3) =       0.000424110639
  error estimate for blocks of size 2^( 4) =       0.000438092634
  error estimate for blocks of size 2^( 5) =       0.000449776227
  error estimate for blocks of size 2^( 6) =       0.000459880338
  error estimate for blocks of size 2^( 7) =       0.000462965959

      target function =                  N/A
              le_mean =     -16.904027925397
             les_mean =     286.071194469152
             stat err =       0.000452678790
             autocorr =       1.308537716907
              std dev =       0.559644217963
             le_variance =       0.313201650700

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313253408230
                                         uncertainty =       0.002229440280

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313253408230
                                         uncertainty =       0.002229440280

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395726622
  error estimate for blocks of size 2^( 2) =       0.000409736619
  error estimate for blocks of size 2^( 3) =       0.000424109208
  error estimate for blocks of size 2^( 4) =       0.000438091267
  error estimate for blocks of size 2^( 5) =       0.000449774840
  error estimate for blocks of size 2^( 6) =       0.000459879171
  error estimate for blocks of size 2^( 7) =       0.000462965089

      target function =                  N/A
              le_mean =     -16.904027934484
             les_mean =     286.071160819291
             stat err =       0.000452677592
             autocorr =       1.308541369506
              std dev =       0.559641956190
             le_variance =       0.313199119128


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904027935996        initial  <--
     2.4414e+01     2.4414e+02             2.2093e-05       -16.904027916414
     9.7656e+01     9.7656e+02             5.5565e-06       -16.904027925397
     3.9062e+02     3.9062e+03             1.3912e-06       -16.904027934484

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.6402
  </log>
  <optVariables href="H2O.s010.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046464e-02 3 1  ON 2
ci_0004                -3.091212e-02 3 1  ON 3
ci_0005                -3.366196e-02 3 1  ON 4
ci_0006                -3.479372e-02 3 1  ON 5
ci_0007                -2.186530e-02 3 1  ON 6
ci_0008                -2.315684e-02 3 1  ON 7
ci_0009                -1.987032e-02 3 1  ON 8
ci_0010                -2.025439e-02 3 1  ON 9
ci_0011                -1.478730e-02 3 1  ON 10
ci_0012                -1.482301e-02 3 1  ON 11
ci_0013                 1.604635e-02 3 1  ON 12
ci_0014                 1.528534e-02 3 1  ON 13
ci_0015                 1.616097e-02 3 1  ON 14
ci_0016                 1.562241e-02 3 1  ON 15
ci_0017                 1.423615e-02 3 1  ON 16
ci_0018                 1.405583e-02 3 1  ON 17
ci_0019                 1.258399e-02 3 1  ON 18
ci_0020                 1.185992e-02 3 1  ON 19
ci_0021                 6.905650e-03 3 1  ON 20
ci_0022                 7.158315e-03 3 1  ON 21
ci_0023                -1.184553e-02 3 1  ON 22
ci_0024                -1.120241e-02 3 1  ON 23
ci_0025                -1.121362e-02 3 1  ON 24
ci_0026                -1.121615e-02 3 1  ON 25
ci_0027                -1.141764e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086571e-02 3 1  ON 28
ci_0030                -1.049961e-02 3 1  ON 29
ci_0031                 1.941868e-02 3 1  ON 30
ci_0032                 1.934132e-02 3 1  ON 31
ci_0033                 9.742440e-03 3 1  ON 32
ci_0034                 1.064359e-02 3 1  ON 33
ci_0035                 6.625049e-03 3 1  ON 34
ci_0036                 4.423315e-03 3 1  ON 35
ci_0037                -1.147143e-02 3 1  ON 36
ci_0038                -1.067730e-02 3 1  ON 37
ci_0039                -4.224481e-03 3 1  ON 38
ci_0040                -4.037545e-03 3 1  ON 39
ci_0041                 8.592948e-03 3 1  ON 40
ci_0042                 8.387405e-03 3 1  ON 41
ci_0043                -1.322946e-02 3 1  ON 42
ci_0044                -1.355797e-02 3 1  ON 43
ci_0045                 8.144493e-03 3 1  ON 44
ci_0046                 7.905365e-03 3 1  ON 45
ci_0047                -3.628904e-03 3 1  ON 46
ci_0048                -3.172351e-03 3 1  ON 47
ci_0049                -6.782582e-03 3 1  ON 48
ci_0050                -5.923778e-03 3 1  ON 49
ci_0051                -4.458184e-03 3 1  ON 50
ci_0052                -4.596475e-03 3 1  ON 51
ci_0053                -6.301372e-03 3 1  ON 52
ci_0054                -5.938148e-03 3 1  ON 53
ci_0055                 6.415218e-03 3 1  ON 54
ci_0056                 6.765489e-03 3 1  ON 55
ci_0057                 5.653064e-03 3 1  ON 56
ci_0058                 4.678573e-03 3 1  ON 57
ci_0059                -5.819294e-03 3 1  ON 58
ci_0060                -5.905117e-03 3 1  ON 59
ci_0061                -3.686790e-03 3 1  ON 60
ci_0062                -4.029202e-03 3 1  ON 61
ci_0063                -9.202421e-03 3 1  ON 62
ci_0064                -8.554649e-03 3 1  ON 63
ci_0065                -6.654943e-03 3 1  ON 64
ci_0066                -6.874045e-03 3 1  ON 65
ci_0067                -6.044475e-03 3 1  ON 66
ci_0068                -6.239134e-03 3 1  ON 67
ci_0069                 5.308838e-03 3 1  ON 68
ci_0070                 5.442889e-03 3 1  ON 69
ci_0071                 4.215513e-03 3 1  ON 70
ci_0072                 5.163090e-03 3 1  ON 71
ci_0073                 5.148216e-03 3 1  ON 72
ci_0074                 5.508994e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0606e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6894e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.8716
    reference variance = 0.157217
====================================================
  Execution time = 1.6651e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5256e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2933e-01
  Total weights = 1.951752458e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6084e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314796397788
                                         uncertainty =       0.002637969352

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314796397788
                                         uncertainty =       0.002637969352

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396740090
  error estimate for blocks of size 2^( 2) =       0.000410509258
  error estimate for blocks of size 2^( 3) =       0.000425006535
  error estimate for blocks of size 2^( 4) =       0.000437065526
  error estimate for blocks of size 2^( 5) =       0.000449097617
  error estimate for blocks of size 2^( 6) =       0.000456853013
  error estimate for blocks of size 2^( 7) =       0.000460919953

      target function =                  N/A
              le_mean =     -16.904502117726
             les_mean =     286.091519824859
             stat err =       0.000450984027
             autocorr =       1.292141712561
              std dev =       0.561075215717
             le_variance =       0.314805397692


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690450211773e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904502117723       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904502141323       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904502141067       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904502141046       residual = 1.50e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.4414e+02 is 2.570225e-06

solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904502117723       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904502123627       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904502123563       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904502123558       residual = 1.51e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.7656e+02 is 6.431277e-07

solving harmonic davidson linear method for identity shift 3.9062e+03, overlap shift 3.9062e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904502117723       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904502119200       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904502119184       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904502119181       residual = 1.51e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.9062e+03 is 1.608177e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.160730 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.9264e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
ci_0001                 7.011126e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046487e-02 3 1  ON 2
ci_0004                -3.091200e-02 3 1  ON 3
ci_0005                -3.366187e-02 3 1  ON 4
ci_0006                -3.479357e-02 3 1  ON 5
ci_0007                -2.186556e-02 3 1  ON 6
ci_0008                -2.315666e-02 3 1  ON 7
ci_0009                -1.987039e-02 3 1  ON 8
ci_0010                -2.025466e-02 3 1  ON 9
ci_0011                -1.478739e-02 3 1  ON 10
ci_0012                -1.482293e-02 3 1  ON 11
ci_0013                 1.604639e-02 3 1  ON 12
ci_0014                 1.528529e-02 3 1  ON 13
ci_0015                 1.616089e-02 3 1  ON 14
ci_0016                 1.562232e-02 3 1  ON 15
ci_0017                 1.423603e-02 3 1  ON 16
ci_0018                 1.405572e-02 3 1  ON 17
ci_0019                 1.258402e-02 3 1  ON 18
ci_0020                 1.185971e-02 3 1  ON 19
ci_0021                 6.905646e-03 3 1  ON 20
ci_0022                 7.158350e-03 3 1  ON 21
ci_0023                -1.184549e-02 3 1  ON 22
ci_0024                -1.120245e-02 3 1  ON 23
ci_0025                -1.121365e-02 3 1  ON 24
ci_0026                -1.121629e-02 3 1  ON 25
ci_0027                -1.141726e-02 3 1  ON 26
ci_0028                -1.145848e-02 3 1  ON 27
ci_0029                -1.086574e-02 3 1  ON 28
ci_0030                -1.049945e-02 3 1  ON 29
ci_0031                 1.941857e-02 3 1  ON 30
ci_0032                 1.934106e-02 3 1  ON 31
ci_0033                 9.742677e-03 3 1  ON 32
ci_0034                 1.064343e-02 3 1  ON 33
ci_0035                 6.625202e-03 3 1  ON 34
ci_0036                 4.423624e-03 3 1  ON 35
ci_0037                -1.147135e-02 3 1  ON 36
ci_0038                -1.067747e-02 3 1  ON 37
ci_0039                -4.224707e-03 3 1  ON 38
ci_0040                -4.037620e-03 3 1  ON 39
ci_0041                 8.592922e-03 3 1  ON 40
ci_0042                 8.387325e-03 3 1  ON 41
ci_0043                -1.322969e-02 3 1  ON 42
ci_0044                -1.355812e-02 3 1  ON 43
ci_0045                 8.144604e-03 3 1  ON 44
ci_0046                 7.905394e-03 3 1  ON 45
ci_0047                -3.628877e-03 3 1  ON 46
ci_0048                -3.172388e-03 3 1  ON 47
ci_0049                -6.782695e-03 3 1  ON 48
ci_0050                -5.923857e-03 3 1  ON 49
ci_0051                -4.458354e-03 3 1  ON 50
ci_0052                -4.596490e-03 3 1  ON 51
ci_0053                -6.301088e-03 3 1  ON 52
ci_0054                -5.938078e-03 3 1  ON 53
ci_0055                 6.415351e-03 3 1  ON 54
ci_0056                 6.765808e-03 3 1  ON 55
ci_0057                 5.653066e-03 3 1  ON 56
ci_0058                 4.678988e-03 3 1  ON 57
ci_0059                -5.819147e-03 3 1  ON 58
ci_0060                -5.905078e-03 3 1  ON 59
ci_0061                -3.686721e-03 3 1  ON 60
ci_0062                -4.029004e-03 3 1  ON 61
ci_0063                -9.202311e-03 3 1  ON 62
ci_0064                -8.555293e-03 3 1  ON 63
ci_0065                -6.654982e-03 3 1  ON 64
ci_0066                -6.874170e-03 3 1  ON 65
ci_0067                -6.044403e-03 3 1  ON 66
ci_0068                -6.239132e-03 3 1  ON 67
ci_0069                 5.308966e-03 3 1  ON 68
ci_0070                 5.442953e-03 3 1  ON 69
ci_0071                 4.215424e-03 3 1  ON 70
ci_0072                 5.162934e-03 3 1  ON 71
ci_0073                 5.148420e-03 3 1  ON 72
ci_0074                 5.508830e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.8596
    reference variance = 0.212342
====================================================
  Execution time = 1.4550e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.1897e-01
  Total weights = 1.9516e+06
  Execution time = 1.8875e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307022323997
                                         uncertainty =       0.001889933728

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307022323997
                                         uncertainty =       0.001889933728

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391823218
  error estimate for blocks of size 2^( 2) =       0.000405723740
  error estimate for blocks of size 2^( 3) =       0.000419594848
  error estimate for blocks of size 2^( 4) =       0.000431457718
  error estimate for blocks of size 2^( 5) =       0.000441509361
  error estimate for blocks of size 2^( 6) =       0.000447381780
  error estimate for blocks of size 2^( 7) =       0.000451328854

      target function =                  N/A
              le_mean =     -16.904846466994
             les_mean =     286.092805319890
             stat err =       0.000442919428
             autocorr =       1.277818369206
              std dev =       0.554121709081
             le_variance =       0.307050868475

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307023350651
                                         uncertainty =       0.001890001121

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307023350651
                                         uncertainty =       0.001890001121

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391823873
  error estimate for blocks of size 2^( 2) =       0.000405724338
  error estimate for blocks of size 2^( 3) =       0.000419595381
  error estimate for blocks of size 2^( 4) =       0.000431458231
  error estimate for blocks of size 2^( 5) =       0.000441509779
  error estimate for blocks of size 2^( 6) =       0.000447382221
  error estimate for blocks of size 2^( 7) =       0.000451329177

      target function =                  N/A
              le_mean =     -16.904846474720
             les_mean =     286.092931082966
             stat err =       0.000442919852
             autocorr =       1.277816545877
              std dev =       0.554122634599
             le_variance =       0.307051894175

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307022837516
                                         uncertainty =       0.001889967439

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307022837516
                                         uncertainty =       0.001889967439

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391823545
  error estimate for blocks of size 2^( 2) =       0.000405724039
  error estimate for blocks of size 2^( 3) =       0.000419595115
  error estimate for blocks of size 2^( 4) =       0.000431457975
  error estimate for blocks of size 2^( 5) =       0.000441509571
  error estimate for blocks of size 2^( 6) =       0.000447382002
  error estimate for blocks of size 2^( 7) =       0.000451329018

      target function =                  N/A
              le_mean =     -16.904846471229
             les_mean =     286.092811584540
             stat err =       0.000442919642
             autocorr =       1.277817464868
              std dev =       0.554122172014
             le_variance =       0.307051381517

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307022388182
                                         uncertainty =       0.001889937942

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307022388182
                                         uncertainty =       0.001889937942

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391823259
  error estimate for blocks of size 2^( 2) =       0.000405723777
  error estimate for blocks of size 2^( 3) =       0.000419594881
  error estimate for blocks of size 2^( 4) =       0.000431457750
  error estimate for blocks of size 2^( 5) =       0.000441509388
  error estimate for blocks of size 2^( 6) =       0.000447381807
  error estimate for blocks of size 2^( 7) =       0.000451328875

      target function =                  N/A
              le_mean =     -16.904846467516
             les_mean =     286.092805638805
             stat err =       0.000442919455
             autocorr =       1.277818256059
              std dev =       0.554121766943
             le_variance =       0.307050932600


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904846466994        initial
     2.4414e+02     2.4414e+03             2.5702e-06       -16.904846474720  <--
     9.7656e+02     9.7656e+03             6.4313e-07       -16.904846471229
     3.9062e+03     3.9062e+04             1.6082e-07       -16.904846467516

*****************************************************************************
Applying the update for shift_i =   2.4414e+02     and shift_s =   2.4414e+03
*****************************************************************************

  Execution time = 2.4085e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
ci_0001                 7.011127e-01 3 1  ON 0
ci_0002                 6.996412e-01 3 1  ON 1
ci_0003                -3.046557e-02 3 1  ON 2
ci_0004                -3.091163e-02 3 1  ON 3
ci_0005                -3.366161e-02 3 1  ON 4
ci_0006                -3.479312e-02 3 1  ON 5
ci_0007                -2.186636e-02 3 1  ON 6
ci_0008                -2.315611e-02 3 1  ON 7
ci_0009                -1.987057e-02 3 1  ON 8
ci_0010                -2.025547e-02 3 1  ON 9
ci_0011                -1.478765e-02 3 1  ON 10
ci_0012                -1.482270e-02 3 1  ON 11
ci_0013                 1.604649e-02 3 1  ON 12
ci_0014                 1.528516e-02 3 1  ON 13
ci_0015                 1.616065e-02 3 1  ON 14
ci_0016                 1.562205e-02 3 1  ON 15
ci_0017                 1.423565e-02 3 1  ON 16
ci_0018                 1.405537e-02 3 1  ON 17
ci_0019                 1.258412e-02 3 1  ON 18
ci_0020                 1.185907e-02 3 1  ON 19
ci_0021                 6.905633e-03 3 1  ON 20
ci_0022                 7.158456e-03 3 1  ON 21
ci_0023                -1.184537e-02 3 1  ON 22
ci_0024                -1.120255e-02 3 1  ON 23
ci_0025                -1.121374e-02 3 1  ON 24
ci_0026                -1.121672e-02 3 1  ON 25
ci_0027                -1.141614e-02 3 1  ON 26
ci_0028                -1.145842e-02 3 1  ON 27
ci_0029                -1.086585e-02 3 1  ON 28
ci_0030                -1.049897e-02 3 1  ON 29
ci_0031                 1.941822e-02 3 1  ON 30
ci_0032                 1.934030e-02 3 1  ON 31
ci_0033                 9.743386e-03 3 1  ON 32
ci_0034                 1.064295e-02 3 1  ON 33
ci_0035                 6.625660e-03 3 1  ON 34
ci_0036                 4.424552e-03 3 1  ON 35
ci_0037                -1.147114e-02 3 1  ON 36
ci_0038                -1.067795e-02 3 1  ON 37
ci_0039                -4.225384e-03 3 1  ON 38
ci_0040                -4.037846e-03 3 1  ON 39
ci_0041                 8.592847e-03 3 1  ON 40
ci_0042                 8.387084e-03 3 1  ON 41
ci_0043                -1.323038e-02 3 1  ON 42
ci_0044                -1.355855e-02 3 1  ON 43
ci_0045                 8.144936e-03 3 1  ON 44
ci_0046                 7.905482e-03 3 1  ON 45
ci_0047                -3.628797e-03 3 1  ON 46
ci_0048                -3.172498e-03 3 1  ON 47
ci_0049                -6.783035e-03 3 1  ON 48
ci_0050                -5.924092e-03 3 1  ON 49
ci_0051                -4.458860e-03 3 1  ON 50
ci_0052                -4.596532e-03 3 1  ON 51
ci_0053                -6.300237e-03 3 1  ON 52
ci_0054                -5.937869e-03 3 1  ON 53
ci_0055                 6.415751e-03 3 1  ON 54
ci_0056                 6.766765e-03 3 1  ON 55
ci_0057                 5.653074e-03 3 1  ON 56
ci_0058                 4.680230e-03 3 1  ON 57
ci_0059                -5.818706e-03 3 1  ON 58
ci_0060                -5.904963e-03 3 1  ON 59
ci_0061                -3.686513e-03 3 1  ON 60
ci_0062                -4.028411e-03 3 1  ON 61
ci_0063                -9.201979e-03 3 1  ON 62
ci_0064                -8.557220e-03 3 1  ON 63
ci_0065                -6.655100e-03 3 1  ON 64
ci_0066                -6.874546e-03 3 1  ON 65
ci_0067                -6.044188e-03 3 1  ON 66
ci_0068                -6.239127e-03 3 1  ON 67
ci_0069                 5.309352e-03 3 1  ON 68
ci_0070                 5.443145e-03 3 1  ON 69
ci_0071                 4.215158e-03 3 1  ON 70
ci_0072                 5.162468e-03 3 1  ON 71
ci_0073                 5.149031e-03 3 1  ON 72
ci_0074                 5.508335e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.3355e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6892e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.9199
    reference variance = 0.333439
====================================================
  Execution time = 1.4460e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5266e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2553e-01
  Total weights = 1.951740001e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5990e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313666812167
                                         uncertainty =       0.002242004541

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313666812167
                                         uncertainty =       0.002242004541

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396022380
  error estimate for blocks of size 2^( 2) =       0.000410202459
  error estimate for blocks of size 2^( 3) =       0.000424329179
  error estimate for blocks of size 2^( 4) =       0.000437247930
  error estimate for blocks of size 2^( 5) =       0.000448268861
  error estimate for blocks of size 2^( 6) =       0.000456614920
  error estimate for blocks of size 2^( 7) =       0.000462371638

      target function =                  N/A
              le_mean =     -16.904429100213
             les_mean =     286.085250966008
             stat err =       0.000451125837
             autocorr =       1.297645134467
              std dev =       0.560060220832
             le_variance =       0.313667450958


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690442910021e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904429100220       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904429149947       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904429153191       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904429154008       residual = 1.52e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e+01 is 6.951366e-06

solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904429100220       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904429112683       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904429113486       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904429113691       residual = 1.54e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.4414e+02 is 1.742360e-06

solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904429100220       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904429103338       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904429103538       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904429103589       residual = 1.55e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.7656e+02 is 4.358732e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.162062 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7064e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
ci_0001                 7.011127e-01 3 1  ON 0
ci_0002                 6.996410e-01 3 1  ON 1
ci_0003                -3.046541e-02 3 1  ON 2
ci_0004                -3.091230e-02 3 1  ON 3
ci_0005                -3.366216e-02 3 1  ON 4
ci_0006                -3.479304e-02 3 1  ON 5
ci_0007                -2.186627e-02 3 1  ON 6
ci_0008                -2.315681e-02 3 1  ON 7
ci_0009                -1.987094e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478830e-02 3 1  ON 10
ci_0012                -1.482323e-02 3 1  ON 11
ci_0013                 1.604600e-02 3 1  ON 12
ci_0014                 1.528557e-02 3 1  ON 13
ci_0015                 1.616060e-02 3 1  ON 14
ci_0016                 1.562202e-02 3 1  ON 15
ci_0017                 1.423602e-02 3 1  ON 16
ci_0018                 1.405496e-02 3 1  ON 17
ci_0019                 1.258285e-02 3 1  ON 18
ci_0020                 1.185962e-02 3 1  ON 19
ci_0021                 6.905720e-03 3 1  ON 20
ci_0022                 7.158639e-03 3 1  ON 21
ci_0023                -1.184457e-02 3 1  ON 22
ci_0024                -1.120242e-02 3 1  ON 23
ci_0025                -1.121437e-02 3 1  ON 24
ci_0026                -1.121846e-02 3 1  ON 25
ci_0027                -1.141661e-02 3 1  ON 26
ci_0028                -1.145843e-02 3 1  ON 27
ci_0029                -1.086659e-02 3 1  ON 28
ci_0030                -1.049910e-02 3 1  ON 29
ci_0031                 1.941796e-02 3 1  ON 30
ci_0032                 1.934039e-02 3 1  ON 31
ci_0033                 9.743716e-03 3 1  ON 32
ci_0034                 1.064312e-02 3 1  ON 33
ci_0035                 6.626749e-03 3 1  ON 34
ci_0036                 4.426172e-03 3 1  ON 35
ci_0037                -1.146981e-02 3 1  ON 36
ci_0038                -1.067908e-02 3 1  ON 37
ci_0039                -4.225058e-03 3 1  ON 38
ci_0040                -4.038501e-03 3 1  ON 39
ci_0041                 8.592086e-03 3 1  ON 40
ci_0042                 8.386160e-03 3 1  ON 41
ci_0043                -1.323112e-02 3 1  ON 42
ci_0044                -1.355906e-02 3 1  ON 43
ci_0045                 8.144672e-03 3 1  ON 44
ci_0046                 7.906099e-03 3 1  ON 45
ci_0047                -3.628270e-03 3 1  ON 46
ci_0048                -3.172430e-03 3 1  ON 47
ci_0049                -6.782675e-03 3 1  ON 48
ci_0050                -5.923813e-03 3 1  ON 49
ci_0051                -4.458372e-03 3 1  ON 50
ci_0052                -4.596614e-03 3 1  ON 51
ci_0053                -6.300744e-03 3 1  ON 52
ci_0054                -5.937156e-03 3 1  ON 53
ci_0055                 6.416432e-03 3 1  ON 54
ci_0056                 6.766973e-03 3 1  ON 55
ci_0057                 5.653004e-03 3 1  ON 56
ci_0058                 4.681148e-03 3 1  ON 57
ci_0059                -5.819121e-03 3 1  ON 58
ci_0060                -5.905468e-03 3 1  ON 59
ci_0061                -3.686818e-03 3 1  ON 60
ci_0062                -4.028232e-03 3 1  ON 61
ci_0063                -9.201867e-03 3 1  ON 62
ci_0064                -8.558639e-03 3 1  ON 63
ci_0065                -6.654651e-03 3 1  ON 64
ci_0066                -6.874579e-03 3 1  ON 65
ci_0067                -6.044199e-03 3 1  ON 66
ci_0068                -6.238664e-03 3 1  ON 67
ci_0069                 5.309042e-03 3 1  ON 68
ci_0070                 5.443158e-03 3 1  ON 69
ci_0071                 4.215694e-03 3 1  ON 70
ci_0072                 5.162058e-03 3 1  ON 71
ci_0073                 5.148897e-03 3 1  ON 72
ci_0074                 5.508525e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.8111
    reference variance = 0.28352
====================================================
  Execution time = 1.4340e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2099e-01
  Total weights = 1.9516e+06
  Execution time = 1.8954e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308815614542
                                         uncertainty =       0.001883348603

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308815614542
                                         uncertainty =       0.001883348603

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392923020
  error estimate for blocks of size 2^( 2) =       0.000407065919
  error estimate for blocks of size 2^( 3) =       0.000422266435
  error estimate for blocks of size 2^( 4) =       0.000435238240
  error estimate for blocks of size 2^( 5) =       0.000447481552
  error estimate for blocks of size 2^( 6) =       0.000457177054
  error estimate for blocks of size 2^( 7) =       0.000463679273

      target function =                  N/A
              le_mean =     -16.904228443886
             les_mean =     286.073930440665
             stat err =       0.000450894030
             autocorr =       1.316843072018
              std dev =       0.555677063682
             le_variance =       0.308776999103

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308817953003
                                         uncertainty =       0.001883183293

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308817953003
                                         uncertainty =       0.001883183293

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392924510
  error estimate for blocks of size 2^( 2) =       0.000407067374
  error estimate for blocks of size 2^( 3) =       0.000422267893
  error estimate for blocks of size 2^( 4) =       0.000435239617
  error estimate for blocks of size 2^( 5) =       0.000447482841
  error estimate for blocks of size 2^( 6) =       0.000457178247
  error estimate for blocks of size 2^( 7) =       0.000463680361

      target function =                  N/A
              le_mean =     -16.904228443669
             les_mean =     286.073933467470
             stat err =       0.000450895266
             autocorr =       1.316840306616
              std dev =       0.555679171303
             le_variance =       0.308779341420

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308816784340
                                         uncertainty =       0.001883265658

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308816784340
                                         uncertainty =       0.001883265658

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392923765
  error estimate for blocks of size 2^( 2) =       0.000407066647
  error estimate for blocks of size 2^( 3) =       0.000422267164
  error estimate for blocks of size 2^( 4) =       0.000435238929
  error estimate for blocks of size 2^( 5) =       0.000447482197
  error estimate for blocks of size 2^( 6) =       0.000457177651
  error estimate for blocks of size 2^( 7) =       0.000463679817

      target function =                  N/A
              le_mean =     -16.904228443584
             les_mean =     286.073931903147
             stat err =       0.000450894648
             autocorr =       1.316841688274
              std dev =       0.555678118009
             le_variance =       0.308778170834

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308815760643
                                         uncertainty =       0.001883338221

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308815760643
                                         uncertainty =       0.001883338221

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392923113
  error estimate for blocks of size 2^( 2) =       0.000407066010
  error estimate for blocks of size 2^( 3) =       0.000422266526
  error estimate for blocks of size 2^( 4) =       0.000435238326
  error estimate for blocks of size 2^( 5) =       0.000447481633
  error estimate for blocks of size 2^( 6) =       0.000457177128
  error estimate for blocks of size 2^( 7) =       0.000463679341

      target function =                  N/A
              le_mean =     -16.904228443825
             les_mean =     286.073930616710
             stat err =       0.000450894107
             autocorr =       1.316842899137
              std dev =       0.555677195363
             le_variance =       0.308777145446


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904228443886        initial  <--
     6.1035e+01     6.1035e+02             6.9514e-06       -16.904228443669
     2.4414e+02     2.4414e+03             1.7424e-06       -16.904228443584
     9.7656e+02     9.7656e+03             4.3587e-07       -16.904228443825

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.9040
  </log>
  <optVariables href="H2O.s012.opt.xml">
ci_0001                 7.011127e-01 3 1  ON 0
ci_0002                 6.996412e-01 3 1  ON 1
ci_0003                -3.046557e-02 3 1  ON 2
ci_0004                -3.091163e-02 3 1  ON 3
ci_0005                -3.366161e-02 3 1  ON 4
ci_0006                -3.479312e-02 3 1  ON 5
ci_0007                -2.186636e-02 3 1  ON 6
ci_0008                -2.315611e-02 3 1  ON 7
ci_0009                -1.987057e-02 3 1  ON 8
ci_0010                -2.025547e-02 3 1  ON 9
ci_0011                -1.478765e-02 3 1  ON 10
ci_0012                -1.482270e-02 3 1  ON 11
ci_0013                 1.604649e-02 3 1  ON 12
ci_0014                 1.528516e-02 3 1  ON 13
ci_0015                 1.616065e-02 3 1  ON 14
ci_0016                 1.562205e-02 3 1  ON 15
ci_0017                 1.423565e-02 3 1  ON 16
ci_0018                 1.405537e-02 3 1  ON 17
ci_0019                 1.258412e-02 3 1  ON 18
ci_0020                 1.185907e-02 3 1  ON 19
ci_0021                 6.905633e-03 3 1  ON 20
ci_0022                 7.158456e-03 3 1  ON 21
ci_0023                -1.184537e-02 3 1  ON 22
ci_0024                -1.120255e-02 3 1  ON 23
ci_0025                -1.121374e-02 3 1  ON 24
ci_0026                -1.121672e-02 3 1  ON 25
ci_0027                -1.141614e-02 3 1  ON 26
ci_0028                -1.145842e-02 3 1  ON 27
ci_0029                -1.086585e-02 3 1  ON 28
ci_0030                -1.049897e-02 3 1  ON 29
ci_0031                 1.941822e-02 3 1  ON 30
ci_0032                 1.934030e-02 3 1  ON 31
ci_0033                 9.743386e-03 3 1  ON 32
ci_0034                 1.064295e-02 3 1  ON 33
ci_0035                 6.625660e-03 3 1  ON 34
ci_0036                 4.424552e-03 3 1  ON 35
ci_0037                -1.147114e-02 3 1  ON 36
ci_0038                -1.067795e-02 3 1  ON 37
ci_0039                -4.225384e-03 3 1  ON 38
ci_0040                -4.037846e-03 3 1  ON 39
ci_0041                 8.592847e-03 3 1  ON 40
ci_0042                 8.387084e-03 3 1  ON 41
ci_0043                -1.323038e-02 3 1  ON 42
ci_0044                -1.355855e-02 3 1  ON 43
ci_0045                 8.144936e-03 3 1  ON 44
ci_0046                 7.905482e-03 3 1  ON 45
ci_0047                -3.628797e-03 3 1  ON 46
ci_0048                -3.172498e-03 3 1  ON 47
ci_0049                -6.783035e-03 3 1  ON 48
ci_0050                -5.924092e-03 3 1  ON 49
ci_0051                -4.458860e-03 3 1  ON 50
ci_0052                -4.596532e-03 3 1  ON 51
ci_0053                -6.300237e-03 3 1  ON 52
ci_0054                -5.937869e-03 3 1  ON 53
ci_0055                 6.415751e-03 3 1  ON 54
ci_0056                 6.766765e-03 3 1  ON 55
ci_0057                 5.653074e-03 3 1  ON 56
ci_0058                 4.680230e-03 3 1  ON 57
ci_0059                -5.818706e-03 3 1  ON 58
ci_0060                -5.904963e-03 3 1  ON 59
ci_0061                -3.686513e-03 3 1  ON 60
ci_0062                -4.028411e-03 3 1  ON 61
ci_0063                -9.201979e-03 3 1  ON 62
ci_0064                -8.557220e-03 3 1  ON 63
ci_0065                -6.655100e-03 3 1  ON 64
ci_0066                -6.874546e-03 3 1  ON 65
ci_0067                -6.044188e-03 3 1  ON 66
ci_0068                -6.239127e-03 3 1  ON 67
ci_0069                 5.309352e-03 3 1  ON 68
ci_0070                 5.443145e-03 3 1  ON 69
ci_0071                 4.215158e-03 3 1  ON 70
ci_0072                 5.162468e-03 3 1  ON 71
ci_0073                 5.149031e-03 3 1  ON 72
ci_0074                 5.508335e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0973e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6890e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.8099
    reference variance = 0.180294
====================================================
  Execution time = 1.4590e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5250e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2083e-01
  Total weights = 1.952030549e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5663e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308561749564
                                         uncertainty =       0.001667668759

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308561749564
                                         uncertainty =       0.001667668759

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392784526
  error estimate for blocks of size 2^( 2) =       0.000407018293
  error estimate for blocks of size 2^( 3) =       0.000421288821
  error estimate for blocks of size 2^( 4) =       0.000434287329
  error estimate for blocks of size 2^( 5) =       0.000445111761
  error estimate for blocks of size 2^( 6) =       0.000452788220
  error estimate for blocks of size 2^( 7) =       0.000456787666

      target function =                  N/A
              le_mean =     -16.903818526992
             les_mean =     286.059912834809
             stat err =       0.000447243744
             autocorr =       1.296521757645
              std dev =       0.555481203212
             le_variance =       0.308559367122


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690381852699e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903818527023       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903818533263       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.903818533196       residual = 1.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.903818533203       residual = 2.32e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e+02 is 9.500757e-07

solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903818527023       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903818528583       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.903818528566       residual = 1.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.903818528568       residual = 2.32e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.4414e+03 is 2.375744e-07

solving harmonic davidson linear method for identity shift 9.7656e+03, overlap shift 9.7656e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903818527023       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903818527413       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.903818527409       residual = 1.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.903818527409       residual = 2.32e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.7656e+03 is 5.939706e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.163349 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7161e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
ci_0001                 7.011127e-01 3 1  ON 0
ci_0002                 6.996412e-01 3 1  ON 1
ci_0003                -3.046555e-02 3 1  ON 2
ci_0004                -3.091161e-02 3 1  ON 3
ci_0005                -3.366165e-02 3 1  ON 4
ci_0006                -3.479316e-02 3 1  ON 5
ci_0007                -2.186644e-02 3 1  ON 6
ci_0008                -2.315606e-02 3 1  ON 7
ci_0009                -1.987056e-02 3 1  ON 8
ci_0010                -2.025543e-02 3 1  ON 9
ci_0011                -1.478771e-02 3 1  ON 10
ci_0012                -1.482270e-02 3 1  ON 11
ci_0013                 1.604645e-02 3 1  ON 12
ci_0014                 1.528522e-02 3 1  ON 13
ci_0015                 1.616071e-02 3 1  ON 14
ci_0016                 1.562201e-02 3 1  ON 15
ci_0017                 1.423562e-02 3 1  ON 16
ci_0018                 1.405536e-02 3 1  ON 17
ci_0019                 1.258408e-02 3 1  ON 18
ci_0020                 1.185915e-02 3 1  ON 19
ci_0021                 6.905666e-03 3 1  ON 20
ci_0022                 7.158509e-03 3 1  ON 21
ci_0023                -1.184533e-02 3 1  ON 22
ci_0024                -1.120256e-02 3 1  ON 23
ci_0025                -1.121375e-02 3 1  ON 24
ci_0026                -1.121671e-02 3 1  ON 25
ci_0027                -1.141608e-02 3 1  ON 26
ci_0028                -1.145846e-02 3 1  ON 27
ci_0029                -1.086578e-02 3 1  ON 28
ci_0030                -1.049891e-02 3 1  ON 29
ci_0031                 1.941811e-02 3 1  ON 30
ci_0032                 1.934027e-02 3 1  ON 31
ci_0033                 9.743462e-03 3 1  ON 32
ci_0034                 1.064292e-02 3 1  ON 33
ci_0035                 6.625698e-03 3 1  ON 34
ci_0036                 4.424789e-03 3 1  ON 35
ci_0037                -1.147113e-02 3 1  ON 36
ci_0038                -1.067791e-02 3 1  ON 37
ci_0039                -4.225529e-03 3 1  ON 38
ci_0040                -4.037885e-03 3 1  ON 39
ci_0041                 8.592823e-03 3 1  ON 40
ci_0042                 8.387149e-03 3 1  ON 41
ci_0043                -1.323034e-02 3 1  ON 42
ci_0044                -1.355859e-02 3 1  ON 43
ci_0045                 8.145002e-03 3 1  ON 44
ci_0046                 7.905641e-03 3 1  ON 45
ci_0047                -3.628727e-03 3 1  ON 46
ci_0048                -3.172560e-03 3 1  ON 47
ci_0049                -6.782977e-03 3 1  ON 48
ci_0050                -5.924192e-03 3 1  ON 49
ci_0051                -4.458912e-03 3 1  ON 50
ci_0052                -4.596498e-03 3 1  ON 51
ci_0053                -6.300167e-03 3 1  ON 52
ci_0054                -5.937879e-03 3 1  ON 53
ci_0055                 6.415755e-03 3 1  ON 54
ci_0056                 6.766734e-03 3 1  ON 55
ci_0057                 5.653058e-03 3 1  ON 56
ci_0058                 4.680237e-03 3 1  ON 57
ci_0059                -5.818697e-03 3 1  ON 58
ci_0060                -5.904898e-03 3 1  ON 59
ci_0061                -3.686542e-03 3 1  ON 60
ci_0062                -4.028389e-03 3 1  ON 61
ci_0063                -9.201878e-03 3 1  ON 62
ci_0064                -8.557235e-03 3 1  ON 63
ci_0065                -6.655097e-03 3 1  ON 64
ci_0066                -6.874575e-03 3 1  ON 65
ci_0067                -6.044180e-03 3 1  ON 66
ci_0068                -6.239153e-03 3 1  ON 67
ci_0069                 5.309421e-03 3 1  ON 68
ci_0070                 5.443123e-03 3 1  ON 69
ci_0071                 4.215204e-03 3 1  ON 70
ci_0072                 5.162382e-03 3 1  ON 71
ci_0073                 5.149051e-03 3 1  ON 72
ci_0074                 5.508242e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.8865
    reference variance = 0.158624
====================================================
  Execution time = 1.3936e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.1968e-01
  Total weights = 1.9521e+06
  Execution time = 1.8878e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309157542624
                                         uncertainty =       0.001739618280

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309157542624
                                         uncertainty =       0.001739618280

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393133509
  error estimate for blocks of size 2^( 2) =       0.000407311638
  error estimate for blocks of size 2^( 3) =       0.000421832100
  error estimate for blocks of size 2^( 4) =       0.000435150522
  error estimate for blocks of size 2^( 5) =       0.000446746422
  error estimate for blocks of size 2^( 6) =       0.000453821016
  error estimate for blocks of size 2^( 7) =       0.000457724086

      target function =                  N/A
              le_mean =     -16.903287602259
             les_mean =     286.040816903365
             stat err =       0.000448360512
             autocorr =       1.300692351289
              std dev =       0.555974740224
             le_variance =       0.309107911768

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309157416205
                                         uncertainty =       0.001739611977

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309157416205
                                         uncertainty =       0.001739611977

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393133429
  error estimate for blocks of size 2^( 2) =       0.000407311561
  error estimate for blocks of size 2^( 3) =       0.000421832026
  error estimate for blocks of size 2^( 4) =       0.000435150452
  error estimate for blocks of size 2^( 5) =       0.000446746344
  error estimate for blocks of size 2^( 6) =       0.000453820933
  error estimate for blocks of size 2^( 7) =       0.000457724017

      target function =                  N/A
              le_mean =     -16.903287604861
             les_mean =     286.040815310309
             stat err =       0.000448360437
             autocorr =       1.300692447726
              std dev =       0.555974626833
             le_variance =       0.309107785682

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309157479384
                                         uncertainty =       0.001739615128

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309157479384
                                         uncertainty =       0.001739615128

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393133469
  error estimate for blocks of size 2^( 2) =       0.000407311599
  error estimate for blocks of size 2^( 3) =       0.000421832063
  error estimate for blocks of size 2^( 4) =       0.000435150487
  error estimate for blocks of size 2^( 5) =       0.000446746383
  error estimate for blocks of size 2^( 6) =       0.000453820975
  error estimate for blocks of size 2^( 7) =       0.000457724052

      target function =                  N/A
              le_mean =     -16.903287603558
             les_mean =     286.040816089950
             stat err =       0.000448360474
             autocorr =       1.300692399539
              std dev =       0.555974683501
             le_variance =       0.309107848694

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309157534717
                                         uncertainty =       0.001739617886

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309157534717
                                         uncertainty =       0.001739617886

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393133504
  error estimate for blocks of size 2^( 2) =       0.000407311633
  error estimate for blocks of size 2^( 3) =       0.000421832095
  error estimate for blocks of size 2^( 4) =       0.000435150518
  error estimate for blocks of size 2^( 5) =       0.000446746417
  error estimate for blocks of size 2^( 6) =       0.000453821011
  error estimate for blocks of size 2^( 7) =       0.000457724082

      target function =                  N/A
              le_mean =     -16.903287602421
             les_mean =     286.040816799792
             stat err =       0.000448360507
             autocorr =       1.300692357326
              std dev =       0.555974733132
             le_variance =       0.309107903881


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.903287602259        initial
     6.1035e+02     6.1035e+03             9.5008e-07       -16.903287604861  <--
     2.4414e+03     2.4414e+04             2.3757e-07       -16.903287603558
     9.7656e+03     9.7656e+04             5.9397e-08       -16.903287602421

*****************************************************************************
Applying the update for shift_i =   6.1035e+02     and shift_s =   6.1035e+03
*****************************************************************************

  Execution time = 2.3498e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
ci_0001                 7.011126e-01 3 1  ON 0
ci_0002                 6.996412e-01 3 1  ON 1
ci_0003                -3.046549e-02 3 1  ON 2
ci_0004                -3.091157e-02 3 1  ON 3
ci_0005                -3.366178e-02 3 1  ON 4
ci_0006                -3.479326e-02 3 1  ON 5
ci_0007                -2.186671e-02 3 1  ON 6
ci_0008                -2.315588e-02 3 1  ON 7
ci_0009                -1.987053e-02 3 1  ON 8
ci_0010                -2.025533e-02 3 1  ON 9
ci_0011                -1.478788e-02 3 1  ON 10
ci_0012                -1.482268e-02 3 1  ON 11
ci_0013                 1.604632e-02 3 1  ON 12
ci_0014                 1.528539e-02 3 1  ON 13
ci_0015                 1.616089e-02 3 1  ON 14
ci_0016                 1.562190e-02 3 1  ON 15
ci_0017                 1.423553e-02 3 1  ON 16
ci_0018                 1.405532e-02 3 1  ON 17
ci_0019                 1.258399e-02 3 1  ON 18
ci_0020                 1.185938e-02 3 1  ON 19
ci_0021                 6.905763e-03 3 1  ON 20
ci_0022                 7.158667e-03 3 1  ON 21
ci_0023                -1.184520e-02 3 1  ON 22
ci_0024                -1.120259e-02 3 1  ON 23
ci_0025                -1.121376e-02 3 1  ON 24
ci_0026                -1.121671e-02 3 1  ON 25
ci_0027                -1.141590e-02 3 1  ON 26
ci_0028                -1.145856e-02 3 1  ON 27
ci_0029                -1.086558e-02 3 1  ON 28
ci_0030                -1.049875e-02 3 1  ON 29
ci_0031                 1.941777e-02 3 1  ON 30
ci_0032                 1.934020e-02 3 1  ON 31
ci_0033                 9.743688e-03 3 1  ON 32
ci_0034                 1.064282e-02 3 1  ON 33
ci_0035                 6.625809e-03 3 1  ON 34
ci_0036                 4.425502e-03 3 1  ON 35
ci_0037                -1.147111e-02 3 1  ON 36
ci_0038                -1.067780e-02 3 1  ON 37
ci_0039                -4.225964e-03 3 1  ON 38
ci_0040                -4.038001e-03 3 1  ON 39
ci_0041                 8.592751e-03 3 1  ON 40
ci_0042                 8.387344e-03 3 1  ON 41
ci_0043                -1.323021e-02 3 1  ON 42
ci_0044                -1.355871e-02 3 1  ON 43
ci_0045                 8.145201e-03 3 1  ON 44
ci_0046                 7.906117e-03 3 1  ON 45
ci_0047                -3.628519e-03 3 1  ON 46
ci_0048                -3.172744e-03 3 1  ON 47
ci_0049                -6.782804e-03 3 1  ON 48
ci_0050                -5.924490e-03 3 1  ON 49
ci_0051                -4.459067e-03 3 1  ON 50
ci_0052                -4.596398e-03 3 1  ON 51
ci_0053                -6.299955e-03 3 1  ON 52
ci_0054                -5.937908e-03 3 1  ON 53
ci_0055                 6.415767e-03 3 1  ON 54
ci_0056                 6.766641e-03 3 1  ON 55
ci_0057                 5.653012e-03 3 1  ON 56
ci_0058                 4.680257e-03 3 1  ON 57
ci_0059                -5.818667e-03 3 1  ON 58
ci_0060                -5.904702e-03 3 1  ON 59
ci_0061                -3.686629e-03 3 1  ON 60
ci_0062                -4.028324e-03 3 1  ON 61
ci_0063                -9.201575e-03 3 1  ON 62
ci_0064                -8.557280e-03 3 1  ON 63
ci_0065                -6.655085e-03 3 1  ON 64
ci_0066                -6.874665e-03 3 1  ON 65
ci_0067                -6.044154e-03 3 1  ON 66
ci_0068                -6.239231e-03 3 1  ON 67
ci_0069                 5.309629e-03 3 1  ON 68
ci_0070                 5.443057e-03 3 1  ON 69
ci_0071                 4.215341e-03 3 1  ON 70
ci_0072                 5.162125e-03 3 1  ON 71
ci_0073                 5.149111e-03 3 1  ON 72
ci_0074                 5.507961e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0665e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6887e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.8519
    reference variance = 0.385968
====================================================
  Execution time = 1.4758e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5246e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2459e-01
  Total weights = 1.951729587e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5638e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311725095748
                                         uncertainty =       0.002100654300

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311725095748
                                         uncertainty =       0.002100654300

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394788228
  error estimate for blocks of size 2^( 2) =       0.000408887137
  error estimate for blocks of size 2^( 3) =       0.000423151558
  error estimate for blocks of size 2^( 4) =       0.000435748356
  error estimate for blocks of size 2^( 5) =       0.000446293464
  error estimate for blocks of size 2^( 6) =       0.000453042153
  error estimate for blocks of size 2^( 7) =       0.000461340722

      target function =                  N/A
              le_mean =     -16.904068506728
             les_mean =     286.072120661084
             stat err =       0.000449106174
             autocorr =       1.294105439176
              std dev =       0.558314866146
             le_variance =       0.311715489759


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690406850673e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904068506735       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904068494694       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904068495602       residual = 9.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+02 is 2.396684e-06

solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904068506735       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904068503721       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904068503945       residual = 9.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e+02 is 5.998770e-07

solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904068506735       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904068505981       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904068506037       residual = 9.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.4414e+03 is 1.500135e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.164370 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7330e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
ci_0001                 7.011127e-01 3 1  ON 0
ci_0002                 6.996412e-01 3 1  ON 1
ci_0003                -3.046542e-02 3 1  ON 2
ci_0004                -3.091166e-02 3 1  ON 3
ci_0005                -3.366166e-02 3 1  ON 4
ci_0006                -3.479287e-02 3 1  ON 5
ci_0007                -2.186656e-02 3 1  ON 6
ci_0008                -2.315578e-02 3 1  ON 7
ci_0009                -1.987078e-02 3 1  ON 8
ci_0010                -2.025539e-02 3 1  ON 9
ci_0011                -1.478803e-02 3 1  ON 10
ci_0012                -1.482256e-02 3 1  ON 11
ci_0013                 1.604623e-02 3 1  ON 12
ci_0014                 1.528523e-02 3 1  ON 13
ci_0015                 1.616075e-02 3 1  ON 14
ci_0016                 1.562208e-02 3 1  ON 15
ci_0017                 1.423493e-02 3 1  ON 16
ci_0018                 1.405513e-02 3 1  ON 17
ci_0019                 1.258385e-02 3 1  ON 18
ci_0020                 1.185929e-02 3 1  ON 19
ci_0021                 6.905692e-03 3 1  ON 20
ci_0022                 7.158704e-03 3 1  ON 21
ci_0023                -1.184523e-02 3 1  ON 22
ci_0024                -1.120210e-02 3 1  ON 23
ci_0025                -1.121389e-02 3 1  ON 24
ci_0026                -1.121650e-02 3 1  ON 25
ci_0027                -1.141581e-02 3 1  ON 26
ci_0028                -1.145873e-02 3 1  ON 27
ci_0029                -1.086515e-02 3 1  ON 28
ci_0030                -1.049871e-02 3 1  ON 29
ci_0031                 1.941724e-02 3 1  ON 30
ci_0032                 1.934013e-02 3 1  ON 31
ci_0033                 9.744237e-03 3 1  ON 32
ci_0034                 1.064291e-02 3 1  ON 33
ci_0035                 6.626130e-03 3 1  ON 34
ci_0036                 4.426000e-03 3 1  ON 35
ci_0037                -1.147109e-02 3 1  ON 36
ci_0038                -1.067809e-02 3 1  ON 37
ci_0039                -4.225831e-03 3 1  ON 38
ci_0040                -4.037641e-03 3 1  ON 39
ci_0041                 8.592759e-03 3 1  ON 40
ci_0042                 8.387074e-03 3 1  ON 41
ci_0043                -1.323048e-02 3 1  ON 42
ci_0044                -1.355879e-02 3 1  ON 43
ci_0045                 8.145454e-03 3 1  ON 44
ci_0046                 7.906136e-03 3 1  ON 45
ci_0047                -3.628108e-03 3 1  ON 46
ci_0048                -3.172938e-03 3 1  ON 47
ci_0049                -6.782521e-03 3 1  ON 48
ci_0050                -5.924606e-03 3 1  ON 49
ci_0051                -4.458831e-03 3 1  ON 50
ci_0052                -4.596628e-03 3 1  ON 51
ci_0053                -6.300085e-03 3 1  ON 52
ci_0054                -5.938175e-03 3 1  ON 53
ci_0055                 6.416058e-03 3 1  ON 54
ci_0056                 6.766895e-03 3 1  ON 55
ci_0057                 5.652963e-03 3 1  ON 56
ci_0058                 4.680374e-03 3 1  ON 57
ci_0059                -5.818366e-03 3 1  ON 58
ci_0060                -5.905099e-03 3 1  ON 59
ci_0061                -3.686686e-03 3 1  ON 60
ci_0062                -4.027836e-03 3 1  ON 61
ci_0063                -9.201406e-03 3 1  ON 62
ci_0064                -8.557594e-03 3 1  ON 63
ci_0065                -6.654993e-03 3 1  ON 64
ci_0066                -6.874367e-03 3 1  ON 65
ci_0067                -6.044235e-03 3 1  ON 66
ci_0068                -6.239787e-03 3 1  ON 67
ci_0069                 5.309533e-03 3 1  ON 68
ci_0070                 5.442517e-03 3 1  ON 69
ci_0071                 4.215318e-03 3 1  ON 70
ci_0072                 5.161759e-03 3 1  ON 71
ci_0073                 5.149057e-03 3 1  ON 72
ci_0074                 5.507793e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.9056
    reference variance = 0.195686
====================================================
  Execution time = 1.4079e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2707e-01
  Total weights = 1.9516e+06
  Execution time = 1.8885e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314192480075
                                         uncertainty =       0.002405166083

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314192480075
                                         uncertainty =       0.002405166083

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396306369
  error estimate for blocks of size 2^( 2) =       0.000410326710
  error estimate for blocks of size 2^( 3) =       0.000424675982
  error estimate for blocks of size 2^( 4) =       0.000437745084
  error estimate for blocks of size 2^( 5) =       0.000448681999
  error estimate for blocks of size 2^( 6) =       0.000457983828
  error estimate for blocks of size 2^( 7) =       0.000464634098

      target function =                  N/A
              le_mean =     -16.904606908094
             les_mean =     286.092803613702
             stat err =       0.000452261252
             autocorr =       1.302316841825
              std dev =       0.560461842436
             le_variance =       0.314117476827

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314192381494
                                         uncertainty =       0.002405052217

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314192381494
                                         uncertainty =       0.002405052217

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396306307
  error estimate for blocks of size 2^( 2) =       0.000410326688
  error estimate for blocks of size 2^( 3) =       0.000424675974
  error estimate for blocks of size 2^( 4) =       0.000437745064
  error estimate for blocks of size 2^( 5) =       0.000448682016
  error estimate for blocks of size 2^( 6) =       0.000457983831
  error estimate for blocks of size 2^( 7) =       0.000464634184

      target function =                  N/A
              le_mean =     -16.904606889185
             les_mean =     286.092789327563
             stat err =       0.000452261274
             autocorr =       1.302317376962
              std dev =       0.560461753993
             le_variance =       0.314117377689

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314192430118
                                         uncertainty =       0.002405109047

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314192430118
                                         uncertainty =       0.002405109047

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396306338
  error estimate for blocks of size 2^( 2) =       0.000410326699
  error estimate for blocks of size 2^( 3) =       0.000424675977
  error estimate for blocks of size 2^( 4) =       0.000437745074
  error estimate for blocks of size 2^( 5) =       0.000448682007
  error estimate for blocks of size 2^( 6) =       0.000457983829
  error estimate for blocks of size 2^( 7) =       0.000464634141

      target function =                  N/A
              le_mean =     -16.904606898576
             les_mean =     286.092796329611
             stat err =       0.000452261263
             autocorr =       1.302317110617
              std dev =       0.560461797620
             le_variance =       0.314117426591

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314192473780
                                         uncertainty =       0.002405158949

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314192473780
                                         uncertainty =       0.002405158949

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396306365
  error estimate for blocks of size 2^( 2) =       0.000410326709
  error estimate for blocks of size 2^( 3) =       0.000424675981
  error estimate for blocks of size 2^( 4) =       0.000437745083
  error estimate for blocks of size 2^( 5) =       0.000448682000
  error estimate for blocks of size 2^( 6) =       0.000457983828
  error estimate for blocks of size 2^( 7) =       0.000464634103

      target function =                  N/A
              le_mean =     -16.904606906898
             les_mean =     286.092802688131
             stat err =       0.000452261253
             autocorr =       1.302316875508
              std dev =       0.560461836789
             le_variance =       0.314117470497


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904606908094        initial  <--
     1.5259e+02     1.5259e+03             2.3967e-06       -16.904606889185
     6.1035e+02     6.1035e+03             5.9988e-07       -16.904606898576
     2.4414e+03     2.4414e+04             1.5001e-07       -16.904606906898

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.6254
  </log>
  <optVariables href="H2O.s014.opt.xml">
ci_0001                 7.011126e-01 3 1  ON 0
ci_0002                 6.996412e-01 3 1  ON 1
ci_0003                -3.046549e-02 3 1  ON 2
ci_0004                -3.091157e-02 3 1  ON 3
ci_0005                -3.366178e-02 3 1  ON 4
ci_0006                -3.479326e-02 3 1  ON 5
ci_0007                -2.186671e-02 3 1  ON 6
ci_0008                -2.315588e-02 3 1  ON 7
ci_0009                -1.987053e-02 3 1  ON 8
ci_0010                -2.025533e-02 3 1  ON 9
ci_0011                -1.478788e-02 3 1  ON 10
ci_0012                -1.482268e-02 3 1  ON 11
ci_0013                 1.604632e-02 3 1  ON 12
ci_0014                 1.528539e-02 3 1  ON 13
ci_0015                 1.616089e-02 3 1  ON 14
ci_0016                 1.562190e-02 3 1  ON 15
ci_0017                 1.423553e-02 3 1  ON 16
ci_0018                 1.405532e-02 3 1  ON 17
ci_0019                 1.258399e-02 3 1  ON 18
ci_0020                 1.185938e-02 3 1  ON 19
ci_0021                 6.905763e-03 3 1  ON 20
ci_0022                 7.158667e-03 3 1  ON 21
ci_0023                -1.184520e-02 3 1  ON 22
ci_0024                -1.120259e-02 3 1  ON 23
ci_0025                -1.121376e-02 3 1  ON 24
ci_0026                -1.121671e-02 3 1  ON 25
ci_0027                -1.141590e-02 3 1  ON 26
ci_0028                -1.145856e-02 3 1  ON 27
ci_0029                -1.086558e-02 3 1  ON 28
ci_0030                -1.049875e-02 3 1  ON 29
ci_0031                 1.941777e-02 3 1  ON 30
ci_0032                 1.934020e-02 3 1  ON 31
ci_0033                 9.743688e-03 3 1  ON 32
ci_0034                 1.064282e-02 3 1  ON 33
ci_0035                 6.625809e-03 3 1  ON 34
ci_0036                 4.425502e-03 3 1  ON 35
ci_0037                -1.147111e-02 3 1  ON 36
ci_0038                -1.067780e-02 3 1  ON 37
ci_0039                -4.225964e-03 3 1  ON 38
ci_0040                -4.038001e-03 3 1  ON 39
ci_0041                 8.592751e-03 3 1  ON 40
ci_0042                 8.387344e-03 3 1  ON 41
ci_0043                -1.323021e-02 3 1  ON 42
ci_0044                -1.355871e-02 3 1  ON 43
ci_0045                 8.145201e-03 3 1  ON 44
ci_0046                 7.906117e-03 3 1  ON 45
ci_0047                -3.628519e-03 3 1  ON 46
ci_0048                -3.172744e-03 3 1  ON 47
ci_0049                -6.782804e-03 3 1  ON 48
ci_0050                -5.924490e-03 3 1  ON 49
ci_0051                -4.459067e-03 3 1  ON 50
ci_0052                -4.596398e-03 3 1  ON 51
ci_0053                -6.299955e-03 3 1  ON 52
ci_0054                -5.937908e-03 3 1  ON 53
ci_0055                 6.415767e-03 3 1  ON 54
ci_0056                 6.766641e-03 3 1  ON 55
ci_0057                 5.653012e-03 3 1  ON 56
ci_0058                 4.680257e-03 3 1  ON 57
ci_0059                -5.818667e-03 3 1  ON 58
ci_0060                -5.904702e-03 3 1  ON 59
ci_0061                -3.686629e-03 3 1  ON 60
ci_0062                -4.028324e-03 3 1  ON 61
ci_0063                -9.201575e-03 3 1  ON 62
ci_0064                -8.557280e-03 3 1  ON 63
ci_0065                -6.655085e-03 3 1  ON 64
ci_0066                -6.874665e-03 3 1  ON 65
ci_0067                -6.044154e-03 3 1  ON 66
ci_0068                -6.239231e-03 3 1  ON 67
ci_0069                 5.309629e-03 3 1  ON 68
ci_0070                 5.443057e-03 3 1  ON 69
ci_0071                 4.215341e-03 3 1  ON 70
ci_0072                 5.162125e-03 3 1  ON 71
ci_0073                 5.149111e-03 3 1  ON 72
ci_0074                 5.507961e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0971e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6886e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.9184
    reference variance = 0.21578
====================================================
  Execution time = 1.4609e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5246e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2255e-01
  Total weights = 1.951731010e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5686e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309821197034
                                         uncertainty =       0.002274794400

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309821197034
                                         uncertainty =       0.002274794400

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393631505
  error estimate for blocks of size 2^( 2) =       0.000407597321
  error estimate for blocks of size 2^( 3) =       0.000421535976
  error estimate for blocks of size 2^( 4) =       0.000434895216
  error estimate for blocks of size 2^( 5) =       0.000445650534
  error estimate for blocks of size 2^( 6) =       0.000452778968
  error estimate for blocks of size 2^( 7) =       0.000458028986

      target function =                  N/A
              le_mean =     -16.904151576830
             les_mean =     286.072892069704
             stat err =       0.000447838426
             autocorr =       1.294383619411
              std dev =       0.556679012824
             le_variance =       0.309891523319


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690415157683e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904151576810       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904151578100       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904151578051       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904151578051       residual = 1.90e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+03 is 4.277929e-07

solving harmonic davidson linear method for identity shift 6.1035e+03, overlap shift 6.1035e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904151576810       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904151577133       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904151577120       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904151577119       residual = 1.90e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e+03 is 1.069583e-07

solving harmonic davidson linear method for identity shift 2.4414e+04, overlap shift 2.4414e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904151576810       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904151576891       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904151576888       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904151576893       residual = 1.90e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.4414e+04 is 2.674020e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.165763 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7183e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
ci_0001                 7.011126e-01 3 1  ON 0
ci_0002                 6.996412e-01 3 1  ON 1
ci_0003                -3.046547e-02 3 1  ON 2
ci_0004                -3.091155e-02 3 1  ON 3
ci_0005                -3.366179e-02 3 1  ON 4
ci_0006                -3.479327e-02 3 1  ON 5
ci_0007                -2.186673e-02 3 1  ON 6
ci_0008                -2.315586e-02 3 1  ON 7
ci_0009                -1.987052e-02 3 1  ON 8
ci_0010                -2.025533e-02 3 1  ON 9
ci_0011                -1.478790e-02 3 1  ON 10
ci_0012                -1.482268e-02 3 1  ON 11
ci_0013                 1.604631e-02 3 1  ON 12
ci_0014                 1.528541e-02 3 1  ON 13
ci_0015                 1.616090e-02 3 1  ON 14
ci_0016                 1.562189e-02 3 1  ON 15
ci_0017                 1.423551e-02 3 1  ON 16
ci_0018                 1.405533e-02 3 1  ON 17
ci_0019                 1.258399e-02 3 1  ON 18
ci_0020                 1.185939e-02 3 1  ON 19
ci_0021                 6.905749e-03 3 1  ON 20
ci_0022                 7.158708e-03 3 1  ON 21
ci_0023                -1.184521e-02 3 1  ON 22
ci_0024                -1.120261e-02 3 1  ON 23
ci_0025                -1.121384e-02 3 1  ON 24
ci_0026                -1.121671e-02 3 1  ON 25
ci_0027                -1.141592e-02 3 1  ON 26
ci_0028                -1.145859e-02 3 1  ON 27
ci_0029                -1.086559e-02 3 1  ON 28
ci_0030                -1.049874e-02 3 1  ON 29
ci_0031                 1.941775e-02 3 1  ON 30
ci_0032                 1.934022e-02 3 1  ON 31
ci_0033                 9.743713e-03 3 1  ON 32
ci_0034                 1.064282e-02 3 1  ON 33
ci_0035                 6.625810e-03 3 1  ON 34
ci_0036                 4.425609e-03 3 1  ON 35
ci_0037                -1.147116e-02 3 1  ON 36
ci_0038                -1.067781e-02 3 1  ON 37
ci_0039                -4.225945e-03 3 1  ON 38
ci_0040                -4.038016e-03 3 1  ON 39
ci_0041                 8.592777e-03 3 1  ON 40
ci_0042                 8.387350e-03 3 1  ON 41
ci_0043                -1.323024e-02 3 1  ON 42
ci_0044                -1.355872e-02 3 1  ON 43
ci_0045                 8.145189e-03 3 1  ON 44
ci_0046                 7.906149e-03 3 1  ON 45
ci_0047                -3.628507e-03 3 1  ON 46
ci_0048                -3.172755e-03 3 1  ON 47
ci_0049                -6.782727e-03 3 1  ON 48
ci_0050                -5.924516e-03 3 1  ON 49
ci_0051                -4.459084e-03 3 1  ON 50
ci_0052                -4.596399e-03 3 1  ON 51
ci_0053                -6.299959e-03 3 1  ON 52
ci_0054                -5.937943e-03 3 1  ON 53
ci_0055                 6.415805e-03 3 1  ON 54
ci_0056                 6.766650e-03 3 1  ON 55
ci_0057                 5.653006e-03 3 1  ON 56
ci_0058                 4.680256e-03 3 1  ON 57
ci_0059                -5.818720e-03 3 1  ON 58
ci_0060                -5.904708e-03 3 1  ON 59
ci_0061                -3.686631e-03 3 1  ON 60
ci_0062                -4.028331e-03 3 1  ON 61
ci_0063                -9.201570e-03 3 1  ON 62
ci_0064                -8.557295e-03 3 1  ON 63
ci_0065                -6.655045e-03 3 1  ON 64
ci_0066                -6.874621e-03 3 1  ON 65
ci_0067                -6.044151e-03 3 1  ON 66
ci_0068                -6.239251e-03 3 1  ON 67
ci_0069                 5.309642e-03 3 1  ON 68
ci_0070                 5.443055e-03 3 1  ON 69
ci_0071                 4.215347e-03 3 1  ON 70
ci_0072                 5.162086e-03 3 1  ON 71
ci_0073                 5.149083e-03 3 1  ON 72
ci_0074                 5.507900e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.8835
    reference variance = 0.255657
====================================================
  Execution time = 1.4249e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2625e-01
  Total weights = 1.9520e+06
  Execution time = 1.8884e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312871468837
                                         uncertainty =       0.002424629794

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312871468837
                                         uncertainty =       0.002424629794

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395540176
  error estimate for blocks of size 2^( 2) =       0.000409316153
  error estimate for blocks of size 2^( 3) =       0.000423306952
  error estimate for blocks of size 2^( 4) =       0.000435313672
  error estimate for blocks of size 2^( 5) =       0.000444359640
  error estimate for blocks of size 2^( 6) =       0.000451788627
  error estimate for blocks of size 2^( 7) =       0.000453817219

      target function =                  N/A
              le_mean =     -16.904470775777
             les_mean =     286.087384566096
             stat err =       0.000446319789
             autocorr =       1.273242371247
              std dev =       0.559378280738
             le_variance =       0.312904060961

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312871538169
                                         uncertainty =       0.002424626414

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312871538169
                                         uncertainty =       0.002424626414

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395540219
  error estimate for blocks of size 2^( 2) =       0.000409316192
  error estimate for blocks of size 2^( 3) =       0.000423306984
  error estimate for blocks of size 2^( 4) =       0.000435313701
  error estimate for blocks of size 2^( 5) =       0.000444359672
  error estimate for blocks of size 2^( 6) =       0.000451788670
  error estimate for blocks of size 2^( 7) =       0.000453817254

      target function =                  N/A
              le_mean =     -16.904470776186
             les_mean =     286.087384425922
             stat err =       0.000446319824
             autocorr =       1.273242293715
              std dev =       0.559378341478
             le_variance =       0.312904128915

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312871503503
                                         uncertainty =       0.002424628104

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312871503503
                                         uncertainty =       0.002424628104

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395540197
  error estimate for blocks of size 2^( 2) =       0.000409316173
  error estimate for blocks of size 2^( 3) =       0.000423306968
  error estimate for blocks of size 2^( 4) =       0.000435313686
  error estimate for blocks of size 2^( 5) =       0.000444359656
  error estimate for blocks of size 2^( 6) =       0.000451788648
  error estimate for blocks of size 2^( 7) =       0.000453817236

      target function =                  N/A
              le_mean =     -16.904470775981
             les_mean =     286.087384495694
             stat err =       0.000446319807
             autocorr =       1.273242332482
              std dev =       0.559378311108
             le_variance =       0.312904094939

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312871473170
                                         uncertainty =       0.002424629583

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312871473170
                                         uncertainty =       0.002424629583

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395540178
  error estimate for blocks of size 2^( 2) =       0.000409316156
  error estimate for blocks of size 2^( 3) =       0.000423306954
  error estimate for blocks of size 2^( 4) =       0.000435313673
  error estimate for blocks of size 2^( 5) =       0.000444359642
  error estimate for blocks of size 2^( 6) =       0.000451788629
  error estimate for blocks of size 2^( 7) =       0.000453817221

      target function =                  N/A
              le_mean =     -16.904470775802
             les_mean =     286.087384557262
             stat err =       0.000446319791
             autocorr =       1.273242366402
              std dev =       0.559378284533
             le_variance =       0.312904065208


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904470775777        initial
     1.5259e+03     1.5259e+04             4.2779e-07       -16.904470776186  <--
     6.1035e+03     6.1035e+04             1.0696e-07       -16.904470775981
     2.4414e+04     2.4414e+05             2.6740e-08       -16.904470775802

*****************************************************************************
Applying the update for shift_i =   1.5259e+03     and shift_s =   1.5259e+04
*****************************************************************************

  Execution time = 2.3806e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
ci_0001                 7.011126e-01 3 1  ON 0
ci_0002                 6.996412e-01 3 1  ON 1
ci_0003                -3.046543e-02 3 1  ON 2
ci_0004                -3.091150e-02 3 1  ON 3
ci_0005                -3.366185e-02 3 1  ON 4
ci_0006                -3.479331e-02 3 1  ON 5
ci_0007                -2.186680e-02 3 1  ON 6
ci_0008                -2.315580e-02 3 1  ON 7
ci_0009                -1.987051e-02 3 1  ON 8
ci_0010                -2.025534e-02 3 1  ON 9
ci_0011                -1.478795e-02 3 1  ON 10
ci_0012                -1.482265e-02 3 1  ON 11
ci_0013                 1.604628e-02 3 1  ON 12
ci_0014                 1.528548e-02 3 1  ON 13
ci_0015                 1.616092e-02 3 1  ON 14
ci_0016                 1.562188e-02 3 1  ON 15
ci_0017                 1.423547e-02 3 1  ON 16
ci_0018                 1.405538e-02 3 1  ON 17
ci_0019                 1.258399e-02 3 1  ON 18
ci_0020                 1.185942e-02 3 1  ON 19
ci_0021                 6.905707e-03 3 1  ON 20
ci_0022                 7.158832e-03 3 1  ON 21
ci_0023                -1.184525e-02 3 1  ON 22
ci_0024                -1.120268e-02 3 1  ON 23
ci_0025                -1.121406e-02 3 1  ON 24
ci_0026                -1.121673e-02 3 1  ON 25
ci_0027                -1.141598e-02 3 1  ON 26
ci_0028                -1.145868e-02 3 1  ON 27
ci_0029                -1.086562e-02 3 1  ON 28
ci_0030                -1.049871e-02 3 1  ON 29
ci_0031                 1.941768e-02 3 1  ON 30
ci_0032                 1.934029e-02 3 1  ON 31
ci_0033                 9.743787e-03 3 1  ON 32
ci_0034                 1.064283e-02 3 1  ON 33
ci_0035                 6.625816e-03 3 1  ON 34
ci_0036                 4.425930e-03 3 1  ON 35
ci_0037                -1.147133e-02 3 1  ON 36
ci_0038                -1.067786e-02 3 1  ON 37
ci_0039                -4.225887e-03 3 1  ON 38
ci_0040                -4.038060e-03 3 1  ON 39
ci_0041                 8.592856e-03 3 1  ON 40
ci_0042                 8.387366e-03 3 1  ON 41
ci_0043                -1.323032e-02 3 1  ON 42
ci_0044                -1.355876e-02 3 1  ON 43
ci_0045                 8.145154e-03 3 1  ON 44
ci_0046                 7.906244e-03 3 1  ON 45
ci_0047                -3.628471e-03 3 1  ON 46
ci_0048                -3.172789e-03 3 1  ON 47
ci_0049                -6.782494e-03 3 1  ON 48
ci_0050                -5.924593e-03 3 1  ON 49
ci_0051                -4.459136e-03 3 1  ON 50
ci_0052                -4.596402e-03 3 1  ON 51
ci_0053                -6.299974e-03 3 1  ON 52
ci_0054                -5.938046e-03 3 1  ON 53
ci_0055                 6.415919e-03 3 1  ON 54
ci_0056                 6.766674e-03 3 1  ON 55
ci_0057                 5.652987e-03 3 1  ON 56
ci_0058                 4.680255e-03 3 1  ON 57
ci_0059                -5.818879e-03 3 1  ON 58
ci_0060                -5.904727e-03 3 1  ON 59
ci_0061                -3.686639e-03 3 1  ON 60
ci_0062                -4.028354e-03 3 1  ON 61
ci_0063                -9.201558e-03 3 1  ON 62
ci_0064                -8.557339e-03 3 1  ON 63
ci_0065                -6.654925e-03 3 1  ON 64
ci_0066                -6.874490e-03 3 1  ON 65
ci_0067                -6.044139e-03 3 1  ON 66
ci_0068                -6.239311e-03 3 1  ON 67
ci_0069                 5.309683e-03 3 1  ON 68
ci_0070                 5.443048e-03 3 1  ON 69
ci_0071                 4.215363e-03 3 1  ON 70
ci_0072                 5.161969e-03 3 1  ON 71
ci_0073                 5.148999e-03 3 1  ON 72
ci_0074                 5.507718e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0994e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6887e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.9161
    reference variance = 0.359704
====================================================
  Execution time = 1.4373e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5252e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.1830e-01
  Total weights = 1.951558869e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5658e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307358440386
                                         uncertainty =       0.001659365901

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307358440386
                                         uncertainty =       0.001659365901

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392009391
  error estimate for blocks of size 2^( 2) =       0.000405681590
  error estimate for blocks of size 2^( 3) =       0.000420053134
  error estimate for blocks of size 2^( 4) =       0.000433474714
  error estimate for blocks of size 2^( 5) =       0.000444025289
  error estimate for blocks of size 2^( 6) =       0.000452218138
  error estimate for blocks of size 2^( 7) =       0.000456700983

      target function =                  N/A
              le_mean =     -16.904366374736
             les_mean =     286.075904168096
             stat err =       0.000446604781
             autocorr =       1.297937537214
              std dev =       0.554384997728
             le_variance =       0.307342725706


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690436637474e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904366374752       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904366395804       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904366397493       residual = 3.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904366397425       residual = 3.66e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+02 is 1.279269e-06

solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904366374752       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904366380017       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904366380440       residual = 3.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904366380423       residual = 3.67e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+03 is 3.199399e-07

solving harmonic davidson linear method for identity shift 6.1035e+03, overlap shift 6.1035e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904366374752       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904366376068       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904366376174       residual = 3.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904366376170       residual = 3.67e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e+03 is 7.999264e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.167056 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6944e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
ci_0001                 7.011126e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046557e-02 3 1  ON 2
ci_0004                -3.091129e-02 3 1  ON 3
ci_0005                -3.366178e-02 3 1  ON 4
ci_0006                -3.479321e-02 3 1  ON 5
ci_0007                -2.186680e-02 3 1  ON 6
ci_0008                -2.315577e-02 3 1  ON 7
ci_0009                -1.987050e-02 3 1  ON 8
ci_0010                -2.025523e-02 3 1  ON 9
ci_0011                -1.478799e-02 3 1  ON 10
ci_0012                -1.482274e-02 3 1  ON 11
ci_0013                 1.604619e-02 3 1  ON 12
ci_0014                 1.528570e-02 3 1  ON 13
ci_0015                 1.616087e-02 3 1  ON 14
ci_0016                 1.562201e-02 3 1  ON 15
ci_0017                 1.423541e-02 3 1  ON 16
ci_0018                 1.405539e-02 3 1  ON 17
ci_0019                 1.258388e-02 3 1  ON 18
ci_0020                 1.185944e-02 3 1  ON 19
ci_0021                 6.905738e-03 3 1  ON 20
ci_0022                 7.158871e-03 3 1  ON 21
ci_0023                -1.184514e-02 3 1  ON 22
ci_0024                -1.120279e-02 3 1  ON 23
ci_0025                -1.121411e-02 3 1  ON 24
ci_0026                -1.121680e-02 3 1  ON 25
ci_0027                -1.141608e-02 3 1  ON 26
ci_0028                -1.145866e-02 3 1  ON 27
ci_0029                -1.086557e-02 3 1  ON 28
ci_0030                -1.049880e-02 3 1  ON 29
ci_0031                 1.941758e-02 3 1  ON 30
ci_0032                 1.934045e-02 3 1  ON 31
ci_0033                 9.743813e-03 3 1  ON 32
ci_0034                 1.064310e-02 3 1  ON 33
ci_0035                 6.625740e-03 3 1  ON 34
ci_0036                 4.426250e-03 3 1  ON 35
ci_0037                -1.147133e-02 3 1  ON 36
ci_0038                -1.067769e-02 3 1  ON 37
ci_0039                -4.225915e-03 3 1  ON 38
ci_0040                -4.038102e-03 3 1  ON 39
ci_0041                 8.592953e-03 3 1  ON 40
ci_0042                 8.387413e-03 3 1  ON 41
ci_0043                -1.323024e-02 3 1  ON 42
ci_0044                -1.355881e-02 3 1  ON 43
ci_0045                 8.145067e-03 3 1  ON 44
ci_0046                 7.906354e-03 3 1  ON 45
ci_0047                -3.628505e-03 3 1  ON 46
ci_0048                -3.172985e-03 3 1  ON 47
ci_0049                -6.782506e-03 3 1  ON 48
ci_0050                -5.924653e-03 3 1  ON 49
ci_0051                -4.459222e-03 3 1  ON 50
ci_0052                -4.596366e-03 3 1  ON 51
ci_0053                -6.299945e-03 3 1  ON 52
ci_0054                -5.938164e-03 3 1  ON 53
ci_0055                 6.416045e-03 3 1  ON 54
ci_0056                 6.766729e-03 3 1  ON 55
ci_0057                 5.652863e-03 3 1  ON 56
ci_0058                 4.680326e-03 3 1  ON 57
ci_0059                -5.819006e-03 3 1  ON 58
ci_0060                -5.904788e-03 3 1  ON 59
ci_0061                -3.686601e-03 3 1  ON 60
ci_0062                -4.028242e-03 3 1  ON 61
ci_0063                -9.201643e-03 3 1  ON 62
ci_0064                -8.557173e-03 3 1  ON 63
ci_0065                -6.654899e-03 3 1  ON 64
ci_0066                -6.874463e-03 3 1  ON 65
ci_0067                -6.044142e-03 3 1  ON 66
ci_0068                -6.239333e-03 3 1  ON 67
ci_0069                 5.309705e-03 3 1  ON 68
ci_0070                 5.442978e-03 3 1  ON 69
ci_0071                 4.215375e-03 3 1  ON 70
ci_0072                 5.161827e-03 3 1  ON 71
ci_0073                 5.149119e-03 3 1  ON 72
ci_0074                 5.507833e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.921
    reference variance = 0.300712
====================================================
  Execution time = 1.4285e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2994e-01
  Total weights = 1.9519e+06
  Execution time = 1.9051e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315233213275
                                         uncertainty =       0.002653087618

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315233213275
                                         uncertainty =       0.002653087618

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396979194
  error estimate for blocks of size 2^( 2) =       0.000411105854
  error estimate for blocks of size 2^( 3) =       0.000425906632
  error estimate for blocks of size 2^( 4) =       0.000439928227
  error estimate for blocks of size 2^( 5) =       0.000451334209
  error estimate for blocks of size 2^( 6) =       0.000460824944
  error estimate for blocks of size 2^( 7) =       0.000466431064

      target function =                  N/A
              le_mean =     -16.904282788433
             les_mean =     286.084711089565
             stat err =       0.000454629611
             autocorr =       1.311535184945
              std dev =       0.561413360238
             le_variance =       0.315184961054

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315233692407
                                         uncertainty =       0.002653101316

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315233692407
                                         uncertainty =       0.002653101316

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396979494
  error estimate for blocks of size 2^( 2) =       0.000411106124
  error estimate for blocks of size 2^( 3) =       0.000425906857
  error estimate for blocks of size 2^( 4) =       0.000439928398
  error estimate for blocks of size 2^( 5) =       0.000451334393
  error estimate for blocks of size 2^( 6) =       0.000460825146
  error estimate for blocks of size 2^( 7) =       0.000466431288

      target function =                  N/A
              le_mean =     -16.904282799786
             les_mean =     286.084715735987
             stat err =       0.000454629806
             autocorr =       1.311534327921
              std dev =       0.561413784881
             le_variance =       0.315185437855

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315233452920
                                         uncertainty =       0.002653094472

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315233452920
                                         uncertainty =       0.002653094472

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396979344
  error estimate for blocks of size 2^( 2) =       0.000411105989
  error estimate for blocks of size 2^( 3) =       0.000425906745
  error estimate for blocks of size 2^( 4) =       0.000439928312
  error estimate for blocks of size 2^( 5) =       0.000451334301
  error estimate for blocks of size 2^( 6) =       0.000460825045
  error estimate for blocks of size 2^( 7) =       0.000466431176

      target function =                  N/A
              le_mean =     -16.904282794108
             les_mean =     286.084713402884
             stat err =       0.000454629709
             autocorr =       1.311534756190
              std dev =       0.561413572630
             le_variance =       0.315185199533

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315233243229
                                         uncertainty =       0.002653088475

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315233243229
                                         uncertainty =       0.002653088475

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396979213
  error estimate for blocks of size 2^( 2) =       0.000411105871
  error estimate for blocks of size 2^( 3) =       0.000425906646
  error estimate for blocks of size 2^( 4) =       0.000439928237
  error estimate for blocks of size 2^( 5) =       0.000451334221
  error estimate for blocks of size 2^( 6) =       0.000460824956
  error estimate for blocks of size 2^( 7) =       0.000466431078

      target function =                  N/A
              le_mean =     -16.904282789142
             les_mean =     286.084711377555
             stat err =       0.000454629623
             autocorr =       1.311535131347
              std dev =       0.561413386786
             le_variance =       0.315184990862


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904282788433        initial
     3.8147e+02     3.8147e+03             1.2793e-06       -16.904282799786  <--
     1.5259e+03     1.5259e+04             3.1994e-07       -16.904282794108
     6.1035e+03     6.1035e+04             7.9993e-08       -16.904282789142

*****************************************************************************
Applying the update for shift_i =   3.8147e+02     and shift_s =   3.8147e+03
*****************************************************************************

  Execution time = 2.3853e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
ci_0001                 7.011124e-01 3 1  ON 0
ci_0002                 6.996414e-01 3 1  ON 1
ci_0003                -3.046602e-02 3 1  ON 2
ci_0004                -3.091068e-02 3 1  ON 3
ci_0005                -3.366157e-02 3 1  ON 4
ci_0006                -3.479294e-02 3 1  ON 5
ci_0007                -2.186679e-02 3 1  ON 6
ci_0008                -2.315567e-02 3 1  ON 7
ci_0009                -1.987050e-02 3 1  ON 8
ci_0010                -2.025488e-02 3 1  ON 9
ci_0011                -1.478813e-02 3 1  ON 10
ci_0012                -1.482304e-02 3 1  ON 11
ci_0013                 1.604591e-02 3 1  ON 12
ci_0014                 1.528635e-02 3 1  ON 13
ci_0015                 1.616073e-02 3 1  ON 14
ci_0016                 1.562241e-02 3 1  ON 15
ci_0017                 1.423522e-02 3 1  ON 16
ci_0018                 1.405542e-02 3 1  ON 17
ci_0019                 1.258357e-02 3 1  ON 18
ci_0020                 1.185950e-02 3 1  ON 19
ci_0021                 6.905831e-03 3 1  ON 20
ci_0022                 7.158988e-03 3 1  ON 21
ci_0023                -1.184481e-02 3 1  ON 22
ci_0024                -1.120312e-02 3 1  ON 23
ci_0025                -1.121428e-02 3 1  ON 24
ci_0026                -1.121703e-02 3 1  ON 25
ci_0027                -1.141637e-02 3 1  ON 26
ci_0028                -1.145863e-02 3 1  ON 27
ci_0029                -1.086541e-02 3 1  ON 28
ci_0030                -1.049907e-02 3 1  ON 29
ci_0031                 1.941727e-02 3 1  ON 30
ci_0032                 1.934090e-02 3 1  ON 31
ci_0033                 9.743891e-03 3 1  ON 32
ci_0034                 1.064394e-02 3 1  ON 33
ci_0035                 6.625511e-03 3 1  ON 34
ci_0036                 4.427209e-03 3 1  ON 35
ci_0037                -1.147131e-02 3 1  ON 36
ci_0038                -1.067718e-02 3 1  ON 37
ci_0039                -4.225999e-03 3 1  ON 38
ci_0040                -4.038229e-03 3 1  ON 39
ci_0041                 8.593244e-03 3 1  ON 40
ci_0042                 8.387555e-03 3 1  ON 41
ci_0043                -1.323001e-02 3 1  ON 42
ci_0044                -1.355895e-02 3 1  ON 43
ci_0045                 8.144807e-03 3 1  ON 44
ci_0046                 7.906684e-03 3 1  ON 45
ci_0047                -3.628608e-03 3 1  ON 46
ci_0048                -3.173576e-03 3 1  ON 47
ci_0049                -6.782543e-03 3 1  ON 48
ci_0050                -5.924831e-03 3 1  ON 49
ci_0051                -4.459481e-03 3 1  ON 50
ci_0052                -4.596256e-03 3 1  ON 51
ci_0053                -6.299859e-03 3 1  ON 52
ci_0054                -5.938516e-03 3 1  ON 53
ci_0055                 6.416425e-03 3 1  ON 54
ci_0056                 6.766892e-03 3 1  ON 55
ci_0057                 5.652492e-03 3 1  ON 56
ci_0058                 4.680538e-03 3 1  ON 57
ci_0059                -5.819386e-03 3 1  ON 58
ci_0060                -5.904970e-03 3 1  ON 59
ci_0061                -3.686488e-03 3 1  ON 60
ci_0062                -4.027907e-03 3 1  ON 61
ci_0063                -9.201898e-03 3 1  ON 62
ci_0064                -8.556675e-03 3 1  ON 63
ci_0065                -6.654820e-03 3 1  ON 64
ci_0066                -6.874384e-03 3 1  ON 65
ci_0067                -6.044152e-03 3 1  ON 66
ci_0068                -6.239400e-03 3 1  ON 67
ci_0069                 5.309774e-03 3 1  ON 68
ci_0070                 5.442767e-03 3 1  ON 69
ci_0071                 4.215410e-03 3 1  ON 70
ci_0072                 5.161401e-03 3 1  ON 71
ci_0073                 5.149480e-03 3 1  ON 72
ci_0074                 5.508175e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0802e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6889e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.8601
    reference variance = 0.676386
====================================================
  Execution time = 1.4459e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5241e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.1929e-01
  Total weights = 1.951595869e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5721e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309899831968
                                         uncertainty =       0.001895249243

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309899831968
                                         uncertainty =       0.001895249243

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393625883
  error estimate for blocks of size 2^( 2) =       0.000407655400
  error estimate for blocks of size 2^( 3) =       0.000422053659
  error estimate for blocks of size 2^( 4) =       0.000435799396
  error estimate for blocks of size 2^( 5) =       0.000446535956
  error estimate for blocks of size 2^( 6) =       0.000455100319
  error estimate for blocks of size 2^( 7) =       0.000459600871

      target function =                  N/A
              le_mean =     -16.905161732492
             les_mean =     286.103786885876
             stat err =       0.000449259135
             autocorr =       1.302646382224
              std dev =       0.556671062675
             le_variance =       0.309882672020


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690516173249e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905161732515       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905161758053       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905161756689       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905161756308       residual = 1.22e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.5367e+01 is 5.762196e-06

solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905161732515       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905161738910       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905161738567       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905161738470       residual = 1.23e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+02 is 1.443803e-06

solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905161732515       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905161734114       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905161734028       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905161734003       residual = 1.24e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+03 is 3.611547e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.168399 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7036e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
ci_0001                 7.011123e-01 3 1  ON 0
ci_0002                 6.996414e-01 3 1  ON 1
ci_0003                -3.046627e-02 3 1  ON 2
ci_0004                -3.091087e-02 3 1  ON 3
ci_0005                -3.366161e-02 3 1  ON 4
ci_0006                -3.479253e-02 3 1  ON 5
ci_0007                -2.186708e-02 3 1  ON 6
ci_0008                -2.315503e-02 3 1  ON 7
ci_0009                -1.987065e-02 3 1  ON 8
ci_0010                -2.025419e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482314e-02 3 1  ON 11
ci_0013                 1.604634e-02 3 1  ON 12
ci_0014                 1.528692e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562220e-02 3 1  ON 15
ci_0017                 1.423516e-02 3 1  ON 16
ci_0018                 1.405548e-02 3 1  ON 17
ci_0019                 1.258346e-02 3 1  ON 18
ci_0020                 1.185980e-02 3 1  ON 19
ci_0021                 6.905646e-03 3 1  ON 20
ci_0022                 7.159320e-03 3 1  ON 21
ci_0023                -1.184477e-02 3 1  ON 22
ci_0024                -1.120323e-02 3 1  ON 23
ci_0025                -1.121462e-02 3 1  ON 24
ci_0026                -1.121725e-02 3 1  ON 25
ci_0027                -1.141641e-02 3 1  ON 26
ci_0028                -1.145855e-02 3 1  ON 27
ci_0029                -1.086499e-02 3 1  ON 28
ci_0030                -1.049886e-02 3 1  ON 29
ci_0031                 1.941663e-02 3 1  ON 30
ci_0032                 1.934110e-02 3 1  ON 31
ci_0033                 9.744542e-03 3 1  ON 32
ci_0034                 1.064441e-02 3 1  ON 33
ci_0035                 6.625653e-03 3 1  ON 34
ci_0036                 4.428372e-03 3 1  ON 35
ci_0037                -1.147085e-02 3 1  ON 36
ci_0038                -1.067783e-02 3 1  ON 37
ci_0039                -4.226107e-03 3 1  ON 38
ci_0040                -4.038390e-03 3 1  ON 39
ci_0041                 8.593358e-03 3 1  ON 40
ci_0042                 8.387800e-03 3 1  ON 41
ci_0043                -1.323020e-02 3 1  ON 42
ci_0044                -1.355914e-02 3 1  ON 43
ci_0045                 8.144728e-03 3 1  ON 44
ci_0046                 7.906996e-03 3 1  ON 45
ci_0047                -3.628234e-03 3 1  ON 46
ci_0048                -3.173128e-03 3 1  ON 47
ci_0049                -6.782610e-03 3 1  ON 48
ci_0050                -5.925964e-03 3 1  ON 49
ci_0051                -4.459365e-03 3 1  ON 50
ci_0052                -4.596262e-03 3 1  ON 51
ci_0053                -6.299438e-03 3 1  ON 52
ci_0054                -5.938118e-03 3 1  ON 53
ci_0055                 6.416933e-03 3 1  ON 54
ci_0056                 6.767142e-03 3 1  ON 55
ci_0057                 5.651805e-03 3 1  ON 56
ci_0058                 4.680779e-03 3 1  ON 57
ci_0059                -5.819359e-03 3 1  ON 58
ci_0060                -5.904663e-03 3 1  ON 59
ci_0061                -3.686676e-03 3 1  ON 60
ci_0062                -4.027942e-03 3 1  ON 61
ci_0063                -9.203342e-03 3 1  ON 62
ci_0064                -8.556992e-03 3 1  ON 63
ci_0065                -6.654401e-03 3 1  ON 64
ci_0066                -6.873699e-03 3 1  ON 65
ci_0067                -6.044057e-03 3 1  ON 66
ci_0068                -6.239215e-03 3 1  ON 67
ci_0069                 5.309818e-03 3 1  ON 68
ci_0070                 5.442835e-03 3 1  ON 69
ci_0071                 4.215256e-03 3 1  ON 70
ci_0072                 5.161313e-03 3 1  ON 71
ci_0073                 5.149676e-03 3 1  ON 72
ci_0074                 5.507884e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.8135
    reference variance = 0.216048
====================================================
  Execution time = 1.3982e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2696e-01
  Total weights = 1.9517e+06
  Execution time = 1.9028e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311541740170
                                         uncertainty =       0.003336131572

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311541740170
                                         uncertainty =       0.003336131572

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394640546
  error estimate for blocks of size 2^( 2) =       0.000409114399
  error estimate for blocks of size 2^( 3) =       0.000423777048
  error estimate for blocks of size 2^( 4) =       0.000437009479
  error estimate for blocks of size 2^( 5) =       0.000448876588
  error estimate for blocks of size 2^( 6) =       0.000458799351
  error estimate for blocks of size 2^( 7) =       0.000465506522

      target function =                  N/A
              le_mean =     -16.904194720227
             les_mean =     286.078764736139
             stat err =       0.000452547985
             autocorr =       1.315000341845
              std dev =       0.558106011847
             le_variance =       0.311482320459

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311539789363
                                         uncertainty =       0.003334499224

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311539789363
                                         uncertainty =       0.003334499224

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394639315
  error estimate for blocks of size 2^( 2) =       0.000409113177
  error estimate for blocks of size 2^( 3) =       0.000423775808
  error estimate for blocks of size 2^( 4) =       0.000437008289
  error estimate for blocks of size 2^( 5) =       0.000448875336
  error estimate for blocks of size 2^( 6) =       0.000458798204
  error estimate for blocks of size 2^( 7) =       0.000465505433

      target function =                  N/A
              le_mean =     -16.904194662285
             les_mean =     286.078753274153
             stat err =       0.000452546816
             autocorr =       1.315001744780
              std dev =       0.558104271761
             le_variance =       0.311480378158

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311540761222
                                         uncertainty =       0.003335313368

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311540761222
                                         uncertainty =       0.003335313368

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394639928
  error estimate for blocks of size 2^( 2) =       0.000409113786
  error estimate for blocks of size 2^( 3) =       0.000423776426
  error estimate for blocks of size 2^( 4) =       0.000437008882
  error estimate for blocks of size 2^( 5) =       0.000448875960
  error estimate for blocks of size 2^( 6) =       0.000458798776
  error estimate for blocks of size 2^( 7) =       0.000465505976

      target function =                  N/A
              le_mean =     -16.904194691023
             les_mean =     286.078756840727
             stat err =       0.000452547399
             autocorr =       1.315001047085
              std dev =       0.558105138639
             le_variance =       0.311481345775

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311541617610
                                         uncertainty =       0.003336029215

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311541617610
                                         uncertainty =       0.003336029215

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394640468
  error estimate for blocks of size 2^( 2) =       0.000409114322
  error estimate for blocks of size 2^( 3) =       0.000423776970
  error estimate for blocks of size 2^( 4) =       0.000437009405
  error estimate for blocks of size 2^( 5) =       0.000448876509
  error estimate for blocks of size 2^( 6) =       0.000458799280
  error estimate for blocks of size 2^( 7) =       0.000465506454

      target function =                  N/A
              le_mean =     -16.904194716551
             les_mean =     286.078763354864
             stat err =       0.000452547912
             autocorr =       1.315000430295
              std dev =       0.558105902524
             le_variance =       0.311482198433


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904194720227        initial  <--
     9.5367e+01     9.5367e+02             5.7622e-06       -16.904194662285
     3.8147e+02     3.8147e+03             1.4438e-06       -16.904194691023
     1.5259e+03     1.5259e+04             3.6115e-07       -16.904194716551

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.5539
  </log>
  <optVariables href="H2O.s017.opt.xml">
ci_0001                 7.011124e-01 3 1  ON 0
ci_0002                 6.996414e-01 3 1  ON 1
ci_0003                -3.046602e-02 3 1  ON 2
ci_0004                -3.091068e-02 3 1  ON 3
ci_0005                -3.366157e-02 3 1  ON 4
ci_0006                -3.479294e-02 3 1  ON 5
ci_0007                -2.186679e-02 3 1  ON 6
ci_0008                -2.315567e-02 3 1  ON 7
ci_0009                -1.987050e-02 3 1  ON 8
ci_0010                -2.025488e-02 3 1  ON 9
ci_0011                -1.478813e-02 3 1  ON 10
ci_0012                -1.482304e-02 3 1  ON 11
ci_0013                 1.604591e-02 3 1  ON 12
ci_0014                 1.528635e-02 3 1  ON 13
ci_0015                 1.616073e-02 3 1  ON 14
ci_0016                 1.562241e-02 3 1  ON 15
ci_0017                 1.423522e-02 3 1  ON 16
ci_0018                 1.405542e-02 3 1  ON 17
ci_0019                 1.258357e-02 3 1  ON 18
ci_0020                 1.185950e-02 3 1  ON 19
ci_0021                 6.905831e-03 3 1  ON 20
ci_0022                 7.158988e-03 3 1  ON 21
ci_0023                -1.184481e-02 3 1  ON 22
ci_0024                -1.120312e-02 3 1  ON 23
ci_0025                -1.121428e-02 3 1  ON 24
ci_0026                -1.121703e-02 3 1  ON 25
ci_0027                -1.141637e-02 3 1  ON 26
ci_0028                -1.145863e-02 3 1  ON 27
ci_0029                -1.086541e-02 3 1  ON 28
ci_0030                -1.049907e-02 3 1  ON 29
ci_0031                 1.941727e-02 3 1  ON 30
ci_0032                 1.934090e-02 3 1  ON 31
ci_0033                 9.743891e-03 3 1  ON 32
ci_0034                 1.064394e-02 3 1  ON 33
ci_0035                 6.625511e-03 3 1  ON 34
ci_0036                 4.427209e-03 3 1  ON 35
ci_0037                -1.147131e-02 3 1  ON 36
ci_0038                -1.067718e-02 3 1  ON 37
ci_0039                -4.225999e-03 3 1  ON 38
ci_0040                -4.038229e-03 3 1  ON 39
ci_0041                 8.593244e-03 3 1  ON 40
ci_0042                 8.387555e-03 3 1  ON 41
ci_0043                -1.323001e-02 3 1  ON 42
ci_0044                -1.355895e-02 3 1  ON 43
ci_0045                 8.144807e-03 3 1  ON 44
ci_0046                 7.906684e-03 3 1  ON 45
ci_0047                -3.628608e-03 3 1  ON 46
ci_0048                -3.173576e-03 3 1  ON 47
ci_0049                -6.782543e-03 3 1  ON 48
ci_0050                -5.924831e-03 3 1  ON 49
ci_0051                -4.459481e-03 3 1  ON 50
ci_0052                -4.596256e-03 3 1  ON 51
ci_0053                -6.299859e-03 3 1  ON 52
ci_0054                -5.938516e-03 3 1  ON 53
ci_0055                 6.416425e-03 3 1  ON 54
ci_0056                 6.766892e-03 3 1  ON 55
ci_0057                 5.652492e-03 3 1  ON 56
ci_0058                 4.680538e-03 3 1  ON 57
ci_0059                -5.819386e-03 3 1  ON 58
ci_0060                -5.904970e-03 3 1  ON 59
ci_0061                -3.686488e-03 3 1  ON 60
ci_0062                -4.027907e-03 3 1  ON 61
ci_0063                -9.201898e-03 3 1  ON 62
ci_0064                -8.556675e-03 3 1  ON 63
ci_0065                -6.654820e-03 3 1  ON 64
ci_0066                -6.874384e-03 3 1  ON 65
ci_0067                -6.044152e-03 3 1  ON 66
ci_0068                -6.239400e-03 3 1  ON 67
ci_0069                 5.309774e-03 3 1  ON 68
ci_0070                 5.442767e-03 3 1  ON 69
ci_0071                 4.215410e-03 3 1  ON 70
ci_0072                 5.161401e-03 3 1  ON 71
ci_0073                 5.149480e-03 3 1  ON 72
ci_0074                 5.508175e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0595e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6886e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.8867
    reference variance = 0.780481
====================================================
  Execution time = 1.6478e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5257e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.1888e-01
  Total weights = 1.951889351e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5677e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308535766924
                                         uncertainty =       0.001941640283

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308535766924
                                         uncertainty =       0.001941640283

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392811906
  error estimate for blocks of size 2^( 2) =       0.000407111100
  error estimate for blocks of size 2^( 3) =       0.000421229010
  error estimate for blocks of size 2^( 4) =       0.000434111948
  error estimate for blocks of size 2^( 5) =       0.000444778413
  error estimate for blocks of size 2^( 6) =       0.000452061984
  error estimate for blocks of size 2^( 7) =       0.000454911574

      target function =                  N/A
              le_mean =     -16.904854517109
             les_mean =     286.092989038732
             stat err =       0.000446465980
             autocorr =       1.291836226126
              std dev =       0.555519924310
             le_variance =       0.308602386306


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690485451711e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904854517136       residual = 2.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904854521721       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904854521691       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904854521777       residual = 1.65e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.5367e+02 is 7.403875e-07

solving harmonic davidson linear method for identity shift 3.8147e+03, overlap shift 3.8147e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904854517136       residual = 2.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904854518283       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904854518275       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904854518297       residual = 1.65e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+03 is 1.851256e-07

solving harmonic davidson linear method for identity shift 1.5259e+04, overlap shift 1.5259e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904854517136       residual = 2.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904854517423       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904854517421       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904854517426       residual = 1.65e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+04 is 4.628319e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.169737 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.9051e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
ci_0001                 7.011124e-01 3 1  ON 0
ci_0002                 6.996414e-01 3 1  ON 1
ci_0003                -3.046601e-02 3 1  ON 2
ci_0004                -3.091071e-02 3 1  ON 3
ci_0005                -3.366158e-02 3 1  ON 4
ci_0006                -3.479291e-02 3 1  ON 5
ci_0007                -2.186676e-02 3 1  ON 6
ci_0008                -2.315566e-02 3 1  ON 7
ci_0009                -1.987057e-02 3 1  ON 8
ci_0010                -2.025486e-02 3 1  ON 9
ci_0011                -1.478813e-02 3 1  ON 10
ci_0012                -1.482310e-02 3 1  ON 11
ci_0013                 1.604587e-02 3 1  ON 12
ci_0014                 1.528632e-02 3 1  ON 13
ci_0015                 1.616071e-02 3 1  ON 14
ci_0016                 1.562241e-02 3 1  ON 15
ci_0017                 1.423526e-02 3 1  ON 16
ci_0018                 1.405535e-02 3 1  ON 17
ci_0019                 1.258347e-02 3 1  ON 18
ci_0020                 1.185942e-02 3 1  ON 19
ci_0021                 6.905837e-03 3 1  ON 20
ci_0022                 7.159024e-03 3 1  ON 21
ci_0023                -1.184476e-02 3 1  ON 22
ci_0024                -1.120316e-02 3 1  ON 23
ci_0025                -1.121433e-02 3 1  ON 24
ci_0026                -1.121710e-02 3 1  ON 25
ci_0027                -1.141636e-02 3 1  ON 26
ci_0028                -1.145860e-02 3 1  ON 27
ci_0029                -1.086544e-02 3 1  ON 28
ci_0030                -1.049900e-02 3 1  ON 29
ci_0031                 1.941724e-02 3 1  ON 30
ci_0032                 1.934086e-02 3 1  ON 31
ci_0033                 9.743915e-03 3 1  ON 32
ci_0034                 1.064394e-02 3 1  ON 33
ci_0035                 6.625602e-03 3 1  ON 34
ci_0036                 4.427394e-03 3 1  ON 35
ci_0037                -1.147128e-02 3 1  ON 36
ci_0038                -1.067723e-02 3 1  ON 37
ci_0039                -4.225937e-03 3 1  ON 38
ci_0040                -4.038189e-03 3 1  ON 39
ci_0041                 8.593231e-03 3 1  ON 40
ci_0042                 8.387584e-03 3 1  ON 41
ci_0043                -1.323002e-02 3 1  ON 42
ci_0044                -1.355899e-02 3 1  ON 43
ci_0045                 8.144817e-03 3 1  ON 44
ci_0046                 7.906720e-03 3 1  ON 45
ci_0047                -3.628591e-03 3 1  ON 46
ci_0048                -3.173611e-03 3 1  ON 47
ci_0049                -6.782511e-03 3 1  ON 48
ci_0050                -5.924851e-03 3 1  ON 49
ci_0051                -4.459497e-03 3 1  ON 50
ci_0052                -4.596291e-03 3 1  ON 51
ci_0053                -6.299900e-03 3 1  ON 52
ci_0054                -5.938461e-03 3 1  ON 53
ci_0055                 6.416442e-03 3 1  ON 54
ci_0056                 6.766984e-03 3 1  ON 55
ci_0057                 5.652506e-03 3 1  ON 56
ci_0058                 4.680598e-03 3 1  ON 57
ci_0059                -5.819409e-03 3 1  ON 58
ci_0060                -5.905019e-03 3 1  ON 59
ci_0061                -3.686506e-03 3 1  ON 60
ci_0062                -4.027861e-03 3 1  ON 61
ci_0063                -9.201942e-03 3 1  ON 62
ci_0064                -8.556715e-03 3 1  ON 63
ci_0065                -6.654869e-03 3 1  ON 64
ci_0066                -6.874412e-03 3 1  ON 65
ci_0067                -6.044156e-03 3 1  ON 66
ci_0068                -6.239404e-03 3 1  ON 67
ci_0069                 5.309763e-03 3 1  ON 68
ci_0070                 5.442735e-03 3 1  ON 69
ci_0071                 4.215409e-03 3 1  ON 70
ci_0072                 5.161382e-03 3 1  ON 71
ci_0073                 5.149453e-03 3 1  ON 72
ci_0074                 5.508170e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.89
    reference variance = 0.217488
====================================================
  Execution time = 1.4212e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2407e-01
  Total weights = 1.9516e+06
  Execution time = 1.8948e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308158778201
                                         uncertainty =       0.001862975044

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308158778201
                                         uncertainty =       0.001862975044

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392495904
  error estimate for blocks of size 2^( 2) =       0.000406597241
  error estimate for blocks of size 2^( 3) =       0.000420838170
  error estimate for blocks of size 2^( 4) =       0.000433090769
  error estimate for blocks of size 2^( 5) =       0.000443427143
  error estimate for blocks of size 2^( 6) =       0.000450625179
  error estimate for blocks of size 2^( 7) =       0.000458161611

      target function =                  N/A
              le_mean =     -16.904472115207
             les_mean =     286.085250182061
             stat err =       0.000446326176
             autocorr =       1.293106985224
              std dev =       0.555073030426
             le_variance =       0.308106069106

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308159063151
                                         uncertainty =       0.001862983706

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308159063151
                                         uncertainty =       0.001862983706

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392496086
  error estimate for blocks of size 2^( 2) =       0.000406597415
  error estimate for blocks of size 2^( 3) =       0.000420838340
  error estimate for blocks of size 2^( 4) =       0.000433090936
  error estimate for blocks of size 2^( 5) =       0.000443427296
  error estimate for blocks of size 2^( 6) =       0.000450625339
  error estimate for blocks of size 2^( 7) =       0.000458161786

      target function =                  N/A
              le_mean =     -16.904472114327
             les_mean =     286.085251930324
             stat err =       0.000446326339
             autocorr =       1.293106736039
              std dev =       0.555073287501
             le_variance =       0.308106354497

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308158920689
                                         uncertainty =       0.001862979375

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308158920689
                                         uncertainty =       0.001862979375

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392495995
  error estimate for blocks of size 2^( 2) =       0.000406597328
  error estimate for blocks of size 2^( 3) =       0.000420838255
  error estimate for blocks of size 2^( 4) =       0.000433090853
  error estimate for blocks of size 2^( 5) =       0.000443427220
  error estimate for blocks of size 2^( 6) =       0.000450625259
  error estimate for blocks of size 2^( 7) =       0.000458161699

      target function =                  N/A
              le_mean =     -16.904472114766
             les_mean =     286.085251056017
             stat err =       0.000446326258
             autocorr =       1.293106860614
              std dev =       0.555073158975
             le_variance =       0.308106211815

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308158796012
                                         uncertainty =       0.001862975585

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308158796012
                                         uncertainty =       0.001862975585

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392495915
  error estimate for blocks of size 2^( 2) =       0.000406597252
  error estimate for blocks of size 2^( 3) =       0.000420838181
  error estimate for blocks of size 2^( 4) =       0.000433090780
  error estimate for blocks of size 2^( 5) =       0.000443427153
  error estimate for blocks of size 2^( 6) =       0.000450625189
  error estimate for blocks of size 2^( 7) =       0.000458161622

      target function =                  N/A
              le_mean =     -16.904472115152
             les_mean =     286.085250291274
             stat err =       0.000446326186
             autocorr =       1.293106969649
              std dev =       0.555073046494
             le_variance =       0.308106086944


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904472115207        initial  <--
     9.5367e+02     9.5367e+03             7.4039e-07       -16.904472114327
     3.8147e+03     3.8147e+04             1.8513e-07       -16.904472114766
     1.5259e+04     1.5259e+05             4.6283e-08       -16.904472115152

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.8147
  </log>
  <optVariables href="H2O.s018.opt.xml">
ci_0001                 7.011124e-01 3 1  ON 0
ci_0002                 6.996414e-01 3 1  ON 1
ci_0003                -3.046602e-02 3 1  ON 2
ci_0004                -3.091068e-02 3 1  ON 3
ci_0005                -3.366157e-02 3 1  ON 4
ci_0006                -3.479294e-02 3 1  ON 5
ci_0007                -2.186679e-02 3 1  ON 6
ci_0008                -2.315567e-02 3 1  ON 7
ci_0009                -1.987050e-02 3 1  ON 8
ci_0010                -2.025488e-02 3 1  ON 9
ci_0011                -1.478813e-02 3 1  ON 10
ci_0012                -1.482304e-02 3 1  ON 11
ci_0013                 1.604591e-02 3 1  ON 12
ci_0014                 1.528635e-02 3 1  ON 13
ci_0015                 1.616073e-02 3 1  ON 14
ci_0016                 1.562241e-02 3 1  ON 15
ci_0017                 1.423522e-02 3 1  ON 16
ci_0018                 1.405542e-02 3 1  ON 17
ci_0019                 1.258357e-02 3 1  ON 18
ci_0020                 1.185950e-02 3 1  ON 19
ci_0021                 6.905831e-03 3 1  ON 20
ci_0022                 7.158988e-03 3 1  ON 21
ci_0023                -1.184481e-02 3 1  ON 22
ci_0024                -1.120312e-02 3 1  ON 23
ci_0025                -1.121428e-02 3 1  ON 24
ci_0026                -1.121703e-02 3 1  ON 25
ci_0027                -1.141637e-02 3 1  ON 26
ci_0028                -1.145863e-02 3 1  ON 27
ci_0029                -1.086541e-02 3 1  ON 28
ci_0030                -1.049907e-02 3 1  ON 29
ci_0031                 1.941727e-02 3 1  ON 30
ci_0032                 1.934090e-02 3 1  ON 31
ci_0033                 9.743891e-03 3 1  ON 32
ci_0034                 1.064394e-02 3 1  ON 33
ci_0035                 6.625511e-03 3 1  ON 34
ci_0036                 4.427209e-03 3 1  ON 35
ci_0037                -1.147131e-02 3 1  ON 36
ci_0038                -1.067718e-02 3 1  ON 37
ci_0039                -4.225999e-03 3 1  ON 38
ci_0040                -4.038229e-03 3 1  ON 39
ci_0041                 8.593244e-03 3 1  ON 40
ci_0042                 8.387555e-03 3 1  ON 41
ci_0043                -1.323001e-02 3 1  ON 42
ci_0044                -1.355895e-02 3 1  ON 43
ci_0045                 8.144807e-03 3 1  ON 44
ci_0046                 7.906684e-03 3 1  ON 45
ci_0047                -3.628608e-03 3 1  ON 46
ci_0048                -3.173576e-03 3 1  ON 47
ci_0049                -6.782543e-03 3 1  ON 48
ci_0050                -5.924831e-03 3 1  ON 49
ci_0051                -4.459481e-03 3 1  ON 50
ci_0052                -4.596256e-03 3 1  ON 51
ci_0053                -6.299859e-03 3 1  ON 52
ci_0054                -5.938516e-03 3 1  ON 53
ci_0055                 6.416425e-03 3 1  ON 54
ci_0056                 6.766892e-03 3 1  ON 55
ci_0057                 5.652492e-03 3 1  ON 56
ci_0058                 4.680538e-03 3 1  ON 57
ci_0059                -5.819386e-03 3 1  ON 58
ci_0060                -5.904970e-03 3 1  ON 59
ci_0061                -3.686488e-03 3 1  ON 60
ci_0062                -4.027907e-03 3 1  ON 61
ci_0063                -9.201898e-03 3 1  ON 62
ci_0064                -8.556675e-03 3 1  ON 63
ci_0065                -6.654820e-03 3 1  ON 64
ci_0066                -6.874384e-03 3 1  ON 65
ci_0067                -6.044152e-03 3 1  ON 66
ci_0068                -6.239400e-03 3 1  ON 67
ci_0069                 5.309774e-03 3 1  ON 68
ci_0070                 5.442767e-03 3 1  ON 69
ci_0071                 4.215410e-03 3 1  ON 70
ci_0072                 5.161401e-03 3 1  ON 71
ci_0073                 5.149480e-03 3 1  ON 72
ci_0074                 5.508175e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2871e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6886e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.9786
    reference variance = 0.251704
====================================================
  Execution time = 1.4729e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5240e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2734e-01
  Total weights = 1.951453258e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5710e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315470359967
                                         uncertainty =       0.004504124726

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315470359967
                                         uncertainty =       0.004504124726

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397143077
  error estimate for blocks of size 2^( 2) =       0.000411197945
  error estimate for blocks of size 2^( 3) =       0.000425642324
  error estimate for blocks of size 2^( 4) =       0.000438433340
  error estimate for blocks of size 2^( 5) =       0.000448941951
  error estimate for blocks of size 2^( 6) =       0.000457153033
  error estimate for blocks of size 2^( 7) =       0.000462508697

      target function =                  N/A
              le_mean =     -16.904315934972
             les_mean =     286.083232681276
             stat err =       0.000451759255
             autocorr =       1.293957837632
              std dev =       0.561645125314
             le_variance =       0.315445246789


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690431593497e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904315935005       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904315935600       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904315935668       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904315935668       residual = 2.00e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.5367e+03 is 4.734627e-08

solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904315935005       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904315935154       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904315935171       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904315935171       residual = 2.00e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+04 is 1.183675e-08

solving harmonic davidson linear method for identity shift 1.5259e+05, overlap shift 1.5259e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904315935005       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904315935042       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904315935047       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904315935036       residual = 2.00e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+05 is 2.959198e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.170994 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7306e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
ci_0001                 7.011124e-01 3 1  ON 0
ci_0002                 6.996414e-01 3 1  ON 1
ci_0003                -3.046602e-02 3 1  ON 2
ci_0004                -3.091068e-02 3 1  ON 3
ci_0005                -3.366157e-02 3 1  ON 4
ci_0006                -3.479294e-02 3 1  ON 5
ci_0007                -2.186680e-02 3 1  ON 6
ci_0008                -2.315567e-02 3 1  ON 7
ci_0009                -1.987050e-02 3 1  ON 8
ci_0010                -2.025487e-02 3 1  ON 9
ci_0011                -1.478813e-02 3 1  ON 10
ci_0012                -1.482304e-02 3 1  ON 11
ci_0013                 1.604591e-02 3 1  ON 12
ci_0014                 1.528635e-02 3 1  ON 13
ci_0015                 1.616072e-02 3 1  ON 14
ci_0016                 1.562242e-02 3 1  ON 15
ci_0017                 1.423522e-02 3 1  ON 16
ci_0018                 1.405542e-02 3 1  ON 17
ci_0019                 1.258357e-02 3 1  ON 18
ci_0020                 1.185950e-02 3 1  ON 19
ci_0021                 6.905835e-03 3 1  ON 20
ci_0022                 7.158987e-03 3 1  ON 21
ci_0023                -1.184481e-02 3 1  ON 22
ci_0024                -1.120312e-02 3 1  ON 23
ci_0025                -1.121428e-02 3 1  ON 24
ci_0026                -1.121703e-02 3 1  ON 25
ci_0027                -1.141637e-02 3 1  ON 26
ci_0028                -1.145862e-02 3 1  ON 27
ci_0029                -1.086540e-02 3 1  ON 28
ci_0030                -1.049908e-02 3 1  ON 29
ci_0031                 1.941727e-02 3 1  ON 30
ci_0032                 1.934090e-02 3 1  ON 31
ci_0033                 9.743896e-03 3 1  ON 32
ci_0034                 1.064394e-02 3 1  ON 33
ci_0035                 6.625510e-03 3 1  ON 34
ci_0036                 4.427221e-03 3 1  ON 35
ci_0037                -1.147132e-02 3 1  ON 36
ci_0038                -1.067718e-02 3 1  ON 37
ci_0039                -4.225994e-03 3 1  ON 38
ci_0040                -4.038230e-03 3 1  ON 39
ci_0041                 8.593243e-03 3 1  ON 40
ci_0042                 8.387553e-03 3 1  ON 41
ci_0043                -1.323001e-02 3 1  ON 42
ci_0044                -1.355895e-02 3 1  ON 43
ci_0045                 8.144812e-03 3 1  ON 44
ci_0046                 7.906686e-03 3 1  ON 45
ci_0047                -3.628608e-03 3 1  ON 46
ci_0048                -3.173581e-03 3 1  ON 47
ci_0049                -6.782539e-03 3 1  ON 48
ci_0050                -5.924835e-03 3 1  ON 49
ci_0051                -4.459481e-03 3 1  ON 50
ci_0052                -4.596256e-03 3 1  ON 51
ci_0053                -6.299858e-03 3 1  ON 52
ci_0054                -5.938512e-03 3 1  ON 53
ci_0055                 6.416429e-03 3 1  ON 54
ci_0056                 6.766896e-03 3 1  ON 55
ci_0057                 5.652490e-03 3 1  ON 56
ci_0058                 4.680538e-03 3 1  ON 57
ci_0059                -5.819386e-03 3 1  ON 58
ci_0060                -5.904969e-03 3 1  ON 59
ci_0061                -3.686490e-03 3 1  ON 60
ci_0062                -4.027905e-03 3 1  ON 61
ci_0063                -9.201894e-03 3 1  ON 62
ci_0064                -8.556676e-03 3 1  ON 63
ci_0065                -6.654820e-03 3 1  ON 64
ci_0066                -6.874380e-03 3 1  ON 65
ci_0067                -6.044151e-03 3 1  ON 66
ci_0068                -6.239405e-03 3 1  ON 67
ci_0069                 5.309777e-03 3 1  ON 68
ci_0070                 5.442766e-03 3 1  ON 69
ci_0071                 4.215412e-03 3 1  ON 70
ci_0072                 5.161393e-03 3 1  ON 71
ci_0073                 5.149479e-03 3 1  ON 72
ci_0074                 5.508171e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.8438
    reference variance = 0.294975
====================================================
  Execution time = 1.4390e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2065e-01
  Total weights = 1.9517e+06
  Execution time = 1.8898e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310741937851
                                         uncertainty =       0.002002232649

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310741937851
                                         uncertainty =       0.002002232649

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394114064
  error estimate for blocks of size 2^( 2) =       0.000407992931
  error estimate for blocks of size 2^( 3) =       0.000422614646
  error estimate for blocks of size 2^( 4) =       0.000435467125
  error estimate for blocks of size 2^( 5) =       0.000448060201
  error estimate for blocks of size 2^( 6) =       0.000456264619
  error estimate for blocks of size 2^( 7) =       0.000462213750

      target function =                  N/A
              le_mean =     -16.904387655627
             les_mean =     286.078976712961
             stat err =       0.000450501424
             autocorr =       1.306617494584
              std dev =       0.557361455118
             le_variance =       0.310651791651

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310741941240
                                         uncertainty =       0.002002233556

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310741941240
                                         uncertainty =       0.002002233556

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394114067
  error estimate for blocks of size 2^( 2) =       0.000407992933
  error estimate for blocks of size 2^( 3) =       0.000422614648
  error estimate for blocks of size 2^( 4) =       0.000435467128
  error estimate for blocks of size 2^( 5) =       0.000448060205
  error estimate for blocks of size 2^( 6) =       0.000456264621
  error estimate for blocks of size 2^( 7) =       0.000462213756

      target function =                  N/A
              le_mean =     -16.904387655693
             les_mean =     286.078976910834
             stat err =       0.000450501428
             autocorr =       1.306617502297
              std dev =       0.557361458163
             le_variance =       0.310651795046

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310741939545
                                         uncertainty =       0.002002233102

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310741939545
                                         uncertainty =       0.002002233102

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394114066
  error estimate for blocks of size 2^( 2) =       0.000407992932
  error estimate for blocks of size 2^( 3) =       0.000422614647
  error estimate for blocks of size 2^( 4) =       0.000435467126
  error estimate for blocks of size 2^( 5) =       0.000448060203
  error estimate for blocks of size 2^( 6) =       0.000456264620
  error estimate for blocks of size 2^( 7) =       0.000462213753

      target function =                  N/A
              le_mean =     -16.904387655660
             les_mean =     286.078976811650
             stat err =       0.000450501426
             autocorr =       1.306617498439
              std dev =       0.557361456640
             le_variance =       0.310651793348

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310741938063
                                         uncertainty =       0.002002232705

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310741938063
                                         uncertainty =       0.002002232705

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394114065
  error estimate for blocks of size 2^( 2) =       0.000407992931
  error estimate for blocks of size 2^( 3) =       0.000422614646
  error estimate for blocks of size 2^( 4) =       0.000435467125
  error estimate for blocks of size 2^( 5) =       0.000448060202
  error estimate for blocks of size 2^( 6) =       0.000456264619
  error estimate for blocks of size 2^( 7) =       0.000462213751

      target function =                  N/A
              le_mean =     -16.904387655631
             les_mean =     286.078976725270
             stat err =       0.000450501424
             autocorr =       1.306617495060
              std dev =       0.557361455308
             le_variance =       0.310651791863


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904387655627        initial
     9.5367e+03     9.5367e+04             4.7346e-08       -16.904387655693  <--
     3.8147e+04     3.8147e+05             1.1837e-08       -16.904387655660
     1.5259e+05     1.5259e+06             2.9592e-09       -16.904387655631

*****************************************************************************
Applying the update for shift_i =   9.5367e+03     and shift_s =   9.5367e+04
*****************************************************************************

  Execution time = 2.3929e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
ci_0001                 7.011124e-01 3 1  ON 0
ci_0002                 6.996414e-01 3 1  ON 1
ci_0003                -3.046603e-02 3 1  ON 2
ci_0004                -3.091069e-02 3 1  ON 3
ci_0005                -3.366157e-02 3 1  ON 4
ci_0006                -3.479294e-02 3 1  ON 5
ci_0007                -2.186681e-02 3 1  ON 6
ci_0008                -2.315567e-02 3 1  ON 7
ci_0009                -1.987048e-02 3 1  ON 8
ci_0010                -2.025486e-02 3 1  ON 9
ci_0011                -1.478814e-02 3 1  ON 10
ci_0012                -1.482304e-02 3 1  ON 11
ci_0013                 1.604591e-02 3 1  ON 12
ci_0014                 1.528636e-02 3 1  ON 13
ci_0015                 1.616072e-02 3 1  ON 14
ci_0016                 1.562242e-02 3 1  ON 15
ci_0017                 1.423519e-02 3 1  ON 16
ci_0018                 1.405543e-02 3 1  ON 17
ci_0019                 1.258355e-02 3 1  ON 18
ci_0020                 1.185950e-02 3 1  ON 19
ci_0021                 6.905845e-03 3 1  ON 20
ci_0022                 7.158982e-03 3 1  ON 21
ci_0023                -1.184480e-02 3 1  ON 22
ci_0024                -1.120312e-02 3 1  ON 23
ci_0025                -1.121427e-02 3 1  ON 24
ci_0026                -1.121704e-02 3 1  ON 25
ci_0027                -1.141639e-02 3 1  ON 26
ci_0028                -1.145861e-02 3 1  ON 27
ci_0029                -1.086540e-02 3 1  ON 28
ci_0030                -1.049910e-02 3 1  ON 29
ci_0031                 1.941727e-02 3 1  ON 30
ci_0032                 1.934089e-02 3 1  ON 31
ci_0033                 9.743910e-03 3 1  ON 32
ci_0034                 1.064392e-02 3 1  ON 33
ci_0035                 6.625507e-03 3 1  ON 34
ci_0036                 4.427256e-03 3 1  ON 35
ci_0037                -1.147133e-02 3 1  ON 36
ci_0038                -1.067718e-02 3 1  ON 37
ci_0039                -4.225980e-03 3 1  ON 38
ci_0040                -4.038234e-03 3 1  ON 39
ci_0041                 8.593240e-03 3 1  ON 40
ci_0042                 8.387548e-03 3 1  ON 41
ci_0043                -1.323002e-02 3 1  ON 42
ci_0044                -1.355896e-02 3 1  ON 43
ci_0045                 8.144827e-03 3 1  ON 44
ci_0046                 7.906690e-03 3 1  ON 45
ci_0047                -3.628607e-03 3 1  ON 46
ci_0048                -3.173596e-03 3 1  ON 47
ci_0049                -6.782526e-03 3 1  ON 48
ci_0050                -5.924847e-03 3 1  ON 49
ci_0051                -4.459483e-03 3 1  ON 50
ci_0052                -4.596254e-03 3 1  ON 51
ci_0053                -6.299853e-03 3 1  ON 52
ci_0054                -5.938501e-03 3 1  ON 53
ci_0055                 6.416441e-03 3 1  ON 54
ci_0056                 6.766908e-03 3 1  ON 55
ci_0057                 5.652482e-03 3 1  ON 56
ci_0058                 4.680541e-03 3 1  ON 57
ci_0059                -5.819383e-03 3 1  ON 58
ci_0060                -5.904968e-03 3 1  ON 59
ci_0061                -3.686495e-03 3 1  ON 60
ci_0062                -4.027900e-03 3 1  ON 61
ci_0063                -9.201883e-03 3 1  ON 62
ci_0064                -8.556680e-03 3 1  ON 63
ci_0065                -6.654818e-03 3 1  ON 64
ci_0066                -6.874369e-03 3 1  ON 65
ci_0067                -6.044146e-03 3 1  ON 66
ci_0068                -6.239418e-03 3 1  ON 67
ci_0069                 5.309789e-03 3 1  ON 68
ci_0070                 5.442765e-03 3 1  ON 69
ci_0071                 4.215417e-03 3 1  ON 70
ci_0072                 5.161366e-03 3 1  ON 71
ci_0073                 5.149477e-03 3 1  ON 72
ci_0074                 5.508158e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1240e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6888e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.9261
    reference variance = 0.214771
====================================================
  Execution time = 1.4423e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5228e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2711e-01
  Total weights = 1.951675279e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5582e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314538349216
                                         uncertainty =       0.002518635631

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314538349216
                                         uncertainty =       0.002518635631

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396640007
  error estimate for blocks of size 2^( 2) =       0.000410817672
  error estimate for blocks of size 2^( 3) =       0.000425406914
  error estimate for blocks of size 2^( 4) =       0.000438625584
  error estimate for blocks of size 2^( 5) =       0.000450453114
  error estimate for blocks of size 2^( 6) =       0.000458746065
  error estimate for blocks of size 2^( 7) =       0.000467619490

      target function =                  N/A
              le_mean =     -16.903995237783
             les_mean =     286.072163782473
             stat err =       0.000453861063
             autocorr =       1.309341153123
              std dev =       0.560933677410
             le_variance =       0.314646590452


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690399523778e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+03, overlap shift 2.3842e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903995237781       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903995241753       residual = 7.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.903995241867       residual = 8.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3842e+03 is 1.525284e-07

solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903995237781       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903995238774       residual = 7.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.903995238803       residual = 8.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.5367e+03 is 3.813397e-08

solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903995237781       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903995238029       residual = 7.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.903995238036       residual = 8.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+04 is 9.533608e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.172027 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6986e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
ci_0001                 7.011124e-01 3 1  ON 0
ci_0002                 6.996414e-01 3 1  ON 1
ci_0003                -3.046604e-02 3 1  ON 2
ci_0004                -3.091070e-02 3 1  ON 3
ci_0005                -3.366157e-02 3 1  ON 4
ci_0006                -3.479294e-02 3 1  ON 5
ci_0007                -2.186683e-02 3 1  ON 6
ci_0008                -2.315566e-02 3 1  ON 7
ci_0009                -1.987047e-02 3 1  ON 8
ci_0010                -2.025486e-02 3 1  ON 9
ci_0011                -1.478814e-02 3 1  ON 10
ci_0012                -1.482304e-02 3 1  ON 11
ci_0013                 1.604591e-02 3 1  ON 12
ci_0014                 1.528638e-02 3 1  ON 13
ci_0015                 1.616071e-02 3 1  ON 14
ci_0016                 1.562241e-02 3 1  ON 15
ci_0017                 1.423520e-02 3 1  ON 16
ci_0018                 1.405541e-02 3 1  ON 17
ci_0019                 1.258354e-02 3 1  ON 18
ci_0020                 1.185950e-02 3 1  ON 19
ci_0021                 6.905847e-03 3 1  ON 20
ci_0022                 7.158970e-03 3 1  ON 21
ci_0023                -1.184479e-02 3 1  ON 22
ci_0024                -1.120313e-02 3 1  ON 23
ci_0025                -1.121430e-02 3 1  ON 24
ci_0026                -1.121707e-02 3 1  ON 25
ci_0027                -1.141640e-02 3 1  ON 26
ci_0028                -1.145861e-02 3 1  ON 27
ci_0029                -1.086542e-02 3 1  ON 28
ci_0030                -1.049910e-02 3 1  ON 29
ci_0031                 1.941728e-02 3 1  ON 30
ci_0032                 1.934089e-02 3 1  ON 31
ci_0033                 9.743931e-03 3 1  ON 32
ci_0034                 1.064392e-02 3 1  ON 33
ci_0035                 6.625513e-03 3 1  ON 34
ci_0036                 4.427291e-03 3 1  ON 35
ci_0037                -1.147132e-02 3 1  ON 36
ci_0038                -1.067721e-02 3 1  ON 37
ci_0039                -4.225975e-03 3 1  ON 38
ci_0040                -4.038252e-03 3 1  ON 39
ci_0041                 8.593230e-03 3 1  ON 40
ci_0042                 8.387562e-03 3 1  ON 41
ci_0043                -1.323005e-02 3 1  ON 42
ci_0044                -1.355897e-02 3 1  ON 43
ci_0045                 8.144844e-03 3 1  ON 44
ci_0046                 7.906692e-03 3 1  ON 45
ci_0047                -3.628592e-03 3 1  ON 46
ci_0048                -3.173599e-03 3 1  ON 47
ci_0049                -6.782509e-03 3 1  ON 48
ci_0050                -5.924851e-03 3 1  ON 49
ci_0051                -4.459492e-03 3 1  ON 50
ci_0052                -4.596247e-03 3 1  ON 51
ci_0053                -6.299832e-03 3 1  ON 52
ci_0054                -5.938519e-03 3 1  ON 53
ci_0055                 6.416479e-03 3 1  ON 54
ci_0056                 6.766900e-03 3 1  ON 55
ci_0057                 5.652490e-03 3 1  ON 56
ci_0058                 4.680547e-03 3 1  ON 57
ci_0059                -5.819379e-03 3 1  ON 58
ci_0060                -5.904972e-03 3 1  ON 59
ci_0061                -3.686493e-03 3 1  ON 60
ci_0062                -4.027894e-03 3 1  ON 61
ci_0063                -9.201871e-03 3 1  ON 62
ci_0064                -8.556685e-03 3 1  ON 63
ci_0065                -6.654829e-03 3 1  ON 64
ci_0066                -6.874374e-03 3 1  ON 65
ci_0067                -6.044133e-03 3 1  ON 66
ci_0068                -6.239403e-03 3 1  ON 67
ci_0069                 5.309785e-03 3 1  ON 68
ci_0070                 5.442778e-03 3 1  ON 69
ci_0071                 4.215415e-03 3 1  ON 70
ci_0072                 5.161359e-03 3 1  ON 71
ci_0073                 5.149482e-03 3 1  ON 72
ci_0074                 5.508143e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.8912
    reference variance = 0.474419
====================================================
  Execution time = 1.4526e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2315e-01
  Total weights = 1.9517e+06
  Execution time = 1.8939e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311320329513
                                         uncertainty =       0.002224452469

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311320329513
                                         uncertainty =       0.002224452469

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394549919
  error estimate for blocks of size 2^( 2) =       0.000408285555
  error estimate for blocks of size 2^( 3) =       0.000422900118
  error estimate for blocks of size 2^( 4) =       0.000435513350
  error estimate for blocks of size 2^( 5) =       0.000446796959
  error estimate for blocks of size 2^( 6) =       0.000454730386
  error estimate for blocks of size 2^( 7) =       0.000461110335

      target function =                  N/A
              le_mean =     -16.904013207779
             les_mean =     286.068807652582
             stat err =       0.000449537757
             autocorr =       1.298160625461
              std dev =       0.557977846276
             le_variance =       0.311339276935

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311320386296
                                         uncertainty =       0.002224452736

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311320386296
                                         uncertainty =       0.002224452736

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394549955
  error estimate for blocks of size 2^( 2) =       0.000408285590
  error estimate for blocks of size 2^( 3) =       0.000422900150
  error estimate for blocks of size 2^( 4) =       0.000435513381
  error estimate for blocks of size 2^( 5) =       0.000446796989
  error estimate for blocks of size 2^( 6) =       0.000454730417
  error estimate for blocks of size 2^( 7) =       0.000461110356

      target function =                  N/A
              le_mean =     -16.904013209505
             les_mean =     286.068807248733
             stat err =       0.000449537786
             autocorr =       1.298160553501
              std dev =       0.557977897160
             le_variance =       0.311339333719

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311320357905
                                         uncertainty =       0.002224452602

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311320357905
                                         uncertainty =       0.002224452602

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394549937
  error estimate for blocks of size 2^( 2) =       0.000408285573
  error estimate for blocks of size 2^( 3) =       0.000422900134
  error estimate for blocks of size 2^( 4) =       0.000435513366
  error estimate for blocks of size 2^( 5) =       0.000446796974
  error estimate for blocks of size 2^( 6) =       0.000454730402
  error estimate for blocks of size 2^( 7) =       0.000461110345

      target function =                  N/A
              le_mean =     -16.904013208642
             les_mean =     286.068807450503
             stat err =       0.000449537772
             autocorr =       1.298160589477
              std dev =       0.557977871719
             le_variance =       0.311339305328

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311320333062
                                         uncertainty =       0.002224452486

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311320333062
                                         uncertainty =       0.002224452486

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394549921
  error estimate for blocks of size 2^( 2) =       0.000408285557
  error estimate for blocks of size 2^( 3) =       0.000422900120
  error estimate for blocks of size 2^( 4) =       0.000435513352
  error estimate for blocks of size 2^( 5) =       0.000446796961
  error estimate for blocks of size 2^( 6) =       0.000454730388
  error estimate for blocks of size 2^( 7) =       0.000461110336

      target function =                  N/A
              le_mean =     -16.904013207887
             les_mean =     286.068807627306
             stat err =       0.000449537759
             autocorr =       1.298160620967
              std dev =       0.557977849456
             le_variance =       0.311339280483


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904013207779        initial
     2.3842e+03     2.3842e+04             1.5253e-07       -16.904013209505  <--
     9.5367e+03     9.5367e+04             3.8134e-08       -16.904013208642
     3.8147e+04     3.8147e+05             9.5336e-09       -16.904013207887

*****************************************************************************
Applying the update for shift_i =   2.3842e+03     and shift_s =   2.3842e+04
*****************************************************************************

  Execution time = 2.4324e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
ci_0001                 7.011124e-01 3 1  ON 0
ci_0002                 6.996414e-01 3 1  ON 1
ci_0003                -3.046605e-02 3 1  ON 2
ci_0004                -3.091072e-02 3 1  ON 3
ci_0005                -3.366156e-02 3 1  ON 4
ci_0006                -3.479293e-02 3 1  ON 5
ci_0007                -2.186687e-02 3 1  ON 6
ci_0008                -2.315565e-02 3 1  ON 7
ci_0009                -1.987046e-02 3 1  ON 8
ci_0010                -2.025486e-02 3 1  ON 9
ci_0011                -1.478815e-02 3 1  ON 10
ci_0012                -1.482303e-02 3 1  ON 11
ci_0013                 1.604590e-02 3 1  ON 12
ci_0014                 1.528644e-02 3 1  ON 13
ci_0015                 1.616070e-02 3 1  ON 14
ci_0016                 1.562240e-02 3 1  ON 15
ci_0017                 1.423523e-02 3 1  ON 16
ci_0018                 1.405537e-02 3 1  ON 17
ci_0019                 1.258351e-02 3 1  ON 18
ci_0020                 1.185948e-02 3 1  ON 19
ci_0021                 6.905854e-03 3 1  ON 20
ci_0022                 7.158935e-03 3 1  ON 21
ci_0023                -1.184474e-02 3 1  ON 22
ci_0024                -1.120315e-02 3 1  ON 23
ci_0025                -1.121439e-02 3 1  ON 24
ci_0026                -1.121716e-02 3 1  ON 25
ci_0027                -1.141644e-02 3 1  ON 26
ci_0028                -1.145862e-02 3 1  ON 27
ci_0029                -1.086549e-02 3 1  ON 28
ci_0030                -1.049912e-02 3 1  ON 29
ci_0031                 1.941732e-02 3 1  ON 30
ci_0032                 1.934089e-02 3 1  ON 31
ci_0033                 9.743994e-03 3 1  ON 32
ci_0034                 1.064393e-02 3 1  ON 33
ci_0035                 6.625530e-03 3 1  ON 34
ci_0036                 4.427396e-03 3 1  ON 35
ci_0037                -1.147132e-02 3 1  ON 36
ci_0038                -1.067728e-02 3 1  ON 37
ci_0039                -4.225961e-03 3 1  ON 38
ci_0040                -4.038306e-03 3 1  ON 39
ci_0041                 8.593198e-03 3 1  ON 40
ci_0042                 8.387603e-03 3 1  ON 41
ci_0043                -1.323013e-02 3 1  ON 42
ci_0044                -1.355902e-02 3 1  ON 43
ci_0045                 8.144895e-03 3 1  ON 44
ci_0046                 7.906699e-03 3 1  ON 45
ci_0047                -3.628549e-03 3 1  ON 46
ci_0048                -3.173608e-03 3 1  ON 47
ci_0049                -6.782457e-03 3 1  ON 48
ci_0050                -5.924863e-03 3 1  ON 49
ci_0051                -4.459521e-03 3 1  ON 50
ci_0052                -4.596229e-03 3 1  ON 51
ci_0053                -6.299770e-03 3 1  ON 52
ci_0054                -5.938574e-03 3 1  ON 53
ci_0055                 6.416594e-03 3 1  ON 54
ci_0056                 6.766874e-03 3 1  ON 55
ci_0057                 5.652512e-03 3 1  ON 56
ci_0058                 4.680564e-03 3 1  ON 57
ci_0059                -5.819365e-03 3 1  ON 58
ci_0060                -5.904983e-03 3 1  ON 59
ci_0061                -3.686488e-03 3 1  ON 60
ci_0062                -4.027874e-03 3 1  ON 61
ci_0063                -9.201835e-03 3 1  ON 62
ci_0064                -8.556701e-03 3 1  ON 63
ci_0065                -6.654859e-03 3 1  ON 64
ci_0066                -6.874389e-03 3 1  ON 65
ci_0067                -6.044093e-03 3 1  ON 66
ci_0068                -6.239357e-03 3 1  ON 67
ci_0069                 5.309773e-03 3 1  ON 68
ci_0070                 5.442815e-03 3 1  ON 69
ci_0071                 4.215409e-03 3 1  ON 70
ci_0072                 5.161337e-03 3 1  ON 71
ci_0073                 5.149496e-03 3 1  ON 72
ci_0074                 5.508097e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1315e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6889e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.9769
    reference variance = 0.246881
====================================================
  Execution time = 1.4543e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5218e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2264e-01
  Total weights = 1.951636552e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5643e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308374795147
                                         uncertainty =       0.002211181469

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308374795147
                                         uncertainty =       0.002211181469

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392676687
  error estimate for blocks of size 2^( 2) =       0.000406758981
  error estimate for blocks of size 2^( 3) =       0.000421004028
  error estimate for blocks of size 2^( 4) =       0.000434485486
  error estimate for blocks of size 2^( 5) =       0.000445131120
  error estimate for blocks of size 2^( 6) =       0.000452924081
  error estimate for blocks of size 2^( 7) =       0.000455593442

      target function =                  N/A
              le_mean =     -16.904431937190
             les_mean =     286.082460111049
             stat err =       0.000447033532
             autocorr =       1.296014812247
              std dev =       0.555328696886
             le_variance =       0.308389961585


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690443193719e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+02, overlap shift 5.9605e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904431937215       residual = 2.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904431939600       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904431939921       residual = 6.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904431939944       residual = 1.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.9605e+02 is 8.320017e-07

solving harmonic davidson linear method for identity shift 2.3842e+03, overlap shift 2.3842e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904431937215       residual = 2.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904431937812       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904431937892       residual = 6.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904431937898       residual = 1.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3842e+03 is 2.080510e-07

solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904431937215       residual = 2.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904431937364       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904431937385       residual = 6.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904431937386       residual = 1.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.5367e+03 is 5.201592e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.173374 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7113e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
ci_0001                 7.011124e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046604e-02 3 1  ON 2
ci_0004                -3.091072e-02 3 1  ON 3
ci_0005                -3.366159e-02 3 1  ON 4
ci_0006                -3.479305e-02 3 1  ON 5
ci_0007                -2.186673e-02 3 1  ON 6
ci_0008                -2.315562e-02 3 1  ON 7
ci_0009                -1.987052e-02 3 1  ON 8
ci_0010                -2.025483e-02 3 1  ON 9
ci_0011                -1.478820e-02 3 1  ON 10
ci_0012                -1.482293e-02 3 1  ON 11
ci_0013                 1.604588e-02 3 1  ON 12
ci_0014                 1.528635e-02 3 1  ON 13
ci_0015                 1.616069e-02 3 1  ON 14
ci_0016                 1.562237e-02 3 1  ON 15
ci_0017                 1.423518e-02 3 1  ON 16
ci_0018                 1.405526e-02 3 1  ON 17
ci_0019                 1.258345e-02 3 1  ON 18
ci_0020                 1.185959e-02 3 1  ON 19
ci_0021                 6.905878e-03 3 1  ON 20
ci_0022                 7.158933e-03 3 1  ON 21
ci_0023                -1.184467e-02 3 1  ON 22
ci_0024                -1.120301e-02 3 1  ON 23
ci_0025                -1.121457e-02 3 1  ON 24
ci_0026                -1.121725e-02 3 1  ON 25
ci_0027                -1.141647e-02 3 1  ON 26
ci_0028                -1.145859e-02 3 1  ON 27
ci_0029                -1.086544e-02 3 1  ON 28
ci_0030                -1.049905e-02 3 1  ON 29
ci_0031                 1.941728e-02 3 1  ON 30
ci_0032                 1.934087e-02 3 1  ON 31
ci_0033                 9.744161e-03 3 1  ON 32
ci_0034                 1.064386e-02 3 1  ON 33
ci_0035                 6.625570e-03 3 1  ON 34
ci_0036                 4.427605e-03 3 1  ON 35
ci_0037                -1.147129e-02 3 1  ON 36
ci_0038                -1.067734e-02 3 1  ON 37
ci_0039                -4.225982e-03 3 1  ON 38
ci_0040                -4.038311e-03 3 1  ON 39
ci_0041                 8.593107e-03 3 1  ON 40
ci_0042                 8.387676e-03 3 1  ON 41
ci_0043                -1.323008e-02 3 1  ON 42
ci_0044                -1.355894e-02 3 1  ON 43
ci_0045                 8.145099e-03 3 1  ON 44
ci_0046                 7.906704e-03 3 1  ON 45
ci_0047                -3.628505e-03 3 1  ON 46
ci_0048                -3.173673e-03 3 1  ON 47
ci_0049                -6.782390e-03 3 1  ON 48
ci_0050                -5.924927e-03 3 1  ON 49
ci_0051                -4.459618e-03 3 1  ON 50
ci_0052                -4.596289e-03 3 1  ON 51
ci_0053                -6.299791e-03 3 1  ON 52
ci_0054                -5.938737e-03 3 1  ON 53
ci_0055                 6.416608e-03 3 1  ON 54
ci_0056                 6.766894e-03 3 1  ON 55
ci_0057                 5.652421e-03 3 1  ON 56
ci_0058                 4.680689e-03 3 1  ON 57
ci_0059                -5.819412e-03 3 1  ON 58
ci_0060                -5.905052e-03 3 1  ON 59
ci_0061                -3.686498e-03 3 1  ON 60
ci_0062                -4.027895e-03 3 1  ON 61
ci_0063                -9.201774e-03 3 1  ON 62
ci_0064                -8.556843e-03 3 1  ON 63
ci_0065                -6.654955e-03 3 1  ON 64
ci_0066                -6.874433e-03 3 1  ON 65
ci_0067                -6.044043e-03 3 1  ON 66
ci_0068                -6.239315e-03 3 1  ON 67
ci_0069                 5.309788e-03 3 1  ON 68
ci_0070                 5.442842e-03 3 1  ON 69
ci_0071                 4.215395e-03 3 1  ON 70
ci_0072                 5.161346e-03 3 1  ON 71
ci_0073                 5.149628e-03 3 1  ON 72
ci_0074                 5.508006e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.9827
    reference variance = 0.388299
====================================================
  Execution time = 1.4193e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2756e-01
  Total weights = 1.9517e+06
  Execution time = 1.8840e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310736801248
                                         uncertainty =       0.001965579310

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310736801248
                                         uncertainty =       0.001965579310

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394160234
  error estimate for blocks of size 2^( 2) =       0.000408005611
  error estimate for blocks of size 2^( 3) =       0.000422194274
  error estimate for blocks of size 2^( 4) =       0.000435417706
  error estimate for blocks of size 2^( 5) =       0.000445779053
  error estimate for blocks of size 2^( 6) =       0.000454517485
  error estimate for blocks of size 2^( 7) =       0.000457779966

      target function =                  N/A
              le_mean =     -16.904445070376
             les_mean =     286.087821924720
             stat err =       0.000448373553
             autocorr =       1.294000255390
              std dev =       0.557426748222
             le_variance =       0.310724579633

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310737413299
                                         uncertainty =       0.001965595863

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310737413299
                                         uncertainty =       0.001965595863

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394160621
  error estimate for blocks of size 2^( 2) =       0.000408005974
  error estimate for blocks of size 2^( 3) =       0.000422194638
  error estimate for blocks of size 2^( 4) =       0.000435418078
  error estimate for blocks of size 2^( 5) =       0.000445779424
  error estimate for blocks of size 2^( 6) =       0.000454517873
  error estimate for blocks of size 2^( 7) =       0.000457780313

      target function =                  N/A
              le_mean =     -16.904445075649
             les_mean =     286.087822175625
             stat err =       0.000448373922
             autocorr =       1.293999845240
              std dev =       0.557427295775
             le_variance =       0.310725190075

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310737107333
                                         uncertainty =       0.001965587588

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310737107333
                                         uncertainty =       0.001965587588

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394160427
  error estimate for blocks of size 2^( 2) =       0.000408005792
  error estimate for blocks of size 2^( 3) =       0.000422194456
  error estimate for blocks of size 2^( 4) =       0.000435417892
  error estimate for blocks of size 2^( 5) =       0.000445779238
  error estimate for blocks of size 2^( 6) =       0.000454517679
  error estimate for blocks of size 2^( 7) =       0.000457780139

      target function =                  N/A
              le_mean =     -16.904445073008
             les_mean =     286.087822044445
             stat err =       0.000448373737
             autocorr =       1.294000050256
              std dev =       0.557427022052
             le_variance =       0.310724884913

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310736839508
                                         uncertainty =       0.001965580345

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310736839508
                                         uncertainty =       0.001965580345

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394160258
  error estimate for blocks of size 2^( 2) =       0.000408005633
  error estimate for blocks of size 2^( 3) =       0.000422194297
  error estimate for blocks of size 2^( 4) =       0.000435417730
  error estimate for blocks of size 2^( 5) =       0.000445779076
  error estimate for blocks of size 2^( 6) =       0.000454517509
  error estimate for blocks of size 2^( 7) =       0.000457779988

      target function =                  N/A
              le_mean =     -16.904445070705
             les_mean =     286.087821939066
             stat err =       0.000448373576
             autocorr =       1.294000229751
              std dev =       0.557426782449
             le_variance =       0.310724617792


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904445070376        initial
     5.9605e+02     5.9605e+03             8.3200e-07       -16.904445075649  <--
     2.3842e+03     2.3842e+04             2.0805e-07       -16.904445073008
     9.5367e+03     9.5367e+04             5.2016e-08       -16.904445070705

*****************************************************************************
Applying the update for shift_i =   5.9605e+02     and shift_s =   5.9605e+03
*****************************************************************************

  Execution time = 2.3721e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046598e-02 3 1  ON 2
ci_0004                -3.091074e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479342e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987071e-02 3 1  ON 8
ci_0010                -2.025474e-02 3 1  ON 9
ci_0011                -1.478835e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604581e-02 3 1  ON 12
ci_0014                 1.528608e-02 3 1  ON 13
ci_0015                 1.616065e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423503e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258327e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905950e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184449e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121508e-02 3 1  ON 24
ci_0026                -1.121753e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145851e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049885e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934078e-02 3 1  ON 31
ci_0033                 9.744661e-03 3 1  ON 32
ci_0034                 1.064363e-02 3 1  ON 33
ci_0035                 6.625689e-03 3 1  ON 34
ci_0036                 4.428228e-03 3 1  ON 35
ci_0037                -1.147123e-02 3 1  ON 36
ci_0038                -1.067751e-02 3 1  ON 37
ci_0039                -4.226044e-03 3 1  ON 38
ci_0040                -4.038323e-03 3 1  ON 39
ci_0041                 8.592834e-03 3 1  ON 40
ci_0042                 8.387897e-03 3 1  ON 41
ci_0043                -1.322991e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145710e-03 3 1  ON 44
ci_0046                 7.906721e-03 3 1  ON 45
ci_0047                -3.628375e-03 3 1  ON 46
ci_0048                -3.173867e-03 3 1  ON 47
ci_0049                -6.782189e-03 3 1  ON 48
ci_0050                -5.925120e-03 3 1  ON 49
ci_0051                -4.459910e-03 3 1  ON 50
ci_0052                -4.596471e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939224e-03 3 1  ON 53
ci_0055                 6.416652e-03 3 1  ON 54
ci_0056                 6.766952e-03 3 1  ON 55
ci_0057                 5.652148e-03 3 1  ON 56
ci_0058                 4.681063e-03 3 1  ON 57
ci_0059                -5.819552e-03 3 1  ON 58
ci_0060                -5.905259e-03 3 1  ON 59
ci_0061                -3.686529e-03 3 1  ON 60
ci_0062                -4.027959e-03 3 1  ON 61
ci_0063                -9.201593e-03 3 1  ON 62
ci_0064                -8.557270e-03 3 1  ON 63
ci_0065                -6.655244e-03 3 1  ON 64
ci_0066                -6.874565e-03 3 1  ON 65
ci_0067                -6.043893e-03 3 1  ON 66
ci_0068                -6.239190e-03 3 1  ON 67
ci_0069                 5.309835e-03 3 1  ON 68
ci_0070                 5.442922e-03 3 1  ON 69
ci_0071                 4.215353e-03 3 1  ON 70
ci_0072                 5.161372e-03 3 1  ON 71
ci_0073                 5.150025e-03 3 1  ON 72
ci_0074                 5.507732e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0954e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6893e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.9096
    reference variance = 0.169382
====================================================
  Execution time = 1.4569e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5237e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2709e-01
  Total weights = 1.951593689e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5752e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312442535555
                                         uncertainty =       0.002825768737

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312442535555
                                         uncertainty =       0.002825768737

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395277535
  error estimate for blocks of size 2^( 2) =       0.000409101259
  error estimate for blocks of size 2^( 3) =       0.000422975019
  error estimate for blocks of size 2^( 4) =       0.000436014914
  error estimate for blocks of size 2^( 5) =       0.000447109691
  error estimate for blocks of size 2^( 6) =       0.000456279840
  error estimate for blocks of size 2^( 7) =       0.000461445627

      target function =                  N/A
              le_mean =     -16.904372309410
             les_mean =     286.084888985996
             stat err =       0.000450212518
             autocorr =       1.297271472540
              std dev =       0.559006850697
             le_variance =       0.312488659126


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690437230941e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+02, overlap shift 1.4901e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904372309428       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904372344939       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904372345992       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904372345860       residual = 1.62e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+02 is 2.540789e-06

solving harmonic davidson linear method for identity shift 5.9605e+02, overlap shift 5.9605e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904372309428       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904372318315       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904372318581       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904372318547       residual = 1.63e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.9605e+02 is 6.359751e-07

solving harmonic davidson linear method for identity shift 2.3842e+03, overlap shift 2.3842e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904372309428       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904372311651       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904372311717       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904372311709       residual = 1.63e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3842e+03 is 1.590425e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.174648 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7149e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
ci_0001                 7.011123e-01 3 1  ON 0
ci_0002                 6.996414e-01 3 1  ON 1
ci_0003                -3.046636e-02 3 1  ON 2
ci_0004                -3.091085e-02 3 1  ON 3
ci_0005                -3.366209e-02 3 1  ON 4
ci_0006                -3.479308e-02 3 1  ON 5
ci_0007                -2.186641e-02 3 1  ON 6
ci_0008                -2.315571e-02 3 1  ON 7
ci_0009                -1.987094e-02 3 1  ON 8
ci_0010                -2.025440e-02 3 1  ON 9
ci_0011                -1.478852e-02 3 1  ON 10
ci_0012                -1.482292e-02 3 1  ON 11
ci_0013                 1.604542e-02 3 1  ON 12
ci_0014                 1.528626e-02 3 1  ON 13
ci_0015                 1.616078e-02 3 1  ON 14
ci_0016                 1.562216e-02 3 1  ON 15
ci_0017                 1.423461e-02 3 1  ON 16
ci_0018                 1.405483e-02 3 1  ON 17
ci_0019                 1.258318e-02 3 1  ON 18
ci_0020                 1.185994e-02 3 1  ON 19
ci_0021                 6.905933e-03 3 1  ON 20
ci_0022                 7.158894e-03 3 1  ON 21
ci_0023                -1.184385e-02 3 1  ON 22
ci_0024                -1.120281e-02 3 1  ON 23
ci_0025                -1.121513e-02 3 1  ON 24
ci_0026                -1.121764e-02 3 1  ON 25
ci_0027                -1.141683e-02 3 1  ON 26
ci_0028                -1.145835e-02 3 1  ON 27
ci_0029                -1.086488e-02 3 1  ON 28
ci_0030                -1.049900e-02 3 1  ON 29
ci_0031                 1.941700e-02 3 1  ON 30
ci_0032                 1.934075e-02 3 1  ON 31
ci_0033                 9.744780e-03 3 1  ON 32
ci_0034                 1.064337e-02 3 1  ON 33
ci_0035                 6.626099e-03 3 1  ON 34
ci_0036                 4.428861e-03 3 1  ON 35
ci_0037                -1.147158e-02 3 1  ON 36
ci_0038                -1.067796e-02 3 1  ON 37
ci_0039                -4.226044e-03 3 1  ON 38
ci_0040                -4.038460e-03 3 1  ON 39
ci_0041                 8.592572e-03 3 1  ON 40
ci_0042                 8.387742e-03 3 1  ON 41
ci_0043                -1.323012e-02 3 1  ON 42
ci_0044                -1.355874e-02 3 1  ON 43
ci_0045                 8.145551e-03 3 1  ON 44
ci_0046                 7.906917e-03 3 1  ON 45
ci_0047                -3.628027e-03 3 1  ON 46
ci_0048                -3.173739e-03 3 1  ON 47
ci_0049                -6.781872e-03 3 1  ON 48
ci_0050                -5.925594e-03 3 1  ON 49
ci_0051                -4.460060e-03 3 1  ON 50
ci_0052                -4.596371e-03 3 1  ON 51
ci_0053                -6.299931e-03 3 1  ON 52
ci_0054                -5.939383e-03 3 1  ON 53
ci_0055                 6.416220e-03 3 1  ON 54
ci_0056                 6.766932e-03 3 1  ON 55
ci_0057                 5.652086e-03 3 1  ON 56
ci_0058                 4.681246e-03 3 1  ON 57
ci_0059                -5.819615e-03 3 1  ON 58
ci_0060                -5.905454e-03 3 1  ON 59
ci_0061                -3.686626e-03 3 1  ON 60
ci_0062                -4.028092e-03 3 1  ON 61
ci_0063                -9.201322e-03 3 1  ON 62
ci_0064                -8.557275e-03 3 1  ON 63
ci_0065                -6.655307e-03 3 1  ON 64
ci_0066                -6.874588e-03 3 1  ON 65
ci_0067                -6.043823e-03 3 1  ON 66
ci_0068                -6.239105e-03 3 1  ON 67
ci_0069                 5.310047e-03 3 1  ON 68
ci_0070                 5.442812e-03 3 1  ON 69
ci_0071                 4.215235e-03 3 1  ON 70
ci_0072                 5.160974e-03 3 1  ON 71
ci_0073                 5.149717e-03 3 1  ON 72
ci_0074                 5.507500e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.9317
    reference variance = 0.436056
====================================================
  Execution time = 1.3935e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2104e-01
  Total weights = 1.9518e+06
  Execution time = 1.8954e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309840096817
                                         uncertainty =       0.001870935629

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309840096817
                                         uncertainty =       0.001870935629

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393577099
  error estimate for blocks of size 2^( 2) =       0.000407495439
  error estimate for blocks of size 2^( 3) =       0.000421657150
  error estimate for blocks of size 2^( 4) =       0.000434408163
  error estimate for blocks of size 2^( 5) =       0.000443948377
  error estimate for blocks of size 2^( 6) =       0.000451452910
  error estimate for blocks of size 2^( 7) =       0.000455508627

      target function =                  N/A
              le_mean =     -16.904189642169
             les_mean =     286.072665100196
             stat err =       0.000446329519
             autocorr =       1.286031426701
              std dev =       0.556602070870
             le_variance =       0.309805865297

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309839903457
                                         uncertainty =       0.001870914663

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309839903457
                                         uncertainty =       0.001870914663

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393576977
  error estimate for blocks of size 2^( 2) =       0.000407495328
  error estimate for blocks of size 2^( 3) =       0.000421657039
  error estimate for blocks of size 2^( 4) =       0.000434408066
  error estimate for blocks of size 2^( 5) =       0.000443948257
  error estimate for blocks of size 2^( 6) =       0.000451452777
  error estimate for blocks of size 2^( 7) =       0.000455508459

      target function =                  N/A
              le_mean =     -16.904189632156
             les_mean =     286.072665350268
             stat err =       0.000446329390
             autocorr =       1.286031478825
              std dev =       0.556601898421
             le_variance =       0.309805673325

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309839999780
                                         uncertainty =       0.001870925135

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309839999780
                                         uncertainty =       0.001870925135

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393577038
  error estimate for blocks of size 2^( 2) =       0.000407495383
  error estimate for blocks of size 2^( 3) =       0.000421657094
  error estimate for blocks of size 2^( 4) =       0.000434408114
  error estimate for blocks of size 2^( 5) =       0.000443948317
  error estimate for blocks of size 2^( 6) =       0.000451452843
  error estimate for blocks of size 2^( 7) =       0.000455508543

      target function =                  N/A
              le_mean =     -16.904189637125
             les_mean =     286.072665204904
             stat err =       0.000446329454
             autocorr =       1.286031453025
              std dev =       0.556601984326
             le_variance =       0.309805768955

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309840084655
                                         uncertainty =       0.001870934317

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309840084655
                                         uncertainty =       0.001870934317

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393577091
  error estimate for blocks of size 2^( 2) =       0.000407495432
  error estimate for blocks of size 2^( 3) =       0.000421657143
  error estimate for blocks of size 2^( 4) =       0.000434408156
  error estimate for blocks of size 2^( 5) =       0.000443948369
  error estimate for blocks of size 2^( 6) =       0.000451452901
  error estimate for blocks of size 2^( 7) =       0.000455508616

      target function =                  N/A
              le_mean =     -16.904189641534
             les_mean =     286.072665111215
             stat err =       0.000446329511
             autocorr =       1.286031430010
              std dev =       0.556602060023
             le_variance =       0.309805853222


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904189642169        initial  <--
     1.4901e+02     1.4901e+03             2.5408e-06       -16.904189632156
     5.9605e+02     5.9605e+03             6.3598e-07       -16.904189637125
     2.3842e+03     2.3842e+04             1.5904e-07       -16.904189641534

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.5080
  </log>
  <optVariables href="H2O.s022.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046598e-02 3 1  ON 2
ci_0004                -3.091074e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479342e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987071e-02 3 1  ON 8
ci_0010                -2.025474e-02 3 1  ON 9
ci_0011                -1.478835e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604581e-02 3 1  ON 12
ci_0014                 1.528608e-02 3 1  ON 13
ci_0015                 1.616065e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423503e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258327e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905950e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184449e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121508e-02 3 1  ON 24
ci_0026                -1.121753e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145851e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049885e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934078e-02 3 1  ON 31
ci_0033                 9.744661e-03 3 1  ON 32
ci_0034                 1.064363e-02 3 1  ON 33
ci_0035                 6.625689e-03 3 1  ON 34
ci_0036                 4.428228e-03 3 1  ON 35
ci_0037                -1.147123e-02 3 1  ON 36
ci_0038                -1.067751e-02 3 1  ON 37
ci_0039                -4.226044e-03 3 1  ON 38
ci_0040                -4.038323e-03 3 1  ON 39
ci_0041                 8.592834e-03 3 1  ON 40
ci_0042                 8.387897e-03 3 1  ON 41
ci_0043                -1.322991e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145710e-03 3 1  ON 44
ci_0046                 7.906721e-03 3 1  ON 45
ci_0047                -3.628375e-03 3 1  ON 46
ci_0048                -3.173867e-03 3 1  ON 47
ci_0049                -6.782189e-03 3 1  ON 48
ci_0050                -5.925120e-03 3 1  ON 49
ci_0051                -4.459910e-03 3 1  ON 50
ci_0052                -4.596471e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939224e-03 3 1  ON 53
ci_0055                 6.416652e-03 3 1  ON 54
ci_0056                 6.766952e-03 3 1  ON 55
ci_0057                 5.652148e-03 3 1  ON 56
ci_0058                 4.681063e-03 3 1  ON 57
ci_0059                -5.819552e-03 3 1  ON 58
ci_0060                -5.905259e-03 3 1  ON 59
ci_0061                -3.686529e-03 3 1  ON 60
ci_0062                -4.027959e-03 3 1  ON 61
ci_0063                -9.201593e-03 3 1  ON 62
ci_0064                -8.557270e-03 3 1  ON 63
ci_0065                -6.655244e-03 3 1  ON 64
ci_0066                -6.874565e-03 3 1  ON 65
ci_0067                -6.043893e-03 3 1  ON 66
ci_0068                -6.239190e-03 3 1  ON 67
ci_0069                 5.309835e-03 3 1  ON 68
ci_0070                 5.442922e-03 3 1  ON 69
ci_0071                 4.215353e-03 3 1  ON 70
ci_0072                 5.161372e-03 3 1  ON 71
ci_0073                 5.150025e-03 3 1  ON 72
ci_0074                 5.507732e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0662e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6894e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.8953
    reference variance = 0.18796
====================================================
  Execution time = 1.4711e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5250e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2535e-01
  Total weights = 1.951916208e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5701e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311163139637
                                         uncertainty =       0.002087886532

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311163139637
                                         uncertainty =       0.002087886532

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394445407
  error estimate for blocks of size 2^( 2) =       0.000408573557
  error estimate for blocks of size 2^( 3) =       0.000423490036
  error estimate for blocks of size 2^( 4) =       0.000437195114
  error estimate for blocks of size 2^( 5) =       0.000449123970
  error estimate for blocks of size 2^( 6) =       0.000457513435
  error estimate for blocks of size 2^( 7) =       0.000463542354

      target function =                  N/A
              le_mean =     -16.904295941767
             les_mean =     286.080571413845
             stat err =       0.000451843718
             autocorr =       1.312208026040
              std dev =       0.557830044876
             le_variance =       0.311174358967


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690429594177e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+03, overlap shift 1.4901e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904295941756       residual = 1.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904295946571       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904295946608       residual = 2.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904295946588       residual = 2.70e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+03 is 4.778835e-07

solving harmonic davidson linear method for identity shift 5.9605e+03, overlap shift 5.9605e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904295941756       residual = 1.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904295942960       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904295942969       residual = 2.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904295942968       residual = 2.70e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.9605e+03 is 1.194824e-07

solving harmonic davidson linear method for identity shift 2.3842e+04, overlap shift 2.3842e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904295941756       residual = 1.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904295942057       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904295942059       residual = 2.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904295942058       residual = 2.70e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3842e+04 is 2.987133e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.175990 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7287e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046602e-02 3 1  ON 2
ci_0004                -3.091072e-02 3 1  ON 3
ci_0005                -3.366170e-02 3 1  ON 4
ci_0006                -3.479343e-02 3 1  ON 5
ci_0007                -2.186632e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987070e-02 3 1  ON 8
ci_0010                -2.025476e-02 3 1  ON 9
ci_0011                -1.478838e-02 3 1  ON 10
ci_0012                -1.482263e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528605e-02 3 1  ON 13
ci_0015                 1.616065e-02 3 1  ON 14
ci_0016                 1.562231e-02 3 1  ON 15
ci_0017                 1.423507e-02 3 1  ON 16
ci_0018                 1.405494e-02 3 1  ON 17
ci_0019                 1.258325e-02 3 1  ON 18
ci_0020                 1.185992e-02 3 1  ON 19
ci_0021                 6.905965e-03 3 1  ON 20
ci_0022                 7.158949e-03 3 1  ON 21
ci_0023                -1.184449e-02 3 1  ON 22
ci_0024                -1.120260e-02 3 1  ON 23
ci_0025                -1.121507e-02 3 1  ON 24
ci_0026                -1.121758e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145854e-02 3 1  ON 27
ci_0029                -1.086528e-02 3 1  ON 28
ci_0030                -1.049885e-02 3 1  ON 29
ci_0031                 1.941719e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744695e-03 3 1  ON 32
ci_0034                 1.064363e-02 3 1  ON 33
ci_0035                 6.625695e-03 3 1  ON 34
ci_0036                 4.428348e-03 3 1  ON 35
ci_0037                -1.147124e-02 3 1  ON 36
ci_0038                -1.067755e-02 3 1  ON 37
ci_0039                -4.226043e-03 3 1  ON 38
ci_0040                -4.038313e-03 3 1  ON 39
ci_0041                 8.592827e-03 3 1  ON 40
ci_0042                 8.387912e-03 3 1  ON 41
ci_0043                -1.322993e-02 3 1  ON 42
ci_0044                -1.355870e-02 3 1  ON 43
ci_0045                 8.145709e-03 3 1  ON 44
ci_0046                 7.906751e-03 3 1  ON 45
ci_0047                -3.628377e-03 3 1  ON 46
ci_0048                -3.173864e-03 3 1  ON 47
ci_0049                -6.782157e-03 3 1  ON 48
ci_0050                -5.925166e-03 3 1  ON 49
ci_0051                -4.459898e-03 3 1  ON 50
ci_0052                -4.596476e-03 3 1  ON 51
ci_0053                -6.299855e-03 3 1  ON 52
ci_0054                -5.939254e-03 3 1  ON 53
ci_0055                 6.416656e-03 3 1  ON 54
ci_0056                 6.766978e-03 3 1  ON 55
ci_0057                 5.652137e-03 3 1  ON 56
ci_0058                 4.681107e-03 3 1  ON 57
ci_0059                -5.819578e-03 3 1  ON 58
ci_0060                -5.905211e-03 3 1  ON 59
ci_0061                -3.686558e-03 3 1  ON 60
ci_0062                -4.027966e-03 3 1  ON 61
ci_0063                -9.201585e-03 3 1  ON 62
ci_0064                -8.557300e-03 3 1  ON 63
ci_0065                -6.655252e-03 3 1  ON 64
ci_0066                -6.874587e-03 3 1  ON 65
ci_0067                -6.043897e-03 3 1  ON 66
ci_0068                -6.239201e-03 3 1  ON 67
ci_0069                 5.309844e-03 3 1  ON 68
ci_0070                 5.442914e-03 3 1  ON 69
ci_0071                 4.215335e-03 3 1  ON 70
ci_0072                 5.161367e-03 3 1  ON 71
ci_0073                 5.149990e-03 3 1  ON 72
ci_0074                 5.507771e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.9425
    reference variance = 0.329013
====================================================
  Execution time = 1.4038e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2428e-01
  Total weights = 1.9520e+06
  Execution time = 1.9098e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311659799092
                                         uncertainty =       0.003239797392

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311659799092
                                         uncertainty =       0.003239797392

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394816544
  error estimate for blocks of size 2^( 2) =       0.000408764064
  error estimate for blocks of size 2^( 3) =       0.000423437310
  error estimate for blocks of size 2^( 4) =       0.000436682501
  error estimate for blocks of size 2^( 5) =       0.000448137325
  error estimate for blocks of size 2^( 6) =       0.000457491741
  error estimate for blocks of size 2^( 7) =       0.000461737977

      target function =                  N/A
              le_mean =     -16.904179677622
             les_mean =     286.075567326776
             stat err =       0.000451012386
             autocorr =       1.304927110059
              std dev =       0.558354910514
             le_variance =       0.311760206095

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311659873893
                                         uncertainty =       0.003239806020

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311659873893
                                         uncertainty =       0.003239806020

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394816591
  error estimate for blocks of size 2^( 2) =       0.000408764104
  error estimate for blocks of size 2^( 3) =       0.000423437341
  error estimate for blocks of size 2^( 4) =       0.000436682522
  error estimate for blocks of size 2^( 5) =       0.000448137344
  error estimate for blocks of size 2^( 6) =       0.000457491751
  error estimate for blocks of size 2^( 7) =       0.000461737985

      target function =                  N/A
              le_mean =     -16.904179674386
             les_mean =     286.075567239340
             stat err =       0.000451012401
             autocorr =       1.304926879589
              std dev =       0.558354977903
             le_variance =       0.311760281349

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311659836493
                                         uncertainty =       0.003239801706

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311659836493
                                         uncertainty =       0.003239801706

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394816567
  error estimate for blocks of size 2^( 2) =       0.000408764084
  error estimate for blocks of size 2^( 3) =       0.000423437326
  error estimate for blocks of size 2^( 4) =       0.000436682512
  error estimate for blocks of size 2^( 5) =       0.000448137335
  error estimate for blocks of size 2^( 6) =       0.000457491746
  error estimate for blocks of size 2^( 7) =       0.000461737981

      target function =                  N/A
              le_mean =     -16.904179676003
             les_mean =     286.075567282648
             stat err =       0.000451012393
             autocorr =       1.304926994822
              std dev =       0.558354944208
             le_variance =       0.311760243722

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311659803766
                                         uncertainty =       0.003239797931

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311659803766
                                         uncertainty =       0.003239797931

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394816547
  error estimate for blocks of size 2^( 2) =       0.000408764067
  error estimate for blocks of size 2^( 3) =       0.000423437312
  error estimate for blocks of size 2^( 4) =       0.000436682502
  error estimate for blocks of size 2^( 5) =       0.000448137326
  error estimate for blocks of size 2^( 6) =       0.000457491742
  error estimate for blocks of size 2^( 7) =       0.000461737978

      target function =                  N/A
              le_mean =     -16.904179677419
             les_mean =     286.075567321215
             stat err =       0.000451012387
             autocorr =       1.304927095665
              std dev =       0.558354914725
             le_variance =       0.311760210798


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904179677622        initial  <--
     1.4901e+03     1.4901e+04             4.7788e-07       -16.904179674386
     5.9605e+03     5.9605e+04             1.1948e-07       -16.904179676003
     2.3842e+04     2.3842e+05             2.9871e-08       -16.904179677419

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.5949
  </log>
  <optVariables href="H2O.s023.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046598e-02 3 1  ON 2
ci_0004                -3.091074e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479342e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987071e-02 3 1  ON 8
ci_0010                -2.025474e-02 3 1  ON 9
ci_0011                -1.478835e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604581e-02 3 1  ON 12
ci_0014                 1.528608e-02 3 1  ON 13
ci_0015                 1.616065e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423503e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258327e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905950e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184449e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121508e-02 3 1  ON 24
ci_0026                -1.121753e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145851e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049885e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934078e-02 3 1  ON 31
ci_0033                 9.744661e-03 3 1  ON 32
ci_0034                 1.064363e-02 3 1  ON 33
ci_0035                 6.625689e-03 3 1  ON 34
ci_0036                 4.428228e-03 3 1  ON 35
ci_0037                -1.147123e-02 3 1  ON 36
ci_0038                -1.067751e-02 3 1  ON 37
ci_0039                -4.226044e-03 3 1  ON 38
ci_0040                -4.038323e-03 3 1  ON 39
ci_0041                 8.592834e-03 3 1  ON 40
ci_0042                 8.387897e-03 3 1  ON 41
ci_0043                -1.322991e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145710e-03 3 1  ON 44
ci_0046                 7.906721e-03 3 1  ON 45
ci_0047                -3.628375e-03 3 1  ON 46
ci_0048                -3.173867e-03 3 1  ON 47
ci_0049                -6.782189e-03 3 1  ON 48
ci_0050                -5.925120e-03 3 1  ON 49
ci_0051                -4.459910e-03 3 1  ON 50
ci_0052                -4.596471e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939224e-03 3 1  ON 53
ci_0055                 6.416652e-03 3 1  ON 54
ci_0056                 6.766952e-03 3 1  ON 55
ci_0057                 5.652148e-03 3 1  ON 56
ci_0058                 4.681063e-03 3 1  ON 57
ci_0059                -5.819552e-03 3 1  ON 58
ci_0060                -5.905259e-03 3 1  ON 59
ci_0061                -3.686529e-03 3 1  ON 60
ci_0062                -4.027959e-03 3 1  ON 61
ci_0063                -9.201593e-03 3 1  ON 62
ci_0064                -8.557270e-03 3 1  ON 63
ci_0065                -6.655244e-03 3 1  ON 64
ci_0066                -6.874565e-03 3 1  ON 65
ci_0067                -6.043893e-03 3 1  ON 66
ci_0068                -6.239190e-03 3 1  ON 67
ci_0069                 5.309835e-03 3 1  ON 68
ci_0070                 5.442922e-03 3 1  ON 69
ci_0071                 4.215353e-03 3 1  ON 70
ci_0072                 5.161372e-03 3 1  ON 71
ci_0073                 5.150025e-03 3 1  ON 72
ci_0074                 5.507732e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0887e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6895e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.9343
    reference variance = 0.200515
====================================================
  Execution time = 1.4492e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5274e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3924e-01
  Total weights = 1.951961709e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5746e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319547459349
                                         uncertainty =       0.005806051360

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319547459349
                                         uncertainty =       0.005806051360

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399687391
  error estimate for blocks of size 2^( 2) =       0.000413664071
  error estimate for blocks of size 2^( 3) =       0.000427424464
  error estimate for blocks of size 2^( 4) =       0.000440214835
  error estimate for blocks of size 2^( 5) =       0.000451436902
  error estimate for blocks of size 2^( 6) =       0.000460034850
  error estimate for blocks of size 2^( 7) =       0.000466768014

      target function =                  N/A
              le_mean =     -16.904701690243
             les_mean =     286.108181946025
             stat err =       0.000454613650
             autocorr =       1.293731185911
              std dev =       0.565243329731
             le_variance =       0.319500021805


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690470169024e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+04, overlap shift 1.4901e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904701690270       residual = 2.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904701690750       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904701690731       residual = 4.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904701690732       residual = 4.59e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+04 is 4.000342e-08

solving harmonic davidson linear method for identity shift 5.9605e+04, overlap shift 5.9605e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904701690270       residual = 2.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904701690390       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904701690385       residual = 4.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904701690358       residual = 4.59e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.9605e+04 is 1.000095e-08

solving harmonic davidson linear method for identity shift 2.3842e+05, overlap shift 2.3842e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904701690270       residual = 2.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904701690300       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904701690298       residual = 4.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904701690298       residual = 4.59e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3842e+05 is 2.500244e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.177283 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7072e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046598e-02 3 1  ON 2
ci_0004                -3.091074e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479342e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987071e-02 3 1  ON 8
ci_0010                -2.025474e-02 3 1  ON 9
ci_0011                -1.478835e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604580e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616065e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423502e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258327e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905949e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184448e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121508e-02 3 1  ON 24
ci_0026                -1.121753e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145851e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049885e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934078e-02 3 1  ON 31
ci_0033                 9.744667e-03 3 1  ON 32
ci_0034                 1.064363e-02 3 1  ON 33
ci_0035                 6.625693e-03 3 1  ON 34
ci_0036                 4.428238e-03 3 1  ON 35
ci_0037                -1.147123e-02 3 1  ON 36
ci_0038                -1.067751e-02 3 1  ON 37
ci_0039                -4.226041e-03 3 1  ON 38
ci_0040                -4.038327e-03 3 1  ON 39
ci_0041                 8.592836e-03 3 1  ON 40
ci_0042                 8.387897e-03 3 1  ON 41
ci_0043                -1.322990e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145706e-03 3 1  ON 44
ci_0046                 7.906724e-03 3 1  ON 45
ci_0047                -3.628373e-03 3 1  ON 46
ci_0048                -3.173871e-03 3 1  ON 47
ci_0049                -6.782191e-03 3 1  ON 48
ci_0050                -5.925124e-03 3 1  ON 49
ci_0051                -4.459913e-03 3 1  ON 50
ci_0052                -4.596472e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939225e-03 3 1  ON 53
ci_0055                 6.416651e-03 3 1  ON 54
ci_0056                 6.766953e-03 3 1  ON 55
ci_0057                 5.652151e-03 3 1  ON 56
ci_0058                 4.681065e-03 3 1  ON 57
ci_0059                -5.819554e-03 3 1  ON 58
ci_0060                -5.905258e-03 3 1  ON 59
ci_0061                -3.686528e-03 3 1  ON 60
ci_0062                -4.027962e-03 3 1  ON 61
ci_0063                -9.201586e-03 3 1  ON 62
ci_0064                -8.557274e-03 3 1  ON 63
ci_0065                -6.655246e-03 3 1  ON 64
ci_0066                -6.874561e-03 3 1  ON 65
ci_0067                -6.043897e-03 3 1  ON 66
ci_0068                -6.239190e-03 3 1  ON 67
ci_0069                 5.309835e-03 3 1  ON 68
ci_0070                 5.442921e-03 3 1  ON 69
ci_0071                 4.215354e-03 3 1  ON 70
ci_0072                 5.161368e-03 3 1  ON 71
ci_0073                 5.150028e-03 3 1  ON 72
ci_0074                 5.507730e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.9065
    reference variance = 0.256014
====================================================
  Execution time = 1.4346e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2607e-01
  Total weights = 1.9520e+06
  Execution time = 1.8922e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314266053661
                                         uncertainty =       0.002297448822

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314266053661
                                         uncertainty =       0.002297448822

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396392338
  error estimate for blocks of size 2^( 2) =       0.000410350371
  error estimate for blocks of size 2^( 3) =       0.000424575389
  error estimate for blocks of size 2^( 4) =       0.000438000546
  error estimate for blocks of size 2^( 5) =       0.000448988295
  error estimate for blocks of size 2^( 6) =       0.000457691899
  error estimate for blocks of size 2^( 7) =       0.000463624878

      target function =                  N/A
              le_mean =     -16.904433797941
             les_mean =     286.085950131975
             stat err =       0.000452076405
             autocorr =       1.300688131201
              std dev =       0.560583420962
             le_variance =       0.314253771857

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314266074658
                                         uncertainty =       0.002297450097

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314266074658
                                         uncertainty =       0.002297450097

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396392352
  error estimate for blocks of size 2^( 2) =       0.000410350385
  error estimate for blocks of size 2^( 3) =       0.000424575402
  error estimate for blocks of size 2^( 4) =       0.000438000559
  error estimate for blocks of size 2^( 5) =       0.000448988309
  error estimate for blocks of size 2^( 6) =       0.000457691912
  error estimate for blocks of size 2^( 7) =       0.000463624891

      target function =                  N/A
              le_mean =     -16.904433798092
             les_mean =     286.085950160598
             stat err =       0.000452076418
             autocorr =       1.300688120149
              std dev =       0.560583439651
             le_variance =       0.314253792811

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314266064159
                                         uncertainty =       0.002297449459

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314266064159
                                         uncertainty =       0.002297449459

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396392345
  error estimate for blocks of size 2^( 2) =       0.000410350378
  error estimate for blocks of size 2^( 3) =       0.000424575396
  error estimate for blocks of size 2^( 4) =       0.000438000553
  error estimate for blocks of size 2^( 5) =       0.000448988302
  error estimate for blocks of size 2^( 6) =       0.000457691905
  error estimate for blocks of size 2^( 7) =       0.000463624885

      target function =                  N/A
              le_mean =     -16.904433798017
             les_mean =     286.085950146286
             stat err =       0.000452076411
             autocorr =       1.300688125676
              std dev =       0.560583430307
             le_variance =       0.314253782334

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314266054973
                                         uncertainty =       0.002297448901

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314266054973
                                         uncertainty =       0.002297448901

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396392339
  error estimate for blocks of size 2^( 2) =       0.000410350372
  error estimate for blocks of size 2^( 3) =       0.000424575390
  error estimate for blocks of size 2^( 4) =       0.000438000547
  error estimate for blocks of size 2^( 5) =       0.000448988296
  error estimate for blocks of size 2^( 6) =       0.000457691900
  error estimate for blocks of size 2^( 7) =       0.000463624879

      target function =                  N/A
              le_mean =     -16.904433797951
             les_mean =     286.085950133764
             stat err =       0.000452076405
             autocorr =       1.300688130507
              std dev =       0.560583422130
             le_variance =       0.314253773167


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904433797941        initial
     1.4901e+04     1.4901e+05             4.0003e-08       -16.904433798092  <--
     5.9605e+04     5.9605e+05             1.0001e-08       -16.904433798017
     2.3842e+05     2.3842e+06             2.5002e-09       -16.904433797951

*****************************************************************************
Applying the update for shift_i =   1.4901e+04     and shift_s =   1.4901e+05
*****************************************************************************

  Execution time = 2.3910e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428268e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0988e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6896e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.9017
    reference variance = 0.167785
====================================================
  Execution time = 1.4473e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5265e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2337e-01
  Total weights = 1.951531886e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5808e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311585407383
                                         uncertainty =       0.002506584056

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311585407383
                                         uncertainty =       0.002506584056

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394670070
  error estimate for blocks of size 2^( 2) =       0.000409064746
  error estimate for blocks of size 2^( 3) =       0.000423399578
  error estimate for blocks of size 2^( 4) =       0.000436376957
  error estimate for blocks of size 2^( 5) =       0.000447825688
  error estimate for blocks of size 2^( 6) =       0.000457410195
  error estimate for blocks of size 2^( 7) =       0.000464452557

      target function =                  N/A
              le_mean =     -16.904248720736
             les_mean =     286.076990400278
             stat err =       0.000451516349
             autocorr =       1.308815942863
              std dev =       0.558147765236
             le_variance =       0.311528927838


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690424872074e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+03, overlap shift 3.7253e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904248720744       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904248721295       residual = 9.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904248721270       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904248721268       residual = 1.25e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+03 is 1.038236e-07

solving harmonic davidson linear method for identity shift 1.4901e+04, overlap shift 1.4901e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904248720744       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904248720882       residual = 9.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904248720876       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904248720866       residual = 1.25e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+04 is 2.595701e-08

solving harmonic davidson linear method for identity shift 5.9605e+04, overlap shift 5.9605e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904248720744       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904248720778       residual = 9.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904248720777       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904248720777       residual = 1.25e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.9605e+04 is 6.489322e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.178601 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7059e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046600e-02 3 1  ON 2
ci_0004                -3.091074e-02 3 1  ON 3
ci_0005                -3.366170e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315550e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604578e-02 3 1  ON 12
ci_0014                 1.528608e-02 3 1  ON 13
ci_0015                 1.616062e-02 3 1  ON 14
ci_0016                 1.562232e-02 3 1  ON 15
ci_0017                 1.423499e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258325e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905941e-03 3 1  ON 20
ci_0022                 7.158942e-03 3 1  ON 21
ci_0023                -1.184446e-02 3 1  ON 22
ci_0024                -1.120259e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121757e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145851e-02 3 1  ON 27
ci_0029                -1.086530e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934076e-02 3 1  ON 31
ci_0033                 9.744693e-03 3 1  ON 32
ci_0034                 1.064361e-02 3 1  ON 33
ci_0035                 6.625707e-03 3 1  ON 34
ci_0036                 4.428290e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226024e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592826e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322990e-02 3 1  ON 42
ci_0044                -1.355867e-02 3 1  ON 43
ci_0045                 8.145696e-03 3 1  ON 44
ci_0046                 7.906741e-03 3 1  ON 45
ci_0047                -3.628359e-03 3 1  ON 46
ci_0048                -3.173882e-03 3 1  ON 47
ci_0049                -6.782194e-03 3 1  ON 48
ci_0050                -5.925143e-03 3 1  ON 49
ci_0051                -4.459931e-03 3 1  ON 50
ci_0052                -4.596463e-03 3 1  ON 51
ci_0053                -6.299856e-03 3 1  ON 52
ci_0054                -5.939229e-03 3 1  ON 53
ci_0055                 6.416647e-03 3 1  ON 54
ci_0056                 6.766950e-03 3 1  ON 55
ci_0057                 5.652167e-03 3 1  ON 56
ci_0058                 4.681078e-03 3 1  ON 57
ci_0059                -5.819548e-03 3 1  ON 58
ci_0060                -5.905270e-03 3 1  ON 59
ci_0061                -3.686520e-03 3 1  ON 60
ci_0062                -4.027957e-03 3 1  ON 61
ci_0063                -9.201548e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655261e-03 3 1  ON 64
ci_0066                -6.874536e-03 3 1  ON 65
ci_0067                -6.043915e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309836e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215356e-03 3 1  ON 70
ci_0072                 5.161346e-03 3 1  ON 71
ci_0073                 5.150041e-03 3 1  ON 72
ci_0074                 5.507717e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.9791
    reference variance = 0.457064
====================================================
  Execution time = 1.6193e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2449e-01
  Total weights = 1.9513e+06
  Execution time = 1.8895e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309684962750
                                         uncertainty =       0.002068023247

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309684962750
                                         uncertainty =       0.002068023247

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393643034
  error estimate for blocks of size 2^( 2) =       0.000407749843
  error estimate for blocks of size 2^( 3) =       0.000422063058
  error estimate for blocks of size 2^( 4) =       0.000435220231
  error estimate for blocks of size 2^( 5) =       0.000447194426
  error estimate for blocks of size 2^( 6) =       0.000455979864
  error estimate for blocks of size 2^( 7) =       0.000461240178

      target function =                  N/A
              le_mean =     -16.904629947931
             les_mean =     286.090999910114
             stat err =       0.000449908675
             autocorr =       1.306302002264
              std dev =       0.556695317645
             le_variance =       0.309909676687

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309684999509
                                         uncertainty =       0.002068024005

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309684999509
                                         uncertainty =       0.002068024005

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393643058
  error estimate for blocks of size 2^( 2) =       0.000407749865
  error estimate for blocks of size 2^( 3) =       0.000422063081
  error estimate for blocks of size 2^( 4) =       0.000435220254
  error estimate for blocks of size 2^( 5) =       0.000447194450
  error estimate for blocks of size 2^( 6) =       0.000455979889
  error estimate for blocks of size 2^( 7) =       0.000461240203

      target function =                  N/A
              le_mean =     -16.904629946290
             les_mean =     286.090999836080
             stat err =       0.000449908699
             autocorr =       1.306301988910
              std dev =       0.556695350683
             le_variance =       0.309909713472

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309684981130
                                         uncertainty =       0.002068023626

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309684981130
                                         uncertainty =       0.002068023626

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393643046
  error estimate for blocks of size 2^( 2) =       0.000407749854
  error estimate for blocks of size 2^( 3) =       0.000422063069
  error estimate for blocks of size 2^( 4) =       0.000435220242
  error estimate for blocks of size 2^( 5) =       0.000447194438
  error estimate for blocks of size 2^( 6) =       0.000455979877
  error estimate for blocks of size 2^( 7) =       0.000461240191

      target function =                  N/A
              le_mean =     -16.904629947111
             les_mean =     286.090999873077
             stat err =       0.000449908687
             autocorr =       1.306301995588
              std dev =       0.556695334164
             le_variance =       0.309909695081

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309684965048
                                         uncertainty =       0.002068023294

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309684965048
                                         uncertainty =       0.002068023294

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393643036
  error estimate for blocks of size 2^( 2) =       0.000407749844
  error estimate for blocks of size 2^( 3) =       0.000422063059
  error estimate for blocks of size 2^( 4) =       0.000435220232
  error estimate for blocks of size 2^( 5) =       0.000447194428
  error estimate for blocks of size 2^( 6) =       0.000455979866
  error estimate for blocks of size 2^( 7) =       0.000461240179

      target function =                  N/A
              le_mean =     -16.904629947828
             les_mean =     286.090999905482
             stat err =       0.000449908676
             autocorr =       1.306302001437
              std dev =       0.556695319710
             le_variance =       0.309909678987


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904629947931        initial  <--
     3.7253e+03     3.7253e+04             1.0382e-07       -16.904629946290
     1.4901e+04     1.4901e+05             2.5957e-08       -16.904629947111
     5.9605e+04     5.9605e+05             6.4893e-09       -16.904629947828

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 25.7338
  </log>
  <optVariables href="H2O.s025.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428268e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2798e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.921
    reference variance = 0.40005
====================================================
  Execution time = 1.4521e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5231e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2567e-01
  Total weights = 1.952011149e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5710e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315077027162
                                         uncertainty =       0.003114652745

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315077027162
                                         uncertainty =       0.003114652745

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396932321
  error estimate for blocks of size 2^( 2) =       0.000410855884
  error estimate for blocks of size 2^( 3) =       0.000424225318
  error estimate for blocks of size 2^( 4) =       0.000437640051
  error estimate for blocks of size 2^( 5) =       0.000448182245
  error estimate for blocks of size 2^( 6) =       0.000457172372
  error estimate for blocks of size 2^( 7) =       0.000460161424

      target function =                  N/A
              le_mean =     -16.904591279987
             les_mean =     286.090871523864
             stat err =       0.000450789023
             autocorr =       1.289774356409
              std dev =       0.561347071188
             le_variance =       0.315110534331


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690459127999e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+04, overlap shift 3.7253e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904591280006       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904591280176       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904591280185       residual = 2.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904591280183       residual = 2.22e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+04 is 1.162525e-08

solving harmonic davidson linear method for identity shift 1.4901e+05, overlap shift 1.4901e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904591280006       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904591280049       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904591280051       residual = 2.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904591280030       residual = 2.22e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+05 is 2.906323e-09

solving harmonic davidson linear method for identity shift 5.9605e+05, overlap shift 5.9605e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904591280006       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904591280017       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904591280017       residual = 2.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904591280083       residual = 2.22e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.9605e+05 is 7.265815e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.179867 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7097e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366170e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905947e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184446e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064363e-02 3 1  ON 33
ci_0035                 6.625705e-03 3 1  ON 34
ci_0036                 4.428271e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038338e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387900e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145694e-03 3 1  ON 44
ci_0046                 7.906736e-03 3 1  ON 45
ci_0047                -3.628365e-03 3 1  ON 46
ci_0048                -3.173884e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925137e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596473e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939228e-03 3 1  ON 53
ci_0055                 6.416651e-03 3 1  ON 54
ci_0056                 6.766954e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819560e-03 3 1  ON 58
ci_0060                -5.905255e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557287e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874549e-03 3 1  ON 65
ci_0067                -6.043906e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309836e-03 3 1  ON 68
ci_0070                 5.442917e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150041e-03 3 1  ON 72
ci_0074                 5.507725e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.9314
    reference variance = 1.07961
====================================================
  Execution time = 1.4023e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.2142e-01
  Total weights = 1.9516e+06
  Execution time = 1.8913e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311397389370
                                         uncertainty =       0.002211587365

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311397389370
                                         uncertainty =       0.002211587365

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394624230
  error estimate for blocks of size 2^( 2) =       0.000408751072
  error estimate for blocks of size 2^( 3) =       0.000423278212
  error estimate for blocks of size 2^( 4) =       0.000436568461
  error estimate for blocks of size 2^( 5) =       0.000446599282
  error estimate for blocks of size 2^( 6) =       0.000452643396
  error estimate for blocks of size 2^( 7) =       0.000459032687

      target function =                  N/A
              le_mean =     -16.903452557277
             les_mean =     286.048126218300
             stat err =       0.000448710957
             autocorr =       1.292902735567
              std dev =       0.558082937501
             le_variance =       0.311456565129

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311397392859
                                         uncertainty =       0.002211587432

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311397392859
                                         uncertainty =       0.002211587432

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394624232
  error estimate for blocks of size 2^( 2) =       0.000408751074
  error estimate for blocks of size 2^( 3) =       0.000423278214
  error estimate for blocks of size 2^( 4) =       0.000436568464
  error estimate for blocks of size 2^( 5) =       0.000446599285
  error estimate for blocks of size 2^( 6) =       0.000452643398
  error estimate for blocks of size 2^( 7) =       0.000459032689

      target function =                  N/A
              le_mean =     -16.903452557094
             les_mean =     286.048126216821
             stat err =       0.000448710959
             autocorr =       1.292902735806
              std dev =       0.558082940620
             le_variance =       0.311456568611

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311397391115
                                         uncertainty =       0.002211587398

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311397391115
                                         uncertainty =       0.002211587398

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394624231
  error estimate for blocks of size 2^( 2) =       0.000408751073
  error estimate for blocks of size 2^( 3) =       0.000423278213
  error estimate for blocks of size 2^( 4) =       0.000436568463
  error estimate for blocks of size 2^( 5) =       0.000446599284
  error estimate for blocks of size 2^( 6) =       0.000452643397
  error estimate for blocks of size 2^( 7) =       0.000459032688

      target function =                  N/A
              le_mean =     -16.903452557185
             les_mean =     286.048126217560
             stat err =       0.000448710958
             autocorr =       1.292902735687
              std dev =       0.558082939060
             le_variance =       0.311456566870

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311397389588
                                         uncertainty =       0.002211587369

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311397389588
                                         uncertainty =       0.002211587369

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394624230
  error estimate for blocks of size 2^( 2) =       0.000408751072
  error estimate for blocks of size 2^( 3) =       0.000423278212
  error estimate for blocks of size 2^( 4) =       0.000436568462
  error estimate for blocks of size 2^( 5) =       0.000446599283
  error estimate for blocks of size 2^( 6) =       0.000452643396
  error estimate for blocks of size 2^( 7) =       0.000459032687

      target function =                  N/A
              le_mean =     -16.903452557266
             les_mean =     286.048126218207
             stat err =       0.000448710957
             autocorr =       1.292902735571
              std dev =       0.558082937696
             le_variance =       0.311456565347


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.903452557277        initial  <--
     3.7253e+04     3.7253e+05             1.1625e-08       -16.903452557094
     1.4901e+05     1.4901e+06             2.9063e-09       -16.903452557185
     5.9605e+05     5.9605e+06             7.2658e-10       -16.903452557266

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.5429
  </log>
  <optVariables href="H2O.s026.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428268e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0645e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.923
    reference variance = 0.245165
====================================================
  Execution time = 1.4759e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5258e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.1920e-01
  Total weights = 1.951214610e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5751e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309092703005
                                         uncertainty =       0.002035973352

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309092703005
                                         uncertainty =       0.002035973352

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393076392
  error estimate for blocks of size 2^( 2) =       0.000406532217
  error estimate for blocks of size 2^( 3) =       0.000420734707
  error estimate for blocks of size 2^( 4) =       0.000433506561
  error estimate for blocks of size 2^( 5) =       0.000444310856
  error estimate for blocks of size 2^( 6) =       0.000452392388
  error estimate for blocks of size 2^( 7) =       0.000457400989

      target function =                  N/A
              le_mean =     -16.903749762284
             les_mean =     286.055960057740
             stat err =       0.000446902698
             autocorr =       1.292623452489
              std dev =       0.555893964773
             le_variance =       0.309018100071


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690374976228e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+05, overlap shift 3.7253e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903749762267       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903749762279       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.903749762279       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.903749762257       residual = 1.34e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+05 is 1.345779e-09

solving harmonic davidson linear method for identity shift 1.4901e+06, overlap shift 1.4901e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903749762267       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903749762270       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.903749762270       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.903749762270       residual = 1.34e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+06 is 3.364448e-10

solving harmonic davidson linear method for identity shift 5.9605e+06, overlap shift 5.9605e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903749762267       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903749762268       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.903749762268       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.903749762268       residual = 1.34e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.9605e+06 is 8.411123e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.181180 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7339e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226033e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592840e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681074e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655250e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442917e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.9413
    reference variance = 0.308609
====================================================
  Execution time = 1.3993e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2669e-01
  Total weights = 1.9519e+06
  Execution time = 1.8875e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310627958806
                                         uncertainty =       0.001859099178

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310627958806
                                         uncertainty =       0.001859099178

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394090843
  error estimate for blocks of size 2^( 2) =       0.000407980789
  error estimate for blocks of size 2^( 3) =       0.000421980187
  error estimate for blocks of size 2^( 4) =       0.000434635987
  error estimate for blocks of size 2^( 5) =       0.000443784867
  error estimate for blocks of size 2^( 6) =       0.000450029483
  error estimate for blocks of size 2^( 7) =       0.000453974978

      target function =                  N/A
              le_mean =     -16.904762589879
             les_mean =     286.097689277552
             stat err =       0.000445606329
             autocorr =       1.278527324127
              std dev =       0.557328614274
             le_variance =       0.310615184289

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310627959460
                                         uncertainty =       0.001859099234

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310627959460
                                         uncertainty =       0.001859099234

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394090843
  error estimate for blocks of size 2^( 2) =       0.000407980789
  error estimate for blocks of size 2^( 3) =       0.000421980187
  error estimate for blocks of size 2^( 4) =       0.000434635987
  error estimate for blocks of size 2^( 5) =       0.000443784867
  error estimate for blocks of size 2^( 6) =       0.000450029484
  error estimate for blocks of size 2^( 7) =       0.000453974978

      target function =                  N/A
              le_mean =     -16.904762589872
             les_mean =     286.097689282038
             stat err =       0.000445606329
             autocorr =       1.278527323559
              std dev =       0.557328614863
             le_variance =       0.310615184945

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310627959133
                                         uncertainty =       0.001859099206

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310627959133
                                         uncertainty =       0.001859099206

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394090843
  error estimate for blocks of size 2^( 2) =       0.000407980789
  error estimate for blocks of size 2^( 3) =       0.000421980187
  error estimate for blocks of size 2^( 4) =       0.000434635987
  error estimate for blocks of size 2^( 5) =       0.000443784867
  error estimate for blocks of size 2^( 6) =       0.000450029484
  error estimate for blocks of size 2^( 7) =       0.000453974978

      target function =                  N/A
              le_mean =     -16.904762589876
             les_mean =     286.097689279790
             stat err =       0.000445606329
             autocorr =       1.278527323843
              std dev =       0.557328614568
             le_variance =       0.310615184617

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310627958847
                                         uncertainty =       0.001859099181

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310627958847
                                         uncertainty =       0.001859099181

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394090843
  error estimate for blocks of size 2^( 2) =       0.000407980789
  error estimate for blocks of size 2^( 3) =       0.000421980187
  error estimate for blocks of size 2^( 4) =       0.000434635987
  error estimate for blocks of size 2^( 5) =       0.000443784867
  error estimate for blocks of size 2^( 6) =       0.000450029483
  error estimate for blocks of size 2^( 7) =       0.000453974978

      target function =                  N/A
              le_mean =     -16.904762589879
             les_mean =     286.097689277831
             stat err =       0.000445606329
             autocorr =       1.278527324083
              std dev =       0.557328614311
             le_variance =       0.310615184330


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904762589879        initial  <--
     3.7253e+05     3.7253e+06             1.3458e-09       -16.904762589872
     1.4901e+06     1.4901e+07             3.3644e-10       -16.904762589876
     5.9605e+06     5.9605e+07             8.4111e-11       -16.904762589879

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.5250
  </log>
  <optVariables href="H2O.s027.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428268e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0870e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.8755
    reference variance = 0.25645
====================================================
  Execution time = 1.4583e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5243e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2367e-01
  Total weights = 1.951938910e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5607e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310619585451
                                         uncertainty =       0.002001805379

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310619585451
                                         uncertainty =       0.002001805379

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394174670
  error estimate for blocks of size 2^( 2) =       0.000408180428
  error estimate for blocks of size 2^( 3) =       0.000422191333
  error estimate for blocks of size 2^( 4) =       0.000435527472
  error estimate for blocks of size 2^( 5) =       0.000445839376
  error estimate for blocks of size 2^( 6) =       0.000454616869
  error estimate for blocks of size 2^( 7) =       0.000459301291

      target function =                  N/A
              le_mean =     -16.904495528492
             les_mean =     286.085641314672
             stat err =       0.000448821252
             autocorr =       1.296490683774
              std dev =       0.557447163959
             le_variance =       0.310747340606


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690449552849e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+06, overlap shift 3.7253e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904495528542       residual = 2.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904495528543       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904495528543       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904495527716       residual = 1.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+06 is 1.543219e-10

solving harmonic davidson linear method for identity shift 1.4901e+07, overlap shift 1.4901e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904495528542       residual = 2.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904495528543       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904495528543       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904495528543       residual = 1.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+07 is 3.858049e-11

solving harmonic davidson linear method for identity shift 5.9605e+07, overlap shift 5.9605e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904495528542       residual = 2.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904495528543       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904495528543       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904495528543       residual = 1.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.9605e+07 is 9.645119e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.182508 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7149e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.9163
    reference variance = 0.245411
====================================================
  Execution time = 1.4054e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.1815e-01
  Total weights = 1.9519e+06
  Execution time = 1.8894e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307200905887
                                         uncertainty =       0.002036603485

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307200905887
                                         uncertainty =       0.002036603485

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391897569
  error estimate for blocks of size 2^( 2) =       0.000405848933
  error estimate for blocks of size 2^( 3) =       0.000419626417
  error estimate for blocks of size 2^( 4) =       0.000432929630
  error estimate for blocks of size 2^( 5) =       0.000443979882
  error estimate for blocks of size 2^( 6) =       0.000450279458
  error estimate for blocks of size 2^( 7) =       0.000454323130

      target function =                  N/A
              le_mean =     -16.904352361370
             les_mean =     286.075283348705
             stat err =       0.000445378025
             autocorr =       1.291553588766
              std dev =       0.554226857287
             le_variance =       0.307167409338

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307200905913
                                         uncertainty =       0.002036603486

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307200905913
                                         uncertainty =       0.002036603486

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391897569
  error estimate for blocks of size 2^( 2) =       0.000405848933
  error estimate for blocks of size 2^( 3) =       0.000419626417
  error estimate for blocks of size 2^( 4) =       0.000432929630
  error estimate for blocks of size 2^( 5) =       0.000443979882
  error estimate for blocks of size 2^( 6) =       0.000450279458
  error estimate for blocks of size 2^( 7) =       0.000454323130

      target function =                  N/A
              le_mean =     -16.904352361369
             les_mean =     286.075283348762
             stat err =       0.000445378025
             autocorr =       1.291553588752
              std dev =       0.554226857311
             le_variance =       0.307167409365

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307200905900
                                         uncertainty =       0.002036603486

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307200905900
                                         uncertainty =       0.002036603486

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391897569
  error estimate for blocks of size 2^( 2) =       0.000405848933
  error estimate for blocks of size 2^( 3) =       0.000419626417
  error estimate for blocks of size 2^( 4) =       0.000432929630
  error estimate for blocks of size 2^( 5) =       0.000443979882
  error estimate for blocks of size 2^( 6) =       0.000450279458
  error estimate for blocks of size 2^( 7) =       0.000454323130

      target function =                  N/A
              le_mean =     -16.904352361370
             les_mean =     286.075283348734
             stat err =       0.000445378025
             autocorr =       1.291553588762
              std dev =       0.554226857299
             le_variance =       0.307167409351

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307200905889
                                         uncertainty =       0.002036603485

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307200905889
                                         uncertainty =       0.002036603485

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391897569
  error estimate for blocks of size 2^( 2) =       0.000405848933
  error estimate for blocks of size 2^( 3) =       0.000419626417
  error estimate for blocks of size 2^( 4) =       0.000432929630
  error estimate for blocks of size 2^( 5) =       0.000443979882
  error estimate for blocks of size 2^( 6) =       0.000450279458
  error estimate for blocks of size 2^( 7) =       0.000454323130

      target function =                  N/A
              le_mean =     -16.904352361370
             les_mean =     286.075283348709
             stat err =       0.000445378025
             autocorr =       1.291553588786
              std dev =       0.554226857289
             le_variance =       0.307167409340


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904352361370        initial  <--
     3.7253e+06     3.7253e+07             1.5432e-10       -16.904352361369
     1.4901e+07     1.4901e+08             3.8580e-11       -16.904352361370
     5.9605e+07     5.9605e+08             9.6451e-12       -16.904352361370

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.6228
  </log>
  <optVariables href="H2O.s028.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428268e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0778e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.9097
    reference variance = 0.371328
====================================================
  Execution time = 1.4475e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5244e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2257e-01
  Total weights = 1.951779715e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5704e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310188779098
                                         uncertainty =       0.003659409791

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310188779098
                                         uncertainty =       0.003659409791

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393838661
  error estimate for blocks of size 2^( 2) =       0.000407596131
  error estimate for blocks of size 2^( 3) =       0.000421701382
  error estimate for blocks of size 2^( 4) =       0.000434559777
  error estimate for blocks of size 2^( 5) =       0.000444950497
  error estimate for blocks of size 2^( 6) =       0.000452491065
  error estimate for blocks of size 2^( 7) =       0.000456148856

      target function =                  N/A
              le_mean =     -16.904607853498
             les_mean =     286.088337318274
             stat err =       0.000447037549
             autocorr =       1.288401775135
              std dev =       0.556971975190
             le_variance =       0.310217781147


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690460785350e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+07, overlap shift 3.7253e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904607853502       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904607853503       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904607853503       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904607853503       residual = 1.74e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+07 is 1.004013e-11

solving harmonic davidson linear method for identity shift 1.4901e+08, overlap shift 1.4901e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904607853502       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904607853502       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904607853502       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904607853502       residual = 1.75e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+08 is 2.510100e-12

solving harmonic davidson linear method for identity shift 5.9605e+08, overlap shift 5.9605e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904607853502       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904607853502       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904607853502       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904607827078       residual = 1.74e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.9605e+08 is 6.274891e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.183748 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7050e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428268e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.1171
    reference variance = 0.795472
====================================================
  Execution time = 1.4313e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.1908e-01
  Total weights = 1.9518e+06
  Execution time = 1.9041e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309032227420
                                         uncertainty =       0.001985821134

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309032227420
                                         uncertainty =       0.001985821134

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393110877
  error estimate for blocks of size 2^( 2) =       0.000407203729
  error estimate for blocks of size 2^( 3) =       0.000421423113
  error estimate for blocks of size 2^( 4) =       0.000434173546
  error estimate for blocks of size 2^( 5) =       0.000444861805
  error estimate for blocks of size 2^( 6) =       0.000453591395
  error estimate for blocks of size 2^( 7) =       0.000457351299

      target function =                  N/A
              le_mean =     -16.904024098323
             les_mean =     286.065115432865
             stat err =       0.000447494511
             autocorr =       1.295821864595
              std dev =       0.555942734400
             le_variance =       0.309072323932

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309032227421
                                         uncertainty =       0.001985821134

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309032227421
                                         uncertainty =       0.001985821134

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393110877
  error estimate for blocks of size 2^( 2) =       0.000407203729
  error estimate for blocks of size 2^( 3) =       0.000421423113
  error estimate for blocks of size 2^( 4) =       0.000434173546
  error estimate for blocks of size 2^( 5) =       0.000444861805
  error estimate for blocks of size 2^( 6) =       0.000453591395
  error estimate for blocks of size 2^( 7) =       0.000457351299

      target function =                  N/A
              le_mean =     -16.904024098323
             les_mean =     286.065115432880
             stat err =       0.000447494511
             autocorr =       1.295821864592
              std dev =       0.555942734400
             le_variance =       0.309072323932

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309032227421
                                         uncertainty =       0.001985821134

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309032227421
                                         uncertainty =       0.001985821134

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393110877
  error estimate for blocks of size 2^( 2) =       0.000407203729
  error estimate for blocks of size 2^( 3) =       0.000421423113
  error estimate for blocks of size 2^( 4) =       0.000434173546
  error estimate for blocks of size 2^( 5) =       0.000444861805
  error estimate for blocks of size 2^( 6) =       0.000453591395
  error estimate for blocks of size 2^( 7) =       0.000457351299

      target function =                  N/A
              le_mean =     -16.904024098323
             les_mean =     286.065115432873
             stat err =       0.000447494511
             autocorr =       1.295821864596
              std dev =       0.555942734400
             le_variance =       0.309072323932

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309032227421
                                         uncertainty =       0.001985821134

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309032227421
                                         uncertainty =       0.001985821134

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393110877
  error estimate for blocks of size 2^( 2) =       0.000407203729
  error estimate for blocks of size 2^( 3) =       0.000421423113
  error estimate for blocks of size 2^( 4) =       0.000434173546
  error estimate for blocks of size 2^( 5) =       0.000444861805
  error estimate for blocks of size 2^( 6) =       0.000453591395
  error estimate for blocks of size 2^( 7) =       0.000457351299

      target function =                  N/A
              le_mean =     -16.904024098323
             les_mean =     286.065115432866
             stat err =       0.000447494511
             autocorr =       1.295821864596
              std dev =       0.555942734400
             le_variance =       0.309072323932


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904024098323        initial
     3.7253e+07     3.7253e+08             1.0040e-11       -16.904024098323  <--
     1.4901e+08     1.4901e+09             2.5101e-12       -16.904024098323
     5.9605e+08     5.9605e+09             6.2749e-13       -16.904024098323

*****************************************************************************
Applying the update for shift_i =   3.7253e+07     and shift_s =   3.7253e+08
*****************************************************************************

  Execution time = 2.3883e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0939e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.8918
    reference variance = 0.280832
====================================================
  Execution time = 1.4647e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5280e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2191e-01
  Total weights = 1.951541400e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5824e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307854279126
                                         uncertainty =       0.001815352596

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307854279126
                                         uncertainty =       0.001815352596

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392362206
  error estimate for blocks of size 2^( 2) =       0.000406229055
  error estimate for blocks of size 2^( 3) =       0.000419761492
  error estimate for blocks of size 2^( 4) =       0.000432586050
  error estimate for blocks of size 2^( 5) =       0.000443592739
  error estimate for blocks of size 2^( 6) =       0.000450256928
  error estimate for blocks of size 2^( 7) =       0.000456272289

      target function =                  N/A
              le_mean =     -16.904418206265
             les_mean =     286.081269496462
             stat err =       0.000445677001
             autocorr =       1.290226959876
              std dev =       0.554883952700
             le_variance =       0.307896200964


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690441820627e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+06, overlap shift 9.3132e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904418206274       residual = 1.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904418206275       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904418206275       residual = 3.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904418206584       residual = 3.56e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e+06 is 3.594641e-11

solving harmonic davidson linear method for identity shift 3.7253e+07, overlap shift 3.7253e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904418206274       residual = 1.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904418206274       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904418206274       residual = 3.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904418206274       residual = 3.56e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+07 is 8.986605e-12

solving harmonic davidson linear method for identity shift 1.4901e+08, overlap shift 1.4901e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904418206274       residual = 1.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904418206274       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904418206274       residual = 3.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904418206274       residual = 3.56e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+08 is 2.246623e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.185057 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7234e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.9379
    reference variance = 0.374321
====================================================
  Execution time = 1.4258e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.2097e-01
  Total weights = 1.9518e+06
  Execution time = 1.8828e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310112200426
                                         uncertainty =       0.002005769288

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310112200426
                                         uncertainty =       0.002005769288

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393816080
  error estimate for blocks of size 2^( 2) =       0.000408456757
  error estimate for blocks of size 2^( 3) =       0.000423241522
  error estimate for blocks of size 2^( 4) =       0.000436588780
  error estimate for blocks of size 2^( 5) =       0.000447604340
  error estimate for blocks of size 2^( 6) =       0.000455688906
  error estimate for blocks of size 2^( 7) =       0.000462008789

      target function =                  N/A
              le_mean =     -16.903335903912
             les_mean =     286.043731296142
             stat err =       0.000450472704
             autocorr =       1.308428727667
              std dev =       0.556940041138
             le_variance =       0.310182209423

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310112200439
                                         uncertainty =       0.002005769287

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310112200439
                                         uncertainty =       0.002005769287

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393816080
  error estimate for blocks of size 2^( 2) =       0.000408456757
  error estimate for blocks of size 2^( 3) =       0.000423241522
  error estimate for blocks of size 2^( 4) =       0.000436588780
  error estimate for blocks of size 2^( 5) =       0.000447604340
  error estimate for blocks of size 2^( 6) =       0.000455688906
  error estimate for blocks of size 2^( 7) =       0.000462008789

      target function =                  N/A
              le_mean =     -16.903335903912
             les_mean =     286.043731296162
             stat err =       0.000450472704
             autocorr =       1.308428727675
              std dev =       0.556940041150
             le_variance =       0.310182209436

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310112200433
                                         uncertainty =       0.002005769288

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310112200433
                                         uncertainty =       0.002005769288

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393816080
  error estimate for blocks of size 2^( 2) =       0.000408456757
  error estimate for blocks of size 2^( 3) =       0.000423241522
  error estimate for blocks of size 2^( 4) =       0.000436588780
  error estimate for blocks of size 2^( 5) =       0.000447604340
  error estimate for blocks of size 2^( 6) =       0.000455688906
  error estimate for blocks of size 2^( 7) =       0.000462008789

      target function =                  N/A
              le_mean =     -16.903335903912
             les_mean =     286.043731296152
             stat err =       0.000450472704
             autocorr =       1.308428727678
              std dev =       0.556940041144
             le_variance =       0.310182209430

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310112200427
                                         uncertainty =       0.002005769288

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310112200427
                                         uncertainty =       0.002005769288

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393816080
  error estimate for blocks of size 2^( 2) =       0.000408456757
  error estimate for blocks of size 2^( 3) =       0.000423241522
  error estimate for blocks of size 2^( 4) =       0.000436588780
  error estimate for blocks of size 2^( 5) =       0.000447604340
  error estimate for blocks of size 2^( 6) =       0.000455688906
  error estimate for blocks of size 2^( 7) =       0.000462008789

      target function =                  N/A
              le_mean =     -16.903335903912
             les_mean =     286.043731296143
             stat err =       0.000450472704
             autocorr =       1.308428727670
              std dev =       0.556940041139
             le_variance =       0.310182209424


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.903335903912        initial  <--
     9.3132e+06     9.3132e+07             3.5946e-11       -16.903335903912
     3.7253e+07     3.7253e+08             8.9866e-12       -16.903335903912
     1.4901e+08     1.4901e+09             2.2466e-12       -16.903335903912

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.7789
  </log>
  <optVariables href="H2O.s030.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1018e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.8274
    reference variance = 0.22801
====================================================
  Execution time = 1.4722e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5242e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2248e-01
  Total weights = 1.951799325e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5686e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310491859353
                                         uncertainty =       0.001925572311

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310491859353
                                         uncertainty =       0.001925572311

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393987445
  error estimate for blocks of size 2^( 2) =       0.000408062756
  error estimate for blocks of size 2^( 3) =       0.000422120277
  error estimate for blocks of size 2^( 4) =       0.000434722981
  error estimate for blocks of size 2^( 5) =       0.000445922450
  error estimate for blocks of size 2^( 6) =       0.000452981167
  error estimate for blocks of size 2^( 7) =       0.000458607604

      target function =                  N/A
              le_mean =     -16.904948078175
             les_mean =     286.099750597258
             stat err =       0.000448058551
             autocorr =       1.293316371630
              std dev =       0.557182387477
             le_variance =       0.310452212914


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690494807817e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+07, overlap shift 9.3132e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904948078179       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904948078179       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904948078179       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904948078179       residual = 2.01e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e+07 is 5.098183e-12

solving harmonic davidson linear method for identity shift 3.7253e+08, overlap shift 3.7253e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904948078179       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904948078179       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904948078179       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904948078179       residual = 2.01e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+08 is 1.274544e-12

solving harmonic davidson linear method for identity shift 1.4901e+09, overlap shift 1.4901e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904948078179       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904948078179       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904948078179       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904948078179       residual = 2.08e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+09 is 3.186226e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.186377 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7299e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.8799
    reference variance = 0.171626
====================================================
  Execution time = 1.4283e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2626e-01
  Total weights = 1.9517e+06
  Execution time = 1.8817e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312868588680
                                         uncertainty =       0.001949633294

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312868588680
                                         uncertainty =       0.001949633294

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395481731
  error estimate for blocks of size 2^( 2) =       0.000409130778
  error estimate for blocks of size 2^( 3) =       0.000423725532
  error estimate for blocks of size 2^( 4) =       0.000437559068
  error estimate for blocks of size 2^( 5) =       0.000449651814
  error estimate for blocks of size 2^( 6) =       0.000459087759
  error estimate for blocks of size 2^( 7) =       0.000465382806

      target function =                  N/A
              le_mean =     -16.903923085250
             les_mean =     286.068871319754
             stat err =       0.000452920362
             autocorr =       1.311568080099
              std dev =       0.559295627639
             le_variance =       0.312811599096

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312868588680
                                         uncertainty =       0.001949633294

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312868588680
                                         uncertainty =       0.001949633294

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395481731
  error estimate for blocks of size 2^( 2) =       0.000409130778
  error estimate for blocks of size 2^( 3) =       0.000423725532
  error estimate for blocks of size 2^( 4) =       0.000437559068
  error estimate for blocks of size 2^( 5) =       0.000449651814
  error estimate for blocks of size 2^( 6) =       0.000459087759
  error estimate for blocks of size 2^( 7) =       0.000465382806

      target function =                  N/A
              le_mean =     -16.903923085250
             les_mean =     286.068871319755
             stat err =       0.000452920362
             autocorr =       1.311568080093
              std dev =       0.559295627639
             le_variance =       0.312811599096

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312868588680
                                         uncertainty =       0.001949633294

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312868588680
                                         uncertainty =       0.001949633294

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395481731
  error estimate for blocks of size 2^( 2) =       0.000409130778
  error estimate for blocks of size 2^( 3) =       0.000423725532
  error estimate for blocks of size 2^( 4) =       0.000437559068
  error estimate for blocks of size 2^( 5) =       0.000449651814
  error estimate for blocks of size 2^( 6) =       0.000459087759
  error estimate for blocks of size 2^( 7) =       0.000465382806

      target function =                  N/A
              le_mean =     -16.903923085250
             les_mean =     286.068871319754
             stat err =       0.000452920362
             autocorr =       1.311568080089
              std dev =       0.559295627639
             le_variance =       0.312811599096

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312868588680
                                         uncertainty =       0.001949633294

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312868588680
                                         uncertainty =       0.001949633294

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395481731
  error estimate for blocks of size 2^( 2) =       0.000409130778
  error estimate for blocks of size 2^( 3) =       0.000423725532
  error estimate for blocks of size 2^( 4) =       0.000437559068
  error estimate for blocks of size 2^( 5) =       0.000449651814
  error estimate for blocks of size 2^( 6) =       0.000459087759
  error estimate for blocks of size 2^( 7) =       0.000465382806

      target function =                  N/A
              le_mean =     -16.903923085250
             les_mean =     286.068871319754
             stat err =       0.000452920362
             autocorr =       1.311568080095
              std dev =       0.559295627639
             le_variance =       0.312811599096


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.903923085250        initial  <--
     9.3132e+07     9.3132e+08             5.0982e-12       -16.903923085250
     3.7253e+08     3.7253e+09             1.2745e-12       -16.903923085250
     1.4901e+09     1.4901e+10             3.1862e-13       -16.903923085250

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.8207
  </log>
  <optVariables href="H2O.s031.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1124e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.9732
    reference variance = 0.289213
====================================================
  Execution time = 1.4770e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5257e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2428e-01
  Total weights = 1.951597918e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5536e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311859401213
                                         uncertainty =       0.001819684306

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311859401213
                                         uncertainty =       0.001819684306

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394869490
  error estimate for blocks of size 2^( 2) =       0.000408491074
  error estimate for blocks of size 2^( 3) =       0.000422620673
  error estimate for blocks of size 2^( 4) =       0.000435427888
  error estimate for blocks of size 2^( 5) =       0.000446248070
  error estimate for blocks of size 2^( 6) =       0.000453738204
  error estimate for blocks of size 2^( 7) =       0.000458290262

      target function =                  N/A
              le_mean =     -16.904212077687
             les_mean =     286.076670402782
             stat err =       0.000448426106
             autocorr =       1.289658180148
              std dev =       0.558429788723
             le_variance =       0.311843828933


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690421207769e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+08, overlap shift 9.3132e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904212077714       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904212077714       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904212077714       residual = 1.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904212077714       residual = 1.44e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e+08 is 4.749762e-13

solving harmonic davidson linear method for identity shift 3.7253e+09, overlap shift 3.7253e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904212077714       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904212077714       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904212077714       residual = 1.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904211868537       residual = 1.59e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+09 is 1.186892e-13

solving harmonic davidson linear method for identity shift 1.4901e+10, overlap shift 1.4901e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904212077714       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904212077714       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904212077714       residual = 1.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904211958253       residual = 3.09e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+10 is 2.967000e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.187654 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7329e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.9159
    reference variance = 0.240406
====================================================
  Execution time = 1.4039e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2078e-01
  Total weights = 1.9515e+06
  Execution time = 1.8874e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310915214933
                                         uncertainty =       0.001874157580

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310915214933
                                         uncertainty =       0.001874157580

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394296311
  error estimate for blocks of size 2^( 2) =       0.000408534185
  error estimate for blocks of size 2^( 3) =       0.000422501326
  error estimate for blocks of size 2^( 4) =       0.000435566050
  error estimate for blocks of size 2^( 5) =       0.000446530790
  error estimate for blocks of size 2^( 6) =       0.000455990456
  error estimate for blocks of size 2^( 7) =       0.000462622305

      target function =                  N/A
              le_mean =     -16.904009937989
             les_mean =     286.066327411040
             stat err =       0.000450177400
             autocorr =       1.303532762341
              std dev =       0.557619189930
             le_variance =       0.310939160978

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310915214933
                                         uncertainty =       0.001874157580

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310915214933
                                         uncertainty =       0.001874157580

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394296311
  error estimate for blocks of size 2^( 2) =       0.000408534185
  error estimate for blocks of size 2^( 3) =       0.000422501326
  error estimate for blocks of size 2^( 4) =       0.000435566050
  error estimate for blocks of size 2^( 5) =       0.000446530790
  error estimate for blocks of size 2^( 6) =       0.000455990456
  error estimate for blocks of size 2^( 7) =       0.000462622305

      target function =                  N/A
              le_mean =     -16.904009937989
             les_mean =     286.066327411041
             stat err =       0.000450177400
             autocorr =       1.303532762344
              std dev =       0.557619189930
             le_variance =       0.310939160978

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310915214933
                                         uncertainty =       0.001874157580

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310915214933
                                         uncertainty =       0.001874157580

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394296311
  error estimate for blocks of size 2^( 2) =       0.000408534185
  error estimate for blocks of size 2^( 3) =       0.000422501326
  error estimate for blocks of size 2^( 4) =       0.000435566050
  error estimate for blocks of size 2^( 5) =       0.000446530790
  error estimate for blocks of size 2^( 6) =       0.000455990456
  error estimate for blocks of size 2^( 7) =       0.000462622305

      target function =                  N/A
              le_mean =     -16.904009937989
             les_mean =     286.066327411041
             stat err =       0.000450177400
             autocorr =       1.303532762344
              std dev =       0.557619189930
             le_variance =       0.310939160978

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310915214933
                                         uncertainty =       0.001874157580

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310915214933
                                         uncertainty =       0.001874157580

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394296311
  error estimate for blocks of size 2^( 2) =       0.000408534185
  error estimate for blocks of size 2^( 3) =       0.000422501326
  error estimate for blocks of size 2^( 4) =       0.000435566050
  error estimate for blocks of size 2^( 5) =       0.000446530790
  error estimate for blocks of size 2^( 6) =       0.000455990456
  error estimate for blocks of size 2^( 7) =       0.000462622305

      target function =                  N/A
              le_mean =     -16.904009937989
             les_mean =     286.066327411040
             stat err =       0.000450177400
             autocorr =       1.303532762341
              std dev =       0.557619189930
             le_variance =       0.310939160978


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904009937989        initial  <--
     9.3132e+08     9.3132e+09             4.7498e-13       -16.904009937989
     3.7253e+09     3.7253e+10             1.1869e-13       -16.904009937989
     1.4901e+10     1.4901e+11             2.9670e-14       -16.904009937989

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 27.5835
  </log>
  <optVariables href="H2O.s032.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.4918e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.876
    reference variance = 0.320743
====================================================
  Execution time = 1.4469e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5264e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2018e-01
  Total weights = 1.951793321e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5643e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309137380921
                                         uncertainty =       0.002164252267

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309137380921
                                         uncertainty =       0.002164252267

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393115200
  error estimate for blocks of size 2^( 2) =       0.000407628864
  error estimate for blocks of size 2^( 3) =       0.000422395495
  error estimate for blocks of size 2^( 4) =       0.000436730729
  error estimate for blocks of size 2^( 5) =       0.000449413617
  error estimate for blocks of size 2^( 6) =       0.000459694649
  error estimate for blocks of size 2^( 7) =       0.000464752878

      target function =                  N/A
              le_mean =     -16.904299582646
             les_mean =     286.075524279422
             stat err =       0.000452647968
             autocorr =       1.325810571281
              std dev =       0.555948847830
             le_variance =       0.309079121404


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690429958265e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+09, overlap shift 9.3132e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904299582671       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904299582671       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904299582671       residual = 1.00e-08           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e+09 is 3.825544e-14

solving harmonic davidson linear method for identity shift 3.7253e+10, overlap shift 3.7253e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904299582671       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904299582671       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904299582671       residual = 1.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904297505804       residual = 2.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+10 is 9.646486e-15

solving harmonic davidson linear method for identity shift 1.4901e+11, overlap shift 1.4901e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904299582671       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904299582671       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904299582671       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904299582671       residual = 8.99e-11           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+11 is 2.409784e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.188885 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7039e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.9036
    reference variance = 0.329812
====================================================
  Execution time = 1.4114e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2427e-01
  Total weights = 1.9514e+06
  Execution time = 1.8783e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310859405396
                                         uncertainty =       0.001733137741

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310859405396
                                         uncertainty =       0.001733137741

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394214183
  error estimate for blocks of size 2^( 2) =       0.000408221814
  error estimate for blocks of size 2^( 3) =       0.000422722543
  error estimate for blocks of size 2^( 4) =       0.000435739857
  error estimate for blocks of size 2^( 5) =       0.000446753552
  error estimate for blocks of size 2^( 6) =       0.000454102630
  error estimate for blocks of size 2^( 7) =       0.000457917099

      target function =                  N/A
              le_mean =     -16.903625041950
             les_mean =     286.056805555227
             stat err =       0.000448628285
             autocorr =       1.295116426058
              std dev =       0.557503044241
             le_variance =       0.310809644338

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310859405396
                                         uncertainty =       0.001733137741

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310859405396
                                         uncertainty =       0.001733137741

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394214183
  error estimate for blocks of size 2^( 2) =       0.000408221814
  error estimate for blocks of size 2^( 3) =       0.000422722543
  error estimate for blocks of size 2^( 4) =       0.000435739857
  error estimate for blocks of size 2^( 5) =       0.000446753552
  error estimate for blocks of size 2^( 6) =       0.000454102630
  error estimate for blocks of size 2^( 7) =       0.000457917099

      target function =                  N/A
              le_mean =     -16.903625041950
             les_mean =     286.056805555227
             stat err =       0.000448628285
             autocorr =       1.295116426055
              std dev =       0.557503044241
             le_variance =       0.310809644338

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310859405396
                                         uncertainty =       0.001733137741

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310859405396
                                         uncertainty =       0.001733137741

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394214183
  error estimate for blocks of size 2^( 2) =       0.000408221814
  error estimate for blocks of size 2^( 3) =       0.000422722543
  error estimate for blocks of size 2^( 4) =       0.000435739857
  error estimate for blocks of size 2^( 5) =       0.000446753552
  error estimate for blocks of size 2^( 6) =       0.000454102630
  error estimate for blocks of size 2^( 7) =       0.000457917099

      target function =                  N/A
              le_mean =     -16.903625041950
             les_mean =     286.056805555227
             stat err =       0.000448628285
             autocorr =       1.295116426055
              std dev =       0.557503044241
             le_variance =       0.310809644338

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310859405396
                                         uncertainty =       0.001733137741

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310859405396
                                         uncertainty =       0.001733137741

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394214183
  error estimate for blocks of size 2^( 2) =       0.000408221814
  error estimate for blocks of size 2^( 3) =       0.000422722543
  error estimate for blocks of size 2^( 4) =       0.000435739857
  error estimate for blocks of size 2^( 5) =       0.000446753552
  error estimate for blocks of size 2^( 6) =       0.000454102630
  error estimate for blocks of size 2^( 7) =       0.000457917099

      target function =                  N/A
              le_mean =     -16.903625041950
             les_mean =     286.056805555227
             stat err =       0.000448628285
             autocorr =       1.295116426058
              std dev =       0.557503044241
             le_variance =       0.310809644338


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.903625041950        initial  <--
     9.3132e+09     9.3132e+10             3.8255e-14       -16.903625041950
     3.7253e+10     3.7253e+11             9.6465e-15       -16.903625041950
     1.4901e+11     1.4901e+12             2.4098e-15       -16.903625041950

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.6000
  </log>
  <optVariables href="H2O.s033.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0644e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.922
    reference variance = 0.205499
====================================================
  Execution time = 1.4631e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5247e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2446e-01
  Total weights = 1.951749490e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5582e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312605138633
                                         uncertainty =       0.001981205617

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312605138633
                                         uncertainty =       0.001981205617

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395355013
  error estimate for blocks of size 2^( 2) =       0.000409350110
  error estimate for blocks of size 2^( 3) =       0.000423816623
  error estimate for blocks of size 2^( 4) =       0.000436472419
  error estimate for blocks of size 2^( 5) =       0.000447764006
  error estimate for blocks of size 2^( 6) =       0.000456283334
  error estimate for blocks of size 2^( 7) =       0.000460026564

      target function =                  N/A
              le_mean =     -16.904384727990
             les_mean =     286.082685048617
             stat err =       0.000450136581
             autocorr =       1.296325655836
              std dev =       0.559116420819
             le_variance =       0.312611172029


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690438472799e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+10, overlap shift 9.3132e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904384727990       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904384727990       residual = 8.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904384727990       residual = 3.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904384727990       residual = 3.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904422586508       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904325149822       residual = 8.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e+10 is 4.057515e-15

solving harmonic davidson linear method for identity shift 3.7253e+11, overlap shift 3.7253e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904384727990       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904384727990       residual = 8.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904384727990       residual = 3.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904384727990       residual = 3.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904263741341       residual = 7.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904440535378       residual = 5.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904231143360       residual = 4.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904136640442       residual = 2.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.882689140099       residual = 7.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.903722916516       residual = 6.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.902044620129       residual = 6.97e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.903941990213       residual = 1.54e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.757936808246       residual = 5.80e+00           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.356140820766       residual = 2.95e+00           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.990618289534       residual = 4.15e-01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.849220420320       residual = 4.58e+00           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.448031648076       residual = 2.53e+00           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -10.501353383635       residual = 5.92e+02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -15.567410592358       residual = 2.47e+02           smallest_sin_value = 1.00e+00
davidson iteration   19 stopping due to too large eigenvalue change
davidson solver did not converge after         19 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+11 is 1.028581e-15

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4901e+12, overlap shift 1.4901e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904384727990       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904384727990       residual = 8.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904384727990       residual = 3.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904384727990       residual = 3.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906613752598       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904384727990       residual = 3.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904012348500       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911419094876       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.917018055966       residual = 1.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908798225590       residual = 2.14e-02           smallest_sin_value = 1.00e+00
davidson iteration   10 stopping due to too large eigenvalue change
davidson solver did not converge after         10 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+12 is 2.571454e-16

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.196986 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7202e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.9412
    reference variance = 0.287707
====================================================
  Execution time = 1.3971e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2864e-01
  Total weights = 1.9519e+06
  Execution time = 1.8926e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314548104698
                                         uncertainty =       0.002755700788

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314548104698
                                         uncertainty =       0.002755700788

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396535113
  error estimate for blocks of size 2^( 2) =       0.000410371968
  error estimate for blocks of size 2^( 3) =       0.000423920483
  error estimate for blocks of size 2^( 4) =       0.000436058251
  error estimate for blocks of size 2^( 5) =       0.000445978687
  error estimate for blocks of size 2^( 6) =       0.000453024664
  error estimate for blocks of size 2^( 7) =       0.000456167219

      target function =                  N/A
              le_mean =     -16.903810382922
             les_mean =     286.067449670841
             stat err =       0.000447807205
             autocorr =       1.275319069201
              std dev =       0.560785334911
             le_variance =       0.314480191851

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314548104698
                                         uncertainty =       0.002755700788

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314548104698
                                         uncertainty =       0.002755700788

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396535113
  error estimate for blocks of size 2^( 2) =       0.000410371968
  error estimate for blocks of size 2^( 3) =       0.000423920483
  error estimate for blocks of size 2^( 4) =       0.000436058251
  error estimate for blocks of size 2^( 5) =       0.000445978687
  error estimate for blocks of size 2^( 6) =       0.000453024664
  error estimate for blocks of size 2^( 7) =       0.000456167219

      target function =                  N/A
              le_mean =     -16.903810382922
             les_mean =     286.067449670841
             stat err =       0.000447807205
             autocorr =       1.275319069203
              std dev =       0.560785334911
             le_variance =       0.314480191851

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314548104698
                                         uncertainty =       0.002755700788

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314548104698
                                         uncertainty =       0.002755700788

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396535113
  error estimate for blocks of size 2^( 2) =       0.000410371968
  error estimate for blocks of size 2^( 3) =       0.000423920483
  error estimate for blocks of size 2^( 4) =       0.000436058251
  error estimate for blocks of size 2^( 5) =       0.000445978687
  error estimate for blocks of size 2^( 6) =       0.000453024664
  error estimate for blocks of size 2^( 7) =       0.000456167219

      target function =                  N/A
              le_mean =     -16.903810382922
             les_mean =     286.067449670841
             stat err =       0.000447807205
             autocorr =       1.275319069203
              std dev =       0.560785334911
             le_variance =       0.314480191851

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314548104698
                                         uncertainty =       0.002755700788

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314548104698
                                         uncertainty =       0.002755700788

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396535113
  error estimate for blocks of size 2^( 2) =       0.000410371968
  error estimate for blocks of size 2^( 3) =       0.000423920483
  error estimate for blocks of size 2^( 4) =       0.000436058251
  error estimate for blocks of size 2^( 5) =       0.000445978687
  error estimate for blocks of size 2^( 6) =       0.000453024664
  error estimate for blocks of size 2^( 7) =       0.000456167219

      target function =                  N/A
              le_mean =     -16.903810382922
             les_mean =     286.067449670841
             stat err =       0.000447807205
             autocorr =       1.275319069203
              std dev =       0.560785334911
             le_variance =       0.314480191851


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.903810382922        initial  <--
     9.3132e+10     9.3132e+11             4.0575e-15       -16.903810382922
     3.7253e+11     3.7253e+12             1.0286e-15       -16.903810382922
     1.4901e+12     1.4901e+13             2.5715e-16       -16.903810382922

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.5281
  </log>
  <optVariables href="H2O.s034.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0740e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.8732
    reference variance = 0.669684
====================================================
  Execution time = 1.4704e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5227e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2446e-01
  Total weights = 1.952162007e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5724e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310177972412
                                         uncertainty =       0.001870562780

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310177972412
                                         uncertainty =       0.001870562780

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393783154
  error estimate for blocks of size 2^( 2) =       0.000407497868
  error estimate for blocks of size 2^( 3) =       0.000421985227
  error estimate for blocks of size 2^( 4) =       0.000434832350
  error estimate for blocks of size 2^( 5) =       0.000446459531
  error estimate for blocks of size 2^( 6) =       0.000454050153
  error estimate for blocks of size 2^( 7) =       0.000458769432

      target function =                  N/A
              le_mean =     -16.904505622681
             les_mean =     286.086766029010
             stat err =       0.000448527866
             autocorr =       1.297372220169
              std dev =       0.556893476848
             le_variance =       0.310130344556


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690450562268e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+11, overlap shift 9.3132e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904505622694       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904505622694       residual = 9.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904505622694       residual = 9.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e+11 is 5.839591e-16

solving harmonic davidson linear method for identity shift 3.7253e+12, overlap shift 3.7253e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904505622694       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904505622694       residual = 9.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904505622694       residual = 9.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+12 is 1.459898e-16

solving harmonic davidson linear method for identity shift 1.4901e+13, overlap shift 1.4901e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904505622694       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904505622694       residual = 9.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904505622694       residual = 9.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+13 is 3.649744e-17

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.200834 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7287e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.9008
    reference variance = 0.204518
====================================================
  Execution time = 1.3999e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.1854e-01
  Total weights = 1.9515e+06
  Execution time = 1.8844e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308711343688
                                         uncertainty =       0.001949992662

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308711343688
                                         uncertainty =       0.001949992662

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392929473
  error estimate for blocks of size 2^( 2) =       0.000406629242
  error estimate for blocks of size 2^( 3) =       0.000420698114
  error estimate for blocks of size 2^( 4) =       0.000433392371
  error estimate for blocks of size 2^( 5) =       0.000444720120
  error estimate for blocks of size 2^( 6) =       0.000453937760
  error estimate for blocks of size 2^( 7) =       0.000456605156

      target function =                  N/A
              le_mean =     -16.904617143260
             les_mean =     286.084622037486
             stat err =       0.000447163852
             autocorr =       1.295102569196
              std dev =       0.555686189929
             le_variance =       0.308787141678

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308711343688
                                         uncertainty =       0.001949992662

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308711343688
                                         uncertainty =       0.001949992662

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392929473
  error estimate for blocks of size 2^( 2) =       0.000406629242
  error estimate for blocks of size 2^( 3) =       0.000420698114
  error estimate for blocks of size 2^( 4) =       0.000433392371
  error estimate for blocks of size 2^( 5) =       0.000444720120
  error estimate for blocks of size 2^( 6) =       0.000453937760
  error estimate for blocks of size 2^( 7) =       0.000456605156

      target function =                  N/A
              le_mean =     -16.904617143260
             les_mean =     286.084622037487
             stat err =       0.000447163852
             autocorr =       1.295102569199
              std dev =       0.555686189929
             le_variance =       0.308787141678

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308711343688
                                         uncertainty =       0.001949992662

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308711343688
                                         uncertainty =       0.001949992662

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392929473
  error estimate for blocks of size 2^( 2) =       0.000406629242
  error estimate for blocks of size 2^( 3) =       0.000420698114
  error estimate for blocks of size 2^( 4) =       0.000433392371
  error estimate for blocks of size 2^( 5) =       0.000444720120
  error estimate for blocks of size 2^( 6) =       0.000453937760
  error estimate for blocks of size 2^( 7) =       0.000456605156

      target function =                  N/A
              le_mean =     -16.904617143260
             les_mean =     286.084622037486
             stat err =       0.000447163852
             autocorr =       1.295102569196
              std dev =       0.555686189929
             le_variance =       0.308787141678

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308711343688
                                         uncertainty =       0.001949992662

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308711343688
                                         uncertainty =       0.001949992662

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392929473
  error estimate for blocks of size 2^( 2) =       0.000406629242
  error estimate for blocks of size 2^( 3) =       0.000420698114
  error estimate for blocks of size 2^( 4) =       0.000433392371
  error estimate for blocks of size 2^( 5) =       0.000444720120
  error estimate for blocks of size 2^( 6) =       0.000453937760
  error estimate for blocks of size 2^( 7) =       0.000456605156

      target function =                  N/A
              le_mean =     -16.904617143260
             les_mean =     286.084622037487
             stat err =       0.000447163852
             autocorr =       1.295102569196
              std dev =       0.555686189929
             le_variance =       0.308787141678


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904617143260        initial  <--
     9.3132e+11     9.3132e+12             5.8396e-16       -16.904617143260
     3.7253e+12     3.7253e+13             1.4599e-16       -16.904617143260
     1.4901e+13     1.4901e+14             3.6497e-17       -16.904617143260

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.5283
  </log>
  <optVariables href="H2O.s035.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0831e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.0069
    reference variance = 0.256379
====================================================
  Execution time = 1.4444e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5246e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2078e-01
  Total weights = 1.951996770e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5471e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309448166832
                                         uncertainty =       0.001822813415

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309448166832
                                         uncertainty =       0.001822813415

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393504640
  error estimate for blocks of size 2^( 2) =       0.000407718192
  error estimate for blocks of size 2^( 3) =       0.000422886962
  error estimate for blocks of size 2^( 4) =       0.000436247717
  error estimate for blocks of size 2^( 5) =       0.000448325175
  error estimate for blocks of size 2^( 6) =       0.000458320923
  error estimate for blocks of size 2^( 7) =       0.000465247601

      target function =                  N/A
              le_mean =     -16.904670100422
             les_mean =     286.088648168273
             stat err =       0.000452035354
             autocorr =       1.319608453262
              std dev =       0.556499599283
             le_variance =       0.309691804002


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690467010042e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+12, overlap shift 9.3132e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904670100397       residual = 1.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904670100397       residual = 1.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 9.64e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e+12 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.7253e+13, overlap shift 3.7253e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904670100397       residual = 1.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904670100397       residual = 1.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 9.64e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.4901e+14, overlap shift 1.4901e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904670100397       residual = 1.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904670100397       residual = 1.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 9.64e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+14 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.204679 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7002e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.8703
    reference variance = 0.205291
====================================================
  Execution time = 1.3966e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2180e-01
  Total weights = 1.9517e+06
  Execution time = 1.8829e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309320892349
                                         uncertainty =       0.001846528256

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309320892349
                                         uncertainty =       0.001846528256

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393266228
  error estimate for blocks of size 2^( 2) =       0.000407028361
  error estimate for blocks of size 2^( 3) =       0.000421203021
  error estimate for blocks of size 2^( 4) =       0.000433836919
  error estimate for blocks of size 2^( 5) =       0.000444825305
  error estimate for blocks of size 2^( 6) =       0.000451775674
  error estimate for blocks of size 2^( 7) =       0.000456293696

      target function =                  N/A
              le_mean =     -16.904150736594
             les_mean =     286.072114726952
             stat err =       0.000446682899
             autocorr =       1.290105852664
              std dev =       0.556162433572
             le_variance =       0.309316652517

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309320892349
                                         uncertainty =       0.001846528256

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309320892349
                                         uncertainty =       0.001846528256

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393266228
  error estimate for blocks of size 2^( 2) =       0.000407028361
  error estimate for blocks of size 2^( 3) =       0.000421203021
  error estimate for blocks of size 2^( 4) =       0.000433836919
  error estimate for blocks of size 2^( 5) =       0.000444825305
  error estimate for blocks of size 2^( 6) =       0.000451775674
  error estimate for blocks of size 2^( 7) =       0.000456293696

      target function =                  N/A
              le_mean =     -16.904150736594
             les_mean =     286.072114726952
             stat err =       0.000446682899
             autocorr =       1.290105852664
              std dev =       0.556162433572
             le_variance =       0.309316652517

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309320892349
                                         uncertainty =       0.001846528256

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309320892349
                                         uncertainty =       0.001846528256

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393266228
  error estimate for blocks of size 2^( 2) =       0.000407028361
  error estimate for blocks of size 2^( 3) =       0.000421203021
  error estimate for blocks of size 2^( 4) =       0.000433836919
  error estimate for blocks of size 2^( 5) =       0.000444825305
  error estimate for blocks of size 2^( 6) =       0.000451775674
  error estimate for blocks of size 2^( 7) =       0.000456293696

      target function =                  N/A
              le_mean =     -16.904150736594
             les_mean =     286.072114726952
             stat err =       0.000446682899
             autocorr =       1.290105852664
              std dev =       0.556162433572
             le_variance =       0.309316652517

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309320892349
                                         uncertainty =       0.001846528256

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309320892349
                                         uncertainty =       0.001846528256

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393266228
  error estimate for blocks of size 2^( 2) =       0.000407028361
  error estimate for blocks of size 2^( 3) =       0.000421203021
  error estimate for blocks of size 2^( 4) =       0.000433836919
  error estimate for blocks of size 2^( 5) =       0.000444825305
  error estimate for blocks of size 2^( 6) =       0.000451775674
  error estimate for blocks of size 2^( 7) =       0.000456293696

      target function =                  N/A
              le_mean =     -16.904150736594
             les_mean =     286.072114726952
             stat err =       0.000446682899
             autocorr =       1.290105852664
              std dev =       0.556162433572
             le_variance =       0.309316652517


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904150736594        initial  <--
     9.3132e+12     9.3132e+13             0.0000e+00       -16.904150736594
     3.7253e+13     3.7253e+14             0.0000e+00       -16.904150736594
     1.4901e+14     1.4901e+15             0.0000e+00       -16.904150736594

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.5619
  </log>
  <optVariables href="H2O.s036.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0581e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.9216
    reference variance = 0.202794
====================================================
  Execution time = 1.4339e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5274e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2433e-01
  Total weights = 1.951836108e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5683e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312587899691
                                         uncertainty =       0.001966715387

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312587899691
                                         uncertainty =       0.001966715387

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395318191
  error estimate for blocks of size 2^( 2) =       0.000409352805
  error estimate for blocks of size 2^( 3) =       0.000423665573
  error estimate for blocks of size 2^( 4) =       0.000436522904
  error estimate for blocks of size 2^( 5) =       0.000446953460
  error estimate for blocks of size 2^( 6) =       0.000452279770
  error estimate for blocks of size 2^( 7) =       0.000453654847

      target function =                  N/A
              le_mean =     -16.904751984376
             les_mean =     286.094974090303
             stat err =       0.000447352745
             autocorr =       1.280579704384
              std dev =       0.559064347109
             le_variance =       0.312552944208


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690475198438e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+13, overlap shift 9.3132e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904751984366       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904751984366       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.90e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.7253e+14, overlap shift 3.7253e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904751984366       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904751984366       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.49e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+14 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.4901e+15, overlap shift 1.4901e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904751984366       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904751984366       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.90e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+15 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.208581 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6918e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.8186
    reference variance = 0.224039
====================================================
  Execution time = 1.4024e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.1752e-01
  Total weights = 1.9516e+06
  Execution time = 1.8805e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308039923775
                                         uncertainty =       0.001892935391

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308039923775
                                         uncertainty =       0.001892935391

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392423422
  error estimate for blocks of size 2^( 2) =       0.000406640064
  error estimate for blocks of size 2^( 3) =       0.000420802189
  error estimate for blocks of size 2^( 4) =       0.000434538479
  error estimate for blocks of size 2^( 5) =       0.000445103738
  error estimate for blocks of size 2^( 6) =       0.000453291664
  error estimate for blocks of size 2^( 7) =       0.000459507024

      target function =                  N/A
              le_mean =     -16.903800414750
             les_mean =     286.055985845959
             stat err =       0.000448110226
             autocorr =       1.303946789183
              std dev =       0.554970525438
             le_variance =       0.307992284105

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308039923775
                                         uncertainty =       0.001892935391

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308039923775
                                         uncertainty =       0.001892935391

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392423422
  error estimate for blocks of size 2^( 2) =       0.000406640064
  error estimate for blocks of size 2^( 3) =       0.000420802189
  error estimate for blocks of size 2^( 4) =       0.000434538479
  error estimate for blocks of size 2^( 5) =       0.000445103738
  error estimate for blocks of size 2^( 6) =       0.000453291664
  error estimate for blocks of size 2^( 7) =       0.000459507024

      target function =                  N/A
              le_mean =     -16.903800414750
             les_mean =     286.055985845959
             stat err =       0.000448110226
             autocorr =       1.303946789183
              std dev =       0.554970525438
             le_variance =       0.307992284105

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308039923775
                                         uncertainty =       0.001892935391

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308039923775
                                         uncertainty =       0.001892935391

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392423422
  error estimate for blocks of size 2^( 2) =       0.000406640064
  error estimate for blocks of size 2^( 3) =       0.000420802189
  error estimate for blocks of size 2^( 4) =       0.000434538479
  error estimate for blocks of size 2^( 5) =       0.000445103738
  error estimate for blocks of size 2^( 6) =       0.000453291664
  error estimate for blocks of size 2^( 7) =       0.000459507024

      target function =                  N/A
              le_mean =     -16.903800414750
             les_mean =     286.055985845959
             stat err =       0.000448110226
             autocorr =       1.303946789183
              std dev =       0.554970525438
             le_variance =       0.307992284105

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308039923775
                                         uncertainty =       0.001892935391

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308039923775
                                         uncertainty =       0.001892935391

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392423422
  error estimate for blocks of size 2^( 2) =       0.000406640064
  error estimate for blocks of size 2^( 3) =       0.000420802189
  error estimate for blocks of size 2^( 4) =       0.000434538479
  error estimate for blocks of size 2^( 5) =       0.000445103738
  error estimate for blocks of size 2^( 6) =       0.000453291664
  error estimate for blocks of size 2^( 7) =       0.000459507024

      target function =                  N/A
              le_mean =     -16.903800414750
             les_mean =     286.055985845959
             stat err =       0.000448110226
             autocorr =       1.303946789183
              std dev =       0.554970525438
             le_variance =       0.307992284105


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.903800414750        initial  <--
     9.3132e+13     9.3132e+14             0.0000e+00       -16.903800414750
     3.7253e+14     3.7253e+15             0.0000e+00       -16.903800414750
     1.4901e+15     1.4901e+16             0.0000e+00       -16.903800414750

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.5265
  </log>
  <optVariables href="H2O.s037.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0460e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.9748
    reference variance = 0.225659
====================================================
  Execution time = 1.4300e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5244e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.1842e-01
  Total weights = 1.951946214e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5792e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308014216345
                                         uncertainty =       0.002087749572

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308014216345
                                         uncertainty =       0.002087749572

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392422862
  error estimate for blocks of size 2^( 2) =       0.000406357560
  error estimate for blocks of size 2^( 3) =       0.000420782810
  error estimate for blocks of size 2^( 4) =       0.000433563353
  error estimate for blocks of size 2^( 5) =       0.000444350436
  error estimate for blocks of size 2^( 6) =       0.000451112741
  error estimate for blocks of size 2^( 7) =       0.000453248159

      target function =                  N/A
              le_mean =     -16.904753144885
             les_mean =     286.089095541981
             stat err =       0.000445568672
             autocorr =       1.289201183638
              std dev =       0.554969733239
             le_variance =       0.307991404811


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690475314488e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+14, overlap shift 9.3132e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904753144883       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904753144883       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904753144883       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.888405821728       residual = 5.59e-01           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904753144883       residual = 4.60e-12           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e+14 is 4.532110e-19

solving harmonic davidson linear method for identity shift 3.7253e+15, overlap shift 3.7253e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904753144883       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904753144883       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904753144883       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to small subspace S singular value of 6.27e-01
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+15 is 1.003072e-19

solving harmonic davidson linear method for identity shift 1.4901e+16, overlap shift 1.4901e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904753144883       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904753144883       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904753144883       residual = 1.80e+02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904753144890       residual = 1.51e+02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904753144871       residual = 2.13e+00           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -18.465288939476       residual = 4.94e+00           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -20.767405896231       residual = 3.02e+01           smallest_sin_value = 1.00e+00
davidson iteration    7 stopping due to too large eigenvalue change
davidson solver did not converge after          7 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+16 is 2.507681e-20

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.214111 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6892e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.965
    reference variance = 0.300178
====================================================
  Execution time = 1.4246e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2081e-01
  Total weights = 1.9517e+06
  Execution time = 1.8878e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310981075462
                                         uncertainty =       0.001833333570

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310981075462
                                         uncertainty =       0.001833333570

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394317317
  error estimate for blocks of size 2^( 2) =       0.000408104340
  error estimate for blocks of size 2^( 3) =       0.000422060339
  error estimate for blocks of size 2^( 4) =       0.000433310834
  error estimate for blocks of size 2^( 5) =       0.000442847089
  error estimate for blocks of size 2^( 6) =       0.000449859464
  error estimate for blocks of size 2^( 7) =       0.000453371754

      target function =                  N/A
              le_mean =     -16.905325924852
             les_mean =     286.110852931371
             stat err =       0.000444847285
             autocorr =       1.272712146736
              std dev =       0.557648897700
             le_variance =       0.310972293106

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310981075462
                                         uncertainty =       0.001833333570

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310981075462
                                         uncertainty =       0.001833333570

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394317317
  error estimate for blocks of size 2^( 2) =       0.000408104340
  error estimate for blocks of size 2^( 3) =       0.000422060339
  error estimate for blocks of size 2^( 4) =       0.000433310834
  error estimate for blocks of size 2^( 5) =       0.000442847089
  error estimate for blocks of size 2^( 6) =       0.000449859464
  error estimate for blocks of size 2^( 7) =       0.000453371754

      target function =                  N/A
              le_mean =     -16.905325924852
             les_mean =     286.110852931371
             stat err =       0.000444847285
             autocorr =       1.272712146736
              std dev =       0.557648897700
             le_variance =       0.310972293106

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310981075462
                                         uncertainty =       0.001833333570

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310981075462
                                         uncertainty =       0.001833333570

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394317317
  error estimate for blocks of size 2^( 2) =       0.000408104340
  error estimate for blocks of size 2^( 3) =       0.000422060339
  error estimate for blocks of size 2^( 4) =       0.000433310834
  error estimate for blocks of size 2^( 5) =       0.000442847089
  error estimate for blocks of size 2^( 6) =       0.000449859464
  error estimate for blocks of size 2^( 7) =       0.000453371754

      target function =                  N/A
              le_mean =     -16.905325924852
             les_mean =     286.110852931371
             stat err =       0.000444847285
             autocorr =       1.272712146736
              std dev =       0.557648897700
             le_variance =       0.310972293106

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310981075462
                                         uncertainty =       0.001833333570

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310981075462
                                         uncertainty =       0.001833333570

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394317317
  error estimate for blocks of size 2^( 2) =       0.000408104340
  error estimate for blocks of size 2^( 3) =       0.000422060339
  error estimate for blocks of size 2^( 4) =       0.000433310834
  error estimate for blocks of size 2^( 5) =       0.000442847089
  error estimate for blocks of size 2^( 6) =       0.000449859464
  error estimate for blocks of size 2^( 7) =       0.000453371754

      target function =                  N/A
              le_mean =     -16.905325924852
             les_mean =     286.110852931371
             stat err =       0.000444847285
             autocorr =       1.272712146736
              std dev =       0.557648897700
             le_variance =       0.310972293106


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905325924852        initial  <--
     9.3132e+14     9.3132e+15             4.5321e-19       -16.905325924852
     3.7253e+15     3.7253e+16             1.0031e-19       -16.905325924852
     1.4901e+16     1.4901e+17             2.5077e-20       -16.905325924852

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.7955
  </log>
  <optVariables href="H2O.s038.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0703e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.9366
    reference variance = 0.342241
====================================================
  Execution time = 1.4281e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5242e+04
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.2410e-01
  Total weights = 1.951460460e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5573e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311828544515
                                         uncertainty =       0.002431709104

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311828544515
                                         uncertainty =       0.002431709104

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394835905
  error estimate for blocks of size 2^( 2) =       0.000408609311
  error estimate for blocks of size 2^( 3) =       0.000423141593
  error estimate for blocks of size 2^( 4) =       0.000435843875
  error estimate for blocks of size 2^( 5) =       0.000446845172
  error estimate for blocks of size 2^( 6) =       0.000454768778
  error estimate for blocks of size 2^( 7) =       0.000456959800

      target function =                  N/A
              le_mean =     -16.903488637745
             les_mean =     286.052031959921
             stat err =       0.000448604406
             autocorr =       1.290903537628
              std dev =       0.558382291999
             le_variance =       0.311790784018


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690348863774e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+15, overlap shift 9.3132e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903488637712       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903488637712       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.24e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e+15 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.7253e+16, overlap shift 3.7253e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903488637712       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903488637712       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.24e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+16 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.4901e+17, overlap shift 1.4901e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903488637712       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903488637712       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.24e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+17 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.217956 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6850e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.9494
    reference variance = 0.249343
====================================================
  Execution time = 1.4068e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2360e-01
  Total weights = 1.9518e+06
  Execution time = 1.8816e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312391844393
                                         uncertainty =       0.002020498552

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312391844393
                                         uncertainty =       0.002020498552

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395191102
  error estimate for blocks of size 2^( 2) =       0.000409451677
  error estimate for blocks of size 2^( 3) =       0.000424160163
  error estimate for blocks of size 2^( 4) =       0.000437643777
  error estimate for blocks of size 2^( 5) =       0.000449213176
  error estimate for blocks of size 2^( 6) =       0.000457560453
  error estimate for blocks of size 2^( 7) =       0.000462784594

      target function =                  N/A
              le_mean =     -16.904255587977
             les_mean =     286.077457506118
             stat err =       0.000451800500
             autocorr =       1.307010565808
              std dev =       0.558884616812
             le_variance =       0.312352014909

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312391844393
                                         uncertainty =       0.002020498552

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312391844393
                                         uncertainty =       0.002020498552

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395191102
  error estimate for blocks of size 2^( 2) =       0.000409451677
  error estimate for blocks of size 2^( 3) =       0.000424160163
  error estimate for blocks of size 2^( 4) =       0.000437643777
  error estimate for blocks of size 2^( 5) =       0.000449213176
  error estimate for blocks of size 2^( 6) =       0.000457560453
  error estimate for blocks of size 2^( 7) =       0.000462784594

      target function =                  N/A
              le_mean =     -16.904255587977
             les_mean =     286.077457506118
             stat err =       0.000451800500
             autocorr =       1.307010565808
              std dev =       0.558884616812
             le_variance =       0.312352014909

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312391844393
                                         uncertainty =       0.002020498552

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312391844393
                                         uncertainty =       0.002020498552

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395191102
  error estimate for blocks of size 2^( 2) =       0.000409451677
  error estimate for blocks of size 2^( 3) =       0.000424160163
  error estimate for blocks of size 2^( 4) =       0.000437643777
  error estimate for blocks of size 2^( 5) =       0.000449213176
  error estimate for blocks of size 2^( 6) =       0.000457560453
  error estimate for blocks of size 2^( 7) =       0.000462784594

      target function =                  N/A
              le_mean =     -16.904255587977
             les_mean =     286.077457506118
             stat err =       0.000451800500
             autocorr =       1.307010565808
              std dev =       0.558884616812
             le_variance =       0.312352014909

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312391844393
                                         uncertainty =       0.002020498552

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312391844393
                                         uncertainty =       0.002020498552

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395191102
  error estimate for blocks of size 2^( 2) =       0.000409451677
  error estimate for blocks of size 2^( 3) =       0.000424160163
  error estimate for blocks of size 2^( 4) =       0.000437643777
  error estimate for blocks of size 2^( 5) =       0.000449213176
  error estimate for blocks of size 2^( 6) =       0.000457560453
  error estimate for blocks of size 2^( 7) =       0.000462784594

      target function =                  N/A
              le_mean =     -16.904255587977
             les_mean =     286.077457506118
             stat err =       0.000451800500
             autocorr =       1.307010565808
              std dev =       0.558884616812
             le_variance =       0.312352014909


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904255587977        initial  <--
     9.3132e+15     9.3132e+16             0.0000e+00       -16.904255587977
     3.7253e+16     3.7253e+17             0.0000e+00       -16.904255587977
     1.4901e+17     1.4901e+18             0.0000e+00       -16.904255587977

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.5979
  </log>
  <optVariables href="H2O.s039.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0463e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s040 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s040 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=40  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -16.8906
    reference variance = 0.447554
====================================================
  Execution time = 1.6647e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s040
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5233e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2937e-01
  Total weights = 1.951352293e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5705e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316114816489
                                         uncertainty =       0.002180678555

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316114816489
                                         uncertainty =       0.002180678555

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397589959
  error estimate for blocks of size 2^( 2) =       0.000411687552
  error estimate for blocks of size 2^( 3) =       0.000425833221
  error estimate for blocks of size 2^( 4) =       0.000438679985
  error estimate for blocks of size 2^( 5) =       0.000449385382
  error estimate for blocks of size 2^( 6) =       0.000458048145
  error estimate for blocks of size 2^( 7) =       0.000463970378

      target function =                  N/A
              le_mean =     -16.904754496677
             les_mean =     286.100094682183
             stat err =       0.000452520973
             autocorr =       1.295408095813
              std dev =       0.562277112964
             le_variance =       0.316155551763


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690475449668e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+16, overlap shift 9.3132e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904754496689       residual = 1.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904754496689       residual = 1.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.54e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e+16 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.7253e+17, overlap shift 3.7253e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904754496689       residual = 1.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904754496689       residual = 1.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.55e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+17 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.4901e+18, overlap shift 1.4901e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904754496689       residual = 1.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904754496689       residual = 1.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.219041 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.9223e+01
  </log>
  <optVariables href="H2O.s040.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -16.8993
    reference variance = 0.317806
====================================================
  Execution time = 1.3934e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s040
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.3349e-01
  Total weights = 1.9517e+06
  Execution time = 1.8877e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317233214701
                                         uncertainty =       0.002773714123

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317233214701
                                         uncertainty =       0.002773714123

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398391302
  error estimate for blocks of size 2^( 2) =       0.000411981274
  error estimate for blocks of size 2^( 3) =       0.000426602285
  error estimate for blocks of size 2^( 4) =       0.000439329870
  error estimate for blocks of size 2^( 5) =       0.000450511003
  error estimate for blocks of size 2^( 6) =       0.000458975342
  error estimate for blocks of size 2^( 7) =       0.000462358609

      target function =                  N/A
              le_mean =     -16.904412006024
             les_mean =     286.092638575985
             stat err =       0.000452793706
             autocorr =       1.291757723491
              std dev =       0.563410382179
             le_variance =       0.317431258747

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317233214701
                                         uncertainty =       0.002773714123

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317233214701
                                         uncertainty =       0.002773714123

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398391302
  error estimate for blocks of size 2^( 2) =       0.000411981274
  error estimate for blocks of size 2^( 3) =       0.000426602285
  error estimate for blocks of size 2^( 4) =       0.000439329870
  error estimate for blocks of size 2^( 5) =       0.000450511003
  error estimate for blocks of size 2^( 6) =       0.000458975342
  error estimate for blocks of size 2^( 7) =       0.000462358609

      target function =                  N/A
              le_mean =     -16.904412006024
             les_mean =     286.092638575985
             stat err =       0.000452793706
             autocorr =       1.291757723491
              std dev =       0.563410382179
             le_variance =       0.317431258747

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317233214701
                                         uncertainty =       0.002773714123

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317233214701
                                         uncertainty =       0.002773714123

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398391302
  error estimate for blocks of size 2^( 2) =       0.000411981274
  error estimate for blocks of size 2^( 3) =       0.000426602285
  error estimate for blocks of size 2^( 4) =       0.000439329870
  error estimate for blocks of size 2^( 5) =       0.000450511003
  error estimate for blocks of size 2^( 6) =       0.000458975342
  error estimate for blocks of size 2^( 7) =       0.000462358609

      target function =                  N/A
              le_mean =     -16.904412006024
             les_mean =     286.092638575985
             stat err =       0.000452793706
             autocorr =       1.291757723491
              std dev =       0.563410382179
             le_variance =       0.317431258747

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317233214701
                                         uncertainty =       0.002773714123

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317233214701
                                         uncertainty =       0.002773714123

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398391302
  error estimate for blocks of size 2^( 2) =       0.000411981274
  error estimate for blocks of size 2^( 3) =       0.000426602285
  error estimate for blocks of size 2^( 4) =       0.000439329870
  error estimate for blocks of size 2^( 5) =       0.000450511003
  error estimate for blocks of size 2^( 6) =       0.000458975342
  error estimate for blocks of size 2^( 7) =       0.000462358609

      target function =                  N/A
              le_mean =     -16.904412006024
             les_mean =     286.092638575985
             stat err =       0.000452793706
             autocorr =       1.291757723491
              std dev =       0.563410382179
             le_variance =       0.317431258747


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904412006024        initial  <--
     9.3132e+16     9.3132e+17             0.0000e+00       -16.904412006024
     3.7253e+17     3.7253e+18             0.0000e+00       -16.904412006024
     1.4901e+18     1.4901e+19             0.0000e+00       -16.904412006024

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.5962
  </log>
  <optVariables href="H2O.s040.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2825e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s041 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s041 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=41  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -16.9375
    reference variance = 0.323068
====================================================
  Execution time = 1.4374e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s041
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5251e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2282e-01
  Total weights = 1.951476951e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5661e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311027497395
                                         uncertainty =       0.002029969162

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311027497395
                                         uncertainty =       0.002029969162

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394417926
  error estimate for blocks of size 2^( 2) =       0.000408826952
  error estimate for blocks of size 2^( 3) =       0.000423554932
  error estimate for blocks of size 2^( 4) =       0.000437765003
  error estimate for blocks of size 2^( 5) =       0.000448939445
  error estimate for blocks of size 2^( 6) =       0.000457748620
  error estimate for blocks of size 2^( 7) =       0.000463199574

      target function =                  N/A
              le_mean =     -16.903937765695
             les_mean =     286.065934901635
             stat err =       0.000451913161
             autocorr =       1.312794316413
              std dev =       0.557791180293
             le_variance =       0.311131000812


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690393776569e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+17, overlap shift 9.3132e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903937765677       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903937765677       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+18, overlap shift 3.7253e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903937765677       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903937765677       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4901e+19, overlap shift 1.4901e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903937765677       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903937765677       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.220072 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6945e+01
  </log>
  <optVariables href="H2O.s041.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -16.8828
    reference variance = 0.202661
====================================================
  Execution time = 1.4011e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s041
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2501e-01
  Total weights = 1.9516e+06
  Execution time = 1.8923e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314082042140
                                         uncertainty =       0.002817442685

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314082042140
                                         uncertainty =       0.002817442685

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396298527
  error estimate for blocks of size 2^( 2) =       0.000410010349
  error estimate for blocks of size 2^( 3) =       0.000423990315
  error estimate for blocks of size 2^( 4) =       0.000437268039
  error estimate for blocks of size 2^( 5) =       0.000448404985
  error estimate for blocks of size 2^( 6) =       0.000456725007
  error estimate for blocks of size 2^( 7) =       0.000463510197

      target function =                  N/A
              le_mean =     -16.903964924678
             les_mean =     286.069035988810
             stat err =       0.000451477057
             autocorr =       1.297855836525
              std dev =       0.560450751549
             le_variance =       0.314105044911

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314082042140
                                         uncertainty =       0.002817442685

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314082042140
                                         uncertainty =       0.002817442685

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396298527
  error estimate for blocks of size 2^( 2) =       0.000410010349
  error estimate for blocks of size 2^( 3) =       0.000423990315
  error estimate for blocks of size 2^( 4) =       0.000437268039
  error estimate for blocks of size 2^( 5) =       0.000448404985
  error estimate for blocks of size 2^( 6) =       0.000456725007
  error estimate for blocks of size 2^( 7) =       0.000463510197

      target function =                  N/A
              le_mean =     -16.903964924678
             les_mean =     286.069035988810
             stat err =       0.000451477057
             autocorr =       1.297855836525
              std dev =       0.560450751549
             le_variance =       0.314105044911

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314082042140
                                         uncertainty =       0.002817442685

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314082042140
                                         uncertainty =       0.002817442685

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396298527
  error estimate for blocks of size 2^( 2) =       0.000410010349
  error estimate for blocks of size 2^( 3) =       0.000423990315
  error estimate for blocks of size 2^( 4) =       0.000437268039
  error estimate for blocks of size 2^( 5) =       0.000448404985
  error estimate for blocks of size 2^( 6) =       0.000456725007
  error estimate for blocks of size 2^( 7) =       0.000463510197

      target function =                  N/A
              le_mean =     -16.903964924678
             les_mean =     286.069035988810
             stat err =       0.000451477057
             autocorr =       1.297855836525
              std dev =       0.560450751549
             le_variance =       0.314105044911

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314082042140
                                         uncertainty =       0.002817442685

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314082042140
                                         uncertainty =       0.002817442685

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396298527
  error estimate for blocks of size 2^( 2) =       0.000410010349
  error estimate for blocks of size 2^( 3) =       0.000423990315
  error estimate for blocks of size 2^( 4) =       0.000437268039
  error estimate for blocks of size 2^( 5) =       0.000448404985
  error estimate for blocks of size 2^( 6) =       0.000456725007
  error estimate for blocks of size 2^( 7) =       0.000463510197

      target function =                  N/A
              le_mean =     -16.903964924678
             les_mean =     286.069035988810
             stat err =       0.000451477057
             autocorr =       1.297855836525
              std dev =       0.560450751549
             le_variance =       0.314105044911


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.903964924678        initial  <--
     9.3132e+17     9.3132e+18             0.0000e+00       -16.903964924678
     3.7253e+18     3.7253e+19             0.0000e+00       -16.903964924678
     1.4901e+19     1.4901e+20             0.0000e+00       -16.903964924678

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.5993
  </log>
  <optVariables href="H2O.s041.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0551e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s042 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s042 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=42  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -16.988
    reference variance = 0.480564
====================================================
  Execution time = 1.4285e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s042
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5253e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2416e-01
  Total weights = 1.951890041e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5564e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309643620068
                                         uncertainty =       0.002413094696

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309643620068
                                         uncertainty =       0.002413094696

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394175294
  error estimate for blocks of size 2^( 2) =       0.000408067798
  error estimate for blocks of size 2^( 3) =       0.000422271692
  error estimate for blocks of size 2^( 4) =       0.000435378123
  error estimate for blocks of size 2^( 5) =       0.000446573166
  error estimate for blocks of size 2^( 6) =       0.000453034406
  error estimate for blocks of size 2^( 7) =       0.000460339050

      target function =                  N/A
              le_mean =     -16.904931732821
             les_mean =     286.100877401996
             stat err =       0.000448831186
             autocorr =       1.296543975017
              std dev =       0.557448046291
             le_variance =       0.310748324313


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690493173282e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+18, overlap shift 9.3132e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904931732837       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904931732837       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+19, overlap shift 3.7253e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904931732837       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904931732837       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4901e+20, overlap shift 1.4901e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904931732837       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904931732837       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.221168 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6847e+01
  </log>
  <optVariables href="H2O.s042.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -16.8215
    reference variance = 0.24598
====================================================
  Execution time = 1.4049e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s042
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2321e-01
  Total weights = 1.9515e+06
  Execution time = 1.8826e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310984202927
                                         uncertainty =       0.002034095648

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310984202927
                                         uncertainty =       0.002034095648

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394332184
  error estimate for blocks of size 2^( 2) =       0.000408359840
  error estimate for blocks of size 2^( 3) =       0.000422663985
  error estimate for blocks of size 2^( 4) =       0.000435969966
  error estimate for blocks of size 2^( 5) =       0.000447508785
  error estimate for blocks of size 2^( 6) =       0.000457297646
  error estimate for blocks of size 2^( 7) =       0.000463197839

      target function =                  N/A
              le_mean =     -16.904052557982
             les_mean =     286.070206879219
             stat err =       0.000450993559
             autocorr =       1.308025556803
              std dev =       0.557669923305
             le_variance =       0.310995743359

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310984202927
                                         uncertainty =       0.002034095648

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310984202927
                                         uncertainty =       0.002034095648

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394332184
  error estimate for blocks of size 2^( 2) =       0.000408359840
  error estimate for blocks of size 2^( 3) =       0.000422663985
  error estimate for blocks of size 2^( 4) =       0.000435969966
  error estimate for blocks of size 2^( 5) =       0.000447508785
  error estimate for blocks of size 2^( 6) =       0.000457297646
  error estimate for blocks of size 2^( 7) =       0.000463197839

      target function =                  N/A
              le_mean =     -16.904052557982
             les_mean =     286.070206879219
             stat err =       0.000450993559
             autocorr =       1.308025556803
              std dev =       0.557669923305
             le_variance =       0.310995743359

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310984202927
                                         uncertainty =       0.002034095648

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310984202927
                                         uncertainty =       0.002034095648

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394332184
  error estimate for blocks of size 2^( 2) =       0.000408359840
  error estimate for blocks of size 2^( 3) =       0.000422663985
  error estimate for blocks of size 2^( 4) =       0.000435969966
  error estimate for blocks of size 2^( 5) =       0.000447508785
  error estimate for blocks of size 2^( 6) =       0.000457297646
  error estimate for blocks of size 2^( 7) =       0.000463197839

      target function =                  N/A
              le_mean =     -16.904052557982
             les_mean =     286.070206879219
             stat err =       0.000450993559
             autocorr =       1.308025556803
              std dev =       0.557669923305
             le_variance =       0.310995743359

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310984202927
                                         uncertainty =       0.002034095648

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310984202927
                                         uncertainty =       0.002034095648

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394332184
  error estimate for blocks of size 2^( 2) =       0.000408359840
  error estimate for blocks of size 2^( 3) =       0.000422663985
  error estimate for blocks of size 2^( 4) =       0.000435969966
  error estimate for blocks of size 2^( 5) =       0.000447508785
  error estimate for blocks of size 2^( 6) =       0.000457297646
  error estimate for blocks of size 2^( 7) =       0.000463197839

      target function =                  N/A
              le_mean =     -16.904052557982
             les_mean =     286.070206879219
             stat err =       0.000450993559
             autocorr =       1.308025556803
              std dev =       0.557669923305
             le_variance =       0.310995743359


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904052557982        initial  <--
     9.3132e+18     9.3132e+19             0.0000e+00       -16.904052557982
     3.7253e+19     3.7253e+20             0.0000e+00       -16.904052557982
     1.4901e+20     1.4901e+21             0.0000e+00       -16.904052557982

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.5803
  </log>
  <optVariables href="H2O.s042.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0433e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s043 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s043 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=43  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -16.8343
    reference variance = 0.94973
====================================================
  Execution time = 1.4472e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s043
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5267e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2248e-01
  Total weights = 1.952002099e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5682e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310876478749
                                         uncertainty =       0.002155835729

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310876478749
                                         uncertainty =       0.002155835729

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394407269
  error estimate for blocks of size 2^( 2) =       0.000408491572
  error estimate for blocks of size 2^( 3) =       0.000422895482
  error estimate for blocks of size 2^( 4) =       0.000436203930
  error estimate for blocks of size 2^( 5) =       0.000447148241
  error estimate for blocks of size 2^( 6) =       0.000455349220
  error estimate for blocks of size 2^( 7) =       0.000463544292

      target function =                  N/A
              le_mean =     -16.904244099342
             les_mean =     286.075952110802
             stat err =       0.000450561421
             autocorr =       1.305023056612
              std dev =       0.557776108996
             le_variance =       0.311114187766


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690424409934e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+19, overlap shift 9.3132e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904244099352       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904244099352       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904244099352       residual = 6.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904244099352       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e+19 is 5.791528e-24

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+20, overlap shift 3.7253e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904244099352       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904244099352       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904244099352       residual = 6.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+20 is 1.447882e-24

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4901e+21, overlap shift 1.4901e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904244099352       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904244099352       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904244099352       residual = 6.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+21 is 3.619705e-25

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.222615 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7045e+01
  </log>
  <optVariables href="H2O.s043.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -16.8277
    reference variance = 0.196268
====================================================
  Execution time = 1.4173e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s043
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2221e-01
  Total weights = 1.9518e+06
  Execution time = 1.8912e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311611608914
                                         uncertainty =       0.002058570710

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311611608914
                                         uncertainty =       0.002058570710

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394692926
  error estimate for blocks of size 2^( 2) =       0.000408937992
  error estimate for blocks of size 2^( 3) =       0.000423213212
  error estimate for blocks of size 2^( 4) =       0.000436555780
  error estimate for blocks of size 2^( 5) =       0.000448324724
  error estimate for blocks of size 2^( 6) =       0.000456428620
  error estimate for blocks of size 2^( 7) =       0.000461086488

      target function =                  N/A
              le_mean =     -16.904011667595
             les_mean =     286.067816859228
             stat err =       0.000450598903
             autocorr =       1.303351554662
              std dev =       0.558180089306
             le_variance =       0.311565012097

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311611608914
                                         uncertainty =       0.002058570710

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311611608914
                                         uncertainty =       0.002058570710

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394692926
  error estimate for blocks of size 2^( 2) =       0.000408937992
  error estimate for blocks of size 2^( 3) =       0.000423213212
  error estimate for blocks of size 2^( 4) =       0.000436555780
  error estimate for blocks of size 2^( 5) =       0.000448324724
  error estimate for blocks of size 2^( 6) =       0.000456428620
  error estimate for blocks of size 2^( 7) =       0.000461086488

      target function =                  N/A
              le_mean =     -16.904011667595
             les_mean =     286.067816859228
             stat err =       0.000450598903
             autocorr =       1.303351554662
              std dev =       0.558180089306
             le_variance =       0.311565012097

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311611608914
                                         uncertainty =       0.002058570710

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311611608914
                                         uncertainty =       0.002058570710

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394692926
  error estimate for blocks of size 2^( 2) =       0.000408937992
  error estimate for blocks of size 2^( 3) =       0.000423213212
  error estimate for blocks of size 2^( 4) =       0.000436555780
  error estimate for blocks of size 2^( 5) =       0.000448324724
  error estimate for blocks of size 2^( 6) =       0.000456428620
  error estimate for blocks of size 2^( 7) =       0.000461086488

      target function =                  N/A
              le_mean =     -16.904011667595
             les_mean =     286.067816859228
             stat err =       0.000450598903
             autocorr =       1.303351554662
              std dev =       0.558180089306
             le_variance =       0.311565012097

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311611608914
                                         uncertainty =       0.002058570710

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311611608914
                                         uncertainty =       0.002058570710

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394692926
  error estimate for blocks of size 2^( 2) =       0.000408937992
  error estimate for blocks of size 2^( 3) =       0.000423213212
  error estimate for blocks of size 2^( 4) =       0.000436555780
  error estimate for blocks of size 2^( 5) =       0.000448324724
  error estimate for blocks of size 2^( 6) =       0.000456428620
  error estimate for blocks of size 2^( 7) =       0.000461086488

      target function =                  N/A
              le_mean =     -16.904011667595
             les_mean =     286.067816859228
             stat err =       0.000450598903
             autocorr =       1.303351554662
              std dev =       0.558180089306
             le_variance =       0.311565012097


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904011667595        initial  <--
     9.3132e+19     9.3132e+20             5.7915e-24       -16.904011667595
     3.7253e+20     3.7253e+21             1.4479e-24       -16.904011667595
     1.4901e+21     1.4901e+22             3.6197e-25       -16.904011667595

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.7438
  </log>
  <optVariables href="H2O.s043.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0794e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s044 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s044 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=44  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -16.903
    reference variance = 0.107511
====================================================
  Execution time = 1.4419e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s044
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5243e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2142e-01
  Total weights = 1.951903556e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5816e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309840394476
                                         uncertainty =       0.002155321666

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309840394476
                                         uncertainty =       0.002155321666

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393558339
  error estimate for blocks of size 2^( 2) =       0.000407692854
  error estimate for blocks of size 2^( 3) =       0.000422410308
  error estimate for blocks of size 2^( 4) =       0.000436026616
  error estimate for blocks of size 2^( 5) =       0.000446281909
  error estimate for blocks of size 2^( 6) =       0.000454464170
  error estimate for blocks of size 2^( 7) =       0.000461931153

      target function =                  N/A
              le_mean =     -16.904255964424
             les_mean =     286.075294296604
             stat err =       0.000449675962
             autocorr =       1.305512718100
              std dev =       0.556575540133
             le_variance =       0.309776331874


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690425596442e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+20, overlap shift 9.3132e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904255964451       residual = 2.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904255964451       residual = 2.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+21, overlap shift 3.7253e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904255964451       residual = 2.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904255964451       residual = 2.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4901e+22, overlap shift 1.4901e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904255964451       residual = 2.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904255964451       residual = 2.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.223625 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7006e+01
  </log>
  <optVariables href="H2O.s044.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -16.8209
    reference variance = 0.235128
====================================================
  Execution time = 1.4316e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s044
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2405e-01
  Total weights = 1.9519e+06
  Execution time = 1.8829e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311673005968
                                         uncertainty =       0.003924550352

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311673005968
                                         uncertainty =       0.003924550352

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394692221
  error estimate for blocks of size 2^( 2) =       0.000408639647
  error estimate for blocks of size 2^( 3) =       0.000422451638
  error estimate for blocks of size 2^( 4) =       0.000435431010
  error estimate for blocks of size 2^( 5) =       0.000445543542
  error estimate for blocks of size 2^( 6) =       0.000451988933
  error estimate for blocks of size 2^( 7) =       0.000455648258

      target function =                  N/A
              le_mean =     -16.904031707249
             les_mean =     286.070334727548
             stat err =       0.000447152936
             autocorr =       1.283497538208
              std dev =       0.558179091461
             le_variance =       0.311563898145

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311673005968
                                         uncertainty =       0.003924550352

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311673005968
                                         uncertainty =       0.003924550352

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394692221
  error estimate for blocks of size 2^( 2) =       0.000408639647
  error estimate for blocks of size 2^( 3) =       0.000422451638
  error estimate for blocks of size 2^( 4) =       0.000435431010
  error estimate for blocks of size 2^( 5) =       0.000445543542
  error estimate for blocks of size 2^( 6) =       0.000451988933
  error estimate for blocks of size 2^( 7) =       0.000455648258

      target function =                  N/A
              le_mean =     -16.904031707249
             les_mean =     286.070334727548
             stat err =       0.000447152936
             autocorr =       1.283497538208
              std dev =       0.558179091461
             le_variance =       0.311563898145

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311673005968
                                         uncertainty =       0.003924550352

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311673005968
                                         uncertainty =       0.003924550352

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394692221
  error estimate for blocks of size 2^( 2) =       0.000408639647
  error estimate for blocks of size 2^( 3) =       0.000422451638
  error estimate for blocks of size 2^( 4) =       0.000435431010
  error estimate for blocks of size 2^( 5) =       0.000445543542
  error estimate for blocks of size 2^( 6) =       0.000451988933
  error estimate for blocks of size 2^( 7) =       0.000455648258

      target function =                  N/A
              le_mean =     -16.904031707249
             les_mean =     286.070334727548
             stat err =       0.000447152936
             autocorr =       1.283497538208
              std dev =       0.558179091461
             le_variance =       0.311563898145

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311673005968
                                         uncertainty =       0.003924550352

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311673005968
                                         uncertainty =       0.003924550352

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394692221
  error estimate for blocks of size 2^( 2) =       0.000408639647
  error estimate for blocks of size 2^( 3) =       0.000422451638
  error estimate for blocks of size 2^( 4) =       0.000435431010
  error estimate for blocks of size 2^( 5) =       0.000445543542
  error estimate for blocks of size 2^( 6) =       0.000451988933
  error estimate for blocks of size 2^( 7) =       0.000455648258

      target function =                  N/A
              le_mean =     -16.904031707249
             les_mean =     286.070334727548
             stat err =       0.000447152936
             autocorr =       1.283497538208
              std dev =       0.558179091461
             le_variance =       0.311563898145


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904031707249        initial  <--
     9.3132e+20     9.3132e+21             0.0000e+00       -16.904031707249
     3.7253e+21     3.7253e+22             0.0000e+00       -16.904031707249
     1.4901e+22     1.4901e+23             0.0000e+00       -16.904031707249

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.8325
  </log>
  <optVariables href="H2O.s044.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0855e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s045 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s045 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=45  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -16.9042
    reference variance = 0.153147
====================================================
  Execution time = 1.4399e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s045
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5233e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2055e-01
  Total weights = 1.952021502e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5743e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307092380361
                                         uncertainty =       0.001665073467

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307092380361
                                         uncertainty =       0.001665073467

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391850581
  error estimate for blocks of size 2^( 2) =       0.000405983148
  error estimate for blocks of size 2^( 3) =       0.000419886979
  error estimate for blocks of size 2^( 4) =       0.000432504285
  error estimate for blocks of size 2^( 5) =       0.000443637935
  error estimate for blocks of size 2^( 6) =       0.000452542367
  error estimate for blocks of size 2^( 7) =       0.000457125535

      target function =                  N/A
              le_mean =     -16.905330749316
             les_mean =     286.110760227052
             stat err =       0.000446452530
             autocorr =       1.298104298444
              std dev =       0.554160405442
             le_variance =       0.307093754960


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690533074932e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+21, overlap shift 9.3132e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905330749336       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905330749336       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+22, overlap shift 3.7253e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905330749336       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905330749336       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4901e+23, overlap shift 1.4901e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905330749336       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905330749336       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.224677 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6978e+01
  </log>
  <optVariables href="H2O.s045.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -16.9798
    reference variance = 0.318251
====================================================
  Execution time = 1.4489e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s045
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2410e-01
  Total weights = 1.9518e+06
  Execution time = 1.8786e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311641125744
                                         uncertainty =       0.002336248233

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311641125744
                                         uncertainty =       0.002336248233

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394764833
  error estimate for blocks of size 2^( 2) =       0.000408971065
  error estimate for blocks of size 2^( 3) =       0.000423941442
  error estimate for blocks of size 2^( 4) =       0.000436679366
  error estimate for blocks of size 2^( 5) =       0.000448293421
  error estimate for blocks of size 2^( 6) =       0.000455613413
  error estimate for blocks of size 2^( 7) =       0.000461151818

      target function =                  N/A
              le_mean =     -16.904095197611
             les_mean =     286.072537519125
             stat err =       0.000450434504
             autocorr =       1.301926263224
              std dev =       0.558281780742
             le_variance =       0.311678546709

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311641125744
                                         uncertainty =       0.002336248233

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311641125744
                                         uncertainty =       0.002336248233

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394764833
  error estimate for blocks of size 2^( 2) =       0.000408971065
  error estimate for blocks of size 2^( 3) =       0.000423941442
  error estimate for blocks of size 2^( 4) =       0.000436679366
  error estimate for blocks of size 2^( 5) =       0.000448293421
  error estimate for blocks of size 2^( 6) =       0.000455613413
  error estimate for blocks of size 2^( 7) =       0.000461151818

      target function =                  N/A
              le_mean =     -16.904095197611
             les_mean =     286.072537519125
             stat err =       0.000450434504
             autocorr =       1.301926263224
              std dev =       0.558281780742
             le_variance =       0.311678546709

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311641125744
                                         uncertainty =       0.002336248233

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311641125744
                                         uncertainty =       0.002336248233

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394764833
  error estimate for blocks of size 2^( 2) =       0.000408971065
  error estimate for blocks of size 2^( 3) =       0.000423941442
  error estimate for blocks of size 2^( 4) =       0.000436679366
  error estimate for blocks of size 2^( 5) =       0.000448293421
  error estimate for blocks of size 2^( 6) =       0.000455613413
  error estimate for blocks of size 2^( 7) =       0.000461151818

      target function =                  N/A
              le_mean =     -16.904095197611
             les_mean =     286.072537519125
             stat err =       0.000450434504
             autocorr =       1.301926263224
              std dev =       0.558281780742
             le_variance =       0.311678546709

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311641125744
                                         uncertainty =       0.002336248233

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311641125744
                                         uncertainty =       0.002336248233

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394764833
  error estimate for blocks of size 2^( 2) =       0.000408971065
  error estimate for blocks of size 2^( 3) =       0.000423941442
  error estimate for blocks of size 2^( 4) =       0.000436679366
  error estimate for blocks of size 2^( 5) =       0.000448293421
  error estimate for blocks of size 2^( 6) =       0.000455613413
  error estimate for blocks of size 2^( 7) =       0.000461151818

      target function =                  N/A
              le_mean =     -16.904095197611
             les_mean =     286.072537519125
             stat err =       0.000450434504
             autocorr =       1.301926263224
              std dev =       0.558281780742
             le_variance =       0.311678546709


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904095197611        initial  <--
     9.3132e+21     9.3132e+22             0.0000e+00       -16.904095197611
     3.7253e+22     3.7253e+23             0.0000e+00       -16.904095197611
     1.4901e+23     1.4901e+24             0.0000e+00       -16.904095197611

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.9834
  </log>
  <optVariables href="H2O.s045.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0968e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s046 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s046 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=46  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -16.8669
    reference variance = 0.302492
====================================================
  Execution time = 1.4590e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s046
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5225e+04
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.2682e-01
  Total weights = 1.951538637e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5678e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312934826911
                                         uncertainty =       0.002013427947

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312934826911
                                         uncertainty =       0.002013427947

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395570614
  error estimate for blocks of size 2^( 2) =       0.000410242208
  error estimate for blocks of size 2^( 3) =       0.000425136110
  error estimate for blocks of size 2^( 4) =       0.000438491954
  error estimate for blocks of size 2^( 5) =       0.000450108072
  error estimate for blocks of size 2^( 6) =       0.000459728524
  error estimate for blocks of size 2^( 7) =       0.000466280574

      target function =                  N/A
              le_mean =     -16.903113450293
             les_mean =     286.042065849681
             stat err =       0.000453652281
             autocorr =       1.315219247621
              std dev =       0.559421326660
             le_variance =       0.312952220722


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690311345029e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+22, overlap shift 9.3132e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903113450286       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903113450286       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+23, overlap shift 3.7253e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903113450286       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903113450286       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4901e+24, overlap shift 1.4901e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903113450286       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903113450286       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.225777 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7162e+01
  </log>
  <optVariables href="H2O.s046.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -16.8496
    reference variance = 0.205985
====================================================
  Execution time = 1.4289e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s046
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.3023e-01
  Total weights = 1.9515e+06
  Execution time = 1.8824e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317776651937
                                         uncertainty =       0.003279553863

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317776651937
                                         uncertainty =       0.003279553863

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398590595
  error estimate for blocks of size 2^( 2) =       0.000412856038
  error estimate for blocks of size 2^( 3) =       0.000427591995
  error estimate for blocks of size 2^( 4) =       0.000440633572
  error estimate for blocks of size 2^( 5) =       0.000452474166
  error estimate for blocks of size 2^( 6) =       0.000461726294
  error estimate for blocks of size 2^( 7) =       0.000464640577

      target function =                  N/A
              le_mean =     -16.904231035355
             les_mean =     286.083260206059
             stat err =       0.000454868652
             autocorr =       1.302320636300
              std dev =       0.563692224839
             le_variance =       0.317748924344

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317776651937
                                         uncertainty =       0.003279553863

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317776651937
                                         uncertainty =       0.003279553863

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398590595
  error estimate for blocks of size 2^( 2) =       0.000412856038
  error estimate for blocks of size 2^( 3) =       0.000427591995
  error estimate for blocks of size 2^( 4) =       0.000440633572
  error estimate for blocks of size 2^( 5) =       0.000452474166
  error estimate for blocks of size 2^( 6) =       0.000461726294
  error estimate for blocks of size 2^( 7) =       0.000464640577

      target function =                  N/A
              le_mean =     -16.904231035355
             les_mean =     286.083260206059
             stat err =       0.000454868652
             autocorr =       1.302320636300
              std dev =       0.563692224839
             le_variance =       0.317748924344

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317776651937
                                         uncertainty =       0.003279553863

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317776651937
                                         uncertainty =       0.003279553863

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398590595
  error estimate for blocks of size 2^( 2) =       0.000412856038
  error estimate for blocks of size 2^( 3) =       0.000427591995
  error estimate for blocks of size 2^( 4) =       0.000440633572
  error estimate for blocks of size 2^( 5) =       0.000452474166
  error estimate for blocks of size 2^( 6) =       0.000461726294
  error estimate for blocks of size 2^( 7) =       0.000464640577

      target function =                  N/A
              le_mean =     -16.904231035355
             les_mean =     286.083260206059
             stat err =       0.000454868652
             autocorr =       1.302320636300
              std dev =       0.563692224839
             le_variance =       0.317748924344

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317776651937
                                         uncertainty =       0.003279553863

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317776651937
                                         uncertainty =       0.003279553863

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398590595
  error estimate for blocks of size 2^( 2) =       0.000412856038
  error estimate for blocks of size 2^( 3) =       0.000427591995
  error estimate for blocks of size 2^( 4) =       0.000440633572
  error estimate for blocks of size 2^( 5) =       0.000452474166
  error estimate for blocks of size 2^( 6) =       0.000461726294
  error estimate for blocks of size 2^( 7) =       0.000464640577

      target function =                  N/A
              le_mean =     -16.904231035355
             les_mean =     286.083260206059
             stat err =       0.000454868652
             autocorr =       1.302320636300
              std dev =       0.563692224839
             le_variance =       0.317748924344


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904231035355        initial  <--
     9.3132e+22     9.3132e+23             0.0000e+00       -16.904231035355
     3.7253e+23     3.7253e+24             0.0000e+00       -16.904231035355
     1.4901e+24     1.4901e+25             0.0000e+00       -16.904231035355

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.8280
  </log>
  <optVariables href="H2O.s046.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0996e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s047 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s047 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=47  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -16.9636
    reference variance = 0.237373
====================================================
  Execution time = 1.4649e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s047
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5270e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2163e-01
  Total weights = 1.951958331e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5814e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312304357221
                                         uncertainty =       0.002129182680

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312304357221
                                         uncertainty =       0.002129182680

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395123187
  error estimate for blocks of size 2^( 2) =       0.000409203137
  error estimate for blocks of size 2^( 3) =       0.000423423043
  error estimate for blocks of size 2^( 4) =       0.000435881187
  error estimate for blocks of size 2^( 5) =       0.000445707463
  error estimate for blocks of size 2^( 6) =       0.000453460259
  error estimate for blocks of size 2^( 7) =       0.000456932424

      target function =                  N/A
              le_mean =     -16.904768214547
             les_mean =     286.092814922339
             stat err =       0.000447995333
             autocorr =       1.285529207794
              std dev =       0.558788569580
             le_variance =       0.312244665493


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690476821455e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+23, overlap shift 9.3132e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904768214544       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904768214544       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+24, overlap shift 3.7253e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904768214544       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904768214544       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4901e+25, overlap shift 1.4901e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904768214544       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904768214544       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+25 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.226887 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7235e+01
  </log>
  <optVariables href="H2O.s047.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -16.9143
    reference variance = 0.269286
====================================================
  Execution time = 1.6368e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s047
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2014e-01
  Total weights = 1.9517e+06
  Execution time = 1.8866e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309993514696
                                         uncertainty =       0.001967377079

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309993514696
                                         uncertainty =       0.001967377079

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393694537
  error estimate for blocks of size 2^( 2) =       0.000407818574
  error estimate for blocks of size 2^( 3) =       0.000422163585
  error estimate for blocks of size 2^( 4) =       0.000434898922
  error estimate for blocks of size 2^( 5) =       0.000447023709
  error estimate for blocks of size 2^( 6) =       0.000456550161
  error estimate for blocks of size 2^( 7) =       0.000461099493

      target function =                  N/A
              le_mean =     -16.903931584870
             les_mean =     286.063039135853
             stat err =       0.000449893071
             autocorr =       1.305869660029
              std dev =       0.556768154086
             le_variance =       0.309990777404

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309993514696
                                         uncertainty =       0.001967377079

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309993514696
                                         uncertainty =       0.001967377079

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393694537
  error estimate for blocks of size 2^( 2) =       0.000407818574
  error estimate for blocks of size 2^( 3) =       0.000422163585
  error estimate for blocks of size 2^( 4) =       0.000434898922
  error estimate for blocks of size 2^( 5) =       0.000447023709
  error estimate for blocks of size 2^( 6) =       0.000456550161
  error estimate for blocks of size 2^( 7) =       0.000461099493

      target function =                  N/A
              le_mean =     -16.903931584870
             les_mean =     286.063039135853
             stat err =       0.000449893071
             autocorr =       1.305869660029
              std dev =       0.556768154086
             le_variance =       0.309990777404

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309993514696
                                         uncertainty =       0.001967377079

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309993514696
                                         uncertainty =       0.001967377079

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393694537
  error estimate for blocks of size 2^( 2) =       0.000407818574
  error estimate for blocks of size 2^( 3) =       0.000422163585
  error estimate for blocks of size 2^( 4) =       0.000434898922
  error estimate for blocks of size 2^( 5) =       0.000447023709
  error estimate for blocks of size 2^( 6) =       0.000456550161
  error estimate for blocks of size 2^( 7) =       0.000461099493

      target function =                  N/A
              le_mean =     -16.903931584870
             les_mean =     286.063039135853
             stat err =       0.000449893071
             autocorr =       1.305869660029
              std dev =       0.556768154086
             le_variance =       0.309990777404

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309993514696
                                         uncertainty =       0.001967377079

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309993514696
                                         uncertainty =       0.001967377079

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393694537
  error estimate for blocks of size 2^( 2) =       0.000407818574
  error estimate for blocks of size 2^( 3) =       0.000422163585
  error estimate for blocks of size 2^( 4) =       0.000434898922
  error estimate for blocks of size 2^( 5) =       0.000447023709
  error estimate for blocks of size 2^( 6) =       0.000456550161
  error estimate for blocks of size 2^( 7) =       0.000461099493

      target function =                  N/A
              le_mean =     -16.903931584870
             les_mean =     286.063039135853
             stat err =       0.000449893071
             autocorr =       1.305869660029
              std dev =       0.556768154086
             le_variance =       0.309990777404


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.903931584870        initial  <--
     9.3132e+23     9.3132e+24             0.0000e+00       -16.903931584870
     3.7253e+24     3.7253e+25             0.0000e+00       -16.903931584870
     1.4901e+25     1.4901e+26             0.0000e+00       -16.903931584870

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 25.8977
  </log>
  <optVariables href="H2O.s047.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.3139e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s048 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s048 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=48  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -16.9015
    reference variance = 0.289258
====================================================
  Execution time = 1.4527e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s048
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5251e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2161e-01
  Total weights = 1.951878971e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5808e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308462450075
                                         uncertainty =       0.002029220438

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308462450075
                                         uncertainty =       0.002029220438

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392691588
  error estimate for blocks of size 2^( 2) =       0.000406889714
  error estimate for blocks of size 2^( 3) =       0.000420729907
  error estimate for blocks of size 2^( 4) =       0.000433054403
  error estimate for blocks of size 2^( 5) =       0.000444520009
  error estimate for blocks of size 2^( 6) =       0.000451225280
  error estimate for blocks of size 2^( 7) =       0.000454581515

      target function =                  N/A
              le_mean =     -16.904622379680
             les_mean =     286.087870596893
             stat err =       0.000445845302
             autocorr =       1.289036436308
              std dev =       0.555349768967
             le_variance =       0.308413365892


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690462237968e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+24, overlap shift 9.3132e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904622379698       residual = 1.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904622379698       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904622379698       residual = 3.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904622072378       residual = 1.08e+08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904622379690       residual = 1.06e+00           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e+24 is 7.575833e-29

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+25, overlap shift 3.7253e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904622379698       residual = 1.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904622379698       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904622379698       residual = 3.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904621102013       residual = 4.34e+08           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+25 is 1.893958e-29

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4901e+26, overlap shift 1.4901e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904622379698       residual = 1.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904622379698       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904622379698       residual = 3.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904622379698       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+26 is 4.734896e-30

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.228617 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7114e+01
  </log>
  <optVariables href="H2O.s048.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -16.9252
    reference variance = 0.221441
====================================================
  Execution time = 1.4335e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s048
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2409e-01
  Total weights = 1.9520e+06
  Execution time = 1.8879e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311490450232
                                         uncertainty =       0.001889721262

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311490450232
                                         uncertainty =       0.001889721262

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394621053
  error estimate for blocks of size 2^( 2) =       0.000408422148
  error estimate for blocks of size 2^( 3) =       0.000422437795
  error estimate for blocks of size 2^( 4) =       0.000435588899
  error estimate for blocks of size 2^( 5) =       0.000445230912
  error estimate for blocks of size 2^( 6) =       0.000451717733
  error estimate for blocks of size 2^( 7) =       0.000457944059

      target function =                  N/A
              le_mean =     -16.903825485909
             les_mean =     286.063409436288
             stat err =       0.000447620401
             autocorr =       1.286646491372
              std dev =       0.558078445841
             le_variance =       0.311451551713

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311490450232
                                         uncertainty =       0.001889721262

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311490450232
                                         uncertainty =       0.001889721262

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394621053
  error estimate for blocks of size 2^( 2) =       0.000408422148
  error estimate for blocks of size 2^( 3) =       0.000422437795
  error estimate for blocks of size 2^( 4) =       0.000435588899
  error estimate for blocks of size 2^( 5) =       0.000445230912
  error estimate for blocks of size 2^( 6) =       0.000451717733
  error estimate for blocks of size 2^( 7) =       0.000457944059

      target function =                  N/A
              le_mean =     -16.903825485909
             les_mean =     286.063409436288
             stat err =       0.000447620401
             autocorr =       1.286646491372
              std dev =       0.558078445841
             le_variance =       0.311451551713

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311490450232
                                         uncertainty =       0.001889721262

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311490450232
                                         uncertainty =       0.001889721262

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394621053
  error estimate for blocks of size 2^( 2) =       0.000408422148
  error estimate for blocks of size 2^( 3) =       0.000422437795
  error estimate for blocks of size 2^( 4) =       0.000435588899
  error estimate for blocks of size 2^( 5) =       0.000445230912
  error estimate for blocks of size 2^( 6) =       0.000451717733
  error estimate for blocks of size 2^( 7) =       0.000457944059

      target function =                  N/A
              le_mean =     -16.903825485909
             les_mean =     286.063409436288
             stat err =       0.000447620401
             autocorr =       1.286646491372
              std dev =       0.558078445841
             le_variance =       0.311451551713

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311490450232
                                         uncertainty =       0.001889721262

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311490450232
                                         uncertainty =       0.001889721262

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394621053
  error estimate for blocks of size 2^( 2) =       0.000408422148
  error estimate for blocks of size 2^( 3) =       0.000422437795
  error estimate for blocks of size 2^( 4) =       0.000435588899
  error estimate for blocks of size 2^( 5) =       0.000445230912
  error estimate for blocks of size 2^( 6) =       0.000451717733
  error estimate for blocks of size 2^( 7) =       0.000457944059

      target function =                  N/A
              le_mean =     -16.903825485909
             les_mean =     286.063409436288
             stat err =       0.000447620401
             autocorr =       1.286646491372
              std dev =       0.558078445841
             le_variance =       0.311451551713


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.903825485909        initial  <--
     9.3132e+24     9.3132e+25             7.5758e-29       -16.903825485909
     3.7253e+25     3.7253e+26             1.8940e-29       -16.903825485909
     1.4901e+26     1.4901e+27             4.7349e-30       -16.903825485909

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.8239
  </log>
  <optVariables href="H2O.s048.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0943e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s049 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s049 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=49  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -16.8581
    reference variance = 0.87273
====================================================
  Execution time = 1.4764e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s049
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5272e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2198e-01
  Total weights = 1.951598558e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5681e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307935384817
                                         uncertainty =       0.002512074621

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307935384817
                                         uncertainty =       0.002512074621

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392417308
  error estimate for blocks of size 2^( 2) =       0.000406194216
  error estimate for blocks of size 2^( 3) =       0.000420165652
  error estimate for blocks of size 2^( 4) =       0.000433193929
  error estimate for blocks of size 2^( 5) =       0.000443644015
  error estimate for blocks of size 2^( 6) =       0.000452523388
  error estimate for blocks of size 2^( 7) =       0.000455183221

      target function =                  N/A
              le_mean =     -16.904379332274
             les_mean =     286.080021398986
             stat err =       0.000446136138
             autocorr =       1.292523651262
              std dev =       0.554961879185
             le_variance =       0.307982687349


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690437933227e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+25, overlap shift 9.3132e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904379332246       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904379332246       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e+25 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+26, overlap shift 3.7253e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904379332246       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904379332246       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+26 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4901e+27, overlap shift 1.4901e+28 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904379332246       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904379332246       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+27 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.229682 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7337e+01
  </log>
  <optVariables href="H2O.s049.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -16.8872
    reference variance = 0.187565
====================================================
  Execution time = 1.4194e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s049
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2292e-01
  Total weights = 1.9519e+06
  Execution time = 1.8824e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312044830235
                                         uncertainty =       0.002136371168

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312044830235
                                         uncertainty =       0.002136371168

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394996973
  error estimate for blocks of size 2^( 2) =       0.000408541655
  error estimate for blocks of size 2^( 3) =       0.000422610910
  error estimate for blocks of size 2^( 4) =       0.000435950946
  error estimate for blocks of size 2^( 5) =       0.000446925039
  error estimate for blocks of size 2^( 6) =       0.000454897151
  error estimate for blocks of size 2^( 7) =       0.000459175857

      target function =                  N/A
              le_mean =     -16.904233836456
             les_mean =     286.076038287841
             stat err =       0.000449237248
             autocorr =       1.293492700828
              std dev =       0.558610075816
             le_variance =       0.312045216803

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312044830235
                                         uncertainty =       0.002136371168

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312044830235
                                         uncertainty =       0.002136371168

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394996973
  error estimate for blocks of size 2^( 2) =       0.000408541655
  error estimate for blocks of size 2^( 3) =       0.000422610910
  error estimate for blocks of size 2^( 4) =       0.000435950946
  error estimate for blocks of size 2^( 5) =       0.000446925039
  error estimate for blocks of size 2^( 6) =       0.000454897151
  error estimate for blocks of size 2^( 7) =       0.000459175857

      target function =                  N/A
              le_mean =     -16.904233836456
             les_mean =     286.076038287841
             stat err =       0.000449237248
             autocorr =       1.293492700828
              std dev =       0.558610075816
             le_variance =       0.312045216803

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312044830235
                                         uncertainty =       0.002136371168

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312044830235
                                         uncertainty =       0.002136371168

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394996973
  error estimate for blocks of size 2^( 2) =       0.000408541655
  error estimate for blocks of size 2^( 3) =       0.000422610910
  error estimate for blocks of size 2^( 4) =       0.000435950946
  error estimate for blocks of size 2^( 5) =       0.000446925039
  error estimate for blocks of size 2^( 6) =       0.000454897151
  error estimate for blocks of size 2^( 7) =       0.000459175857

      target function =                  N/A
              le_mean =     -16.904233836456
             les_mean =     286.076038287841
             stat err =       0.000449237248
             autocorr =       1.293492700828
              std dev =       0.558610075816
             le_variance =       0.312045216803

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312044830235
                                         uncertainty =       0.002136371168

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312044830235
                                         uncertainty =       0.002136371168

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394996973
  error estimate for blocks of size 2^( 2) =       0.000408541655
  error estimate for blocks of size 2^( 3) =       0.000422610910
  error estimate for blocks of size 2^( 4) =       0.000435950946
  error estimate for blocks of size 2^( 5) =       0.000446925039
  error estimate for blocks of size 2^( 6) =       0.000454897151
  error estimate for blocks of size 2^( 7) =       0.000459175857

      target function =                  N/A
              le_mean =     -16.904233836456
             les_mean =     286.076038287841
             stat err =       0.000449237248
             autocorr =       1.293492700828
              std dev =       0.558610075816
             le_variance =       0.312045216803


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904233836456        initial  <--
     9.3132e+25     9.3132e+26             0.0000e+00       -16.904233836456
     3.7253e+26     3.7253e+27             0.0000e+00       -16.904233836456
     1.4901e+27     1.4901e+28             0.0000e+00       -16.904233836456

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.7076
  </log>
  <optVariables href="H2O.s049.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1050e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s050 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s050 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=50  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -16.8373
    reference variance = 0.221609
====================================================
  Execution time = 1.4428e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s050
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5237e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2368e-01
  Total weights = 1.951933523e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5746e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311604640387
                                         uncertainty =       0.002206711653

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311604640387
                                         uncertainty =       0.002206711653

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394705099
  error estimate for blocks of size 2^( 2) =       0.000409171985
  error estimate for blocks of size 2^( 3) =       0.000424156731
  error estimate for blocks of size 2^( 4) =       0.000437734220
  error estimate for blocks of size 2^( 5) =       0.000450163588
  error estimate for blocks of size 2^( 6) =       0.000460707385
  error estimate for blocks of size 2^( 7) =       0.000468986558

      target function =                  N/A
              le_mean =     -16.904575615253
             les_mean =     286.088355123758
             stat err =       0.000454397938
             autocorr =       1.325339770436
              std dev =       0.558197303658
             le_variance =       0.311584229811


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690457561525e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+26, overlap shift 9.3132e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904575615263       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904575615263       residual = 8.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904575615263       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e+26 is 4.359497e-31

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+27, overlap shift 3.7253e+28 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904575615263       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904575615263       residual = 8.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904575615263       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+27 is 1.089874e-31

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4901e+28, overlap shift 1.4901e+29 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904575615263       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904575615263       residual = 8.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904575615263       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+28 is 2.724686e-32

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.231029 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7008e+01
  </log>
  <optVariables href="H2O.s050.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -16.8387
    reference variance = 0.28527
====================================================
  Execution time = 1.4194e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s050
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2653e-01
  Total weights = 1.9517e+06
  Execution time = 1.8795e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312368948271
                                         uncertainty =       0.002351022582

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312368948271
                                         uncertainty =       0.002351022582

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395226173
  error estimate for blocks of size 2^( 2) =       0.000409576280
  error estimate for blocks of size 2^( 3) =       0.000423668318
  error estimate for blocks of size 2^( 4) =       0.000436116291
  error estimate for blocks of size 2^( 5) =       0.000447513159
  error estimate for blocks of size 2^( 6) =       0.000457910368
  error estimate for blocks of size 2^( 7) =       0.000462805235

      target function =                  N/A
              le_mean =     -16.904609962362
             les_mean =     286.092372233328
             stat err =       0.000451086263
             autocorr =       1.302650196210
              std dev =       0.558934214310
             le_variance =       0.312407455926

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312368948271
                                         uncertainty =       0.002351022582

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312368948271
                                         uncertainty =       0.002351022582

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395226173
  error estimate for blocks of size 2^( 2) =       0.000409576280
  error estimate for blocks of size 2^( 3) =       0.000423668318
  error estimate for blocks of size 2^( 4) =       0.000436116291
  error estimate for blocks of size 2^( 5) =       0.000447513159
  error estimate for blocks of size 2^( 6) =       0.000457910368
  error estimate for blocks of size 2^( 7) =       0.000462805235

      target function =                  N/A
              le_mean =     -16.904609962362
             les_mean =     286.092372233328
             stat err =       0.000451086263
             autocorr =       1.302650196210
              std dev =       0.558934214310
             le_variance =       0.312407455926

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312368948271
                                         uncertainty =       0.002351022582

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312368948271
                                         uncertainty =       0.002351022582

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395226173
  error estimate for blocks of size 2^( 2) =       0.000409576280
  error estimate for blocks of size 2^( 3) =       0.000423668318
  error estimate for blocks of size 2^( 4) =       0.000436116291
  error estimate for blocks of size 2^( 5) =       0.000447513159
  error estimate for blocks of size 2^( 6) =       0.000457910368
  error estimate for blocks of size 2^( 7) =       0.000462805235

      target function =                  N/A
              le_mean =     -16.904609962362
             les_mean =     286.092372233328
             stat err =       0.000451086263
             autocorr =       1.302650196210
              std dev =       0.558934214310
             le_variance =       0.312407455926

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312368948271
                                         uncertainty =       0.002351022582

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312368948271
                                         uncertainty =       0.002351022582

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395226173
  error estimate for blocks of size 2^( 2) =       0.000409576280
  error estimate for blocks of size 2^( 3) =       0.000423668318
  error estimate for blocks of size 2^( 4) =       0.000436116291
  error estimate for blocks of size 2^( 5) =       0.000447513159
  error estimate for blocks of size 2^( 6) =       0.000457910368
  error estimate for blocks of size 2^( 7) =       0.000462805235

      target function =                  N/A
              le_mean =     -16.904609962362
             les_mean =     286.092372233328
             stat err =       0.000451086263
             autocorr =       1.302650196210
              std dev =       0.558934214310
             le_variance =       0.312407455926


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904609962362        initial  <--
     9.3132e+26     9.3132e+27             4.3595e-31       -16.904609962362
     3.7253e+27     3.7253e+28             1.0899e-31       -16.904609962362
     1.4901e+28     1.4901e+29             2.7247e-32       -16.904609962362

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.6988
  </log>
  <optVariables href="H2O.s050.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0724e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s051 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s051 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=51  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -16.9271
    reference variance = 0.304236
====================================================
  Execution time = 1.4267e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s051
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5236e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2801e-01
  Total weights = 1.952056290e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5545e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314085836731
                                         uncertainty =       0.002386152425

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314085836731
                                         uncertainty =       0.002386152425

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396261154
  error estimate for blocks of size 2^( 2) =       0.000410294765
  error estimate for blocks of size 2^( 3) =       0.000424337477
  error estimate for blocks of size 2^( 4) =       0.000437051632
  error estimate for blocks of size 2^( 5) =       0.000448715692
  error estimate for blocks of size 2^( 6) =       0.000455918236
  error estimate for blocks of size 2^( 7) =       0.000461566031

      target function =                  N/A
              le_mean =     -16.905260708118
             les_mean =     286.115849944502
             stat err =       0.000450812898
             autocorr =       1.294284249474
              std dev =       0.560397897588
             le_variance =       0.314045803621


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690526070812e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+27, overlap shift 9.3132e+28 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905260708158       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905260708158       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e+27 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+28, overlap shift 3.7253e+29 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905260708158       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905260708158       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+28 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4901e+29, overlap shift 1.4901e+30 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905260708158       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905260708158       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+29 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.232079 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6826e+01
  </log>
  <optVariables href="H2O.s051.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -16.8672
    reference variance = 0.261908
====================================================
  Execution time = 1.4145e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s051
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2096e-01
  Total weights = 1.9519e+06
  Execution time = 1.8897e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310022651761
                                         uncertainty =       0.002206272638

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310022651761
                                         uncertainty =       0.002206272638

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393667926
  error estimate for blocks of size 2^( 2) =       0.000408149731
  error estimate for blocks of size 2^( 3) =       0.000422121740
  error estimate for blocks of size 2^( 4) =       0.000435412442
  error estimate for blocks of size 2^( 5) =       0.000448208778
  error estimate for blocks of size 2^( 6) =       0.000457713834
  error estimate for blocks of size 2^( 7) =       0.000464401666

      target function =                  N/A
              le_mean =     -16.904291627951
             les_mean =     286.076034526265
             stat err =       0.000451434180
             autocorr =       1.315009262886
              std dev =       0.556730519982
             le_variance =       0.309948871880

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310022651761
                                         uncertainty =       0.002206272638

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310022651761
                                         uncertainty =       0.002206272638

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393667926
  error estimate for blocks of size 2^( 2) =       0.000408149731
  error estimate for blocks of size 2^( 3) =       0.000422121740
  error estimate for blocks of size 2^( 4) =       0.000435412442
  error estimate for blocks of size 2^( 5) =       0.000448208778
  error estimate for blocks of size 2^( 6) =       0.000457713834
  error estimate for blocks of size 2^( 7) =       0.000464401666

      target function =                  N/A
              le_mean =     -16.904291627951
             les_mean =     286.076034526265
             stat err =       0.000451434180
             autocorr =       1.315009262886
              std dev =       0.556730519982
             le_variance =       0.309948871880

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310022651761
                                         uncertainty =       0.002206272638

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310022651761
                                         uncertainty =       0.002206272638

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393667926
  error estimate for blocks of size 2^( 2) =       0.000408149731
  error estimate for blocks of size 2^( 3) =       0.000422121740
  error estimate for blocks of size 2^( 4) =       0.000435412442
  error estimate for blocks of size 2^( 5) =       0.000448208778
  error estimate for blocks of size 2^( 6) =       0.000457713834
  error estimate for blocks of size 2^( 7) =       0.000464401666

      target function =                  N/A
              le_mean =     -16.904291627951
             les_mean =     286.076034526265
             stat err =       0.000451434180
             autocorr =       1.315009262886
              std dev =       0.556730519982
             le_variance =       0.309948871880

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310022651761
                                         uncertainty =       0.002206272638

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310022651761
                                         uncertainty =       0.002206272638

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393667926
  error estimate for blocks of size 2^( 2) =       0.000408149731
  error estimate for blocks of size 2^( 3) =       0.000422121740
  error estimate for blocks of size 2^( 4) =       0.000435412442
  error estimate for blocks of size 2^( 5) =       0.000448208778
  error estimate for blocks of size 2^( 6) =       0.000457713834
  error estimate for blocks of size 2^( 7) =       0.000464401666

      target function =                  N/A
              le_mean =     -16.904291627951
             les_mean =     286.076034526265
             stat err =       0.000451434180
             autocorr =       1.315009262886
              std dev =       0.556730519982
             le_variance =       0.309948871880


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904291627951        initial  <--
     9.3132e+27     9.3132e+28             0.0000e+00       -16.904291627951
     3.7253e+28     3.7253e+29             0.0000e+00       -16.904291627951
     1.4901e+29     1.4901e+30             0.0000e+00       -16.904291627951

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.6848
  </log>
  <optVariables href="H2O.s051.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0517e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s052 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s052 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=52  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -16.8874
    reference variance = 0.239538
====================================================
  Execution time = 1.4449e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s052
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5243e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2734e-01
  Total weights = 1.951785126e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5718e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313813751231
                                         uncertainty =       0.002375682993

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313813751231
                                         uncertainty =       0.002375682993

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396129835
  error estimate for blocks of size 2^( 2) =       0.000410180223
  error estimate for blocks of size 2^( 3) =       0.000424906924
  error estimate for blocks of size 2^( 4) =       0.000438381985
  error estimate for blocks of size 2^( 5) =       0.000449961481
  error estimate for blocks of size 2^( 6) =       0.000457801179
  error estimate for blocks of size 2^( 7) =       0.000463667569

      target function =                  N/A
              le_mean =     -16.904048335146
             les_mean =     286.074192395046
             stat err =       0.000452453054
             autocorr =       1.304583678218
              std dev =       0.560212185280
             le_variance =       0.313837692537


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690404833515e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+28, overlap shift 9.3132e+29 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904048335149       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904048335149       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e+28 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+29, overlap shift 3.7253e+30 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904048335149       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904048335149       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+29 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4901e+30, overlap shift 1.4901e+31 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904048335149       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904048335149       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+30 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.233165 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7026e+01
  </log>
  <optVariables href="H2O.s052.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -16.9562
    reference variance = 0.234374
====================================================
  Execution time = 1.4036e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s052
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2105e-01
  Total weights = 1.9517e+06
  Execution time = 1.8848e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309916594738
                                         uncertainty =       0.002690757199

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309916594738
                                         uncertainty =       0.002690757199

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393625731
  error estimate for blocks of size 2^( 2) =       0.000407697226
  error estimate for blocks of size 2^( 3) =       0.000422218367
  error estimate for blocks of size 2^( 4) =       0.000435863385
  error estimate for blocks of size 2^( 5) =       0.000446826499
  error estimate for blocks of size 2^( 6) =       0.000456623579
  error estimate for blocks of size 2^( 7) =       0.000465364735

      target function =                  N/A
              le_mean =     -16.904040808848
             les_mean =     286.067643263158
             stat err =       0.000451169550
             autocorr =       1.313749614338
              std dev =       0.556670846671
             le_variance =       0.309882431533

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309916594738
                                         uncertainty =       0.002690757199

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309916594738
                                         uncertainty =       0.002690757199

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393625731
  error estimate for blocks of size 2^( 2) =       0.000407697226
  error estimate for blocks of size 2^( 3) =       0.000422218367
  error estimate for blocks of size 2^( 4) =       0.000435863385
  error estimate for blocks of size 2^( 5) =       0.000446826499
  error estimate for blocks of size 2^( 6) =       0.000456623579
  error estimate for blocks of size 2^( 7) =       0.000465364735

      target function =                  N/A
              le_mean =     -16.904040808848
             les_mean =     286.067643263158
             stat err =       0.000451169550
             autocorr =       1.313749614338
              std dev =       0.556670846671
             le_variance =       0.309882431533

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309916594738
                                         uncertainty =       0.002690757199

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309916594738
                                         uncertainty =       0.002690757199

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393625731
  error estimate for blocks of size 2^( 2) =       0.000407697226
  error estimate for blocks of size 2^( 3) =       0.000422218367
  error estimate for blocks of size 2^( 4) =       0.000435863385
  error estimate for blocks of size 2^( 5) =       0.000446826499
  error estimate for blocks of size 2^( 6) =       0.000456623579
  error estimate for blocks of size 2^( 7) =       0.000465364735

      target function =                  N/A
              le_mean =     -16.904040808848
             les_mean =     286.067643263158
             stat err =       0.000451169550
             autocorr =       1.313749614338
              std dev =       0.556670846671
             le_variance =       0.309882431533

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309916594738
                                         uncertainty =       0.002690757199

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309916594738
                                         uncertainty =       0.002690757199

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393625731
  error estimate for blocks of size 2^( 2) =       0.000407697226
  error estimate for blocks of size 2^( 3) =       0.000422218367
  error estimate for blocks of size 2^( 4) =       0.000435863385
  error estimate for blocks of size 2^( 5) =       0.000446826499
  error estimate for blocks of size 2^( 6) =       0.000456623579
  error estimate for blocks of size 2^( 7) =       0.000465364735

      target function =                  N/A
              le_mean =     -16.904040808848
             les_mean =     286.067643263158
             stat err =       0.000451169550
             autocorr =       1.313749614338
              std dev =       0.556670846671
             le_variance =       0.309882431533


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904040808848        initial  <--
     9.3132e+28     9.3132e+29             0.0000e+00       -16.904040808848
     3.7253e+29     3.7253e+30             0.0000e+00       -16.904040808848
     1.4901e+30     1.4901e+31             0.0000e+00       -16.904040808848

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.5776
  </log>
  <optVariables href="H2O.s052.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0609e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s053 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s053 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=53  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -16.9023
    reference variance = 0.268717
====================================================
  Execution time = 1.4307e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s053
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5282e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2277e-01
  Total weights = 1.951650746e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5658e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308870399230
                                         uncertainty =       0.001885420743

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308870399230
                                         uncertainty =       0.001885420743

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393002236
  error estimate for blocks of size 2^( 2) =       0.000406837203
  error estimate for blocks of size 2^( 3) =       0.000421246753
  error estimate for blocks of size 2^( 4) =       0.000433691205
  error estimate for blocks of size 2^( 5) =       0.000445140324
  error estimate for blocks of size 2^( 6) =       0.000451481605
  error estimate for blocks of size 2^( 7) =       0.000454501378

      target function =                  N/A
              le_mean =     -16.903967127103
             les_mean =     286.066870083505
             stat err =       0.000446203628
             autocorr =       1.289068959761
              std dev =       0.555789092653
             le_variance =       0.308901515512


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690396712710e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+29, overlap shift 9.3132e+30 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903967127095       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903967127095       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e+29 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+30, overlap shift 3.7253e+31 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903967127095       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903967127095       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+30 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4901e+31, overlap shift 1.4901e+32 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903967127095       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903967127095       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+31 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.234282 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6878e+01
  </log>
  <optVariables href="H2O.s053.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -16.8391
    reference variance = 0.990721
====================================================
  Execution time = 1.4170e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s053
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2338e-01
  Total weights = 1.9518e+06
  Execution time = 1.8879e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312847630786
                                         uncertainty =       0.001983484022

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312847630786
                                         uncertainty =       0.001983484022

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395523518
  error estimate for blocks of size 2^( 2) =       0.000409512374
  error estimate for blocks of size 2^( 3) =       0.000423785927
  error estimate for blocks of size 2^( 4) =       0.000436497112
  error estimate for blocks of size 2^( 5) =       0.000446662103
  error estimate for blocks of size 2^( 6) =       0.000455583198
  error estimate for blocks of size 2^( 7) =       0.000459615778

      target function =                  N/A
              le_mean =     -16.904171909859
             les_mean =     286.074403791098
             stat err =       0.000449589548
             autocorr =       1.292075194160
              std dev =       0.559354723037
             le_variance =       0.312877706183

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312847630786
                                         uncertainty =       0.001983484022

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312847630786
                                         uncertainty =       0.001983484022

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395523518
  error estimate for blocks of size 2^( 2) =       0.000409512374
  error estimate for blocks of size 2^( 3) =       0.000423785927
  error estimate for blocks of size 2^( 4) =       0.000436497112
  error estimate for blocks of size 2^( 5) =       0.000446662103
  error estimate for blocks of size 2^( 6) =       0.000455583198
  error estimate for blocks of size 2^( 7) =       0.000459615778

      target function =                  N/A
              le_mean =     -16.904171909859
             les_mean =     286.074403791098
             stat err =       0.000449589548
             autocorr =       1.292075194160
              std dev =       0.559354723037
             le_variance =       0.312877706183

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312847630786
                                         uncertainty =       0.001983484022

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312847630786
                                         uncertainty =       0.001983484022

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395523518
  error estimate for blocks of size 2^( 2) =       0.000409512374
  error estimate for blocks of size 2^( 3) =       0.000423785927
  error estimate for blocks of size 2^( 4) =       0.000436497112
  error estimate for blocks of size 2^( 5) =       0.000446662103
  error estimate for blocks of size 2^( 6) =       0.000455583198
  error estimate for blocks of size 2^( 7) =       0.000459615778

      target function =                  N/A
              le_mean =     -16.904171909859
             les_mean =     286.074403791098
             stat err =       0.000449589548
             autocorr =       1.292075194160
              std dev =       0.559354723037
             le_variance =       0.312877706183

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312847630786
                                         uncertainty =       0.001983484022

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312847630786
                                         uncertainty =       0.001983484022

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395523518
  error estimate for blocks of size 2^( 2) =       0.000409512374
  error estimate for blocks of size 2^( 3) =       0.000423785927
  error estimate for blocks of size 2^( 4) =       0.000436497112
  error estimate for blocks of size 2^( 5) =       0.000446662103
  error estimate for blocks of size 2^( 6) =       0.000455583198
  error estimate for blocks of size 2^( 7) =       0.000459615778

      target function =                  N/A
              le_mean =     -16.904171909859
             les_mean =     286.074403791098
             stat err =       0.000449589548
             autocorr =       1.292075194160
              std dev =       0.559354723037
             le_variance =       0.312877706183


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904171909859        initial  <--
     9.3132e+29     9.3132e+30             0.0000e+00       -16.904171909859
     3.7253e+30     3.7253e+31             0.0000e+00       -16.904171909859
     1.4901e+31     1.4901e+32             0.0000e+00       -16.904171909859

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.6977
  </log>
  <optVariables href="H2O.s053.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0582e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s054 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s054 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=54  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -16.9171
    reference variance = 0.201242
====================================================
  Execution time = 1.4400e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s054
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5259e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2578e-01
  Total weights = 1.951835812e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5763e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309425978037
                                         uncertainty =       0.002379133033

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309425978037
                                         uncertainty =       0.002379133033

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393303173
  error estimate for blocks of size 2^( 2) =       0.000407254915
  error estimate for blocks of size 2^( 3) =       0.000421148040
  error estimate for blocks of size 2^( 4) =       0.000434459057
  error estimate for blocks of size 2^( 5) =       0.000444591848
  error estimate for blocks of size 2^( 6) =       0.000452004594
  error estimate for blocks of size 2^( 7) =       0.000457449837

      target function =                  N/A
              le_mean =     -16.905128041133
             les_mean =     286.109136083931
             stat err =       0.000447126334
             autocorr =       1.292425736118
              std dev =       0.556214681289
             le_variance =       0.309374771681


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690512804113e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+30, overlap shift 9.3132e+31 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905128041112       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905128041112       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e+30 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+31, overlap shift 3.7253e+32 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905128041112       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905128041112       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+31 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4901e+32, overlap shift 1.4901e+33 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905128041112       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905128041112       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+32 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.235308 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6981e+01
  </log>
  <optVariables href="H2O.s054.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -16.8454
    reference variance = 0.201989
====================================================
  Execution time = 1.4124e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s054
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.1988e-01
  Total weights = 1.9521e+06
  Execution time = 2.3227e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310349303842
                                         uncertainty =       0.002467656182

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310349303842
                                         uncertainty =       0.002467656182

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393880741
  error estimate for blocks of size 2^( 2) =       0.000407727116
  error estimate for blocks of size 2^( 3) =       0.000421811455
  error estimate for blocks of size 2^( 4) =       0.000433888012
  error estimate for blocks of size 2^( 5) =       0.000444161412
  error estimate for blocks of size 2^( 6) =       0.000450533695
  error estimate for blocks of size 2^( 7) =       0.000455335335

      target function =                  N/A
              le_mean =     -16.904205137908
             les_mean =     286.072027433266
             stat err =       0.000445979614
             autocorr =       1.282036889712
              std dev =       0.557031485470
             le_variance =       0.310284075805

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310349303842
                                         uncertainty =       0.002467656182

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310349303842
                                         uncertainty =       0.002467656182

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393880741
  error estimate for blocks of size 2^( 2) =       0.000407727116
  error estimate for blocks of size 2^( 3) =       0.000421811455
  error estimate for blocks of size 2^( 4) =       0.000433888012
  error estimate for blocks of size 2^( 5) =       0.000444161412
  error estimate for blocks of size 2^( 6) =       0.000450533695
  error estimate for blocks of size 2^( 7) =       0.000455335335

      target function =                  N/A
              le_mean =     -16.904205137908
             les_mean =     286.072027433266
             stat err =       0.000445979614
             autocorr =       1.282036889712
              std dev =       0.557031485470
             le_variance =       0.310284075805

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310349303842
                                         uncertainty =       0.002467656182

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310349303842
                                         uncertainty =       0.002467656182

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393880741
  error estimate for blocks of size 2^( 2) =       0.000407727116
  error estimate for blocks of size 2^( 3) =       0.000421811455
  error estimate for blocks of size 2^( 4) =       0.000433888012
  error estimate for blocks of size 2^( 5) =       0.000444161412
  error estimate for blocks of size 2^( 6) =       0.000450533695
  error estimate for blocks of size 2^( 7) =       0.000455335335

      target function =                  N/A
              le_mean =     -16.904205137908
             les_mean =     286.072027433266
             stat err =       0.000445979614
             autocorr =       1.282036889712
              std dev =       0.557031485470
             le_variance =       0.310284075805

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310349303842
                                         uncertainty =       0.002467656182

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310349303842
                                         uncertainty =       0.002467656182

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393880741
  error estimate for blocks of size 2^( 2) =       0.000407727116
  error estimate for blocks of size 2^( 3) =       0.000421811455
  error estimate for blocks of size 2^( 4) =       0.000433888012
  error estimate for blocks of size 2^( 5) =       0.000444161412
  error estimate for blocks of size 2^( 6) =       0.000450533695
  error estimate for blocks of size 2^( 7) =       0.000455335335

      target function =                  N/A
              le_mean =     -16.904205137908
             les_mean =     286.072027433266
             stat err =       0.000445979614
             autocorr =       1.282036889712
              std dev =       0.557031485470
             le_variance =       0.310284075805


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904205137908        initial  <--
     9.3132e+30     9.3132e+31             0.0000e+00       -16.904205137908
     3.7253e+31     3.7253e+32             0.0000e+00       -16.904205137908
     1.4901e+32     1.4901e+33             0.0000e+00       -16.904205137908

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.7946
  </log>
  <optVariables href="H2O.s054.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1781e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s055 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s055 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=55  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -16.9145
    reference variance = 0.207376
====================================================
  Execution time = 1.4370e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s055
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5263e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2343e-01
  Total weights = 1.951979376e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6049e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309255019679
                                         uncertainty =       0.002912351111

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309255019679
                                         uncertainty =       0.002912351111

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393199551
  error estimate for blocks of size 2^( 2) =       0.000407362729
  error estimate for blocks of size 2^( 3) =       0.000421448032
  error estimate for blocks of size 2^( 4) =       0.000434102994
  error estimate for blocks of size 2^( 5) =       0.000445123984
  error estimate for blocks of size 2^( 6) =       0.000453283843
  error estimate for blocks of size 2^( 7) =       0.000457723379

      target function =                  N/A
              le_mean =     -16.904633986663
             les_mean =     286.090081949724
             stat err =       0.000447558550
             autocorr =       1.295608203540
              std dev =       0.556068138298
             le_variance =       0.309211774430


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690463398666e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+31, overlap shift 9.3132e+32 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904633986687       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904633986687       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e+31 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+32, overlap shift 3.7253e+33 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904633986687       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904633986687       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+32 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4901e+33, overlap shift 1.4901e+34 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904633986687       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904633986687       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+33 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.236419 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6980e+01
  </log>
  <optVariables href="H2O.s055.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -16.8598
    reference variance = 0.367848
====================================================
  Execution time = 1.4285e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s055
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.2125e-01
  Total weights = 1.9520e+06
  Execution time = 1.8882e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309900225100
                                         uncertainty =       0.001776289272

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309900225100
                                         uncertainty =       0.001776289272

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393618274
  error estimate for blocks of size 2^( 2) =       0.000408249069
  error estimate for blocks of size 2^( 3) =       0.000422612423
  error estimate for blocks of size 2^( 4) =       0.000435286590
  error estimate for blocks of size 2^( 5) =       0.000445464361
  error estimate for blocks of size 2^( 6) =       0.000455521648
  error estimate for blocks of size 2^( 7) =       0.000461263636

      target function =                  N/A
              le_mean =     -16.903119979575
             les_mean =     286.036710928516
             stat err =       0.000449384059
             autocorr =       1.303421318926
              std dev =       0.556660301203
             le_variance =       0.309870690936

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309900225100
                                         uncertainty =       0.001776289272

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309900225100
                                         uncertainty =       0.001776289272

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393618274
  error estimate for blocks of size 2^( 2) =       0.000408249069
  error estimate for blocks of size 2^( 3) =       0.000422612423
  error estimate for blocks of size 2^( 4) =       0.000435286590
  error estimate for blocks of size 2^( 5) =       0.000445464361
  error estimate for blocks of size 2^( 6) =       0.000455521648
  error estimate for blocks of size 2^( 7) =       0.000461263636

      target function =                  N/A
              le_mean =     -16.903119979575
             les_mean =     286.036710928516
             stat err =       0.000449384059
             autocorr =       1.303421318926
              std dev =       0.556660301203
             le_variance =       0.309870690936

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309900225100
                                         uncertainty =       0.001776289272

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309900225100
                                         uncertainty =       0.001776289272

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393618274
  error estimate for blocks of size 2^( 2) =       0.000408249069
  error estimate for blocks of size 2^( 3) =       0.000422612423
  error estimate for blocks of size 2^( 4) =       0.000435286590
  error estimate for blocks of size 2^( 5) =       0.000445464361
  error estimate for blocks of size 2^( 6) =       0.000455521648
  error estimate for blocks of size 2^( 7) =       0.000461263636

      target function =                  N/A
              le_mean =     -16.903119979575
             les_mean =     286.036710928516
             stat err =       0.000449384059
             autocorr =       1.303421318926
              std dev =       0.556660301203
             le_variance =       0.309870690936

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309900225100
                                         uncertainty =       0.001776289272

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309900225100
                                         uncertainty =       0.001776289272

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393618274
  error estimate for blocks of size 2^( 2) =       0.000408249069
  error estimate for blocks of size 2^( 3) =       0.000422612423
  error estimate for blocks of size 2^( 4) =       0.000435286590
  error estimate for blocks of size 2^( 5) =       0.000445464361
  error estimate for blocks of size 2^( 6) =       0.000455521648
  error estimate for blocks of size 2^( 7) =       0.000461263636

      target function =                  N/A
              le_mean =     -16.903119979575
             les_mean =     286.036710928516
             stat err =       0.000449384059
             autocorr =       1.303421318926
              std dev =       0.556660301203
             le_variance =       0.309870690936


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.903119979575        initial  <--
     9.3132e+31     9.3132e+32             0.0000e+00       -16.903119979575
     3.7253e+32     3.7253e+33             0.0000e+00       -16.903119979575
     1.4901e+33     1.4901e+34             0.0000e+00       -16.903119979575

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.8218
  </log>
  <optVariables href="H2O.s055.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0808e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s056 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s056 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=56  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -16.8837
    reference variance = 0.278163
====================================================
  Execution time = 1.4601e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s056
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5271e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2484e-01
  Total weights = 1.951814824e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5718e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311589501769
                                         uncertainty =       0.001974400489

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311589501769
                                         uncertainty =       0.001974400489

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394643089
  error estimate for blocks of size 2^( 2) =       0.000408200086
  error estimate for blocks of size 2^( 3) =       0.000422813316
  error estimate for blocks of size 2^( 4) =       0.000435330270
  error estimate for blocks of size 2^( 5) =       0.000444895291
  error estimate for blocks of size 2^( 6) =       0.000453689781
  error estimate for blocks of size 2^( 7) =       0.000456431769

      target function =                  N/A
              le_mean =     -16.904072352519
             les_mean =     286.072505130660
             stat err =       0.000447586778
             autocorr =       1.286309544581
              std dev =       0.558109609425
             le_variance =       0.311486336133


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690407235252e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+32, overlap shift 9.3132e+33 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904072352512       residual = 1.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904072352512       residual = 1.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e+32 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+33, overlap shift 3.7253e+34 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904072352512       residual = 1.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904072352512       residual = 1.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+33 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4901e+34, overlap shift 1.4901e+35 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904072352512       residual = 1.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904072352512       residual = 1.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+34 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.237521 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7178e+01
  </log>
  <optVariables href="H2O.s056.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -16.8741
    reference variance = 0.246724
====================================================
  Execution time = 1.4031e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s056
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2628e-01
  Total weights = 1.9517e+06
  Execution time = 1.9133e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312325432392
                                         uncertainty =       0.002296851522

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312325432392
                                         uncertainty =       0.002296851522

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395108177
  error estimate for blocks of size 2^( 2) =       0.000408887975
  error estimate for blocks of size 2^( 3) =       0.000423162061
  error estimate for blocks of size 2^( 4) =       0.000436290578
  error estimate for blocks of size 2^( 5) =       0.000447539965
  error estimate for blocks of size 2^( 6) =       0.000456384635
  error estimate for blocks of size 2^( 7) =       0.000461259570

      target function =                  N/A
              le_mean =     -16.904522959482
             les_mean =     286.089181354503
             stat err =       0.000450368687
             autocorr =       1.299284742347
              std dev =       0.558767343121
             le_variance =       0.312220943739

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312325432392
                                         uncertainty =       0.002296851522

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312325432392
                                         uncertainty =       0.002296851522

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395108177
  error estimate for blocks of size 2^( 2) =       0.000408887975
  error estimate for blocks of size 2^( 3) =       0.000423162061
  error estimate for blocks of size 2^( 4) =       0.000436290578
  error estimate for blocks of size 2^( 5) =       0.000447539965
  error estimate for blocks of size 2^( 6) =       0.000456384635
  error estimate for blocks of size 2^( 7) =       0.000461259570

      target function =                  N/A
              le_mean =     -16.904522959482
             les_mean =     286.089181354503
             stat err =       0.000450368687
             autocorr =       1.299284742347
              std dev =       0.558767343121
             le_variance =       0.312220943739

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312325432392
                                         uncertainty =       0.002296851522

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312325432392
                                         uncertainty =       0.002296851522

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395108177
  error estimate for blocks of size 2^( 2) =       0.000408887975
  error estimate for blocks of size 2^( 3) =       0.000423162061
  error estimate for blocks of size 2^( 4) =       0.000436290578
  error estimate for blocks of size 2^( 5) =       0.000447539965
  error estimate for blocks of size 2^( 6) =       0.000456384635
  error estimate for blocks of size 2^( 7) =       0.000461259570

      target function =                  N/A
              le_mean =     -16.904522959482
             les_mean =     286.089181354503
             stat err =       0.000450368687
             autocorr =       1.299284742347
              std dev =       0.558767343121
             le_variance =       0.312220943739

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312325432392
                                         uncertainty =       0.002296851522

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312325432392
                                         uncertainty =       0.002296851522

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395108177
  error estimate for blocks of size 2^( 2) =       0.000408887975
  error estimate for blocks of size 2^( 3) =       0.000423162061
  error estimate for blocks of size 2^( 4) =       0.000436290578
  error estimate for blocks of size 2^( 5) =       0.000447539965
  error estimate for blocks of size 2^( 6) =       0.000456384635
  error estimate for blocks of size 2^( 7) =       0.000461259570

      target function =                  N/A
              le_mean =     -16.904522959482
             les_mean =     286.089181354503
             stat err =       0.000450368687
             autocorr =       1.299284742347
              std dev =       0.558767343121
             le_variance =       0.312220943739


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904522959482        initial  <--
     9.3132e+32     9.3132e+33             0.0000e+00       -16.904522959482
     3.7253e+33     3.7253e+34             0.0000e+00       -16.904522959482
     1.4901e+34     1.4901e+35             0.0000e+00       -16.904522959482

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.5868
  </log>
  <optVariables href="H2O.s056.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0770e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s057 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s057 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=57  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -16.9242
    reference variance = 0.400474
====================================================
  Execution time = 1.4502e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s057
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5248e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2033e-01
  Total weights = 1.951852987e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5701e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310301735885
                                         uncertainty =       0.001765488906

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310301735885
                                         uncertainty =       0.001765488906

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393920145
  error estimate for blocks of size 2^( 2) =       0.000407818282
  error estimate for blocks of size 2^( 3) =       0.000421773409
  error estimate for blocks of size 2^( 4) =       0.000434863879
  error estimate for blocks of size 2^( 5) =       0.000445940365
  error estimate for blocks of size 2^( 6) =       0.000454837605
  error estimate for blocks of size 2^( 7) =       0.000460530533

      target function =                  N/A
              le_mean =     -16.904349812680
             les_mean =     286.077371392222
             stat err =       0.000449043096
             autocorr =       1.299450269973
              std dev =       0.557087211883
             le_variance =       0.310346161644


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690434981268e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+33, overlap shift 9.3132e+34 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904349812732       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904349812732       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e+33 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+34, overlap shift 3.7253e+35 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904349812732       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904349812732       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+34 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4901e+35, overlap shift 1.4901e+36 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904349812732       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904349812732       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+35 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.238624 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7078e+01
  </log>
  <optVariables href="H2O.s057.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -16.9351
    reference variance = 0.196844
====================================================
  Execution time = 1.3959e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s057
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2493e-01
  Total weights = 1.9515e+06
  Execution time = 1.8866e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312702756014
                                         uncertainty =       0.002590405918

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312702756014
                                         uncertainty =       0.002590405918

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395435304
  error estimate for blocks of size 2^( 2) =       0.000409337647
  error estimate for blocks of size 2^( 3) =       0.000424034287
  error estimate for blocks of size 2^( 4) =       0.000437546167
  error estimate for blocks of size 2^( 5) =       0.000448709850
  error estimate for blocks of size 2^( 6) =       0.000456569267
  error estimate for blocks of size 2^( 7) =       0.000461516024

      target function =                  N/A
              le_mean =     -16.904415547575
             les_mean =     286.084197036790
             stat err =       0.000451085327
             autocorr =       1.301267314968
              std dev =       0.559229969455
             le_variance =       0.312738158736

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312702756014
                                         uncertainty =       0.002590405918

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312702756014
                                         uncertainty =       0.002590405918

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395435304
  error estimate for blocks of size 2^( 2) =       0.000409337647
  error estimate for blocks of size 2^( 3) =       0.000424034287
  error estimate for blocks of size 2^( 4) =       0.000437546167
  error estimate for blocks of size 2^( 5) =       0.000448709850
  error estimate for blocks of size 2^( 6) =       0.000456569267
  error estimate for blocks of size 2^( 7) =       0.000461516024

      target function =                  N/A
              le_mean =     -16.904415547575
             les_mean =     286.084197036790
             stat err =       0.000451085327
             autocorr =       1.301267314968
              std dev =       0.559229969455
             le_variance =       0.312738158736

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312702756014
                                         uncertainty =       0.002590405918

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312702756014
                                         uncertainty =       0.002590405918

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395435304
  error estimate for blocks of size 2^( 2) =       0.000409337647
  error estimate for blocks of size 2^( 3) =       0.000424034287
  error estimate for blocks of size 2^( 4) =       0.000437546167
  error estimate for blocks of size 2^( 5) =       0.000448709850
  error estimate for blocks of size 2^( 6) =       0.000456569267
  error estimate for blocks of size 2^( 7) =       0.000461516024

      target function =                  N/A
              le_mean =     -16.904415547575
             les_mean =     286.084197036790
             stat err =       0.000451085327
             autocorr =       1.301267314968
              std dev =       0.559229969455
             le_variance =       0.312738158736

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312702756014
                                         uncertainty =       0.002590405918

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312702756014
                                         uncertainty =       0.002590405918

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395435304
  error estimate for blocks of size 2^( 2) =       0.000409337647
  error estimate for blocks of size 2^( 3) =       0.000424034287
  error estimate for blocks of size 2^( 4) =       0.000437546167
  error estimate for blocks of size 2^( 5) =       0.000448709850
  error estimate for blocks of size 2^( 6) =       0.000456569267
  error estimate for blocks of size 2^( 7) =       0.000461516024

      target function =                  N/A
              le_mean =     -16.904415547575
             les_mean =     286.084197036790
             stat err =       0.000451085327
             autocorr =       1.301267314968
              std dev =       0.559229969455
             le_variance =       0.312738158736


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904415547575        initial  <--
     9.3132e+33     9.3132e+34             0.0000e+00       -16.904415547575
     3.7253e+34     3.7253e+35             0.0000e+00       -16.904415547575
     1.4901e+35     1.4901e+36             0.0000e+00       -16.904415547575

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.4921
  </log>
  <optVariables href="H2O.s057.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0575e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s058 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s058 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=58  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -16.8911
    reference variance = 0.327786
====================================================
  Execution time = 1.4372e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s058
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5273e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2823e-01
  Total weights = 1.952090967e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5634e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315020824734
                                         uncertainty =       0.002458560012

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315020824734
                                         uncertainty =       0.002458560012

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396869685
  error estimate for blocks of size 2^( 2) =       0.000411312591
  error estimate for blocks of size 2^( 3) =       0.000425579475
  error estimate for blocks of size 2^( 4) =       0.000439534773
  error estimate for blocks of size 2^( 5) =       0.000450944481
  error estimate for blocks of size 2^( 6) =       0.000459474984
  error estimate for blocks of size 2^( 7) =       0.000466516203

      target function =                  N/A
              le_mean =     -16.904486899188
             les_mean =     286.089903496322
             stat err =       0.000454117610
             autocorr =       1.309305024088
              std dev =       0.561258491060
             le_variance =       0.315011093786


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690448689919e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+34, overlap shift 9.3132e+35 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904486899225       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904486899225       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e+34 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+35, overlap shift 3.7253e+36 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904486899225       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904486899225       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+35 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4901e+36, overlap shift 1.4901e+37 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904486899225       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904486899225       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+36 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.239721 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6941e+01
  </log>
  <optVariables href="H2O.s058.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -16.9607
    reference variance = 0.191028
====================================================
  Execution time = 1.3959e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s058
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2253e-01
  Total weights = 1.9517e+06
  Execution time = 1.8830e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310584037558
                                         uncertainty =       0.001975974846

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310584037558
                                         uncertainty =       0.001975974846

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394044352
  error estimate for blocks of size 2^( 2) =       0.000408066569
  error estimate for blocks of size 2^( 3) =       0.000422893265
  error estimate for blocks of size 2^( 4) =       0.000435382237
  error estimate for blocks of size 2^( 5) =       0.000446418489
  error estimate for blocks of size 2^( 6) =       0.000454064785
  error estimate for blocks of size 2^( 7) =       0.000459186954

      target function =                  N/A
              le_mean =     -16.904967200347
             les_mean =     286.100446424244
             stat err =       0.000448763116
             autocorr =       1.297012306905
              std dev =       0.557262866185
             le_variance =       0.310541902029

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310584037558
                                         uncertainty =       0.001975974846

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310584037558
                                         uncertainty =       0.001975974846

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394044352
  error estimate for blocks of size 2^( 2) =       0.000408066569
  error estimate for blocks of size 2^( 3) =       0.000422893265
  error estimate for blocks of size 2^( 4) =       0.000435382237
  error estimate for blocks of size 2^( 5) =       0.000446418489
  error estimate for blocks of size 2^( 6) =       0.000454064785
  error estimate for blocks of size 2^( 7) =       0.000459186954

      target function =                  N/A
              le_mean =     -16.904967200347
             les_mean =     286.100446424244
             stat err =       0.000448763116
             autocorr =       1.297012306905
              std dev =       0.557262866185
             le_variance =       0.310541902029

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310584037558
                                         uncertainty =       0.001975974846

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310584037558
                                         uncertainty =       0.001975974846

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394044352
  error estimate for blocks of size 2^( 2) =       0.000408066569
  error estimate for blocks of size 2^( 3) =       0.000422893265
  error estimate for blocks of size 2^( 4) =       0.000435382237
  error estimate for blocks of size 2^( 5) =       0.000446418489
  error estimate for blocks of size 2^( 6) =       0.000454064785
  error estimate for blocks of size 2^( 7) =       0.000459186954

      target function =                  N/A
              le_mean =     -16.904967200347
             les_mean =     286.100446424244
             stat err =       0.000448763116
             autocorr =       1.297012306905
              std dev =       0.557262866185
             le_variance =       0.310541902029

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310584037558
                                         uncertainty =       0.001975974846

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310584037558
                                         uncertainty =       0.001975974846

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394044352
  error estimate for blocks of size 2^( 2) =       0.000408066569
  error estimate for blocks of size 2^( 3) =       0.000422893265
  error estimate for blocks of size 2^( 4) =       0.000435382237
  error estimate for blocks of size 2^( 5) =       0.000446418489
  error estimate for blocks of size 2^( 6) =       0.000454064785
  error estimate for blocks of size 2^( 7) =       0.000459186954

      target function =                  N/A
              le_mean =     -16.904967200347
             les_mean =     286.100446424244
             stat err =       0.000448763116
             autocorr =       1.297012306905
              std dev =       0.557262866185
             le_variance =       0.310541902029


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904967200347        initial  <--
     9.3132e+34     9.3132e+35             0.0000e+00       -16.904967200347
     3.7253e+35     3.7253e+36             0.0000e+00       -16.904967200347
     1.4901e+36     1.4901e+37             0.0000e+00       -16.904967200347

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.4862
  </log>
  <optVariables href="H2O.s058.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0432e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s059 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s059 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=59  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -16.9492
    reference variance = 0.308413
====================================================
  Execution time = 1.4258e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s059
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5250e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2878e-01
  Total weights = 1.952003641e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5894e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313978633889
                                         uncertainty =       0.002948808555

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313978633889
                                         uncertainty =       0.002948808555

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396162843
  error estimate for blocks of size 2^( 2) =       0.000410112645
  error estimate for blocks of size 2^( 3) =       0.000424855567
  error estimate for blocks of size 2^( 4) =       0.000438032277
  error estimate for blocks of size 2^( 5) =       0.000448439091
  error estimate for blocks of size 2^( 6) =       0.000456350235
  error estimate for blocks of size 2^( 7) =       0.000460058901

      target function =                  N/A
              le_mean =     -16.904304812231
             les_mean =     286.084298793161
             stat err =       0.000450720126
             autocorr =       1.294393797807
              std dev =       0.560258865377
             le_variance =       0.313889996234


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690430481223e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+35, overlap shift 9.3132e+36 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904304812262       residual = 1.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904304812262       residual = 1.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e+35 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+36, overlap shift 3.7253e+37 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904304812262       residual = 1.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904304812262       residual = 1.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+36 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4901e+37, overlap shift 1.4901e+38 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904304812262       residual = 1.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904304812262       residual = 1.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+37 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.240824 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6853e+01
  </log>
  <optVariables href="H2O.s059.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -16.8974
    reference variance = 0.214479
====================================================
  Execution time = 1.4114e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s059
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2221e-01
  Total weights = 1.9516e+06
  Execution time = 1.8853e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311254809470
                                         uncertainty =       0.001712955217

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311254809470
                                         uncertainty =       0.001712955217

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394516914
  error estimate for blocks of size 2^( 2) =       0.000408526404
  error estimate for blocks of size 2^( 3) =       0.000422798484
  error estimate for blocks of size 2^( 4) =       0.000435357809
  error estimate for blocks of size 2^( 5) =       0.000445832075
  error estimate for blocks of size 2^( 6) =       0.000453179976
  error estimate for blocks of size 2^( 7) =       0.000457263853

      target function =                  N/A
              le_mean =     -16.903775469403
             les_mean =     286.059834930014
             stat err =       0.000447908428
             autocorr =       1.288983073498
              std dev =       0.557931170401
             le_variance =       0.311287190905

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311254809470
                                         uncertainty =       0.001712955217

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311254809470
                                         uncertainty =       0.001712955217

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394516914
  error estimate for blocks of size 2^( 2) =       0.000408526404
  error estimate for blocks of size 2^( 3) =       0.000422798484
  error estimate for blocks of size 2^( 4) =       0.000435357809
  error estimate for blocks of size 2^( 5) =       0.000445832075
  error estimate for blocks of size 2^( 6) =       0.000453179976
  error estimate for blocks of size 2^( 7) =       0.000457263853

      target function =                  N/A
              le_mean =     -16.903775469403
             les_mean =     286.059834930014
             stat err =       0.000447908428
             autocorr =       1.288983073498
              std dev =       0.557931170401
             le_variance =       0.311287190905

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311254809470
                                         uncertainty =       0.001712955217

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311254809470
                                         uncertainty =       0.001712955217

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394516914
  error estimate for blocks of size 2^( 2) =       0.000408526404
  error estimate for blocks of size 2^( 3) =       0.000422798484
  error estimate for blocks of size 2^( 4) =       0.000435357809
  error estimate for blocks of size 2^( 5) =       0.000445832075
  error estimate for blocks of size 2^( 6) =       0.000453179976
  error estimate for blocks of size 2^( 7) =       0.000457263853

      target function =                  N/A
              le_mean =     -16.903775469403
             les_mean =     286.059834930014
             stat err =       0.000447908428
             autocorr =       1.288983073498
              std dev =       0.557931170401
             le_variance =       0.311287190905

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311254809470
                                         uncertainty =       0.001712955217

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311254809470
                                         uncertainty =       0.001712955217

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394516914
  error estimate for blocks of size 2^( 2) =       0.000408526404
  error estimate for blocks of size 2^( 3) =       0.000422798484
  error estimate for blocks of size 2^( 4) =       0.000435357809
  error estimate for blocks of size 2^( 5) =       0.000445832075
  error estimate for blocks of size 2^( 6) =       0.000453179976
  error estimate for blocks of size 2^( 7) =       0.000457263853

      target function =                  N/A
              le_mean =     -16.903775469403
             les_mean =     286.059834930014
             stat err =       0.000447908428
             autocorr =       1.288983073498
              std dev =       0.557931170401
             le_variance =       0.311287190905


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.903775469403        initial  <--
     9.3132e+35     9.3132e+36             0.0000e+00       -16.903775469403
     3.7253e+36     3.7253e+37             0.0000e+00       -16.903775469403
     1.4901e+37     1.4901e+38             0.0000e+00       -16.903775469403

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.6686
  </log>
  <optVariables href="H2O.s059.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0527e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s060 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s060 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=60  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 60
    time step          = 0.05
    reference energy   = -16.9234
    reference variance = 0.172093
====================================================
  Execution time = 1.4268e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s060
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5227e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2959e-01
  Total weights = 1.951531780e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5922e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313481110804
                                         uncertainty =       0.002576900440

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313481110804
                                         uncertainty =       0.002576900440

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395904695
  error estimate for blocks of size 2^( 2) =       0.000409898732
  error estimate for blocks of size 2^( 3) =       0.000423996038
  error estimate for blocks of size 2^( 4) =       0.000437157775
  error estimate for blocks of size 2^( 5) =       0.000446905312
  error estimate for blocks of size 2^( 6) =       0.000452261311
  error estimate for blocks of size 2^( 7) =       0.000455093567

      target function =                  N/A
              le_mean =     -16.903875483716
             les_mean =     286.070598912097
             stat err =       0.000447854491
             autocorr =       1.279654010344
              std dev =       0.559893789779
             le_variance =       0.313481055833


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690387548372e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+36, overlap shift 9.3132e+37 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903875483715       residual = 8.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903875483715       residual = 8.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e+36 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+37, overlap shift 3.7253e+38 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903875483715       residual = 8.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903875483715       residual = 8.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+37 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4901e+38, overlap shift 1.4901e+39 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903875483715       residual = 8.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903875483715       residual = 8.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+38 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.241892 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6865e+01
  </log>
  <optVariables href="H2O.s060.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 60
    time step          = 0.05
    reference energy   = -16.9145
    reference variance = 0.274067
====================================================
  Execution time = 1.3845e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s060
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2065e-01
  Total weights = 1.9517e+06
  Execution time = 1.8962e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308951851711
                                         uncertainty =       0.001664337482

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308951851711
                                         uncertainty =       0.001664337482

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393702762
  error estimate for blocks of size 2^( 2) =       0.000407706606
  error estimate for blocks of size 2^( 3) =       0.000421915727
  error estimate for blocks of size 2^( 4) =       0.000434830655
  error estimate for blocks of size 2^( 5) =       0.000445070573
  error estimate for blocks of size 2^( 6) =       0.000454402020
  error estimate for blocks of size 2^( 7) =       0.000457202574

      target function =                  N/A
              le_mean =     -16.904395051277
             les_mean =     286.079217527199
             stat err =       0.000447876456
             autocorr =       1.294134881877
              std dev =       0.556779784921
             le_variance =       0.310003728897

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308951851711
                                         uncertainty =       0.001664337482

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308951851711
                                         uncertainty =       0.001664337482

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393702762
  error estimate for blocks of size 2^( 2) =       0.000407706606
  error estimate for blocks of size 2^( 3) =       0.000421915727
  error estimate for blocks of size 2^( 4) =       0.000434830655
  error estimate for blocks of size 2^( 5) =       0.000445070573
  error estimate for blocks of size 2^( 6) =       0.000454402020
  error estimate for blocks of size 2^( 7) =       0.000457202574

      target function =                  N/A
              le_mean =     -16.904395051277
             les_mean =     286.079217527199
             stat err =       0.000447876456
             autocorr =       1.294134881877
              std dev =       0.556779784921
             le_variance =       0.310003728897

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308951851711
                                         uncertainty =       0.001664337482

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308951851711
                                         uncertainty =       0.001664337482

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393702762
  error estimate for blocks of size 2^( 2) =       0.000407706606
  error estimate for blocks of size 2^( 3) =       0.000421915727
  error estimate for blocks of size 2^( 4) =       0.000434830655
  error estimate for blocks of size 2^( 5) =       0.000445070573
  error estimate for blocks of size 2^( 6) =       0.000454402020
  error estimate for blocks of size 2^( 7) =       0.000457202574

      target function =                  N/A
              le_mean =     -16.904395051277
             les_mean =     286.079217527199
             stat err =       0.000447876456
             autocorr =       1.294134881877
              std dev =       0.556779784921
             le_variance =       0.310003728897

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308951851711
                                         uncertainty =       0.001664337482

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308951851711
                                         uncertainty =       0.001664337482

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393702762
  error estimate for blocks of size 2^( 2) =       0.000407706606
  error estimate for blocks of size 2^( 3) =       0.000421915727
  error estimate for blocks of size 2^( 4) =       0.000434830655
  error estimate for blocks of size 2^( 5) =       0.000445070573
  error estimate for blocks of size 2^( 6) =       0.000454402020
  error estimate for blocks of size 2^( 7) =       0.000457202574

      target function =                  N/A
              le_mean =     -16.904395051277
             les_mean =     286.079217527199
             stat err =       0.000447876456
             autocorr =       1.294134881877
              std dev =       0.556779784921
             le_variance =       0.310003728897


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904395051277        initial  <--
     9.3132e+36     9.3132e+37             0.0000e+00       -16.904395051277
     3.7253e+37     3.7253e+38             0.0000e+00       -16.904395051277
     1.4901e+38     1.4901e+39             0.0000e+00       -16.904395051277

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.4219
  </log>
  <optVariables href="H2O.s060.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0292e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s061 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s061 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=61  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 61
    time step          = 0.05
    reference energy   = -16.9117
    reference variance = 0.294297
====================================================
  Execution time = 1.4383e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s061
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5284e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2355e-01
  Total weights = 1.951377806e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5747e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312361505300
                                         uncertainty =       0.002978458400

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312361505300
                                         uncertainty =       0.002978458400

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395132509
  error estimate for blocks of size 2^( 2) =       0.000409589569
  error estimate for blocks of size 2^( 3) =       0.000424701712
  error estimate for blocks of size 2^( 4) =       0.000438604012
  error estimate for blocks of size 2^( 5) =       0.000450631122
  error estimate for blocks of size 2^( 6) =       0.000459775678
  error estimate for blocks of size 2^( 7) =       0.000464624753

      target function =                  N/A
              le_mean =     -16.904656332614
             les_mean =     286.090958411479
             stat err =       0.000453408891
             autocorr =       1.316723362914
              std dev =       0.558801752661
             le_variance =       0.312259398777


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690465633261e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+37, overlap shift 9.3132e+38 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904656332630       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904656332630       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e+37 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+38, overlap shift 3.7253e+39 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904656332630       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904656332630       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+38 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4901e+39, overlap shift 1.4901e+40 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904656332630       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904656332630       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+39 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.242957 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6963e+01
  </log>
  <optVariables href="H2O.s061.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 61
    time step          = 0.05
    reference energy   = -16.9401
    reference variance = 0.394605
====================================================
  Execution time = 1.4182e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s061
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2482e-01
  Total weights = 1.9518e+06
  Execution time = 1.8800e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311475661025
                                         uncertainty =       0.002404569170

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311475661025
                                         uncertainty =       0.002404569170

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394607087
  error estimate for blocks of size 2^( 2) =       0.000408579058
  error estimate for blocks of size 2^( 3) =       0.000422828740
  error estimate for blocks of size 2^( 4) =       0.000437087698
  error estimate for blocks of size 2^( 5) =       0.000448658147
  error estimate for blocks of size 2^( 6) =       0.000458326748
  error estimate for blocks of size 2^( 7) =       0.000462597396

      target function =                  N/A
              le_mean =     -16.904276901300
             les_mean =     286.079397459802
             stat err =       0.000451667497
             autocorr =       1.310110470355
              std dev =       0.558058693743
             le_variance =       0.311429505663

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311475661025
                                         uncertainty =       0.002404569170

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311475661025
                                         uncertainty =       0.002404569170

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394607087
  error estimate for blocks of size 2^( 2) =       0.000408579058
  error estimate for blocks of size 2^( 3) =       0.000422828740
  error estimate for blocks of size 2^( 4) =       0.000437087698
  error estimate for blocks of size 2^( 5) =       0.000448658147
  error estimate for blocks of size 2^( 6) =       0.000458326748
  error estimate for blocks of size 2^( 7) =       0.000462597396

      target function =                  N/A
              le_mean =     -16.904276901300
             les_mean =     286.079397459802
             stat err =       0.000451667497
             autocorr =       1.310110470355
              std dev =       0.558058693743
             le_variance =       0.311429505663

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311475661025
                                         uncertainty =       0.002404569170

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311475661025
                                         uncertainty =       0.002404569170

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394607087
  error estimate for blocks of size 2^( 2) =       0.000408579058
  error estimate for blocks of size 2^( 3) =       0.000422828740
  error estimate for blocks of size 2^( 4) =       0.000437087698
  error estimate for blocks of size 2^( 5) =       0.000448658147
  error estimate for blocks of size 2^( 6) =       0.000458326748
  error estimate for blocks of size 2^( 7) =       0.000462597396

      target function =                  N/A
              le_mean =     -16.904276901300
             les_mean =     286.079397459802
             stat err =       0.000451667497
             autocorr =       1.310110470355
              std dev =       0.558058693743
             le_variance =       0.311429505663

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311475661025
                                         uncertainty =       0.002404569170

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311475661025
                                         uncertainty =       0.002404569170

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394607087
  error estimate for blocks of size 2^( 2) =       0.000408579058
  error estimate for blocks of size 2^( 3) =       0.000422828740
  error estimate for blocks of size 2^( 4) =       0.000437087698
  error estimate for blocks of size 2^( 5) =       0.000448658147
  error estimate for blocks of size 2^( 6) =       0.000458326748
  error estimate for blocks of size 2^( 7) =       0.000462597396

      target function =                  N/A
              le_mean =     -16.904276901300
             les_mean =     286.079397459802
             stat err =       0.000451667497
             autocorr =       1.310110470355
              std dev =       0.558058693743
             le_variance =       0.311429505663


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904276901300        initial  <--
     9.3132e+37     9.3132e+38             0.0000e+00       -16.904276901300
     3.7253e+38     3.7253e+39             0.0000e+00       -16.904276901300
     1.4901e+39     1.4901e+40             0.0000e+00       -16.904276901300

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.7892
  </log>
  <optVariables href="H2O.s061.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0757e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s062 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s062 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=62  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 62
    time step          = 0.05
    reference energy   = -16.9652
    reference variance = 0.319025
====================================================
  Execution time = 1.6717e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s062
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5231e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2209e-01
  Total weights = 1.951761556e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5911e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310784863809
                                         uncertainty =       0.001952948681

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310784863809
                                         uncertainty =       0.001952948681

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394145981
  error estimate for blocks of size 2^( 2) =       0.000408255728
  error estimate for blocks of size 2^( 3) =       0.000422607442
  error estimate for blocks of size 2^( 4) =       0.000435410421
  error estimate for blocks of size 2^( 5) =       0.000445707215
  error estimate for blocks of size 2^( 6) =       0.000454664803
  error estimate for blocks of size 2^( 7) =       0.000459380645

      target function =                  N/A
              le_mean =     -16.903677937237
             les_mean =     286.056413366236
             stat err =       0.000448790771
             autocorr =       1.296503312687
              std dev =       0.557406591340
             le_variance =       0.310702108070


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690367793724e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+38, overlap shift 9.3132e+39 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903677937254       residual = 2.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903677937254       residual = 2.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e+38 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+39, overlap shift 3.7253e+40 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903677937254       residual = 2.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903677937254       residual = 2.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+39 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4901e+40, overlap shift 1.4901e+41 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903677937254       residual = 2.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903677937254       residual = 2.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+40 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.244044 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.9314e+01
  </log>
  <optVariables href="H2O.s062.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 62
    time step          = 0.05
    reference energy   = -16.9627
    reference variance = 0.223642
====================================================
  Execution time = 1.4115e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s062
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2528e-01
  Total weights = 1.9518e+06
  Execution time = 1.8865e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313037493564
                                         uncertainty =       0.001943001464

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313037493564
                                         uncertainty =       0.001943001464

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395592855
  error estimate for blocks of size 2^( 2) =       0.000409719417
  error estimate for blocks of size 2^( 3) =       0.000424510330
  error estimate for blocks of size 2^( 4) =       0.000437365814
  error estimate for blocks of size 2^( 5) =       0.000449110982
  error estimate for blocks of size 2^( 6) =       0.000458030999
  error estimate for blocks of size 2^( 7) =       0.000464838996

      target function =                  N/A
              le_mean =     -16.904362979558
             les_mean =     286.082769302596
             stat err =       0.000452336698
             autocorr =       1.307455053519
              std dev =       0.559452780774
             le_variance =       0.312987413916

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313037493564
                                         uncertainty =       0.001943001464

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313037493564
                                         uncertainty =       0.001943001464

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395592855
  error estimate for blocks of size 2^( 2) =       0.000409719417
  error estimate for blocks of size 2^( 3) =       0.000424510330
  error estimate for blocks of size 2^( 4) =       0.000437365814
  error estimate for blocks of size 2^( 5) =       0.000449110982
  error estimate for blocks of size 2^( 6) =       0.000458030999
  error estimate for blocks of size 2^( 7) =       0.000464838996

      target function =                  N/A
              le_mean =     -16.904362979558
             les_mean =     286.082769302596
             stat err =       0.000452336698
             autocorr =       1.307455053519
              std dev =       0.559452780774
             le_variance =       0.312987413916

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313037493564
                                         uncertainty =       0.001943001464

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313037493564
                                         uncertainty =       0.001943001464

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395592855
  error estimate for blocks of size 2^( 2) =       0.000409719417
  error estimate for blocks of size 2^( 3) =       0.000424510330
  error estimate for blocks of size 2^( 4) =       0.000437365814
  error estimate for blocks of size 2^( 5) =       0.000449110982
  error estimate for blocks of size 2^( 6) =       0.000458030999
  error estimate for blocks of size 2^( 7) =       0.000464838996

      target function =                  N/A
              le_mean =     -16.904362979558
             les_mean =     286.082769302596
             stat err =       0.000452336698
             autocorr =       1.307455053519
              std dev =       0.559452780774
             le_variance =       0.312987413916

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313037493564
                                         uncertainty =       0.001943001464

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313037493564
                                         uncertainty =       0.001943001464

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395592855
  error estimate for blocks of size 2^( 2) =       0.000409719417
  error estimate for blocks of size 2^( 3) =       0.000424510330
  error estimate for blocks of size 2^( 4) =       0.000437365814
  error estimate for blocks of size 2^( 5) =       0.000449110982
  error estimate for blocks of size 2^( 6) =       0.000458030999
  error estimate for blocks of size 2^( 7) =       0.000464838996

      target function =                  N/A
              le_mean =     -16.904362979558
             les_mean =     286.082769302596
             stat err =       0.000452336698
             autocorr =       1.307455053519
              std dev =       0.559452780774
             le_variance =       0.312987413916


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904362979558        initial  <--
     9.3132e+38     9.3132e+39             0.0000e+00       -16.904362979558
     3.7253e+39     3.7253e+40             0.0000e+00       -16.904362979558
     1.4901e+40     1.4901e+41             0.0000e+00       -16.904362979558

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.6488
  </log>
  <optVariables href="H2O.s062.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2968e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s063 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s063 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=63  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 63
    time step          = 0.05
    reference energy   = -16.9573
    reference variance = 0.251115
====================================================
  Execution time = 1.4482e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s063
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5207e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2039e-01
  Total weights = 1.951968553e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5807e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309159270896
                                         uncertainty =       0.002112482000

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309159270896
                                         uncertainty =       0.002112482000

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393254573
  error estimate for blocks of size 2^( 2) =       0.000407601135
  error estimate for blocks of size 2^( 3) =       0.000422523114
  error estimate for blocks of size 2^( 4) =       0.000436021663
  error estimate for blocks of size 2^( 5) =       0.000449197532
  error estimate for blocks of size 2^( 6) =       0.000457724415
  error estimate for blocks of size 2^( 7) =       0.000465381248

      target function =                  N/A
              le_mean =     -16.903754628237
             les_mean =     286.057308659802
             stat err =       0.000452081214
             autocorr =       1.321555352298
              std dev =       0.556145951123
             le_variance =       0.309298318951


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690375462824e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+39, overlap shift 9.3132e+40 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903754628247       residual = 2.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903754628247       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.903754628247       residual = 2.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.903747558594       residual = 5.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e+39 is 1.015518e-43

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+40, overlap shift 3.7253e+41 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903754628247       residual = 2.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903754628247       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.903754628247       residual = 2.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.903754628247       residual = 2.17e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+40 is 2.537894e-44

solving harmonic davidson linear method for identity shift 1.4901e+41, overlap shift 1.4901e+42 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903754628247       residual = 2.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903754628247       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.903754628247       residual = 2.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.903754628247       residual = 2.17e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+41 is 6.344734e-45

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.245434 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7068e+01
  </log>
  <optVariables href="H2O.s063.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 63
    time step          = 0.05
    reference energy   = -16.944
    reference variance = 0.520889
====================================================
  Execution time = 1.4033e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s063
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2344e-01
  Total weights = 1.9515e+06
  Execution time = 1.8956e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310644230113
                                         uncertainty =       0.001971119864

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310644230113
                                         uncertainty =       0.001971119864

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394075627
  error estimate for blocks of size 2^( 2) =       0.000408447316
  error estimate for blocks of size 2^( 3) =       0.000422841726
  error estimate for blocks of size 2^( 4) =       0.000436657869
  error estimate for blocks of size 2^( 5) =       0.000447997506
  error estimate for blocks of size 2^( 6) =       0.000456515541
  error estimate for blocks of size 2^( 7) =       0.000462527352

      target function =                  N/A
              le_mean =     -16.904092833879
             les_mean =     286.071789584450
             stat err =       0.000450924567
             autocorr =       1.309328564752
              std dev =       0.557307096738
             le_variance =       0.310591200075

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310644230113
                                         uncertainty =       0.001971119864

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310644230113
                                         uncertainty =       0.001971119864

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394075627
  error estimate for blocks of size 2^( 2) =       0.000408447316
  error estimate for blocks of size 2^( 3) =       0.000422841726
  error estimate for blocks of size 2^( 4) =       0.000436657869
  error estimate for blocks of size 2^( 5) =       0.000447997506
  error estimate for blocks of size 2^( 6) =       0.000456515541
  error estimate for blocks of size 2^( 7) =       0.000462527352

      target function =                  N/A
              le_mean =     -16.904092833879
             les_mean =     286.071789584450
             stat err =       0.000450924567
             autocorr =       1.309328564752
              std dev =       0.557307096738
             le_variance =       0.310591200075

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310644230113
                                         uncertainty =       0.001971119864

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310644230113
                                         uncertainty =       0.001971119864

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394075627
  error estimate for blocks of size 2^( 2) =       0.000408447316
  error estimate for blocks of size 2^( 3) =       0.000422841726
  error estimate for blocks of size 2^( 4) =       0.000436657869
  error estimate for blocks of size 2^( 5) =       0.000447997506
  error estimate for blocks of size 2^( 6) =       0.000456515541
  error estimate for blocks of size 2^( 7) =       0.000462527352

      target function =                  N/A
              le_mean =     -16.904092833879
             les_mean =     286.071789584450
             stat err =       0.000450924567
             autocorr =       1.309328564752
              std dev =       0.557307096738
             le_variance =       0.310591200075

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310644230113
                                         uncertainty =       0.001971119864

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310644230113
                                         uncertainty =       0.001971119864

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394075627
  error estimate for blocks of size 2^( 2) =       0.000408447316
  error estimate for blocks of size 2^( 3) =       0.000422841726
  error estimate for blocks of size 2^( 4) =       0.000436657869
  error estimate for blocks of size 2^( 5) =       0.000447997506
  error estimate for blocks of size 2^( 6) =       0.000456515541
  error estimate for blocks of size 2^( 7) =       0.000462527352

      target function =                  N/A
              le_mean =     -16.904092833879
             les_mean =     286.071789584450
             stat err =       0.000450924567
             autocorr =       1.309328564752
              std dev =       0.557307096738
             le_variance =       0.310591200075


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904092833879        initial  <--
     9.3132e+39     9.3132e+40             1.0155e-43       -16.904092833879
     3.7253e+40     3.7253e+41             2.5379e-44       -16.904092833879
     1.4901e+41     1.4901e+42             6.3447e-45       -16.904092833879

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.6233
  </log>
  <optVariables href="H2O.s063.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0697e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s064 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s064 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=64  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 64
    time step          = 0.05
    reference energy   = -16.9466
    reference variance = 0.311132
====================================================
  Execution time = 1.4293e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s064
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5240e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2883e-01
  Total weights = 1.951981298e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5764e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313067943008
                                         uncertainty =       0.002794522097

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313067943008
                                         uncertainty =       0.002794522097

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395625862
  error estimate for blocks of size 2^( 2) =       0.000409606671
  error estimate for blocks of size 2^( 3) =       0.000423774012
  error estimate for blocks of size 2^( 4) =       0.000436599205
  error estimate for blocks of size 2^( 5) =       0.000446724016
  error estimate for blocks of size 2^( 6) =       0.000455688605
  error estimate for blocks of size 2^( 7) =       0.000458567581

      target function =                  N/A
              le_mean =     -16.904312126036
             les_mean =     286.084602590419
             stat err =       0.000449394852
             autocorr =       1.290288536719
              std dev =       0.559499459329
             le_variance =       0.313039644989


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690431212604e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+40, overlap shift 9.3132e+41 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904312126050       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904312126050       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e+40 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+41, overlap shift 3.7253e+42 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904312126050       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904312126050       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+41 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4901e+42, overlap shift 1.4901e+43 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904312126050       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904312126050       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+42 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.246616 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6874e+01
  </log>
  <optVariables href="H2O.s064.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 64
    time step          = 0.05
    reference energy   = -16.8869
    reference variance = 0.295093
====================================================
  Execution time = 1.3947e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s064
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.1908e-01
  Total weights = 1.9518e+06
  Execution time = 1.8914e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308750267394
                                         uncertainty =       0.002158572735

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308750267394
                                         uncertainty =       0.002158572735

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392901227
  error estimate for blocks of size 2^( 2) =       0.000406834615
  error estimate for blocks of size 2^( 3) =       0.000421076803
  error estimate for blocks of size 2^( 4) =       0.000433795680
  error estimate for blocks of size 2^( 5) =       0.000443957669
  error estimate for blocks of size 2^( 6) =       0.000452112378
  error estimate for blocks of size 2^( 7) =       0.000456119956

      target function =                  N/A
              le_mean =     -16.903606023962
             les_mean =     286.050980593491
             stat err =       0.000446496421
             autocorr =       1.291425011084
              std dev =       0.555646244245
             le_variance =       0.308742748744

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308750267394
                                         uncertainty =       0.002158572735

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308750267394
                                         uncertainty =       0.002158572735

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392901227
  error estimate for blocks of size 2^( 2) =       0.000406834615
  error estimate for blocks of size 2^( 3) =       0.000421076803
  error estimate for blocks of size 2^( 4) =       0.000433795680
  error estimate for blocks of size 2^( 5) =       0.000443957669
  error estimate for blocks of size 2^( 6) =       0.000452112378
  error estimate for blocks of size 2^( 7) =       0.000456119956

      target function =                  N/A
              le_mean =     -16.903606023962
             les_mean =     286.050980593491
             stat err =       0.000446496421
             autocorr =       1.291425011084
              std dev =       0.555646244245
             le_variance =       0.308742748744

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308750267394
                                         uncertainty =       0.002158572735

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308750267394
                                         uncertainty =       0.002158572735

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392901227
  error estimate for blocks of size 2^( 2) =       0.000406834615
  error estimate for blocks of size 2^( 3) =       0.000421076803
  error estimate for blocks of size 2^( 4) =       0.000433795680
  error estimate for blocks of size 2^( 5) =       0.000443957669
  error estimate for blocks of size 2^( 6) =       0.000452112378
  error estimate for blocks of size 2^( 7) =       0.000456119956

      target function =                  N/A
              le_mean =     -16.903606023962
             les_mean =     286.050980593491
             stat err =       0.000446496421
             autocorr =       1.291425011084
              std dev =       0.555646244245
             le_variance =       0.308742748744

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308750267394
                                         uncertainty =       0.002158572735

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308750267394
                                         uncertainty =       0.002158572735

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392901227
  error estimate for blocks of size 2^( 2) =       0.000406834615
  error estimate for blocks of size 2^( 3) =       0.000421076803
  error estimate for blocks of size 2^( 4) =       0.000433795680
  error estimate for blocks of size 2^( 5) =       0.000443957669
  error estimate for blocks of size 2^( 6) =       0.000452112378
  error estimate for blocks of size 2^( 7) =       0.000456119956

      target function =                  N/A
              le_mean =     -16.903606023962
             les_mean =     286.050980593491
             stat err =       0.000446496421
             autocorr =       1.291425011084
              std dev =       0.555646244245
             le_variance =       0.308742748744


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.903606023962        initial  <--
     9.3132e+40     9.3132e+41             0.0000e+00       -16.903606023962
     3.7253e+41     3.7253e+42             0.0000e+00       -16.903606023962
     1.4901e+42     1.4901e+43             0.0000e+00       -16.903606023962

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.5338
  </log>
  <optVariables href="H2O.s064.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0414e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s065 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s065 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=65  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 65
    time step          = 0.05
    reference energy   = -16.9036
    reference variance = 0.150537
====================================================
  Execution time = 1.4168e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s065
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5252e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2304e-01
  Total weights = 1.952127816e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5885e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312928696258
                                         uncertainty =       0.001936435953

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312928696258
                                         uncertainty =       0.001936435953

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395543128
  error estimate for blocks of size 2^( 2) =       0.000408960391
  error estimate for blocks of size 2^( 3) =       0.000422757005
  error estimate for blocks of size 2^( 4) =       0.000435394887
  error estimate for blocks of size 2^( 5) =       0.000444783855
  error estimate for blocks of size 2^( 6) =       0.000451395247
  error estimate for blocks of size 2^( 7) =       0.000452904499

      target function =                  N/A
              le_mean =     -16.903962585300
             les_mean =     286.066992439888
             stat err =       0.000446119622
             autocorr =       1.272081575954
              std dev =       0.559382456816
             le_variance =       0.312908732994


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690396258530e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+41, overlap shift 9.3132e+42 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903962585311       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903962585311       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e+41 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+42, overlap shift 3.7253e+43 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903962585311       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903962585311       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+42 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4901e+43, overlap shift 1.4901e+44 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903962585311       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903962585311       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+43 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.247707 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6761e+01
  </log>
  <optVariables href="H2O.s065.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 65
    time step          = 0.05
    reference energy   = -16.9213
    reference variance = 0.210697
====================================================
  Execution time = 1.4079e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s065
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.1842e-01
  Total weights = 1.9516e+06
  Execution time = 1.8845e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307670748198
                                         uncertainty =       0.001930890309

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307670748198
                                         uncertainty =       0.001930890309

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392162751
  error estimate for blocks of size 2^( 2) =       0.000406095515
  error estimate for blocks of size 2^( 3) =       0.000420531229
  error estimate for blocks of size 2^( 4) =       0.000432843904
  error estimate for blocks of size 2^( 5) =       0.000443276341
  error estimate for blocks of size 2^( 6) =       0.000451241993
  error estimate for blocks of size 2^( 7) =       0.000453947672

      target function =                  N/A
              le_mean =     -16.904075145139
             les_mean =     286.066173981673
             stat err =       0.000445327478
             autocorr =       1.289514719672
              std dev =       0.554601881475
             le_variance =       0.307583246936

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307670748198
                                         uncertainty =       0.001930890309

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307670748198
                                         uncertainty =       0.001930890309

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392162751
  error estimate for blocks of size 2^( 2) =       0.000406095515
  error estimate for blocks of size 2^( 3) =       0.000420531229
  error estimate for blocks of size 2^( 4) =       0.000432843904
  error estimate for blocks of size 2^( 5) =       0.000443276341
  error estimate for blocks of size 2^( 6) =       0.000451241993
  error estimate for blocks of size 2^( 7) =       0.000453947672

      target function =                  N/A
              le_mean =     -16.904075145139
             les_mean =     286.066173981673
             stat err =       0.000445327478
             autocorr =       1.289514719672
              std dev =       0.554601881475
             le_variance =       0.307583246936

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307670748198
                                         uncertainty =       0.001930890309

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307670748198
                                         uncertainty =       0.001930890309

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392162751
  error estimate for blocks of size 2^( 2) =       0.000406095515
  error estimate for blocks of size 2^( 3) =       0.000420531229
  error estimate for blocks of size 2^( 4) =       0.000432843904
  error estimate for blocks of size 2^( 5) =       0.000443276341
  error estimate for blocks of size 2^( 6) =       0.000451241993
  error estimate for blocks of size 2^( 7) =       0.000453947672

      target function =                  N/A
              le_mean =     -16.904075145139
             les_mean =     286.066173981673
             stat err =       0.000445327478
             autocorr =       1.289514719672
              std dev =       0.554601881475
             le_variance =       0.307583246936

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307670748198
                                         uncertainty =       0.001930890309

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307670748198
                                         uncertainty =       0.001930890309

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392162751
  error estimate for blocks of size 2^( 2) =       0.000406095515
  error estimate for blocks of size 2^( 3) =       0.000420531229
  error estimate for blocks of size 2^( 4) =       0.000432843904
  error estimate for blocks of size 2^( 5) =       0.000443276341
  error estimate for blocks of size 2^( 6) =       0.000451241993
  error estimate for blocks of size 2^( 7) =       0.000453947672

      target function =                  N/A
              le_mean =     -16.904075145139
             les_mean =     286.066173981673
             stat err =       0.000445327478
             autocorr =       1.289514719672
              std dev =       0.554601881475
             le_variance =       0.307583246936


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904075145139        initial  <--
     9.3132e+41     9.3132e+42             0.0000e+00       -16.904075145139
     3.7253e+42     3.7253e+43             0.0000e+00       -16.904075145139
     1.4901e+43     1.4901e+44             0.0000e+00       -16.904075145139

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.6632
  </log>
  <optVariables href="H2O.s065.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0430e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s066 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s066 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=66  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 66
    time step          = 0.05
    reference energy   = -16.8261
    reference variance = 0.248196
====================================================
  Execution time = 1.4408e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s066
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5262e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2219e-01
  Total weights = 1.951521895e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6257e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309258236861
                                         uncertainty =       0.001804064322

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309258236861
                                         uncertainty =       0.001804064322

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393259049
  error estimate for blocks of size 2^( 2) =       0.000407281236
  error estimate for blocks of size 2^( 3) =       0.000421692760
  error estimate for blocks of size 2^( 4) =       0.000435024968
  error estimate for blocks of size 2^( 5) =       0.000446266284
  error estimate for blocks of size 2^( 6) =       0.000455478154
  error estimate for blocks of size 2^( 7) =       0.000462210918

      target function =                  N/A
              le_mean =     -16.904113594154
             les_mean =     286.071244240280
             stat err =       0.000449745081
             autocorr =       1.307902574533
              std dev =       0.556152280566
             le_variance =       0.309305359179


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690411359415e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+42, overlap shift 9.3132e+43 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904113594165       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904113594165       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e+42 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+43, overlap shift 3.7253e+44 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904113594165       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904113594165       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+43 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4901e+44, overlap shift 1.4901e+45 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904113594165       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904113594165       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+44 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.248736 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7038e+01
  </log>
  <optVariables href="H2O.s066.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 66
    time step          = 0.05
    reference energy   = -16.8784
    reference variance = 0.332872
====================================================
  Execution time = 1.4003e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s066
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.1943e-01
  Total weights = 1.9517e+06
  Execution time = 1.8935e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309911331147
                                         uncertainty =       0.002607938805

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309911331147
                                         uncertainty =       0.002607938805

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393666511
  error estimate for blocks of size 2^( 2) =       0.000407641288
  error estimate for blocks of size 2^( 3) =       0.000421431788
  error estimate for blocks of size 2^( 4) =       0.000435321255
  error estimate for blocks of size 2^( 5) =       0.000446849616
  error estimate for blocks of size 2^( 6) =       0.000456086498
  error estimate for blocks of size 2^( 7) =       0.000460677282

      target function =                  N/A
              le_mean =     -16.903569573446
             les_mean =     286.050094588225
             stat err =       0.000449733663
             autocorr =       1.305130232068
              std dev =       0.556728518688
             le_variance =       0.309946643520

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309911331147
                                         uncertainty =       0.002607938805

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309911331147
                                         uncertainty =       0.002607938805

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393666511
  error estimate for blocks of size 2^( 2) =       0.000407641288
  error estimate for blocks of size 2^( 3) =       0.000421431788
  error estimate for blocks of size 2^( 4) =       0.000435321255
  error estimate for blocks of size 2^( 5) =       0.000446849616
  error estimate for blocks of size 2^( 6) =       0.000456086498
  error estimate for blocks of size 2^( 7) =       0.000460677282

      target function =                  N/A
              le_mean =     -16.903569573446
             les_mean =     286.050094588225
             stat err =       0.000449733663
             autocorr =       1.305130232068
              std dev =       0.556728518688
             le_variance =       0.309946643520

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309911331147
                                         uncertainty =       0.002607938805

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309911331147
                                         uncertainty =       0.002607938805

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393666511
  error estimate for blocks of size 2^( 2) =       0.000407641288
  error estimate for blocks of size 2^( 3) =       0.000421431788
  error estimate for blocks of size 2^( 4) =       0.000435321255
  error estimate for blocks of size 2^( 5) =       0.000446849616
  error estimate for blocks of size 2^( 6) =       0.000456086498
  error estimate for blocks of size 2^( 7) =       0.000460677282

      target function =                  N/A
              le_mean =     -16.903569573446
             les_mean =     286.050094588225
             stat err =       0.000449733663
             autocorr =       1.305130232068
              std dev =       0.556728518688
             le_variance =       0.309946643520

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309911331147
                                         uncertainty =       0.002607938805

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309911331147
                                         uncertainty =       0.002607938805

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393666511
  error estimate for blocks of size 2^( 2) =       0.000407641288
  error estimate for blocks of size 2^( 3) =       0.000421431788
  error estimate for blocks of size 2^( 4) =       0.000435321255
  error estimate for blocks of size 2^( 5) =       0.000446849616
  error estimate for blocks of size 2^( 6) =       0.000456086498
  error estimate for blocks of size 2^( 7) =       0.000460677282

      target function =                  N/A
              le_mean =     -16.903569573446
             les_mean =     286.050094588225
             stat err =       0.000449733663
             autocorr =       1.305130232068
              std dev =       0.556728518688
             le_variance =       0.309946643520


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.903569573446        initial  <--
     9.3132e+42     9.3132e+43             0.0000e+00       -16.903569573446
     3.7253e+43     3.7253e+44             0.0000e+00       -16.903569573446
     1.4901e+44     1.4901e+45             0.0000e+00       -16.903569573446

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.5385
  </log>
  <optVariables href="H2O.s066.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0582e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s067 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s067 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=67  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 67
    time step          = 0.05
    reference energy   = -16.9396
    reference variance = 0.232543
====================================================
  Execution time = 1.4201e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s067
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5255e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2297e-01
  Total weights = 1.951654210e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5866e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311410847276
                                         uncertainty =       0.002215882119

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311410847276
                                         uncertainty =       0.002215882119

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394626798
  error estimate for blocks of size 2^( 2) =       0.000408974023
  error estimate for blocks of size 2^( 3) =       0.000423768522
  error estimate for blocks of size 2^( 4) =       0.000437459154
  error estimate for blocks of size 2^( 5) =       0.000448305966
  error estimate for blocks of size 2^( 6) =       0.000456799395
  error estimate for blocks of size 2^( 7) =       0.000461942164

      target function =                  N/A
              le_mean =     -16.904582534701
             les_mean =     286.087885117774
             stat err =       0.000451126670
             autocorr =       1.306844328478
              std dev =       0.558086570263
             le_variance =       0.311460619907


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690458253470e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+43, overlap shift 9.3132e+44 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904582534702       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904582534702       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e+43 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+44, overlap shift 3.7253e+45 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904582534702       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904582534702       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+44 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4901e+45, overlap shift 1.4901e+46 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904582534702       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904582534702       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+45 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.249817 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6792e+01
  </log>
  <optVariables href="H2O.s067.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 67
    time step          = 0.05
    reference energy   = -16.902
    reference variance = 0.196387
====================================================
  Execution time = 1.4053e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s067
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3104e-01
  Total weights = 1.9516e+06
  Execution time = 1.8915e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316199773942
                                         uncertainty =       0.002478533678

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316199773942
                                         uncertainty =       0.002478533678

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397616256
  error estimate for blocks of size 2^( 2) =       0.000411756837
  error estimate for blocks of size 2^( 3) =       0.000426261702
  error estimate for blocks of size 2^( 4) =       0.000440054717
  error estimate for blocks of size 2^( 5) =       0.000452171478
  error estimate for blocks of size 2^( 6) =       0.000462791018
  error estimate for blocks of size 2^( 7) =       0.000469608058

      target function =                  N/A
              le_mean =     -16.904598265220
             les_mean =     286.096482566029
             stat err =       0.000456156318
             autocorr =       1.316131021082
              std dev =       0.562314301930
             le_variance =       0.316197374155

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316199773942
                                         uncertainty =       0.002478533678

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316199773942
                                         uncertainty =       0.002478533678

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397616256
  error estimate for blocks of size 2^( 2) =       0.000411756837
  error estimate for blocks of size 2^( 3) =       0.000426261702
  error estimate for blocks of size 2^( 4) =       0.000440054717
  error estimate for blocks of size 2^( 5) =       0.000452171478
  error estimate for blocks of size 2^( 6) =       0.000462791018
  error estimate for blocks of size 2^( 7) =       0.000469608058

      target function =                  N/A
              le_mean =     -16.904598265220
             les_mean =     286.096482566029
             stat err =       0.000456156318
             autocorr =       1.316131021082
              std dev =       0.562314301930
             le_variance =       0.316197374155

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316199773942
                                         uncertainty =       0.002478533678

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316199773942
                                         uncertainty =       0.002478533678

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397616256
  error estimate for blocks of size 2^( 2) =       0.000411756837
  error estimate for blocks of size 2^( 3) =       0.000426261702
  error estimate for blocks of size 2^( 4) =       0.000440054717
  error estimate for blocks of size 2^( 5) =       0.000452171478
  error estimate for blocks of size 2^( 6) =       0.000462791018
  error estimate for blocks of size 2^( 7) =       0.000469608058

      target function =                  N/A
              le_mean =     -16.904598265220
             les_mean =     286.096482566029
             stat err =       0.000456156318
             autocorr =       1.316131021082
              std dev =       0.562314301930
             le_variance =       0.316197374155

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316199773942
                                         uncertainty =       0.002478533678

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316199773942
                                         uncertainty =       0.002478533678

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397616256
  error estimate for blocks of size 2^( 2) =       0.000411756837
  error estimate for blocks of size 2^( 3) =       0.000426261702
  error estimate for blocks of size 2^( 4) =       0.000440054717
  error estimate for blocks of size 2^( 5) =       0.000452171478
  error estimate for blocks of size 2^( 6) =       0.000462791018
  error estimate for blocks of size 2^( 7) =       0.000469608058

      target function =                  N/A
              le_mean =     -16.904598265220
             les_mean =     286.096482566029
             stat err =       0.000456156318
             autocorr =       1.316131021082
              std dev =       0.562314301930
             le_variance =       0.316197374155


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904598265220        initial  <--
     9.3132e+43     9.3132e+44             0.0000e+00       -16.904598265220
     3.7253e+44     3.7253e+45             0.0000e+00       -16.904598265220
     1.4901e+45     1.4901e+46             0.0000e+00       -16.904598265220

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.6358
  </log>
  <optVariables href="H2O.s067.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0434e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s068 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s068 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=68  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 68
    time step          = 0.05
    reference energy   = -16.9837
    reference variance = 0.275333
====================================================
  Execution time = 1.4343e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s068
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5228e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2091e-01
  Total weights = 1.951509157e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5937e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309885826066
                                         uncertainty =       0.001946943101

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309885826066
                                         uncertainty =       0.001946943101

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393653151
  error estimate for blocks of size 2^( 2) =       0.000407739676
  error estimate for blocks of size 2^( 3) =       0.000422057105
  error estimate for blocks of size 2^( 4) =       0.000435349514
  error estimate for blocks of size 2^( 5) =       0.000445612063
  error estimate for blocks of size 2^( 6) =       0.000452399657
  error estimate for blocks of size 2^( 7) =       0.000456786744

      target function =                  N/A
              le_mean =     -16.904644011696
             les_mean =     286.087901487990
             stat err =       0.000447536994
             autocorr =       1.292499604057
              std dev =       0.556709624352
             le_variance =       0.309925605846


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690464401170e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+44, overlap shift 9.3132e+45 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904644011705       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904644011705       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904644011705       residual = 2.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904644011705       residual = 3.67e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e+44 is 6.437437e-49

solving harmonic davidson linear method for identity shift 3.7253e+45, overlap shift 3.7253e+46 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904644011705       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904644011705       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904644011705       residual = 2.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+45 is 1.601588e-49

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4901e+46, overlap shift 1.4901e+47 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904644011705       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904644011705       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904644011705       residual = 2.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904644011705       residual = 3.67e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+46 is 4.023398e-50

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.251163 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6941e+01
  </log>
  <optVariables href="H2O.s068.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 68
    time step          = 0.05
    reference energy   = -16.8744
    reference variance = 0.302388
====================================================
  Execution time = 1.4091e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s068
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2533e-01
  Total weights = 1.9516e+06
  Execution time = 1.8889e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310233193013
                                         uncertainty =       0.001991385164

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310233193013
                                         uncertainty =       0.001991385164

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393915766
  error estimate for blocks of size 2^( 2) =       0.000407904329
  error estimate for blocks of size 2^( 3) =       0.000421992737
  error estimate for blocks of size 2^( 4) =       0.000434849708
  error estimate for blocks of size 2^( 5) =       0.000446674834
  error estimate for blocks of size 2^( 6) =       0.000456498462
  error estimate for blocks of size 2^( 7) =       0.000461431002

      target function =                  N/A
              le_mean =     -16.904368100263
             les_mean =     286.082989661954
             stat err =       0.000449863501
             autocorr =       1.304231823366
              std dev =       0.557081018084
             le_variance =       0.310339260710

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310233193013
                                         uncertainty =       0.001991385164

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310233193013
                                         uncertainty =       0.001991385164

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393915766
  error estimate for blocks of size 2^( 2) =       0.000407904329
  error estimate for blocks of size 2^( 3) =       0.000421992737
  error estimate for blocks of size 2^( 4) =       0.000434849708
  error estimate for blocks of size 2^( 5) =       0.000446674834
  error estimate for blocks of size 2^( 6) =       0.000456498462
  error estimate for blocks of size 2^( 7) =       0.000461431002

      target function =                  N/A
              le_mean =     -16.904368100263
             les_mean =     286.082989661954
             stat err =       0.000449863501
             autocorr =       1.304231823366
              std dev =       0.557081018084
             le_variance =       0.310339260710

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310233193013
                                         uncertainty =       0.001991385164

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310233193013
                                         uncertainty =       0.001991385164

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393915766
  error estimate for blocks of size 2^( 2) =       0.000407904329
  error estimate for blocks of size 2^( 3) =       0.000421992737
  error estimate for blocks of size 2^( 4) =       0.000434849708
  error estimate for blocks of size 2^( 5) =       0.000446674834
  error estimate for blocks of size 2^( 6) =       0.000456498462
  error estimate for blocks of size 2^( 7) =       0.000461431002

      target function =                  N/A
              le_mean =     -16.904368100263
             les_mean =     286.082989661954
             stat err =       0.000449863501
             autocorr =       1.304231823366
              std dev =       0.557081018084
             le_variance =       0.310339260710

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310233193013
                                         uncertainty =       0.001991385164

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310233193013
                                         uncertainty =       0.001991385164

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393915766
  error estimate for blocks of size 2^( 2) =       0.000407904329
  error estimate for blocks of size 2^( 3) =       0.000421992737
  error estimate for blocks of size 2^( 4) =       0.000434849708
  error estimate for blocks of size 2^( 5) =       0.000446674834
  error estimate for blocks of size 2^( 6) =       0.000456498462
  error estimate for blocks of size 2^( 7) =       0.000461431002

      target function =                  N/A
              le_mean =     -16.904368100263
             les_mean =     286.082989661954
             stat err =       0.000449863501
             autocorr =       1.304231823366
              std dev =       0.557081018084
             le_variance =       0.310339260710


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904368100263        initial  <--
     9.3132e+44     9.3132e+45             6.4374e-49       -16.904368100263
     3.7253e+45     3.7253e+46             1.6016e-49       -16.904368100263
     1.4901e+46     1.4901e+47             4.0234e-50       -16.904368100263

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.6516
  </log>
  <optVariables href="H2O.s068.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0599e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s069 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s069 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=69  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 69
    time step          = 0.05
    reference energy   = -16.9409
    reference variance = 0.210889
====================================================
  Execution time = 1.4688e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s069
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5243e+04
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.2217e-01
  Total weights = 1.951709880e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5860e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310603136511
                                         uncertainty =       0.001716881839

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310603136511
                                         uncertainty =       0.001716881839

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394064640
  error estimate for blocks of size 2^( 2) =       0.000408298066
  error estimate for blocks of size 2^( 3) =       0.000422764934
  error estimate for blocks of size 2^( 4) =       0.000435887126
  error estimate for blocks of size 2^( 5) =       0.000447005031
  error estimate for blocks of size 2^( 6) =       0.000454216700
  error estimate for blocks of size 2^( 7) =       0.000459697355

      target function =                  N/A
              le_mean =     -16.903472743284
             les_mean =     286.049557791310
             stat err =       0.000449201553
             autocorr =       1.299414064848
              std dev =       0.557291559013
             le_variance =       0.310573881747


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690347274328e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+45, overlap shift 9.3132e+46 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903472743289       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903472743289       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e+45 is 4.203359e-50

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+46, overlap shift 3.7253e+47 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903472743289       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903472743289       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.903472743289       residual = 2.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.875000000000       residual = 1.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+46 is 1.174906e-50

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4901e+47, overlap shift 1.4901e+48 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903472743289       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903472743289       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.903472743289       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+47 is 2.627100e-51

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.252458 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7279e+01
  </log>
  <optVariables href="H2O.s069.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 69
    time step          = 0.05
    reference energy   = -16.972
    reference variance = 0.482632
====================================================
  Execution time = 1.6264e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s069
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2162e-01
  Total weights = 1.9517e+06
  Execution time = 1.8920e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310101865273
                                         uncertainty =       0.002852041497

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310101865273
                                         uncertainty =       0.002852041497

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393774019
  error estimate for blocks of size 2^( 2) =       0.000407583003
  error estimate for blocks of size 2^( 3) =       0.000421752011
  error estimate for blocks of size 2^( 4) =       0.000433925395
  error estimate for blocks of size 2^( 5) =       0.000444195373
  error estimate for blocks of size 2^( 6) =       0.000451087435
  error estimate for blocks of size 2^( 7) =       0.000455248973

      target function =                  N/A
              le_mean =     -16.904970912564
             les_mean =     286.099659349883
             stat err =       0.000446114294
             autocorr =       1.283506760064
              std dev =       0.556880558546
             le_variance =       0.310115956487

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310101865273
                                         uncertainty =       0.002852041497

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310101865273
                                         uncertainty =       0.002852041497

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393774019
  error estimate for blocks of size 2^( 2) =       0.000407583003
  error estimate for blocks of size 2^( 3) =       0.000421752011
  error estimate for blocks of size 2^( 4) =       0.000433925395
  error estimate for blocks of size 2^( 5) =       0.000444195373
  error estimate for blocks of size 2^( 6) =       0.000451087435
  error estimate for blocks of size 2^( 7) =       0.000455248973

      target function =                  N/A
              le_mean =     -16.904970912564
             les_mean =     286.099659349883
             stat err =       0.000446114294
             autocorr =       1.283506760064
              std dev =       0.556880558546
             le_variance =       0.310115956487

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310101865273
                                         uncertainty =       0.002852041497

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310101865273
                                         uncertainty =       0.002852041497

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393774019
  error estimate for blocks of size 2^( 2) =       0.000407583003
  error estimate for blocks of size 2^( 3) =       0.000421752011
  error estimate for blocks of size 2^( 4) =       0.000433925395
  error estimate for blocks of size 2^( 5) =       0.000444195373
  error estimate for blocks of size 2^( 6) =       0.000451087435
  error estimate for blocks of size 2^( 7) =       0.000455248973

      target function =                  N/A
              le_mean =     -16.904970912564
             les_mean =     286.099659349883
             stat err =       0.000446114294
             autocorr =       1.283506760064
              std dev =       0.556880558546
             le_variance =       0.310115956487

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310101865273
                                         uncertainty =       0.002852041497

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310101865273
                                         uncertainty =       0.002852041497

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393774019
  error estimate for blocks of size 2^( 2) =       0.000407583003
  error estimate for blocks of size 2^( 3) =       0.000421752011
  error estimate for blocks of size 2^( 4) =       0.000433925395
  error estimate for blocks of size 2^( 5) =       0.000444195373
  error estimate for blocks of size 2^( 6) =       0.000451087435
  error estimate for blocks of size 2^( 7) =       0.000455248973

      target function =                  N/A
              le_mean =     -16.904970912564
             les_mean =     286.099659349883
             stat err =       0.000446114294
             autocorr =       1.283506760064
              std dev =       0.556880558546
             le_variance =       0.310115956487


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904970912564        initial  <--
     9.3132e+45     9.3132e+46             4.2034e-50       -16.904970912564
     3.7253e+46     3.7253e+47             1.1749e-50       -16.904970912564
     1.4901e+47     1.4901e+48             2.6271e-51       -16.904970912564

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 26.0172
  </log>
  <optVariables href="H2O.s069.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.3302e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s070 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s070 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=70  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 70
    time step          = 0.05
    reference energy   = -16.9152
    reference variance = 0.565063
====================================================
  Execution time = 1.4280e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s070
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5231e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.3165e-01
  Total weights = 1.951510655e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5814e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318838183004
                                         uncertainty =       0.004399887579

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318838183004
                                         uncertainty =       0.004399887579

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399266044
  error estimate for blocks of size 2^( 2) =       0.000413279622
  error estimate for blocks of size 2^( 3) =       0.000427457299
  error estimate for blocks of size 2^( 4) =       0.000440317081
  error estimate for blocks of size 2^( 5) =       0.000452589376
  error estimate for blocks of size 2^( 6) =       0.000460992396
  error estimate for blocks of size 2^( 7) =       0.000464978340

      target function =                  N/A
              le_mean =     -16.903715071048
             les_mean =     286.067228857638
             stat err =       0.000454719298
             autocorr =       1.297065830260
              std dev =       0.564647454660
             le_variance =       0.318826748054


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690371507105e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+46, overlap shift 9.3132e+47 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903715071048       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903715071048       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e+46 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+47, overlap shift 3.7253e+48 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903715071048       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903715071048       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+47 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4901e+48, overlap shift 1.4901e+49 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903715071048       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903715071048       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+48 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.253536 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6866e+01
  </log>
  <optVariables href="H2O.s070.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 70
    time step          = 0.05
    reference energy   = -16.9726
    reference variance = 0.367868
====================================================
  Execution time = 1.4362e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s070
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2503e-01
  Total weights = 1.9516e+06
  Execution time = 1.8911e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312164148961
                                         uncertainty =       0.002023645315

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312164148961
                                         uncertainty =       0.002023645315

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395108048
  error estimate for blocks of size 2^( 2) =       0.000408986784
  error estimate for blocks of size 2^( 3) =       0.000423152341
  error estimate for blocks of size 2^( 4) =       0.000435357482
  error estimate for blocks of size 2^( 5) =       0.000445786363
  error estimate for blocks of size 2^( 6) =       0.000452537272
  error estimate for blocks of size 2^( 7) =       0.000455958503

      target function =                  N/A
              le_mean =     -16.904742869635
             les_mean =     286.095359981286
             stat err =       0.000447409905
             autocorr =       1.282269865708
              std dev =       0.558767160694
             le_variance =       0.312220739870

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312164148961
                                         uncertainty =       0.002023645315

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312164148961
                                         uncertainty =       0.002023645315

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395108048
  error estimate for blocks of size 2^( 2) =       0.000408986784
  error estimate for blocks of size 2^( 3) =       0.000423152341
  error estimate for blocks of size 2^( 4) =       0.000435357482
  error estimate for blocks of size 2^( 5) =       0.000445786363
  error estimate for blocks of size 2^( 6) =       0.000452537272
  error estimate for blocks of size 2^( 7) =       0.000455958503

      target function =                  N/A
              le_mean =     -16.904742869635
             les_mean =     286.095359981286
             stat err =       0.000447409905
             autocorr =       1.282269865708
              std dev =       0.558767160694
             le_variance =       0.312220739870

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312164148961
                                         uncertainty =       0.002023645315

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312164148961
                                         uncertainty =       0.002023645315

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395108048
  error estimate for blocks of size 2^( 2) =       0.000408986784
  error estimate for blocks of size 2^( 3) =       0.000423152341
  error estimate for blocks of size 2^( 4) =       0.000435357482
  error estimate for blocks of size 2^( 5) =       0.000445786363
  error estimate for blocks of size 2^( 6) =       0.000452537272
  error estimate for blocks of size 2^( 7) =       0.000455958503

      target function =                  N/A
              le_mean =     -16.904742869635
             les_mean =     286.095359981286
             stat err =       0.000447409905
             autocorr =       1.282269865708
              std dev =       0.558767160694
             le_variance =       0.312220739870

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312164148961
                                         uncertainty =       0.002023645315

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312164148961
                                         uncertainty =       0.002023645315

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395108048
  error estimate for blocks of size 2^( 2) =       0.000408986784
  error estimate for blocks of size 2^( 3) =       0.000423152341
  error estimate for blocks of size 2^( 4) =       0.000435357482
  error estimate for blocks of size 2^( 5) =       0.000445786363
  error estimate for blocks of size 2^( 6) =       0.000452537272
  error estimate for blocks of size 2^( 7) =       0.000455958503

      target function =                  N/A
              le_mean =     -16.904742869635
             les_mean =     286.095359981286
             stat err =       0.000447409905
             autocorr =       1.282269865708
              std dev =       0.558767160694
             le_variance =       0.312220739870


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904742869635        initial  <--
     9.3132e+46     9.3132e+47             0.0000e+00       -16.904742869635
     3.7253e+47     3.7253e+48             0.0000e+00       -16.904742869635
     1.4901e+48     1.4901e+49             0.0000e+00       -16.904742869635

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.9035
  </log>
  <optVariables href="H2O.s070.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0776e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s071 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s071 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=71  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 71
    time step          = 0.05
    reference energy   = -16.8336
    reference variance = 0.216499
====================================================
  Execution time = 1.4488e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s071
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5227e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2692e-01
  Total weights = 1.951689865e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5937e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312210604229
                                         uncertainty =       0.002464085781

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312210604229
                                         uncertainty =       0.002464085781

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395076464
  error estimate for blocks of size 2^( 2) =       0.000408979988
  error estimate for blocks of size 2^( 3) =       0.000423077959
  error estimate for blocks of size 2^( 4) =       0.000435792582
  error estimate for blocks of size 2^( 5) =       0.000447121070
  error estimate for blocks of size 2^( 6) =       0.000454809358
  error estimate for blocks of size 2^( 7) =       0.000460508742

      target function =                  N/A
              le_mean =     -16.903582044774
             les_mean =     286.058008823095
             stat err =       0.000449557938
             autocorr =       1.294818886010
              std dev =       0.558722493101
             le_variance =       0.312170824297


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690358204477e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+47, overlap shift 9.3132e+48 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903582044776       residual = 2.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903582044776       residual = 2.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e+47 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+48, overlap shift 3.7253e+49 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903582044776       residual = 2.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903582044776       residual = 2.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+48 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4901e+49, overlap shift 1.4901e+50 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903582044776       residual = 2.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903582044776       residual = 2.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+49 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.254620 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7087e+01
  </log>
  <optVariables href="H2O.s071.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 71
    time step          = 0.05
    reference energy   = -16.8269
    reference variance = 0.286958
====================================================
  Execution time = 1.4096e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s071
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.2325e-01
  Total weights = 1.9513e+06
  Execution time = 1.8869e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311495729811
                                         uncertainty =       0.001889734618

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311495729811
                                         uncertainty =       0.001889734618

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394665564
  error estimate for blocks of size 2^( 2) =       0.000408845436
  error estimate for blocks of size 2^( 3) =       0.000423315562
  error estimate for blocks of size 2^( 4) =       0.000436904584
  error estimate for blocks of size 2^( 5) =       0.000448036805
  error estimate for blocks of size 2^( 6) =       0.000456557791
  error estimate for blocks of size 2^( 7) =       0.000461257316

      target function =                  N/A
              le_mean =     -16.903389801206
             les_mean =     286.047836875815
             stat err =       0.000450689124
             autocorr =       1.304054336567
              std dev =       0.558141393132
             le_variance =       0.311521814727

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311495729811
                                         uncertainty =       0.001889734618

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311495729811
                                         uncertainty =       0.001889734618

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394665564
  error estimate for blocks of size 2^( 2) =       0.000408845436
  error estimate for blocks of size 2^( 3) =       0.000423315562
  error estimate for blocks of size 2^( 4) =       0.000436904584
  error estimate for blocks of size 2^( 5) =       0.000448036805
  error estimate for blocks of size 2^( 6) =       0.000456557791
  error estimate for blocks of size 2^( 7) =       0.000461257316

      target function =                  N/A
              le_mean =     -16.903389801206
             les_mean =     286.047836875815
             stat err =       0.000450689124
             autocorr =       1.304054336567
              std dev =       0.558141393132
             le_variance =       0.311521814727

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311495729811
                                         uncertainty =       0.001889734618

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311495729811
                                         uncertainty =       0.001889734618

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394665564
  error estimate for blocks of size 2^( 2) =       0.000408845436
  error estimate for blocks of size 2^( 3) =       0.000423315562
  error estimate for blocks of size 2^( 4) =       0.000436904584
  error estimate for blocks of size 2^( 5) =       0.000448036805
  error estimate for blocks of size 2^( 6) =       0.000456557791
  error estimate for blocks of size 2^( 7) =       0.000461257316

      target function =                  N/A
              le_mean =     -16.903389801206
             les_mean =     286.047836875815
             stat err =       0.000450689124
             autocorr =       1.304054336567
              std dev =       0.558141393132
             le_variance =       0.311521814727

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311495729811
                                         uncertainty =       0.001889734618

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311495729811
                                         uncertainty =       0.001889734618

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394665564
  error estimate for blocks of size 2^( 2) =       0.000408845436
  error estimate for blocks of size 2^( 3) =       0.000423315562
  error estimate for blocks of size 2^( 4) =       0.000436904584
  error estimate for blocks of size 2^( 5) =       0.000448036805
  error estimate for blocks of size 2^( 6) =       0.000456557791
  error estimate for blocks of size 2^( 7) =       0.000461257316

      target function =                  N/A
              le_mean =     -16.903389801206
             les_mean =     286.047836875815
             stat err =       0.000450689124
             autocorr =       1.304054336567
              std dev =       0.558141393132
             le_variance =       0.311521814727


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.903389801206        initial  <--
     9.3132e+47     9.3132e+48             0.0000e+00       -16.903389801206
     3.7253e+48     3.7253e+49             0.0000e+00       -16.903389801206
     1.4901e+49     1.4901e+50             0.0000e+00       -16.903389801206

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.6342
  </log>
  <optVariables href="H2O.s071.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0727e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s072 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s072 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=72  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 72
    time step          = 0.05
    reference energy   = -16.8899
    reference variance = 0.338953
====================================================
  Execution time = 1.4164e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s072
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5231e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2339e-01
  Total weights = 1.951385121e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5893e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309617914763
                                         uncertainty =       0.002409319285

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309617914763
                                         uncertainty =       0.002409319285

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393418912
  error estimate for blocks of size 2^( 2) =       0.000406956499
  error estimate for blocks of size 2^( 3) =       0.000420755000
  error estimate for blocks of size 2^( 4) =       0.000433228633
  error estimate for blocks of size 2^( 5) =       0.000444333957
  error estimate for blocks of size 2^( 6) =       0.000451259706
  error estimate for blocks of size 2^( 7) =       0.000454060069

      target function =                  N/A
              le_mean =     -16.904989071749
             les_mean =     286.102043702324
             stat err =       0.000445720591
             autocorr =       1.283556321382
              std dev =       0.556378361054
             le_variance =       0.309556880649


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690498907175e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+48, overlap shift 9.3132e+49 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904989071755       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904989071755       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e+48 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.7253e+49, overlap shift 3.7253e+50 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904989071755       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904989071755       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+49 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4901e+50, overlap shift 1.4901e+51 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904989071755       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904989071755       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+50 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.255699 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6758e+01
  </log>
  <optVariables href="H2O.s072.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 72
    time step          = 0.05
    reference energy   = -16.8333
    reference variance = 0.237595
====================================================
  Execution time = 1.3940e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s072
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.2507e-01
  Total weights = 1.9517e+06
  Execution time = 1.8890e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312930716010
                                         uncertainty =       0.002570455475

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312930716010
                                         uncertainty =       0.002570455475

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395525517
  error estimate for blocks of size 2^( 2) =       0.000409402169
  error estimate for blocks of size 2^( 3) =       0.000423993056
  error estimate for blocks of size 2^( 4) =       0.000436560722
  error estimate for blocks of size 2^( 5) =       0.000447368343
  error estimate for blocks of size 2^( 6) =       0.000456950685
  error estimate for blocks of size 2^( 7) =       0.000462005779

      target function =                  N/A
              le_mean =     -16.903480463311
             les_mean =     286.052720820853
             stat err =       0.000450721382
             autocorr =       1.298575813287
              std dev =       0.559357550251
             le_variance =       0.312880869023

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312930716010
                                         uncertainty =       0.002570455475

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312930716010
                                         uncertainty =       0.002570455475

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395525517
  error estimate for blocks of size 2^( 2) =       0.000409402169
  error estimate for blocks of size 2^( 3) =       0.000423993056
  error estimate for blocks of size 2^( 4) =       0.000436560722
  error estimate for blocks of size 2^( 5) =       0.000447368343
  error estimate for blocks of size 2^( 6) =       0.000456950685
  error estimate for blocks of size 2^( 7) =       0.000462005779

      target function =                  N/A
              le_mean =     -16.903480463311
             les_mean =     286.052720820853
             stat err =       0.000450721382
             autocorr =       1.298575813287
              std dev =       0.559357550251
             le_variance =       0.312880869023

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312930716010
                                         uncertainty =       0.002570455475

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312930716010
                                         uncertainty =       0.002570455475

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395525517
  error estimate for blocks of size 2^( 2) =       0.000409402169
  error estimate for blocks of size 2^( 3) =       0.000423993056
  error estimate for blocks of size 2^( 4) =       0.000436560722
  error estimate for blocks of size 2^( 5) =       0.000447368343
  error estimate for blocks of size 2^( 6) =       0.000456950685
  error estimate for blocks of size 2^( 7) =       0.000462005779

      target function =                  N/A
              le_mean =     -16.903480463311
             les_mean =     286.052720820853
             stat err =       0.000450721382
             autocorr =       1.298575813287
              std dev =       0.559357550251
             le_variance =       0.312880869023

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312930716010
                                         uncertainty =       0.002570455475

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312930716010
                                         uncertainty =       0.002570455475

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395525517
  error estimate for blocks of size 2^( 2) =       0.000409402169
  error estimate for blocks of size 2^( 3) =       0.000423993056
  error estimate for blocks of size 2^( 4) =       0.000436560722
  error estimate for blocks of size 2^( 5) =       0.000447368343
  error estimate for blocks of size 2^( 6) =       0.000456950685
  error estimate for blocks of size 2^( 7) =       0.000462005779

      target function =                  N/A
              le_mean =     -16.903480463311
             les_mean =     286.052720820853
             stat err =       0.000450721382
             autocorr =       1.298575813287
              std dev =       0.559357550251
             le_variance =       0.312880869023


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.903480463311        initial  <--
     9.3132e+48     9.3132e+49             0.0000e+00       -16.903480463311
     3.7253e+49     3.7253e+50             0.0000e+00       -16.903480463311
     1.4901e+50     1.4901e+51             0.0000e+00       -16.903480463311

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.4925
  </log>
  <optVariables href="H2O.s072.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0256e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s073 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s073 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=73  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 73
    time step          = 0.05
    reference energy   = -16.9691
    reference variance = 0.304106
====================================================
  Execution time = 1.4684e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s073
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5235e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2835e-01
  Total weights = 1.951898323e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5714e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314835774347
                                         uncertainty =       0.003139508912

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314835774347
                                         uncertainty =       0.003139508912

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396750989
  error estimate for blocks of size 2^( 2) =       0.000410703875
  error estimate for blocks of size 2^( 3) =       0.000424409566
  error estimate for blocks of size 2^( 4) =       0.000437305928
  error estimate for blocks of size 2^( 5) =       0.000448067635
  error estimate for blocks of size 2^( 6) =       0.000455824938
  error estimate for blocks of size 2^( 7) =       0.000460104071

      target function =                  N/A
              le_mean =     -16.904230382086
             les_mean =     286.081359523479
             stat err =       0.000450325643
             autocorr =       1.288300927812
              std dev =       0.561090629471
             le_variance =       0.314822694480


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690423038209e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+49, overlap shift 9.3132e+50 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904230382095       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904230382095       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e+49 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+50, overlap shift 3.7253e+51 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904230382095       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904230382095       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+50 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4901e+51, overlap shift 1.4901e+52 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904230382095       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904230382095       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+51 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.256738 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7260e+01
  </log>
  <optVariables href="H2O.s073.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 73
    time step          = 0.05
    reference energy   = -16.8906
    reference variance = 0.258784
====================================================
  Execution time = 1.4161e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s073
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2729e-01
  Total weights = 1.9514e+06
  Execution time = 1.8922e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313389402818
                                         uncertainty =       0.003072974093

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313389402818
                                         uncertainty =       0.003072974093

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395825614
  error estimate for blocks of size 2^( 2) =       0.000409914119
  error estimate for blocks of size 2^( 3) =       0.000424090400
  error estimate for blocks of size 2^( 4) =       0.000437069017
  error estimate for blocks of size 2^( 5) =       0.000448531367
  error estimate for blocks of size 2^( 6) =       0.000456063992
  error estimate for blocks of size 2^( 7) =       0.000459468290

      target function =                  N/A
              le_mean =     -16.903622727721
             les_mean =     286.059751285534
             stat err =       0.000450283167
             autocorr =       1.294087479876
              std dev =       0.559781951445
             le_variance =       0.313355833164

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313389402818
                                         uncertainty =       0.003072974093

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313389402818
                                         uncertainty =       0.003072974093

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395825614
  error estimate for blocks of size 2^( 2) =       0.000409914119
  error estimate for blocks of size 2^( 3) =       0.000424090400
  error estimate for blocks of size 2^( 4) =       0.000437069017
  error estimate for blocks of size 2^( 5) =       0.000448531367
  error estimate for blocks of size 2^( 6) =       0.000456063992
  error estimate for blocks of size 2^( 7) =       0.000459468290

      target function =                  N/A
              le_mean =     -16.903622727721
             les_mean =     286.059751285534
             stat err =       0.000450283167
             autocorr =       1.294087479876
              std dev =       0.559781951445
             le_variance =       0.313355833164

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313389402818
                                         uncertainty =       0.003072974093

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313389402818
                                         uncertainty =       0.003072974093

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395825614
  error estimate for blocks of size 2^( 2) =       0.000409914119
  error estimate for blocks of size 2^( 3) =       0.000424090400
  error estimate for blocks of size 2^( 4) =       0.000437069017
  error estimate for blocks of size 2^( 5) =       0.000448531367
  error estimate for blocks of size 2^( 6) =       0.000456063992
  error estimate for blocks of size 2^( 7) =       0.000459468290

      target function =                  N/A
              le_mean =     -16.903622727721
             les_mean =     286.059751285534
             stat err =       0.000450283167
             autocorr =       1.294087479876
              std dev =       0.559781951445
             le_variance =       0.313355833164

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313389402818
                                         uncertainty =       0.003072974093

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313389402818
                                         uncertainty =       0.003072974093

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395825614
  error estimate for blocks of size 2^( 2) =       0.000409914119
  error estimate for blocks of size 2^( 3) =       0.000424090400
  error estimate for blocks of size 2^( 4) =       0.000437069017
  error estimate for blocks of size 2^( 5) =       0.000448531367
  error estimate for blocks of size 2^( 6) =       0.000456063992
  error estimate for blocks of size 2^( 7) =       0.000459468290

      target function =                  N/A
              le_mean =     -16.903622727721
             les_mean =     286.059751285534
             stat err =       0.000450283167
             autocorr =       1.294087479876
              std dev =       0.559781951445
             le_variance =       0.313355833164


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.903622727721        initial  <--
     9.3132e+49     9.3132e+50             0.0000e+00       -16.903622727721
     3.7253e+50     3.7253e+51             0.0000e+00       -16.903622727721
     1.4901e+51     1.4901e+52             0.0000e+00       -16.903622727721

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.7068
  </log>
  <optVariables href="H2O.s073.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0973e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s074 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s074 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=74  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 74
    time step          = 0.05
    reference energy   = -16.9247
    reference variance = 0.363429
====================================================
  Execution time = 1.4379e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s074
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5251e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2092e-01
  Total weights = 1.951976036e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5774e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310770893120
                                         uncertainty =       0.002444997852

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310770893120
                                         uncertainty =       0.002444997852

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394195552
  error estimate for blocks of size 2^( 2) =       0.000408273894
  error estimate for blocks of size 2^( 3) =       0.000422017019
  error estimate for blocks of size 2^( 4) =       0.000435041287
  error estimate for blocks of size 2^( 5) =       0.000447147196
  error estimate for blocks of size 2^( 6) =       0.000454602599
  error estimate for blocks of size 2^( 7) =       0.000457747447

      target function =                  N/A
              le_mean =     -16.904771914766
             les_mean =     286.092233740351
             stat err =       0.000448634632
             autocorr =       1.295275504395
              std dev =       0.557476695820
             le_variance =       0.310780266382


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690477191477e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+50, overlap shift 9.3132e+51 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904771914776       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904771914776       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e+50 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+51, overlap shift 3.7253e+52 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904771914776       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904771914776       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+51 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4901e+52, overlap shift 1.4901e+53 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904771914776       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904771914776       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+52 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.257806 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6961e+01
  </log>
  <optVariables href="H2O.s074.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 74
    time step          = 0.05
    reference energy   = -16.8458
    reference variance = 0.607245
====================================================
  Execution time = 1.3907e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s074
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2325e-01
  Total weights = 1.9516e+06
  Execution time = 1.8887e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312813634137
                                         uncertainty =       0.002002262424

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312813634137
                                         uncertainty =       0.002002262424

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395431964
  error estimate for blocks of size 2^( 2) =       0.000409246415
  error estimate for blocks of size 2^( 3) =       0.000423374101
  error estimate for blocks of size 2^( 4) =       0.000436561993
  error estimate for blocks of size 2^( 5) =       0.000447605542
  error estimate for blocks of size 2^( 6) =       0.000454969370
  error estimate for blocks of size 2^( 7) =       0.000458831133

      target function =                  N/A
              le_mean =     -16.904109690999
             les_mean =     286.072178984172
             stat err =       0.000449492010
             autocorr =       1.292112736636
              std dev =       0.559225246937
             le_variance =       0.312732876811

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312813634137
                                         uncertainty =       0.002002262424

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312813634137
                                         uncertainty =       0.002002262424

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395431964
  error estimate for blocks of size 2^( 2) =       0.000409246415
  error estimate for blocks of size 2^( 3) =       0.000423374101
  error estimate for blocks of size 2^( 4) =       0.000436561993
  error estimate for blocks of size 2^( 5) =       0.000447605542
  error estimate for blocks of size 2^( 6) =       0.000454969370
  error estimate for blocks of size 2^( 7) =       0.000458831133

      target function =                  N/A
              le_mean =     -16.904109690999
             les_mean =     286.072178984172
             stat err =       0.000449492010
             autocorr =       1.292112736636
              std dev =       0.559225246937
             le_variance =       0.312732876811

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312813634137
                                         uncertainty =       0.002002262424

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312813634137
                                         uncertainty =       0.002002262424

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395431964
  error estimate for blocks of size 2^( 2) =       0.000409246415
  error estimate for blocks of size 2^( 3) =       0.000423374101
  error estimate for blocks of size 2^( 4) =       0.000436561993
  error estimate for blocks of size 2^( 5) =       0.000447605542
  error estimate for blocks of size 2^( 6) =       0.000454969370
  error estimate for blocks of size 2^( 7) =       0.000458831133

      target function =                  N/A
              le_mean =     -16.904109690999
             les_mean =     286.072178984172
             stat err =       0.000449492010
             autocorr =       1.292112736636
              std dev =       0.559225246937
             le_variance =       0.312732876811

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312813634137
                                         uncertainty =       0.002002262424

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312813634137
                                         uncertainty =       0.002002262424

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395431964
  error estimate for blocks of size 2^( 2) =       0.000409246415
  error estimate for blocks of size 2^( 3) =       0.000423374101
  error estimate for blocks of size 2^( 4) =       0.000436561993
  error estimate for blocks of size 2^( 5) =       0.000447605542
  error estimate for blocks of size 2^( 6) =       0.000454969370
  error estimate for blocks of size 2^( 7) =       0.000458831133

      target function =                  N/A
              le_mean =     -16.904109690999
             les_mean =     286.072178984172
             stat err =       0.000449492010
             autocorr =       1.292112736636
              std dev =       0.559225246937
             le_variance =       0.312732876811


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904109690999        initial  <--
     9.3132e+50     9.3132e+51             0.0000e+00       -16.904109690999
     3.7253e+51     3.7253e+52             0.0000e+00       -16.904109690999
     1.4901e+52     1.4901e+53             0.0000e+00       -16.904109690999

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.4679
  </log>
  <optVariables href="H2O.s074.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0434e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s075 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s075 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=75  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 75
    time step          = 0.05
    reference energy   = -16.8778
    reference variance = 0.276113
====================================================
  Execution time = 1.4360e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s075
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5223e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2928e-01
  Total weights = 1.951687994e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5914e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312347652620
                                         uncertainty =       0.002414112869

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312347652620
                                         uncertainty =       0.002414112869

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395183606
  error estimate for blocks of size 2^( 2) =       0.000409005715
  error estimate for blocks of size 2^( 3) =       0.000422828813
  error estimate for blocks of size 2^( 4) =       0.000435460755
  error estimate for blocks of size 2^( 5) =       0.000446151807
  error estimate for blocks of size 2^( 6) =       0.000453498613
  error estimate for blocks of size 2^( 7) =       0.000457295839

      target function =                  N/A
              le_mean =     -16.904217821351
             les_mean =     286.081859074036
             stat err =       0.000448101754
             autocorr =       1.285746783203
              std dev =       0.558874015728
             le_variance =       0.312340165456


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690421782135e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+51, overlap shift 9.3132e+52 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904217821357       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904217821357       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e+51 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+52, overlap shift 3.7253e+53 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904217821357       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904217821357       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+52 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4901e+53, overlap shift 1.4901e+54 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904217821357       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904217821357       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+53 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.258876 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6957e+01
  </log>
  <optVariables href="H2O.s075.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 75
    time step          = 0.05
    reference energy   = -16.8974
    reference variance = 0.227957
====================================================
  Execution time = 1.4074e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s075
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2363e-01
  Total weights = 1.9516e+06
  Execution time = 1.8793e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310778543202
                                         uncertainty =       0.001970517758

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310778543202
                                         uncertainty =       0.001970517758

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394224230
  error estimate for blocks of size 2^( 2) =       0.000408279652
  error estimate for blocks of size 2^( 3) =       0.000422489498
  error estimate for blocks of size 2^( 4) =       0.000434794781
  error estimate for blocks of size 2^( 5) =       0.000445620868
  error estimate for blocks of size 2^( 6) =       0.000454006080
  error estimate for blocks of size 2^( 7) =       0.000458838294

      target function =                  N/A
              le_mean =     -16.904549621182
             les_mean =     286.087424210627
             stat err =       0.000448315006
             autocorr =       1.293242365460
              std dev =       0.557517253372
             le_variance =       0.310825487808

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310778543202
                                         uncertainty =       0.001970517758

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310778543202
                                         uncertainty =       0.001970517758

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394224230
  error estimate for blocks of size 2^( 2) =       0.000408279652
  error estimate for blocks of size 2^( 3) =       0.000422489498
  error estimate for blocks of size 2^( 4) =       0.000434794781
  error estimate for blocks of size 2^( 5) =       0.000445620868
  error estimate for blocks of size 2^( 6) =       0.000454006080
  error estimate for blocks of size 2^( 7) =       0.000458838294

      target function =                  N/A
              le_mean =     -16.904549621182
             les_mean =     286.087424210627
             stat err =       0.000448315006
             autocorr =       1.293242365460
              std dev =       0.557517253372
             le_variance =       0.310825487808

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310778543202
                                         uncertainty =       0.001970517758

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310778543202
                                         uncertainty =       0.001970517758

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394224230
  error estimate for blocks of size 2^( 2) =       0.000408279652
  error estimate for blocks of size 2^( 3) =       0.000422489498
  error estimate for blocks of size 2^( 4) =       0.000434794781
  error estimate for blocks of size 2^( 5) =       0.000445620868
  error estimate for blocks of size 2^( 6) =       0.000454006080
  error estimate for blocks of size 2^( 7) =       0.000458838294

      target function =                  N/A
              le_mean =     -16.904549621182
             les_mean =     286.087424210627
             stat err =       0.000448315006
             autocorr =       1.293242365460
              std dev =       0.557517253372
             le_variance =       0.310825487808

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310778543202
                                         uncertainty =       0.001970517758

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310778543202
                                         uncertainty =       0.001970517758

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394224230
  error estimate for blocks of size 2^( 2) =       0.000408279652
  error estimate for blocks of size 2^( 3) =       0.000422489498
  error estimate for blocks of size 2^( 4) =       0.000434794781
  error estimate for blocks of size 2^( 5) =       0.000445620868
  error estimate for blocks of size 2^( 6) =       0.000454006080
  error estimate for blocks of size 2^( 7) =       0.000458838294

      target function =                  N/A
              le_mean =     -16.904549621182
             les_mean =     286.087424210627
             stat err =       0.000448315006
             autocorr =       1.293242365460
              std dev =       0.557517253372
             le_variance =       0.310825487808


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904549621182        initial  <--
     9.3132e+51     9.3132e+52             0.0000e+00       -16.904549621182
     3.7253e+52     3.7253e+53             0.0000e+00       -16.904549621182
     1.4901e+53     1.4901e+54             0.0000e+00       -16.904549621182

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.6033
  </log>
  <optVariables href="H2O.s075.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0566e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s076 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s076 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=76  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 76
    time step          = 0.05
    reference energy   = -16.9233
    reference variance = 0.18054
====================================================
  Execution time = 1.4157e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s076
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5234e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2504e-01
  Total weights = 1.951814507e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.9081e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312630210119
                                         uncertainty =       0.002087969298

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312630210119
                                         uncertainty =       0.002087969298

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395308347
  error estimate for blocks of size 2^( 2) =       0.000409160631
  error estimate for blocks of size 2^( 3) =       0.000423319820
  error estimate for blocks of size 2^( 4) =       0.000436023753
  error estimate for blocks of size 2^( 5) =       0.000445813031
  error estimate for blocks of size 2^( 6) =       0.000451939592
  error estimate for blocks of size 2^( 7) =       0.000458073904

      target function =                  N/A
              le_mean =     -16.904182244312
             les_mean =     286.076412773048
             stat err =       0.000447962570
             autocorr =       1.284137372514
              std dev =       0.559050425710
             le_variance =       0.312537378487


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690418224431e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+52, overlap shift 9.3132e+53 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904182244327       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904182244327       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e+52 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+53, overlap shift 3.7253e+54 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904182244327       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904182244327       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+53 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4901e+54, overlap shift 1.4901e+55 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904182244327       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904182244327       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+54 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.259911 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7070e+01
  </log>
  <optVariables href="H2O.s076.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 76
    time step          = 0.05
    reference energy   = -16.8552
    reference variance = 0.2384
====================================================
  Execution time = 1.4111e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s076
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2536e-01
  Total weights = 1.9517e+06
  Execution time = 2.2451e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313283754578
                                         uncertainty =       0.002815657073

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313283754578
                                         uncertainty =       0.002815657073

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395746439
  error estimate for blocks of size 2^( 2) =       0.000409503392
  error estimate for blocks of size 2^( 3) =       0.000424329013
  error estimate for blocks of size 2^( 4) =       0.000437724899
  error estimate for blocks of size 2^( 5) =       0.000449748002
  error estimate for blocks of size 2^( 6) =       0.000455697979
  error estimate for blocks of size 2^( 7) =       0.000460374452

      target function =                  N/A
              le_mean =     -16.904435041891
             les_mean =     286.085283987674
             stat err =       0.000450886333
             autocorr =       1.298075970188
              std dev =       0.559669981804
             le_variance =       0.313230488533

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313283754578
                                         uncertainty =       0.002815657073

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313283754578
                                         uncertainty =       0.002815657073

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395746439
  error estimate for blocks of size 2^( 2) =       0.000409503392
  error estimate for blocks of size 2^( 3) =       0.000424329013
  error estimate for blocks of size 2^( 4) =       0.000437724899
  error estimate for blocks of size 2^( 5) =       0.000449748002
  error estimate for blocks of size 2^( 6) =       0.000455697979
  error estimate for blocks of size 2^( 7) =       0.000460374452

      target function =                  N/A
              le_mean =     -16.904435041891
             les_mean =     286.085283987674
             stat err =       0.000450886333
             autocorr =       1.298075970188
              std dev =       0.559669981804
             le_variance =       0.313230488533

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313283754578
                                         uncertainty =       0.002815657073

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313283754578
                                         uncertainty =       0.002815657073

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395746439
  error estimate for blocks of size 2^( 2) =       0.000409503392
  error estimate for blocks of size 2^( 3) =       0.000424329013
  error estimate for blocks of size 2^( 4) =       0.000437724899
  error estimate for blocks of size 2^( 5) =       0.000449748002
  error estimate for blocks of size 2^( 6) =       0.000455697979
  error estimate for blocks of size 2^( 7) =       0.000460374452

      target function =                  N/A
              le_mean =     -16.904435041891
             les_mean =     286.085283987674
             stat err =       0.000450886333
             autocorr =       1.298075970188
              std dev =       0.559669981804
             le_variance =       0.313230488533

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313283754578
                                         uncertainty =       0.002815657073

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313283754578
                                         uncertainty =       0.002815657073

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395746439
  error estimate for blocks of size 2^( 2) =       0.000409503392
  error estimate for blocks of size 2^( 3) =       0.000424329013
  error estimate for blocks of size 2^( 4) =       0.000437724899
  error estimate for blocks of size 2^( 5) =       0.000449748002
  error estimate for blocks of size 2^( 6) =       0.000455697979
  error estimate for blocks of size 2^( 7) =       0.000460374452

      target function =                  N/A
              le_mean =     -16.904435041891
             les_mean =     286.085283987674
             stat err =       0.000450886333
             autocorr =       1.298075970188
              std dev =       0.559669981804
             le_variance =       0.313230488533


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904435041891        initial  <--
     9.3132e+52     9.3132e+53             0.0000e+00       -16.904435041891
     3.7253e+53     3.7253e+54             0.0000e+00       -16.904435041891
     1.4901e+54     1.4901e+55             0.0000e+00       -16.904435041891

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.7850
  </log>
  <optVariables href="H2O.s076.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1860e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s077 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s077 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=77  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 77
    time step          = 0.05
    reference energy   = -16.9628
    reference variance = 0.197059
====================================================
  Execution time = 1.4294e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s077
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5284e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2306e-01
  Total weights = 1.951697827e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6027e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311845861418
                                         uncertainty =       0.001974438907

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311845861418
                                         uncertainty =       0.001974438907

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394892393
  error estimate for blocks of size 2^( 2) =       0.000408979044
  error estimate for blocks of size 2^( 3) =       0.000423462007
  error estimate for blocks of size 2^( 4) =       0.000437001688
  error estimate for blocks of size 2^( 5) =       0.000447478651
  error estimate for blocks of size 2^( 6) =       0.000455339419
  error estimate for blocks of size 2^( 7) =       0.000457463169

      target function =                  N/A
              le_mean =     -16.904097330977
             les_mean =     286.071564158539
             stat err =       0.000449320732
             autocorr =       1.294658952441
              std dev =       0.558462178096
             le_variance =       0.311880004363


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690409733098e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+53, overlap shift 9.3132e+54 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904097330951       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904097330951       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e+53 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+54, overlap shift 3.7253e+55 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904097330951       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904097330951       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+54 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4901e+55, overlap shift 1.4901e+56 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904097330951       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904097330951       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+55 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.261020 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6901e+01
  </log>
  <optVariables href="H2O.s077.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 77
    time step          = 0.05
    reference energy   = -16.9165
    reference variance = 0.272216
====================================================
  Execution time = 1.4129e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s077
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.1858e-01
  Total weights = 1.9516e+06
  Execution time = 1.8871e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305927360179
                                         uncertainty =       0.001387817541

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305927360179
                                         uncertainty =       0.001387817541

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391096880
  error estimate for blocks of size 2^( 2) =       0.000405448190
  error estimate for blocks of size 2^( 3) =       0.000419764902
  error estimate for blocks of size 2^( 4) =       0.000433980889
  error estimate for blocks of size 2^( 5) =       0.000445219946
  error estimate for blocks of size 2^( 6) =       0.000453078926
  error estimate for blocks of size 2^( 7) =       0.000455307021

      target function =                  N/A
              le_mean =     -16.905333270617
             les_mean =     286.108871350069
             stat err =       0.000446896695
             autocorr =       1.305706551704
              std dev =       0.553094512046
             le_variance =       0.305913539255

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305927360179
                                         uncertainty =       0.001387817541

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305927360179
                                         uncertainty =       0.001387817541

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391096880
  error estimate for blocks of size 2^( 2) =       0.000405448190
  error estimate for blocks of size 2^( 3) =       0.000419764902
  error estimate for blocks of size 2^( 4) =       0.000433980889
  error estimate for blocks of size 2^( 5) =       0.000445219946
  error estimate for blocks of size 2^( 6) =       0.000453078926
  error estimate for blocks of size 2^( 7) =       0.000455307021

      target function =                  N/A
              le_mean =     -16.905333270617
             les_mean =     286.108871350069
             stat err =       0.000446896695
             autocorr =       1.305706551704
              std dev =       0.553094512046
             le_variance =       0.305913539255

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305927360179
                                         uncertainty =       0.001387817541

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305927360179
                                         uncertainty =       0.001387817541

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391096880
  error estimate for blocks of size 2^( 2) =       0.000405448190
  error estimate for blocks of size 2^( 3) =       0.000419764902
  error estimate for blocks of size 2^( 4) =       0.000433980889
  error estimate for blocks of size 2^( 5) =       0.000445219946
  error estimate for blocks of size 2^( 6) =       0.000453078926
  error estimate for blocks of size 2^( 7) =       0.000455307021

      target function =                  N/A
              le_mean =     -16.905333270617
             les_mean =     286.108871350069
             stat err =       0.000446896695
             autocorr =       1.305706551704
              std dev =       0.553094512046
             le_variance =       0.305913539255

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305927360179
                                         uncertainty =       0.001387817541

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305927360179
                                         uncertainty =       0.001387817541

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391096880
  error estimate for blocks of size 2^( 2) =       0.000405448190
  error estimate for blocks of size 2^( 3) =       0.000419764902
  error estimate for blocks of size 2^( 4) =       0.000433980889
  error estimate for blocks of size 2^( 5) =       0.000445219946
  error estimate for blocks of size 2^( 6) =       0.000453078926
  error estimate for blocks of size 2^( 7) =       0.000455307021

      target function =                  N/A
              le_mean =     -16.905333270617
             les_mean =     286.108871350069
             stat err =       0.000446896695
             autocorr =       1.305706551704
              std dev =       0.553094512046
             le_variance =       0.305913539255


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905333270617        initial  <--
     9.3132e+53     9.3132e+54             0.0000e+00       -16.905333270617
     3.7253e+54     3.7253e+55             0.0000e+00       -16.905333270617
     1.4901e+55     1.4901e+56             0.0000e+00       -16.905333270617

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.6624
  </log>
  <optVariables href="H2O.s077.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0569e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s078 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s078 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=78  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 78
    time step          = 0.05
    reference energy   = -16.899
    reference variance = 0.286995
====================================================
  Execution time = 1.4396e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s078
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5229e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.1584e-01
  Total weights = 1.951467500e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5890e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306293150860
                                         uncertainty =       0.001843333164

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306293150860
                                         uncertainty =       0.001843333164

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391352904
  error estimate for blocks of size 2^( 2) =       0.000405960731
  error estimate for blocks of size 2^( 3) =       0.000420561459
  error estimate for blocks of size 2^( 4) =       0.000433727820
  error estimate for blocks of size 2^( 5) =       0.000445356591
  error estimate for blocks of size 2^( 6) =       0.000454504491
  error estimate for blocks of size 2^( 7) =       0.000458259717

      target function =                  N/A
              le_mean =     -16.904354075241
             les_mean =     286.073023917198
             stat err =       0.000447962155
             autocorr =       1.310223931830
              std dev =       0.553456584774
             le_variance =       0.306314191229


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690435407524e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+54, overlap shift 9.3132e+55 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904354075276       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904354075276       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e+54 is 5.213181e-59

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+55, overlap shift 3.7253e+56 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904354075276       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904354075276       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+55 is 1.303295e-59

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4901e+56, overlap shift 1.4901e+57 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904354075276       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904354075276       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+56 is 3.258238e-60

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.262094 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6990e+01
  </log>
  <optVariables href="H2O.s078.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 78
    time step          = 0.05
    reference energy   = -16.8614
    reference variance = 0.277608
====================================================
  Execution time = 1.3982e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s078
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.2379e-01
  Total weights = 1.9514e+06
  Execution time = 1.8864e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312690956801
                                         uncertainty =       0.001820579565

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312690956801
                                         uncertainty =       0.001820579565

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395381779
  error estimate for blocks of size 2^( 2) =       0.000409261220
  error estimate for blocks of size 2^( 3) =       0.000423884111
  error estimate for blocks of size 2^( 4) =       0.000437686143
  error estimate for blocks of size 2^( 5) =       0.000449836485
  error estimate for blocks of size 2^( 6) =       0.000456397067
  error estimate for blocks of size 2^( 7) =       0.000460689549

      target function =                  N/A
              le_mean =     -16.903292259212
             les_mean =     286.045080623787
             stat err =       0.000451152311
             autocorr =       1.302006255352
              std dev =       0.559154274132
             le_variance =       0.312653502280

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312690956801
                                         uncertainty =       0.001820579565

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312690956801
                                         uncertainty =       0.001820579565

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395381779
  error estimate for blocks of size 2^( 2) =       0.000409261220
  error estimate for blocks of size 2^( 3) =       0.000423884111
  error estimate for blocks of size 2^( 4) =       0.000437686143
  error estimate for blocks of size 2^( 5) =       0.000449836485
  error estimate for blocks of size 2^( 6) =       0.000456397067
  error estimate for blocks of size 2^( 7) =       0.000460689549

      target function =                  N/A
              le_mean =     -16.903292259212
             les_mean =     286.045080623787
             stat err =       0.000451152311
             autocorr =       1.302006255352
              std dev =       0.559154274132
             le_variance =       0.312653502280

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312690956801
                                         uncertainty =       0.001820579565

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312690956801
                                         uncertainty =       0.001820579565

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395381779
  error estimate for blocks of size 2^( 2) =       0.000409261220
  error estimate for blocks of size 2^( 3) =       0.000423884111
  error estimate for blocks of size 2^( 4) =       0.000437686143
  error estimate for blocks of size 2^( 5) =       0.000449836485
  error estimate for blocks of size 2^( 6) =       0.000456397067
  error estimate for blocks of size 2^( 7) =       0.000460689549

      target function =                  N/A
              le_mean =     -16.903292259212
             les_mean =     286.045080623787
             stat err =       0.000451152311
             autocorr =       1.302006255352
              std dev =       0.559154274132
             le_variance =       0.312653502280

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312690956801
                                         uncertainty =       0.001820579565

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312690956801
                                         uncertainty =       0.001820579565

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395381779
  error estimate for blocks of size 2^( 2) =       0.000409261220
  error estimate for blocks of size 2^( 3) =       0.000423884111
  error estimate for blocks of size 2^( 4) =       0.000437686143
  error estimate for blocks of size 2^( 5) =       0.000449836485
  error estimate for blocks of size 2^( 6) =       0.000456397067
  error estimate for blocks of size 2^( 7) =       0.000460689549

      target function =                  N/A
              le_mean =     -16.903292259212
             les_mean =     286.045080623787
             stat err =       0.000451152311
             autocorr =       1.302006255352
              std dev =       0.559154274132
             le_variance =       0.312653502280


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.903292259212        initial  <--
     9.3132e+54     9.3132e+55             5.2132e-59       -16.903292259212
     3.7253e+55     3.7253e+56             1.3033e-59       -16.903292259212
     1.4901e+56     1.4901e+57             3.2582e-60       -16.903292259212

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.5715
  </log>
  <optVariables href="H2O.s078.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0568e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s079 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s079 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=79  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 79
    time step          = 0.05
    reference energy   = -16.8922
    reference variance = 0.246547
====================================================
  Execution time = 1.4683e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s079
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5236e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2490e-01
  Total weights = 1.951781637e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.8907e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313883325259
                                         uncertainty =       0.003722492384

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313883325259
                                         uncertainty =       0.003722492384

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396167634
  error estimate for blocks of size 2^( 2) =       0.000410306737
  error estimate for blocks of size 2^( 3) =       0.000424233742
  error estimate for blocks of size 2^( 4) =       0.000437774228
  error estimate for blocks of size 2^( 5) =       0.000449251207
  error estimate for blocks of size 2^( 6) =       0.000457774243
  error estimate for blocks of size 2^( 7) =       0.000463835753

      target function =                  N/A
              le_mean =     -16.904441608711
             les_mean =     286.085045821619
             stat err =       0.000452158858
             autocorr =       1.302639075894
              std dev =       0.560265641377
             le_variance =       0.313897588908


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690444160871e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+55, overlap shift 9.3132e+56 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904441608738       residual = 9.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904441608738       residual = 9.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e+55 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+56, overlap shift 3.7253e+57 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904441608738       residual = 9.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904441608738       residual = 9.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+56 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4901e+57, overlap shift 1.4901e+58 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904441608738       residual = 9.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904441608738       residual = 9.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+57 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.263134 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7579e+01
  </log>
  <optVariables href="H2O.s079.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 79
    time step          = 0.05
    reference energy   = -16.895
    reference variance = 0.180761
====================================================
  Execution time = 1.4269e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s079
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2380e-01
  Total weights = 1.9516e+06
  Execution time = 1.8959e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311233300576
                                         uncertainty =       0.001827026319

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311233300576
                                         uncertainty =       0.001827026319

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394488269
  error estimate for blocks of size 2^( 2) =       0.000408264479
  error estimate for blocks of size 2^( 3) =       0.000422865298
  error estimate for blocks of size 2^( 4) =       0.000436811839
  error estimate for blocks of size 2^( 5) =       0.000448177581
  error estimate for blocks of size 2^( 6) =       0.000455659724
  error estimate for blocks of size 2^( 7) =       0.000459854188

      target function =                  N/A
              le_mean =     -16.903568651114
             les_mean =     286.054434033541
             stat err =       0.000450125833
             autocorr =       1.301966142520
              std dev =       0.557890660029
             le_variance =       0.311241988547

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311233300576
                                         uncertainty =       0.001827026319

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311233300576
                                         uncertainty =       0.001827026319

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394488269
  error estimate for blocks of size 2^( 2) =       0.000408264479
  error estimate for blocks of size 2^( 3) =       0.000422865298
  error estimate for blocks of size 2^( 4) =       0.000436811839
  error estimate for blocks of size 2^( 5) =       0.000448177581
  error estimate for blocks of size 2^( 6) =       0.000455659724
  error estimate for blocks of size 2^( 7) =       0.000459854188

      target function =                  N/A
              le_mean =     -16.903568651114
             les_mean =     286.054434033541
             stat err =       0.000450125833
             autocorr =       1.301966142520
              std dev =       0.557890660029
             le_variance =       0.311241988547

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311233300576
                                         uncertainty =       0.001827026319

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311233300576
                                         uncertainty =       0.001827026319

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394488269
  error estimate for blocks of size 2^( 2) =       0.000408264479
  error estimate for blocks of size 2^( 3) =       0.000422865298
  error estimate for blocks of size 2^( 4) =       0.000436811839
  error estimate for blocks of size 2^( 5) =       0.000448177581
  error estimate for blocks of size 2^( 6) =       0.000455659724
  error estimate for blocks of size 2^( 7) =       0.000459854188

      target function =                  N/A
              le_mean =     -16.903568651114
             les_mean =     286.054434033541
             stat err =       0.000450125833
             autocorr =       1.301966142520
              std dev =       0.557890660029
             le_variance =       0.311241988547

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311233300576
                                         uncertainty =       0.001827026319

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311233300576
                                         uncertainty =       0.001827026319

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394488269
  error estimate for blocks of size 2^( 2) =       0.000408264479
  error estimate for blocks of size 2^( 3) =       0.000422865298
  error estimate for blocks of size 2^( 4) =       0.000436811839
  error estimate for blocks of size 2^( 5) =       0.000448177581
  error estimate for blocks of size 2^( 6) =       0.000455659724
  error estimate for blocks of size 2^( 7) =       0.000459854188

      target function =                  N/A
              le_mean =     -16.903568651114
             les_mean =     286.054434033541
             stat err =       0.000450125833
             autocorr =       1.301966142520
              std dev =       0.557890660029
             le_variance =       0.311241988547


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.903568651114        initial  <--
     9.3132e+55     9.3132e+56             0.0000e+00       -16.903568651114
     3.7253e+56     3.7253e+57             0.0000e+00       -16.903568651114
     1.4901e+57     1.4901e+58             0.0000e+00       -16.903568651114

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.8519
  </log>
  <optVariables href="H2O.s079.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1436e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s080 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s080 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=80  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 80
    time step          = 0.05
    reference energy   = -16.9705
    reference variance = 0.301932
====================================================
  Execution time = 1.4432e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s080
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5259e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2286e-01
  Total weights = 1.951569846e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5883e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310953259639
                                         uncertainty =       0.002288428478

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310953259639
                                         uncertainty =       0.002288428478

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394255892
  error estimate for blocks of size 2^( 2) =       0.000408533383
  error estimate for blocks of size 2^( 3) =       0.000423217337
  error estimate for blocks of size 2^( 4) =       0.000436501990
  error estimate for blocks of size 2^( 5) =       0.000447455431
  error estimate for blocks of size 2^( 6) =       0.000454396127
  error estimate for blocks of size 2^( 7) =       0.000457711381

      target function =                  N/A
              le_mean =     -16.903726604814
             les_mean =     286.058837915912
             stat err =       0.000449016232
             autocorr =       1.297082789671
              std dev =       0.557562030187
             le_variance =       0.310875417507


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690372660481e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+56, overlap shift 9.3132e+57 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903726604803       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903726604803       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e+56 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+57, overlap shift 3.7253e+58 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903726604803       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903726604803       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+57 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4901e+58, overlap shift 1.4901e+59 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903726604803       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903726604803       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+58 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.264221 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7026e+01
  </log>
  <optVariables href="H2O.s080.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 80
    time step          = 0.05
    reference energy   = -16.8212
    reference variance = 0.555358
====================================================
  Execution time = 1.4193e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s080
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2122e-01
  Total weights = 1.9518e+06
  Execution time = 1.8894e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309755809801
                                         uncertainty =       0.002199599314

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309755809801
                                         uncertainty =       0.002199599314

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393549124
  error estimate for blocks of size 2^( 2) =       0.000407562490
  error estimate for blocks of size 2^( 3) =       0.000422112504
  error estimate for blocks of size 2^( 4) =       0.000434959201
  error estimate for blocks of size 2^( 5) =       0.000446937603
  error estimate for blocks of size 2^( 6) =       0.000452970990
  error estimate for blocks of size 2^( 7) =       0.000456196961

      target function =                  N/A
              le_mean =     -16.903866917240
             les_mean =     286.061935507750
             stat err =       0.000447766189
             autocorr =       1.294507865603
              std dev =       0.556562508006
             le_variance =       0.309761825318

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309755809801
                                         uncertainty =       0.002199599314

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309755809801
                                         uncertainty =       0.002199599314

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393549124
  error estimate for blocks of size 2^( 2) =       0.000407562490
  error estimate for blocks of size 2^( 3) =       0.000422112504
  error estimate for blocks of size 2^( 4) =       0.000434959201
  error estimate for blocks of size 2^( 5) =       0.000446937603
  error estimate for blocks of size 2^( 6) =       0.000452970990
  error estimate for blocks of size 2^( 7) =       0.000456196961

      target function =                  N/A
              le_mean =     -16.903866917240
             les_mean =     286.061935507750
             stat err =       0.000447766189
             autocorr =       1.294507865603
              std dev =       0.556562508006
             le_variance =       0.309761825318

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309755809801
                                         uncertainty =       0.002199599314

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309755809801
                                         uncertainty =       0.002199599314

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393549124
  error estimate for blocks of size 2^( 2) =       0.000407562490
  error estimate for blocks of size 2^( 3) =       0.000422112504
  error estimate for blocks of size 2^( 4) =       0.000434959201
  error estimate for blocks of size 2^( 5) =       0.000446937603
  error estimate for blocks of size 2^( 6) =       0.000452970990
  error estimate for blocks of size 2^( 7) =       0.000456196961

      target function =                  N/A
              le_mean =     -16.903866917240
             les_mean =     286.061935507750
             stat err =       0.000447766189
             autocorr =       1.294507865603
              std dev =       0.556562508006
             le_variance =       0.309761825318

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309755809801
                                         uncertainty =       0.002199599314

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309755809801
                                         uncertainty =       0.002199599314

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393549124
  error estimate for blocks of size 2^( 2) =       0.000407562490
  error estimate for blocks of size 2^( 3) =       0.000422112504
  error estimate for blocks of size 2^( 4) =       0.000434959201
  error estimate for blocks of size 2^( 5) =       0.000446937603
  error estimate for blocks of size 2^( 6) =       0.000452970990
  error estimate for blocks of size 2^( 7) =       0.000456196961

      target function =                  N/A
              le_mean =     -16.903866917240
             les_mean =     286.061935507750
             stat err =       0.000447766189
             autocorr =       1.294507865603
              std dev =       0.556562508006
             le_variance =       0.309761825318


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.903866917240        initial  <--
     9.3132e+56     9.3132e+57             0.0000e+00       -16.903866917240
     3.7253e+57     3.7253e+58             0.0000e+00       -16.903866917240
     1.4901e+58     1.4901e+59             0.0000e+00       -16.903866917240

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.7500
  </log>
  <optVariables href="H2O.s080.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0782e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s081 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s081 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=81  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 81
    time step          = 0.05
    reference energy   = -16.8677
    reference variance = 0.46695
====================================================
  Execution time = 1.4456e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s081
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5228e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2642e-01
  Total weights = 1.951353181e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5771e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313157534403
                                         uncertainty =       0.002809492263

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313157534403
                                         uncertainty =       0.002809492263

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395757438
  error estimate for blocks of size 2^( 2) =       0.000409612816
  error estimate for blocks of size 2^( 3) =       0.000424137921
  error estimate for blocks of size 2^( 4) =       0.000436305796
  error estimate for blocks of size 2^( 5) =       0.000446515409
  error estimate for blocks of size 2^( 6) =       0.000454646036
  error estimate for blocks of size 2^( 7) =       0.000461379776

      target function =                  N/A
              le_mean =     -16.905298729982
             les_mean =     286.115545736769
             stat err =       0.000449711754
             autocorr =       1.291249915438
              std dev =       0.559685536341
             le_variance =       0.313247899589


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690529872998e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+57, overlap shift 9.3132e+58 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905298729999       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905298729999       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e+57 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+58, overlap shift 3.7253e+59 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905298729999       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905298729999       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+58 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4901e+59, overlap shift 1.4901e+60 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905298729999       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905298729999       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+59 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.265321 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7038e+01
  </log>
  <optVariables href="H2O.s081.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 81
    time step          = 0.05
    reference energy   = -16.9275
    reference variance = 0.305511
====================================================
  Execution time = 1.4207e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s081
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.3393e-01
  Total weights = 1.9518e+06
  Execution time = 1.8936e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316095074590
                                         uncertainty =       0.002890684926

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316095074590
                                         uncertainty =       0.002890684926

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397521936
  error estimate for blocks of size 2^( 2) =       0.000411840594
  error estimate for blocks of size 2^( 3) =       0.000425793202
  error estimate for blocks of size 2^( 4) =       0.000438949097
  error estimate for blocks of size 2^( 5) =       0.000449861639
  error estimate for blocks of size 2^( 6) =       0.000457011443
  error estimate for blocks of size 2^( 7) =       0.000462098780

      target function =                  N/A
              le_mean =     -16.904158021305
             les_mean =     286.084489140372
             stat err =       0.000451980240
             autocorr =       1.292756406216
              std dev =       0.562180913416
             le_variance =       0.316047379410

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316095074590
                                         uncertainty =       0.002890684926

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316095074590
                                         uncertainty =       0.002890684926

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397521936
  error estimate for blocks of size 2^( 2) =       0.000411840594
  error estimate for blocks of size 2^( 3) =       0.000425793202
  error estimate for blocks of size 2^( 4) =       0.000438949097
  error estimate for blocks of size 2^( 5) =       0.000449861639
  error estimate for blocks of size 2^( 6) =       0.000457011443
  error estimate for blocks of size 2^( 7) =       0.000462098780

      target function =                  N/A
              le_mean =     -16.904158021305
             les_mean =     286.084489140372
             stat err =       0.000451980240
             autocorr =       1.292756406216
              std dev =       0.562180913416
             le_variance =       0.316047379410

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316095074590
                                         uncertainty =       0.002890684926

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316095074590
                                         uncertainty =       0.002890684926

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397521936
  error estimate for blocks of size 2^( 2) =       0.000411840594
  error estimate for blocks of size 2^( 3) =       0.000425793202
  error estimate for blocks of size 2^( 4) =       0.000438949097
  error estimate for blocks of size 2^( 5) =       0.000449861639
  error estimate for blocks of size 2^( 6) =       0.000457011443
  error estimate for blocks of size 2^( 7) =       0.000462098780

      target function =                  N/A
              le_mean =     -16.904158021305
             les_mean =     286.084489140372
             stat err =       0.000451980240
             autocorr =       1.292756406216
              std dev =       0.562180913416
             le_variance =       0.316047379410

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316095074590
                                         uncertainty =       0.002890684926

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316095074590
                                         uncertainty =       0.002890684926

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397521936
  error estimate for blocks of size 2^( 2) =       0.000411840594
  error estimate for blocks of size 2^( 3) =       0.000425793202
  error estimate for blocks of size 2^( 4) =       0.000438949097
  error estimate for blocks of size 2^( 5) =       0.000449861639
  error estimate for blocks of size 2^( 6) =       0.000457011443
  error estimate for blocks of size 2^( 7) =       0.000462098780

      target function =                  N/A
              le_mean =     -16.904158021305
             les_mean =     286.084489140372
             stat err =       0.000451980240
             autocorr =       1.292756406216
              std dev =       0.562180913416
             le_variance =       0.316047379410


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904158021305        initial  <--
     9.3132e+57     9.3132e+58             0.0000e+00       -16.904158021305
     3.7253e+58     3.7253e+59             0.0000e+00       -16.904158021305
     1.4901e+59     1.4901e+60             0.0000e+00       -16.904158021305

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.7847
  </log>
  <optVariables href="H2O.s081.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0828e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s082 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s082 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=82  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 82
    time step          = 0.05
    reference energy   = -16.9734
    reference variance = 0.268239
====================================================
  Execution time = 1.4482e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s082
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5247e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2834e-01
  Total weights = 1.951682234e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5899e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314430324927
                                         uncertainty =       0.003627256059

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314430324927
                                         uncertainty =       0.003627256059

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396518892
  error estimate for blocks of size 2^( 2) =       0.000411203443
  error estimate for blocks of size 2^( 3) =       0.000425817039
  error estimate for blocks of size 2^( 4) =       0.000438534443
  error estimate for blocks of size 2^( 5) =       0.000450380722
  error estimate for blocks of size 2^( 6) =       0.000459686782
  error estimate for blocks of size 2^( 7) =       0.000461678637

      target function =                  N/A
              le_mean =     -16.904642488048
             les_mean =     286.095277974989
             stat err =       0.000452570146
             autocorr =       1.302698868830
              std dev =       0.560762395140
             le_variance =       0.314454463803


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690464248805e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+58, overlap shift 9.3132e+59 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904642488066       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904642488066       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904642488066       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e+58 is 5.980232e-63

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+59, overlap shift 3.7253e+60 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904642488066       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904642488066       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904642488066       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+59 is 1.495058e-63

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4901e+60, overlap shift 1.4901e+61 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904642488066       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904642488066       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904642488066       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+60 is 3.737645e-64

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.266645 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7077e+01
  </log>
  <optVariables href="H2O.s082.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 82
    time step          = 0.05
    reference energy   = -16.9173
    reference variance = 0.235041
====================================================
  Execution time = 1.4011e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s082
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2690e-01
  Total weights = 1.9518e+06
  Execution time = 1.8911e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315000457549
                                         uncertainty =       0.003100600702

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315000457549
                                         uncertainty =       0.003100600702

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396849799
  error estimate for blocks of size 2^( 2) =       0.000410695195
  error estimate for blocks of size 2^( 3) =       0.000424764490
  error estimate for blocks of size 2^( 4) =       0.000437569113
  error estimate for blocks of size 2^( 5) =       0.000448579703
  error estimate for blocks of size 2^( 6) =       0.000456287967
  error estimate for blocks of size 2^( 7) =       0.000462701897

      target function =                  N/A
              le_mean =     -16.904869524439
             les_mean =     286.101511581066
             stat err =       0.000451284670
             autocorr =       1.293149788833
              std dev =       0.561230367431
             le_variance =       0.314979525327

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315000457549
                                         uncertainty =       0.003100600702

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315000457549
                                         uncertainty =       0.003100600702

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396849799
  error estimate for blocks of size 2^( 2) =       0.000410695195
  error estimate for blocks of size 2^( 3) =       0.000424764490
  error estimate for blocks of size 2^( 4) =       0.000437569113
  error estimate for blocks of size 2^( 5) =       0.000448579703
  error estimate for blocks of size 2^( 6) =       0.000456287967
  error estimate for blocks of size 2^( 7) =       0.000462701897

      target function =                  N/A
              le_mean =     -16.904869524439
             les_mean =     286.101511581066
             stat err =       0.000451284670
             autocorr =       1.293149788833
              std dev =       0.561230367431
             le_variance =       0.314979525327

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315000457549
                                         uncertainty =       0.003100600702

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315000457549
                                         uncertainty =       0.003100600702

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396849799
  error estimate for blocks of size 2^( 2) =       0.000410695195
  error estimate for blocks of size 2^( 3) =       0.000424764490
  error estimate for blocks of size 2^( 4) =       0.000437569113
  error estimate for blocks of size 2^( 5) =       0.000448579703
  error estimate for blocks of size 2^( 6) =       0.000456287967
  error estimate for blocks of size 2^( 7) =       0.000462701897

      target function =                  N/A
              le_mean =     -16.904869524439
             les_mean =     286.101511581066
             stat err =       0.000451284670
             autocorr =       1.293149788833
              std dev =       0.561230367431
             le_variance =       0.314979525327

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315000457549
                                         uncertainty =       0.003100600702

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315000457549
                                         uncertainty =       0.003100600702

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396849799
  error estimate for blocks of size 2^( 2) =       0.000410695195
  error estimate for blocks of size 2^( 3) =       0.000424764490
  error estimate for blocks of size 2^( 4) =       0.000437569113
  error estimate for blocks of size 2^( 5) =       0.000448579703
  error estimate for blocks of size 2^( 6) =       0.000456287967
  error estimate for blocks of size 2^( 7) =       0.000462701897

      target function =                  N/A
              le_mean =     -16.904869524439
             les_mean =     286.101511581066
             stat err =       0.000451284670
             autocorr =       1.293149788833
              std dev =       0.561230367431
             le_variance =       0.314979525327


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904869524439        initial  <--
     9.3132e+58     9.3132e+59             5.9802e-63       -16.904869524439
     3.7253e+59     3.7253e+60             1.4951e-63       -16.904869524439
     1.4901e+60     1.4901e+61             3.7376e-64       -16.904869524439

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.5643
  </log>
  <optVariables href="H2O.s082.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0647e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s083 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s083 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=83  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 83
    time step          = 0.05
    reference energy   = -16.9673
    reference variance = 0.33362
====================================================
  Execution time = 1.4501e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s083
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5241e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.1906e-01
  Total weights = 1.951593295e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5957e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309848790791
                                         uncertainty =       0.001681976635

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309848790791
                                         uncertainty =       0.001681976635

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393625886
  error estimate for blocks of size 2^( 2) =       0.000407711449
  error estimate for blocks of size 2^( 3) =       0.000422041068
  error estimate for blocks of size 2^( 4) =       0.000434910518
  error estimate for blocks of size 2^( 5) =       0.000445772582
  error estimate for blocks of size 2^( 6) =       0.000452593887
  error estimate for blocks of size 2^( 7) =       0.000456100819

      target function =                  N/A
              le_mean =     -16.904074278568
             les_mean =     286.066786328454
             stat err =       0.000447344452
             autocorr =       1.291566607913
              std dev =       0.556671066407
             le_variance =       0.309882676175


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690407427857e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+59, overlap shift 9.3132e+60 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904074278570       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904074278570       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e+59 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+60, overlap shift 3.7253e+61 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904074278570       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904074278570       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+60 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4901e+61, overlap shift 1.4901e+62 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904074278570       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904074278570       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+61 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.267737 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7102e+01
  </log>
  <optVariables href="H2O.s083.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 83
    time step          = 0.05
    reference energy   = -16.9575
    reference variance = 0.433902
====================================================
  Execution time = 1.3838e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s083
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2261e-01
  Total weights = 1.9515e+06
  Execution time = 1.8784e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312353104208
                                         uncertainty =       0.002402057097

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312353104208
                                         uncertainty =       0.002402057097

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395242419
  error estimate for blocks of size 2^( 2) =       0.000409677201
  error estimate for blocks of size 2^( 3) =       0.000424790962
  error estimate for blocks of size 2^( 4) =       0.000439272521
  error estimate for blocks of size 2^( 5) =       0.000452868290
  error estimate for blocks of size 2^( 6) =       0.000464090476
  error estimate for blocks of size 2^( 7) =       0.000470625848

      target function =                  N/A
              le_mean =     -16.904151617079
             les_mean =     286.072951141191
             stat err =       0.000456714284
             autocorr =       1.335248478067
              std dev =       0.558957189173
             le_variance =       0.312433139329

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312353104208
                                         uncertainty =       0.002402057097

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312353104208
                                         uncertainty =       0.002402057097

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395242419
  error estimate for blocks of size 2^( 2) =       0.000409677201
  error estimate for blocks of size 2^( 3) =       0.000424790962
  error estimate for blocks of size 2^( 4) =       0.000439272521
  error estimate for blocks of size 2^( 5) =       0.000452868290
  error estimate for blocks of size 2^( 6) =       0.000464090476
  error estimate for blocks of size 2^( 7) =       0.000470625848

      target function =                  N/A
              le_mean =     -16.904151617079
             les_mean =     286.072951141191
             stat err =       0.000456714284
             autocorr =       1.335248478067
              std dev =       0.558957189173
             le_variance =       0.312433139329

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312353104208
                                         uncertainty =       0.002402057097

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312353104208
                                         uncertainty =       0.002402057097

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395242419
  error estimate for blocks of size 2^( 2) =       0.000409677201
  error estimate for blocks of size 2^( 3) =       0.000424790962
  error estimate for blocks of size 2^( 4) =       0.000439272521
  error estimate for blocks of size 2^( 5) =       0.000452868290
  error estimate for blocks of size 2^( 6) =       0.000464090476
  error estimate for blocks of size 2^( 7) =       0.000470625848

      target function =                  N/A
              le_mean =     -16.904151617079
             les_mean =     286.072951141191
             stat err =       0.000456714284
             autocorr =       1.335248478067
              std dev =       0.558957189173
             le_variance =       0.312433139329

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312353104208
                                         uncertainty =       0.002402057097

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312353104208
                                         uncertainty =       0.002402057097

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395242419
  error estimate for blocks of size 2^( 2) =       0.000409677201
  error estimate for blocks of size 2^( 3) =       0.000424790962
  error estimate for blocks of size 2^( 4) =       0.000439272521
  error estimate for blocks of size 2^( 5) =       0.000452868290
  error estimate for blocks of size 2^( 6) =       0.000464090476
  error estimate for blocks of size 2^( 7) =       0.000470625848

      target function =                  N/A
              le_mean =     -16.904151617079
             les_mean =     286.072951141191
             stat err =       0.000456714284
             autocorr =       1.335248478067
              std dev =       0.558957189173
             le_variance =       0.312433139329


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904151617079        initial  <--
     9.3132e+59     9.3132e+60             0.0000e+00       -16.904151617079
     3.7253e+60     3.7253e+61             0.0000e+00       -16.904151617079
     1.4901e+61     1.4901e+62             0.0000e+00       -16.904151617079

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.4276
  </log>
  <optVariables href="H2O.s083.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0535e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s084 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s084 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=84  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 84
    time step          = 0.05
    reference energy   = -16.9007
    reference variance = 0.390311
====================================================
  Execution time = 1.6591e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s084
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5235e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2416e-01
  Total weights = 1.951308552e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5938e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310576575398
                                         uncertainty =       0.002607932023

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310576575398
                                         uncertainty =       0.002607932023

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394056915
  error estimate for blocks of size 2^( 2) =       0.000407732660
  error estimate for blocks of size 2^( 3) =       0.000421998096
  error estimate for blocks of size 2^( 4) =       0.000434445539
  error estimate for blocks of size 2^( 5) =       0.000445041356
  error estimate for blocks of size 2^( 6) =       0.000453023973
  error estimate for blocks of size 2^( 7) =       0.000457235961

      target function =                  N/A
              le_mean =     -16.904394073593
             les_mean =     286.082697011519
             stat err =       0.000447436707
             autocorr =       1.289274268834
              std dev =       0.557280632875
             le_variance =       0.310561703777


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690439407359e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+60, overlap shift 9.3132e+61 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904394073603       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904394073603       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e+60 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+61, overlap shift 3.7253e+62 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904394073603       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904394073603       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+61 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4901e+62, overlap shift 1.4901e+63 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904394073603       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904394073603       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+62 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.268844 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.9190e+01
  </log>
  <optVariables href="H2O.s084.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 84
    time step          = 0.05
    reference energy   = -16.8724
    reference variance = 0.278458
====================================================
  Execution time = 1.4100e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s084
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2287e-01
  Total weights = 1.9515e+06
  Execution time = 1.8814e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309659479507
                                         uncertainty =       0.001846742064

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309659479507
                                         uncertainty =       0.001846742064

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393529411
  error estimate for blocks of size 2^( 2) =       0.000407444456
  error estimate for blocks of size 2^( 3) =       0.000422195961
  error estimate for blocks of size 2^( 4) =       0.000435709437
  error estimate for blocks of size 2^( 5) =       0.000448157011
  error estimate for blocks of size 2^( 6) =       0.000458649794
  error estimate for blocks of size 2^( 7) =       0.000463566480

      target function =                  N/A
              le_mean =     -16.903828150365
             les_mean =     286.062273496065
             stat err =       0.000451520680
             autocorr =       1.316439488987
              std dev =       0.556534630662
             le_variance =       0.309730795126

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309659479507
                                         uncertainty =       0.001846742064

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309659479507
                                         uncertainty =       0.001846742064

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393529411
  error estimate for blocks of size 2^( 2) =       0.000407444456
  error estimate for blocks of size 2^( 3) =       0.000422195961
  error estimate for blocks of size 2^( 4) =       0.000435709437
  error estimate for blocks of size 2^( 5) =       0.000448157011
  error estimate for blocks of size 2^( 6) =       0.000458649794
  error estimate for blocks of size 2^( 7) =       0.000463566480

      target function =                  N/A
              le_mean =     -16.903828150365
             les_mean =     286.062273496065
             stat err =       0.000451520680
             autocorr =       1.316439488987
              std dev =       0.556534630662
             le_variance =       0.309730795126

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309659479507
                                         uncertainty =       0.001846742064

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309659479507
                                         uncertainty =       0.001846742064

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393529411
  error estimate for blocks of size 2^( 2) =       0.000407444456
  error estimate for blocks of size 2^( 3) =       0.000422195961
  error estimate for blocks of size 2^( 4) =       0.000435709437
  error estimate for blocks of size 2^( 5) =       0.000448157011
  error estimate for blocks of size 2^( 6) =       0.000458649794
  error estimate for blocks of size 2^( 7) =       0.000463566480

      target function =                  N/A
              le_mean =     -16.903828150365
             les_mean =     286.062273496065
             stat err =       0.000451520680
             autocorr =       1.316439488987
              std dev =       0.556534630662
             le_variance =       0.309730795126

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309659479507
                                         uncertainty =       0.001846742064

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309659479507
                                         uncertainty =       0.001846742064

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393529411
  error estimate for blocks of size 2^( 2) =       0.000407444456
  error estimate for blocks of size 2^( 3) =       0.000422195961
  error estimate for blocks of size 2^( 4) =       0.000435709437
  error estimate for blocks of size 2^( 5) =       0.000448157011
  error estimate for blocks of size 2^( 6) =       0.000458649794
  error estimate for blocks of size 2^( 7) =       0.000463566480

      target function =                  N/A
              le_mean =     -16.903828150365
             les_mean =     286.062273496065
             stat err =       0.000451520680
             autocorr =       1.316439488987
              std dev =       0.556534630662
             le_variance =       0.309730795126


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.903828150365        initial  <--
     9.3132e+60     9.3132e+61             0.0000e+00       -16.903828150365
     3.7253e+61     3.7253e+62             0.0000e+00       -16.903828150365
     1.4901e+62     1.4901e+63             0.0000e+00       -16.903828150365

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.7145
  </log>
  <optVariables href="H2O.s084.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2910e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s085 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s085 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=85  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 85
    time step          = 0.05
    reference energy   = -16.9243
    reference variance = 0.393589
====================================================
  Execution time = 1.4461e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s085
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5257e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2286e-01
  Total weights = 1.951589520e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5730e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311544143532
                                         uncertainty =       0.001858266719

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311544143532
                                         uncertainty =       0.001858266719

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394696254
  error estimate for blocks of size 2^( 2) =       0.000409135841
  error estimate for blocks of size 2^( 3) =       0.000423328808
  error estimate for blocks of size 2^( 4) =       0.000436372285
  error estimate for blocks of size 2^( 5) =       0.000446675969
  error estimate for blocks of size 2^( 6) =       0.000454200496
  error estimate for blocks of size 2^( 7) =       0.000457182828

      target function =                  N/A
              le_mean =     -16.903955776536
             les_mean =     286.066576269544
             stat err =       0.000448607895
             autocorr =       1.291837281978
              std dev =       0.558184796026
             le_variance =       0.311570266515


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690395577654e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+61, overlap shift 9.3132e+62 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903955776543       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903955776543       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.903955776543       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e+61 is 6.131372e-66

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+62, overlap shift 3.7253e+63 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903955776543       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903955776543       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.903955776543       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+62 is 1.532843e-66

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4901e+63, overlap shift 1.4901e+64 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903955776543       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903955776543       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.903955776543       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+63 is 3.832107e-67

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.270208 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7039e+01
  </log>
  <optVariables href="H2O.s085.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 85
    time step          = 0.05
    reference energy   = -16.9332
    reference variance = 0.156092
====================================================
  Execution time = 1.3776e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s085
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2094e-01
  Total weights = 1.9516e+06
  Execution time = 1.8855e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309441227020
                                         uncertainty =       0.001829798104

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309441227020
                                         uncertainty =       0.001829798104

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393333233
  error estimate for blocks of size 2^( 2) =       0.000407412163
  error estimate for blocks of size 2^( 3) =       0.000420983780
  error estimate for blocks of size 2^( 4) =       0.000434082436
  error estimate for blocks of size 2^( 5) =       0.000444132736
  error estimate for blocks of size 2^( 6) =       0.000449954320
  error estimate for blocks of size 2^( 7) =       0.000453780258

      target function =                  N/A
              le_mean =     -16.904568623200
             les_mean =     286.085385212666
             stat err =       0.000445487437
             autocorr =       1.282772498111
              std dev =       0.556257192034
             le_variance =       0.309422063690

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309441227020
                                         uncertainty =       0.001829798104

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309441227020
                                         uncertainty =       0.001829798104

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393333233
  error estimate for blocks of size 2^( 2) =       0.000407412163
  error estimate for blocks of size 2^( 3) =       0.000420983780
  error estimate for blocks of size 2^( 4) =       0.000434082436
  error estimate for blocks of size 2^( 5) =       0.000444132736
  error estimate for blocks of size 2^( 6) =       0.000449954320
  error estimate for blocks of size 2^( 7) =       0.000453780258

      target function =                  N/A
              le_mean =     -16.904568623200
             les_mean =     286.085385212666
             stat err =       0.000445487437
             autocorr =       1.282772498111
              std dev =       0.556257192034
             le_variance =       0.309422063690

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309441227020
                                         uncertainty =       0.001829798104

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309441227020
                                         uncertainty =       0.001829798104

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393333233
  error estimate for blocks of size 2^( 2) =       0.000407412163
  error estimate for blocks of size 2^( 3) =       0.000420983780
  error estimate for blocks of size 2^( 4) =       0.000434082436
  error estimate for blocks of size 2^( 5) =       0.000444132736
  error estimate for blocks of size 2^( 6) =       0.000449954320
  error estimate for blocks of size 2^( 7) =       0.000453780258

      target function =                  N/A
              le_mean =     -16.904568623200
             les_mean =     286.085385212666
             stat err =       0.000445487437
             autocorr =       1.282772498111
              std dev =       0.556257192034
             le_variance =       0.309422063690

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309441227020
                                         uncertainty =       0.001829798104

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309441227020
                                         uncertainty =       0.001829798104

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393333233
  error estimate for blocks of size 2^( 2) =       0.000407412163
  error estimate for blocks of size 2^( 3) =       0.000420983780
  error estimate for blocks of size 2^( 4) =       0.000434082436
  error estimate for blocks of size 2^( 5) =       0.000444132736
  error estimate for blocks of size 2^( 6) =       0.000449954320
  error estimate for blocks of size 2^( 7) =       0.000453780258

      target function =                  N/A
              le_mean =     -16.904568623200
             les_mean =     286.085385212666
             stat err =       0.000445487437
             autocorr =       1.282772498111
              std dev =       0.556257192034
             le_variance =       0.309422063690


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904568623200        initial  <--
     9.3132e+61     9.3132e+62             6.1314e-66       -16.904568623200
     3.7253e+62     3.7253e+63             1.5328e-66       -16.904568623200
     1.4901e+63     1.4901e+64             3.8321e-67       -16.904568623200

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.4401
  </log>
  <optVariables href="H2O.s085.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0485e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s086 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s086 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=86  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 86
    time step          = 0.05
    reference energy   = -16.9418
    reference variance = 0.294069
====================================================
  Execution time = 1.4251e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s086
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5242e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2707e-01
  Total weights = 1.951610372e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5868e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313941503836
                                         uncertainty =       0.002174224024

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313941503836
                                         uncertainty =       0.002174224024

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396136206
  error estimate for blocks of size 2^( 2) =       0.000410148905
  error estimate for blocks of size 2^( 3) =       0.000424030508
  error estimate for blocks of size 2^( 4) =       0.000437694335
  error estimate for blocks of size 2^( 5) =       0.000448546073
  error estimate for blocks of size 2^( 6) =       0.000455177803
  error estimate for blocks of size 2^( 7) =       0.000458998718

      target function =                  N/A
              le_mean =     -16.905460202599
             les_mean =     286.121654638749
             stat err =       0.000450104232
             autocorr =       1.291032329231
              std dev =       0.560221194667
             le_variance =       0.313847786955


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690546020260e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+62, overlap shift 9.3132e+63 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905460202611       residual = 2.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905460202611       residual = 2.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e+62 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+63, overlap shift 3.7253e+64 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905460202611       residual = 2.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905460202611       residual = 2.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+63 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4901e+64, overlap shift 1.4901e+65 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905460202611       residual = 2.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905460202611       residual = 2.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+64 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.271303 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6843e+01
  </log>
  <optVariables href="H2O.s086.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 86
    time step          = 0.05
    reference energy   = -16.9284
    reference variance = 0.162325
====================================================
  Execution time = 1.3955e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s086
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2822e-01
  Total weights = 1.9515e+06
  Execution time = 1.8806e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315850078469
                                         uncertainty =       0.005828959212

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315850078469
                                         uncertainty =       0.005828959212

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397351804
  error estimate for blocks of size 2^( 2) =       0.000411452466
  error estimate for blocks of size 2^( 3) =       0.000425588572
  error estimate for blocks of size 2^( 4) =       0.000438776839
  error estimate for blocks of size 2^( 5) =       0.000450657820
  error estimate for blocks of size 2^( 6) =       0.000457199747
  error estimate for blocks of size 2^( 7) =       0.000463738364

      target function =                  N/A
              le_mean =     -16.903566220106
             les_mean =     286.058770667412
             stat err =       0.000452593192
             autocorr =       1.297375395734
              std dev =       0.561940309588
             le_variance =       0.315776911539

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315850078469
                                         uncertainty =       0.005828959212

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315850078469
                                         uncertainty =       0.005828959212

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397351804
  error estimate for blocks of size 2^( 2) =       0.000411452466
  error estimate for blocks of size 2^( 3) =       0.000425588572
  error estimate for blocks of size 2^( 4) =       0.000438776839
  error estimate for blocks of size 2^( 5) =       0.000450657820
  error estimate for blocks of size 2^( 6) =       0.000457199747
  error estimate for blocks of size 2^( 7) =       0.000463738364

      target function =                  N/A
              le_mean =     -16.903566220106
             les_mean =     286.058770667412
             stat err =       0.000452593192
             autocorr =       1.297375395734
              std dev =       0.561940309588
             le_variance =       0.315776911539

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315850078469
                                         uncertainty =       0.005828959212

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315850078469
                                         uncertainty =       0.005828959212

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397351804
  error estimate for blocks of size 2^( 2) =       0.000411452466
  error estimate for blocks of size 2^( 3) =       0.000425588572
  error estimate for blocks of size 2^( 4) =       0.000438776839
  error estimate for blocks of size 2^( 5) =       0.000450657820
  error estimate for blocks of size 2^( 6) =       0.000457199747
  error estimate for blocks of size 2^( 7) =       0.000463738364

      target function =                  N/A
              le_mean =     -16.903566220106
             les_mean =     286.058770667412
             stat err =       0.000452593192
             autocorr =       1.297375395734
              std dev =       0.561940309588
             le_variance =       0.315776911539

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315850078469
                                         uncertainty =       0.005828959212

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315850078469
                                         uncertainty =       0.005828959212

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397351804
  error estimate for blocks of size 2^( 2) =       0.000411452466
  error estimate for blocks of size 2^( 3) =       0.000425588572
  error estimate for blocks of size 2^( 4) =       0.000438776839
  error estimate for blocks of size 2^( 5) =       0.000450657820
  error estimate for blocks of size 2^( 6) =       0.000457199747
  error estimate for blocks of size 2^( 7) =       0.000463738364

      target function =                  N/A
              le_mean =     -16.903566220106
             les_mean =     286.058770667412
             stat err =       0.000452593192
             autocorr =       1.297375395734
              std dev =       0.561940309588
             le_variance =       0.315776911539


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.903566220106        initial  <--
     9.3132e+62     9.3132e+63             0.0000e+00       -16.903566220106
     3.7253e+63     3.7253e+64             0.0000e+00       -16.903566220106
     1.4901e+64     1.4901e+65             0.0000e+00       -16.903566220106

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.4811
  </log>
  <optVariables href="H2O.s086.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0329e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s087 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s087 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=87  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 87
    time step          = 0.05
    reference energy   = -16.9706
    reference variance = 0.551627
====================================================
  Execution time = 1.4368e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s087
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5244e+04
  VMC Eavg = -1.6903e+01
  VMC Evar = 3.2132e-01
  Total weights = 1.951760708e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5826e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310322883506
                                         uncertainty =       0.002087722053

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310322883506
                                         uncertainty =       0.002087722053

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393878425
  error estimate for blocks of size 2^( 2) =       0.000407568770
  error estimate for blocks of size 2^( 3) =       0.000421798548
  error estimate for blocks of size 2^( 4) =       0.000434802120
  error estimate for blocks of size 2^( 5) =       0.000445207573
  error estimate for blocks of size 2^( 6) =       0.000451031447
  error estimate for blocks of size 2^( 7) =       0.000456367770

      target function =                  N/A
              le_mean =     -16.903410921169
             les_mean =     286.046616208236
             stat err =       0.000446852228
             autocorr =       1.287073857505
              std dev =       0.557028210752
             le_variance =       0.310280427574


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690341092117e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+63, overlap shift 9.3132e+64 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903410921180       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903410921180       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e+63 is 7.644892e-68

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+64, overlap shift 3.7253e+65 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903410921180       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903410921180       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+64 is 1.911223e-68

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4901e+65, overlap shift 1.4901e+66 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903410921180       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903410921180       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+65 is 4.778057e-69

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.272390 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6956e+01
  </log>
  <optVariables href="H2O.s087.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 87
    time step          = 0.05
    reference energy   = -16.8263
    reference variance = 1.07482
====================================================
  Execution time = 1.3894e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s087
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2249e-01
  Total weights = 1.9518e+06
  Execution time = 1.8849e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309090922532
                                         uncertainty =       0.001788167654

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309090922532
                                         uncertainty =       0.001788167654

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393144224
  error estimate for blocks of size 2^( 2) =       0.000407143304
  error estimate for blocks of size 2^( 3) =       0.000421067006
  error estimate for blocks of size 2^( 4) =       0.000433752868
  error estimate for blocks of size 2^( 5) =       0.000443530829
  error estimate for blocks of size 2^( 6) =       0.000450561350
  error estimate for blocks of size 2^( 7) =       0.000455684313

      target function =                  N/A
              le_mean =     -16.904632385530
             les_mean =     286.089089071375
             stat err =       0.000445882340
             autocorr =       1.286283634269
              std dev =       0.555989893492
             le_variance =       0.309124761665

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309090922532
                                         uncertainty =       0.001788167654

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309090922532
                                         uncertainty =       0.001788167654

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393144224
  error estimate for blocks of size 2^( 2) =       0.000407143304
  error estimate for blocks of size 2^( 3) =       0.000421067006
  error estimate for blocks of size 2^( 4) =       0.000433752868
  error estimate for blocks of size 2^( 5) =       0.000443530829
  error estimate for blocks of size 2^( 6) =       0.000450561350
  error estimate for blocks of size 2^( 7) =       0.000455684313

      target function =                  N/A
              le_mean =     -16.904632385530
             les_mean =     286.089089071375
             stat err =       0.000445882340
             autocorr =       1.286283634269
              std dev =       0.555989893492
             le_variance =       0.309124761665

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309090922532
                                         uncertainty =       0.001788167654

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309090922532
                                         uncertainty =       0.001788167654

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393144224
  error estimate for blocks of size 2^( 2) =       0.000407143304
  error estimate for blocks of size 2^( 3) =       0.000421067006
  error estimate for blocks of size 2^( 4) =       0.000433752868
  error estimate for blocks of size 2^( 5) =       0.000443530829
  error estimate for blocks of size 2^( 6) =       0.000450561350
  error estimate for blocks of size 2^( 7) =       0.000455684313

      target function =                  N/A
              le_mean =     -16.904632385530
             les_mean =     286.089089071375
             stat err =       0.000445882340
             autocorr =       1.286283634269
              std dev =       0.555989893492
             le_variance =       0.309124761665

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309090922532
                                         uncertainty =       0.001788167654

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309090922532
                                         uncertainty =       0.001788167654

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393144224
  error estimate for blocks of size 2^( 2) =       0.000407143304
  error estimate for blocks of size 2^( 3) =       0.000421067006
  error estimate for blocks of size 2^( 4) =       0.000433752868
  error estimate for blocks of size 2^( 5) =       0.000443530829
  error estimate for blocks of size 2^( 6) =       0.000450561350
  error estimate for blocks of size 2^( 7) =       0.000455684313

      target function =                  N/A
              le_mean =     -16.904632385530
             les_mean =     286.089089071375
             stat err =       0.000445882340
             autocorr =       1.286283634269
              std dev =       0.555989893492
             le_variance =       0.309124761665


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904632385530        initial  <--
     9.3132e+63     9.3132e+64             7.6449e-68       -16.904632385530
     3.7253e+64     3.7253e+65             1.9112e-68       -16.904632385530
     1.4901e+65     1.4901e+66             4.7781e-69       -16.904632385530

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.4365
  </log>
  <optVariables href="H2O.s087.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0398e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s088 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s088 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=88  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 88
    time step          = 0.05
    reference energy   = -17.0124
    reference variance = 0.66
====================================================
  Execution time = 1.4316e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s088
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5251e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2438e-01
  Total weights = 1.951420871e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5929e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310900170361
                                         uncertainty =       0.002179379018

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310900170361
                                         uncertainty =       0.002179379018

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394278917
  error estimate for blocks of size 2^( 2) =       0.000407889676
  error estimate for blocks of size 2^( 3) =       0.000421661293
  error estimate for blocks of size 2^( 4) =       0.000434814910
  error estimate for blocks of size 2^( 5) =       0.000445273085
  error estimate for blocks of size 2^( 6) =       0.000452064668
  error estimate for blocks of size 2^( 7) =       0.000458006821

      target function =                  N/A
              le_mean =     -16.903861699736
             les_mean =     286.064922805752
             stat err =       0.000447539871
             autocorr =       1.288416726062
              std dev =       0.557594592201
             le_variance =       0.310911729252


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690386169974e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+64, overlap shift 9.3132e+65 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903861699735       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903861699735       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e+64 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+65, overlap shift 3.7253e+66 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903861699735       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903861699735       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+65 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4901e+66, overlap shift 1.4901e+67 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903861699735       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903861699735       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+66 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.273440 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6915e+01
  </log>
  <optVariables href="H2O.s088.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 88
    time step          = 0.05
    reference energy   = -16.9349
    reference variance = 0.249597
====================================================
  Execution time = 1.3873e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s088
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.1753e-01
  Total weights = 1.9514e+06
  Execution time = 1.9057e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307522389250
                                         uncertainty =       0.001649190948

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307522389250
                                         uncertainty =       0.001649190948

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392081371
  error estimate for blocks of size 2^( 2) =       0.000406100142
  error estimate for blocks of size 2^( 3) =       0.000420378701
  error estimate for blocks of size 2^( 4) =       0.000433844833
  error estimate for blocks of size 2^( 5) =       0.000446022608
  error estimate for blocks of size 2^( 6) =       0.000452469605
  error estimate for blocks of size 2^( 7) =       0.000457110714

      target function =                  N/A
              le_mean =     -16.904074036152
             les_mean =     286.065246557966
             stat err =       0.000447361940
             autocorr =       1.301864097471
              std dev =       0.554486792449
             le_variance =       0.307455603001

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307522389250
                                         uncertainty =       0.001649190948

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307522389250
                                         uncertainty =       0.001649190948

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392081371
  error estimate for blocks of size 2^( 2) =       0.000406100142
  error estimate for blocks of size 2^( 3) =       0.000420378701
  error estimate for blocks of size 2^( 4) =       0.000433844833
  error estimate for blocks of size 2^( 5) =       0.000446022608
  error estimate for blocks of size 2^( 6) =       0.000452469605
  error estimate for blocks of size 2^( 7) =       0.000457110714

      target function =                  N/A
              le_mean =     -16.904074036152
             les_mean =     286.065246557966
             stat err =       0.000447361940
             autocorr =       1.301864097471
              std dev =       0.554486792449
             le_variance =       0.307455603001

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307522389250
                                         uncertainty =       0.001649190948

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307522389250
                                         uncertainty =       0.001649190948

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392081371
  error estimate for blocks of size 2^( 2) =       0.000406100142
  error estimate for blocks of size 2^( 3) =       0.000420378701
  error estimate for blocks of size 2^( 4) =       0.000433844833
  error estimate for blocks of size 2^( 5) =       0.000446022608
  error estimate for blocks of size 2^( 6) =       0.000452469605
  error estimate for blocks of size 2^( 7) =       0.000457110714

      target function =                  N/A
              le_mean =     -16.904074036152
             les_mean =     286.065246557966
             stat err =       0.000447361940
             autocorr =       1.301864097471
              std dev =       0.554486792449
             le_variance =       0.307455603001

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307522389250
                                         uncertainty =       0.001649190948

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307522389250
                                         uncertainty =       0.001649190948

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392081371
  error estimate for blocks of size 2^( 2) =       0.000406100142
  error estimate for blocks of size 2^( 3) =       0.000420378701
  error estimate for blocks of size 2^( 4) =       0.000433844833
  error estimate for blocks of size 2^( 5) =       0.000446022608
  error estimate for blocks of size 2^( 6) =       0.000452469605
  error estimate for blocks of size 2^( 7) =       0.000457110714

      target function =                  N/A
              le_mean =     -16.904074036152
             les_mean =     286.065246557966
             stat err =       0.000447361940
             autocorr =       1.301864097471
              std dev =       0.554486792449
             le_variance =       0.307455603001


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904074036152        initial  <--
     9.3132e+64     9.3132e+65             0.0000e+00       -16.904074036152
     3.7253e+65     3.7253e+66             0.0000e+00       -16.904074036152
     1.4901e+66     1.4901e+67             0.0000e+00       -16.904074036152

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.4601
  </log>
  <optVariables href="H2O.s088.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0380e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s089 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s089 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=89  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 89
    time step          = 0.05
    reference energy   = -16.8665
    reference variance = 0.212039
====================================================
  Execution time = 1.4196e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s089
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5239e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2273e-01
  Total weights = 1.951766684e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5853e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311945970617
                                         uncertainty =       0.003128095346

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311945970617
                                         uncertainty =       0.003128095346

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394927783
  error estimate for blocks of size 2^( 2) =       0.000409097243
  error estimate for blocks of size 2^( 3) =       0.000423044573
  error estimate for blocks of size 2^( 4) =       0.000435908821
  error estimate for blocks of size 2^( 5) =       0.000446367314
  error estimate for blocks of size 2^( 6) =       0.000453748862
  error estimate for blocks of size 2^( 7) =       0.000458450465

      target function =                  N/A
              le_mean =     -16.904406804107
             les_mean =     286.081700954864
             stat err =       0.000448618866
             autocorr =       1.290386147383
              std dev =       0.558512226294
             le_variance =       0.311935906920


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690440680411e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+65, overlap shift 9.3132e+66 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904406804140       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904406804140       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e+65 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+66, overlap shift 3.7253e+67 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904406804140       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904406804140       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+66 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4901e+67, overlap shift 1.4901e+68 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904406804140       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904406804140       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+67 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.274518 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6786e+01
  </log>
  <optVariables href="H2O.s089.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 89
    time step          = 0.05
    reference energy   = -16.8919
    reference variance = 0.175349
====================================================
  Execution time = 1.4102e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s089
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2720e-01
  Total weights = 1.9518e+06
  Execution time = 1.8940e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311709429218
                                         uncertainty =       0.002492781261

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311709429218
                                         uncertainty =       0.002492781261

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394756260
  error estimate for blocks of size 2^( 2) =       0.000408650570
  error estimate for blocks of size 2^( 3) =       0.000422630826
  error estimate for blocks of size 2^( 4) =       0.000435472989
  error estimate for blocks of size 2^( 5) =       0.000446651845
  error estimate for blocks of size 2^( 6) =       0.000453280285
  error estimate for blocks of size 2^( 7) =       0.000457567569

      target function =                  N/A
              le_mean =     -16.904711224319
             les_mean =     286.096461229978
             stat err =       0.000448243172
             autocorr =       1.289345513430
              std dev =       0.558269657281
             le_variance =       0.311665010241

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311709429218
                                         uncertainty =       0.002492781261

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311709429218
                                         uncertainty =       0.002492781261

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394756260
  error estimate for blocks of size 2^( 2) =       0.000408650570
  error estimate for blocks of size 2^( 3) =       0.000422630826
  error estimate for blocks of size 2^( 4) =       0.000435472989
  error estimate for blocks of size 2^( 5) =       0.000446651845
  error estimate for blocks of size 2^( 6) =       0.000453280285
  error estimate for blocks of size 2^( 7) =       0.000457567569

      target function =                  N/A
              le_mean =     -16.904711224319
             les_mean =     286.096461229978
             stat err =       0.000448243172
             autocorr =       1.289345513430
              std dev =       0.558269657281
             le_variance =       0.311665010241

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311709429218
                                         uncertainty =       0.002492781261

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311709429218
                                         uncertainty =       0.002492781261

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394756260
  error estimate for blocks of size 2^( 2) =       0.000408650570
  error estimate for blocks of size 2^( 3) =       0.000422630826
  error estimate for blocks of size 2^( 4) =       0.000435472989
  error estimate for blocks of size 2^( 5) =       0.000446651845
  error estimate for blocks of size 2^( 6) =       0.000453280285
  error estimate for blocks of size 2^( 7) =       0.000457567569

      target function =                  N/A
              le_mean =     -16.904711224319
             les_mean =     286.096461229978
             stat err =       0.000448243172
             autocorr =       1.289345513430
              std dev =       0.558269657281
             le_variance =       0.311665010241

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311709429218
                                         uncertainty =       0.002492781261

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311709429218
                                         uncertainty =       0.002492781261

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394756260
  error estimate for blocks of size 2^( 2) =       0.000408650570
  error estimate for blocks of size 2^( 3) =       0.000422630826
  error estimate for blocks of size 2^( 4) =       0.000435472989
  error estimate for blocks of size 2^( 5) =       0.000446651845
  error estimate for blocks of size 2^( 6) =       0.000453280285
  error estimate for blocks of size 2^( 7) =       0.000457567569

      target function =                  N/A
              le_mean =     -16.904711224319
             les_mean =     286.096461229978
             stat err =       0.000448243172
             autocorr =       1.289345513430
              std dev =       0.558269657281
             le_variance =       0.311665010241


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904711224319        initial  <--
     9.3132e+65     9.3132e+66             0.0000e+00       -16.904711224319
     3.7253e+66     3.7253e+67             0.0000e+00       -16.904711224319
     1.4901e+67     1.4901e+68             0.0000e+00       -16.904711224319

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.6999
  </log>
  <optVariables href="H2O.s089.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0491e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s090 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s090 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=90  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 90
    time step          = 0.05
    reference energy   = -16.9359
    reference variance = 0.188461
====================================================
  Execution time = 1.4412e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s090
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5260e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2504e-01
  Total weights = 1.952411781e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5907e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313163675156
                                         uncertainty =       0.002316698284

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313163675156
                                         uncertainty =       0.002316698284

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395726504
  error estimate for blocks of size 2^( 2) =       0.000410026504
  error estimate for blocks of size 2^( 3) =       0.000424689399
  error estimate for blocks of size 2^( 4) =       0.000438666364
  error estimate for blocks of size 2^( 5) =       0.000450248611
  error estimate for blocks of size 2^( 6) =       0.000460257476
  error estimate for blocks of size 2^( 7) =       0.000462292816

      target function =                  N/A
              le_mean =     -16.903891689281
             les_mean =     286.066593594759
             stat err =       0.000452866317
             autocorr =       1.309633461826
              std dev =       0.559641789203
             le_variance =       0.313198932223


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690389168928e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+66, overlap shift 9.3132e+67 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903891689290       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903891689290       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e+66 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+67, overlap shift 3.7253e+68 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903891689290       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903891689290       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+67 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4901e+68, overlap shift 1.4901e+69 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903891689290       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903891689290       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+68 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.275593 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7008e+01
  </log>
  <optVariables href="H2O.s090.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 90
    time step          = 0.05
    reference energy   = -16.897
    reference variance = 0.148259
====================================================
  Execution time = 1.3999e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s090
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2334e-01
  Total weights = 1.9515e+06
  Execution time = 1.8974e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313223286382
                                         uncertainty =       0.002331713470

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313223286382
                                         uncertainty =       0.002331713470

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395711532
  error estimate for blocks of size 2^( 2) =       0.000409403144
  error estimate for blocks of size 2^( 3) =       0.000423908807
  error estimate for blocks of size 2^( 4) =       0.000436454178
  error estimate for blocks of size 2^( 5) =       0.000447380281
  error estimate for blocks of size 2^( 6) =       0.000455301827
  error estimate for blocks of size 2^( 7) =       0.000459541005

      target function =                  N/A
              le_mean =     -16.904143613574
             les_mean =     286.073412255294
             stat err =       0.000449669323
             autocorr =       1.291305815121
              std dev =       0.559620615361
             le_variance =       0.313175233137

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313223286382
                                         uncertainty =       0.002331713470

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313223286382
                                         uncertainty =       0.002331713470

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395711532
  error estimate for blocks of size 2^( 2) =       0.000409403144
  error estimate for blocks of size 2^( 3) =       0.000423908807
  error estimate for blocks of size 2^( 4) =       0.000436454178
  error estimate for blocks of size 2^( 5) =       0.000447380281
  error estimate for blocks of size 2^( 6) =       0.000455301827
  error estimate for blocks of size 2^( 7) =       0.000459541005

      target function =                  N/A
              le_mean =     -16.904143613574
             les_mean =     286.073412255294
             stat err =       0.000449669323
             autocorr =       1.291305815121
              std dev =       0.559620615361
             le_variance =       0.313175233137

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313223286382
                                         uncertainty =       0.002331713470

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313223286382
                                         uncertainty =       0.002331713470

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395711532
  error estimate for blocks of size 2^( 2) =       0.000409403144
  error estimate for blocks of size 2^( 3) =       0.000423908807
  error estimate for blocks of size 2^( 4) =       0.000436454178
  error estimate for blocks of size 2^( 5) =       0.000447380281
  error estimate for blocks of size 2^( 6) =       0.000455301827
  error estimate for blocks of size 2^( 7) =       0.000459541005

      target function =                  N/A
              le_mean =     -16.904143613574
             les_mean =     286.073412255294
             stat err =       0.000449669323
             autocorr =       1.291305815121
              std dev =       0.559620615361
             le_variance =       0.313175233137

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313223286382
                                         uncertainty =       0.002331713470

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313223286382
                                         uncertainty =       0.002331713470

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395711532
  error estimate for blocks of size 2^( 2) =       0.000409403144
  error estimate for blocks of size 2^( 3) =       0.000423908807
  error estimate for blocks of size 2^( 4) =       0.000436454178
  error estimate for blocks of size 2^( 5) =       0.000447380281
  error estimate for blocks of size 2^( 6) =       0.000455301827
  error estimate for blocks of size 2^( 7) =       0.000459541005

      target function =                  N/A
              le_mean =     -16.904143613574
             les_mean =     286.073412255294
             stat err =       0.000449669323
             autocorr =       1.291305815121
              std dev =       0.559620615361
             le_variance =       0.313175233137


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904143613574        initial  <--
     9.3132e+66     9.3132e+67             0.0000e+00       -16.904143613574
     3.7253e+67     3.7253e+68             0.0000e+00       -16.904143613574
     1.4901e+68     1.4901e+69             0.0000e+00       -16.904143613574

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.5978
  </log>
  <optVariables href="H2O.s090.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0611e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s091 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s091 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=91  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 91
    time step          = 0.05
    reference energy   = -16.9154
    reference variance = 0.26059
====================================================
  Execution time = 1.4341e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s091
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5256e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2309e-01
  Total weights = 1.951719105e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5918e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311853335163
                                         uncertainty =       0.002300735739

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311853335163
                                         uncertainty =       0.002300735739

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394925226
  error estimate for blocks of size 2^( 2) =       0.000408923587
  error estimate for blocks of size 2^( 3) =       0.000423864575
  error estimate for blocks of size 2^( 4) =       0.000437681292
  error estimate for blocks of size 2^( 5) =       0.000448997308
  error estimate for blocks of size 2^( 6) =       0.000458089510
  error estimate for blocks of size 2^( 7) =       0.000465553986

      target function =                  N/A
              le_mean =     -16.903784567787
             les_mean =     286.061024309351
             stat err =       0.000452580524
             autocorr =       1.313294030898
              std dev =       0.558508611159
             le_variance =       0.311931868739


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690378456779e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+67, overlap shift 9.3132e+68 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903784567790       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903784567790       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.903784567790       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.903784567790       residual = 1.52e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e+67 is 5.747347e-72

solving harmonic davidson linear method for identity shift 3.7253e+68, overlap shift 3.7253e+69 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903784567790       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903784567790       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.903784567790       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.903784567790       residual = 1.52e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+68 is 1.436837e-72

solving harmonic davidson linear method for identity shift 1.4901e+69, overlap shift 1.4901e+70 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.903784567790       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.903784567790       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.903784567790       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.903784567790       residual = 1.52e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+69 is 3.592092e-73

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.276920 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6938e+01
  </log>
  <optVariables href="H2O.s091.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 91
    time step          = 0.05
    reference energy   = -16.9309
    reference variance = 0.27526
====================================================
  Execution time = 1.6084e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s091
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2318e-01
  Total weights = 1.9516e+06
  Execution time = 1.8952e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306696783304
                                         uncertainty =       0.001770651097

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306696783304
                                         uncertainty =       0.001770651097

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391576079
  error estimate for blocks of size 2^( 2) =       0.000405618835
  error estimate for blocks of size 2^( 3) =       0.000419851904
  error estimate for blocks of size 2^( 4) =       0.000432363746
  error estimate for blocks of size 2^( 5) =       0.000441592241
  error estimate for blocks of size 2^( 6) =       0.000447694909
  error estimate for blocks of size 2^( 7) =       0.000453566953

      target function =                  N/A
              le_mean =     -16.904724419615
             les_mean =     286.092891634173
             stat err =       0.000443804462
             autocorr =       1.284550028031
              std dev =       0.553772201333
             le_variance =       0.306663650969

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306696783304
                                         uncertainty =       0.001770651097

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306696783304
                                         uncertainty =       0.001770651097

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391576079
  error estimate for blocks of size 2^( 2) =       0.000405618835
  error estimate for blocks of size 2^( 3) =       0.000419851904
  error estimate for blocks of size 2^( 4) =       0.000432363746
  error estimate for blocks of size 2^( 5) =       0.000441592241
  error estimate for blocks of size 2^( 6) =       0.000447694909
  error estimate for blocks of size 2^( 7) =       0.000453566953

      target function =                  N/A
              le_mean =     -16.904724419615
             les_mean =     286.092891634173
             stat err =       0.000443804462
             autocorr =       1.284550028031
              std dev =       0.553772201333
             le_variance =       0.306663650969

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306696783304
                                         uncertainty =       0.001770651097

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306696783304
                                         uncertainty =       0.001770651097

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391576079
  error estimate for blocks of size 2^( 2) =       0.000405618835
  error estimate for blocks of size 2^( 3) =       0.000419851904
  error estimate for blocks of size 2^( 4) =       0.000432363746
  error estimate for blocks of size 2^( 5) =       0.000441592241
  error estimate for blocks of size 2^( 6) =       0.000447694909
  error estimate for blocks of size 2^( 7) =       0.000453566953

      target function =                  N/A
              le_mean =     -16.904724419615
             les_mean =     286.092891634173
             stat err =       0.000443804462
             autocorr =       1.284550028031
              std dev =       0.553772201333
             le_variance =       0.306663650969

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306696783304
                                         uncertainty =       0.001770651097

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306696783304
                                         uncertainty =       0.001770651097

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391576079
  error estimate for blocks of size 2^( 2) =       0.000405618835
  error estimate for blocks of size 2^( 3) =       0.000419851904
  error estimate for blocks of size 2^( 4) =       0.000432363746
  error estimate for blocks of size 2^( 5) =       0.000441592241
  error estimate for blocks of size 2^( 6) =       0.000447694909
  error estimate for blocks of size 2^( 7) =       0.000453566953

      target function =                  N/A
              le_mean =     -16.904724419615
             les_mean =     286.092891634173
             stat err =       0.000443804462
             autocorr =       1.284550028031
              std dev =       0.553772201333
             le_variance =       0.306663650969


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904724419615        initial  <--
     9.3132e+67     9.3132e+68             5.7473e-72       -16.904724419615
     3.7253e+68     3.7253e+69             1.4368e-72       -16.904724419615
     1.4901e+69     1.4901e+70             3.5921e-73       -16.904724419615

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 25.6998
  </log>
  <optVariables href="H2O.s091.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2647e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s092 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s092 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=92  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 92
    time step          = 0.05
    reference energy   = -16.9455
    reference variance = 0.181733
====================================================
  Execution time = 1.4536e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s092
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5259e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2027e-01
  Total weights = 1.951745508e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6001e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310474063177
                                         uncertainty =       0.002137127665

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310474063177
                                         uncertainty =       0.002137127665

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394007727
  error estimate for blocks of size 2^( 2) =       0.000408070412
  error estimate for blocks of size 2^( 3) =       0.000422424069
  error estimate for blocks of size 2^( 4) =       0.000435480386
  error estimate for blocks of size 2^( 5) =       0.000446576473
  error estimate for blocks of size 2^( 6) =       0.000453247399
  error estimate for blocks of size 2^( 7) =       0.000458315283

      target function =                  N/A
              le_mean =     -16.904614442977
             les_mean =     286.086258443988
             stat err =       0.000448404885
             autocorr =       1.295183173186
              std dev =       0.557211070860
             le_variance =       0.310484177489


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690461444298e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+68, overlap shift 9.3132e+69 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904614442959       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904614442959       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904614442959       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e+68 is 5.605156e-73

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+69, overlap shift 3.7253e+70 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904614442959       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904614442959       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904614442959       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+69 is 1.401289e-73

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4901e+70, overlap shift 1.4901e+71 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904614442959       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904614442959       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904614442959       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904614442959       residual = 2.02e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+70 is 3.520751e-74

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.278272 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7141e+01
  </log>
  <optVariables href="H2O.s092.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 92
    time step          = 0.05
    reference energy   = -16.8616
    reference variance = 0.222733
====================================================
  Execution time = 1.3865e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s092
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2077e-01
  Total weights = 1.9518e+06
  Execution time = 1.8822e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307942901460
                                         uncertainty =       0.001887948115

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307942901460
                                         uncertainty =       0.001887948115

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392379959
  error estimate for blocks of size 2^( 2) =       0.000406095320
  error estimate for blocks of size 2^( 3) =       0.000419671517
  error estimate for blocks of size 2^( 4) =       0.000432735276
  error estimate for blocks of size 2^( 5) =       0.000442677544
  error estimate for blocks of size 2^( 6) =       0.000450715394
  error estimate for blocks of size 2^( 7) =       0.000455726596

      target function =                  N/A
              le_mean =     -16.904037091654
             les_mean =     286.067240149012
             stat err =       0.000445463702
             autocorr =       1.288875619939
              std dev =       0.554909060130
             le_variance =       0.307924065014

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307942901460
                                         uncertainty =       0.001887948115

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307942901460
                                         uncertainty =       0.001887948115

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392379959
  error estimate for blocks of size 2^( 2) =       0.000406095320
  error estimate for blocks of size 2^( 3) =       0.000419671517
  error estimate for blocks of size 2^( 4) =       0.000432735276
  error estimate for blocks of size 2^( 5) =       0.000442677544
  error estimate for blocks of size 2^( 6) =       0.000450715394
  error estimate for blocks of size 2^( 7) =       0.000455726596

      target function =                  N/A
              le_mean =     -16.904037091654
             les_mean =     286.067240149012
             stat err =       0.000445463702
             autocorr =       1.288875619939
              std dev =       0.554909060130
             le_variance =       0.307924065014

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307942901460
                                         uncertainty =       0.001887948115

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307942901460
                                         uncertainty =       0.001887948115

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392379959
  error estimate for blocks of size 2^( 2) =       0.000406095320
  error estimate for blocks of size 2^( 3) =       0.000419671517
  error estimate for blocks of size 2^( 4) =       0.000432735276
  error estimate for blocks of size 2^( 5) =       0.000442677544
  error estimate for blocks of size 2^( 6) =       0.000450715394
  error estimate for blocks of size 2^( 7) =       0.000455726596

      target function =                  N/A
              le_mean =     -16.904037091654
             les_mean =     286.067240149012
             stat err =       0.000445463702
             autocorr =       1.288875619939
              std dev =       0.554909060130
             le_variance =       0.307924065014

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307942901460
                                         uncertainty =       0.001887948115

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307942901460
                                         uncertainty =       0.001887948115

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392379959
  error estimate for blocks of size 2^( 2) =       0.000406095320
  error estimate for blocks of size 2^( 3) =       0.000419671517
  error estimate for blocks of size 2^( 4) =       0.000432735276
  error estimate for blocks of size 2^( 5) =       0.000442677544
  error estimate for blocks of size 2^( 6) =       0.000450715394
  error estimate for blocks of size 2^( 7) =       0.000455726596

      target function =                  N/A
              le_mean =     -16.904037091654
             les_mean =     286.067240149012
             stat err =       0.000445463702
             autocorr =       1.288875619939
              std dev =       0.554909060130
             le_variance =       0.307924065014


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904037091654        initial  <--
     9.3132e+68     9.3132e+69             5.6052e-73       -16.904037091654
     3.7253e+69     3.7253e+70             1.4013e-73       -16.904037091654
     1.4901e+70     1.4901e+71             3.5208e-74       -16.904037091654

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.3935
  </log>
  <optVariables href="H2O.s092.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0540e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s093 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s093 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=93  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 93
    time step          = 0.05
    reference energy   = -16.9205
    reference variance = 0.183868
====================================================
  Execution time = 1.4388e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s093
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5292e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2211e-01
  Total weights = 1.952207010e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5758e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310285836552
                                         uncertainty =       0.002189178462

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310285836552
                                         uncertainty =       0.002189178462

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393889560
  error estimate for blocks of size 2^( 2) =       0.000407825017
  error estimate for blocks of size 2^( 3) =       0.000421699165
  error estimate for blocks of size 2^( 4) =       0.000434376482
  error estimate for blocks of size 2^( 5) =       0.000444295934
  error estimate for blocks of size 2^( 6) =       0.000451225386
  error estimate for blocks of size 2^( 7) =       0.000458037678

      target function =                  N/A
              le_mean =     -16.904914295467
             les_mean =     286.098232889814
             stat err =       0.000446983870
             autocorr =       1.287759502302
              std dev =       0.557043957389
             le_variance =       0.310297970463


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690491429547e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+69, overlap shift 9.3132e+70 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904914295525       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904914295525       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e+69 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+70, overlap shift 3.7253e+71 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904914295525       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904914295525       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+70 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4901e+71, overlap shift 1.4901e+72 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904914295525       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904914295525       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+71 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.279381 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6969e+01
  </log>
  <optVariables href="H2O.s093.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 93
    time step          = 0.05
    reference energy   = -16.9076
    reference variance = 0.451311
====================================================
  Execution time = 1.3882e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s093
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2124e-01
  Total weights = 1.9521e+06
  Execution time = 1.8823e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310163332880
                                         uncertainty =       0.001831203517

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310163332880
                                         uncertainty =       0.001831203517

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393841951
  error estimate for blocks of size 2^( 2) =       0.000407888641
  error estimate for blocks of size 2^( 3) =       0.000422141711
  error estimate for blocks of size 2^( 4) =       0.000435517288
  error estimate for blocks of size 2^( 5) =       0.000446975432
  error estimate for blocks of size 2^( 6) =       0.000453942226
  error estimate for blocks of size 2^( 7) =       0.000459077384

      target function =                  N/A
              le_mean =     -16.904124342623
             les_mean =     286.070663092146
             stat err =       0.000448878082
             autocorr =       1.299011070475
              std dev =       0.556976628792
             le_variance =       0.310222965021

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310163332880
                                         uncertainty =       0.001831203517

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310163332880
                                         uncertainty =       0.001831203517

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393841951
  error estimate for blocks of size 2^( 2) =       0.000407888641
  error estimate for blocks of size 2^( 3) =       0.000422141711
  error estimate for blocks of size 2^( 4) =       0.000435517288
  error estimate for blocks of size 2^( 5) =       0.000446975432
  error estimate for blocks of size 2^( 6) =       0.000453942226
  error estimate for blocks of size 2^( 7) =       0.000459077384

      target function =                  N/A
              le_mean =     -16.904124342623
             les_mean =     286.070663092146
             stat err =       0.000448878082
             autocorr =       1.299011070475
              std dev =       0.556976628792
             le_variance =       0.310222965021

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310163332880
                                         uncertainty =       0.001831203517

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310163332880
                                         uncertainty =       0.001831203517

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393841951
  error estimate for blocks of size 2^( 2) =       0.000407888641
  error estimate for blocks of size 2^( 3) =       0.000422141711
  error estimate for blocks of size 2^( 4) =       0.000435517288
  error estimate for blocks of size 2^( 5) =       0.000446975432
  error estimate for blocks of size 2^( 6) =       0.000453942226
  error estimate for blocks of size 2^( 7) =       0.000459077384

      target function =                  N/A
              le_mean =     -16.904124342623
             les_mean =     286.070663092146
             stat err =       0.000448878082
             autocorr =       1.299011070475
              std dev =       0.556976628792
             le_variance =       0.310222965021

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310163332880
                                         uncertainty =       0.001831203517

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310163332880
                                         uncertainty =       0.001831203517

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393841951
  error estimate for blocks of size 2^( 2) =       0.000407888641
  error estimate for blocks of size 2^( 3) =       0.000422141711
  error estimate for blocks of size 2^( 4) =       0.000435517288
  error estimate for blocks of size 2^( 5) =       0.000446975432
  error estimate for blocks of size 2^( 6) =       0.000453942226
  error estimate for blocks of size 2^( 7) =       0.000459077384

      target function =                  N/A
              le_mean =     -16.904124342623
             les_mean =     286.070663092146
             stat err =       0.000448878082
             autocorr =       1.299011070475
              std dev =       0.556976628792
             le_variance =       0.310222965021


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904124342623        initial  <--
     9.3132e+69     9.3132e+70             0.0000e+00       -16.904124342623
     3.7253e+70     3.7253e+71             0.0000e+00       -16.904124342623
     1.4901e+71     1.4901e+72             0.0000e+00       -16.904124342623

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.4037
  </log>
  <optVariables href="H2O.s093.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0378e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s094 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s094 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=94  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 94
    time step          = 0.05
    reference energy   = -16.842
    reference variance = 0.23904
====================================================
  Execution time = 1.4359e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s094
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5296e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2297e-01
  Total weights = 1.951607373e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5837e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311490617626
                                         uncertainty =       0.002046281350

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311490617626
                                         uncertainty =       0.002046281350

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394643947
  error estimate for blocks of size 2^( 2) =       0.000408579469
  error estimate for blocks of size 2^( 3) =       0.000422290606
  error estimate for blocks of size 2^( 4) =       0.000434999284
  error estimate for blocks of size 2^( 5) =       0.000445239752
  error estimate for blocks of size 2^( 6) =       0.000452980295
  error estimate for blocks of size 2^( 7) =       0.000457560817

      target function =                  N/A
              le_mean =     -16.904901490942
             les_mean =     286.098665534457
             stat err =       0.000447695037
             autocorr =       1.286926275558
              std dev =       0.558110821775
             le_variance =       0.311487689383


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690490149094e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+70, overlap shift 9.3132e+71 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904901490967       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904901490967       residual = 9.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e+70 is 2.891053e-75

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+71, overlap shift 3.7253e+72 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904901490967       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904901490967       residual = 9.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+71 is 7.227632e-76

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4901e+72, overlap shift 1.4901e+73 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904901490967       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904901490967       residual = 9.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904901490967       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    3: stopping due to imaginary component in cost function
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+72 is 1.806908e-76

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.280519 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6948e+01
  </log>
  <optVariables href="H2O.s094.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 94
    time step          = 0.05
    reference energy   = -16.899
    reference variance = 0.169998
====================================================
  Execution time = 1.3873e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s094
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2360e-01
  Total weights = 1.9518e+06
  Execution time = 1.8789e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311686485912
                                         uncertainty =       0.001898119718

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311686485912
                                         uncertainty =       0.001898119718

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394736867
  error estimate for blocks of size 2^( 2) =       0.000409018390
  error estimate for blocks of size 2^( 3) =       0.000424218915
  error estimate for blocks of size 2^( 4) =       0.000437848193
  error estimate for blocks of size 2^( 5) =       0.000450167198
  error estimate for blocks of size 2^( 6) =       0.000458769902
  error estimate for blocks of size 2^( 7) =       0.000464375587

      target function =                  N/A
              le_mean =     -16.904545523505
             les_mean =     286.087258504528
             stat err =       0.000452790220
             autocorr =       1.315766107699
              std dev =       0.558242230993
             le_variance =       0.311634388464

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311686485912
                                         uncertainty =       0.001898119718

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311686485912
                                         uncertainty =       0.001898119718

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394736867
  error estimate for blocks of size 2^( 2) =       0.000409018390
  error estimate for blocks of size 2^( 3) =       0.000424218915
  error estimate for blocks of size 2^( 4) =       0.000437848193
  error estimate for blocks of size 2^( 5) =       0.000450167198
  error estimate for blocks of size 2^( 6) =       0.000458769902
  error estimate for blocks of size 2^( 7) =       0.000464375587

      target function =                  N/A
              le_mean =     -16.904545523505
             les_mean =     286.087258504528
             stat err =       0.000452790220
             autocorr =       1.315766107699
              std dev =       0.558242230993
             le_variance =       0.311634388464

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311686485912
                                         uncertainty =       0.001898119718

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311686485912
                                         uncertainty =       0.001898119718

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394736867
  error estimate for blocks of size 2^( 2) =       0.000409018390
  error estimate for blocks of size 2^( 3) =       0.000424218915
  error estimate for blocks of size 2^( 4) =       0.000437848193
  error estimate for blocks of size 2^( 5) =       0.000450167198
  error estimate for blocks of size 2^( 6) =       0.000458769902
  error estimate for blocks of size 2^( 7) =       0.000464375587

      target function =                  N/A
              le_mean =     -16.904545523505
             les_mean =     286.087258504528
             stat err =       0.000452790220
             autocorr =       1.315766107699
              std dev =       0.558242230993
             le_variance =       0.311634388464

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311686485912
                                         uncertainty =       0.001898119718

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311686485912
                                         uncertainty =       0.001898119718

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394736867
  error estimate for blocks of size 2^( 2) =       0.000409018390
  error estimate for blocks of size 2^( 3) =       0.000424218915
  error estimate for blocks of size 2^( 4) =       0.000437848193
  error estimate for blocks of size 2^( 5) =       0.000450167198
  error estimate for blocks of size 2^( 6) =       0.000458769902
  error estimate for blocks of size 2^( 7) =       0.000464375587

      target function =                  N/A
              le_mean =     -16.904545523505
             les_mean =     286.087258504528
             stat err =       0.000452790220
             autocorr =       1.315766107699
              std dev =       0.558242230993
             le_variance =       0.311634388464


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904545523505        initial  <--
     9.3132e+70     9.3132e+71             2.8911e-75       -16.904545523505
     3.7253e+71     3.7253e+72             7.2276e-76       -16.904545523505
     1.4901e+72     1.4901e+73             1.8069e-76       -16.904545523505

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.5103
  </log>
  <optVariables href="H2O.s094.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0468e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s095 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s095 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=95  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 95
    time step          = 0.05
    reference energy   = -16.8773
    reference variance = 0.239756
====================================================
  Execution time = 1.4367e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s095
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5239e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2662e-01
  Total weights = 1.951738717e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6130e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316146593728
                                         uncertainty =       0.002501894735

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316146593728
                                         uncertainty =       0.002501894735

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397515881
  error estimate for blocks of size 2^( 2) =       0.000411402697
  error estimate for blocks of size 2^( 3) =       0.000425915197
  error estimate for blocks of size 2^( 4) =       0.000439547565
  error estimate for blocks of size 2^( 5) =       0.000451774290
  error estimate for blocks of size 2^( 6) =       0.000460199471
  error estimate for blocks of size 2^( 7) =       0.000464174277

      target function =                  N/A
              le_mean =     -16.904313193945
             les_mean =     286.082422518438
             stat err =       0.000453923901
             autocorr =       1.303938579188
              std dev =       0.562172349606
             le_variance =       0.316037750662


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690431319395e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+71, overlap shift 9.3132e+72 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904313193945       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904313193945       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e+71 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+72, overlap shift 3.7253e+73 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904313193945       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904313193945       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+72 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4901e+73, overlap shift 1.4901e+74 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904313193945       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904313193945       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+73 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.281693 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6986e+01
  </log>
  <optVariables href="H2O.s095.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 95
    time step          = 0.05
    reference energy   = -16.8966
    reference variance = 0.222879
====================================================
  Execution time = 1.3840e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s095
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2320e-01
  Total weights = 1.9515e+06
  Execution time = 1.8867e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311153477231
                                         uncertainty =       0.002059957612

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311153477231
                                         uncertainty =       0.002059957612

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394369174
  error estimate for blocks of size 2^( 2) =       0.000408590702
  error estimate for blocks of size 2^( 3) =       0.000422621113
  error estimate for blocks of size 2^( 4) =       0.000436692980
  error estimate for blocks of size 2^( 5) =       0.000447938108
  error estimate for blocks of size 2^( 6) =       0.000458508407
  error estimate for blocks of size 2^( 7) =       0.000465243491

      target function =                  N/A
              le_mean =     -16.903586598824
             les_mean =     286.054442812707
             stat err =       0.000452095747
             autocorr =       1.314180201869
              std dev =       0.557722234591
             le_variance =       0.311054090957

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311153477231
                                         uncertainty =       0.002059957612

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311153477231
                                         uncertainty =       0.002059957612

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394369174
  error estimate for blocks of size 2^( 2) =       0.000408590702
  error estimate for blocks of size 2^( 3) =       0.000422621113
  error estimate for blocks of size 2^( 4) =       0.000436692980
  error estimate for blocks of size 2^( 5) =       0.000447938108
  error estimate for blocks of size 2^( 6) =       0.000458508407
  error estimate for blocks of size 2^( 7) =       0.000465243491

      target function =                  N/A
              le_mean =     -16.903586598824
             les_mean =     286.054442812707
             stat err =       0.000452095747
             autocorr =       1.314180201869
              std dev =       0.557722234591
             le_variance =       0.311054090957

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311153477231
                                         uncertainty =       0.002059957612

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311153477231
                                         uncertainty =       0.002059957612

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394369174
  error estimate for blocks of size 2^( 2) =       0.000408590702
  error estimate for blocks of size 2^( 3) =       0.000422621113
  error estimate for blocks of size 2^( 4) =       0.000436692980
  error estimate for blocks of size 2^( 5) =       0.000447938108
  error estimate for blocks of size 2^( 6) =       0.000458508407
  error estimate for blocks of size 2^( 7) =       0.000465243491

      target function =                  N/A
              le_mean =     -16.903586598824
             les_mean =     286.054442812707
             stat err =       0.000452095747
             autocorr =       1.314180201869
              std dev =       0.557722234591
             le_variance =       0.311054090957

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311153477231
                                         uncertainty =       0.002059957612

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311153477231
                                         uncertainty =       0.002059957612

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394369174
  error estimate for blocks of size 2^( 2) =       0.000408590702
  error estimate for blocks of size 2^( 3) =       0.000422621113
  error estimate for blocks of size 2^( 4) =       0.000436692980
  error estimate for blocks of size 2^( 5) =       0.000447938108
  error estimate for blocks of size 2^( 6) =       0.000458508407
  error estimate for blocks of size 2^( 7) =       0.000465243491

      target function =                  N/A
              le_mean =     -16.903586598824
             les_mean =     286.054442812707
             stat err =       0.000452095747
             autocorr =       1.314180201869
              std dev =       0.557722234591
             le_variance =       0.311054090957


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.903586598824        initial  <--
     9.3132e+71     9.3132e+72             0.0000e+00       -16.903586598824
     3.7253e+72     3.7253e+73             0.0000e+00       -16.903586598824
     1.4901e+73     1.4901e+74             0.0000e+00       -16.903586598824

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.3792
  </log>
  <optVariables href="H2O.s095.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0371e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s096 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s096 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=96  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 96
    time step          = 0.05
    reference energy   = -16.9081
    reference variance = 0.226964
====================================================
  Execution time = 1.4402e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s096
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5239e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2176e-01
  Total weights = 1.951142947e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5813e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309522745096
                                         uncertainty =       0.002056668534

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309522745096
                                         uncertainty =       0.002056668534

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393349604
  error estimate for blocks of size 2^( 2) =       0.000407641756
  error estimate for blocks of size 2^( 3) =       0.000421783534
  error estimate for blocks of size 2^( 4) =       0.000434216678
  error estimate for blocks of size 2^( 5) =       0.000444938904
  error estimate for blocks of size 2^( 6) =       0.000454053149
  error estimate for blocks of size 2^( 7) =       0.000459985633

      target function =                  N/A
              le_mean =     -16.904820743396
             les_mean =     286.094727378508
             stat err =       0.000448298591
             autocorr =       1.298904773627
              std dev =       0.556280345029
             le_variance =       0.309447822265


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690482074340e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+72, overlap shift 9.3132e+73 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904820743389       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904820743389       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904820743389       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904820743389       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e+72 is 5.297845e-77

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+73, overlap shift 3.7253e+74 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904820743389       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904820743389       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904820743389       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+73 is 1.324461e-77

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4901e+74, overlap shift 1.4901e+75 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904820743389       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904820743389       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904820743389       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904820743389       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+74 is 3.311153e-78

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.283314 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6989e+01
  </log>
  <optVariables href="H2O.s096.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 96
    time step          = 0.05
    reference energy   = -16.9501
    reference variance = 0.209133
====================================================
  Execution time = 1.4052e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s096
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2301e-01
  Total weights = 1.9516e+06
  Execution time = 1.8874e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310776048654
                                         uncertainty =       0.002285134304

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310776048654
                                         uncertainty =       0.002285134304

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394160011
  error estimate for blocks of size 2^( 2) =       0.000408513280
  error estimate for blocks of size 2^( 3) =       0.000422681537
  error estimate for blocks of size 2^( 4) =       0.000436131932
  error estimate for blocks of size 2^( 5) =       0.000447108734
  error estimate for blocks of size 2^( 6) =       0.000455089801
  error estimate for blocks of size 2^( 7) =       0.000459902998

      target function =                  N/A
              le_mean =     -16.903866829330
             les_mean =     286.063719707984
             stat err =       0.000449558366
             autocorr =       1.300849474679
              std dev =       0.557426433064
             le_variance =       0.310724228279

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310776048654
                                         uncertainty =       0.002285134304

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310776048654
                                         uncertainty =       0.002285134304

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394160011
  error estimate for blocks of size 2^( 2) =       0.000408513280
  error estimate for blocks of size 2^( 3) =       0.000422681537
  error estimate for blocks of size 2^( 4) =       0.000436131932
  error estimate for blocks of size 2^( 5) =       0.000447108734
  error estimate for blocks of size 2^( 6) =       0.000455089801
  error estimate for blocks of size 2^( 7) =       0.000459902998

      target function =                  N/A
              le_mean =     -16.903866829330
             les_mean =     286.063719707984
             stat err =       0.000449558366
             autocorr =       1.300849474679
              std dev =       0.557426433064
             le_variance =       0.310724228279

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310776048654
                                         uncertainty =       0.002285134304

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310776048654
                                         uncertainty =       0.002285134304

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394160011
  error estimate for blocks of size 2^( 2) =       0.000408513280
  error estimate for blocks of size 2^( 3) =       0.000422681537
  error estimate for blocks of size 2^( 4) =       0.000436131932
  error estimate for blocks of size 2^( 5) =       0.000447108734
  error estimate for blocks of size 2^( 6) =       0.000455089801
  error estimate for blocks of size 2^( 7) =       0.000459902998

      target function =                  N/A
              le_mean =     -16.903866829330
             les_mean =     286.063719707984
             stat err =       0.000449558366
             autocorr =       1.300849474679
              std dev =       0.557426433064
             le_variance =       0.310724228279

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310776048654
                                         uncertainty =       0.002285134304

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310776048654
                                         uncertainty =       0.002285134304

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394160011
  error estimate for blocks of size 2^( 2) =       0.000408513280
  error estimate for blocks of size 2^( 3) =       0.000422681537
  error estimate for blocks of size 2^( 4) =       0.000436131932
  error estimate for blocks of size 2^( 5) =       0.000447108734
  error estimate for blocks of size 2^( 6) =       0.000455089801
  error estimate for blocks of size 2^( 7) =       0.000459902998

      target function =                  N/A
              le_mean =     -16.903866829330
             les_mean =     286.063719707984
             stat err =       0.000449558366
             autocorr =       1.300849474679
              std dev =       0.557426433064
             le_variance =       0.310724228279


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.903866829330        initial  <--
     9.3132e+72     9.3132e+73             5.2978e-77       -16.903866829330
     3.7253e+73     3.7253e+74             1.3245e-77       -16.903866829330
     1.4901e+74     1.4901e+75             3.3112e-78       -16.903866829330

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.5726
  </log>
  <optVariables href="H2O.s096.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0567e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s097 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s097 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=97  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 97
    time step          = 0.05
    reference energy   = -16.8644
    reference variance = 0.195126
====================================================
  Execution time = 1.4387e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s097
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5226e+04
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2138e-01
  Total weights = 1.951848223e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6102e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308150697864
                                         uncertainty =       0.001931505860

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308150697864
                                         uncertainty =       0.001931505860

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392484714
  error estimate for blocks of size 2^( 2) =       0.000406349909
  error estimate for blocks of size 2^( 3) =       0.000421094731
  error estimate for blocks of size 2^( 4) =       0.000434502766
  error estimate for blocks of size 2^( 5) =       0.000443624836
  error estimate for blocks of size 2^( 6) =       0.000453215719
  error estimate for blocks of size 2^( 7) =       0.000458493368

      target function =                  N/A
              le_mean =     -16.904200707601
             les_mean =     286.073378438561
             stat err =       0.000447459172
             autocorr =       1.299754518143
              std dev =       0.555057205505
             le_variance =       0.308088501384


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690420070760e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+73, overlap shift 9.3132e+74 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904200707626       residual = 1.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904200707626       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e+73 is 4.749704e-78

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+74, overlap shift 3.7253e+75 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904200707626       residual = 1.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904200707626       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+74 is 1.187426e-78

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4901e+75, overlap shift 1.4901e+76 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904200707626       residual = 1.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904200707626       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+75 is 2.968565e-79

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.284322 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7002e+01
  </log>
  <optVariables href="H2O.s097.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 97
    time step          = 0.05
    reference energy   = -16.9886
    reference variance = 0.484425
====================================================
  Execution time = 1.4115e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s097
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2461e-01
  Total weights = 1.9517e+06
  Execution time = 1.8814e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310522993912
                                         uncertainty =       0.002344177053

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310522993912
                                         uncertainty =       0.002344177053

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394496892
  error estimate for blocks of size 2^( 2) =       0.000408922911
  error estimate for blocks of size 2^( 3) =       0.000422988247
  error estimate for blocks of size 2^( 4) =       0.000434889750
  error estimate for blocks of size 2^( 5) =       0.000446609957
  error estimate for blocks of size 2^( 6) =       0.000454278945
  error estimate for blocks of size 2^( 7) =       0.000458243775

      target function =                  N/A
              le_mean =     -16.904619947029
             les_mean =     286.090784525773
             stat err =       0.000448505607
             autocorr =       1.292553659718
              std dev =       0.557902854413
             le_variance =       0.311255594962

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310522993912
                                         uncertainty =       0.002344177053

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310522993912
                                         uncertainty =       0.002344177053

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394496892
  error estimate for blocks of size 2^( 2) =       0.000408922911
  error estimate for blocks of size 2^( 3) =       0.000422988247
  error estimate for blocks of size 2^( 4) =       0.000434889750
  error estimate for blocks of size 2^( 5) =       0.000446609957
  error estimate for blocks of size 2^( 6) =       0.000454278945
  error estimate for blocks of size 2^( 7) =       0.000458243775

      target function =                  N/A
              le_mean =     -16.904619947029
             les_mean =     286.090784525773
             stat err =       0.000448505607
             autocorr =       1.292553659718
              std dev =       0.557902854413
             le_variance =       0.311255594962

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310522993912
                                         uncertainty =       0.002344177053

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310522993912
                                         uncertainty =       0.002344177053

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394496892
  error estimate for blocks of size 2^( 2) =       0.000408922911
  error estimate for blocks of size 2^( 3) =       0.000422988247
  error estimate for blocks of size 2^( 4) =       0.000434889750
  error estimate for blocks of size 2^( 5) =       0.000446609957
  error estimate for blocks of size 2^( 6) =       0.000454278945
  error estimate for blocks of size 2^( 7) =       0.000458243775

      target function =                  N/A
              le_mean =     -16.904619947029
             les_mean =     286.090784525773
             stat err =       0.000448505607
             autocorr =       1.292553659718
              std dev =       0.557902854413
             le_variance =       0.311255594962

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310522993912
                                         uncertainty =       0.002344177053

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310522993912
                                         uncertainty =       0.002344177053

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394496892
  error estimate for blocks of size 2^( 2) =       0.000408922911
  error estimate for blocks of size 2^( 3) =       0.000422988247
  error estimate for blocks of size 2^( 4) =       0.000434889750
  error estimate for blocks of size 2^( 5) =       0.000446609957
  error estimate for blocks of size 2^( 6) =       0.000454278945
  error estimate for blocks of size 2^( 7) =       0.000458243775

      target function =                  N/A
              le_mean =     -16.904619947029
             les_mean =     286.090784525773
             stat err =       0.000448505607
             autocorr =       1.292553659718
              std dev =       0.557902854413
             le_variance =       0.311255594962


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904619947029        initial  <--
     9.3132e+73     9.3132e+74             4.7497e-78       -16.904619947029
     3.7253e+74     3.7253e+75             1.1874e-78       -16.904619947029
     1.4901e+75     1.4901e+76             2.9686e-79       -16.904619947029

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.6245
  </log>
  <optVariables href="H2O.s097.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0632e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s098 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s098 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=98  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 98
    time step          = 0.05
    reference energy   = -16.802
    reference variance = 0.293625
====================================================
  Execution time = 1.4512e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s098
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5261e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2299e-01
  Total weights = 1.952373160e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5890e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311022675524
                                         uncertainty =       0.002062160603

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311022675524
                                         uncertainty =       0.002062160603

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394316279
  error estimate for blocks of size 2^( 2) =       0.000408250054
  error estimate for blocks of size 2^( 3) =       0.000422467275
  error estimate for blocks of size 2^( 4) =       0.000435569619
  error estimate for blocks of size 2^( 5) =       0.000446834407
  error estimate for blocks of size 2^( 6) =       0.000455335205
  error estimate for blocks of size 2^( 7) =       0.000463294176

      target function =                  N/A
              le_mean =     -16.904771204246
             les_mean =     286.094282483016
             stat err =       0.000450258352
             autocorr =       1.303869540729
              std dev =       0.557647429932
             le_variance =       0.310970656110


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690477120425e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+74, overlap shift 9.3132e+75 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904771204269       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904771204269       residual = 8.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e+74 is 3.498074e-79

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+75, overlap shift 3.7253e+76 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904771204269       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904771204269       residual = 8.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+75 is 8.745186e-80

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4901e+76, overlap shift 1.4901e+77 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904771204269       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904771204269       residual = 8.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+76 is 2.186296e-80

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.285390 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7105e+01
  </log>
  <optVariables href="H2O.s098.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 98
    time step          = 0.05
    reference energy   = -16.8644
    reference variance = 0.205775
====================================================
  Execution time = 1.4102e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s098
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2847e-01
  Total weights = 1.9516e+06
  Execution time = 1.8906e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315123869910
                                         uncertainty =       0.004613788288

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315123869910
                                         uncertainty =       0.004613788288

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396926704
  error estimate for blocks of size 2^( 2) =       0.000411149857
  error estimate for blocks of size 2^( 3) =       0.000425214139
  error estimate for blocks of size 2^( 4) =       0.000438338717
  error estimate for blocks of size 2^( 5) =       0.000449682263
  error estimate for blocks of size 2^( 6) =       0.000457696986
  error estimate for blocks of size 2^( 7) =       0.000464864341

      target function =                  N/A
              le_mean =     -16.904176225255
             les_mean =     286.079640859635
             stat err =       0.000452645577
             autocorr =       1.300456790049
              std dev =       0.561339128067
             le_variance =       0.315101616699

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315123869910
                                         uncertainty =       0.004613788288

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315123869910
                                         uncertainty =       0.004613788288

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396926704
  error estimate for blocks of size 2^( 2) =       0.000411149857
  error estimate for blocks of size 2^( 3) =       0.000425214139
  error estimate for blocks of size 2^( 4) =       0.000438338717
  error estimate for blocks of size 2^( 5) =       0.000449682263
  error estimate for blocks of size 2^( 6) =       0.000457696986
  error estimate for blocks of size 2^( 7) =       0.000464864341

      target function =                  N/A
              le_mean =     -16.904176225255
             les_mean =     286.079640859635
             stat err =       0.000452645577
             autocorr =       1.300456790049
              std dev =       0.561339128067
             le_variance =       0.315101616699

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315123869910
                                         uncertainty =       0.004613788288

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315123869910
                                         uncertainty =       0.004613788288

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396926704
  error estimate for blocks of size 2^( 2) =       0.000411149857
  error estimate for blocks of size 2^( 3) =       0.000425214139
  error estimate for blocks of size 2^( 4) =       0.000438338717
  error estimate for blocks of size 2^( 5) =       0.000449682263
  error estimate for blocks of size 2^( 6) =       0.000457696986
  error estimate for blocks of size 2^( 7) =       0.000464864341

      target function =                  N/A
              le_mean =     -16.904176225255
             les_mean =     286.079640859635
             stat err =       0.000452645577
             autocorr =       1.300456790049
              std dev =       0.561339128067
             le_variance =       0.315101616699

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315123869910
                                         uncertainty =       0.004613788288

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315123869910
                                         uncertainty =       0.004613788288

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396926704
  error estimate for blocks of size 2^( 2) =       0.000411149857
  error estimate for blocks of size 2^( 3) =       0.000425214139
  error estimate for blocks of size 2^( 4) =       0.000438338717
  error estimate for blocks of size 2^( 5) =       0.000449682263
  error estimate for blocks of size 2^( 6) =       0.000457696986
  error estimate for blocks of size 2^( 7) =       0.000464864341

      target function =                  N/A
              le_mean =     -16.904176225255
             les_mean =     286.079640859635
             stat err =       0.000452645577
             autocorr =       1.300456790049
              std dev =       0.561339128067
             le_variance =       0.315101616699


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904176225255        initial  <--
     9.3132e+74     9.3132e+75             3.4981e-79       -16.904176225255
     3.7253e+75     3.7253e+76             8.7452e-80       -16.904176225255
     1.4901e+76     1.4901e+77             2.1863e-80       -16.904176225255

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 25.9675
  </log>
  <optVariables href="H2O.s098.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.3078e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s099 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s099 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=99  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 99
    time step          = 0.05
    reference energy   = -16.8415
    reference variance = 0.27569
====================================================
  Execution time = 1.4463e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s099
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5259e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2471e-01
  Total weights = 1.952193735e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5994e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313191880575
                                         uncertainty =       0.001944753692

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313191880575
                                         uncertainty =       0.001944753692

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395657083
  error estimate for blocks of size 2^( 2) =       0.000409655210
  error estimate for blocks of size 2^( 3) =       0.000423974994
  error estimate for blocks of size 2^( 4) =       0.000436271254
  error estimate for blocks of size 2^( 5) =       0.000447240034
  error estimate for blocks of size 2^( 6) =       0.000455190498
  error estimate for blocks of size 2^( 7) =       0.000458944166

      target function =                  N/A
              le_mean =     -16.904818802722
             les_mean =     286.097608033499
             stat err =       0.000449411488
             autocorr =       1.290180429525
              std dev =       0.559543612907
             le_variance =       0.313089054746


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690481880272e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+75, overlap shift 9.3132e+76 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904818802715       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904818802715       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e+75 is 4.900385e-80

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+76, overlap shift 3.7253e+77 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904818802715       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904818802715       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+76 is 1.225096e-80

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4901e+77, overlap shift 1.4901e+78 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904818802715       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904818802715       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904818802715       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+77 is 3.062741e-81

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.286582 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7067e+01
  </log>
  <optVariables href="H2O.s099.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 99
    time step          = 0.05
    reference energy   = -16.9832
    reference variance = 0.229462
====================================================
  Execution time = 1.4154e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s099
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6904e+01
  VMC Evar = 3.2517e-01
  Total weights = 1.9517e+06
  Execution time = 1.8875e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312061321845
                                         uncertainty =       0.002689975352

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312061321845
                                         uncertainty =       0.002689975352

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394964068
  error estimate for blocks of size 2^( 2) =       0.000408906455
  error estimate for blocks of size 2^( 3) =       0.000422737773
  error estimate for blocks of size 2^( 4) =       0.000434772914
  error estimate for blocks of size 2^( 5) =       0.000444482075
  error estimate for blocks of size 2^( 6) =       0.000450317103
  error estimate for blocks of size 2^( 7) =       0.000455549792

      target function =                  N/A
              le_mean =     -16.904118536579
             les_mean =     286.074391813573
             stat err =       0.000446280471
             autocorr =       1.276734488689
              std dev =       0.558563541999
             le_variance =       0.311993230451

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312061321845
                                         uncertainty =       0.002689975352

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312061321845
                                         uncertainty =       0.002689975352

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394964068
  error estimate for blocks of size 2^( 2) =       0.000408906455
  error estimate for blocks of size 2^( 3) =       0.000422737773
  error estimate for blocks of size 2^( 4) =       0.000434772914
  error estimate for blocks of size 2^( 5) =       0.000444482075
  error estimate for blocks of size 2^( 6) =       0.000450317103
  error estimate for blocks of size 2^( 7) =       0.000455549792

      target function =                  N/A
              le_mean =     -16.904118536579
             les_mean =     286.074391813573
             stat err =       0.000446280471
             autocorr =       1.276734488689
              std dev =       0.558563541999
             le_variance =       0.311993230451

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312061321845
                                         uncertainty =       0.002689975352

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312061321845
                                         uncertainty =       0.002689975352

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394964068
  error estimate for blocks of size 2^( 2) =       0.000408906455
  error estimate for blocks of size 2^( 3) =       0.000422737773
  error estimate for blocks of size 2^( 4) =       0.000434772914
  error estimate for blocks of size 2^( 5) =       0.000444482075
  error estimate for blocks of size 2^( 6) =       0.000450317103
  error estimate for blocks of size 2^( 7) =       0.000455549792

      target function =                  N/A
              le_mean =     -16.904118536579
             les_mean =     286.074391813573
             stat err =       0.000446280471
             autocorr =       1.276734488689
              std dev =       0.558563541999
             le_variance =       0.311993230451

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312061321845
                                         uncertainty =       0.002689975352

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312061321845
                                         uncertainty =       0.002689975352

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394964068
  error estimate for blocks of size 2^( 2) =       0.000408906455
  error estimate for blocks of size 2^( 3) =       0.000422737773
  error estimate for blocks of size 2^( 4) =       0.000434772914
  error estimate for blocks of size 2^( 5) =       0.000444482075
  error estimate for blocks of size 2^( 6) =       0.000450317103
  error estimate for blocks of size 2^( 7) =       0.000455549792

      target function =                  N/A
              le_mean =     -16.904118536579
             les_mean =     286.074391813573
             stat err =       0.000446280471
             autocorr =       1.276734488689
              std dev =       0.558563541999
             le_variance =       0.311993230451


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904118536579        initial  <--
     9.3132e+75     9.3132e+76             4.9004e-80       -16.904118536579
     3.7253e+76     3.7253e+77             1.2251e-80       -16.904118536579
     1.4901e+77     1.4901e+78             3.0627e-81       -16.904118536579

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.6971
  </log>
  <optVariables href="H2O.s099.opt.xml">
ci_0001                 7.011125e-01 3 1  ON 0
ci_0002                 6.996413e-01 3 1  ON 1
ci_0003                -3.046599e-02 3 1  ON 2
ci_0004                -3.091075e-02 3 1  ON 3
ci_0005                -3.366169e-02 3 1  ON 4
ci_0006                -3.479341e-02 3 1  ON 5
ci_0007                -2.186631e-02 3 1  ON 6
ci_0008                -2.315551e-02 3 1  ON 7
ci_0009                -1.987072e-02 3 1  ON 8
ci_0010                -2.025475e-02 3 1  ON 9
ci_0011                -1.478832e-02 3 1  ON 10
ci_0012                -1.482264e-02 3 1  ON 11
ci_0013                 1.604579e-02 3 1  ON 12
ci_0014                 1.528607e-02 3 1  ON 13
ci_0015                 1.616064e-02 3 1  ON 14
ci_0016                 1.562230e-02 3 1  ON 15
ci_0017                 1.423500e-02 3 1  ON 16
ci_0018                 1.405493e-02 3 1  ON 17
ci_0019                 1.258326e-02 3 1  ON 18
ci_0020                 1.185993e-02 3 1  ON 19
ci_0021                 6.905946e-03 3 1  ON 20
ci_0022                 7.158927e-03 3 1  ON 21
ci_0023                -1.184447e-02 3 1  ON 22
ci_0024                -1.120258e-02 3 1  ON 23
ci_0025                -1.121509e-02 3 1  ON 24
ci_0026                -1.121755e-02 3 1  ON 25
ci_0027                -1.141654e-02 3 1  ON 26
ci_0028                -1.145850e-02 3 1  ON 27
ci_0029                -1.086529e-02 3 1  ON 28
ci_0030                -1.049884e-02 3 1  ON 29
ci_0031                 1.941717e-02 3 1  ON 30
ci_0032                 1.934077e-02 3 1  ON 31
ci_0033                 9.744682e-03 3 1  ON 32
ci_0034                 1.064362e-02 3 1  ON 33
ci_0035                 6.625704e-03 3 1  ON 34
ci_0036                 4.428269e-03 3 1  ON 35
ci_0037                -1.147122e-02 3 1  ON 36
ci_0038                -1.067753e-02 3 1  ON 37
ci_0039                -4.226034e-03 3 1  ON 38
ci_0040                -4.038337e-03 3 1  ON 39
ci_0041                 8.592841e-03 3 1  ON 40
ci_0042                 8.387898e-03 3 1  ON 41
ci_0043                -1.322989e-02 3 1  ON 42
ci_0044                -1.355868e-02 3 1  ON 43
ci_0045                 8.145695e-03 3 1  ON 44
ci_0046                 7.906734e-03 3 1  ON 45
ci_0047                -3.628367e-03 3 1  ON 46
ci_0048                -3.173883e-03 3 1  ON 47
ci_0049                -6.782200e-03 3 1  ON 48
ci_0050                -5.925136e-03 3 1  ON 49
ci_0051                -4.459922e-03 3 1  ON 50
ci_0052                -4.596474e-03 3 1  ON 51
ci_0053                -6.299854e-03 3 1  ON 52
ci_0054                -5.939227e-03 3 1  ON 53
ci_0055                 6.416649e-03 3 1  ON 54
ci_0056                 6.766955e-03 3 1  ON 55
ci_0057                 5.652159e-03 3 1  ON 56
ci_0058                 4.681073e-03 3 1  ON 57
ci_0059                -5.819559e-03 3 1  ON 58
ci_0060                -5.905254e-03 3 1  ON 59
ci_0061                -3.686525e-03 3 1  ON 60
ci_0062                -4.027970e-03 3 1  ON 61
ci_0063                -9.201564e-03 3 1  ON 62
ci_0064                -8.557286e-03 3 1  ON 63
ci_0065                -6.655251e-03 3 1  ON 64
ci_0066                -6.874550e-03 3 1  ON 65
ci_0067                -6.043907e-03 3 1  ON 66
ci_0068                -6.239191e-03 3 1  ON 67
ci_0069                 5.309837e-03 3 1  ON 68
ci_0070                 5.442916e-03 3 1  ON 69
ci_0071                 4.215355e-03 3 1  ON 70
ci_0072                 5.161357e-03 3 1  ON 71
ci_0073                 5.150040e-03 3 1  ON 72
ci_0074                 5.507727e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0769e+01 secs
  Total Execution time = 4.1046e+03 secs

=========================================================
  A new xml input file : H2O.s099.cont.xml
