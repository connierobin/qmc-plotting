Rank =    0  Free Memory = 88860 MB
Rank =    1  Free Memory = 88860 MB
Rank =    2  Free Memory = 88860 MB
Rank =    3  Free Memory = 88859 MB
Rank =    4  Free Memory = 88858 MB
Rank =    5  Free Memory = 88858 MB
Rank =    6  Free Memory = 88858 MB
Rank =    7  Free Memory = 88858 MB
Rank =    8  Free Memory = 88858 MB
Rank =    9  Free Memory = 88858 MB
Rank =   10  Free Memory = 88858 MB
Rank =   11  Free Memory = 88857 MB
Rank =   12  Free Memory = 88857 MB
Rank =   13  Free Memory = 88857 MB
Rank =   14  Free Memory = 88857 MB
Rank =   15  Free Memory = 88842 MB
Rank =   16  Free Memory = 88842 MB
Rank =   17  Free Memory = 88842 MB
Rank =   18  Free Memory = 88842 MB
Rank =   19  Free Memory = 88842 MB
Rank =   20  Free Memory = 88842 MB
Rank =   21  Free Memory = 88842 MB
Rank =   22  Free Memory = 88842 MB
Rank =   23  Free Memory = 88842 MB
Rank =   24  Free Memory = 88842 MB
Rank =   25  Free Memory = 88842 MB
Rank =   26  Free Memory = 88842 MB
Rank =   27  Free Memory = 88842 MB
Rank =   28  Free Memory = 88842 MB
Rank =   29  Free Memory = 88842 MB
Rank =   30  Free Memory = 88842 MB
Rank =   31  Free Memory = 88842 MB
Rank =   32  Free Memory = 77521 MB
Rank =   33  Free Memory = 77520 MB
Rank =   34  Free Memory = 77520 MB
Rank =   35  Free Memory = 77520 MB
Rank =   36  Free Memory = 77520 MB
Rank =   37  Free Memory = 77520 MB
Rank =   38  Free Memory = 77520 MB
Rank =   39  Free Memory = 77520 MB
Rank =   40  Free Memory = 77520 MB
Rank =   41  Free Memory = 77520 MB
Rank =   42  Free Memory = 77520 MB
Rank =   43  Free Memory = 77520 MB
Rank =   44  Free Memory = 77520 MB
Rank =   45  Free Memory = 77520 MB
Rank =   46  Free Memory = 77520 MB
Rank =   47  Free Memory = 77520 MB
Rank =   48  Free Memory = 77520 MB
Rank =   49  Free Memory = 77520 MB
Rank =   50  Free Memory = 77520 MB
Rank =   51  Free Memory = 77520 MB
Rank =   52  Free Memory = 77520 MB
Rank =   53  Free Memory = 77520 MB
Rank =   54  Free Memory = 77520 MB
Rank =   55  Free Memory = 77520 MB
Rank =   56  Free Memory = 77520 MB
Rank =   57  Free Memory = 77520 MB
Rank =   58  Free Memory = 77520 MB
Rank =   59  Free Memory = 77520 MB
Rank =   60  Free Memory = 77520 MB
Rank =   61  Free Memory = 77520 MB
Rank =   62  Free Memory = 77520 MB
Rank =   63  Free Memory = 77520 MB
Rank =   64  Free Memory = 88022 MB
Rank =   65  Free Memory = 88022 MB
Rank =   66  Free Memory = 88022 MB
Rank =   67  Free Memory = 88022 MB
Rank =   68  Free Memory = 88022 MB
Rank =   69  Free Memory = 88022 MB
Rank =   70  Free Memory = 88022 MB
Rank =   71  Free Memory = 88022 MB
Rank =   72  Free Memory = 88022 MB
Rank =   73  Free Memory = 88021 MB
Rank =   74  Free Memory = 88021 MB
Rank =   75  Free Memory = 88021 MB
Rank =   76  Free Memory = 88021 MB
Rank =   77  Free Memory = 88021 MB
Rank =   78  Free Memory = 88021 MB
Rank =   79  Free Memory = 88021 MB
Rank =   80  Free Memory = 88021 MB
Rank =   81  Free Memory = 88021 MB
Rank =   82  Free Memory = 88021 MB
Rank =   83  Free Memory = 88021 MB
Rank =   84  Free Memory = 88021 MB
Rank =   85  Free Memory = 88021 MB
Rank =   86  Free Memory = 88021 MB
Rank =   87  Free Memory = 88021 MB
Rank =   88  Free Memory = 88021 MB
Rank =   89  Free Memory = 88021 MB
Rank =   90  Free Memory = 88021 MB
Rank =   91  Free Memory = 88021 MB
Rank =   92  Free Memory = 88021 MB
Rank =   93  Free Memory = 88021 MB
Rank =   94  Free Memory = 88021 MB
Rank =   95  Free Memory = 88021 MB
Rank =   96  Free Memory = 88641 MB
Rank =   97  Free Memory = 88641 MB
Rank =   98  Free Memory = 88641 MB
Rank =   99  Free Memory = 88641 MB
Rank =  100  Free Memory = 88641 MB
Rank =  101  Free Memory = 88641 MB
Rank =  102  Free Memory = 88641 MB
Rank =  103  Free Memory = 88641 MB
Rank =  104  Free Memory = 88641 MB
Rank =  105  Free Memory = 88641 MB
Rank =  106  Free Memory = 88641 MB
Rank =  107  Free Memory = 88641 MB
Rank =  108  Free Memory = 88641 MB
Rank =  109  Free Memory = 88641 MB
Rank =  110  Free Memory = 88641 MB
Rank =  111  Free Memory = 88641 MB
Rank =  112  Free Memory = 88641 MB
Rank =  113  Free Memory = 88641 MB
Rank =  114  Free Memory = 88641 MB
Rank =  115  Free Memory = 88641 MB
Rank =  116  Free Memory = 88641 MB
Rank =  117  Free Memory = 88641 MB
Rank =  118  Free Memory = 88641 MB
Rank =  119  Free Memory = 88641 MB
Rank =  120  Free Memory = 88641 MB
Rank =  121  Free Memory = 88641 MB
Rank =  122  Free Memory = 88641 MB
Rank =  123  Free Memory = 88641 MB
Rank =  124  Free Memory = 88641 MB
Rank =  125  Free Memory = 88641 MB
Rank =  126  Free Memory = 88641 MB
Rank =  127  Free Memory = 88641 MB
  Input file(s): opt_h2o_1b1_Jwarm_run001.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: a1d851bbe8d902a0d3168a885b757a378aeaab54-dirty
  Last git commit date: Mon Feb 13 11:52:39 2023 -0800
  Last git commit subject: Print param update magnitude and largest update
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_1b1_Jwarm_run001.xml

  Project = H2O
  date    = 2023-03-01 19:29:21 PST
  host    = n0010.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 17

  Range of prime numbers to use as seeds over processors and threads = 67-853


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 0.000000e+00    1         1  ON     0
     uu_1                 0.000000e+00    1         1  ON     1
     uu_2                 0.000000e+00    1         1  ON     2
     uu_3                 0.000000e+00    1         1  ON     3
     uu_4                 0.000000e+00    1         1  ON     4
     uu_5                 0.000000e+00    1         1  ON     5
     uu_6                 0.000000e+00    1         1  ON     6
     uu_7                 0.000000e+00    1         1  ON     7
     uu_8                 0.000000e+00    1         1  ON     8
     uu_9                 0.000000e+00    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 0.000000e+00    1         1  ON     0
     ud_1                 0.000000e+00    1         1  ON     1
     ud_2                 0.000000e+00    1         1  ON     2
     ud_3                 0.000000e+00    1         1  ON     3
     ud_4                 0.000000e+00    1         1  ON     4
     ud_5                 0.000000e+00    1         1  ON     5
     ud_6                 0.000000e+00    1         1  ON     6
     ud_7                 0.000000e+00    1         1  ON     7
     ud_8                 0.000000e+00    1         1  ON     8
     ud_9                 0.000000e+00    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                 0.000000e+00    1         1  ON     0
     eO_1                 0.000000e+00    1         1  ON     1
     eO_2                 0.000000e+00    1         1  ON     2
     eO_3                 0.000000e+00    1         1  ON     3
     eO_4                 0.000000e+00    1         1  ON     4
     eO_5                 0.000000e+00    1         1  ON     5
     eO_6                 0.000000e+00    1         1  ON     6
     eO_7                 0.000000e+00    1         1  ON     7
     eO_8                 0.000000e+00    1         1  ON     8
     eO_9                 0.000000e+00    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                 0.000000e+00    1         1  ON     0
     eH1_1                 0.000000e+00    1         1  ON     1
     eH1_2                 0.000000e+00    1         1  ON     2
     eH1_3                 0.000000e+00    1         1  ON     3
     eH1_4                 0.000000e+00    1         1  ON     4
     eH1_5                 0.000000e+00    1         1  ON     5
     eH1_6                 0.000000e+00    1         1  ON     6
     eH1_7                 0.000000e+00    1         1  ON     7
     eH1_8                 0.000000e+00    1         1  ON     8
     eH1_9                 0.000000e+00    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                 0.000000e+00    1         1  ON     0
     eH2_1                 0.000000e+00    1         1  ON     1
     eH2_2                 0.000000e+00    1         1  ON     2
     eH2_3                 0.000000e+00    1         1  ON     3
     eH2_4                 0.000000e+00    1         1  ON     4
     eH2_5                 0.000000e+00    1         1  ON     5
     eH2_6                 0.000000e+00    1         1  ON     6
     eH2_7                 0.000000e+00    1         1  ON     7
     eH2_8                 0.000000e+00    1         1  ON     8
     eH2_9                 0.000000e+00    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 75 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.913765e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 30 unique up determinants.
Found 30 unique down determinants.
Number of terms in pairs array: 20
Number of terms in pairs array: 20
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 1.6256e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u  6.1002844054e-01  1.3250453608e-01 -4.2267217978e-01
    u -4.3494847795e-01 -2.3203549626e-01  1.0876787134e-01
    u -1.5984350305e-01  8.1842956548e-01  5.1837161342e-02
    u  1.1948334779e+00  1.4453040952e+00  1.6346730752e+00
    d -9.5054657961e-01  2.3768909128e-01 -6.0876959125e-01
    d -2.0429807517e-01  1.5546410594e+00 -1.0292769217e-01
    d  4.7451519973e-01  3.4811618685e-02  3.5425821429e-01
    d -8.6403568621e-02 -1.8286319639e+00  9.9844026831e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 20
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.6732
    reference variance = 1.20967
====================================================
  Execution time = 2.0877e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6753e+01
  VMC Evar = 1.2073e+00
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4917e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       1.207216275604
                                         uncertainty =       0.005066319635

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       1.207216275604
                                         uncertainty =       0.005066319635

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000776935949
  error estimate for blocks of size 2^( 2) =       0.000827116232
  error estimate for blocks of size 2^( 3) =       0.000871460879
  error estimate for blocks of size 2^( 4) =       0.000901583650
  error estimate for blocks of size 2^( 5) =       0.000921522018
  error estimate for blocks of size 2^( 6) =       0.000932864797
  error estimate for blocks of size 2^( 7) =       0.000938811934

      target function =                  N/A
              le_mean =     -16.753292433337
             les_mean =     281.880065690866
             stat err =       0.000923695600
             autocorr =       1.413472345058
              std dev =       1.098753356117
             le_variance =       1.207258937578


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.675329243334e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.753292433337       residual = 1.18e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.773530856648       residual = 6.56e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.790914843914       residual = 3.59e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.799324259281       residual = 3.38e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.802039026131       residual = 5.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.805276989915       residual = 2.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.806831366031       residual = 1.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.807217841759       residual = 2.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.807396546856       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.807484533439       residual = 3.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.807503850989       residual = 2.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.807517328039       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.807520505044       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.807522224268       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.807521243750       residual = 9.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.807520668689       residual = 2.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.807520701144       residual = 5.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.952563e-01

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.753292433337       residual = 1.18e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.763045713686       residual = 8.97e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.769485923131       residual = 6.25e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.772251757953       residual = 4.59e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.775472610213       residual = 6.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.776690010078       residual = 1.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.776994619550       residual = 6.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.777128767069       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.777157320256       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.777163448466       residual = 9.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.777165553462       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.777165832248       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.777165995389       residual = 3.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.777166034743       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.777166021209       residual = 1.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 7.549947e-02

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.753292433337       residual = 1.18e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.756464772651       residual = 1.10e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.758396227705       residual = 7.57e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.759310481187       residual = 4.55e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.760367690908       residual = 8.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.760814291275       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.760879637300       residual = 3.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.760903072960       residual = 9.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.760909116063       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.760910214152       residual = 4.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.760910665851       residual = 3.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.760910611532       residual = 6.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.760910626783       residual = 5.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 2.243818e-02

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.011038 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6389e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  3.350051e-02                 1 1 ON  0
uu_1  9.159707e-03                 1 1 ON  1
uu_2  -1.242374e-02                1 1 ON  2
uu_3  -6.139223e-03                1 1 ON  3
uu_4  -4.623058e-03                1 1 ON  4
uu_5  -3.649473e-03                1 1 ON  5
uu_6  -6.726003e-03                1 1 ON  6
uu_7  -5.988326e-03                1 1 ON  7
uu_8  -2.744438e-03                1 1 ON  8
uu_9  -4.905534e-04                1 1 ON  9
ud_0  7.549947e-02                 1 1 ON  10
ud_1  -5.099628e-03                1 1 ON  11
ud_2  -1.880150e-02                1 1 ON  12
ud_3  -8.119171e-03                1 1 ON  13
ud_4  -1.035772e-02                1 1 ON  14
ud_5  -9.071091e-03                1 1 ON  15
ud_6  -1.097414e-02                1 1 ON  16
ud_7  -8.610054e-03                1 1 ON  17
ud_8  -3.786941e-03                1 1 ON  18
ud_9  -7.364102e-04                1 1 ON  19
eO_0  -4.418273e-02                1 1 ON  20
eO_1  -1.073481e-02                1 1 ON  21
eO_2  3.206150e-02                 1 1 ON  22
eO_3  1.771964e-02                 1 1 ON  23
eO_4  1.310245e-02                 1 1 ON  24
eO_5  -1.008509e-05                1 1 ON  25
eO_6  -4.752508e-03                1 1 ON  26
eO_7  -2.629153e-03                1 1 ON  27
eO_8  -5.454075e-04                1 1 ON  28
eO_9  -3.423308e-05                1 1 ON  29
eH1_0 -9.235944e-03                1 1 ON  30
eH1_1 1.734363e-04                 1 1 ON  31
eH1_2 -2.018653e-03                1 1 ON  32
eH1_3 3.658730e-03                 1 1 ON  33
eH1_4 6.147055e-03                 1 1 ON  34
eH1_5 3.124270e-03                 1 1 ON  35
eH1_6 5.219279e-04                 1 1 ON  36
eH1_7 -1.308610e-03                1 1 ON  37
eH1_8 -8.463838e-04                1 1 ON  38
eH1_9 -2.058628e-04                1 1 ON  39
eH2_0 -9.431924e-03                1 1 ON  40
eH2_1 1.385708e-04                 1 1 ON  41
eH2_2 -2.147794e-03                1 1 ON  42
eH2_3 3.578061e-03                 1 1 ON  43
eH2_4 6.115840e-03                 1 1 ON  44
eH2_5 3.226706e-03                 1 1 ON  45
eH2_6 7.607355e-04                 1 1 ON  46
eH2_7 -1.236081e-03                1 1 ON  47
eH2_8 -7.994858e-04                1 1 ON  48
eH2_9 -1.839551e-04                1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.8721
    reference variance = 0.666939
====================================================
  Execution time = 2.0618e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6798e+01
  VMC Evar = 7.9638e-01
  Total weights = 2.0000e+06
  Execution time = 1.9643e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       1.156863493376
                                         uncertainty =       0.002816687465

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       1.156863493376
                                         uncertainty =       0.002816687465

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000760600106
  error estimate for blocks of size 2^( 2) =       0.000809299623
  error estimate for blocks of size 2^( 3) =       0.000851151986
  error estimate for blocks of size 2^( 4) =       0.000879889683
  error estimate for blocks of size 2^( 5) =       0.000897724556
  error estimate for blocks of size 2^( 6) =       0.000907460173
  error estimate for blocks of size 2^( 7) =       0.000915897871

      target function =                  N/A
              le_mean =     -16.805914136635
             les_mean =     283.595774431924
             stat err =       0.000900243071
             autocorr =       1.400898955758
              std dev =       1.075650985438
             le_variance =       1.157025042475

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513761022389
                                         uncertainty =       0.003593123915

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513761022389
                                         uncertainty =       0.003593123915

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506921159
  error estimate for blocks of size 2^( 2) =       0.000544021626
  error estimate for blocks of size 2^( 3) =       0.000579744165
  error estimate for blocks of size 2^( 4) =       0.000606877494
  error estimate for blocks of size 2^( 5) =       0.000624539569
  error estimate for blocks of size 2^( 6) =       0.000635389613
  error estimate for blocks of size 2^( 7) =       0.000641802632

      target function =                  N/A
              le_mean =     -16.815094988886
             les_mean =     283.261357351594
             stat err =       0.000627152327
             autocorr =       1.530612436071
              std dev =       0.716894778402
             le_variance =       0.513938123300

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.598300501194
                                         uncertainty =       0.003190875493

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.598300501194
                                         uncertainty =       0.003190875493

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000547030675
  error estimate for blocks of size 2^( 2) =       0.000589815698
  error estimate for blocks of size 2^( 3) =       0.000629879469
  error estimate for blocks of size 2^( 4) =       0.000659441089
  error estimate for blocks of size 2^( 5) =       0.000678378749
  error estimate for blocks of size 2^( 6) =       0.000689858774
  error estimate for blocks of size 2^( 7) =       0.000696947638

      target function =                  N/A
              le_mean =     -16.806081247998
             les_mean =     283.042851733425
             stat err =       0.000681156562
             autocorr =       1.550495570012
              std dev =       0.773618199352
             le_variance =       0.598485118369

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       1.032606475347
                                         uncertainty =       0.002764340184

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       1.032606475347
                                         uncertainty =       0.002764340184

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000718599852
  error estimate for blocks of size 2^( 2) =       0.000766741340
  error estimate for blocks of size 2^( 3) =       0.000808619150
  error estimate for blocks of size 2^( 4) =       0.000837662831
  error estimate for blocks of size 2^( 5) =       0.000855723123
  error estimate for blocks of size 2^( 6) =       0.000865788569
  error estimate for blocks of size 2^( 7) =       0.000873993699

      target function =                  N/A
              le_mean =     -16.801958036613
             les_mean =     283.338564842089
             stat err =       0.000858292056
             autocorr =       1.426579367527
              std dev =       1.016253656507
             le_variance =       1.032771494364


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.805914136635        initial
     2.5000e-01     2.5000e+00             1.9526e-01       -16.815094988886  <--
     1.0000e+00     1.0000e+01             7.5499e-02       -16.806081247998
     4.0000e+00     4.0000e+01             2.2438e-02       -16.801958036613

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 3.2866e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 1.043219e-01 1 1  ON 0
 uu_1                 2.526068e-02 1 1  ON 1
 uu_2                -2.652425e-02 1 1  ON 2
 uu_3                -2.382323e-02 1 1  ON 3
 uu_4                -1.705469e-02 1 1  ON 4
 uu_5                -1.272225e-02 1 1  ON 5
 uu_6                -1.966302e-02 1 1  ON 6
 uu_7                -2.016529e-02 1 1  ON 7
 uu_8                -9.800998e-03 1 1  ON 8
 uu_9                -1.128313e-03 1 1  ON 9
 ud_0                 1.952563e-01 1 1  ON 10
 ud_1                 3.899165e-03 1 1  ON 11
 ud_2                -3.761342e-02 1 1  ON 12
 ud_3                -2.694918e-02 1 1  ON 13
 ud_4                -2.959793e-02 1 1  ON 14
 ud_5                -2.814439e-02 1 1  ON 15
 ud_6                -3.247220e-02 1 1  ON 16
 ud_7                -2.928841e-02 1 1  ON 17
 ud_8                -1.392061e-02 1 1  ON 18
 ud_9                -2.128859e-03 1 1  ON 19
 eO_0                -1.604199e-01 1 1  ON 20
 eO_1                -4.755372e-02 1 1  ON 21
 eO_2                 8.576993e-02 1 1  ON 22
 eO_3                 7.755986e-02 1 1  ON 23
 eO_4                 6.394888e-02 1 1  ON 24
 eO_5                 1.072425e-02 1 1  ON 25
 eO_6                -1.697602e-02 1 1  ON 26
 eO_7                -1.102687e-02 1 1  ON 27
 eO_8                -2.126370e-03 1 1  ON 28
 eO_9                 4.954774e-06 1 1  ON 29
eH1_0                -3.703411e-02 1 1  ON 30
eH1_1                -5.648206e-03 1 1  ON 31
eH1_2                -5.876344e-03 1 1  ON 32
eH1_3                 1.020169e-02 1 1  ON 33
eH1_4                 2.230920e-02 1 1  ON 34
eH1_5                 1.703212e-02 1 1  ON 35
eH1_6                 6.601961e-03 1 1  ON 36
eH1_7                -3.569091e-03 1 1  ON 37
eH1_8                -3.306694e-03 1 1  ON 38
eH1_9                -7.543161e-04 1 1  ON 39
eH2_0                -3.768233e-02 1 1  ON 40
eH2_1                -5.971761e-03 1 1  ON 41
eH2_2                -6.443700e-03 1 1  ON 42
eH2_3                 9.938701e-03 1 1  ON 43
eH2_4                 2.208636e-02 1 1  ON 44
eH2_5                 1.732021e-02 1 1  ON 45
eH2_6                 7.430556e-03 1 1  ON 46
eH2_7                -3.129575e-03 1 1  ON 47
eH2_8                -2.968497e-03 1 1  ON 48
eH2_9                -6.233511e-04 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9273e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6773e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.9015
    reference variance = 0.386982
====================================================
  Execution time = 2.0932e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6846e+01
  VMC Evar = 4.8877e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5267e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488783095527
                                         uncertainty =       0.006024727590

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.488783095527
                                         uncertainty =       0.006024727590

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000494355208
  error estimate for blocks of size 2^( 2) =       0.000529995962
  error estimate for blocks of size 2^( 3) =       0.000564672740
  error estimate for blocks of size 2^( 4) =       0.000592386738
  error estimate for blocks of size 2^( 5) =       0.000609885894
  error estimate for blocks of size 2^( 6) =       0.000620752076
  error estimate for blocks of size 2^( 7) =       0.000623555016

      target function =                  N/A
              le_mean =     -16.846397257915
             les_mean =     284.289874470060
             stat err =       0.000611644931
             autocorr =       1.530807335348
              std dev =       0.699123839514
             le_variance =       0.488774142976


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.684639725791e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.846397257915       residual = 6.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.852989938567       residual = 8.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.857203711148       residual = 1.36e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.860027096649       residual = 4.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.862041167811       residual = 4.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.863369724167       residual = 1.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.864568882285       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.865215024601       residual = 3.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.865655953237       residual = 3.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.865884852685       residual = 1.68e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.866030845532       residual = 6.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.866114369918       residual = 2.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.866161708037       residual = 4.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.866180080335       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.866182773067       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.866189177443       residual = 7.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.866192050418       residual = 4.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.866190779813       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.866189862096       residual = 3.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.866189937253       residual = 5.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         19 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 2.048247e-01

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.846397257915       residual = 6.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.849526737001       residual = 7.86e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.851555939422       residual = 1.17e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.853182432344       residual = 3.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.853823019201       residual = 1.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.854390360030       residual = 5.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.854675474837       residual = 2.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.854788524721       residual = 6.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.854820963970       residual = 3.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.854848558643       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.854850273273       residual = 3.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.854852213142       residual = 7.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.854853373373       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.854853648381       residual = 6.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.854853791629       residual = 2.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.854854072674       residual = 3.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 7.927720e-02

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.846397257915       residual = 6.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.847405479018       residual = 9.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.848066741719       residual = 8.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.848603274991       residual = 5.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.848935021736       residual = 8.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.849075808856       residual = 2.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.849113663112       residual = 6.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.849134721848       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.849134374318       residual = 4.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.849136071509       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.849136466121       residual = 3.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.849136395546       residual = 4.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.849136552768       residual = 5.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 2.374798e-02

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.020920 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6477e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 1.444117e-01 1 1  ON 0
 uu_1                 3.492418e-02 1 1  ON 1
 uu_2                -2.674403e-02 1 1  ON 2
 uu_3                -3.415801e-02 1 1  ON 3
 uu_4                -2.642796e-02 1 1  ON 4
 uu_5                -1.986022e-02 1 1  ON 5
 uu_6                -2.654201e-02 1 1  ON 6
 uu_7                -3.014156e-02 1 1  ON 7
 uu_8                -1.652302e-02 1 1  ON 8
 uu_9                -1.835441e-03 1 1  ON 9
 ud_0                 2.403850e-01 1 1  ON 10
 ud_1                 2.133137e-02 1 1  ON 11
 ud_2                -3.412330e-02 1 1  ON 12
 ud_3                -3.635228e-02 1 1  ON 13
 ud_4                -3.934629e-02 1 1  ON 14
 ud_5                -3.929893e-02 1 1  ON 15
 ud_6                -4.428204e-02 1 1  ON 16
 ud_7                -4.446019e-02 1 1  ON 17
 ud_8                -2.294961e-02 1 1  ON 18
 ud_9                -3.308521e-03 1 1  ON 19
 eO_0                -2.396971e-01 1 1  ON 20
 eO_1                -8.016427e-02 1 1  ON 21
 eO_2                 1.030973e-01 1 1  ON 22
 eO_3                 1.248318e-01 1 1  ON 23
 eO_4                 1.111114e-01 1 1  ON 24
 eO_5                 2.881783e-02 1 1  ON 25
 eO_6                -2.518375e-02 1 1  ON 26
 eO_7                -1.929332e-02 1 1  ON 27
 eO_8                -3.844858e-03 1 1  ON 28
 eO_9                 6.834519e-05 1 1  ON 29
eH1_0                -5.857629e-02 1 1  ON 30
eH1_1                -1.385007e-02 1 1  ON 31
eH1_2                -7.923019e-03 1 1  ON 32
eH1_3                 1.310744e-02 1 1  ON 33
eH1_4                 3.289623e-02 1 1  ON 34
eH1_5                 2.966140e-02 1 1  ON 35
eH1_6                 1.522306e-02 1 1  ON 36
eH1_7                -3.891385e-03 1 1  ON 37
eH1_8                -5.385776e-03 1 1  ON 38
eH1_9                -1.334486e-03 1 1  ON 39
eH2_0                -5.910961e-02 1 1  ON 40
eH2_1                -1.413864e-02 1 1  ON 41
eH2_2                -8.462571e-03 1 1  ON 42
eH2_3                 1.224624e-02 1 1  ON 43
eH2_4                 3.240217e-02 1 1  ON 44
eH2_5                 3.021985e-02 1 1  ON 45
eH2_6                 1.565119e-02 1 1  ON 46
eH2_7                -3.013027e-03 1 1  ON 47
eH2_8                -4.830680e-03 1 1  ON 48
eH2_9                -1.103625e-03 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.9733
    reference variance = 0.872559
====================================================
  Execution time = 2.0431e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6861e+01
  VMC Evar = 4.2636e-01
  Total weights = 2.0000e+06
  Execution time = 1.8864e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471459269236
                                         uncertainty =       0.002807404691

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.471459269236
                                         uncertainty =       0.002807404691

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000485536561
  error estimate for blocks of size 2^( 2) =       0.000519987840
  error estimate for blocks of size 2^( 3) =       0.000553005619
  error estimate for blocks of size 2^( 4) =       0.000579035533
  error estimate for blocks of size 2^( 5) =       0.000597105581
  error estimate for blocks of size 2^( 6) =       0.000608369492
  error estimate for blocks of size 2^( 7) =       0.000615100091

      target function =                  N/A
              le_mean =     -16.863559400066
             les_mean =     284.851126908620
             stat err =       0.000599902674
             autocorr =       1.526573499999
              std dev =       0.686652390083
             le_variance =       0.471491504807

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.397912290814
                                         uncertainty =       0.003208947269

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.397912290814
                                         uncertainty =       0.003208947269

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000446049710
  error estimate for blocks of size 2^( 2) =       0.000467913281
  error estimate for blocks of size 2^( 3) =       0.000489815542
  error estimate for blocks of size 2^( 4) =       0.000507875009
  error estimate for blocks of size 2^( 5) =       0.000521486452
  error estimate for blocks of size 2^( 6) =       0.000530060348
  error estimate for blocks of size 2^( 7) =       0.000534011276

      target function =                  N/A
              le_mean =     -16.865245610089
             les_mean =     284.834429978090
             stat err =       0.000523358271
             autocorr =       1.376675744612
              std dev =       0.630809550037
             le_variance =       0.397920688419

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.416537445316
                                         uncertainty =       0.003276227799

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.416537445316
                                         uncertainty =       0.003276227799

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000456368897
  error estimate for blocks of size 2^( 2) =       0.000480674604
  error estimate for blocks of size 2^( 3) =       0.000505296361
  error estimate for blocks of size 2^( 4) =       0.000525677585
  error estimate for blocks of size 2^( 5) =       0.000540825968
  error estimate for blocks of size 2^( 6) =       0.000550187500
  error estimate for blocks of size 2^( 7) =       0.000554786365

      target function =                  N/A
              le_mean =     -16.863876587927
             les_mean =     284.806878505165
             stat err =       0.000542869355
             autocorr =       1.415006958623
              std dev =       0.645403083814
             le_variance =       0.416545140596

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453587203647
                                         uncertainty =       0.002880008669

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.453587203647
                                         uncertainty =       0.002880008669

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000476243691
  error estimate for blocks of size 2^( 2) =       0.000509066234
  error estimate for blocks of size 2^( 3) =       0.000540871816
  error estimate for blocks of size 2^( 4) =       0.000566184506
  error estimate for blocks of size 2^( 5) =       0.000583930595
  error estimate for blocks of size 2^( 6) =       0.000594982310
  error estimate for blocks of size 2^( 7) =       0.000601405005

      target function =                  N/A
              le_mean =     -16.862276515986
             les_mean =     284.789985180855
             stat err =       0.000586625604
             autocorr =       1.517272401961
              std dev =       0.673510286554
             le_variance =       0.453616106094


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.863559400066        initial
     6.2500e-02     6.2500e-01             2.0482e-01       -16.865245610089  <--
     2.5000e-01     2.5000e+00             7.9277e-02       -16.863876587927
     1.0000e+00     1.0000e+01             2.3748e-02       -16.862276515986

*****************************************************************************
Applying the update for shift_i =   6.2500e-02     and shift_s =   6.2500e-01
*****************************************************************************

  Execution time = 2.9973e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 1.961794e-01 1 1  ON 0
 uu_1                 5.875767e-02 1 1  ON 1
 uu_2                -1.518203e-02 1 1  ON 2
 uu_3                -3.946841e-02 1 1  ON 3
 uu_4                -4.092809e-02 1 1  ON 4
 uu_5                -3.665714e-02 1 1  ON 5
 uu_6                -4.130449e-02 1 1  ON 6
 uu_7                -4.895163e-02 1 1  ON 7
 uu_8                -3.532754e-02 1 1  ON 8
 uu_9                -5.265998e-03 1 1  ON 9
 ud_0                 2.935982e-01 1 1  ON 10
 ud_1                 5.560319e-02 1 1  ON 11
 ud_2                -1.622951e-02 1 1  ON 12
 ud_3                -3.768710e-02 1 1  ON 13
 ud_4                -5.258387e-02 1 1  ON 14
 ud_5                -5.835084e-02 1 1  ON 15
 ud_6                -6.361806e-02 1 1  ON 16
 ud_7                -7.080153e-02 1 1  ON 17
 ud_8                -4.811582e-02 1 1  ON 18
 ud_9                -8.811035e-03 1 1  ON 19
 eO_0                -3.652446e-01 1 1  ON 20
 eO_1                -1.510397e-01 1 1  ON 21
 eO_2                 9.959250e-02 1 1  ON 22
 eO_3                 1.929677e-01 1 1  ON 23
 eO_4                 2.106543e-01 1 1  ON 24
 eO_5                 9.665535e-02 1 1  ON 25
 eO_6                -2.969644e-02 1 1  ON 26
 eO_7                -4.429842e-02 1 1  ON 27
 eO_8                -1.050435e-02 1 1  ON 28
 eO_9                 1.284044e-04 1 1  ON 29
eH1_0                -9.424283e-02 1 1  ON 30
eH1_1                -3.145120e-02 1 1  ON 31
eH1_2                -1.442494e-02 1 1  ON 32
eH1_3                 1.441825e-02 1 1  ON 33
eH1_4                 4.487017e-02 1 1  ON 34
eH1_5                 5.118520e-02 1 1  ON 35
eH1_6                 4.019372e-02 1 1  ON 36
eH1_7                 3.186031e-03 1 1  ON 37
eH1_8                -1.023521e-02 1 1  ON 38
eH1_9                -3.570658e-03 1 1  ON 39
eH2_0                -9.470051e-02 1 1  ON 40
eH2_1                -3.209663e-02 1 1  ON 41
eH2_2                -1.528783e-02 1 1  ON 42
eH2_3                 1.289679e-02 1 1  ON 43
eH2_4                 4.372358e-02 1 1  ON 44
eH2_5                 5.198385e-02 1 1  ON 45
eH2_6                 3.980073e-02 1 1  ON 46
eH2_7                 5.178046e-03 1 1  ON 47
eH2_8                -8.915910e-03 1 1  ON 48
eH2_9                -2.945533e-03 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6455e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6855e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.8666
    reference variance = 0.23056
====================================================
  Execution time = 2.0915e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6877e+01
  VMC Evar = 4.0321e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5093e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.403208325362
                                         uncertainty =       0.007350993663

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.403208325362
                                         uncertainty =       0.007350993663

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000449007308
  error estimate for blocks of size 2^( 2) =       0.000470128489
  error estimate for blocks of size 2^( 3) =       0.000491675093
  error estimate for blocks of size 2^( 4) =       0.000510092727
  error estimate for blocks of size 2^( 5) =       0.000523770708
  error estimate for blocks of size 2^( 6) =       0.000531856438
  error estimate for blocks of size 2^( 7) =       0.000535977902

      target function =                  N/A
              le_mean =     -16.876878062254
             les_mean =     285.232228052005
             stat err =       0.000525424444
             autocorr =       1.369347668870
              std dev =       0.634992224688
             le_variance =       0.403215125414


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.687687806225e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-02, overlap shift 1.5625e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.876878062254       residual = 1.70e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.878154726767       residual = 2.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.878907086347       residual = 1.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.880174299977       residual = 3.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.881599299869       residual = 1.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.883048283336       residual = 9.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.884277976656       residual = 1.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.884770807868       residual = 2.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.885119993070       residual = 4.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.885521497657       residual = 2.33e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.885856306265       residual = 8.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.886076284461       residual = 5.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.886206137326       residual = 3.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.886289583262       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.886344173747       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.886373997854       residual = 7.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.886403226373       residual = 4.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.886417002933       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.886420198862       residual = 6.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.886419726783       residual = 2.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.886420690799       residual = 5.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.886423122830       residual = 2.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.886424108097       residual = 2.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.886424768822       residual = 6.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.886423627674       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.886424333922       residual = 3.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         25 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-02 is 2.306327e-01

solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.876878062254       residual = 1.70e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.877742931158       residual = 1.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.878242312746       residual = 1.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.879029248366       residual = 2.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.879972154587       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.880752700068       residual = 4.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.881234729268       residual = 3.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.881334168352       residual = 9.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.881423370126       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.881489835783       residual = 4.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.881549999919       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.881587199004       residual = 6.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.881594671423       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.881599160367       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.881600788502       residual = 6.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.881600007997       residual = 3.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.881599516752       residual = 9.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.881601460557       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.881601490240       residual = 6.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 9.720162e-02

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.876878062254       residual = 1.70e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.877255574681       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.877535964701       residual = 1.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.877855192637       residual = 1.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.878232079501       residual = 4.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.878430962935       residual = 9.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.878499807747       residual = 3.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.878497981368       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.878506114628       residual = 5.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.878508612244       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.878513423714       residual = 5.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.878515304715       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.878514956244       residual = 4.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.878514935182       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.878514927099       residual = 4.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 3.301656e-02

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.036581 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6449e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 2.312534e-01 1 1  ON 0
 uu_1                 8.175750e-02 1 1  ON 1
 uu_2                -1.158367e-03 1 1  ON 2
 uu_3                -3.834823e-02 1 1  ON 3
 uu_4                -5.081460e-02 1 1  ON 4
 uu_5                -5.233345e-02 1 1  ON 5
 uu_6                -5.541974e-02 1 1  ON 6
 uu_7                -6.299776e-02 1 1  ON 7
 uu_8                -5.401665e-02 1 1  ON 8
 uu_9                -1.212032e-02 1 1  ON 9
 ud_0                 3.290848e-01 1 1  ON 10
 ud_1                 8.427405e-02 1 1  ON 11
 ud_2                 1.951914e-03 1 1  ON 12
 ud_3                -3.278809e-02 1 1  ON 13
 ud_4                -6.062509e-02 1 1  ON 14
 ud_5                -7.322490e-02 1 1  ON 15
 ud_6                -7.848262e-02 1 1  ON 16
 ud_7                -8.814337e-02 1 1  ON 17
 ud_8                -7.611801e-02 1 1  ON 18
 ud_9                -1.955404e-02 1 1  ON 19
 eO_0                -4.624462e-01 1 1  ON 20
 eO_1                -2.161287e-01 1 1  ON 21
 eO_2                 8.142333e-02 1 1  ON 22
 eO_3                 2.386450e-01 1 1  ON 23
 eO_4                 2.958356e-01 1 1  ON 24
 eO_5                 1.707490e-01 1 1  ON 25
 eO_6                -1.518372e-02 1 1  ON 26
 eO_7                -7.219695e-02 1 1  ON 27
 eO_8                -2.157287e-02 1 1  ON 28
 eO_9                -5.416197e-04 1 1  ON 29
eH1_0                -1.200227e-01 1 1  ON 30
eH1_1                -4.805099e-02 1 1  ON 31
eH1_2                -2.318772e-02 1 1  ON 32
eH1_3                 1.133575e-02 1 1  ON 33
eH1_4                 4.890070e-02 1 1  ON 34
eH1_5                 6.532442e-02 1 1  ON 35
eH1_6                 6.341804e-02 1 1  ON 36
eH1_7                 2.089315e-02 1 1  ON 37
eH1_8                -1.206385e-02 1 1  ON 38
eH1_9                -6.498110e-03 1 1  ON 39
eH2_0                -1.210797e-01 1 1  ON 40
eH2_1                -4.866872e-02 1 1  ON 41
eH2_2                -2.375807e-02 1 1  ON 42
eH2_3                 1.079231e-02 1 1  ON 43
eH2_4                 4.823042e-02 1 1  ON 44
eH2_5                 6.537224e-02 1 1  ON 45
eH2_6                 6.322383e-02 1 1  ON 46
eH2_7                 2.228976e-02 1 1  ON 47
eH2_8                -1.054179e-02 1 1  ON 48
eH2_9                -6.498721e-03 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.9102
    reference variance = 0.780716
====================================================
  Execution time = 2.0436e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6886e+01
  VMC Evar = 3.8524e-01
  Total weights = 2.0000e+06
  Execution time = 1.8823e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.388622365674
                                         uncertainty =       0.004554829455

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.388622365674
                                         uncertainty =       0.004554829455

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000441305988
  error estimate for blocks of size 2^( 2) =       0.000462463006
  error estimate for blocks of size 2^( 3) =       0.000484258722
  error estimate for blocks of size 2^( 4) =       0.000502719739
  error estimate for blocks of size 2^( 5) =       0.000517203814
  error estimate for blocks of size 2^( 6) =       0.000524451766
  error estimate for blocks of size 2^( 7) =       0.000532826620

      target function =                  N/A
              le_mean =     -16.888157072119
             les_mean =     285.599351047109
             stat err =       0.000519300485
             autocorr =       1.384706773396
              std dev =       0.624100912764
             le_variance =       0.389501949312

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.391469801374
                                         uncertainty =       0.005222155227

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.391469801374
                                         uncertainty =       0.005222155227

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000442892582
  error estimate for blocks of size 2^( 2) =       0.000457223319
  error estimate for blocks of size 2^( 3) =       0.000471622798
  error estimate for blocks of size 2^( 4) =       0.000483875912
  error estimate for blocks of size 2^( 5) =       0.000493910745
  error estimate for blocks of size 2^( 6) =       0.000499438585
  error estimate for blocks of size 2^( 7) =       0.000506572451

      target function =                  N/A
              le_mean =     -16.889403018923
             les_mean =     285.644241817764
             stat err =       0.000495949423
             autocorr =       1.253943495024
              std dev =       0.626344696091
             le_variance =       0.392307678321

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.393204065866
                                         uncertainty =       0.005234682598

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.393204065866
                                         uncertainty =       0.005234682598

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000443870128
  error estimate for blocks of size 2^( 2) =       0.000458893517
  error estimate for blocks of size 2^( 3) =       0.000474198159
  error estimate for blocks of size 2^( 4) =       0.000487386292
  error estimate for blocks of size 2^( 5) =       0.000498111949
  error estimate for blocks of size 2^( 6) =       0.000503991236
  error estimate for blocks of size 2^( 7) =       0.000511440407

      target function =                  N/A
              le_mean =     -16.888195529737
             les_mean =     285.605189434504
             stat err =       0.000500232471
             autocorr =       1.270082470574
              std dev =       0.627727154814
             le_variance =       0.394041380891

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.386309513918
                                         uncertainty =       0.004683296266

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.386309513918
                                         uncertainty =       0.004683296266

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000439988866
  error estimate for blocks of size 2^( 2) =       0.000459742161
  error estimate for blocks of size 2^( 3) =       0.000480149496
  error estimate for blocks of size 2^( 4) =       0.000497542322
  error estimate for blocks of size 2^( 5) =       0.000511280942
  error estimate for blocks of size 2^( 6) =       0.000518237339
  error estimate for blocks of size 2^( 7) =       0.000526435891

      target function =                  N/A
              le_mean =     -16.887093207758
             les_mean =     285.561097217867
             stat err =       0.000513374123
             autocorr =       1.361396330771
              std dev =       0.622238221211
             le_variance =       0.387180403936


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.888157072119        initial
     1.5625e-02     1.5625e-01             2.3063e-01       -16.889403018923  <--
     6.2500e-02     6.2500e-01             9.7202e-02       -16.888195529737
     2.5000e-01     2.5000e+00             3.3017e-02       -16.887093207758

*****************************************************************************
Applying the update for shift_i =   1.5625e-02     and shift_s =   1.5625e-01
*****************************************************************************

  Execution time = 2.9992e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 2.775278e-01 1 1  ON 0
 uu_1                 1.171817e-01 1 1  ON 1
 uu_2                 2.464831e-02 1 1  ON 2
 uu_3                -2.759698e-02 1 1  ON 3
 uu_4                -5.731895e-02 1 1  ON 4
 uu_5                -7.310033e-02 1 1  ON 5
 uu_6                -8.256839e-02 1 1  ON 6
 uu_7                -8.837972e-02 1 1  ON 7
 uu_8                -8.810705e-02 1 1  ON 8
 uu_9                -3.613043e-02 1 1  ON 9
 ud_0                 3.762651e-01 1 1  ON 10
 ud_1                 1.252126e-01 1 1  ON 11
 ud_2                 3.240688e-02 1 1  ON 12
 ud_3                -1.757991e-02 1 1  ON 13
 ud_4                -6.381558e-02 1 1  ON 14
 ud_5                -9.157304e-02 1 1  ON 15
 ud_6                -1.040470e-01 1 1  ON 16
 ud_7                -1.133479e-01 1 1  ON 17
 ud_8                -1.209499e-01 1 1  ON 18
 ud_9                -5.612492e-02 1 1  ON 19
 eO_0                -5.958773e-01 1 1  ON 20
 eO_1                -3.177775e-01 1 1  ON 21
 eO_2                 3.381004e-02 1 1  ON 22
 eO_3                 2.754271e-01 1 1  ON 23
 eO_4                 4.118230e-01 1 1  ON 24
 eO_5                 3.110841e-01 1 1  ON 25
 eO_6                 6.665347e-02 1 1  ON 26
 eO_7                -1.217104e-01 1 1  ON 27
 eO_8                -6.178257e-02 1 1  ON 28
 eO_9                -5.095687e-03 1 1  ON 29
eH1_0                -1.571392e-01 1 1  ON 30
eH1_1                -7.705903e-02 1 1  ON 31
eH1_2                -4.353058e-02 1 1  ON 32
eH1_3                -1.618944e-04 1 1  ON 33
eH1_4                 4.520130e-02 1 1  ON 34
eH1_5                 7.483240e-02 1 1  ON 35
eH1_6                 9.533371e-02 1 1  ON 36
eH1_7                 7.468325e-02 1 1  ON 37
eH1_8                 3.005049e-03 1 1  ON 38
eH1_9                -1.362267e-02 1 1  ON 39
eH2_0                -1.583441e-01 1 1  ON 40
eH2_1                -7.725695e-02 1 1  ON 41
eH2_2                -4.362145e-02 1 1  ON 42
eH2_3                 2.435889e-05 1 1  ON 43
eH2_4                 4.521145e-02 1 1  ON 44
eH2_5                 7.454665e-02 1 1  ON 45
eH2_6                 9.511070e-02 1 1  ON 46
eH2_7                 7.410285e-02 1 1  ON 47
eH2_8                 5.570775e-03 1 1  ON 48
eH2_9                -1.611443e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6446e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6866e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.9302
    reference variance = 0.317345
====================================================
  Execution time = 2.0894e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6892e+01
  VMC Evar = 3.9233e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6283e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.392323073501
                                         uncertainty =       0.004674513583

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.392323073501
                                         uncertainty =       0.004674513583

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000442905670
  error estimate for blocks of size 2^( 2) =       0.000457824118
  error estimate for blocks of size 2^( 3) =       0.000474318079
  error estimate for blocks of size 2^( 4) =       0.000488573664
  error estimate for blocks of size 2^( 5) =       0.000499258170
  error estimate for blocks of size 2^( 6) =       0.000506336368
  error estimate for blocks of size 2^( 7) =       0.000512617436

      target function =                  N/A
              le_mean =     -16.891789452214
             les_mean =     285.724881566476
             stat err =       0.000501696410
             autocorr =       1.283097050196
              std dev =       0.626363205109
             le_variance =       0.392330864715


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689178945221e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-03, overlap shift 3.9062e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.891789452214       residual = 3.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.891811816011       residual = 9.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.891896938818       residual = 2.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.891997678634       residual = 2.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.892232749194       residual = 2.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.892490329820       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.892645874323       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.892730195300       residual = 5.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.892768175746       residual = 5.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.892823312052       residual = 2.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.892855737958       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.892895306841       residual = 9.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.892914911148       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.892947355512       residual = 7.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.892963325362       residual = 6.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.893003203975       residual = 5.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.893014383446       residual = 5.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.893023154586       residual = 4.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.893038534658       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.893040609537       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.893039840276       residual = 8.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.893048901653       residual = 4.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.893052678338       residual = 9.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.893051831753       residual = 9.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.893054723903       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.893054662662       residual = 2.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.893057202674       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.893059467729       residual = 5.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.893061164532       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.893059394588       residual = 5.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         29 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-03 is 4.149324e-01

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5625e-02, overlap shift 1.5625e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.891789452214       residual = 3.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.891810682847       residual = 9.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.891889682732       residual = 2.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.891971932495       residual = 2.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.892138548709       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.892283225742       residual = 5.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.892360991411       residual = 4.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.892391979096       residual = 2.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.892405539765       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.892426569945       residual = 9.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.892433028272       residual = 5.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.892446807818       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.892451101595       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.892457636030       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.892458409080       residual = 8.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.892467098074       residual = 6.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.892469202847       residual = 4.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.892466725345       residual = 4.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.892467520070       residual = 5.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.892468072066       residual = 7.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.892467626731       residual = 2.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.892468105144       residual = 9.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         21 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-02 is 9.178443e-02

solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.891789452214       residual = 3.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.891807105003       residual = 8.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.891867860322       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.891913008035       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.891981255376       residual = 5.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.892014352322       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.892033772758       residual = 7.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.892035293479       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.892040463165       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.892040596980       residual = 7.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.892042491060       residual = 3.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.892042093645       residual = 3.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.892042861622       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.892042894387       residual = 5.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.892043056097       residual = 2.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.892042870633       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.892043503565       residual = 3.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 2.578501e-02

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.057168 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6551e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 2.928992e-01 1 1  ON 0
 uu_1                 1.305569e-01 1 1  ON 1
 uu_2                 3.444365e-02 1 1  ON 2
 uu_3                -2.359711e-02 1 1  ON 3
 uu_4                -6.291814e-02 1 1  ON 4
 uu_5                -8.783941e-02 1 1  ON 5
 uu_6                -1.038526e-01 1 1  ON 6
 uu_7                -1.052011e-01 1 1  ON 7
 uu_8                -9.794737e-02 1 1  ON 8
 uu_9                -5.492735e-02 1 1  ON 9
 ud_0                 3.940588e-01 1 1  ON 10
 ud_1                 1.413148e-01 1 1  ON 11
 ud_2                 4.606793e-02 1 1  ON 12
 ud_3                -8.775117e-03 1 1  ON 13
 ud_4                -6.326678e-02 1 1  ON 14
 ud_5                -1.005997e-01 1 1  ON 15
 ud_6                -1.208907e-01 1 1  ON 16
 ud_7                -1.275846e-01 1 1  ON 17
 ud_8                -1.312864e-01 1 1  ON 18
 ud_9                -9.282700e-02 1 1  ON 19
 eO_0                -6.649851e-01 1 1  ON 20
 eO_1                -3.796950e-01 1 1  ON 21
 eO_2                -1.007854e-02 1 1  ON 22
 eO_3                 2.686630e-01 1 1  ON 23
 eO_4                 4.619321e-01 1 1  ON 24
 eO_5                 3.937725e-01 1 1  ON 25
 eO_6                 1.584379e-01 1 1  ON 26
 eO_7                -1.101517e-01 1 1  ON 27
 eO_8                -1.115267e-01 1 1  ON 28
 eO_9                -1.192899e-02 1 1  ON 29
eH1_0                -1.814904e-01 1 1  ON 30
eH1_1                -1.006291e-01 1 1  ON 31
eH1_2                -6.369059e-02 1 1  ON 32
eH1_3                -1.519316e-02 1 1  ON 33
eH1_4                 3.168371e-02 1 1  ON 34
eH1_5                 6.474307e-02 1 1  ON 35
eH1_6                 1.012328e-01 1 1  ON 36
eH1_7                 1.216568e-01 1 1  ON 37
eH1_8                 5.336020e-02 1 1  ON 38
eH1_9                -1.105336e-02 1 1  ON 39
eH2_0                -1.794230e-01 1 1  ON 40
eH2_1                -9.751646e-02 1 1  ON 41
eH2_2                -6.102766e-02 1 1  ON 42
eH2_3                -1.344414e-02 1 1  ON 43
eH2_4                 3.468530e-02 1 1  ON 44
eH2_5                 6.460304e-02 1 1  ON 45
eH2_6                 1.020339e-01 1 1  ON 46
eH2_7                 1.172608e-01 1 1  ON 47
eH2_8                 5.142684e-02 1 1  ON 48
eH2_9                -1.733251e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.9676
    reference variance = 0.210834
====================================================
  Execution time = 2.0661e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6893e+01
  VMC Evar = 3.9740e-01
  Total weights = 2.0000e+06
  Execution time = 1.8937e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.392209651640
                                         uncertainty =       0.007800944361

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.392209651640
                                         uncertainty =       0.007800944361

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000442916996
  error estimate for blocks of size 2^( 2) =       0.000457875960
  error estimate for blocks of size 2^( 3) =       0.000472612021
  error estimate for blocks of size 2^( 4) =       0.000487148957
  error estimate for blocks of size 2^( 5) =       0.000498921964
  error estimate for blocks of size 2^( 6) =       0.000508798271
  error estimate for blocks of size 2^( 7) =       0.000512104273

      target function =                  N/A
              le_mean =     -16.893945215970
             les_mean =     285.797735694557
             stat err =       0.000501743366
             autocorr =       1.283271611979
              std dev =       0.626379222638
             le_variance =       0.392350930552

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434061934257
                                         uncertainty =       0.008114520452

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434061934257
                                         uncertainty =       0.008114520452

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465934531
  error estimate for blocks of size 2^( 2) =       0.000481474333
  error estimate for blocks of size 2^( 3) =       0.000495735984
  error estimate for blocks of size 2^( 4) =       0.000508915601
  error estimate for blocks of size 2^( 5) =       0.000519254012
  error estimate for blocks of size 2^( 6) =       0.000527983810
  error estimate for blocks of size 2^( 7) =       0.000530097227

      target function =                  N/A
              le_mean =     -16.899645626027
             les_mean =     286.032212043071
             stat err =       0.000521562662
             autocorr =       1.253034968666
              std dev =       0.658930933308
             le_variance =       0.434189974870

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.405695717280
                                         uncertainty =       0.007955597165

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.405695717280
                                         uncertainty =       0.007955597165

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000450459371
  error estimate for blocks of size 2^( 2) =       0.000464678307
  error estimate for blocks of size 2^( 3) =       0.000478115741
  error estimate for blocks of size 2^( 4) =       0.000491193922
  error estimate for blocks of size 2^( 5) =       0.000501920262
  error estimate for blocks of size 2^( 6) =       0.000511126634
  error estimate for blocks of size 2^( 7) =       0.000513721816

      target function =                  N/A
              le_mean =     -16.894046737818
             les_mean =     285.814642266948
             stat err =       0.000504490659
             autocorr =       1.254281467295
              std dev =       0.637045752123
             le_variance =       0.405827290298

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.393546335342
                                         uncertainty =       0.007822196160

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.393546335342
                                         uncertainty =       0.007822196160

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000443669823
  error estimate for blocks of size 2^( 2) =       0.000458391953
  error estimate for blocks of size 2^( 3) =       0.000472800508
  error estimate for blocks of size 2^( 4) =       0.000487018790
  error estimate for blocks of size 2^( 5) =       0.000498599706
  error estimate for blocks of size 2^( 6) =       0.000508364749
  error estimate for blocks of size 2^( 7) =       0.000511552540

      target function =                  N/A
              le_mean =     -16.893659948316
             les_mean =     285.789432075312
             stat err =       0.000501383946
             autocorr =       1.277088717314
              std dev =       0.627443880209
             le_variance =       0.393685822811


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.893945215970        initial
            N/A            N/A                    N/A                    N/A     bad update
     1.5625e-02     1.5625e-01             9.1784e-02       -16.894046737818  <--
     6.2500e-02     6.2500e-01             2.5785e-02       -16.893659948316

*****************************************************************************
Applying the update for shift_i =   1.5625e-02     and shift_s =   1.5625e-01
*****************************************************************************

  Execution time = 3.0243e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 2.928992e-01 1 1  ON 0
 uu_1                 1.305569e-01 1 1  ON 1
 uu_2                 3.444365e-02 1 1  ON 2
 uu_3                -2.359711e-02 1 1  ON 3
 uu_4                -6.291814e-02 1 1  ON 4
 uu_5                -8.783941e-02 1 1  ON 5
 uu_6                -1.038526e-01 1 1  ON 6
 uu_7                -1.052011e-01 1 1  ON 7
 uu_8                -9.794737e-02 1 1  ON 8
 uu_9                -5.492735e-02 1 1  ON 9
 ud_0                 3.940588e-01 1 1  ON 10
 ud_1                 1.413148e-01 1 1  ON 11
 ud_2                 4.606793e-02 1 1  ON 12
 ud_3                -8.775117e-03 1 1  ON 13
 ud_4                -6.326678e-02 1 1  ON 14
 ud_5                -1.005997e-01 1 1  ON 15
 ud_6                -1.208907e-01 1 1  ON 16
 ud_7                -1.275846e-01 1 1  ON 17
 ud_8                -1.312864e-01 1 1  ON 18
 ud_9                -9.282700e-02 1 1  ON 19
 eO_0                -6.649851e-01 1 1  ON 20
 eO_1                -3.796950e-01 1 1  ON 21
 eO_2                -1.007854e-02 1 1  ON 22
 eO_3                 2.686630e-01 1 1  ON 23
 eO_4                 4.619321e-01 1 1  ON 24
 eO_5                 3.937725e-01 1 1  ON 25
 eO_6                 1.584379e-01 1 1  ON 26
 eO_7                -1.101517e-01 1 1  ON 27
 eO_8                -1.115267e-01 1 1  ON 28
 eO_9                -1.192899e-02 1 1  ON 29
eH1_0                -1.814904e-01 1 1  ON 30
eH1_1                -1.006291e-01 1 1  ON 31
eH1_2                -6.369059e-02 1 1  ON 32
eH1_3                -1.519316e-02 1 1  ON 33
eH1_4                 3.168371e-02 1 1  ON 34
eH1_5                 6.474307e-02 1 1  ON 35
eH1_6                 1.012328e-01 1 1  ON 36
eH1_7                 1.216568e-01 1 1  ON 37
eH1_8                 5.336020e-02 1 1  ON 38
eH1_9                -1.105336e-02 1 1  ON 39
eH2_0                -1.794230e-01 1 1  ON 40
eH2_1                -9.751646e-02 1 1  ON 41
eH2_2                -6.102766e-02 1 1  ON 42
eH2_3                -1.344414e-02 1 1  ON 43
eH2_4                 3.468530e-02 1 1  ON 44
eH2_5                 6.460304e-02 1 1  ON 45
eH2_6                 1.020339e-01 1 1  ON 46
eH2_7                 1.172608e-01 1 1  ON 47
eH2_8                 5.142684e-02 1 1  ON 48
eH2_9                -1.733251e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6800e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6887e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.848
    reference variance = 0.343368
====================================================
  Execution time = 2.0731e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6893e+01
  VMC Evar = 3.8576e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5639e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.385661922007
                                         uncertainty =       0.003601667653

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.385661922007
                                         uncertainty =       0.003601667653

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000439178392
  error estimate for blocks of size 2^( 2) =       0.000453852380
  error estimate for blocks of size 2^( 3) =       0.000468167026
  error estimate for blocks of size 2^( 4) =       0.000480812493
  error estimate for blocks of size 2^( 5) =       0.000491882284
  error estimate for blocks of size 2^( 6) =       0.000499082738
  error estimate for blocks of size 2^( 7) =       0.000505530346

      target function =                  N/A
              le_mean =     -16.892893942788
             les_mean =     285.755620888600
             stat err =       0.000494326965
             autocorr =       1.266912659140
              std dev =       0.621092037619
             le_variance =       0.385755319194


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689289394279e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-03, overlap shift 3.9062e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.892893942788       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.892897475225       residual = 2.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.892913556452       residual = 2.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.892922658805       residual = 3.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.892944570439       residual = 2.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.892970492559       residual = 3.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.892996774496       residual = 3.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.893050885627       residual = 2.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.893094732410       residual = 3.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.893139711792       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.893166087432       residual = 9.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.893185745629       residual = 9.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.893196236729       residual = 6.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.893204522123       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.893214716095       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.893215039386       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.893228134989       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.893246133738       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.893246026592       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.893245409388       residual = 3.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.893244548681       residual = 2.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.893246153000       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.893248711334       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.893247671189       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.893246046338       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.893246911767       residual = 7.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.893249198398       residual = 8.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.893248274452       residual = 2.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.893248328660       residual = 6.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         28 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-03 is 9.834136e-02

solving harmonic davidson linear method for identity shift 1.5625e-02, overlap shift 1.5625e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.892893942788       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.892897182772       residual = 2.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.892911628737       residual = 2.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.892919360839       residual = 3.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.892938037294       residual = 2.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.892958650561       residual = 2.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.892977087671       residual = 2.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.893007208226       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.893032616169       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.893048394713       residual = 6.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.893054927232       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.893057608569       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.893057967825       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.893058994550       residual = 3.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.893062024842       residual = 2.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.893060331567       residual = 2.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.893065299789       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.893065887166       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.893065683655       residual = 5.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.893064788621       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.893064717800       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.893064911376       residual = 4.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         21 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-02 is 3.295770e-02

solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.892893942788       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.892896376737       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.892907027346       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.892912060315       residual = 3.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.892923316726       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.892934358484       residual = 8.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.892940303184       residual = 7.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.892947083574       residual = 3.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.892953568710       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.892954509635       residual = 7.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.892955454955       residual = 3.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.892953941733       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.892953566915       residual = 4.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.892953502889       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.892953990847       residual = 9.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 1.091723e-02

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.076189 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6323e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 2.984198e-01 1 1  ON 0
 uu_1                 1.357173e-01 1 1  ON 1
 uu_2                 3.893277e-02 1 1  ON 2
 uu_3                -1.983086e-02 1 1  ON 3
 uu_4                -6.082798e-02 1 1  ON 4
 uu_5                -8.911835e-02 1 1  ON 5
 uu_6                -1.088093e-01 1 1  ON 6
 uu_7                -1.141446e-01 1 1  ON 7
 uu_8                -1.054221e-01 1 1  ON 8
 uu_9                -7.054245e-02 1 1  ON 9
 ud_0                 4.023596e-01 1 1  ON 10
 ud_1                 1.494535e-01 1 1  ON 11
 ud_2                 5.309637e-02 1 1  ON 12
 ud_3                -3.486650e-03 1 1  ON 13
 ud_4                -6.048246e-02 1 1  ON 14
 ud_5                -1.005941e-01 1 1  ON 15
 ud_6                -1.237303e-01 1 1  ON 16
 ud_7                -1.334035e-01 1 1  ON 17
 ud_8                -1.365668e-01 1 1  ON 18
 ud_9                -1.138441e-01 1 1  ON 19
 eO_0                -6.848606e-01 1 1  ON 20
 eO_1                -3.973931e-01 1 1  ON 21
 eO_2                -2.134718e-02 1 1  ON 22
 eO_3                 2.665136e-01 1 1  ON 23
 eO_4                 4.725614e-01 1 1  ON 24
 eO_5                 4.199821e-01 1 1  ON 25
 eO_6                 1.913956e-01 1 1  ON 26
 eO_7                -9.061057e-02 1 1  ON 27
 eO_8                -1.398043e-01 1 1  ON 28
 eO_9                -2.182985e-02 1 1  ON 29
eH1_0                -1.890383e-01 1 1  ON 30
eH1_1                -1.069238e-01 1 1  ON 31
eH1_2                -6.951136e-02 1 1  ON 32
eH1_3                -2.080797e-02 1 1  ON 33
eH1_4                 2.590864e-02 1 1  ON 34
eH1_5                 5.898735e-02 1 1  ON 35
eH1_6                 9.901045e-02 1 1  ON 36
eH1_7                 1.280886e-01 1 1  ON 37
eH1_8                 8.259486e-02 1 1  ON 38
eH1_9                -5.718718e-03 1 1  ON 39
eH2_0                -1.881214e-01 1 1  ON 40
eH2_1                -1.063489e-01 1 1  ON 41
eH2_2                -6.877514e-02 1 1  ON 42
eH2_3                -1.991051e-02 1 1  ON 43
eH2_4                 2.767134e-02 1 1  ON 44
eH2_5                 6.019105e-02 1 1  ON 45
eH2_6                 1.028204e-01 1 1  ON 46
eH2_7                 1.319736e-01 1 1  ON 47
eH2_8                 8.315450e-02 1 1  ON 48
eH2_9                -1.647382e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.9099
    reference variance = 0.494859
====================================================
  Execution time = 2.0691e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6894e+01
  VMC Evar = 4.1365e-01
  Total weights = 2.0000e+06
  Execution time = 1.9046e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.412455501323
                                         uncertainty =       0.018425815490

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.412455501323
                                         uncertainty =       0.018425815490

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000454059181
  error estimate for blocks of size 2^( 2) =       0.000468594327
  error estimate for blocks of size 2^( 3) =       0.000482879139
  error estimate for blocks of size 2^( 4) =       0.000495824878
  error estimate for blocks of size 2^( 5) =       0.000505122410
  error estimate for blocks of size 2^( 6) =       0.000511873442
  error estimate for blocks of size 2^( 7) =       0.000515733847

      target function =                  N/A
              le_mean =     -16.893600989937
             les_mean =     285.806093680023
             stat err =       0.000507138644
             autocorr =       1.247465340217
              std dev =       0.642136651350
             le_variance =       0.412339479007

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.416302108510
                                         uncertainty =       0.019003144821

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.416302108510
                                         uncertainty =       0.019003144821

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000456169257
  error estimate for blocks of size 2^( 2) =       0.000470432528
  error estimate for blocks of size 2^( 3) =       0.000484265479
  error estimate for blocks of size 2^( 4) =       0.000496729170
  error estimate for blocks of size 2^( 5) =       0.000505609368
  error estimate for blocks of size 2^( 6) =       0.000512089155
  error estimate for blocks of size 2^( 7) =       0.000515957419

      target function =                  N/A
              le_mean =     -16.893637818513
             les_mean =     285.811179316257
             stat err =       0.000507596278
             autocorr =       1.238182988129
              std dev =       0.645120749357
             le_variance =       0.416180781251

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.415524627852
                                         uncertainty =       0.018951556726

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.415524627852
                                         uncertainty =       0.018951556726

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000455743706
  error estimate for blocks of size 2^( 2) =       0.000470035641
  error estimate for blocks of size 2^( 3) =       0.000483927231
  error estimate for blocks of size 2^( 4) =       0.000496460390
  error estimate for blocks of size 2^( 5) =       0.000505421048
  error estimate for blocks of size 2^( 6) =       0.000511977661
  error estimate for blocks of size 2^( 7) =       0.000515938143

      target function =                  N/A
              le_mean =     -16.893594537096
             les_mean =     285.808940827778
             stat err =       0.000507449311
             autocorr =       1.239778137802
              std dev =       0.644518930423
             le_variance =       0.415404651673

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.412624327616
                                         uncertainty =       0.018515143690

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.412624327616
                                         uncertainty =       0.018515143690

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000454151852
  error estimate for blocks of size 2^( 2) =       0.000468629387
  error estimate for blocks of size 2^( 3) =       0.000482830033
  error estimate for blocks of size 2^( 4) =       0.000495691188
  error estimate for blocks of size 2^( 5) =       0.000504922431
  error estimate for blocks of size 2^( 6) =       0.000511645350
  error estimate for blocks of size 2^( 7) =       0.000515534391

      target function =                  N/A
              le_mean =     -16.893547391329
             les_mean =     285.804451065541
             stat err =       0.000506948340
             autocorr =       1.246020628830
              std dev =       0.642267707975
             le_variance =       0.412507808707


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.893600989937        initial
     3.9062e-03     3.9062e-02             9.8341e-02       -16.893637818513  <--
     1.5625e-02     1.5625e-01             3.2958e-02       -16.893594537096
     6.2500e-02     6.2500e-01             1.0917e-02       -16.893547391329

*****************************************************************************
Applying the update for shift_i =   3.9062e-03     and shift_s =   3.9062e-02
*****************************************************************************

  Execution time = 3.0306e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.028772e-01 1 1  ON 0
 uu_1                 1.394319e-01 1 1  ON 1
 uu_2                 4.165689e-02 1 1  ON 2
 uu_3                -1.870341e-02 1 1  ON 3
 uu_4                -6.223442e-02 1 1  ON 4
 uu_5                -9.450477e-02 1 1  ON 5
 uu_6                -1.189056e-01 1 1  ON 6
 uu_7                -1.296091e-01 1 1  ON 7
 uu_8                -1.198588e-01 1 1  ON 8
 uu_9                -9.418924e-02 1 1  ON 9
 ud_0                 4.121607e-01 1 1  ON 10
 ud_1                 1.588173e-01 1 1  ON 11
 ud_2                 6.135506e-02 1 1  ON 12
 ud_3                 2.935740e-03 1 1  ON 13
 ud_4                -5.683434e-02 1 1  ON 14
 ud_5                -1.008499e-01 1 1  ON 15
 ud_6                -1.280916e-01 1 1  ON 16
 ud_7                -1.429558e-01 1 1  ON 17
 ud_8                -1.434470e-01 1 1  ON 18
 ud_9                -1.366312e-01 1 1  ON 19
 eO_0                -7.037962e-01 1 1  ON 20
 eO_1                -4.133723e-01 1 1  ON 21
 eO_2                -3.084689e-02 1 1  ON 22
 eO_3                 2.689953e-01 1 1  ON 23
 eO_4                 4.910624e-01 1 1  ON 24
 eO_5                 4.578008e-01 1 1  ON 25
 eO_6                 2.351166e-01 1 1  ON 26
 eO_7                -5.767876e-02 1 1  ON 27
 eO_8                -1.944339e-01 1 1  ON 28
 eO_9                -5.599059e-02 1 1  ON 29
eH1_0                -2.078290e-01 1 1  ON 30
eH1_1                -1.250792e-01 1 1  ON 31
eH1_2                -8.645301e-02 1 1  ON 32
eH1_3                -3.641075e-02 1 1  ON 33
eH1_4                 1.177113e-02 1 1  ON 34
eH1_5                 4.451983e-02 1 1  ON 35
eH1_6                 9.402029e-02 1 1  ON 36
eH1_7                 1.367795e-01 1 1  ON 37
eH1_8                 1.435115e-01 1 1  ON 38
eH1_9                 3.026808e-02 1 1  ON 39
eH2_0                -2.067175e-01 1 1  ON 40
eH2_1                -1.246848e-01 1 1  ON 41
eH2_2                -8.573133e-02 1 1  ON 42
eH2_3                -3.514790e-02 1 1  ON 43
eH2_4                 1.387487e-02 1 1  ON 44
eH2_5                 4.818069e-02 1 1  ON 45
eH2_6                 1.012092e-01 1 1  ON 46
eH2_7                 1.499438e-01 1 1  ON 47
eH2_8                 1.497682e-01 1 1  ON 48
eH2_9                 8.501773e-03 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6634e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6885e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.8671
    reference variance = 0.291381
====================================================
  Execution time = 2.0897e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6894e+01
  VMC Evar = 4.2817e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5806e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.428301324423
                                         uncertainty =       0.037056115223

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.428301324423
                                         uncertainty =       0.037056115223

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000462693557
  error estimate for blocks of size 2^( 2) =       0.000476770878
  error estimate for blocks of size 2^( 3) =       0.000490930598
  error estimate for blocks of size 2^( 4) =       0.000505122755
  error estimate for blocks of size 2^( 5) =       0.000517399246
  error estimate for blocks of size 2^( 6) =       0.000528350569
  error estimate for blocks of size 2^( 7) =       0.000532547383

      target function =                  N/A
              le_mean =     -16.893747231857
             les_mean =     285.826865974764
             stat err =       0.000520854988
             autocorr =       1.267204633403
              std dev =       0.654347503223
             le_variance =       0.428170654974


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689374723186e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-04, overlap shift 9.7656e-03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.893747231857       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.893749812610       residual = 9.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.893753246006       residual = 8.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.893747654751       residual = 9.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.893755316114       residual = 3.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.893764549104       residual = 4.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.893769917274       residual = 4.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.893776890563       residual = 4.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.893776545201       residual = 4.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.893792157628       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.893798959804       residual = 3.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.893822611588       residual = 6.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.893842830286       residual = 5.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.893850142018       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.893859168485       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.893867402779       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.893873551005       residual = 4.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.893893046160       residual = 3.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.893908371493       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.893916021820       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.893917287554       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.893918459760       residual = 4.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.893921065189       residual = 5.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.893919075484       residual = 5.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.893920042653       residual = 7.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.893924823710       residual = 4.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.893927171555       residual = 6.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.893931860136       residual = 2.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.893929970610       residual = 9.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.893933680943       residual = 6.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.893936929479       residual = 4.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.893937637598       residual = 3.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -16.893936132144       residual = 2.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -16.893937483468       residual = 3.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -16.893939300973       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -16.893940445153       residual = 5.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         35 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-04 is 3.512914e-01

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e-03, overlap shift 3.9062e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.893747231857       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.893749766083       residual = 9.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.893753074067       residual = 8.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.893747590560       residual = 8.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.893755059280       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.893764090874       residual = 3.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.893768819686       residual = 3.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.893774940000       residual = 3.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.893774622869       residual = 3.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.893788059760       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.893792967343       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.893809513912       residual = 4.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.893821010663       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.893824041634       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.893828528209       residual = 7.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.893831390050       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.893831474402       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.893838432170       residual = 9.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.893842574936       residual = 5.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.893844281524       residual = 2.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.893843555237       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.893842885650       residual = 8.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.893842855110       residual = 7.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.893841319280       residual = 5.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.893841553392       residual = 8.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.893842024038       residual = 3.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.893841835815       residual = 4.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.893842325868       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.893841656066       residual = 4.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         28 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-03 is 8.858429e-02

solving harmonic davidson linear method for identity shift 1.5625e-02, overlap shift 1.5625e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.893747231857       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.893749595622       residual = 8.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.893752472596       residual = 7.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.893747385712       residual = 7.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.893754249312       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.893762526819       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.893765231905       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.893768954306       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.893769231839       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.893777200047       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.893778554008       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.893784470732       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.893787067807       residual = 5.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.893786930955       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.893787811417       residual = 9.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.893787591918       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.893787065010       residual = 9.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.893787558888       residual = 4.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.893788351988       residual = 2.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.893788177567       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.893788089316       residual = 7.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         20 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-02 is 2.068407e-02

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.112579 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6523e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 2.966780e-01 1 1  ON 0
 uu_1                 1.333754e-01 1 1  ON 1
 uu_2                 3.519329e-02 1 1  ON 2
 uu_3                -2.650780e-02 1 1  ON 3
 uu_4                -7.087626e-02 1 1  ON 4
 uu_5                -1.050409e-01 1 1  ON 5
 uu_6                -1.316965e-01 1 1  ON 6
 uu_7                -1.417689e-01 1 1  ON 7
 uu_8                -1.321206e-01 1 1  ON 8
 uu_9                -9.943431e-02 1 1  ON 9
 ud_0                 4.106432e-01 1 1  ON 10
 ud_1                 1.576013e-01 1 1  ON 11
 ud_2                 6.036367e-02 1 1  ON 12
 ud_3                 2.137923e-03 1 1  ON 13
 ud_4                -5.824528e-02 1 1  ON 14
 ud_5                -1.045079e-01 1 1  ON 15
 ud_6                -1.347381e-01 1 1  ON 16
 ud_7                -1.526361e-01 1 1  ON 17
 ud_8                -1.509982e-01 1 1  ON 18
 ud_9                -1.320634e-01 1 1  ON 19
 eO_0                -7.007639e-01 1 1  ON 20
 eO_1                -4.097142e-01 1 1  ON 21
 eO_2                -2.700368e-02 1 1  ON 22
 eO_3                 2.759641e-01 1 1  ON 23
 eO_4                 5.014016e-01 1 1  ON 24
 eO_5                 4.748800e-01 1 1  ON 25
 eO_6                 2.525832e-01 1 1  ON 26
 eO_7                -4.767809e-02 1 1  ON 27
 eO_8                -2.217334e-01 1 1  ON 28
 eO_9                -9.387477e-02 1 1  ON 29
eH1_0                -2.303570e-01 1 1  ON 30
eH1_1                -1.492063e-01 1 1  ON 31
eH1_2                -1.096796e-01 1 1  ON 32
eH1_3                -5.794193e-02 1 1  ON 33
eH1_4                -6.412084e-03 1 1  ON 34
eH1_5                 2.967336e-02 1 1  ON 35
eH1_6                 9.168901e-02 1 1  ON 36
eH1_7                 1.488878e-01 1 1  ON 37
eH1_8                 1.851082e-01 1 1  ON 38
eH1_9                 9.357857e-02 1 1  ON 39
eH2_0                -2.332413e-01 1 1  ON 40
eH2_1                -1.497749e-01 1 1  ON 41
eH2_2                -1.108722e-01 1 1  ON 42
eH2_3                -5.947395e-02 1 1  ON 43
eH2_4                -8.008694e-03 1 1  ON 44
eH2_5                 2.986249e-02 1 1  ON 45
eH2_6                 9.228198e-02 1 1  ON 46
eH2_7                 1.498496e-01 1 1  ON 47
eH2_8                 1.934986e-01 1 1  ON 48
eH2_9                 9.708607e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.8908
    reference variance = 0.245968
====================================================
  Execution time = 2.0681e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6894e+01
  VMC Evar = 3.8998e-01
  Total weights = 2.0000e+06
  Execution time = 1.8903e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.389272285472
                                         uncertainty =       0.004134851447

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.389272285472
                                         uncertainty =       0.004134851447

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000441135881
  error estimate for blocks of size 2^( 2) =       0.000455322650
  error estimate for blocks of size 2^( 3) =       0.000469103473
  error estimate for blocks of size 2^( 4) =       0.000481086462
  error estimate for blocks of size 2^( 5) =       0.000490730565
  error estimate for blocks of size 2^( 6) =       0.000496157644
  error estimate for blocks of size 2^( 7) =       0.000502126781

      target function =                  N/A
              le_mean =     -16.894157289408
             les_mean =     285.801752056461
             stat err =       0.000492525363
             autocorr =       1.246557829621
              std dev =       0.623860346406
             le_variance =       0.389201731818

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.391123230495
                                         uncertainty =       0.004137519681

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.391123230495
                                         uncertainty =       0.004137519681

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000442184554
  error estimate for blocks of size 2^( 2) =       0.000456480623
  error estimate for blocks of size 2^( 3) =       0.000470295916
  error estimate for blocks of size 2^( 4) =       0.000482166679
  error estimate for blocks of size 2^( 5) =       0.000491514430
  error estimate for blocks of size 2^( 6) =       0.000496728355
  error estimate for blocks of size 2^( 7) =       0.000501956248

      target function =                  N/A
              le_mean =     -16.894230837822
             les_mean =     285.806089764892
             stat err =       0.000493091428
             autocorr =       1.243505670431
              std dev =       0.625343392715
             le_variance =       0.391054358812

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.391082788213
                                         uncertainty =       0.004157008079

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.391082788213
                                         uncertainty =       0.004157008079

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000442160932
  error estimate for blocks of size 2^( 2) =       0.000456497287
  error estimate for blocks of size 2^( 3) =       0.000470356367
  error estimate for blocks of size 2^( 4) =       0.000482305188
  error estimate for blocks of size 2^( 5) =       0.000491738338
  error estimate for blocks of size 2^( 6) =       0.000496990851
  error estimate for blocks of size 2^( 7) =       0.000502413033

      target function =                  N/A
              le_mean =     -16.894119357419
             les_mean =     285.802281246532
             stat err =       0.000493361852
             autocorr =       1.245003001557
              std dev =       0.625309986590
             le_variance =       0.391012579330

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.389516845820
                                         uncertainty =       0.004140960524

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.389516845820
                                         uncertainty =       0.004140960524

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000441274421
  error estimate for blocks of size 2^( 2) =       0.000455493021
  error estimate for blocks of size 2^( 3) =       0.000469290385
  error estimate for blocks of size 2^( 4) =       0.000481265793
  error estimate for blocks of size 2^( 5) =       0.000490863839
  error estimate for blocks of size 2^( 6) =       0.000496250284
  error estimate for blocks of size 2^( 7) =       0.000502100098

      target function =                  N/A
              le_mean =     -16.894103169951
             les_mean =     285.800167951080
             stat err =       0.000492620003
             autocorr =       1.246254039011
              std dev =       0.624056270580
             le_variance =       0.389446228850


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.894157289408        initial  <--
            N/A            N/A                    N/A                    N/A     bad update
     3.9062e-03     3.9062e-02             8.8584e-02       -16.894119357419
     1.5625e-02     1.5625e-01             2.0684e-02       -16.894103169951

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.3593
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.028772e-01 1 1  ON 0
 uu_1                 1.394319e-01 1 1  ON 1
 uu_2                 4.165689e-02 1 1  ON 2
 uu_3                -1.870341e-02 1 1  ON 3
 uu_4                -6.223442e-02 1 1  ON 4
 uu_5                -9.450477e-02 1 1  ON 5
 uu_6                -1.189056e-01 1 1  ON 6
 uu_7                -1.296091e-01 1 1  ON 7
 uu_8                -1.198588e-01 1 1  ON 8
 uu_9                -9.418924e-02 1 1  ON 9
 ud_0                 4.121607e-01 1 1  ON 10
 ud_1                 1.588173e-01 1 1  ON 11
 ud_2                 6.135506e-02 1 1  ON 12
 ud_3                 2.935740e-03 1 1  ON 13
 ud_4                -5.683434e-02 1 1  ON 14
 ud_5                -1.008499e-01 1 1  ON 15
 ud_6                -1.280916e-01 1 1  ON 16
 ud_7                -1.429558e-01 1 1  ON 17
 ud_8                -1.434470e-01 1 1  ON 18
 ud_9                -1.366312e-01 1 1  ON 19
 eO_0                -7.037962e-01 1 1  ON 20
 eO_1                -4.133723e-01 1 1  ON 21
 eO_2                -3.084689e-02 1 1  ON 22
 eO_3                 2.689953e-01 1 1  ON 23
 eO_4                 4.910624e-01 1 1  ON 24
 eO_5                 4.578008e-01 1 1  ON 25
 eO_6                 2.351166e-01 1 1  ON 26
 eO_7                -5.767876e-02 1 1  ON 27
 eO_8                -1.944339e-01 1 1  ON 28
 eO_9                -5.599059e-02 1 1  ON 29
eH1_0                -2.078290e-01 1 1  ON 30
eH1_1                -1.250792e-01 1 1  ON 31
eH1_2                -8.645301e-02 1 1  ON 32
eH1_3                -3.641075e-02 1 1  ON 33
eH1_4                 1.177113e-02 1 1  ON 34
eH1_5                 4.451983e-02 1 1  ON 35
eH1_6                 9.402029e-02 1 1  ON 36
eH1_7                 1.367795e-01 1 1  ON 37
eH1_8                 1.435115e-01 1 1  ON 38
eH1_9                 3.026808e-02 1 1  ON 39
eH2_0                -2.067175e-01 1 1  ON 40
eH2_1                -1.246848e-01 1 1  ON 41
eH2_2                -8.573133e-02 1 1  ON 42
eH2_3                -3.514790e-02 1 1  ON 43
eH2_4                 1.387487e-02 1 1  ON 44
eH2_5                 4.818069e-02 1 1  ON 45
eH2_6                 1.012092e-01 1 1  ON 46
eH2_7                 1.499438e-01 1 1  ON 47
eH2_8                 1.497682e-01 1 1  ON 48
eH2_9                 8.501773e-03 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6888e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6884e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.8481
    reference variance = 0.242562
====================================================
  Execution time = 2.2979e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6894e+01
  VMC Evar = 3.9802e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5837e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.397773760739
                                         uncertainty =       0.006967091357

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.397773760739
                                         uncertainty =       0.006967091357

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000446104911
  error estimate for blocks of size 2^( 2) =       0.000460448700
  error estimate for blocks of size 2^( 3) =       0.000474724868
  error estimate for blocks of size 2^( 4) =       0.000487227381
  error estimate for blocks of size 2^( 5) =       0.000496751052
  error estimate for blocks of size 2^( 6) =       0.000502899027
  error estimate for blocks of size 2^( 7) =       0.000508701036

      target function =                  N/A
              le_mean =     -16.894016128579
             les_mean =     285.805799937584
             stat err =       0.000498894624
             autocorr =       1.250672610944
              std dev =       0.630887615919
             le_variance =       0.398019183921


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689401612858e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-03, overlap shift 9.7656e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.894016128579       residual = 5.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.894017627769       residual = 4.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.894022545704       residual = 5.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.894019938793       residual = 4.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.894024067061       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.894025725498       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.894025087936       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.894025924130       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.894027316264       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.894036952723       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.894040838737       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.894048484734       residual = 6.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.894048012993       residual = 6.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.894049989371       residual = 2.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.894050460959       residual = 2.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.894051385975       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.894053503459       residual = 8.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.894053798825       residual = 7.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.894051875450       residual = 3.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.894052792794       residual = 4.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.894052696993       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.894051977491       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.894051490721       residual = 5.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         22 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-03 is 2.775582e-02

solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.894016128579       residual = 5.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.894017430092       residual = 4.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.894021538908       residual = 4.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.894019510646       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.894022869792       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.894024178922       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.894023081878       residual = 8.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.894023414740       residual = 6.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.894025794009       residual = 7.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.894028228953       residual = 4.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.894028304006       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.894029455931       residual = 5.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.894029429729       residual = 4.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.894029444033       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.894029284363       residual = 7.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-02 is 6.974871e-03

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.894016128579       residual = 5.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.894016980675       residual = 4.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.894019570338       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.894018438971       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.894020501637       residual = 8.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.894020569483       residual = 5.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.894020165152       residual = 2.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.894020587632       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.894020509294       residual = 4.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.894021280035       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.894021182168       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.894021201136       residual = 2.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 1.779243e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.123251 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8582e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.030608e-01 1 1  ON 0
 uu_1                 1.392655e-01 1 1  ON 1
 uu_2                 4.169046e-02 1 1  ON 2
 uu_3                -1.927483e-02 1 1  ON 3
 uu_4                -6.308087e-02 1 1  ON 4
 uu_5                -9.543911e-02 1 1  ON 5
 uu_6                -1.206151e-01 1 1  ON 6
 uu_7                -1.301914e-01 1 1  ON 7
 uu_8                -1.218550e-01 1 1  ON 8
 uu_9                -9.436642e-02 1 1  ON 9
 ud_0                 4.118701e-01 1 1  ON 10
 ud_1                 1.584736e-01 1 1  ON 11
 ud_2                 6.126850e-02 1 1  ON 12
 ud_3                 3.131757e-03 1 1  ON 13
 ud_4                -5.668805e-02 1 1  ON 14
 ud_5                -1.011780e-01 1 1  ON 15
 ud_6                -1.289349e-01 1 1  ON 16
 ud_7                -1.440274e-01 1 1  ON 17
 ud_8                -1.433748e-01 1 1  ON 18
 ud_9                -1.345391e-01 1 1  ON 19
 eO_0                -7.031615e-01 1 1  ON 20
 eO_1                -4.127072e-01 1 1  ON 21
 eO_2                -3.160487e-02 1 1  ON 22
 eO_3                 2.681087e-01 1 1  ON 23
 eO_4                 4.916824e-01 1 1  ON 24
 eO_5                 4.594589e-01 1 1  ON 25
 eO_6                 2.370837e-01 1 1  ON 26
 eO_7                -5.451859e-02 1 1  ON 27
 eO_8                -1.977045e-01 1 1  ON 28
 eO_9                -5.924380e-02 1 1  ON 29
eH1_0                -2.100094e-01 1 1  ON 30
eH1_1                -1.286476e-01 1 1  ON 31
eH1_2                -8.934220e-02 1 1  ON 32
eH1_3                -3.850975e-02 1 1  ON 33
eH1_4                 1.184152e-02 1 1  ON 34
eH1_5                 4.439276e-02 1 1  ON 35
eH1_6                 9.475868e-02 1 1  ON 36
eH1_7                 1.392052e-01 1 1  ON 37
eH1_8                 1.471667e-01 1 1  ON 38
eH1_9                 3.406669e-02 1 1  ON 39
eH2_0                -2.092274e-01 1 1  ON 40
eH2_1                -1.269576e-01 1 1  ON 41
eH2_2                -8.781692e-02 1 1  ON 42
eH2_3                -3.671737e-02 1 1  ON 43
eH2_4                 1.304451e-02 1 1  ON 44
eH2_5                 4.680643e-02 1 1  ON 45
eH2_6                 1.000308e-01 1 1  ON 46
eH2_7                 1.488191e-01 1 1  ON 47
eH2_8                 1.554525e-01 1 1  ON 48
eH2_9                 1.547664e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.9062
    reference variance = 0.371659
====================================================
  Execution time = 2.1613e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6894e+01
  VMC Evar = 3.8987e-01
  Total weights = 2.0000e+06
  Execution time = 1.8848e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.389663003939
                                         uncertainty =       0.003957468411

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.389663003939
                                         uncertainty =       0.003957468411

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000441453137
  error estimate for blocks of size 2^( 2) =       0.000455683850
  error estimate for blocks of size 2^( 3) =       0.000469481401
  error estimate for blocks of size 2^( 4) =       0.000481507911
  error estimate for blocks of size 2^( 5) =       0.000493312480
  error estimate for blocks of size 2^( 6) =       0.000502297713
  error estimate for blocks of size 2^( 7) =       0.000506336850

      target function =                  N/A
              le_mean =     -16.894318435432
             les_mean =     285.807756947832
             stat err =       0.000495863739
             autocorr =       1.261698206581
              std dev =       0.624309013974
             le_variance =       0.389761744929

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.389973915330
                                         uncertainty =       0.003964226687

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.389973915330
                                         uncertainty =       0.003964226687

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000441629295
  error estimate for blocks of size 2^( 2) =       0.000455857020
  error estimate for blocks of size 2^( 3) =       0.000469623565
  error estimate for blocks of size 2^( 4) =       0.000481613004
  error estimate for blocks of size 2^( 5) =       0.000493362047
  error estimate for blocks of size 2^( 6) =       0.000502309708
  error estimate for blocks of size 2^( 7) =       0.000506338660

      target function =                  N/A
              le_mean =     -16.894314822978
             les_mean =     285.807946010737
             stat err =       0.000495905855
             autocorr =       1.260906035996
              std dev =       0.624558138100
             le_variance =       0.390072867867

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.389910907175
                                         uncertainty =       0.003963454556

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.389910907175
                                         uncertainty =       0.003963454556

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000441593084
  error estimate for blocks of size 2^( 2) =       0.000455819854
  error estimate for blocks of size 2^( 3) =       0.000469590494
  error estimate for blocks of size 2^( 4) =       0.000481590340
  error estimate for blocks of size 2^( 5) =       0.000493358271
  error estimate for blocks of size 2^( 6) =       0.000502325147
  error estimate for blocks of size 2^( 7) =       0.000506359729

      target function =                  N/A
              le_mean =     -16.894316747482
             les_mean =     285.807947073434
             stat err =       0.000495908372
             autocorr =       1.261125633788
              std dev =       0.624506928865
             le_variance =       0.390008904200

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.389719313201
                                         uncertainty =       0.003958652799

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.389719313201
                                         uncertainty =       0.003958652799

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000441484858
  error estimate for blocks of size 2^( 2) =       0.000455711689
  error estimate for blocks of size 2^( 3) =       0.000469500097
  error estimate for blocks of size 2^( 4) =       0.000481518713
  error estimate for blocks of size 2^( 5) =       0.000493315683
  error estimate for blocks of size 2^( 6) =       0.000502298393
  error estimate for blocks of size 2^( 7) =       0.000506335389

      target function =                  N/A
              le_mean =     -16.894314459942
             les_mean =     285.807678635484
             stat err =       0.000495867045
             autocorr =       1.261533730587
              std dev =       0.624353873216
             le_variance =       0.389817758999


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.894318435432        initial  <--
     9.7656e-03     9.7656e-02             2.7756e-02       -16.894314822978
     3.9062e-02     3.9062e-01             6.9749e-03       -16.894316747482
     1.5625e-01     1.5625e+00             1.7792e-03       -16.894314459942

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.1676
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.028772e-01 1 1  ON 0
 uu_1                 1.394319e-01 1 1  ON 1
 uu_2                 4.165689e-02 1 1  ON 2
 uu_3                -1.870341e-02 1 1  ON 3
 uu_4                -6.223442e-02 1 1  ON 4
 uu_5                -9.450477e-02 1 1  ON 5
 uu_6                -1.189056e-01 1 1  ON 6
 uu_7                -1.296091e-01 1 1  ON 7
 uu_8                -1.198588e-01 1 1  ON 8
 uu_9                -9.418924e-02 1 1  ON 9
 ud_0                 4.121607e-01 1 1  ON 10
 ud_1                 1.588173e-01 1 1  ON 11
 ud_2                 6.135506e-02 1 1  ON 12
 ud_3                 2.935740e-03 1 1  ON 13
 ud_4                -5.683434e-02 1 1  ON 14
 ud_5                -1.008499e-01 1 1  ON 15
 ud_6                -1.280916e-01 1 1  ON 16
 ud_7                -1.429558e-01 1 1  ON 17
 ud_8                -1.434470e-01 1 1  ON 18
 ud_9                -1.366312e-01 1 1  ON 19
 eO_0                -7.037962e-01 1 1  ON 20
 eO_1                -4.133723e-01 1 1  ON 21
 eO_2                -3.084689e-02 1 1  ON 22
 eO_3                 2.689953e-01 1 1  ON 23
 eO_4                 4.910624e-01 1 1  ON 24
 eO_5                 4.578008e-01 1 1  ON 25
 eO_6                 2.351166e-01 1 1  ON 26
 eO_7                -5.767876e-02 1 1  ON 27
 eO_8                -1.944339e-01 1 1  ON 28
 eO_9                -5.599059e-02 1 1  ON 29
eH1_0                -2.078290e-01 1 1  ON 30
eH1_1                -1.250792e-01 1 1  ON 31
eH1_2                -8.645301e-02 1 1  ON 32
eH1_3                -3.641075e-02 1 1  ON 33
eH1_4                 1.177113e-02 1 1  ON 34
eH1_5                 4.451983e-02 1 1  ON 35
eH1_6                 9.402029e-02 1 1  ON 36
eH1_7                 1.367795e-01 1 1  ON 37
eH1_8                 1.435115e-01 1 1  ON 38
eH1_9                 3.026808e-02 1 1  ON 39
eH2_0                -2.067175e-01 1 1  ON 40
eH2_1                -1.246848e-01 1 1  ON 41
eH2_2                -8.573133e-02 1 1  ON 42
eH2_3                -3.514790e-02 1 1  ON 43
eH2_4                 1.387487e-02 1 1  ON 44
eH2_5                 4.818069e-02 1 1  ON 45
eH2_6                 1.012092e-01 1 1  ON 46
eH2_7                 1.499438e-01 1 1  ON 47
eH2_8                 1.497682e-01 1 1  ON 48
eH2_9                 8.501773e-03 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9755e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6883e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.9089
    reference variance = 0.170044
====================================================
  Execution time = 2.0907e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6894e+01
  VMC Evar = 3.9318e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5745e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.393048486333
                                         uncertainty =       0.004738264599

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.393048486333
                                         uncertainty =       0.004738264599

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000443385486
  error estimate for blocks of size 2^( 2) =       0.000458413075
  error estimate for blocks of size 2^( 3) =       0.000473187650
  error estimate for blocks of size 2^( 4) =       0.000488253500
  error estimate for blocks of size 2^( 5) =       0.000499750286
  error estimate for blocks of size 2^( 6) =       0.000506911968
  error estimate for blocks of size 2^( 7) =       0.000509500533

      target function =                  N/A
              le_mean =     -16.893877564156
             les_mean =     285.796280334068
             stat err =       0.000501104072
             autocorr =       1.277300020301
              std dev =       0.627041767317
             le_variance =       0.393181377960


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689387756416e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.893877564156       residual = 8.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.893880767238       residual = 8.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.893878646521       residual = 3.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.893879755664       residual = 3.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.893883504415       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.893883133891       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.893886533611       residual = 8.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.893888712202       residual = 4.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.893891030562       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.893890020157       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.893889256976       residual = 6.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.893888611383       residual = 2.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.893889007713       residual = 5.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-02 is 2.578759e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.893877564156       residual = 8.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.893879102601       residual = 8.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.893877898213       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.893878211190       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.893879468523       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.893879729099       residual = 4.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.893879840243       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.893880622797       residual = 7.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.893880844759       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.893880847219       residual = 7.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 8.007912e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.893877564156       residual = 8.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.893878063847       residual = 8.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.893877629281       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.893877647576       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.893877866885       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.893878006301       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.893878039119       residual = 8.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.893878122493       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.893878191794       residual = 3.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 2.134028e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.127474 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6494e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.030093e-01 1 1  ON 0
 uu_1                 1.396180e-01 1 1  ON 1
 uu_2                 4.182937e-02 1 1  ON 2
 uu_3                -1.891826e-02 1 1  ON 3
 uu_4                -6.259049e-02 1 1  ON 4
 uu_5                -9.450880e-02 1 1  ON 5
 uu_6                -1.191697e-01 1 1  ON 6
 uu_7                -1.294844e-01 1 1  ON 7
 uu_8                -1.201378e-01 1 1  ON 8
 uu_9                -9.435431e-02 1 1  ON 9
 ud_0                 4.121420e-01 1 1  ON 10
 ud_1                 1.589338e-01 1 1  ON 11
 ud_2                 6.148031e-02 1 1  ON 12
 ud_3                 3.128678e-03 1 1  ON 13
 ud_4                -5.664212e-02 1 1  ON 14
 ud_5                -1.008017e-01 1 1  ON 15
 ud_6                -1.281253e-01 1 1  ON 16
 ud_7                -1.433688e-01 1 1  ON 17
 ud_8                -1.436588e-01 1 1  ON 18
 ud_9                -1.365883e-01 1 1  ON 19
 eO_0                -7.039516e-01 1 1  ON 20
 eO_1                -4.135382e-01 1 1  ON 21
 eO_2                -3.108339e-02 1 1  ON 22
 eO_3                 2.694902e-01 1 1  ON 23
 eO_4                 4.914093e-01 1 1  ON 24
 eO_5                 4.580995e-01 1 1  ON 25
 eO_6                 2.352253e-01 1 1  ON 26
 eO_7                -5.737315e-02 1 1  ON 27
 eO_8                -1.949759e-01 1 1  ON 28
 eO_9                -5.638392e-02 1 1  ON 29
eH1_0                -2.086298e-01 1 1  ON 30
eH1_1                -1.256545e-01 1 1  ON 31
eH1_2                -8.698612e-02 1 1  ON 32
eH1_3                -3.654811e-02 1 1  ON 33
eH1_4                 1.195253e-02 1 1  ON 34
eH1_5                 4.476366e-02 1 1  ON 35
eH1_6                 9.441839e-02 1 1  ON 36
eH1_7                 1.370110e-01 1 1  ON 37
eH1_8                 1.440844e-01 1 1  ON 38
eH1_9                 3.068265e-02 1 1  ON 39
eH2_0                -2.067982e-01 1 1  ON 40
eH2_1                -1.249776e-01 1 1  ON 41
eH2_2                -8.589043e-02 1 1  ON 42
eH2_3                -3.531914e-02 1 1  ON 43
eH2_4                 1.399336e-02 1 1  ON 44
eH2_5                 4.811325e-02 1 1  ON 45
eH2_6                 1.011324e-01 1 1  ON 46
eH2_7                 1.496050e-01 1 1  ON 47
eH2_8                 1.501780e-01 1 1  ON 48
eH2_9                 9.116123e-03 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.8927
    reference variance = 0.286157
====================================================
  Execution time = 2.0420e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6893e+01
  VMC Evar = 3.9158e-01
  Total weights = 2.0000e+06
  Execution time = 1.8837e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.391223374648
                                         uncertainty =       0.003562817631

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.391223374648
                                         uncertainty =       0.003562817631

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000442518281
  error estimate for blocks of size 2^( 2) =       0.000456996572
  error estimate for blocks of size 2^( 3) =       0.000471356850
  error estimate for blocks of size 2^( 4) =       0.000484328850
  error estimate for blocks of size 2^( 5) =       0.000495566104
  error estimate for blocks of size 2^( 6) =       0.000503430730
  error estimate for blocks of size 2^( 7) =       0.000508843161

      target function =                  N/A
              le_mean =     -16.893166691881
             les_mean =     285.770725541876
             stat err =       0.000498042211
             autocorr =       1.266688629913
              std dev =       0.625815354568
             le_variance =       0.391644858013

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.391218314927
                                         uncertainty =       0.003554103531

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.391218314927
                                         uncertainty =       0.003554103531

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000442515717
  error estimate for blocks of size 2^( 2) =       0.000456994344
  error estimate for blocks of size 2^( 3) =       0.000471344674
  error estimate for blocks of size 2^( 4) =       0.000484303827
  error estimate for blocks of size 2^( 5) =       0.000495527110
  error estimate for blocks of size 2^( 6) =       0.000503380802
  error estimate for blocks of size 2^( 7) =       0.000508790322

      target function =                  N/A
              le_mean =     -16.893166338934
             les_mean =     285.770709078835
             stat err =       0.000498000515
             autocorr =       1.266491220496
              std dev =       0.625811728696
             le_variance =       0.391640319773

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.391107369649
                                         uncertainty =       0.003553699990

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.391107369649
                                         uncertainty =       0.003553699990

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000442452965
  error estimate for blocks of size 2^( 2) =       0.000456934312
  error estimate for blocks of size 2^( 3) =       0.000471290098
  error estimate for blocks of size 2^( 4) =       0.000484254721
  error estimate for blocks of size 2^( 5) =       0.000495481183
  error estimate for blocks of size 2^( 6) =       0.000503340156
  error estimate for blocks of size 2^( 7) =       0.000508751683

      target function =                  N/A
              le_mean =     -16.893166352210
             les_mean =     285.770598460261
             stat err =       0.000497956936
             autocorr =       1.266628781385
              std dev =       0.625722983895
             le_variance =       0.391529252574

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.391179740200
                                         uncertainty =       0.003560882984

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.391179740200
                                         uncertainty =       0.003560882984

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000442493667
  error estimate for blocks of size 2^( 2) =       0.000456972941
  error estimate for blocks of size 2^( 3) =       0.000471332796
  error estimate for blocks of size 2^( 4) =       0.000484304056
  error estimate for blocks of size 2^( 5) =       0.000495539516
  error estimate for blocks of size 2^( 6) =       0.000503403673
  error estimate for blocks of size 2^( 7) =       0.000508816335

      target function =                  N/A
              le_mean =     -16.893166277130
             les_mean =     285.770667962016
             stat err =       0.000498015895
             autocorr =       1.266695679039
              std dev =       0.625780545451
             le_variance =       0.391601291065


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.893166691881        initial  <--
     9.7656e-02     9.7656e-01             2.5788e-03       -16.893166338934
     3.9062e-01     3.9062e+00             8.0079e-04       -16.893166352210
     1.5625e+00     1.5625e+01             2.1340e-04       -16.893166277130

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9794
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.028772e-01 1 1  ON 0
 uu_1                 1.394319e-01 1 1  ON 1
 uu_2                 4.165689e-02 1 1  ON 2
 uu_3                -1.870341e-02 1 1  ON 3
 uu_4                -6.223442e-02 1 1  ON 4
 uu_5                -9.450477e-02 1 1  ON 5
 uu_6                -1.189056e-01 1 1  ON 6
 uu_7                -1.296091e-01 1 1  ON 7
 uu_8                -1.198588e-01 1 1  ON 8
 uu_9                -9.418924e-02 1 1  ON 9
 ud_0                 4.121607e-01 1 1  ON 10
 ud_1                 1.588173e-01 1 1  ON 11
 ud_2                 6.135506e-02 1 1  ON 12
 ud_3                 2.935740e-03 1 1  ON 13
 ud_4                -5.683434e-02 1 1  ON 14
 ud_5                -1.008499e-01 1 1  ON 15
 ud_6                -1.280916e-01 1 1  ON 16
 ud_7                -1.429558e-01 1 1  ON 17
 ud_8                -1.434470e-01 1 1  ON 18
 ud_9                -1.366312e-01 1 1  ON 19
 eO_0                -7.037962e-01 1 1  ON 20
 eO_1                -4.133723e-01 1 1  ON 21
 eO_2                -3.084689e-02 1 1  ON 22
 eO_3                 2.689953e-01 1 1  ON 23
 eO_4                 4.910624e-01 1 1  ON 24
 eO_5                 4.578008e-01 1 1  ON 25
 eO_6                 2.351166e-01 1 1  ON 26
 eO_7                -5.767876e-02 1 1  ON 27
 eO_8                -1.944339e-01 1 1  ON 28
 eO_9                -5.599059e-02 1 1  ON 29
eH1_0                -2.078290e-01 1 1  ON 30
eH1_1                -1.250792e-01 1 1  ON 31
eH1_2                -8.645301e-02 1 1  ON 32
eH1_3                -3.641075e-02 1 1  ON 33
eH1_4                 1.177113e-02 1 1  ON 34
eH1_5                 4.451983e-02 1 1  ON 35
eH1_6                 9.402029e-02 1 1  ON 36
eH1_7                 1.367795e-01 1 1  ON 37
eH1_8                 1.435115e-01 1 1  ON 38
eH1_9                 3.026808e-02 1 1  ON 39
eH2_0                -2.067175e-01 1 1  ON 40
eH2_1                -1.246848e-01 1 1  ON 41
eH2_2                -8.573133e-02 1 1  ON 42
eH2_3                -3.514790e-02 1 1  ON 43
eH2_4                 1.387487e-02 1 1  ON 44
eH2_5                 4.818069e-02 1 1  ON 45
eH2_6                 1.012092e-01 1 1  ON 46
eH2_7                 1.499438e-01 1 1  ON 47
eH2_8                 1.497682e-01 1 1  ON 48
eH2_9                 8.501773e-03 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6499e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6885e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.9106
    reference variance = 0.278965
====================================================
  Execution time = 2.0831e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6893e+01
  VMC Evar = 4.0749e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5898e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.407556777017
                                         uncertainty =       0.019976451375

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.407556777017
                                         uncertainty =       0.019976451375

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000451379357
  error estimate for blocks of size 2^( 2) =       0.000465920522
  error estimate for blocks of size 2^( 3) =       0.000479631084
  error estimate for blocks of size 2^( 4) =       0.000492766924
  error estimate for blocks of size 2^( 5) =       0.000504457283
  error estimate for blocks of size 2^( 6) =       0.000514910688
  error estimate for blocks of size 2^( 7) =       0.000520665959

      target function =                  N/A
              le_mean =     -16.893110901645
             les_mean =     285.784682379312
             stat err =       0.000508200213
             autocorr =       1.267611875445
              std dev =       0.638346808386
             le_variance =       0.407486647777


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689311090165e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.893110901645       residual = 9.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.893111355374       residual = 6.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.893111399847       residual = 4.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.893111999723       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.893112454140       residual = 5.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.893112547518       residual = 3.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.893112573853       residual = 6.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.893112306879       residual = 3.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.893112375354       residual = 6.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-01 is 3.513136e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.893110901645       residual = 9.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.893111029297       residual = 6.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.893111043069       residual = 3.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.893111191428       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.893111319917       residual = 4.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.893111358346       residual = 2.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.893111377975       residual = 4.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.893111312954       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.893111320721       residual = 2.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 9.634262e-05

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.893110901645       residual = 9.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.893110934590       residual = 6.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.893110938298       residual = 3.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.893110975059       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.893111007710       residual = 4.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.893111018633       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.893111025239       residual = 4.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.893111008960       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.893111010478       residual = 2.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 2.472908e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.130691 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6432e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.028844e-01 1 1  ON 0
 uu_1                 1.394327e-01 1 1  ON 1
 uu_2                 4.167912e-02 1 1  ON 2
 uu_3                -1.873755e-02 1 1  ON 3
 uu_4                -6.223924e-02 1 1  ON 4
 uu_5                -9.453784e-02 1 1  ON 5
 uu_6                -1.189616e-01 1 1  ON 6
 uu_7                -1.296345e-01 1 1  ON 7
 uu_8                -1.198601e-01 1 1  ON 8
 uu_9                -9.414734e-02 1 1  ON 9
 ud_0                 4.121255e-01 1 1  ON 10
 ud_1                 1.587950e-01 1 1  ON 11
 ud_2                 6.133979e-02 1 1  ON 12
 ud_3                 2.945776e-03 1 1  ON 13
 ud_4                -5.682528e-02 1 1  ON 14
 ud_5                -1.008669e-01 1 1  ON 15
 ud_6                -1.281377e-01 1 1  ON 16
 ud_7                -1.429501e-01 1 1  ON 17
 ud_8                -1.433972e-01 1 1  ON 18
 ud_9                -1.365911e-01 1 1  ON 19
 eO_0                -7.037703e-01 1 1  ON 20
 eO_1                -4.134001e-01 1 1  ON 21
 eO_2                -3.090511e-02 1 1  ON 22
 eO_3                 2.689976e-01 1 1  ON 23
 eO_4                 4.910557e-01 1 1  ON 24
 eO_5                 4.578679e-01 1 1  ON 25
 eO_6                 2.351458e-01 1 1  ON 26
 eO_7                -5.764806e-02 1 1  ON 27
 eO_8                -1.944620e-01 1 1  ON 28
 eO_9                -5.602032e-02 1 1  ON 29
eH1_0                -2.078174e-01 1 1  ON 30
eH1_1                -1.251345e-01 1 1  ON 31
eH1_2                -8.654935e-02 1 1  ON 32
eH1_3                -3.641873e-02 1 1  ON 33
eH1_4                 1.174276e-02 1 1  ON 34
eH1_5                 4.450334e-02 1 1  ON 35
eH1_6                 9.405488e-02 1 1  ON 36
eH1_7                 1.368356e-01 1 1  ON 37
eH1_8                 1.435629e-01 1 1  ON 38
eH1_9                 3.031178e-02 1 1  ON 39
eH2_0                -2.067522e-01 1 1  ON 40
eH2_1                -1.247120e-01 1 1  ON 41
eH2_2                -8.576316e-02 1 1  ON 42
eH2_3                -3.516106e-02 1 1  ON 43
eH2_4                 1.385605e-02 1 1  ON 44
eH2_5                 4.820470e-02 1 1  ON 45
eH2_6                 1.011781e-01 1 1  ON 46
eH2_7                 1.499341e-01 1 1  ON 47
eH2_8                 1.498373e-01 1 1  ON 48
eH2_9                 8.569187e-03 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.9944
    reference variance = 0.412963
====================================================
  Execution time = 2.0442e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6894e+01
  VMC Evar = 3.8619e-01
  Total weights = 2.0000e+06
  Execution time = 1.8954e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.386274852352
                                         uncertainty =       0.003213530211

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.386274852352
                                         uncertainty =       0.003213530211

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000439425692
  error estimate for blocks of size 2^( 2) =       0.000454305323
  error estimate for blocks of size 2^( 3) =       0.000469230536
  error estimate for blocks of size 2^( 4) =       0.000482744965
  error estimate for blocks of size 2^( 5) =       0.000493525718
  error estimate for blocks of size 2^( 6) =       0.000502286728
  error estimate for blocks of size 2^( 7) =       0.000507923200

      target function =                  N/A
              le_mean =     -16.893926116579
             les_mean =     285.790929317132
             stat err =       0.000496620153
             autocorr =       1.277255516456
              std dev =       0.621441773457
             le_variance =       0.386189877797

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.386268379701
                                         uncertainty =       0.003213784580

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.386268379701
                                         uncertainty =       0.003213784580

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000439421970
  error estimate for blocks of size 2^( 2) =       0.000454302208
  error estimate for blocks of size 2^( 3) =       0.000469226555
  error estimate for blocks of size 2^( 4) =       0.000482739551
  error estimate for blocks of size 2^( 5) =       0.000493516948
  error estimate for blocks of size 2^( 6) =       0.000502274959
  error estimate for blocks of size 2^( 7) =       0.000507908748

      target function =                  N/A
              le_mean =     -16.893926386734
             les_mean =     285.790931901951
             stat err =       0.000496610051
             autocorr =       1.277225198412
              std dev =       0.621436508956
             le_variance =       0.386183334663

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.386271439256
                                         uncertainty =       0.003213686866

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.386271439256
                                         uncertainty =       0.003213686866

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000439423724
  error estimate for blocks of size 2^( 2) =       0.000454303538
  error estimate for blocks of size 2^( 3) =       0.000469228143
  error estimate for blocks of size 2^( 4) =       0.000482741876
  error estimate for blocks of size 2^( 5) =       0.000493520810
  error estimate for blocks of size 2^( 6) =       0.000502279901
  error estimate for blocks of size 2^( 7) =       0.000507914592

      target function =                  N/A
              le_mean =     -16.893926263026
             les_mean =     285.790930806532
             stat err =       0.000496614295
             autocorr =       1.277236823685
              std dev =       0.621438990633
             le_variance =       0.386186419079

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.386274390049
                                         uncertainty =       0.003213551026

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.386274390049
                                         uncertainty =       0.003213551026

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000439425426
  error estimate for blocks of size 2^( 2) =       0.000454305072
  error estimate for blocks of size 2^( 3) =       0.000469230200
  error estimate for blocks of size 2^( 4) =       0.000482744544
  error estimate for blocks of size 2^( 5) =       0.000493525062
  error estimate for blocks of size 2^( 6) =       0.000502285812
  error estimate for blocks of size 2^( 7) =       0.000507922038

      target function =                  N/A
              le_mean =     -16.893926129833
             les_mean =     285.790929296467
             stat err =       0.000496619364
             autocorr =       1.277253009221
              std dev =       0.621441396526
             le_variance =       0.386189409317


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.893926116579        initial
     9.7656e-01     9.7656e+00             3.5131e-04       -16.893926386734  <--
     3.9062e+00     3.9062e+01             9.6343e-05       -16.893926263026
     1.5625e+01     1.5625e+02             2.4729e-05       -16.893926129833

*****************************************************************************
Applying the update for shift_i =   9.7656e-01     and shift_s =   9.7656e+00
*****************************************************************************

  Execution time = 3.0052e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.029039e-01 1 1  ON 0
 uu_1                 1.394412e-01 1 1  ON 1
 uu_2                 4.171950e-02 1 1  ON 2
 uu_3                -1.880885e-02 1 1  ON 3
 uu_4                -6.226907e-02 1 1  ON 4
 uu_5                -9.462824e-02 1 1  ON 5
 uu_6                -1.191188e-01 1 1  ON 6
 uu_7                -1.297173e-01 1 1  ON 7
 uu_8                -1.198676e-01 1 1  ON 8
 uu_9                -9.402277e-02 1 1  ON 9
 ud_0                 4.120268e-01 1 1  ON 10
 ud_1                 1.587325e-01 1 1  ON 11
 ud_2                 6.130392e-02 1 1  ON 12
 ud_3                 2.964661e-03 1 1  ON 13
 ud_4                -5.680485e-02 1 1  ON 14
 ud_5                -1.009151e-01 1 1  ON 15
 ud_6                -1.282580e-01 1 1  ON 16
 ud_7                -1.429468e-01 1 1  ON 17
 ud_8                -1.432580e-01 1 1  ON 18
 ud_9                -1.364716e-01 1 1  ON 19
 eO_0                -7.037118e-01 1 1  ON 20
 eO_1                -4.134736e-01 1 1  ON 21
 eO_2                -3.105948e-02 1 1  ON 22
 eO_3                 2.689941e-01 1 1  ON 23
 eO_4                 4.910435e-01 1 1  ON 24
 eO_5                 4.580639e-01 1 1  ON 25
 eO_6                 2.352305e-01 1 1  ON 26
 eO_7                -5.755989e-02 1 1  ON 27
 eO_8                -1.945449e-01 1 1  ON 28
 eO_9                -5.610777e-02 1 1  ON 29
eH1_0                -2.077972e-01 1 1  ON 30
eH1_1                -1.252991e-01 1 1  ON 31
eH1_2                -8.680432e-02 1 1  ON 32
eH1_3                -3.646619e-02 1 1  ON 33
eH1_4                 1.166500e-02 1 1  ON 34
eH1_5                 4.445517e-02 1 1  ON 35
eH1_6                 9.415675e-02 1 1  ON 36
eH1_7                 1.370026e-01 1 1  ON 37
eH1_8                 1.437159e-01 1 1  ON 38
eH1_9                 3.044143e-02 1 1  ON 39
eH2_0                -2.068533e-01 1 1  ON 40
eH2_1                -1.247861e-01 1 1  ON 41
eH2_2                -8.585535e-02 1 1  ON 42
eH2_3                -3.520524e-02 1 1  ON 43
eH2_4                 1.380083e-02 1 1  ON 44
eH2_5                 4.827125e-02 1 1  ON 45
eH2_6                 1.010875e-01 1 1  ON 46
eH2_7                 1.499047e-01 1 1  ON 47
eH2_8                 1.500408e-01 1 1  ON 48
eH2_9                 8.768687e-03 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6490e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6893e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.8206
    reference variance = 0.320953
====================================================
  Execution time = 2.0950e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6893e+01
  VMC Evar = 3.9679e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6091e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.396774570744
                                         uncertainty =       0.005819405313

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.396774570744
                                         uncertainty =       0.005819405313

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000445416025
  error estimate for blocks of size 2^( 2) =       0.000459569160
  error estimate for blocks of size 2^( 3) =       0.000473368564
  error estimate for blocks of size 2^( 4) =       0.000486161278
  error estimate for blocks of size 2^( 5) =       0.000497039089
  error estimate for blocks of size 2^( 6) =       0.000505380358
  error estimate for blocks of size 2^( 7) =       0.000511183017

      target function =                  N/A
              le_mean =     -16.893478730068
             les_mean =     285.786414275625
             stat err =       0.000499940936
             autocorr =       1.259811943871
              std dev =       0.629913383549
             le_variance =       0.396790870775


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689347873007e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.893478730068       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.893481372167       residual = 5.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.893483362931       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.893484198851       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.893485653579       residual = 9.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.893485565531       residual = 6.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.893487332990       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.893486513032       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.893486682997       residual = 2.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.893486757573       residual = 6.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-01 is 1.236363e-03

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.893478730068       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.893479679595       residual = 3.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.893480514765       residual = 3.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.893481105465       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.893481253851       residual = 5.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.893481151789       residual = 2.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.893481564599       residual = 4.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.893481484969       residual = 2.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.893481407368       residual = 3.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-01 is 3.257922e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.893478730068       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.893478996604       residual = 3.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.893479272191       residual = 4.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.893479460984       residual = 9.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.893479454897       residual = 2.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.893479464953       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.893479529194       residual = 3.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.893479532194       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.893479505861       residual = 1.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 8.445900e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.134062 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6571e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.028894e-01 1 1  ON 0
 uu_1                 1.394518e-01 1 1  ON 1
 uu_2                 4.173999e-02 1 1  ON 2
 uu_3                -1.895518e-02 1 1  ON 3
 uu_4                -6.241770e-02 1 1  ON 4
 uu_5                -9.462751e-02 1 1  ON 5
 uu_6                -1.192620e-01 1 1  ON 6
 uu_7                -1.297647e-01 1 1  ON 7
 uu_8                -1.198735e-01 1 1  ON 8
 uu_9                -9.391025e-02 1 1  ON 9
 ud_0                 4.119542e-01 1 1  ON 10
 ud_1                 1.586756e-01 1 1  ON 11
 ud_2                 6.121626e-02 1 1  ON 12
 ud_3                 2.925465e-03 1 1  ON 13
 ud_4                -5.680555e-02 1 1  ON 14
 ud_5                -1.009202e-01 1 1  ON 15
 ud_6                -1.283255e-01 1 1  ON 16
 ud_7                -1.429742e-01 1 1  ON 17
 ud_8                -1.431002e-01 1 1  ON 18
 ud_9                -1.363481e-01 1 1  ON 19
 eO_0                -7.037849e-01 1 1  ON 20
 eO_1                -4.134650e-01 1 1  ON 21
 eO_2                -3.113348e-02 1 1  ON 22
 eO_3                 2.690334e-01 1 1  ON 23
 eO_4                 4.910800e-01 1 1  ON 24
 eO_5                 4.582162e-01 1 1  ON 25
 eO_6                 2.352592e-01 1 1  ON 26
 eO_7                -5.745458e-02 1 1  ON 27
 eO_8                -1.946241e-01 1 1  ON 28
 eO_9                -5.623399e-02 1 1  ON 29
eH1_0                -2.079413e-01 1 1  ON 30
eH1_1                -1.254667e-01 1 1  ON 31
eH1_2                -8.690920e-02 1 1  ON 32
eH1_3                -3.656139e-02 1 1  ON 33
eH1_4                 1.169346e-02 1 1  ON 34
eH1_5                 4.446371e-02 1 1  ON 35
eH1_6                 9.427654e-02 1 1  ON 36
eH1_7                 1.370738e-01 1 1  ON 37
eH1_8                 1.438648e-01 1 1  ON 38
eH1_9                 3.057110e-02 1 1  ON 39
eH2_0                -2.071791e-01 1 1  ON 40
eH2_1                -1.249447e-01 1 1  ON 41
eH2_2                -8.588686e-02 1 1  ON 42
eH2_3                -3.531372e-02 1 1  ON 43
eH2_4                 1.375373e-02 1 1  ON 44
eH2_5                 4.829077e-02 1 1  ON 45
eH2_6                 1.010905e-01 1 1  ON 46
eH2_7                 1.499227e-01 1 1  ON 47
eH2_8                 1.503214e-01 1 1  ON 48
eH2_9                 9.082200e-03 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.9919
    reference variance = 0.346809
====================================================
  Execution time = 2.0705e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6893e+01
  VMC Evar = 3.8677e-01
  Total weights = 2.0000e+06
  Execution time = 1.8989e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.386912025699
                                         uncertainty =       0.005341441815

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.386912025699
                                         uncertainty =       0.005341441815

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000439755882
  error estimate for blocks of size 2^( 2) =       0.000454932144
  error estimate for blocks of size 2^( 3) =       0.000468902055
  error estimate for blocks of size 2^( 4) =       0.000481467210
  error estimate for blocks of size 2^( 5) =       0.000491019117
  error estimate for blocks of size 2^( 6) =       0.000499922484
  error estimate for blocks of size 2^( 7) =       0.000505969249

      target function =                  N/A
              le_mean =     -16.892881033565
             les_mean =     285.756199891867
             stat err =       0.000494594515
             autocorr =       1.264955588954
              std dev =       0.621908732115
             le_variance =       0.386770471081

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.386931320017
                                         uncertainty =       0.005341854319

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.386931320017
                                         uncertainty =       0.005341854319

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000439766720
  error estimate for blocks of size 2^( 2) =       0.000454942727
  error estimate for blocks of size 2^( 3) =       0.000468911524
  error estimate for blocks of size 2^( 4) =       0.000481472660
  error estimate for blocks of size 2^( 5) =       0.000491018998
  error estimate for blocks of size 2^( 6) =       0.000499904145
  error estimate for blocks of size 2^( 7) =       0.000505955071

      target function =                  N/A
              le_mean =     -16.892882883269
             les_mean =     285.756281451107
             stat err =       0.000494587719
             autocorr =       1.264858473749
              std dev =       0.621924060195
             le_variance =       0.386789536650

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.386906601272
                                         uncertainty =       0.005341578631

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.386906601272
                                         uncertainty =       0.005341578631

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000439752700
  error estimate for blocks of size 2^( 2) =       0.000454928071
  error estimate for blocks of size 2^( 3) =       0.000468897360
  error estimate for blocks of size 2^( 4) =       0.000481460130
  error estimate for blocks of size 2^( 5) =       0.000491009167
  error estimate for blocks of size 2^( 6) =       0.000499899218
  error estimate for blocks of size 2^( 7) =       0.000505949506

      target function =                  N/A
              le_mean =     -16.892881819598
             les_mean =     285.756220851285
             stat err =       0.000494579505
             autocorr =       1.264897118046
              std dev =       0.621904231981
             le_variance =       0.386764873756

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.386909070266
                                         uncertainty =       0.005341443133

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.386909070266
                                         uncertainty =       0.005341443133

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000439754187
  error estimate for blocks of size 2^( 2) =       0.000454930280
  error estimate for blocks of size 2^( 3) =       0.000468900121
  error estimate for blocks of size 2^( 4) =       0.000481464990
  error estimate for blocks of size 2^( 5) =       0.000491016601
  error estimate for blocks of size 2^( 6) =       0.000499917982
  error estimate for blocks of size 2^( 7) =       0.000505965286

      target function =                  N/A
              le_mean =     -16.892881033375
             les_mean =     285.756196903654
             stat err =       0.000494591215
             autocorr =       1.264948457798
              std dev =       0.621906334807
             le_variance =       0.386767489273


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.892881033565        initial
     2.4414e-01     2.4414e+00             1.2364e-03       -16.892882883269  <--
     9.7656e-01     9.7656e+00             3.2579e-04       -16.892881819598
     3.9062e+00     3.9062e+01             8.4459e-05       -16.892881033375

*****************************************************************************
Applying the update for shift_i =   2.4414e-01     and shift_s =   2.4414e+00
*****************************************************************************

  Execution time = 3.0329e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.028763e-01 1 1  ON 0
 uu_1                 1.394321e-01 1 1  ON 1
 uu_2                 4.168500e-02 1 1  ON 2
 uu_3                -1.922908e-02 1 1  ON 3
 uu_4                -6.274744e-02 1 1  ON 4
 uu_5                -9.478566e-02 1 1  ON 5
 uu_6                -1.195709e-01 1 1  ON 6
 uu_7                -1.299449e-01 1 1  ON 7
 uu_8                -1.199343e-01 1 1  ON 8
 uu_9                -9.358648e-02 1 1  ON 9
 ud_0                 4.117999e-01 1 1  ON 10
 ud_1                 1.585235e-01 1 1  ON 11
 ud_2                 6.104997e-02 1 1  ON 12
 ud_3                 2.802243e-03 1 1  ON 13
 ud_4                -5.684296e-02 1 1  ON 14
 ud_5                -1.010121e-01 1 1  ON 15
 ud_6                -1.284387e-01 1 1  ON 16
 ud_7                -1.430884e-01 1 1  ON 17
 ud_8                -1.427355e-01 1 1  ON 18
 ud_9                -1.359934e-01 1 1  ON 19
 eO_0                -7.039506e-01 1 1  ON 20
 eO_1                -4.134693e-01 1 1  ON 21
 eO_2                -3.127143e-02 1 1  ON 22
 eO_3                 2.690252e-01 1 1  ON 23
 eO_4                 4.912070e-01 1 1  ON 24
 eO_5                 4.586707e-01 1 1  ON 25
 eO_6                 2.353703e-01 1 1  ON 26
 eO_7                -5.716693e-02 1 1  ON 27
 eO_8                -1.948645e-01 1 1  ON 28
 eO_9                -5.660405e-02 1 1  ON 29
eH1_0                -2.083653e-01 1 1  ON 30
eH1_1                -1.259005e-01 1 1  ON 31
eH1_2                -8.721288e-02 1 1  ON 32
eH1_3                -3.679665e-02 1 1  ON 33
eH1_4                 1.167464e-02 1 1  ON 34
eH1_5                 4.448715e-02 1 1  ON 35
eH1_6                 9.461760e-02 1 1  ON 36
eH1_7                 1.372887e-01 1 1  ON 37
eH1_8                 1.443023e-01 1 1  ON 38
eH1_9                 3.095313e-02 1 1  ON 39
eH2_0                -2.080014e-01 1 1  ON 40
eH2_1                -1.253604e-01 1 1  ON 41
eH2_2                -8.612093e-02 1 1  ON 42
eH2_3                -3.559826e-02 1 1  ON 43
eH2_4                 1.356634e-02 1 1  ON 44
eH2_5                 4.830895e-02 1 1  ON 45
eH2_6                 1.011036e-01 1 1  ON 46
eH2_7                 1.499823e-01 1 1  ON 47
eH2_8                 1.511408e-01 1 1  ON 48
eH2_9                 1.000505e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6905e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6894e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.8965
    reference variance = 0.563036
====================================================
  Execution time = 2.0904e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6894e+01
  VMC Evar = 3.9814e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6453e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.398240349256
                                         uncertainty =       0.004204786234

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.398240349256
                                         uncertainty =       0.004204786234

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000446171848
  error estimate for blocks of size 2^( 2) =       0.000460697370
  error estimate for blocks of size 2^( 3) =       0.000474526748
  error estimate for blocks of size 2^( 4) =       0.000487734954
  error estimate for blocks of size 2^( 5) =       0.000499596392
  error estimate for blocks of size 2^( 6) =       0.000507789031
  error estimate for blocks of size 2^( 7) =       0.000513729861

      target function =                  N/A
              le_mean =     -16.894120515045
             les_mean =     285.809446414487
             stat err =       0.000502212559
             autocorr =       1.266983063256
              std dev =       0.630982279233
             le_variance =       0.398138636706


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689412051504e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.894120515045       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.894120685568       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.894123339341       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.894120275425       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.894122628533       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.894126593117       residual = 8.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.894127912283       residual = 5.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.894127847278       residual = 6.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.894126972152       residual = 2.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.894127349900       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.894128034313       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.894128514847       residual = 2.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.894128142552       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.894128382438       residual = 3.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-02 is 4.315890e-03

solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.894120515045       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.894120613521       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.894122044864       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.894120834061       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.894121880939       residual = 6.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.894123023311       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.894123692379       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.894123201143       residual = 7.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.894123093689       residual = 2.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.894123061744       residual = 8.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-01 is 1.069503e-03

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.894120515045       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.894120551653       residual = 3.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.894121060585       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.894120963698       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.894121211158       residual = 3.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.894121152354       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.894121518939       residual = 4.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.894121476698       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.894121412212       residual = 3.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-01 is 2.689147e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.138753 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6563e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.029097e-01 1 1  ON 0
 uu_1                 1.392893e-01 1 1  ON 1
 uu_2                 4.162376e-02 1 1  ON 2
 uu_3                -1.927149e-02 1 1  ON 3
 uu_4                -6.289121e-02 1 1  ON 4
 uu_5                -9.518068e-02 1 1  ON 5
 uu_6                -1.200068e-01 1 1  ON 6
 uu_7                -1.304272e-01 1 1  ON 7
 uu_8                -1.198116e-01 1 1  ON 8
 uu_9                -9.331986e-02 1 1  ON 9
 ud_0                 4.116870e-01 1 1  ON 10
 ud_1                 1.584246e-01 1 1  ON 11
 ud_2                 6.103836e-02 1 1  ON 12
 ud_3                 2.729342e-03 1 1  ON 13
 ud_4                -5.688319e-02 1 1  ON 14
 ud_5                -1.010654e-01 1 1  ON 15
 ud_6                -1.285592e-01 1 1  ON 16
 ud_7                -1.435048e-01 1 1  ON 17
 ud_8                -1.427414e-01 1 1  ON 18
 ud_9                -1.354489e-01 1 1  ON 19
 eO_0                -7.038491e-01 1 1  ON 20
 eO_1                -4.132291e-01 1 1  ON 21
 eO_2                -3.165090e-02 1 1  ON 22
 eO_3                 2.688053e-01 1 1  ON 23
 eO_4                 4.915448e-01 1 1  ON 24
 eO_5                 4.590810e-01 1 1  ON 25
 eO_6                 2.354273e-01 1 1  ON 26
 eO_7                -5.695581e-02 1 1  ON 27
 eO_8                -1.952996e-01 1 1  ON 28
 eO_9                -5.694304e-02 1 1  ON 29
eH1_0                -2.089839e-01 1 1  ON 30
eH1_1                -1.266063e-01 1 1  ON 31
eH1_2                -8.773063e-02 1 1  ON 32
eH1_3                -3.712986e-02 1 1  ON 33
eH1_4                 1.157702e-02 1 1  ON 34
eH1_5                 4.377055e-02 1 1  ON 35
eH1_6                 9.489764e-02 1 1  ON 36
eH1_7                 1.379492e-01 1 1  ON 37
eH1_8                 1.453718e-01 1 1  ON 38
eH1_9                 3.177818e-02 1 1  ON 39
eH2_0                -2.082120e-01 1 1  ON 40
eH2_1                -1.256206e-01 1 1  ON 41
eH2_2                -8.635829e-02 1 1  ON 42
eH2_3                -3.571145e-02 1 1  ON 43
eH2_4                 1.365081e-02 1 1  ON 44
eH2_5                 4.793694e-02 1 1  ON 45
eH2_6                 1.005593e-01 1 1  ON 46
eH2_7                 1.497714e-01 1 1  ON 47
eH2_8                 1.519250e-01 1 1  ON 48
eH2_9                 1.099715e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.8706
    reference variance = 0.340811
====================================================
  Execution time = 2.0539e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6894e+01
  VMC Evar = 4.0101e-01
  Total weights = 2.0000e+06
  Execution time = 1.8808e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.401109104843
                                         uncertainty =       0.007319345021

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.401109104843
                                         uncertainty =       0.007319345021

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000447799541
  error estimate for blocks of size 2^( 2) =       0.000462229700
  error estimate for blocks of size 2^( 3) =       0.000476315965
  error estimate for blocks of size 2^( 4) =       0.000488591297
  error estimate for blocks of size 2^( 5) =       0.000501249782
  error estimate for blocks of size 2^( 6) =       0.000510618577
  error estimate for blocks of size 2^( 7) =       0.000516033950

      target function =                  N/A
              le_mean =     -16.893965132942
             les_mean =     285.807106571102
             stat err =       0.000504123401
             autocorr =       1.267378766829
              std dev =       0.633284184692
             le_variance =       0.401048858581

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.401090662287
                                         uncertainty =       0.007318495059

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.401090662287
                                         uncertainty =       0.007318495059

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000447789192
  error estimate for blocks of size 2^( 2) =       0.000462222017
  error estimate for blocks of size 2^( 3) =       0.000476305714
  error estimate for blocks of size 2^( 4) =       0.000488577161
  error estimate for blocks of size 2^( 5) =       0.000501224664
  error estimate for blocks of size 2^( 6) =       0.000510582896
  error estimate for blocks of size 2^( 7) =       0.000515981946

      target function =                  N/A
              le_mean =     -16.893960220984
             les_mean =     285.806922069050
             stat err =       0.000504091667
             autocorr =       1.267277785273
              std dev =       0.633269548747
             le_variance =       0.401030321370

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.401040317473
                                         uncertainty =       0.007317829981

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.401040317473
                                         uncertainty =       0.007317829981

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000447761124
  error estimate for blocks of size 2^( 2) =       0.000462193011
  error estimate for blocks of size 2^( 3) =       0.000476276963
  error estimate for blocks of size 2^( 4) =       0.000488551999
  error estimate for blocks of size 2^( 5) =       0.000501205463
  error estimate for blocks of size 2^( 6) =       0.000510566904
  error estimate for blocks of size 2^( 7) =       0.000515974272

      target function =                  N/A
              le_mean =     -16.893961270750
             les_mean =     285.806907265553
             stat err =       0.000504074660
             autocorr =       1.267351148414
              std dev =       0.633229854356
             le_variance =       0.400980048448

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.401088654741
                                         uncertainty =       0.007319188031

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.401088654741
                                         uncertainty =       0.007319188031

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000447788122
  error estimate for blocks of size 2^( 2) =       0.000462218636
  error estimate for blocks of size 2^( 3) =       0.000476304275
  error estimate for blocks of size 2^( 4) =       0.000488579702
  error estimate for blocks of size 2^( 5) =       0.000501237718
  error estimate for blocks of size 2^( 6) =       0.000510605045
  error estimate for blocks of size 2^( 7) =       0.000516019221

      target function =                  N/A
              le_mean =     -16.893964162460
             les_mean =     285.807053327203
             stat err =       0.000504110421
             autocorr =       1.267378139214
              std dev =       0.633268035856
             le_variance =       0.401028405237


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.893965132942        initial  <--
     6.1035e-02     6.1035e-01             4.3159e-03       -16.893960220984
     2.4414e-01     2.4414e+00             1.0695e-03       -16.893961270750
     9.7656e-01     9.7656e+00             2.6891e-04       -16.893964162460

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.1723
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.028763e-01 1 1  ON 0
 uu_1                 1.394321e-01 1 1  ON 1
 uu_2                 4.168500e-02 1 1  ON 2
 uu_3                -1.922908e-02 1 1  ON 3
 uu_4                -6.274744e-02 1 1  ON 4
 uu_5                -9.478566e-02 1 1  ON 5
 uu_6                -1.195709e-01 1 1  ON 6
 uu_7                -1.299449e-01 1 1  ON 7
 uu_8                -1.199343e-01 1 1  ON 8
 uu_9                -9.358648e-02 1 1  ON 9
 ud_0                 4.117999e-01 1 1  ON 10
 ud_1                 1.585235e-01 1 1  ON 11
 ud_2                 6.104997e-02 1 1  ON 12
 ud_3                 2.802243e-03 1 1  ON 13
 ud_4                -5.684296e-02 1 1  ON 14
 ud_5                -1.010121e-01 1 1  ON 15
 ud_6                -1.284387e-01 1 1  ON 16
 ud_7                -1.430884e-01 1 1  ON 17
 ud_8                -1.427355e-01 1 1  ON 18
 ud_9                -1.359934e-01 1 1  ON 19
 eO_0                -7.039506e-01 1 1  ON 20
 eO_1                -4.134693e-01 1 1  ON 21
 eO_2                -3.127143e-02 1 1  ON 22
 eO_3                 2.690252e-01 1 1  ON 23
 eO_4                 4.912070e-01 1 1  ON 24
 eO_5                 4.586707e-01 1 1  ON 25
 eO_6                 2.353703e-01 1 1  ON 26
 eO_7                -5.716693e-02 1 1  ON 27
 eO_8                -1.948645e-01 1 1  ON 28
 eO_9                -5.660405e-02 1 1  ON 29
eH1_0                -2.083653e-01 1 1  ON 30
eH1_1                -1.259005e-01 1 1  ON 31
eH1_2                -8.721288e-02 1 1  ON 32
eH1_3                -3.679665e-02 1 1  ON 33
eH1_4                 1.167464e-02 1 1  ON 34
eH1_5                 4.448715e-02 1 1  ON 35
eH1_6                 9.461760e-02 1 1  ON 36
eH1_7                 1.372887e-01 1 1  ON 37
eH1_8                 1.443023e-01 1 1  ON 38
eH1_9                 3.095313e-02 1 1  ON 39
eH2_0                -2.080014e-01 1 1  ON 40
eH2_1                -1.253604e-01 1 1  ON 41
eH2_2                -8.612093e-02 1 1  ON 42
eH2_3                -3.559826e-02 1 1  ON 43
eH2_4                 1.356634e-02 1 1  ON 44
eH2_5                 4.830895e-02 1 1  ON 45
eH2_6                 1.011036e-01 1 1  ON 46
eH2_7                 1.499823e-01 1 1  ON 47
eH2_8                 1.511408e-01 1 1  ON 48
eH2_9                 1.000505e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6740e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6893e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.8457
    reference variance = 0.216516
====================================================
  Execution time = 2.0990e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6894e+01
  VMC Evar = 3.9162e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6791e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.391686647982
                                         uncertainty =       0.004738743849

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.391686647982
                                         uncertainty =       0.004738743849

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000442502530
  error estimate for blocks of size 2^( 2) =       0.000456603909
  error estimate for blocks of size 2^( 3) =       0.000470883690
  error estimate for blocks of size 2^( 4) =       0.000484112758
  error estimate for blocks of size 2^( 5) =       0.000494976289
  error estimate for blocks of size 2^( 6) =       0.000502091303
  error estimate for blocks of size 2^( 7) =       0.000507089699

      target function =                  N/A
              le_mean =     -16.894298613742
             les_mean =     285.808942433210
             stat err =       0.000497067512
             autocorr =       1.261825329198
              std dev =       0.625793079813
             le_variance =       0.391616978742


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689429861374e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.894298613742       residual = 7.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.894299174433       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.894298956802       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.894298475026       residual = 9.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.894298707451       residual = 3.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.894299285995       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.894299509936       residual = 5.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.894299534746       residual = 3.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.894299456133       residual = 1.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-01 is 5.134270e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.894298613742       residual = 7.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.894298788041       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.894298693320       residual = 3.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.894298513113       residual = 7.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.894298546620       residual = 2.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.894298655769       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.894298733891       residual = 4.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.894298735863       residual = 9.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+00 is 1.256441e-04

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.894298613742       residual = 7.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.894298660141       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.894298632321       residual = 3.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.894298582164       residual = 7.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.894298586265       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.894298607980       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.894298630678       residual = 3.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.894298632287       residual = 6.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+00 is 3.157331e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.141684 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0274e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.028064e-01 1 1  ON 0
 uu_1                 1.394498e-01 1 1  ON 1
 uu_2                 4.172888e-02 1 1  ON 2
 uu_3                -1.923988e-02 1 1  ON 3
 uu_4                -6.276634e-02 1 1  ON 4
 uu_5                -9.482868e-02 1 1  ON 5
 uu_6                -1.195821e-01 1 1  ON 6
 uu_7                -1.299635e-01 1 1  ON 7
 uu_8                -1.199621e-01 1 1  ON 8
 uu_9                -9.356007e-02 1 1  ON 9
 ud_0                 4.117915e-01 1 1  ON 10
 ud_1                 1.585099e-01 1 1  ON 11
 ud_2                 6.109450e-02 1 1  ON 12
 ud_3                 2.774429e-03 1 1  ON 13
 ud_4                -5.680336e-02 1 1  ON 14
 ud_5                -1.010206e-01 1 1  ON 15
 ud_6                -1.284749e-01 1 1  ON 16
 ud_7                -1.431196e-01 1 1  ON 17
 ud_8                -1.427775e-01 1 1  ON 18
 ud_9                -1.359534e-01 1 1  ON 19
 eO_0                -7.039718e-01 1 1  ON 20
 eO_1                -4.134706e-01 1 1  ON 21
 eO_2                -3.131519e-02 1 1  ON 22
 eO_3                 2.690835e-01 1 1  ON 23
 eO_4                 4.912332e-01 1 1  ON 24
 eO_5                 4.587307e-01 1 1  ON 25
 eO_6                 2.353797e-01 1 1  ON 26
 eO_7                -5.713327e-02 1 1  ON 27
 eO_8                -1.949327e-01 1 1  ON 28
 eO_9                -5.665208e-02 1 1  ON 29
eH1_0                -2.084268e-01 1 1  ON 30
eH1_1                -1.259459e-01 1 1  ON 31
eH1_2                -8.726210e-02 1 1  ON 32
eH1_3                -3.681547e-02 1 1  ON 33
eH1_4                 1.172501e-02 1 1  ON 34
eH1_5                 4.447724e-02 1 1  ON 35
eH1_6                 9.462687e-02 1 1  ON 36
eH1_7                 1.373126e-01 1 1  ON 37
eH1_8                 1.443545e-01 1 1  ON 38
eH1_9                 3.101050e-02 1 1  ON 39
eH2_0                -2.080362e-01 1 1  ON 40
eH2_1                -1.253967e-01 1 1  ON 41
eH2_2                -8.621624e-02 1 1  ON 42
eH2_3                -3.560596e-02 1 1  ON 43
eH2_4                 1.356452e-02 1 1  ON 44
eH2_5                 4.829832e-02 1 1  ON 45
eH2_6                 1.010654e-01 1 1  ON 46
eH2_7                 1.499490e-01 1 1  ON 47
eH2_8                 1.512449e-01 1 1  ON 48
eH2_9                 1.013069e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.9092
    reference variance = 0.31516
====================================================
  Execution time = 2.0700e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6894e+01
  VMC Evar = 3.9375e-01
  Total weights = 2.0000e+06
  Execution time = 1.8969e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.393615669358
                                         uncertainty =       0.004916253482

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.393615669358
                                         uncertainty =       0.004916253482

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000443729653
  error estimate for blocks of size 2^( 2) =       0.000458438215
  error estimate for blocks of size 2^( 3) =       0.000472877273
  error estimate for blocks of size 2^( 4) =       0.000485529224
  error estimate for blocks of size 2^( 5) =       0.000497809255
  error estimate for blocks of size 2^( 6) =       0.000508555570
  error estimate for blocks of size 2^( 7) =       0.000514405098

      target function =                  N/A
              le_mean =     -16.893643071069
             les_mean =     285.788968025767
             stat err =       0.000501574787
             autocorr =       1.277716460928
              std dev =       0.627528493353
             le_variance =       0.393792009970

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.393505435868
                                         uncertainty =       0.004914902662

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.393505435868
                                         uncertainty =       0.004914902662

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000443667570
  error estimate for blocks of size 2^( 2) =       0.000458380877
  error estimate for blocks of size 2^( 3) =       0.000472822952
  error estimate for blocks of size 2^( 4) =       0.000485473468
  error estimate for blocks of size 2^( 5) =       0.000497752135
  error estimate for blocks of size 2^( 6) =       0.000508501388
  error estimate for blocks of size 2^( 7) =       0.000514346320

      target function =                  N/A
              le_mean =     -16.893643383815
             les_mean =     285.788868408492
             stat err =       0.000501518328
             autocorr =       1.277786357288
              std dev =       0.627440695056
             le_variance =       0.393681825812

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.393530984839
                                         uncertainty =       0.004915589288

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.393530984839
                                         uncertainty =       0.004915589288

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000443681958
  error estimate for blocks of size 2^( 2) =       0.000458394013
  error estimate for blocks of size 2^( 3) =       0.000472835688
  error estimate for blocks of size 2^( 4) =       0.000485486850
  error estimate for blocks of size 2^( 5) =       0.000497766066
  error estimate for blocks of size 2^( 6) =       0.000508514647
  error estimate for blocks of size 2^( 7) =       0.000514360605

      target function =                  N/A
              le_mean =     -16.893643031954
             les_mean =     285.788882053682
             stat err =       0.000501532042
             autocorr =       1.277773366637
              std dev =       0.627461042189
             le_variance =       0.393707359465

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.393603623307
                                         uncertainty =       0.004916177845

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.393603623307
                                         uncertainty =       0.004916177845

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000443722869
  error estimate for blocks of size 2^( 2) =       0.000458431926
  error estimate for blocks of size 2^( 3) =       0.000472871363
  error estimate for blocks of size 2^( 4) =       0.000485523207
  error estimate for blocks of size 2^( 5) =       0.000497803103
  error estimate for blocks of size 2^( 6) =       0.000508549733
  error estimate for blocks of size 2^( 7) =       0.000514398738

      target function =                  N/A
              le_mean =     -16.893643038950
             les_mean =     285.788954899487
             stat err =       0.000501568695
             autocorr =       1.277724495753
              std dev =       0.627518899260
             le_variance =       0.393779968928


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.893643071069        initial
     6.1035e-01     6.1035e+00             5.1343e-04       -16.893643383815  <--
     2.4414e+00     2.4414e+01             1.2564e-04       -16.893643031954
     9.7656e+00     9.7656e+01             3.1573e-05       -16.893643038950

*****************************************************************************
Applying the update for shift_i =   6.1035e-01     and shift_s =   6.1035e+00
*****************************************************************************

  Execution time = 3.0329e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.026745e-01 1 1  ON 0
 uu_1                 1.394947e-01 1 1  ON 1
 uu_2                 4.179019e-02 1 1  ON 2
 uu_3                -1.925757e-02 1 1  ON 3
 uu_4                -6.283707e-02 1 1  ON 4
 uu_5                -9.494224e-02 1 1  ON 5
 uu_6                -1.196370e-01 1 1  ON 6
 uu_7                -1.300213e-01 1 1  ON 7
 uu_8                -1.200465e-01 1 1  ON 8
 uu_9                -9.348209e-02 1 1  ON 9
 ud_0                 4.117826e-01 1 1  ON 10
 ud_1                 1.585154e-01 1 1  ON 11
 ud_2                 6.116688e-02 1 1  ON 12
 ud_3                 2.741813e-03 1 1  ON 13
 ud_4                -5.673116e-02 1 1  ON 14
 ud_5                -1.010508e-01 1 1  ON 15
 ud_6                -1.285812e-01 1 1  ON 16
 ud_7                -1.432116e-01 1 1  ON 17
 ud_8                -1.429078e-01 1 1  ON 18
 ud_9                -1.358359e-01 1 1  ON 19
 eO_0                -7.040223e-01 1 1  ON 20
 eO_1                -4.135017e-01 1 1  ON 21
 eO_2                -3.138624e-02 1 1  ON 22
 eO_3                 2.692066e-01 1 1  ON 23
 eO_4                 4.913272e-01 1 1  ON 24
 eO_5                 4.589100e-01 1 1  ON 25
 eO_6                 2.354081e-01 1 1  ON 26
 eO_7                -5.702838e-02 1 1  ON 27
 eO_8                -1.951445e-01 1 1  ON 28
 eO_9                -5.680144e-02 1 1  ON 29
eH1_0                -2.085979e-01 1 1  ON 30
eH1_1                -1.260692e-01 1 1  ON 31
eH1_2                -8.739412e-02 1 1  ON 32
eH1_3                -3.687304e-02 1 1  ON 33
eH1_4                 1.182548e-02 1 1  ON 34
eH1_5                 4.444879e-02 1 1  ON 35
eH1_6                 9.465445e-02 1 1  ON 36
eH1_7                 1.373834e-01 1 1  ON 37
eH1_8                 1.445156e-01 1 1  ON 38
eH1_9                 3.118820e-02 1 1  ON 39
eH2_0                -2.081417e-01 1 1  ON 40
eH2_1                -1.255232e-01 1 1  ON 41
eH2_2                -8.645227e-02 1 1  ON 42
eH2_3                -3.566552e-02 1 1  ON 43
eH2_4                 1.354634e-02 1 1  ON 44
eH2_5                 4.826269e-02 1 1  ON 45
eH2_6                 1.009536e-01 1 1  ON 46
eH2_7                 1.498471e-01 1 1  ON 47
eH2_8                 1.515645e-01 1 1  ON 48
eH2_9                 1.051848e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.0612e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6892e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.9295
    reference variance = 0.40579
====================================================
  Execution time = 2.1222e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6893e+01
  VMC Evar = 4.0090e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5744e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.400815125110
                                         uncertainty =       0.006792543576

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.400815125110
                                         uncertainty =       0.006792543576

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000447715581
  error estimate for blocks of size 2^( 2) =       0.000462117509
  error estimate for blocks of size 2^( 3) =       0.000477491506
  error estimate for blocks of size 2^( 4) =       0.000491864573
  error estimate for blocks of size 2^( 5) =       0.000503652255
  error estimate for blocks of size 2^( 6) =       0.000512772267
  error estimate for blocks of size 2^( 7) =       0.000523398315

      target function =                  N/A
              le_mean =     -16.893435011853
             les_mean =     285.789044782179
             stat err =       0.000507921852
             autocorr =       1.287032099824
              std dev =       0.633165446716
             le_variance =       0.400898482915


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689343501185e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.893435011853       residual = 4.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.893435803151       residual = 6.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.893437009529       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.893438294962       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.893439555610       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.893439513698       residual = 6.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.893439218248       residual = 2.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.893440496752       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.893440304238       residual = 6.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.893440463455       residual = 4.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.893440596771       residual = 2.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.893440562148       residual = 6.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e-01 is 1.813152e-03

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.893435011853       residual = 4.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.893435354414       residual = 5.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.893435767173       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.893436313529       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.893436578702       residual = 7.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.893436360211       residual = 2.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.893436308884       residual = 8.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.893436468765       residual = 2.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.893436477359       residual = 6.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-01 is 4.489979e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.893435011853       residual = 4.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.893435116665       residual = 5.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.893435233547       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.893435386354       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.893435461705       residual = 7.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.893435402272       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.893435352701       residual = 3.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.893435404749       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.893435393082       residual = 2.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+00 is 1.140051e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.145511 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6811e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.025735e-01 1 1  ON 0
 uu_1                 1.395860e-01 1 1  ON 1
 uu_2                 4.175289e-02 1 1  ON 2
 uu_3                -1.928042e-02 1 1  ON 3
 uu_4                -6.298412e-02 1 1  ON 4
 uu_5                -9.513774e-02 1 1  ON 5
 uu_6                -1.198543e-01 1 1  ON 6
 uu_7                -1.302635e-01 1 1  ON 7
 uu_8                -1.199533e-01 1 1  ON 8
 uu_9                -9.330767e-02 1 1  ON 9
 ud_0                 4.115791e-01 1 1  ON 10
 ud_1                 1.584326e-01 1 1  ON 11
 ud_2                 6.100365e-02 1 1  ON 12
 ud_3                 2.753027e-03 1 1  ON 13
 ud_4                -5.679608e-02 1 1  ON 14
 ud_5                -1.011044e-01 1 1  ON 15
 ud_6                -1.285699e-01 1 1  ON 16
 ud_7                -1.432970e-01 1 1  ON 17
 ud_8                -1.426115e-01 1 1  ON 18
 ud_9                -1.354927e-01 1 1  ON 19
 eO_0                -7.042350e-01 1 1  ON 20
 eO_1                -4.134676e-01 1 1  ON 21
 eO_2                -3.142646e-02 1 1  ON 22
 eO_3                 2.692072e-01 1 1  ON 23
 eO_4                 4.913355e-01 1 1  ON 24
 eO_5                 4.590481e-01 1 1  ON 25
 eO_6                 2.354797e-01 1 1  ON 26
 eO_7                -5.677817e-02 1 1  ON 27
 eO_8                -1.952222e-01 1 1  ON 28
 eO_9                -5.694534e-02 1 1  ON 29
eH1_0                -2.089018e-01 1 1  ON 30
eH1_1                -1.262788e-01 1 1  ON 31
eH1_2                -8.757549e-02 1 1  ON 32
eH1_3                -3.690398e-02 1 1  ON 33
eH1_4                 1.177084e-02 1 1  ON 34
eH1_5                 4.451273e-02 1 1  ON 35
eH1_6                 9.462448e-02 1 1  ON 36
eH1_7                 1.374443e-01 1 1  ON 37
eH1_8                 1.447471e-01 1 1  ON 38
eH1_9                 3.153108e-02 1 1  ON 39
eH2_0                -2.082357e-01 1 1  ON 40
eH2_1                -1.256481e-01 1 1  ON 41
eH2_2                -8.662963e-02 1 1  ON 42
eH2_3                -3.581403e-02 1 1  ON 43
eH2_4                 1.334034e-02 1 1  ON 44
eH2_5                 4.819396e-02 1 1  ON 45
eH2_6                 1.008520e-01 1 1  ON 46
eH2_7                 1.498083e-01 1 1  ON 47
eH2_8                 1.519996e-01 1 1  ON 48
eH2_9                 1.096748e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.863
    reference variance = 0.331765
====================================================
  Execution time = 2.0404e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6894e+01
  VMC Evar = 3.9165e-01
  Total weights = 2.0000e+06
  Execution time = 1.8900e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.391791761196
                                         uncertainty =       0.007558404920

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.391791761196
                                         uncertainty =       0.007558404920

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000442531994
  error estimate for blocks of size 2^( 2) =       0.000456893724
  error estimate for blocks of size 2^( 3) =       0.000471417868
  error estimate for blocks of size 2^( 4) =       0.000483904737
  error estimate for blocks of size 2^( 5) =       0.000495864662
  error estimate for blocks of size 2^( 6) =       0.000503600464
  error estimate for blocks of size 2^( 7) =       0.000510342439

      target function =                  N/A
              le_mean =     -16.893854921837
             les_mean =     285.794003054967
             stat err =       0.000498428075
             autocorr =       1.268573531902
              std dev =       0.625834747147
             le_variance =       0.391669130736

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.391771869646
                                         uncertainty =       0.007554335122

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.391771869646
                                         uncertainty =       0.007554335122

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000442520708
  error estimate for blocks of size 2^( 2) =       0.000456886876
  error estimate for blocks of size 2^( 3) =       0.000471415395
  error estimate for blocks of size 2^( 4) =       0.000483904865
  error estimate for blocks of size 2^( 5) =       0.000495859810
  error estimate for blocks of size 2^( 6) =       0.000503593197
  error estimate for blocks of size 2^( 7) =       0.000510321072

      target function =                  N/A
              le_mean =     -16.893857007428
             les_mean =     285.794053546223
             stat err =       0.000498419736
             autocorr =       1.268595784377
              std dev =       0.625818787374
             le_variance =       0.391649154631

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.391747925606
                                         uncertainty =       0.007554032653

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.391747925606
                                         uncertainty =       0.007554032653

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000442507187
  error estimate for blocks of size 2^( 2) =       0.000456871004
  error estimate for blocks of size 2^( 3) =       0.000471397684
  error estimate for blocks of size 2^( 4) =       0.000483887045
  error estimate for blocks of size 2^( 5) =       0.000495844435
  error estimate for blocks of size 2^( 6) =       0.000503579388
  error estimate for blocks of size 2^( 7) =       0.000510314635

      target function =                  N/A
              le_mean =     -16.893856567578
             les_mean =     285.794014751823
             stat err =       0.000498406376
             autocorr =       1.268605296666
              std dev =       0.625799665821
             le_variance =       0.391625221741

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.391780659855
                                         uncertainty =       0.007557524793

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.391780659855
                                         uncertainty =       0.007557524793

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000442525713
  error estimate for blocks of size 2^( 2) =       0.000456887655
  error estimate for blocks of size 2^( 3) =       0.000471412160
  error estimate for blocks of size 2^( 4) =       0.000483899453
  error estimate for blocks of size 2^( 5) =       0.000495858974
  error estimate for blocks of size 2^( 6) =       0.000503594694
  error estimate for blocks of size 2^( 7) =       0.000510336052

      target function =                  N/A
              le_mean =     -16.893855109828
             les_mean =     285.793998289343
             stat err =       0.000498422293
             autocorr =       1.268580108532
              std dev =       0.625825864996
             le_variance =       0.391658013298


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.893854921837        initial
     1.5259e-01     1.5259e+00             1.8132e-03       -16.893857007428  <--
     6.1035e-01     6.1035e+00             4.4900e-04       -16.893856567578
     2.4414e+00     2.4414e+01             1.1401e-04       -16.893855109828

*****************************************************************************
Applying the update for shift_i =   1.5259e-01     and shift_s =   1.5259e+00
*****************************************************************************

  Execution time = 2.9991e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.024809e-01 1 1  ON 0
 uu_1                 1.395938e-01 1 1  ON 1
 uu_2                 4.164756e-02 1 1  ON 2
 uu_3                -1.943850e-02 1 1  ON 3
 uu_4                -6.328846e-02 1 1  ON 4
 uu_5                -9.566748e-02 1 1  ON 5
 uu_6                -1.203283e-01 1 1  ON 6
 uu_7                -1.309009e-01 1 1  ON 7
 uu_8                -1.199432e-01 1 1  ON 8
 uu_9                -9.288442e-02 1 1  ON 9
 ud_0                 4.112686e-01 1 1  ON 10
 ud_1                 1.582134e-01 1 1  ON 11
 ud_2                 6.075784e-02 1 1  ON 12
 ud_3                 2.640571e-03 1 1  ON 13
 ud_4                -5.694237e-02 1 1  ON 14
 ud_5                -1.012506e-01 1 1  ON 15
 ud_6                -1.286154e-01 1 1  ON 16
 ud_7                -1.434956e-01 1 1  ON 17
 ud_8                -1.420805e-01 1 1  ON 18
 ud_9                -1.345753e-01 1 1  ON 19
 eO_0                -7.045790e-01 1 1  ON 20
 eO_1                -4.135703e-01 1 1  ON 21
 eO_2                -3.154835e-02 1 1  ON 22
 eO_3                 2.692029e-01 1 1  ON 23
 eO_4                 4.913758e-01 1 1  ON 24
 eO_5                 4.594370e-01 1 1  ON 25
 eO_6                 2.357686e-01 1 1  ON 26
 eO_7                -5.608849e-02 1 1  ON 27
 eO_8                -1.955193e-01 1 1  ON 28
 eO_9                -5.739622e-02 1 1  ON 29
eH1_0                -2.096481e-01 1 1  ON 30
eH1_1                -1.267963e-01 1 1  ON 31
eH1_2                -8.799964e-02 1 1  ON 32
eH1_3                -3.718655e-02 1 1  ON 33
eH1_4                 1.157089e-02 1 1  ON 34
eH1_5                 4.456685e-02 1 1  ON 35
eH1_6                 9.450978e-02 1 1  ON 36
eH1_7                 1.376198e-01 1 1  ON 37
eH1_8                 1.454230e-01 1 1  ON 38
eH1_9                 3.257049e-02 1 1  ON 39
eH2_0                -2.085893e-01 1 1  ON 40
eH2_1                -1.260569e-01 1 1  ON 41
eH2_2                -8.709865e-02 1 1  ON 42
eH2_3                -3.626034e-02 1 1  ON 43
eH2_4                 1.280834e-02 1 1  ON 44
eH2_5                 4.791610e-02 1 1  ON 45
eH2_6                 1.005621e-01 1 1  ON 46
eH2_7                 1.497002e-01 1 1  ON 47
eH2_8                 1.532877e-01 1 1  ON 48
eH2_9                 1.233163e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6808e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6892e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.9036
    reference variance = 0.266261
====================================================
  Execution time = 2.1074e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6894e+01
  VMC Evar = 4.0416e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5432e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.404284772963
                                         uncertainty =       0.005264352469

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.404284772963
                                         uncertainty =       0.005264352469

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000449533376
  error estimate for blocks of size 2^( 2) =       0.000462937642
  error estimate for blocks of size 2^( 3) =       0.000476762304
  error estimate for blocks of size 2^( 4) =       0.000490014835
  error estimate for blocks of size 2^( 5) =       0.000501583603
  error estimate for blocks of size 2^( 6) =       0.000510773803
  error estimate for blocks of size 2^( 7) =       0.000516526265

      target function =                  N/A
              le_mean =     -16.893959749517
             les_mean =     285.810036327990
             stat err =       0.000504724626
             autocorr =       1.260622653814
              std dev =       0.635736196686
             le_variance =       0.404160511777


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689395974952e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-02, overlap shift 3.8147e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.893959749517       residual = 3.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.893960401166       residual = 4.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.893958816763       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.893959611884       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.893966183430       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.893967894009       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.893967117899       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.893969053636       residual = 7.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.893968914186       residual = 4.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.893968741582       residual = 5.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.893968613105       residual = 1.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.893968238788       residual = 9.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.893968894118       residual = 3.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.893969093693       residual = 1.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.893969504844       residual = 5.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-02 is 5.919335e-03

solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.893959749517       residual = 3.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.893960181162       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.893959245908       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.893959155244       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.893962629045       residual = 8.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.893962610368       residual = 5.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.893962759073       residual = 2.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.893962475147       residual = 6.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.893962831611       residual = 8.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.893962532112       residual = 1.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.893962438407       residual = 4.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e-01 is 1.497644e-03

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.893959749517       residual = 3.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.893959933161       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.893959577537       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.893959436369       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.893960621355       residual = 4.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.893960376866       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.893960443773       residual = 7.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.893960338853       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.893960368130       residual = 5.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-01 is 3.715597e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.150634 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6631e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.026121e-01 1 1  ON 0
 uu_1                 1.393486e-01 1 1  ON 1
 uu_2                 4.168452e-02 1 1  ON 2
 uu_3                -1.944687e-02 1 1  ON 3
 uu_4                -6.344990e-02 1 1  ON 4
 uu_5                -9.599975e-02 1 1  ON 5
 uu_6                -1.206368e-01 1 1  ON 6
 uu_7                -1.308323e-01 1 1  ON 7
 uu_8                -1.208684e-01 1 1  ON 8
 uu_9                -9.322878e-02 1 1  ON 9
 ud_0                 4.115574e-01 1 1  ON 10
 ud_1                 1.584286e-01 1 1  ON 11
 ud_2                 6.100046e-02 1 1  ON 12
 ud_3                 2.693599e-03 1 1  ON 13
 ud_4                -5.716533e-02 1 1  ON 14
 ud_5                -1.015454e-01 1 1  ON 15
 ud_6                -1.291134e-01 1 1  ON 16
 ud_7                -1.439865e-01 1 1  ON 17
 ud_8                -1.426422e-01 1 1  ON 18
 ud_9                -1.339043e-01 1 1  ON 19
 eO_0                -7.042163e-01 1 1  ON 20
 eO_1                -4.139385e-01 1 1  ON 21
 eO_2                -3.153413e-02 1 1  ON 22
 eO_3                 2.692513e-01 1 1  ON 23
 eO_4                 4.920449e-01 1 1  ON 24
 eO_5                 4.599661e-01 1 1  ON 25
 eO_6                 2.362476e-01 1 1  ON 26
 eO_7                -5.561100e-02 1 1  ON 27
 eO_8                -1.968982e-01 1 1  ON 28
 eO_9                -5.817115e-02 1 1  ON 29
eH1_0                -2.104481e-01 1 1  ON 30
eH1_1                -1.278496e-01 1 1  ON 31
eH1_2                -8.864563e-02 1 1  ON 32
eH1_3                -3.778011e-02 1 1  ON 33
eH1_4                 1.120211e-02 1 1  ON 34
eH1_5                 4.467304e-02 1 1  ON 35
eH1_6                 9.509487e-02 1 1  ON 36
eH1_7                 1.382481e-01 1 1  ON 37
eH1_8                 1.466282e-01 1 1  ON 38
eH1_9                 3.347603e-02 1 1  ON 39
eH2_0                -2.091330e-01 1 1  ON 40
eH2_1                -1.269636e-01 1 1  ON 41
eH2_2                -8.756218e-02 1 1  ON 42
eH2_3                -3.674895e-02 1 1  ON 43
eH2_4                 1.314729e-02 1 1  ON 44
eH2_5                 4.831024e-02 1 1  ON 45
eH2_6                 1.001360e-01 1 1  ON 46
eH2_7                 1.491985e-01 1 1  ON 47
eH2_8                 1.543930e-01 1 1  ON 48
eH2_9                 1.382927e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.9101
    reference variance = 0.593999
====================================================
  Execution time = 2.0494e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6894e+01
  VMC Evar = 4.7437e-01
  Total weights = 2.0000e+06
  Execution time = 1.8886e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474150125244
                                         uncertainty =       0.050411847541

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474150125244
                                         uncertainty =       0.050411847541

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486990101
  error estimate for blocks of size 2^( 2) =       0.000500131965
  error estimate for blocks of size 2^( 3) =       0.000513913868
  error estimate for blocks of size 2^( 4) =       0.000525980428
  error estimate for blocks of size 2^( 5) =       0.000535772386
  error estimate for blocks of size 2^( 6) =       0.000542462780
  error estimate for blocks of size 2^( 7) =       0.000545140942

      target function =                  N/A
              le_mean =     -16.894074231895
             les_mean =     285.884062632452
             stat err =       0.000537339134
             autocorr =       1.217465533915
              std dev =       0.688708005494
             le_variance =       0.474318716831

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474374967177
                                         uncertainty =       0.050473796242

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474374967177
                                         uncertainty =       0.050473796242

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487105995
  error estimate for blocks of size 2^( 2) =       0.000500243655
  error estimate for blocks of size 2^( 3) =       0.000514018079
  error estimate for blocks of size 2^( 4) =       0.000526072663
  error estimate for blocks of size 2^( 5) =       0.000535846146
  error estimate for blocks of size 2^( 6) =       0.000542516551
  error estimate for blocks of size 2^( 7) =       0.000545183973

      target function =                  N/A
              le_mean =     -16.894073592802
             les_mean =     285.884266822425
             stat err =       0.000537404833
             autocorr =       1.217183864349
              std dev =       0.688871904407
             le_variance =       0.474544500681

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474273799688
                                         uncertainty =       0.050468584286

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474273799688
                                         uncertainty =       0.050468584286

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000487053853
  error estimate for blocks of size 2^( 2) =       0.000500194309
  error estimate for blocks of size 2^( 3) =       0.000513973711
  error estimate for blocks of size 2^( 4) =       0.000526035091
  error estimate for blocks of size 2^( 5) =       0.000535813203
  error estimate for blocks of size 2^( 6) =       0.000542490622
  error estimate for blocks of size 2^( 7) =       0.000545164644

      target function =                  N/A
              le_mean =     -16.894070296346
             les_mean =     285.884053851527
             stat err =       0.000537375890
             autocorr =       1.217313360522
              std dev =       0.688798164112
             le_variance =       0.474442910884

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474157513016
                                         uncertainty =       0.050423438473

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.474157513016
                                         uncertainty =       0.050423438473

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000486993892
  error estimate for blocks of size 2^( 2) =       0.000500135731
  error estimate for blocks of size 2^( 3) =       0.000513917669
  error estimate for blocks of size 2^( 4) =       0.000525984191
  error estimate for blocks of size 2^( 5) =       0.000535773213
  error estimate for blocks of size 2^( 6) =       0.000542461663
  error estimate for blocks of size 2^( 7) =       0.000545140108

      target function =                  N/A
              le_mean =     -16.894072088013
             les_mean =     285.883997580108
             stat err =       0.000537339794
             autocorr =       1.217449566968
              std dev =       0.688713367284
             le_variance =       0.474326102276


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.894074231895        initial  <--
     3.8147e-02     3.8147e-01             5.9193e-03       -16.894073592802
     1.5259e-01     1.5259e+00             1.4976e-03       -16.894070296346
     6.1035e-01     6.1035e+00             3.7156e-04       -16.894072088013

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.2006
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.024809e-01 1 1  ON 0
 uu_1                 1.395938e-01 1 1  ON 1
 uu_2                 4.164756e-02 1 1  ON 2
 uu_3                -1.943850e-02 1 1  ON 3
 uu_4                -6.328846e-02 1 1  ON 4
 uu_5                -9.566748e-02 1 1  ON 5
 uu_6                -1.203283e-01 1 1  ON 6
 uu_7                -1.309009e-01 1 1  ON 7
 uu_8                -1.199432e-01 1 1  ON 8
 uu_9                -9.288442e-02 1 1  ON 9
 ud_0                 4.112686e-01 1 1  ON 10
 ud_1                 1.582134e-01 1 1  ON 11
 ud_2                 6.075784e-02 1 1  ON 12
 ud_3                 2.640571e-03 1 1  ON 13
 ud_4                -5.694237e-02 1 1  ON 14
 ud_5                -1.012506e-01 1 1  ON 15
 ud_6                -1.286154e-01 1 1  ON 16
 ud_7                -1.434956e-01 1 1  ON 17
 ud_8                -1.420805e-01 1 1  ON 18
 ud_9                -1.345753e-01 1 1  ON 19
 eO_0                -7.045790e-01 1 1  ON 20
 eO_1                -4.135703e-01 1 1  ON 21
 eO_2                -3.154835e-02 1 1  ON 22
 eO_3                 2.692029e-01 1 1  ON 23
 eO_4                 4.913758e-01 1 1  ON 24
 eO_5                 4.594370e-01 1 1  ON 25
 eO_6                 2.357686e-01 1 1  ON 26
 eO_7                -5.608849e-02 1 1  ON 27
 eO_8                -1.955193e-01 1 1  ON 28
 eO_9                -5.739622e-02 1 1  ON 29
eH1_0                -2.096481e-01 1 1  ON 30
eH1_1                -1.267963e-01 1 1  ON 31
eH1_2                -8.799964e-02 1 1  ON 32
eH1_3                -3.718655e-02 1 1  ON 33
eH1_4                 1.157089e-02 1 1  ON 34
eH1_5                 4.456685e-02 1 1  ON 35
eH1_6                 9.450978e-02 1 1  ON 36
eH1_7                 1.376198e-01 1 1  ON 37
eH1_8                 1.454230e-01 1 1  ON 38
eH1_9                 3.257049e-02 1 1  ON 39
eH2_0                -2.085893e-01 1 1  ON 40
eH2_1                -1.260569e-01 1 1  ON 41
eH2_2                -8.709865e-02 1 1  ON 42
eH2_3                -3.626034e-02 1 1  ON 43
eH2_4                 1.280834e-02 1 1  ON 44
eH2_5                 4.791610e-02 1 1  ON 45
eH2_6                 1.005621e-01 1 1  ON 46
eH2_7                 1.497002e-01 1 1  ON 47
eH2_8                 1.532877e-01 1 1  ON 48
eH2_9                 1.233163e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6837e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6893e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.8598
    reference variance = 0.366306
====================================================
  Execution time = 2.0867e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6893e+01
  VMC Evar = 4.1639e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6043e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.416480161506
                                         uncertainty =       0.007686246615

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.416480161506
                                         uncertainty =       0.007686246615

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000456281904
  error estimate for blocks of size 2^( 2) =       0.000470423934
  error estimate for blocks of size 2^( 3) =       0.000484934817
  error estimate for blocks of size 2^( 4) =       0.000497189560
  error estimate for blocks of size 2^( 5) =       0.000507328433
  error estimate for blocks of size 2^( 6) =       0.000516414506
  error estimate for blocks of size 2^( 7) =       0.000521721392

      target function =                  N/A
              le_mean =     -16.893045867190
             les_mean =     285.791384814702
             stat err =       0.000510663473
             autocorr =       1.252573150872
              std dev =       0.645280056949
             le_variance =       0.416386351897


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689304586719e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.893045867190       residual = 5.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.893047543344       residual = 4.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.893047438033       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.893046899790       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.893047452141       residual = 6.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.893047158936       residual = 3.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.893047027328       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.893048040738       residual = 4.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.893047982344       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.893047987244       residual = 4.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-01 is 6.914198e-04

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.893045867190       residual = 5.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.893046446523       residual = 5.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.893046517497       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.893046196183       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.893046328432       residual = 4.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.893046311048       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.893046108723       residual = 6.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.893046349896       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.893046367315       residual = 2.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+00 is 2.015945e-04

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.893045867190       residual = 5.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.893046027339       residual = 5.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.893046060748       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.893045966852       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.893045990129       residual = 4.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.893045991846       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.893045930801       residual = 3.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.893045977201       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.893045985481       residual = 9.55e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+00 is 5.313801e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.154031 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6483e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.025725e-01 1 1  ON 0
 uu_1                 1.395817e-01 1 1  ON 1
 uu_2                 4.161735e-02 1 1  ON 2
 uu_3                -1.944586e-02 1 1  ON 3
 uu_4                -6.330009e-02 1 1  ON 4
 uu_5                -9.572923e-02 1 1  ON 5
 uu_6                -1.203924e-01 1 1  ON 6
 uu_7                -1.309392e-01 1 1  ON 7
 uu_8                -1.200435e-01 1 1  ON 8
 uu_9                -9.285628e-02 1 1  ON 9
 ud_0                 4.113263e-01 1 1  ON 10
 ud_1                 1.582462e-01 1 1  ON 11
 ud_2                 6.081050e-02 1 1  ON 12
 ud_3                 2.663283e-03 1 1  ON 13
 ud_4                -5.701175e-02 1 1  ON 14
 ud_5                -1.013267e-01 1 1  ON 15
 ud_6                -1.286182e-01 1 1  ON 16
 ud_7                -1.434972e-01 1 1  ON 17
 ud_8                -1.421786e-01 1 1  ON 18
 ud_9                -1.345457e-01 1 1  ON 19
 eO_0                -7.044675e-01 1 1  ON 20
 eO_1                -4.136320e-01 1 1  ON 21
 eO_2                -3.164890e-02 1 1  ON 22
 eO_3                 2.692041e-01 1 1  ON 23
 eO_4                 4.914518e-01 1 1  ON 24
 eO_5                 4.594794e-01 1 1  ON 25
 eO_6                 2.358345e-01 1 1  ON 26
 eO_7                -5.604858e-02 1 1  ON 27
 eO_8                -1.956220e-01 1 1  ON 28
 eO_9                -5.746946e-02 1 1  ON 29
eH1_0                -2.097085e-01 1 1  ON 30
eH1_1                -1.269979e-01 1 1  ON 31
eH1_2                -8.809685e-02 1 1  ON 32
eH1_3                -3.722961e-02 1 1  ON 33
eH1_4                 1.158559e-02 1 1  ON 34
eH1_5                 4.461229e-02 1 1  ON 35
eH1_6                 9.457282e-02 1 1  ON 36
eH1_7                 1.377593e-01 1 1  ON 37
eH1_8                 1.454890e-01 1 1  ON 38
eH1_9                 3.263683e-02 1 1  ON 39
eH2_0                -2.086396e-01 1 1  ON 40
eH2_1                -1.261949e-01 1 1  ON 41
eH2_2                -8.718050e-02 1 1  ON 42
eH2_3                -3.629498e-02 1 1  ON 43
eH2_4                 1.284124e-02 1 1  ON 44
eH2_5                 4.792579e-02 1 1  ON 45
eH2_6                 1.005737e-01 1 1  ON 46
eH2_7                 1.496737e-01 1 1  ON 47
eH2_8                 1.534019e-01 1 1  ON 48
eH2_9                 1.247978e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.8365
    reference variance = 0.235005
====================================================
  Execution time = 2.0342e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6894e+01
  VMC Evar = 3.9129e-01
  Total weights = 2.0000e+06
  Execution time = 1.8886e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.391342900946
                                         uncertainty =       0.003456464221

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.391342900946
                                         uncertainty =       0.003456464221

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000442291082
  error estimate for blocks of size 2^( 2) =       0.000457129676
  error estimate for blocks of size 2^( 3) =       0.000472580882
  error estimate for blocks of size 2^( 4) =       0.000486742058
  error estimate for blocks of size 2^( 5) =       0.000500046690
  error estimate for blocks of size 2^( 6) =       0.000508442840
  error estimate for blocks of size 2^( 7) =       0.000514893628

      target function =                  N/A
              le_mean =     -16.894129897146
             les_mean =     285.802867587638
             stat err =       0.000502531304
             autocorr =       1.290951349760
              std dev =       0.625494046032
             le_variance =       0.391242801621

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.391452720785
                                         uncertainty =       0.003456298468

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.391452720785
                                         uncertainty =       0.003456298468

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000442353127
  error estimate for blocks of size 2^( 2) =       0.000457187470
  error estimate for blocks of size 2^( 3) =       0.000472632027
  error estimate for blocks of size 2^( 4) =       0.000486787990
  error estimate for blocks of size 2^( 5) =       0.000500087170
  error estimate for blocks of size 2^( 6) =       0.000508485625
  error estimate for blocks of size 2^( 7) =       0.000514939261

      target function =                  N/A
              le_mean =     -16.894132292061
             les_mean =     285.803058283912
             stat err =       0.000502575012
             autocorr =       1.290813739847
              std dev =       0.625581791558
             le_variance =       0.391352577928

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.391437502045
                                         uncertainty =       0.003456412903

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.391437502045
                                         uncertainty =       0.003456412903

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000442344529
  error estimate for blocks of size 2^( 2) =       0.000457179618
  error estimate for blocks of size 2^( 3) =       0.000472626164
  error estimate for blocks of size 2^( 4) =       0.000486783830
  error estimate for blocks of size 2^( 5) =       0.000500083786
  error estimate for blocks of size 2^( 6) =       0.000508481654
  error estimate for blocks of size 2^( 7) =       0.000514934394

      target function =                  N/A
              le_mean =     -16.894131713035
             les_mean =     285.803023506228
             stat err =       0.000502570916
             autocorr =       1.290842883324
              std dev =       0.625569632042
             le_variance =       0.391337364533

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.391356924040
                                         uncertainty =       0.003456459781

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.391356924040
                                         uncertainty =       0.003456459781

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000442299005
  error estimate for blocks of size 2^( 2) =       0.000457137077
  error estimate for blocks of size 2^( 3) =       0.000472587641
  error estimate for blocks of size 2^( 4) =       0.000486748331
  error estimate for blocks of size 2^( 5) =       0.000500052258
  error estimate for blocks of size 2^( 6) =       0.000508448648
  error estimate for blocks of size 2^( 7) =       0.000514899714

      target function =                  N/A
              le_mean =     -16.894130136199
             les_mean =     285.802889682256
             stat err =       0.000502537238
             autocorr =       1.290935585231
              std dev =       0.625505251027
             le_variance =       0.391256819062


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.894129897146        initial
     3.8147e-01     3.8147e+00             6.9142e-04       -16.894132292061  <--
     1.5259e+00     1.5259e+01             2.0159e-04       -16.894131713035
     6.1035e+00     6.1035e+01             5.3138e-05       -16.894130136199

*****************************************************************************
Applying the update for shift_i =   3.8147e-01     and shift_s =   3.8147e+00
*****************************************************************************

  Execution time = 2.9927e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.027108e-01 1 1  ON 0
 uu_1                 1.395499e-01 1 1  ON 1
 uu_2                 4.158458e-02 1 1  ON 2
 uu_3                -1.946409e-02 1 1  ON 3
 uu_4                -6.333239e-02 1 1  ON 4
 uu_5                -9.587524e-02 1 1  ON 5
 uu_6                -1.205706e-01 1 1  ON 6
 uu_7                -1.310580e-01 1 1  ON 7
 uu_8                -1.203232e-01 1 1  ON 8
 uu_9                -9.277332e-02 1 1  ON 9
 ud_0                 4.114416e-01 1 1  ON 10
 ud_1                 1.583401e-01 1 1  ON 11
 ud_2                 6.092685e-02 1 1  ON 12
 ud_3                 2.699750e-03 1 1  ON 13
 ud_4                -5.713986e-02 1 1  ON 14
 ud_5                -1.014997e-01 1 1  ON 15
 ud_6                -1.286687e-01 1 1  ON 16
 ud_7                -1.435029e-01 1 1  ON 17
 ud_8                -1.424319e-01 1 1  ON 18
 ud_9                -1.344547e-01 1 1  ON 19
 eO_0                -7.043100e-01 1 1  ON 20
 eO_1                -4.137154e-01 1 1  ON 21
 eO_2                -3.185752e-02 1 1  ON 22
 eO_3                 2.692030e-01 1 1  ON 23
 eO_4                 4.916456e-01 1 1  ON 24
 eO_5                 4.596091e-01 1 1  ON 25
 eO_6                 2.360353e-01 1 1  ON 26
 eO_7                -5.591968e-02 1 1  ON 27
 eO_8                -1.959242e-01 1 1  ON 28
 eO_9                -5.768884e-02 1 1  ON 29
eH1_0                -2.099404e-01 1 1  ON 30
eH1_1                -1.274877e-01 1 1  ON 31
eH1_2                -8.838243e-02 1 1  ON 32
eH1_3                -3.738645e-02 1 1  ON 33
eH1_4                 1.159942e-02 1 1  ON 34
eH1_5                 4.473069e-02 1 1  ON 35
eH1_6                 9.476145e-02 1 1  ON 36
eH1_7                 1.381756e-01 1 1  ON 37
eH1_8                 1.456924e-01 1 1  ON 38
eH1_9                 3.283823e-02 1 1  ON 39
eH2_0                -2.088198e-01 1 1  ON 40
eH2_1                -1.265485e-01 1 1  ON 41
eH2_2                -8.741031e-02 1 1  ON 42
eH2_3                -3.640778e-02 1 1  ON 43
eH2_4                 1.289653e-02 1 1  ON 44
eH2_5                 4.794967e-02 1 1  ON 45
eH2_6                 1.006131e-01 1 1  ON 46
eH2_7                 1.496008e-01 1 1  ON 47
eH2_8                 1.537439e-01 1 1  ON 48
eH2_9                 1.292423e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6415e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6890e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.9158
    reference variance = 0.210037
====================================================
  Execution time = 2.1008e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6895e+01
  VMC Evar = 4.0133e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5348e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.401411494735
                                         uncertainty =       0.006060573037

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.401411494735
                                         uncertainty =       0.006060573037

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000447955135
  error estimate for blocks of size 2^( 2) =       0.000462461516
  error estimate for blocks of size 2^( 3) =       0.000477604725
  error estimate for blocks of size 2^( 4) =       0.000490797625
  error estimate for blocks of size 2^( 5) =       0.000503067385
  error estimate for blocks of size 2^( 6) =       0.000512177137
  error estimate for blocks of size 2^( 7) =       0.000518555044

      target function =                  N/A
              le_mean =     -16.894778653680
             les_mean =     285.834873161718
             stat err =       0.000506149298
             autocorr =       1.276698179207
              std dev =       0.633504226938
             le_variance =       0.401327605549


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689477865368e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-02, overlap shift 9.5367e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.894778653680       residual = 8.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.894778954027       residual = 3.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.894780978164       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.894784038665       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.894786287184       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.894787308052       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.894787085536       residual = 3.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.894787603252       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.894788535023       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.894787705500       residual = 4.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.894788138321       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.894787925682       residual = 8.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-02 is 2.704835e-03

solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.894778653680       residual = 8.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.894778784966       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.894779964262       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.894781287340       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.894781421948       residual = 8.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.894782076459       residual = 3.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.894781904160       residual = 7.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.894781751066       residual = 3.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.894781976253       residual = 8.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-01 is 6.760410e-04

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.894778653680       residual = 8.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.894778694056       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.894779165649       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.894779594646       residual = 9.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.894779577152       residual = 5.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.894779726178       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.894779634642       residual = 2.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.894779675444       residual = 9.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+00 is 1.689876e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.157729 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6555e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.024289e-01 1 1  ON 0
 uu_1                 1.394638e-01 1 1  ON 1
 uu_2                 4.163081e-02 1 1  ON 2
 uu_3                -1.964165e-02 1 1  ON 3
 uu_4                -6.339770e-02 1 1  ON 4
 uu_5                -9.578060e-02 1 1  ON 5
 uu_6                -1.205379e-01 1 1  ON 6
 uu_7                -1.315932e-01 1 1  ON 7
 uu_8                -1.203176e-01 1 1  ON 8
 uu_9                -9.246629e-02 1 1  ON 9
 ud_0                 4.114050e-01 1 1  ON 10
 ud_1                 1.582688e-01 1 1  ON 11
 ud_2                 6.093773e-02 1 1  ON 12
 ud_3                 2.694562e-03 1 1  ON 13
 ud_4                -5.713603e-02 1 1  ON 14
 ud_5                -1.015323e-01 1 1  ON 15
 ud_6                -1.287795e-01 1 1  ON 16
 ud_7                -1.436147e-01 1 1  ON 17
 ud_8                -1.424434e-01 1 1  ON 18
 ud_9                -1.341792e-01 1 1  ON 19
 eO_0                -7.043372e-01 1 1  ON 20
 eO_1                -4.138488e-01 1 1  ON 21
 eO_2                -3.188415e-02 1 1  ON 22
 eO_3                 2.692514e-01 1 1  ON 23
 eO_4                 4.918884e-01 1 1  ON 24
 eO_5                 4.597502e-01 1 1  ON 25
 eO_6                 2.363478e-01 1 1  ON 26
 eO_7                -5.578391e-02 1 1  ON 27
 eO_8                -1.962646e-01 1 1  ON 28
 eO_9                -5.799865e-02 1 1  ON 29
eH1_0                -2.102383e-01 1 1  ON 30
eH1_1                -1.277641e-01 1 1  ON 31
eH1_2                -8.875462e-02 1 1  ON 32
eH1_3                -3.783927e-02 1 1  ON 33
eH1_4                 1.136523e-02 1 1  ON 34
eH1_5                 4.451634e-02 1 1  ON 35
eH1_6                 9.494246e-02 1 1  ON 36
eH1_7                 1.386027e-01 1 1  ON 37
eH1_8                 1.463684e-01 1 1  ON 38
eH1_9                 3.337321e-02 1 1  ON 39
eH2_0                -2.091031e-01 1 1  ON 40
eH2_1                -1.268163e-01 1 1  ON 41
eH2_2                -8.755651e-02 1 1  ON 42
eH2_3                -3.672282e-02 1 1  ON 43
eH2_4                 1.280579e-02 1 1  ON 44
eH2_5                 4.820443e-02 1 1  ON 45
eH2_6                 1.005541e-01 1 1  ON 46
eH2_7                 1.495076e-01 1 1  ON 47
eH2_8                 1.542002e-01 1 1  ON 48
eH2_9                 1.347784e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.8639
    reference variance = 0.349682
====================================================
  Execution time = 2.0473e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6894e+01
  VMC Evar = 3.9914e-01
  Total weights = 2.0000e+06
  Execution time = 1.8906e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.399361847762
                                         uncertainty =       0.006401489052

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.399361847762
                                         uncertainty =       0.006401489052

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000446772337
  error estimate for blocks of size 2^( 2) =       0.000460982060
  error estimate for blocks of size 2^( 3) =       0.000475465089
  error estimate for blocks of size 2^( 4) =       0.000487843595
  error estimate for blocks of size 2^( 5) =       0.000499682371
  error estimate for blocks of size 2^( 6) =       0.000506797568
  error estimate for blocks of size 2^( 7) =       0.000509807483

      target function =                  N/A
              le_mean =     -16.893745736189
             les_mean =     285.797855842057
             stat err =       0.000501032754
             autocorr =       1.257649684950
              std dev =       0.631831498628
             le_variance =       0.399211042658

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.399282524815
                                         uncertainty =       0.006399478584

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.399282524815
                                         uncertainty =       0.006399478584

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000446727954
  error estimate for blocks of size 2^( 2) =       0.000460948704
  error estimate for blocks of size 2^( 3) =       0.000475438385
  error estimate for blocks of size 2^( 4) =       0.000487811839
  error estimate for blocks of size 2^( 5) =       0.000499638300
  error estimate for blocks of size 2^( 6) =       0.000506741650
  error estimate for blocks of size 2^( 7) =       0.000509733344

      target function =                  N/A
              le_mean =     -16.893744717721
             les_mean =     285.797742117150
             stat err =       0.000500981283
             autocorr =       1.257641162888
              std dev =       0.631768730790
             le_variance =       0.399131729204

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.399220781957
                                         uncertainty =       0.006398185323

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.399220781957
                                         uncertainty =       0.006398185323

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000446693427
  error estimate for blocks of size 2^( 2) =       0.000460912218
  error estimate for blocks of size 2^( 3) =       0.000475403166
  error estimate for blocks of size 2^( 4) =       0.000487780295
  error estimate for blocks of size 2^( 5) =       0.000499610270
  error estimate for blocks of size 2^( 6) =       0.000506720918
  error estimate for blocks of size 2^( 7) =       0.000509717954

      target function =                  N/A
              le_mean =     -16.893743809206
             les_mean =     285.797649726421
             stat err =       0.000500957359
             autocorr =       1.257715457029
              std dev =       0.631719902218
             le_variance =       0.399070034859

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.399329558834
                                         uncertainty =       0.006400799343

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.399329558834
                                         uncertainty =       0.006400799343

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000446754277
  error estimate for blocks of size 2^( 2) =       0.000460965382
  error estimate for blocks of size 2^( 3) =       0.000475449805
  error estimate for blocks of size 2^( 4) =       0.000487828316
  error estimate for blocks of size 2^( 5) =       0.000499665820
  error estimate for blocks of size 2^( 6) =       0.000506781172
  error estimate for blocks of size 2^( 7) =       0.000509789076

      target function =                  N/A
              le_mean =     -16.893745086100
             les_mean =     285.797801602008
             stat err =       0.000501016096
             autocorr =       1.257667735494
              std dev =       0.631805957126
             le_variance =       0.399178767460


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.893745736189        initial  <--
     9.5367e-02     9.5367e-01             2.7048e-03       -16.893744717721
     3.8147e-01     3.8147e+00             6.7604e-04       -16.893743809206
     1.5259e+00     1.5259e+01             1.6899e-04       -16.893745086100

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0465
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.027108e-01 1 1  ON 0
 uu_1                 1.395499e-01 1 1  ON 1
 uu_2                 4.158458e-02 1 1  ON 2
 uu_3                -1.946409e-02 1 1  ON 3
 uu_4                -6.333239e-02 1 1  ON 4
 uu_5                -9.587524e-02 1 1  ON 5
 uu_6                -1.205706e-01 1 1  ON 6
 uu_7                -1.310580e-01 1 1  ON 7
 uu_8                -1.203232e-01 1 1  ON 8
 uu_9                -9.277332e-02 1 1  ON 9
 ud_0                 4.114416e-01 1 1  ON 10
 ud_1                 1.583401e-01 1 1  ON 11
 ud_2                 6.092685e-02 1 1  ON 12
 ud_3                 2.699750e-03 1 1  ON 13
 ud_4                -5.713986e-02 1 1  ON 14
 ud_5                -1.014997e-01 1 1  ON 15
 ud_6                -1.286687e-01 1 1  ON 16
 ud_7                -1.435029e-01 1 1  ON 17
 ud_8                -1.424319e-01 1 1  ON 18
 ud_9                -1.344547e-01 1 1  ON 19
 eO_0                -7.043100e-01 1 1  ON 20
 eO_1                -4.137154e-01 1 1  ON 21
 eO_2                -3.185752e-02 1 1  ON 22
 eO_3                 2.692030e-01 1 1  ON 23
 eO_4                 4.916456e-01 1 1  ON 24
 eO_5                 4.596091e-01 1 1  ON 25
 eO_6                 2.360353e-01 1 1  ON 26
 eO_7                -5.591968e-02 1 1  ON 27
 eO_8                -1.959242e-01 1 1  ON 28
 eO_9                -5.768884e-02 1 1  ON 29
eH1_0                -2.099404e-01 1 1  ON 30
eH1_1                -1.274877e-01 1 1  ON 31
eH1_2                -8.838243e-02 1 1  ON 32
eH1_3                -3.738645e-02 1 1  ON 33
eH1_4                 1.159942e-02 1 1  ON 34
eH1_5                 4.473069e-02 1 1  ON 35
eH1_6                 9.476145e-02 1 1  ON 36
eH1_7                 1.381756e-01 1 1  ON 37
eH1_8                 1.456924e-01 1 1  ON 38
eH1_9                 3.283823e-02 1 1  ON 39
eH2_0                -2.088198e-01 1 1  ON 40
eH2_1                -1.265485e-01 1 1  ON 41
eH2_2                -8.741031e-02 1 1  ON 42
eH2_3                -3.640778e-02 1 1  ON 43
eH2_4                 1.289653e-02 1 1  ON 44
eH2_5                 4.794967e-02 1 1  ON 45
eH2_6                 1.006131e-01 1 1  ON 46
eH2_7                 1.496008e-01 1 1  ON 47
eH2_8                 1.537439e-01 1 1  ON 48
eH2_9                 1.292423e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6625e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6890e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.9465
    reference variance = 0.439584
====================================================
  Execution time = 2.0897e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6895e+01
  VMC Evar = 3.8393e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5231e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.383936834660
                                         uncertainty =       0.003497892424

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.383936834660
                                         uncertainty =       0.003497892424

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000438140612
  error estimate for blocks of size 2^( 2) =       0.000452524033
  error estimate for blocks of size 2^( 3) =       0.000466719983
  error estimate for blocks of size 2^( 4) =       0.000479388063
  error estimate for blocks of size 2^( 5) =       0.000489773758
  error estimate for blocks of size 2^( 6) =       0.000495704474
  error estimate for blocks of size 2^( 7) =       0.000501540418

      target function =                  N/A
              le_mean =     -16.894570882863
             les_mean =     285.810459515712
             stat err =       0.000491601678
             autocorr =       1.258924521087
              std dev =       0.619624395568
             le_variance =       0.383934391582


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689457088286e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.894570882863       residual = 5.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.894571270456       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.894571231558       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.894570987583       residual = 7.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.894571635719       residual = 3.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.894571567865       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.894571515349       residual = 2.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.894571496268       residual = 3.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-01 is 1.988003e-04

solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.894570882863       residual = 5.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.894570987866       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.894570975955       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.894570911874       residual = 6.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.894571084725       residual = 3.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.894571078862       residual = 8.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.894571060439       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.894571047400       residual = 2.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+00 is 5.007699e-05

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.894570882863       residual = 5.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.894570909675       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.894570906540       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.894570890379       residual = 5.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.894570933990       residual = 2.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.894570933191       residual = 7.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.894570928785       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.894570925173       residual = 1.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+01 is 1.254492e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.160466 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6431e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.027212e-01 1 1  ON 0
 uu_1                 1.395451e-01 1 1  ON 1
 uu_2                 4.159531e-02 1 1  ON 2
 uu_3                -1.946042e-02 1 1  ON 3
 uu_4                -6.334464e-02 1 1  ON 4
 uu_5                -9.590390e-02 1 1  ON 5
 uu_6                -1.205890e-01 1 1  ON 6
 uu_7                -1.310736e-01 1 1  ON 7
 uu_8                -1.203582e-01 1 1  ON 8
 uu_9                -9.275350e-02 1 1  ON 9
 ud_0                 4.114604e-01 1 1  ON 10
 ud_1                 1.583397e-01 1 1  ON 11
 ud_2                 6.092620e-02 1 1  ON 12
 ud_3                 2.701485e-03 1 1  ON 13
 ud_4                -5.713268e-02 1 1  ON 14
 ud_5                -1.015120e-01 1 1  ON 15
 ud_6                -1.286828e-01 1 1  ON 16
 ud_7                -1.435219e-01 1 1  ON 17
 ud_8                -1.424329e-01 1 1  ON 18
 ud_9                -1.344294e-01 1 1  ON 19
 eO_0                -7.043078e-01 1 1  ON 20
 eO_1                -4.137178e-01 1 1  ON 21
 eO_2                -3.184748e-02 1 1  ON 22
 eO_3                 2.691926e-01 1 1  ON 23
 eO_4                 4.916713e-01 1 1  ON 24
 eO_5                 4.596161e-01 1 1  ON 25
 eO_6                 2.360595e-01 1 1  ON 26
 eO_7                -5.591160e-02 1 1  ON 27
 eO_8                -1.959541e-01 1 1  ON 28
 eO_9                -5.771702e-02 1 1  ON 29
eH1_0                -2.099811e-01 1 1  ON 30
eH1_1                -1.275148e-01 1 1  ON 31
eH1_2                -8.839219e-02 1 1  ON 32
eH1_3                -3.741355e-02 1 1  ON 33
eH1_4                 1.158136e-02 1 1  ON 34
eH1_5                 4.472878e-02 1 1  ON 35
eH1_6                 9.476770e-02 1 1  ON 36
eH1_7                 1.382025e-01 1 1  ON 37
eH1_8                 1.457258e-01 1 1  ON 38
eH1_9                 3.288830e-02 1 1  ON 39
eH2_0                -2.088234e-01 1 1  ON 40
eH2_1                -1.265923e-01 1 1  ON 41
eH2_2                -8.740752e-02 1 1  ON 42
eH2_3                -3.640337e-02 1 1  ON 43
eH2_4                 1.286837e-02 1 1  ON 44
eH2_5                 4.793863e-02 1 1  ON 45
eH2_6                 1.006128e-01 1 1  ON 46
eH2_7                 1.495895e-01 1 1  ON 47
eH2_8                 1.537866e-01 1 1  ON 48
eH2_9                 1.297252e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.9169
    reference variance = 0.326812
====================================================
  Execution time = 2.2588e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6893e+01
  VMC Evar = 3.9739e-01
  Total weights = 2.0000e+06
  Execution time = 1.8986e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.397303343118
                                         uncertainty =       0.005802222759

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.397303343118
                                         uncertainty =       0.005802222759

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000445746334
  error estimate for blocks of size 2^( 2) =       0.000459873015
  error estimate for blocks of size 2^( 3) =       0.000474562797
  error estimate for blocks of size 2^( 4) =       0.000487712571
  error estimate for blocks of size 2^( 5) =       0.000498490884
  error estimate for blocks of size 2^( 6) =       0.000506075253
  error estimate for blocks of size 2^( 7) =       0.000514222879

      target function =                  N/A
              le_mean =     -16.893446731160
             les_mean =     285.785921848046
             stat err =       0.000501625397
             autocorr =       1.266436656324
              std dev =       0.630380510639
             le_variance =       0.397379588193

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.397328663383
                                         uncertainty =       0.005803412640

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.397328663383
                                         uncertainty =       0.005803412640

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000445760527
  error estimate for blocks of size 2^( 2) =       0.000459886663
  error estimate for blocks of size 2^( 3) =       0.000474576049
  error estimate for blocks of size 2^( 4) =       0.000487725399
  error estimate for blocks of size 2^( 5) =       0.000498504435
  error estimate for blocks of size 2^( 6) =       0.000506088590
  error estimate for blocks of size 2^( 7) =       0.000514233840

      target function =                  N/A
              le_mean =     -16.893446719821
             les_mean =     285.785946771676
             stat err =       0.000501638066
             autocorr =       1.266419979017
              std dev =       0.630400582928
             le_variance =       0.397404894955

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.397319595968
                                         uncertainty =       0.005802939020

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.397319595968
                                         uncertainty =       0.005802939020

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000445755445
  error estimate for blocks of size 2^( 2) =       0.000459881768
  error estimate for blocks of size 2^( 3) =       0.000474571269
  error estimate for blocks of size 2^( 4) =       0.000487720787
  error estimate for blocks of size 2^( 5) =       0.000498499496
  error estimate for blocks of size 2^( 6) =       0.000506083804
  error estimate for blocks of size 2^( 7) =       0.000514229996

      target function =                  N/A
              le_mean =     -16.893446700904
             les_mean =     285.785937071259
             stat err =       0.000501633521
             autocorr =       1.266425906470
              std dev =       0.630393395961
             le_variance =       0.397395833671

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.397305497658
                                         uncertainty =       0.005802317154

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.397305497658
                                         uncertainty =       0.005802317154

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000445747542
  error estimate for blocks of size 2^( 2) =       0.000459874175
  error estimate for blocks of size 2^( 3) =       0.000474563919
  error estimate for blocks of size 2^( 4) =       0.000487713659
  error estimate for blocks of size 2^( 5) =       0.000498492022
  error estimate for blocks of size 2^( 6) =       0.000506076385
  error estimate for blocks of size 2^( 7) =       0.000514223821

      target function =                  N/A
              le_mean =     -16.893446724653
             les_mean =     285.785923781805
             stat err =       0.000501626472
             autocorr =       1.266435221929
              std dev =       0.630382218819
             le_variance =       0.397381741803


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.893446731160        initial  <--
     9.5367e-01     9.5367e+00             1.9880e-04       -16.893446719821
     3.8147e+00     3.8147e+01             5.0077e-05       -16.893446700904
     1.5259e+01     1.5259e+02             1.2545e-05       -16.893446724653

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 32.2238
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.027108e-01 1 1  ON 0
 uu_1                 1.395499e-01 1 1  ON 1
 uu_2                 4.158458e-02 1 1  ON 2
 uu_3                -1.946409e-02 1 1  ON 3
 uu_4                -6.333239e-02 1 1  ON 4
 uu_5                -9.587524e-02 1 1  ON 5
 uu_6                -1.205706e-01 1 1  ON 6
 uu_7                -1.310580e-01 1 1  ON 7
 uu_8                -1.203232e-01 1 1  ON 8
 uu_9                -9.277332e-02 1 1  ON 9
 ud_0                 4.114416e-01 1 1  ON 10
 ud_1                 1.583401e-01 1 1  ON 11
 ud_2                 6.092685e-02 1 1  ON 12
 ud_3                 2.699750e-03 1 1  ON 13
 ud_4                -5.713986e-02 1 1  ON 14
 ud_5                -1.014997e-01 1 1  ON 15
 ud_6                -1.286687e-01 1 1  ON 16
 ud_7                -1.435029e-01 1 1  ON 17
 ud_8                -1.424319e-01 1 1  ON 18
 ud_9                -1.344547e-01 1 1  ON 19
 eO_0                -7.043100e-01 1 1  ON 20
 eO_1                -4.137154e-01 1 1  ON 21
 eO_2                -3.185752e-02 1 1  ON 22
 eO_3                 2.692030e-01 1 1  ON 23
 eO_4                 4.916456e-01 1 1  ON 24
 eO_5                 4.596091e-01 1 1  ON 25
 eO_6                 2.360353e-01 1 1  ON 26
 eO_7                -5.591968e-02 1 1  ON 27
 eO_8                -1.959242e-01 1 1  ON 28
 eO_9                -5.768884e-02 1 1  ON 29
eH1_0                -2.099404e-01 1 1  ON 30
eH1_1                -1.274877e-01 1 1  ON 31
eH1_2                -8.838243e-02 1 1  ON 32
eH1_3                -3.738645e-02 1 1  ON 33
eH1_4                 1.159942e-02 1 1  ON 34
eH1_5                 4.473069e-02 1 1  ON 35
eH1_6                 9.476145e-02 1 1  ON 36
eH1_7                 1.381756e-01 1 1  ON 37
eH1_8                 1.456924e-01 1 1  ON 38
eH1_9                 3.283823e-02 1 1  ON 39
eH2_0                -2.088198e-01 1 1  ON 40
eH2_1                -1.265485e-01 1 1  ON 41
eH2_2                -8.741031e-02 1 1  ON 42
eH2_3                -3.640778e-02 1 1  ON 43
eH2_4                 1.289653e-02 1 1  ON 44
eH2_5                 4.794967e-02 1 1  ON 45
eH2_6                 1.006131e-01 1 1  ON 46
eH2_7                 1.496008e-01 1 1  ON 47
eH2_8                 1.537439e-01 1 1  ON 48
eH2_9                 1.292423e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8661e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6893e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.8601
    reference variance = 0.281867
====================================================
  Execution time = 2.1286e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6894e+01
  VMC Evar = 4.0293e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5634e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.403069745905
                                         uncertainty =       0.010562275272

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.403069745905
                                         uncertainty =       0.010562275272

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000448851038
  error estimate for blocks of size 2^( 2) =       0.000462507632
  error estimate for blocks of size 2^( 3) =       0.000476154272
  error estimate for blocks of size 2^( 4) =       0.000488584572
  error estimate for blocks of size 2^( 5) =       0.000498667039
  error estimate for blocks of size 2^( 6) =       0.000507604755
  error estimate for blocks of size 2^( 7) =       0.000512419871

      target function =                  N/A
              le_mean =     -16.893673277994
             les_mean =     285.799131131615
             stat err =       0.000501819059
             autocorr =       1.249941924336
              std dev =       0.634771226080
             le_variance =       0.402934509459


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689367327799e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.893673277994       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.893673255325       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.893673248653       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.893673280279       residual = 9.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.893673313684       residual = 4.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.893673335699       residual = 5.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.893673343065       residual = 2.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.893673342048       residual = 1.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+00 is 2.316480e-05

solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.893673277994       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.893673272259       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.893673270519       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.893673278469       residual = 9.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.893673286796       residual = 4.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.893673292450       residual = 4.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.893673294233       residual = 2.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.893673294098       residual = 1.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+01 is 5.792259e-06

solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.893673277994       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.893673276556       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.893673276117       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.893673278107       residual = 9.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.893673280187       residual = 4.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.893673281611       residual = 4.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.893673282052       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.893673282027       residual = 1.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+02 is 1.448123e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.163216 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6861e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.027115e-01 1 1  ON 0
 uu_1                 1.395507e-01 1 1  ON 1
 uu_2                 4.158413e-02 1 1  ON 2
 uu_3                -1.946522e-02 1 1  ON 3
 uu_4                -6.333290e-02 1 1  ON 4
 uu_5                -9.587242e-02 1 1  ON 5
 uu_6                -1.205733e-01 1 1  ON 6
 uu_7                -1.310583e-01 1 1  ON 7
 uu_8                -1.203276e-01 1 1  ON 8
 uu_9                -9.277432e-02 1 1  ON 9
 ud_0                 4.114443e-01 1 1  ON 10
 ud_1                 1.583389e-01 1 1  ON 11
 ud_2                 6.092775e-02 1 1  ON 12
 ud_3                 2.699760e-03 1 1  ON 13
 ud_4                -5.713947e-02 1 1  ON 14
 ud_5                -1.015001e-01 1 1  ON 15
 ud_6                -1.286701e-01 1 1  ON 16
 ud_7                -1.435046e-01 1 1  ON 17
 ud_8                -1.424334e-01 1 1  ON 18
 ud_9                -1.344539e-01 1 1  ON 19
 eO_0                -7.043106e-01 1 1  ON 20
 eO_1                -4.137162e-01 1 1  ON 21
 eO_2                -3.185715e-02 1 1  ON 22
 eO_3                 2.692033e-01 1 1  ON 23
 eO_4                 4.916494e-01 1 1  ON 24
 eO_5                 4.596102e-01 1 1  ON 25
 eO_6                 2.360380e-01 1 1  ON 26
 eO_7                -5.591698e-02 1 1  ON 27
 eO_8                -1.959294e-01 1 1  ON 28
 eO_9                -5.769260e-02 1 1  ON 29
eH1_0                -2.099415e-01 1 1  ON 30
eH1_1                -1.274931e-01 1 1  ON 31
eH1_2                -8.838420e-02 1 1  ON 32
eH1_3                -3.739126e-02 1 1  ON 33
eH1_4                 1.159877e-02 1 1  ON 34
eH1_5                 4.472934e-02 1 1  ON 35
eH1_6                 9.476179e-02 1 1  ON 36
eH1_7                 1.381789e-01 1 1  ON 37
eH1_8                 1.456982e-01 1 1  ON 38
eH1_9                 3.284350e-02 1 1  ON 39
eH2_0                -2.088238e-01 1 1  ON 40
eH2_1                -1.265509e-01 1 1  ON 41
eH2_2                -8.741179e-02 1 1  ON 42
eH2_3                -3.640783e-02 1 1  ON 43
eH2_4                 1.289717e-02 1 1  ON 44
eH2_5                 4.794672e-02 1 1  ON 45
eH2_6                 1.006119e-01 1 1  ON 46
eH2_7                 1.496017e-01 1 1  ON 47
eH2_8                 1.537496e-01 1 1  ON 48
eH2_9                 1.292942e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.9267
    reference variance = 0.239633
====================================================
  Execution time = 2.0584e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6894e+01
  VMC Evar = 3.9663e-01
  Total weights = 2.0000e+06
  Execution time = 1.8867e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.396674429048
                                         uncertainty =       0.005346074566

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.396674429048
                                         uncertainty =       0.005346074566

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000445323592
  error estimate for blocks of size 2^( 2) =       0.000459913534
  error estimate for blocks of size 2^( 3) =       0.000473685975
  error estimate for blocks of size 2^( 4) =       0.000487369715
  error estimate for blocks of size 2^( 5) =       0.000499235065
  error estimate for blocks of size 2^( 6) =       0.000507978716
  error estimate for blocks of size 2^( 7) =       0.000511812796

      target function =                  N/A
              le_mean =     -16.894131869746
             les_mean =     285.808317637832
             stat err =       0.000501599073
             autocorr =       1.268709065155
              std dev =       0.629782663928
             le_variance =       0.396626203784

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.396684647531
                                         uncertainty =       0.005346158560

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.396684647531
                                         uncertainty =       0.005346158560

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000445329334
  error estimate for blocks of size 2^( 2) =       0.000459919013
  error estimate for blocks of size 2^( 3) =       0.000473691148
  error estimate for blocks of size 2^( 4) =       0.000487374593
  error estimate for blocks of size 2^( 5) =       0.000499239575
  error estimate for blocks of size 2^( 6) =       0.000507983036
  error estimate for blocks of size 2^( 7) =       0.000511816992

      target function =                  N/A
              le_mean =     -16.894131817516
             les_mean =     285.808326101611
             stat err =       0.000501603549
             autocorr =       1.268698989037
              std dev =       0.629790784572
             le_variance =       0.396636432332

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.396679732659
                                         uncertainty =       0.005346117997

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.396679732659
                                         uncertainty =       0.005346117997

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000445326573
  error estimate for blocks of size 2^( 2) =       0.000459916378
  error estimate for blocks of size 2^( 3) =       0.000473688661
  error estimate for blocks of size 2^( 4) =       0.000487372251
  error estimate for blocks of size 2^( 5) =       0.000499237414
  error estimate for blocks of size 2^( 6) =       0.000507980968
  error estimate for blocks of size 2^( 7) =       0.000511814986

      target function =                  N/A
              le_mean =     -16.894131842262
             les_mean =     285.808322018138
             stat err =       0.000501601405
             autocorr =       1.268703877723
              std dev =       0.629786878817
             le_variance =       0.396631512731

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.396675098213
                                         uncertainty =       0.005346080041

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.396675098213
                                         uncertainty =       0.005346080041

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000445323968
  error estimate for blocks of size 2^( 2) =       0.000459913893
  error estimate for blocks of size 2^( 3) =       0.000473686314
  error estimate for blocks of size 2^( 4) =       0.000487370035
  error estimate for blocks of size 2^( 5) =       0.000499235362
  error estimate for blocks of size 2^( 6) =       0.000507979001
  error estimate for blocks of size 2^( 7) =       0.000511813073

      target function =                  N/A
              le_mean =     -16.894131866251
             les_mean =     285.808318189583
             stat err =       0.000501599367
             autocorr =       1.268708411876
              std dev =       0.629783195732
             le_variance =       0.396626873626


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.894131869746        initial  <--
     9.5367e+00     9.5367e+01             2.3165e-05       -16.894131817516
     3.8147e+01     3.8147e+02             5.7923e-06       -16.894131842262
     1.5259e+02     1.5259e+03             1.4481e-06       -16.894131866251

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.1582
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.027108e-01 1 1  ON 0
 uu_1                 1.395499e-01 1 1  ON 1
 uu_2                 4.158458e-02 1 1  ON 2
 uu_3                -1.946409e-02 1 1  ON 3
 uu_4                -6.333239e-02 1 1  ON 4
 uu_5                -9.587524e-02 1 1  ON 5
 uu_6                -1.205706e-01 1 1  ON 6
 uu_7                -1.310580e-01 1 1  ON 7
 uu_8                -1.203232e-01 1 1  ON 8
 uu_9                -9.277332e-02 1 1  ON 9
 ud_0                 4.114416e-01 1 1  ON 10
 ud_1                 1.583401e-01 1 1  ON 11
 ud_2                 6.092685e-02 1 1  ON 12
 ud_3                 2.699750e-03 1 1  ON 13
 ud_4                -5.713986e-02 1 1  ON 14
 ud_5                -1.014997e-01 1 1  ON 15
 ud_6                -1.286687e-01 1 1  ON 16
 ud_7                -1.435029e-01 1 1  ON 17
 ud_8                -1.424319e-01 1 1  ON 18
 ud_9                -1.344547e-01 1 1  ON 19
 eO_0                -7.043100e-01 1 1  ON 20
 eO_1                -4.137154e-01 1 1  ON 21
 eO_2                -3.185752e-02 1 1  ON 22
 eO_3                 2.692030e-01 1 1  ON 23
 eO_4                 4.916456e-01 1 1  ON 24
 eO_5                 4.596091e-01 1 1  ON 25
 eO_6                 2.360353e-01 1 1  ON 26
 eO_7                -5.591968e-02 1 1  ON 27
 eO_8                -1.959242e-01 1 1  ON 28
 eO_9                -5.768884e-02 1 1  ON 29
eH1_0                -2.099404e-01 1 1  ON 30
eH1_1                -1.274877e-01 1 1  ON 31
eH1_2                -8.838243e-02 1 1  ON 32
eH1_3                -3.738645e-02 1 1  ON 33
eH1_4                 1.159942e-02 1 1  ON 34
eH1_5                 4.473069e-02 1 1  ON 35
eH1_6                 9.476145e-02 1 1  ON 36
eH1_7                 1.381756e-01 1 1  ON 37
eH1_8                 1.456924e-01 1 1  ON 38
eH1_9                 3.283823e-02 1 1  ON 39
eH2_0                -2.088198e-01 1 1  ON 40
eH2_1                -1.265485e-01 1 1  ON 41
eH2_2                -8.741031e-02 1 1  ON 42
eH2_3                -3.640778e-02 1 1  ON 43
eH2_4                 1.289653e-02 1 1  ON 44
eH2_5                 4.794967e-02 1 1  ON 45
eH2_6                 1.006131e-01 1 1  ON 46
eH2_7                 1.496008e-01 1 1  ON 47
eH2_8                 1.537439e-01 1 1  ON 48
eH2_9                 1.292423e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7024e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6893e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.8771
    reference variance = 0.26899
====================================================
  Execution time = 2.0812e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6894e+01
  VMC Evar = 4.0501e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6337e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.405025941917
                                         uncertainty =       0.008320568850

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.405025941917
                                         uncertainty =       0.008320568850

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000450005366
  error estimate for blocks of size 2^( 2) =       0.000464442814
  error estimate for blocks of size 2^( 3) =       0.000479068184
  error estimate for blocks of size 2^( 4) =       0.000492229526
  error estimate for blocks of size 2^( 5) =       0.000502486265
  error estimate for blocks of size 2^( 6) =       0.000510506169
  error estimate for blocks of size 2^( 7) =       0.000515052925

      target function =                  N/A
              le_mean =     -16.894264058325
             les_mean =     285.821167528792
             stat err =       0.000505068721
             autocorr =       1.259695454105
              std dev =       0.636403691747
             le_variance =       0.405009658869


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689426405833e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.894264058325       residual = 8.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.894264057979       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.894264074721       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.894264072875       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.894264071394       residual = 3.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.894264066455       residual = 7.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.894264066566       residual = 2.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.894264067823       residual = 4.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+01 is 2.969385e-06

solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.894264058325       residual = 8.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.894264058239       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.894264062431       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.894264061967       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.894264061601       residual = 3.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.894264060367       residual = 7.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.894264060389       residual = 2.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.894264060701       residual = 4.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+02 is 7.424077e-07

solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.894264058325       residual = 8.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.894264058304       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.894264059352       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.894264059235       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.894264059146       residual = 3.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.894264058836       residual = 7.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.894264058843       residual = 2.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.894264058921       residual = 4.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+03 is 1.856058e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.165889 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6457e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.027108e-01 1 1  ON 0
 uu_1                 1.395498e-01 1 1  ON 1
 uu_2                 4.158458e-02 1 1  ON 2
 uu_3                -1.946420e-02 1 1  ON 3
 uu_4                -6.333261e-02 1 1  ON 4
 uu_5                -9.587518e-02 1 1  ON 5
 uu_6                -1.205707e-01 1 1  ON 6
 uu_7                -1.310580e-01 1 1  ON 7
 uu_8                -1.203235e-01 1 1  ON 8
 uu_9                -9.277341e-02 1 1  ON 9
 ud_0                 4.114417e-01 1 1  ON 10
 ud_1                 1.583398e-01 1 1  ON 11
 ud_2                 6.092694e-02 1 1  ON 12
 ud_3                 2.699815e-03 1 1  ON 13
 ud_4                -5.713970e-02 1 1  ON 14
 ud_5                -1.014997e-01 1 1  ON 15
 ud_6                -1.286689e-01 1 1  ON 16
 ud_7                -1.435029e-01 1 1  ON 17
 ud_8                -1.424321e-01 1 1  ON 18
 ud_9                -1.344546e-01 1 1  ON 19
 eO_0                -7.043102e-01 1 1  ON 20
 eO_1                -4.137152e-01 1 1  ON 21
 eO_2                -3.185789e-02 1 1  ON 22
 eO_3                 2.692032e-01 1 1  ON 23
 eO_4                 4.916463e-01 1 1  ON 24
 eO_5                 4.596092e-01 1 1  ON 25
 eO_6                 2.360353e-01 1 1  ON 26
 eO_7                -5.591941e-02 1 1  ON 27
 eO_8                -1.959247e-01 1 1  ON 28
 eO_9                -5.768918e-02 1 1  ON 29
eH1_0                -2.099406e-01 1 1  ON 30
eH1_1                -1.274878e-01 1 1  ON 31
eH1_2                -8.838261e-02 1 1  ON 32
eH1_3                -3.738664e-02 1 1  ON 33
eH1_4                 1.159932e-02 1 1  ON 34
eH1_5                 4.473067e-02 1 1  ON 35
eH1_6                 9.476153e-02 1 1  ON 36
eH1_7                 1.381757e-01 1 1  ON 37
eH1_8                 1.456927e-01 1 1  ON 38
eH1_9                 3.283848e-02 1 1  ON 39
eH2_0                -2.088204e-01 1 1  ON 40
eH2_1                -1.265483e-01 1 1  ON 41
eH2_2                -8.741076e-02 1 1  ON 42
eH2_3                -3.640790e-02 1 1  ON 43
eH2_4                 1.289646e-02 1 1  ON 44
eH2_5                 4.794946e-02 1 1  ON 45
eH2_6                 1.006129e-01 1 1  ON 46
eH2_7                 1.496007e-01 1 1  ON 47
eH2_8                 1.537446e-01 1 1  ON 48
eH2_9                 1.292497e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.9045
    reference variance = 0.289913
====================================================
  Execution time = 2.0454e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6895e+01
  VMC Evar = 3.9558e-01
  Total weights = 2.0000e+06
  Execution time = 1.8957e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.395561666131
                                         uncertainty =       0.005003048598

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.395561666131
                                         uncertainty =       0.005003048598

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000444735678
  error estimate for blocks of size 2^( 2) =       0.000458738341
  error estimate for blocks of size 2^( 3) =       0.000472492963
  error estimate for blocks of size 2^( 4) =       0.000485258857
  error estimate for blocks of size 2^( 5) =       0.000496653278
  error estimate for blocks of size 2^( 6) =       0.000504175010
  error estimate for blocks of size 2^( 7) =       0.000511500856

      target function =                  N/A
              le_mean =     -16.894686156574
             les_mean =     285.825999778530
             stat err =       0.000499397000
             autocorr =       1.260921109776
              std dev =       0.628951227986
             le_variance =       0.395579647186

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.395562544851
                                         uncertainty =       0.005003059113

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.395562544851
                                         uncertainty =       0.005003059113

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000444736173
  error estimate for blocks of size 2^( 2) =       0.000458738835
  error estimate for blocks of size 2^( 3) =       0.000472493440
  error estimate for blocks of size 2^( 4) =       0.000485259302
  error estimate for blocks of size 2^( 5) =       0.000496653687
  error estimate for blocks of size 2^( 6) =       0.000504175399
  error estimate for blocks of size 2^( 7) =       0.000511501242

      target function =                  N/A
              le_mean =     -16.894686141611
             les_mean =     285.826000152712
             stat err =       0.000499397408
             autocorr =       1.260920362411
              std dev =       0.628951927387
             le_variance =       0.395580526964

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.395562107540
                                         uncertainty =       0.005003053883

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.395562107540
                                         uncertainty =       0.005003053883

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000444735927
  error estimate for blocks of size 2^( 2) =       0.000458738589
  error estimate for blocks of size 2^( 3) =       0.000472493203
  error estimate for blocks of size 2^( 4) =       0.000485259081
  error estimate for blocks of size 2^( 5) =       0.000496653483
  error estimate for blocks of size 2^( 6) =       0.000504175205
  error estimate for blocks of size 2^( 7) =       0.000511501050

      target function =                  N/A
              le_mean =     -16.894686149064
             les_mean =     285.825999966725
             stat err =       0.000499397205
             autocorr =       1.260920734604
              std dev =       0.628951579317
             le_variance =       0.395580089125

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.395561721369
                                         uncertainty =       0.005003049260

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.395561721369
                                         uncertainty =       0.005003049260

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000444735709
  error estimate for blocks of size 2^( 2) =       0.000458738372
  error estimate for blocks of size 2^( 3) =       0.000472492993
  error estimate for blocks of size 2^( 4) =       0.000485258885
  error estimate for blocks of size 2^( 5) =       0.000496653304
  error estimate for blocks of size 2^( 6) =       0.000504175034
  error estimate for blocks of size 2^( 7) =       0.000511500881

      target function =                  N/A
              le_mean =     -16.894686155634
             les_mean =     285.825999802077
             stat err =       0.000499397026
             autocorr =       1.260921062831
              std dev =       0.628951271952
             le_variance =       0.395579702490


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.894686156574        initial  <--
     9.5367e+01     9.5367e+02             2.9694e-06       -16.894686141611
     3.8147e+02     3.8147e+03             7.4241e-07       -16.894686149064
     1.5259e+03     1.5259e+04             1.8561e-07       -16.894686155634

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.2347
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.027108e-01 1 1  ON 0
 uu_1                 1.395499e-01 1 1  ON 1
 uu_2                 4.158458e-02 1 1  ON 2
 uu_3                -1.946409e-02 1 1  ON 3
 uu_4                -6.333239e-02 1 1  ON 4
 uu_5                -9.587524e-02 1 1  ON 5
 uu_6                -1.205706e-01 1 1  ON 6
 uu_7                -1.310580e-01 1 1  ON 7
 uu_8                -1.203232e-01 1 1  ON 8
 uu_9                -9.277332e-02 1 1  ON 9
 ud_0                 4.114416e-01 1 1  ON 10
 ud_1                 1.583401e-01 1 1  ON 11
 ud_2                 6.092685e-02 1 1  ON 12
 ud_3                 2.699750e-03 1 1  ON 13
 ud_4                -5.713986e-02 1 1  ON 14
 ud_5                -1.014997e-01 1 1  ON 15
 ud_6                -1.286687e-01 1 1  ON 16
 ud_7                -1.435029e-01 1 1  ON 17
 ud_8                -1.424319e-01 1 1  ON 18
 ud_9                -1.344547e-01 1 1  ON 19
 eO_0                -7.043100e-01 1 1  ON 20
 eO_1                -4.137154e-01 1 1  ON 21
 eO_2                -3.185752e-02 1 1  ON 22
 eO_3                 2.692030e-01 1 1  ON 23
 eO_4                 4.916456e-01 1 1  ON 24
 eO_5                 4.596091e-01 1 1  ON 25
 eO_6                 2.360353e-01 1 1  ON 26
 eO_7                -5.591968e-02 1 1  ON 27
 eO_8                -1.959242e-01 1 1  ON 28
 eO_9                -5.768884e-02 1 1  ON 29
eH1_0                -2.099404e-01 1 1  ON 30
eH1_1                -1.274877e-01 1 1  ON 31
eH1_2                -8.838243e-02 1 1  ON 32
eH1_3                -3.738645e-02 1 1  ON 33
eH1_4                 1.159942e-02 1 1  ON 34
eH1_5                 4.473069e-02 1 1  ON 35
eH1_6                 9.476145e-02 1 1  ON 36
eH1_7                 1.381756e-01 1 1  ON 37
eH1_8                 1.456924e-01 1 1  ON 38
eH1_9                 3.283823e-02 1 1  ON 39
eH2_0                -2.088198e-01 1 1  ON 40
eH2_1                -1.265485e-01 1 1  ON 41
eH2_2                -8.741031e-02 1 1  ON 42
eH2_3                -3.640778e-02 1 1  ON 43
eH2_4                 1.289653e-02 1 1  ON 44
eH2_5                 4.794967e-02 1 1  ON 45
eH2_6                 1.006131e-01 1 1  ON 46
eH2_7                 1.496008e-01 1 1  ON 47
eH2_8                 1.537439e-01 1 1  ON 48
eH2_9                 1.292423e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6697e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6893e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.8619
    reference variance = 0.268273
====================================================
  Execution time = 2.0761e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6895e+01
  VMC Evar = 4.0816e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5364e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.408272197060
                                         uncertainty =       0.020083473167

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.408272197060
                                         uncertainty =       0.020083473167

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000451754623
  error estimate for blocks of size 2^( 2) =       0.000466033068
  error estimate for blocks of size 2^( 3) =       0.000479276760
  error estimate for blocks of size 2^( 4) =       0.000492218023
  error estimate for blocks of size 2^( 5) =       0.000502572404
  error estimate for blocks of size 2^( 6) =       0.000510810040
  error estimate for blocks of size 2^( 7) =       0.000517036937

      target function =                  N/A
              le_mean =     -16.894791745473
             les_mean =     285.842152396976
             stat err =       0.000505659351
             autocorr =       1.252884036049
              std dev =       0.638877514206
             le_variance =       0.408164478158


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.689479174547e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.894791745473       residual = 4.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.894791747807       residual = 6.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.894791748308       residual = 9.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.894791748454       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.894791748787       residual = 3.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.894791748638       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.894791748665       residual = 3.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.894791748827       residual = 9.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+02 is 2.129676e-07

solving harmonic davidson linear method for identity shift 3.8147e+03, overlap shift 3.8147e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.894791745473       residual = 4.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.894791746057       residual = 6.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.894791746182       residual = 9.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.894791746221       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.894791746301       residual = 3.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.894791746263       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.894791746271       residual = 3.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.894791746311       residual = 9.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+03 is 5.324315e-08

solving harmonic davidson linear method for identity shift 1.5259e+04, overlap shift 1.5259e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.894791745473       residual = 4.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.894791745619       residual = 6.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.894791745650       residual = 9.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.894791745660       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.894791745680       residual = 3.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.894791745674       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.894791745678       residual = 3.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.894791745688       residual = 9.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+04 is 1.331087e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.168593 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6309e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.027108e-01 1 1  ON 0
 uu_1                 1.395498e-01 1 1  ON 1
 uu_2                 4.158462e-02 1 1  ON 2
 uu_3                -1.946411e-02 1 1  ON 3
 uu_4                -6.333243e-02 1 1  ON 4
 uu_5                -9.587521e-02 1 1  ON 5
 uu_6                -1.205706e-01 1 1  ON 6
 uu_7                -1.310579e-01 1 1  ON 7
 uu_8                -1.203233e-01 1 1  ON 8
 uu_9                -9.277334e-02 1 1  ON 9
 ud_0                 4.114416e-01 1 1  ON 10
 ud_1                 1.583401e-01 1 1  ON 11
 ud_2                 6.092687e-02 1 1  ON 12
 ud_3                 2.699762e-03 1 1  ON 13
 ud_4                -5.713984e-02 1 1  ON 14
 ud_5                -1.014997e-01 1 1  ON 15
 ud_6                -1.286687e-01 1 1  ON 16
 ud_7                -1.435030e-01 1 1  ON 17
 ud_8                -1.424320e-01 1 1  ON 18
 ud_9                -1.344547e-01 1 1  ON 19
 eO_0                -7.043100e-01 1 1  ON 20
 eO_1                -4.137154e-01 1 1  ON 21
 eO_2                -3.185756e-02 1 1  ON 22
 eO_3                 2.692030e-01 1 1  ON 23
 eO_4                 4.916456e-01 1 1  ON 24
 eO_5                 4.596091e-01 1 1  ON 25
 eO_6                 2.360353e-01 1 1  ON 26
 eO_7                -5.591965e-02 1 1  ON 27
 eO_8                -1.959243e-01 1 1  ON 28
 eO_9                -5.768887e-02 1 1  ON 29
eH1_0                -2.099404e-01 1 1  ON 30
eH1_1                -1.274878e-01 1 1  ON 31
eH1_2                -8.838246e-02 1 1  ON 32
eH1_3                -3.738650e-02 1 1  ON 33
eH1_4                 1.159940e-02 1 1  ON 34
eH1_5                 4.473070e-02 1 1  ON 35
eH1_6                 9.476146e-02 1 1  ON 36
eH1_7                 1.381757e-01 1 1  ON 37
eH1_8                 1.456924e-01 1 1  ON 38
eH1_9                 3.283827e-02 1 1  ON 39
eH2_0                -2.088199e-01 1 1  ON 40
eH2_1                -1.265485e-01 1 1  ON 41
eH2_2                -8.741033e-02 1 1  ON 42
eH2_3                -3.640780e-02 1 1  ON 43
eH2_4                 1.289654e-02 1 1  ON 44
eH2_5                 4.794966e-02 1 1  ON 45
eH2_6                 1.006130e-01 1 1  ON 46
eH2_7                 1.496008e-01 1 1  ON 47
eH2_8                 1.537439e-01 1 1  ON 48
eH2_9                 1.292428e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.8563
    reference variance = 1.66823
====================================================
  Execution time = 2.0354e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6894e+01
  VMC Evar = 4.0690e-01
  Total weights = 2.0000e+06
  Execution time = 1.8932e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.406651371546
                                         uncertainty =       0.013072312659

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.406651371546
                                         uncertainty =       0.013072312659

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000451055941
  error estimate for blocks of size 2^( 2) =       0.000465048615
  error estimate for blocks of size 2^( 3) =       0.000479882722
  error estimate for blocks of size 2^( 4) =       0.000492890680
  error estimate for blocks of size 2^( 5) =       0.000503558806
  error estimate for blocks of size 2^( 6) =       0.000512461912
  error estimate for blocks of size 2^( 7) =       0.000517851172

      target function =                  N/A
              le_mean =     -16.894341901788
             les_mean =     285.825691015456
             stat err =       0.000506690642
             autocorr =       1.261900033856
              std dev =       0.637889429606
             le_variance =       0.406902924402

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.406651307542
                                         uncertainty =       0.013072311556

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.406651307542
                                         uncertainty =       0.013072311556

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000451055906
  error estimate for blocks of size 2^( 2) =       0.000465048579
  error estimate for blocks of size 2^( 3) =       0.000479882687
  error estimate for blocks of size 2^( 4) =       0.000492890646
  error estimate for blocks of size 2^( 5) =       0.000503558775
  error estimate for blocks of size 2^( 6) =       0.000512461880
  error estimate for blocks of size 2^( 7) =       0.000517851142

      target function =                  N/A
              le_mean =     -16.894341898532
             les_mean =     285.825690841464
             stat err =       0.000506690611
             autocorr =       1.261900076813
              std dev =       0.637889379454
             le_variance =       0.406902860421

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.406651339536
                                         uncertainty =       0.013072312108

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.406651339536
                                         uncertainty =       0.013072312108

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000451055924
  error estimate for blocks of size 2^( 2) =       0.000465048597
  error estimate for blocks of size 2^( 3) =       0.000479882704
  error estimate for blocks of size 2^( 4) =       0.000492890663
  error estimate for blocks of size 2^( 5) =       0.000503558790
  error estimate for blocks of size 2^( 6) =       0.000512461896
  error estimate for blocks of size 2^( 7) =       0.000517851157

      target function =                  N/A
              le_mean =     -16.894341900159
             les_mean =     285.825690928425
             stat err =       0.000506690627
             autocorr =       1.261900055336
              std dev =       0.637889404524
             le_variance =       0.406902892404

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.406651367544
                                         uncertainty =       0.013072312590

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.406651367544
                                         uncertainty =       0.013072312590

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000451055939
  error estimate for blocks of size 2^( 2) =       0.000465048613
  error estimate for blocks of size 2^( 3) =       0.000479882720
  error estimate for blocks of size 2^( 4) =       0.000492890678
  error estimate for blocks of size 2^( 5) =       0.000503558804
  error estimate for blocks of size 2^( 6) =       0.000512461910
  error estimate for blocks of size 2^( 7) =       0.000517851170

      target function =                  N/A
              le_mean =     -16.894341901584
             les_mean =     285.825691004575
             stat err =       0.000506690640
             autocorr =       1.261900036539
              std dev =       0.637889426470
             le_variance =       0.406902920402


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.894341901788        initial  <--
     9.5367e+02     9.5367e+03             2.1297e-07       -16.894341898532
     3.8147e+03     3.8147e+04             5.3243e-08       -16.894341900159
     1.5259e+04     1.5259e+05             1.3311e-08       -16.894341901584

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9559
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.027108e-01 1 1  ON 0
 uu_1                 1.395499e-01 1 1  ON 1
 uu_2                 4.158458e-02 1 1  ON 2
 uu_3                -1.946409e-02 1 1  ON 3
 uu_4                -6.333239e-02 1 1  ON 4
 uu_5                -9.587524e-02 1 1  ON 5
 uu_6                -1.205706e-01 1 1  ON 6
 uu_7                -1.310580e-01 1 1  ON 7
 uu_8                -1.203232e-01 1 1  ON 8
 uu_9                -9.277332e-02 1 1  ON 9
 ud_0                 4.114416e-01 1 1  ON 10
 ud_1                 1.583401e-01 1 1  ON 11
 ud_2                 6.092685e-02 1 1  ON 12
 ud_3                 2.699750e-03 1 1  ON 13
 ud_4                -5.713986e-02 1 1  ON 14
 ud_5                -1.014997e-01 1 1  ON 15
 ud_6                -1.286687e-01 1 1  ON 16
 ud_7                -1.435029e-01 1 1  ON 17
 ud_8                -1.424319e-01 1 1  ON 18
 ud_9                -1.344547e-01 1 1  ON 19
 eO_0                -7.043100e-01 1 1  ON 20
 eO_1                -4.137154e-01 1 1  ON 21
 eO_2                -3.185752e-02 1 1  ON 22
 eO_3                 2.692030e-01 1 1  ON 23
 eO_4                 4.916456e-01 1 1  ON 24
 eO_5                 4.596091e-01 1 1  ON 25
 eO_6                 2.360353e-01 1 1  ON 26
 eO_7                -5.591968e-02 1 1  ON 27
 eO_8                -1.959242e-01 1 1  ON 28
 eO_9                -5.768884e-02 1 1  ON 29
eH1_0                -2.099404e-01 1 1  ON 30
eH1_1                -1.274877e-01 1 1  ON 31
eH1_2                -8.838243e-02 1 1  ON 32
eH1_3                -3.738645e-02 1 1  ON 33
eH1_4                 1.159942e-02 1 1  ON 34
eH1_5                 4.473069e-02 1 1  ON 35
eH1_6                 9.476145e-02 1 1  ON 36
eH1_7                 1.381756e-01 1 1  ON 37
eH1_8                 1.456924e-01 1 1  ON 38
eH1_9                 3.283823e-02 1 1  ON 39
eH2_0                -2.088198e-01 1 1  ON 40
eH2_1                -1.265485e-01 1 1  ON 41
eH2_2                -8.741031e-02 1 1  ON 42
eH2_3                -3.640778e-02 1 1  ON 43
eH2_4                 1.289653e-02 1 1  ON 44
eH2_5                 4.794967e-02 1 1  ON 45
eH2_6                 1.006131e-01 1 1  ON 46
eH2_7                 1.496008e-01 1 1  ON 47
eH2_8                 1.537439e-01 1 1  ON 48
eH2_9                 1.292423e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6269e+01 secs
  Total Execution time = 1.1450e+03 secs

=========================================================
  A new xml input file : H2O.s019.cont.xml
